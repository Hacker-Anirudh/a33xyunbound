cscope 15 $HOME/MOHIT/CODEBASES/PAPAYA_MASTER_14_FEB_2024/product/kernel/drivers/net/wireless/scsc               0003174981
	@acm_api.c

7 
	~<lšux/Ãtdeviû.h
>

8 
	~"mlme.h
"

9 
	~"mib.h
"

10 
	~"debug.h
"

12 
	#TSF_RESP_SIZE
 (14)

	)

14 
	$SDA_g‘Tsf
(cÚ¡ 
if_id
)

16 
Ãt_deviû
 *
dev
 = 
NULL
;

17 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

18 
¦si_dev
 *
sdev
 = 
NULL
;

19 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

20 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

22 
u8
 
»s_·ylßd
[
TSF_RESP_SIZE
] = { 0 };

23 
r
 = 0;

24 
rx_Ëngth
 = 0;

25 
»t
 = 0;

27 
	`»ad_lock
(&
dev_ba£_lock
);

28 
dev
 = 
	`fœ¡_Ãt_deviû
(&
š™_Ãt
);

29 
dev
) {

30 ià(
if_id
 =ğ0 && 
	`memcmp
(
dev
->
Çme
, "wlan0", 5) == 0)

32 ià(
if_id
 =ğ1 && 
	`memcmp
(
dev
->
Çme
, "p2p0", 4) == 0)

34 
dev
 = 
	`Ãxt_Ãt_deviû
(dev);

36 
	`»ad_uÆock
(&
dev_ba£_lock
);

38 ià(!
dev
) {

39 
	`SLSI_ERR
(
sdev
, "dev is‚ull\n");

42 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

43 ià(!
ndev_vif
) {

44 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ull\n");

47 
sdev
 = 
ndev_vif
->sdev;

48 ià(!
sdev
) {

49 
	`SLSI_ERR
(
sdev
, "sdev is‚ull\n");

53 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

54 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_CURRENT_TSF_TIME
, 0);

55 
mibr¥
.
d©aL’gth
 = (
»s_·ylßd
);

56 
mibr¥
.
d©a
 = 
»s_·ylßd
;

58 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ëngth
);

60 
	`kä“
(
mib»q
.
d©a
);

62 ià(
r
 == 0) {

63 
mibr¥
.
d©aL’gth
 = 
rx_Ëngth
;

64 ià(
rx_Ëngth
 == 0) {

65 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

68 
	`¦si_mib_decodeIÁ64
(&
mibr¥
.
d©a
[4], &
»t
);

70 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

73  
»t
;

74 
	}
}

	@ba.c

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"ba.h
"

10 
	~"mgt.h
"

11 
	~"§p.h
"

19 
ušt
 
	gba_mpdu_»Üd”_age_timeout
 = 100;

20 
moduË_·¿m
(
ba_mpdu_»Üd”_age_timeout
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

21 
MODULE_PARM_DESC
(
ba_mpdu_»Üd”_age_timeout
, "Timeout (in ms) before‡ BA frame in Reorder buffer is…assedo upper†ayers");

23 
boŞ
 
	gba_out_of_¿nge_d–ba_’abË
 = 1;

24 
moduË_·¿m
(
ba_out_of_¿nge_d–ba_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

25 
MODULE_PARM_DESC
(
ba_out_of_¿nge_d–ba_’abË
, "Optionorigger DELBA on out of„ange frame (1:ƒnable (default), 0: disable)");

27 
	#ADVANCE_EXPECTED_SN
(
__ba_£ssiÚ_rx
) \

29 
__ba_£ssiÚ_rx
->
ex³ùed_¢
++; \

30 
__ba_£ssiÚ_rx
->
ex³ùed_¢
 &= 0xFFF; \

31 }

	)

33 
	#FREE_BUFFER_SLOT
(
__ba_£ssiÚ_rx
, 
__šdex
) \

35 
__ba_£ssiÚ_rx
->
occup›d_¦Ùs
--; \

36 
__ba_£ssiÚ_rx
->
bufãr
[
__šdex
].
aùive
 = 
çl£
; \

37 }

	)

39 
	$¦si_rx_ba_š™
(
¦si_dev
 *
sdev
)

41 
	`¦si_¥šlock_ü—‹
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

42 
	}
}

44 
¦si_ba_£ssiÚ_rx
 *
	$¦si_rx_ba_®loc_bufãr
(
Ãt_deviû
 *
dev
)

46 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

47 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

48 
¦si_ba_£ssiÚ_rx
 *
bufãr
 = 
NULL
;

49 
i
;

51 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "RX BA buffer…ool status: %d,%d,%d,%d,%d,%d,%d,%d\n",

52 
sdev
->
rx_ba_bufãr_poŞ
[0].
u£d
, sdev->rx_ba_buffer_pool[1].used, sdev->rx_ba_buffer_pool[2].used,

53 
sdev
->
rx_ba_bufãr_poŞ
[3].
u£d
, sdev->rx_ba_buffer_pool[4].used, sdev->rx_ba_buffer_pool[5].used,

54 
sdev
->
rx_ba_bufãr_poŞ
[6].
u£d
, sdev->rx_ba_buffer_pool[7].used);

56 
	`¦si_¥šlock_lock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

57 
i
 = 0; i < 
SLSI_MAX_RX_BA_SESSIONS
; i++) {

58 ià(!
sdev
->
rx_ba_bufãr_poŞ
[
i
].
u£d
) {

59 
sdev
->
rx_ba_bufãr_poŞ
[
i
].
u£d
 = 
Œue
;

60 
bufãr
 = &
sdev
->
rx_ba_bufãr_poŞ
[
i
];

64 
	`¦si_¥šlock_uÆock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

66 ià(!
bufãr
)

67 
	`SLSI_NET_ERR
(
dev
, "No free RX BA buffer\n");

69  
bufãr
;

70 
	}
}

72 
	$¦si_rx_ba_ä“_bufãr
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
tid
)

74 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

75 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

77 
	`¦si_¥šlock_lock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

78 ià(
³”
 &&…“r->
ba_£ssiÚ_rx
[
tid
]) {

79 
³”
->
ba_£ssiÚ_rx
[
tid
]->
u£d
 = 
çl£
;

80 
³”
->
ba_£ssiÚ_rx
[
tid
] = 
NULL
;

82 
	`¦si_¥šlock_uÆock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

84 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "RX BA buffer…ool status: %d,%d,%d,%d,%d,%d,%d,%d\n",

85 
sdev
->
rx_ba_bufãr_poŞ
[0].
u£d
, sdev->rx_ba_buffer_pool[1].used, sdev->rx_ba_buffer_pool[2].used,

86 
sdev
->
rx_ba_bufãr_poŞ
[3].
u£d
, sdev->rx_ba_buffer_pool[4].used, sdev->rx_ba_buffer_pool[5].used,

87 
sdev
->
rx_ba_bufãr_poŞ
[6].
u£d
, sdev->rx_ba_buffer_pool[7].used);

88 
	}
}

93 
	$¦si_ba_´oûss_com¶‘e
(
Ãt_deviû
 *
dev
, 
boŞ
 
ùx_Çpi
)

95 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

96 
sk_buff
 *
skb
;

98 (
skb
 = 
	`skb_dequeue
(&
ndev_vif
->
ba_com¶‘e
)è!ğ
NULL
) {

99 
	`loÿl_bh_di§bË
();

100 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

101 
	`¦si_rx_d©a_d–iv”_skb
(
ndev_vif
->
sdev
, 
dev
, 
skb
, 
ùx_Çpi
);

102 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

103 
	`loÿl_bh_’abË
();

105 
	}
}

107 
	$¦si_ba_sigÇl_´oûss_com¶‘e
(
Ãt_deviû
 *
dev
)

109 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

111 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 1);

112 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


113 
	`¦si_skb_scheduË_wÜk
(&
ndev_vif
->
rx_d©a
);

115 
	}
}

117 
	$ba_add_äame_to_ba_com¶‘e
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
äame_desc
)

119 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

121 ià(
	`¦si_ba_»¶ay_check_²
(
dev
, 
ba_£ssiÚ_rx
, 
äame_desc
)) {

122 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "drop:id=%d sn=%d„eceived PN %pm\n",

123 
äame_desc
->
tid
,

124 
äame_desc
->
¢
,

125 
äame_desc
->
²
);

126 #ifdeà
CONFIG_SCSC_SMAPPER


127 
	`h4_sm­³r_ä“_m­³d_skb
(
äame_desc
->
sigÇl
);

129 
	`kä“_skb
(
äame_desc
->
sigÇl
);

132 
	`skb_queue_
(&
ndev_vif
->
ba_com¶‘e
, 
äame_desc
->
sigÇl
);

133 
	}
}

135 
	$ba_upd©e_ex³ùed_¢
(
Ãt_deviû
 *
dev
,

136 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
)

138 
u32
 
i
, 
j
;

139 
u16
 
g­
;

141 
g­
 = (
¢
 - 
ba_£ssiÚ_rx
->
ex³ùed_¢
) & 0xFFF;

142 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Procûs thäame u°tØÃwƒx³ùed_¢ = %d g­ = %d\n", 
¢
, 
g­
);

144 
j
 = 0; j < 
g­
 && j < 
ba_£ssiÚ_rx
->
bufãr_size
; j++) {

145 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
);

146 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Procûs th¦Ù index = %d\n", 
i
);

147 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

148 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, &ba_£ssiÚ_rx->
bufãr
[
i
]);

149 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Procûs thäam© index = %dƒx³ùed_¢ = %d\n", 
i
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

150 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

152 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Em±y slÙ‡ˆšdex = %d\n", 
i
);

154 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

156 
ba_£ssiÚ_rx
->
ex³ùed_¢
 = 
¢
;

157 
	}
}

159 
	$ba_com¶‘e_»ady_£qu’û
(
Ãt_deviû
 *
dev
,

160 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

162 
i
;

164 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
);

165 
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

166 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, &ba_£ssiÚ_rx->
bufãr
[
i
]);

167 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "Completed stored frame (expected_sn=%d)‡t i = %d\n",

168 
ba_£ssiÚ_rx
->
ex³ùed_¢
, 
i
);

169 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

170 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

171 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
);

173 
	}
}

175 
	$ba_süŞl_wšdow
(
Ãt_deviû
 *
dev
,

176 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
)

178 ià(((
¢
 - 
ba_£ssiÚ_rx
->
ex³ùed_¢
è& 0xFFFè<ğ
BA_WINDOW_BOUNDARY
) {

179 
	`ba_upd©e_ex³ùed_¢
(
dev
, 
ba_£ssiÚ_rx
, 
¢
);

180 
	`ba_com¶‘e_»ady_£qu’û
(
dev
, 
ba_£ssiÚ_rx
);

182 
	}
}

184 
	$ba_d–‘e_ba_Ú_Şd_äame
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

185 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
)

187 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

188 
§p_drv_ma_to_mlme_d–ba_»q
 *
d–ba_»q
;

189 
sk_buff
 *
skb
 = 
NULL
;

191 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "¢=%d\n", 
¢
);

193 
skb
 = 
	`®loc_skb
((
§p_drv_ma_to_mlme_d–ba_»q
), 
GFP_ATOMIC
);

195 ià(
	`WARN_ON
(!
skb
))

198 
ba_£ssiÚ_rx
->
şosšg
 = 
Œue
;

199 
	`¦si_skb_cb_š™
(
skb
)->
sig_Ëngth
 = (
§p_drv_ma_to_mlme_d–ba_»q
);

200 
	`¦si_skb_cb_g‘
(
skb
)->
d©a_Ëngth
 = (
§p_drv_ma_to_mlme_d–ba_»q
);

202 
d–ba_»q
 = (
§p_drv_ma_to_mlme_d–ba_»q
 *)
	`skb_put
(
skb
, (sap_drv_ma_to_mlme_delba_req));

203 
d–ba_»q
->
h—d”
.
id
 = 
	`ıu_to_Ë16
(
SAP_DRV_MA_TO_MLME_DELBA_REQ
);

204 
d–ba_»q
->
h—d”
.
»ûiv”_pid
 = 0;

205 
d–ba_»q
->
h—d”
.
£nd”_pid
 = 0;

206 
d–ba_»q
->
h—d”
.
fw_»ã»nû
 = 0;

207 
d–ba_»q
->
vif
 = 
ndev_vif
->
iâum
;

209 
	`memıy
(
d–ba_»q
->
³”_q¡a_add»ss
, 
³”
->
add»ss
, 
ETH_ALEN
);

210 
d–ba_»q
->
£qu’û_numb”
 = 
¢
;

211 
d–ba_»q
->
u£r_´iÜ™y
 = 
ba_£ssiÚ_rx
->
tid
;

212 
d–ba_»q
->
»asÚ
 = 
FAPI_REASONCODE_OUT_OF_RANGE_SEQUENCE_NUMBER
;

213 
d–ba_»q
->
dœeùiÚ
 = 
FAPI_DIRECTION_RECEIVE
;

216 
	`¦si_rx_’queue_Ãtdev_mlme
(
ndev_vif
->
sdev
, 
skb
, 
	`çpi_g‘_vif
(skb));

217 
	}
}

219 
	$ba_cÚsume_äame_Ü_g‘_bufãr_šdex
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

220 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
, 
¦si_ba_äame_desc
 *
äame_desc
, 
boŞ
 *
¡İ_tim”
)

222 
i
;

223 
u16
 
¢_‹mp
;

224 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


225 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

228 *
¡İ_tim”
 = 
çl£
;

230 ià(((
¢
 - 
ba_£ssiÚ_rx
->
ex³ùed_¢
è& 0xFFFè<ğ
BA_WINDOW_BOUNDARY
) {

232 ià(!
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
)

233 
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
 = 
Œue
;

235 
¢_‹mp
 = 
ba_£ssiÚ_rx
->
ex³ùed_¢
 + ba_£ssiÚ_rx->
bufãr_size
;

236 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "New f¿me: sn=%d\n", 
¢
);

238 ià(!(((
¢
 - 
¢_‹mp
è& 0xFFFè> 
BA_WINDOW_BOUNDARY
)) {

239 
u16
 
Ãw_ex³ùed_¢
;

241 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX_BA
, "Frame is out of window\n");

242 
¢_‹mp
 = (
¢
 - 
ba_£ssiÚ_rx
->
bufãr_size
) & 0xFFF;

243 ià(
ba_£ssiÚ_rx
->
tim”_Ú
)

244 *
¡İ_tim”
 = 
Œue
;

245 
Ãw_ex³ùed_¢
 = (
¢_‹mp
 + 1) & 0xFFF;

246 
	`ba_upd©e_ex³ùed_¢
(
dev
, 
ba_£ssiÚ_rx
, 
Ãw_ex³ùed_¢
);

249 
i
 = -1;

250 ià(
¢
 =ğ
ba_£ssiÚ_rx
->
ex³ùed_¢
) {

251 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "¢ = ba_£ssiÚ_rx->ex³ùed_¢ = %d\n", 
¢
);

252 ià(
ba_£ssiÚ_rx
->
tim”_Ú
)

253 *
¡İ_tim”
 = 
Œue
;

254 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

255 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, 
äame_desc
);

257 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, 
¢
);

258 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "¢ (%dè!ğba_£ssiÚ_rx->ex³ùed_¢(%d), i = %d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
, 
i
);

259 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

260 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "ä“ f¿m© i = %d\n", 
i
);

261 
i
 = -1;

262 #ifdeà
CONFIG_SCSC_SMAPPER


263 
	`h4_sm­³r_ä“_m­³d_skb
(
äame_desc
->
sigÇl
);

265 
	`kä“_skb
(
äame_desc
->
sigÇl
);

268 ià(!
	`IS_SN_LESS
(
¢
, 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
))

269 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
 = 
¢
;

271 
i
 = -1;

272 ià(!
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
) {

273 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "äambefÜs¢,…as ™ up: sn=%d\n", 
¢
);

274 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, 
äame_desc
);

276 
äame_desc
->
æag_Şd_¢
 = 
Œue
;

277 ià(
	`¦si_is_tdls_³”
(
dev
, 
³”
)) {

284 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "tdls: fÜw¬d old f¿me: sn=%d,ƒx³ùed_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

285 
äame_desc
->
æag_Şd_tdls
 = 
Œue
;

286 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, 
äame_desc
);

294 ià(
	`IS_SN_LESS
(
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
, ((
¢
 + ba_£ssiÚ_rx->
bufãr_size
) & 0xFFF))) {

295 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Şd f¿me, buˆ¡Èš wšdow: sn=%d, highe¡_»ûived_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
);

296 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, 
äame_desc
);

298 
	`SLSI_NET_WARN
(
dev
, "Şd f¿me, drİ: sn=%d,ƒx³ùed_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

299 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


300 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
)

301 
	`¦si_fl_’hªûd_¬p_out_of_Üd”_drİ_couÁ”
(
ndev_vif
, 
äame_desc
->
sigÇl
);

303 #ifdeà
CONFIG_SCSC_SMAPPER


304 
	`h4_sm­³r_ä“_m­³d_skb
(
äame_desc
->
sigÇl
);

306 
	`kä“_skb
(
äame_desc
->
sigÇl
);

307 ià(
ba_out_of_¿nge_d–ba_’abË
) {

308 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "a ¨couÁ”m—su»Ø»-sync, d–‘BA: sn=%d,ƒx³ùed_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

309 ià(!
ba_£ssiÚ_rx
->
şosšg
)

310 
	`ba_d–‘e_ba_Ú_Şd_äame
(
dev
, 
³”
, 
ba_£ssiÚ_rx
, 
¢
);

316  
i
;

317 
	}
}

319 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


320 
	$¦si_ba_agšg_timeout_hªdËr
(
tim”_li¡
 *
t
)

322 
	$¦si_ba_agšg_timeout_hªdËr
(
d©a
)

325 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


326 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
 = 
	`äom_tim”
(ba_£ssiÚ_rx, 
t
, 
ba_age_tim”
);

328 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
 = (¦si_ba_£ssiÚ_rx *)
d©a
;

330 
u8
 
i
, 
j
;

331 
u8
 
g­
 = 1;

332 
u16
 
‹mp_¢
;

333 
Ãt_deviû
 *
dev
 = 
ba_£ssiÚ_rx
->dev;

334 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

336 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "\n");

338 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

340 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

342 ià(
ba_£ssiÚ_rx
->
aùive
 && ba_£ssiÚ_rx->
occup›d_¦Ùs
) {

347 
‹mp_¢
 = (
ba_£ssiÚ_rx
->
ex³ùed_¢
 + 1) & 0xFFF;

348 
i
 = 0; i < 
MAX_BA_BUFFER_SIZE
; i++) {

349 
ba_£ssiÚ_rx
->
ba_wšdow
[
i
].
£Á
 = 
çl£
;

350 
ba_£ssiÚ_rx
->
ba_wšdow
[
i
].
¢
 = 0;

353 
j
 = 0; j < 
ba_£ssiÚ_rx
->
bufãr_size
; j++) {

354 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, 
‹mp_¢
);

356 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

357 
g­
--)

358 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

360 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Com¶‘ed stÜed f¿mÓx³ùed_¢=%dè© i = %d\n", 
ba_£ssiÚ_rx
->
ex³ùed_¢
, 
i
);

361 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, &ba_£ssiÚ_rx->
bufãr
[
i
]);

362 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

363 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

364 
	`ba_com¶‘e_»ady_£qu’û
(
dev
, 
ba_£ssiÚ_rx
);

365 
ba_£ssiÚ_rx
->
ba_timeouts
++;

369 
‹mp_¢
 = (temp_sn + 1) & 0xFFF;

370 
g­
++;

375 ià(
ba_£ssiÚ_rx
->
aùive
 && ba_£ssiÚ_rx->
occup›d_¦Ùs
) {

376 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer start\n");

377 
	`mod_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
ba_mpdu_»Üd”_age_timeout
));

378 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
Œue
;

381 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


382 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

384 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

387 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

388 
	}
}

390 
	$¦si_ba_´oûss_äame
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

391 
sk_buff
 *
skb
, 
u16
 
£qu’û_numb”
, u16 
tid
)

393 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

394 
i
;

395 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
 = 
³”
->ba_£ssiÚ_rx[
tid
];

396 
¦si_ba_äame_desc
 
äame_desc
;

397 
boŞ
 
¡İ_tim”
 = 
çl£
;

399 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "GÙ f¿me(¢=%d)\n", 
£qu’û_numb”
);

401 ià(
	`WARN_ON
(
tid
 > 
FAPI_PRIORITY_QOS_UP7
)) {

402 
	`SLSI_NET_ERR
(
dev
, "tid=%d\n", 
tid
);

403  -
EINVAL
;

406 ià(!
ba_£ssiÚ_rx
)

407  -
EINVAL
;

409 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

411 ià(!
ba_£ssiÚ_rx
->
aùive
) {

412 
	`SLSI_NET_ERR
(
dev
, "No BA sessionƒxists\n");

413 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

414  -
EINVAL
;

417 
äame_desc
.
sigÇl
 = 
skb
;

418 
äame_desc
.
tid
 =id;

419 
äame_desc
.
¢
 = 
£qu’û_numb”
;

420 
äame_desc
.
aùive
 = 
Œue
;

421 
	`¦si_ba_»¶ay_g‘_²
(
dev
, 
³”
, 
skb
, &
äame_desc
);

423 
i
 = 
	`ba_cÚsume_äame_Ü_g‘_bufãr_šdex
(
dev
, 
³”
, 
ba_£ssiÚ_rx
, 
£qu’û_numb”
, &
äame_desc
, &
¡İ_tim”
);

424 ià(
i
 >= 0) {

425 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "StÜäame(¢=%dè© i = %d\n", 
£qu’û_numb”
, 
i
);

426 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

427 
	`SLSI_NET_WARN
(
dev
, "drİ du¶iÿ‹ f¿m(¢=%dè© i = %d\n", 
£qu’û_numb”
, 
i
);

428 #ifdeà
CONFIG_SCSC_SMAPPER


429 
	`h4_sm­³r_ä“_m­³d_skb
(
äame_desc
.
sigÇl
);

431 
	`kä“_skb
(
äame_desc
.
sigÇl
);

432 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

435 
ba_£ssiÚ_rx
->
bufãr
[
i
] = 
äame_desc
;

436 
ba_£ssiÚ_rx
->
occup›d_¦Ùs
++;

438 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "F¿mcÚsumed - sÀğ%d\n", 
£qu’û_numb”
);

441 
	`ba_com¶‘e_»ady_£qu’û
(
dev
, 
ba_£ssiÚ_rx
);

457 ià(!
ba_£ssiÚ_rx
->
tim”_Ú
) {

458 ià(
ba_£ssiÚ_rx
->
occup›d_¦Ùs
) {

459 
¡İ_tim”
 = 
çl£
;

460 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer start\n");

461 
	`mod_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
ba_mpdu_»Üd”_age_timeout
));

462 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
Œue
;

464 } ià(!
ba_£ssiÚ_rx
->
occup›d_¦Ùs
) {

465 
¡İ_tim”
 = 
Œue
;

466 } ià(
¡İ_tim”
) {

467 
¡İ_tim”
 = 
çl£
;

468 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer„estart\n");

469 
	`mod_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
ba_mpdu_»Üd”_age_timeout
));

470 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
Œue
;

473 ià(
¡İ_tim”
) {

474 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

475 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

476 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer stop\n");

477 
	`d–_tim”_sync
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

479 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

481 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

483 
	}
}

485 
boŞ
 
	$¦si_ba_check
(
¦si_³”
 *
³”
, 
u16
 
tid
)

487 ià(
tid
 > 
FAPI_PRIORITY_QOS_UP7
)

488  
çl£
;

489 ià(!
³”
->
ba_£ssiÚ_rx
[
tid
])

490  
çl£
;

492  
³”
->
ba_£ssiÚ_rx
[
tid
]->
aùive
;

493 
	}
}

495 
	$__¦si_rx_ba_¡İ
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

497 
u8
 
i
, 
j
;

499 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "Stİpšg BA sessiÚ:id = %d\n", 
ba_£ssiÚ_rx
->
tid
);

501 ià(
	`WARN_ON
(!
ba_£ssiÚ_rx
->
aùive
)) {

502 
	`SLSI_NET_ERR
(
dev
, "No BA sessionƒxists\n");

506 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
), 
j
 = 0;

507 
j
 < 
ba_£ssiÚ_rx
->
bufãr_size
; 
i
++, j++) {

508 
i
 %ğ
ba_£ssiÚ_rx
->
bufãr_size
;

509 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

510 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
ba_£ssiÚ_rx
, &ba_£ssiÚ_rx->
bufãr
[
i
]);

511 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Com¶‘ed stÜed f¿m© i = %d\n", 
i
);

512 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

516 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


517 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

519 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

522 
ba_£ssiÚ_rx
->
aùive
 = 
çl£
;

523 
	}
}

525 
	$¦si_rx_ba_¡İ_lock_h–d
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

527 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

529 
	`__¦si_rx_ba_¡İ
(
dev
, 
ba_£ssiÚ_rx
);

530 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

531 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

532 
	`d–_tim”_sync
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

533 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

534 
	}
}

536 
	$¦si_rx_ba_¡İ_lock_unh–d
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

538 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

540 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

541 
	`__¦si_rx_ba_¡İ
(
dev
, 
ba_£ssiÚ_rx
);

542 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

543 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

544 
	`d–_tim”_sync
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

545 
	}
}

547 
	$¦si_rx_ba_¡İ_®l
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

549 
i
;

551 
i
 = 0; i < 
NUM_BA_SESSIONS_PER_PEER
; i++)

552 ià(
³”
->
ba_£ssiÚ_rx
[
i
] &&…“r->ba_£ssiÚ_rx[i]->
aùive
) {

553 
	`¦si_rx_ba_¡İ_lock_unh–d
(
dev
, 
³”
->
ba_£ssiÚ_rx
[
i
]);

554 
	`¦si_rx_ba_ä“_bufãr
(
dev
, 
³”
, 
i
);

556 
	}
}

558 
	$¦si_rx_ba_¡¬t
(
Ãt_deviû
 *
dev
,

559 
¦si_³”
 *
³”
,

560 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
,

561 
u16
 
tid
, u16 
bufãr_size
, u16 
¡¬t_¢
)

563 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

565 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "Requesto start‡‚ew BA sessionid=%d buffer_size=%d start_sn=%d\n",

566 
tid
, 
bufãr_size
, 
¡¬t_¢
);

568 ià(
	`WARN_ON
((!
bufãr_size
è|| (bufãr_siz> 
SLSI_BA_BUFFER_SIZE_MAX
))) {

569 
	`SLSI_NET_ERR
(
dev
, "Inv®id wšdow size: bufãr_size=%d\n", 
bufãr_size
);

570  -
EINVAL
;

573 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

575 ià(
ba_£ssiÚ_rx
->
aùive
) {

576 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "BA session‡lreadyƒxists\n");

578 ià((
ba_£ssiÚ_rx
->
bufãr_size
 == buffer_size) &&

579 (
ba_£ssiÚ_rx
->
ex³ùed_¢
 =ğ
¡¬t_¢
)) {

580 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
,

582 
tid
);

583 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

586 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "P¬am‘” dÚ'ˆm©ch sØ¡İhexi¡šg BA sessiÚ:id=%d\n", 
tid
);

587 
	`¦si_rx_ba_¡İ_lock_h–d
(
dev
, 
ba_£ssiÚ_rx
);

590 
ba_£ssiÚ_rx
->
dev
 = dev;

591 
ba_£ssiÚ_rx
->
³”
 =…eer;

592 
ba_£ssiÚ_rx
->
bufãr_size
 = buffer_size;

593 
ba_£ssiÚ_rx
->
¡¬t_¢
 = start_sn;

594 
ba_£ssiÚ_rx
->
ex³ùed_¢
 = 
¡¬t_¢
;

595 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
 = 0;

596 
ba_£ssiÚ_rx
->
şosšg
 = 
çl£
;

597 
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
 = 
çl£
;

598 
ba_£ssiÚ_rx
->
tid
 =id;

599 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

600 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


601 
	`tim”_£tup
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
¦si_ba_agšg_timeout_hªdËr
, 0);

603 
ba_£ssiÚ_rx
->
ba_age_tim”
.
funùiÚ
 = 
¦si_ba_agšg_timeout_hªdËr
;

604 
ba_£ssiÚ_rx
->
ba_age_tim”
.
d©a
 = ()ba_session_rx;

605 
	`š™_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

608 
ba_£ssiÚ_rx
->
ba_timeouts
 = 0;

609 
ba_£ssiÚ_rx
->
ba_drİs_Şd
 = 0;

610 
ba_£ssiÚ_rx
->
ba_drİs_»¶ay
 = 0;

612 
ba_£ssiÚ_rx
->
aùive
 = 
Œue
;

613 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "Started‡‚ew BA sessionid=%d buffer_size=%d start_sn=%d\n",

614 
tid
, 
bufãr_size
, 
¡¬t_¢
);

616 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

617 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

620 
	}
}

622 
	$¦si_ba_upd©e_wšdow
(
Ãt_deviû
 *
dev
,

623 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
£qu’û_numb”
)

625 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

627 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

629 ià(
	`WARN_ON
(!
ba_£ssiÚ_rx
->
aùive
)) {

630 
	`SLSI_NET_ERR
(
dev
, "No BA sessionƒxists\n");

631 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

635 
	`ba_süŞl_wšdow
(
dev
, 
ba_£ssiÚ_rx
, 
£qu’û_numb”
);

636 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


637 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

639 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

641 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

642 
	}
}

644 
	$¦si_hªdË_blockack
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

645 
u16
 
»asÚ_code
, u16 
u£r_´iÜ™y
, u16 
bufãr_size
, u16 
£qu’û_numb”
)

647 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
;

649 ià(
	`WARN_ON
(
u£r_´iÜ™y
 > 
FAPI_PRIORITY_QOS_UP7
)) {

650 
	`SLSI_NET_ERR
(
dev
, "Inv®id u£r_´iÜ™y=%d\n", 
u£r_´iÜ™y
);

654 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "reason_code:%d, user_priority:%d, buffer_size:%d, sequence_num:%d)\n",

655 
»asÚ_code
,

656 
u£r_´iÜ™y
,

657 
bufãr_size
,

658 
£qu’û_numb”
);

660 
ba_£ssiÚ_rx
 = 
³”
->ba_£ssiÚ_rx[
u£r_´iÜ™y
];

662 
»asÚ_code
) {

663 
FAPI_REASONCODE_START
:

664 ià(!
³”
->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
])

665 
³”
->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
] = 
	`¦si_rx_ba_®loc_bufãr
(
dev
);

667 ià(
³”
->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
])

668 ià(
	`¦si_rx_ba_¡¬t
(
dev
, 
³”
,…“r->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
], u£r_´iÜ™y, 
bufãr_size
, 
£qu’û_numb”
) != 0)

669 
	`¦si_rx_ba_ä“_bufãr
(
dev
, 
³”
, 
u£r_´iÜ™y
);

671 
FAPI_REASONCODE_END
:

672 ià(
ba_£ssiÚ_rx
) {

673 
	`¦si_rx_ba_¡İ_lock_unh–d
(
dev
, 
ba_£ssiÚ_rx
);

674 
	`¦si_rx_ba_ä“_bufãr
(
dev
, 
³”
, 
u£r_´iÜ™y
);

677 
FAPI_REASONCODE_UNSPECIFIED_REASON
:

678 ià(
ba_£ssiÚ_rx
)

679 
	`¦si_ba_upd©e_wšdow
(
dev
, 
ba_£ssiÚ_rx
, 
£qu’û_numb”
);

682 
	`SLSI_NET_ERR
(
dev
, "Inv®id v®ue:„—sÚ_code=%d\n", 
»asÚ_code
);

685 
	}
}

	@ba.h

7 #iâdeà
__SLSI_BA_H__


8 
	#__SLSI_BA_H__


	)

10 
	~"dev.h
"

12 
	#BA_WINDOW_BOUNDARY
 2048

	)

14 
	#SN_TO_INDEX
(
__ba_£ssiÚ_rx
, 
__¢
è(((__¢ - __ba_£ssiÚ_rx->
¡¬t_¢
è& 0xFFFè% __ba_£ssiÚ_rx->
bufãr_size
)

	)

16 
	#IS_SN_LESS
(
¢1
, 
¢2
è((((¢1è- (¢2)è& 0xFFFè> 
BA_WINDOW_BOUNDARY
)

	)

18 
¦si_hªdË_blockack
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

19 
u16
 
»asÚ_code
, u16 
u£r_´iÜ™y
, u16 
bufãr_size
, u16 
£qu’û_numb”
);

21 
¦si_ba_´oûss_äame
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

22 
sk_buff
 *
skb
, 
u16
 
£qu’û_numb”
, u16 
tid
);

24 
¦si_ba_upd©e_wšdow
(
Ãt_deviû
 *
dev
,

25 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
£qu’û_numb”
);

27 
¦si_ba_´oûss_com¶‘e
(
Ãt_deviû
 *
dev
, 
boŞ
 
ùx_Çpi
);

29 
boŞ
 
¦si_ba_check
(
¦si_³”
 *
³”
, 
u16
 
tid
);

31 
¦si_rx_ba_¡İ_®l
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

33 
¦si_rx_ba_š™
(
¦si_dev
 *
sdev
);

36 
¦si_ba_»¶ay_»£t_²
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

38 
¦si_ba_»¶ay_¡Üe_²
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
);

40 
¦si_ba_»¶ay_g‘_²
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
, 
¦si_ba_äame_desc
 *
äame_desc
);

42 
boŞ
 
¦si_ba_»¶ay_check_²
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
äame_desc
);

	@ba_replay.c

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"ba.h
"

11 
boŞ
 
	gba_»¶ay_check_’abË
 = 
çl£
;

12 
moduË_·¿m
(
ba_»¶ay_check_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

13 
MODULE_PARM_DESC
(
ba_»¶ay_check_’abË
, "Replay check (1:ƒnable (default), 0: disable)");

15 
ušt
 
	gba_»¶ay_check_İtiÚ
 = 1;

16 
moduË_·¿m
(
ba_»¶ay_check_İtiÚ
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

17 
MODULE_PARM_DESC
(
ba_»¶ay_check_İtiÚ
, "Replay check optionype (1 (default), 2");

19 
boŞ
 
ba_»¶ay_check_İtiÚ_1
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
äame_desc
);

20 
boŞ
 
ba_»¶ay_check_İtiÚ_2
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
äame_desc
);

22 
	sba_»¶ay_check_ty³
 {

23 cÚ¡ 
u8
 
	mİtiÚ_num
;

24 
boŞ
 (*
»¶ay_check_â
)(
Ãt_deviû
 *
	mdev
, 
¦si_ba_£ssiÚ_rx
 *
	mba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
	mäame_desc
);

51 cÚ¡ 
ba_»¶ay_check_ty³
 
	g»¶ay_check_ty³s
[] = {

52 { 1, 
ba_»¶ay_check_İtiÚ_1
 },

53 { 2, 
ba_»¶ay_check_İtiÚ_2
 }

56 
	$¦si_ba_»¶ay_»£t_²
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

58 
u8
 
i
 = 0;

60 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "»£ˆPN fÜ…“¸%pM\n", 
³”
->
add»ss
);

61 
i
 = 0; i <ğ
FAPI_PRIORITY_QOS_UP7
; i++)

62 
	`mem£t
(
³”
->
rx_²
[
i
], 0, 
SLSI_RX_PN_LEN
);

63 
	}
}

65 
	$¦si_ba_»¶ay_g‘_²
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
, 
¦si_ba_äame_desc
 *
äame_desc
)

67 
¦si_skb_cb
 *
skb_cb
;

69 ià(
ba_»¶ay_check_’abË
) {

70 
skb_cb
 = (
¦si_skb_cb
 *)
skb
->
cb
;

72 ià(
skb_cb
->
is_ch”ed
) {

73 
äame_desc
->
²
[0] = 
skb_cb
->
keyrsc
[7];

74 
äame_desc
->
²
[1] = 
skb_cb
->
keyrsc
[6];

75 
äame_desc
->
²
[2] = 
skb_cb
->
keyrsc
[5];

76 
äame_desc
->
²
[3] = 
skb_cb
->
keyrsc
[4];

77 
äame_desc
->
²
[4] = 
skb_cb
->
keyrsc
[1];

78 
äame_desc
->
²
[5] = 
skb_cb
->
keyrsc
[0];

79 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "received:id=%d sn=%d…revious PN %pm„eceived PN %pm\n",

80 
äame_desc
->
tid
,

81 
äame_desc
->
¢
,

82 
³”
->
rx_²
[
äame_desc
->
tid
],

83 
äame_desc
->
²
);

86 
	}
}

88 
	$¦si_ba_»¶ay_¡Üe_²
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
)

90 
¦si_skb_cb
 *
skb_cb
;

92 ià(
ba_»¶ay_check_’abË
) {

93 
skb_cb
 = (
¦si_skb_cb
 *)
skb
->
cb
;

95 ià(
skb_cb
->
is_ch”ed
) {

96 ià(
skb_cb
->
tid
 <ğ
FAPI_PRIORITY_QOS_UP7
) {

97 
³”
->
rx_²
[
skb_cb
->
tid
][0] = skb_cb->
keyrsc
[7];

98 
³”
->
rx_²
[
skb_cb
->
tid
][1] = skb_cb->
keyrsc
[6];

99 
³”
->
rx_²
[
skb_cb
->
tid
][2] = skb_cb->
keyrsc
[5];

100 
³”
->
rx_²
[
skb_cb
->
tid
][3] = skb_cb->
keyrsc
[4];

101 
³”
->
rx_²
[
skb_cb
->
tid
][4] = skb_cb->
keyrsc
[1];

102 
³”
->
rx_²
[
skb_cb
->
tid
][5] = skb_cb->
keyrsc
[0];

104 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "store:id=%d sn=%d„eceived PN %pm\n",

105 
skb_cb
->
tid
,

106 
skb_cb
->
£q_num
,

107 
³”
->
rx_²
[
skb_cb
->
tid
]);

111 
	}
}

113 
boŞ
 
	$ba_»¶ay_check_İtiÚ_1
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
äame_desc
)

115 
¦si_³”
 *
³”
 = 
ba_£ssiÚ_rx
->peer;

117 ià(
äame_desc
->
æag_Şd_¢
) {

118 
	`SLSI_NET_WARN
(
dev
, "Şd f¿me, drİ: sn=%d,ƒx³ùed_¢=%d\n", 
äame_desc
->
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

119 
ba_£ssiÚ_rx
->
ba_drİs_Şd
++;

120  
Œue
;

123 ià(
	`memcmp
(
äame_desc
->
²
, 
³”
->
rx_²
[äame_desc->
tid
], 
SLSI_RX_PN_LEN
) <= 0) {

124 
	`SLSI_NET_WARN
(
dev
, "replay detected:id=%d sn=%d…revious PN %pm„eceived PN %pm\n",

125 
äame_desc
->
tid
,

126 
äame_desc
->
¢
,

127 
³”
->
rx_²
[
äame_desc
->
tid
],

128 
äame_desc
->
²
);

130 
ba_£ssiÚ_rx
->
ba_drİs_»¶ay
++;

131  
Œue
;

134 
	`memıy
(
³”
->
rx_²
[
äame_desc
->
tid
], f¿me_desc->
²
, 
SLSI_RX_PN_LEN
);

135  
çl£
;

136 
	}
}

138 
boŞ
 
	$ba_»¶ay_check_İtiÚ_2
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
äame_desc
)

140 
¦si_³”
 *
³”
 = 
ba_£ssiÚ_rx
->peer;

141 
u8
 
i
 = 0;

143 ià(!
äame_desc
->
æag_Şd_¢
) {

144 ià(
	`memcmp
(
äame_desc
->
²
, 
³”
->
rx_²
[äame_desc->
tid
], 
SLSI_RX_PN_LEN
) <= 0) {

145 
	`SLSI_NET_WARN
(
dev
, "replay detected:id=%d sn=%d…revious PN %pm„eceived PN %pm\n",

146 
äame_desc
->
tid
,

147 
äame_desc
->
¢
,

148 
³”
->
rx_²
[
äame_desc
->
tid
],

149 
äame_desc
->
²
);

151 
ba_£ssiÚ_rx
->
ba_drİs_»¶ay
++;

152  
Œue
;

155 
	`memıy
(
³”
->
rx_²
[
äame_desc
->
tid
], f¿me_desc->
²
, 
SLSI_RX_PN_LEN
);

156 
ba_£ssiÚ_rx
->
ba_wšdow
[
i
].
¢
 = 
äame_desc
->sn;

157 
ba_£ssiÚ_rx
->
ba_wšdow
[
i
].
£Á
 = 
Œue
;

158  
çl£
;

162 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, 
äame_desc
->
¢
);

163 ià(
ba_£ssiÚ_rx
->
ba_wšdow
[
i
].
£Á
) {

164 
	`SLSI_NET_WARN
(
dev
, "duplicate:id=%d sn=%d highest_sn=%d,…revious PN %pm„eceived PN %pm\n",

165 
äame_desc
->
tid
,

166 
äame_desc
->
¢
,

167 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
,

168 
³”
->
rx_²
[
äame_desc
->
tid
],

169 
äame_desc
->
²
);

171 
ba_£ssiÚ_rx
->
ba_drİs_Şd
++;

172  
Œue
;

176 ià(
	`IS_SN_LESS
(
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
, 
äame_desc
->
¢
)) {

178 ià(
	`memcmp
(
äame_desc
->
²
, 
³”
->
rx_²
[äame_desc->
tid
], 
SLSI_RX_PN_LEN
) <= 0) {

179 
	`SLSI_NET_WARN
(
dev
, "replay detected:id=%d sn=%d,…revious PN %pm„eceived PN %pm\n",

180 
äame_desc
->
tid
,

181 
äame_desc
->
¢
,

182 
³”
->
rx_²
[
äame_desc
->
tid
],

183 
äame_desc
->
²
);

185 
ba_£ssiÚ_rx
->
ba_drİs_»¶ay
++;

186  
Œue
;

190 ià(
	`memcmp
(
äame_desc
->
²
, 
³”
->
rx_²
[äame_desc->
tid
], 
SLSI_RX_PN_LEN
) >= 0) {

191 
	`SLSI_NET_WARN
(
dev
, "replay detected:id=%d sn=%d,…revious PN %pm„eceived PN %pm\n",

192 
äame_desc
->
tid
,

193 
äame_desc
->
¢
,

194 
³”
->
rx_²
[
äame_desc
->
tid
],

195 
äame_desc
->
²
);

197 
ba_£ssiÚ_rx
->
ba_drİs_»¶ay
++;

198  
Œue
;

203 
ba_£ssiÚ_rx
->
ba_wšdow
[
i
].
¢
 = 
äame_desc
->sn;

204 
ba_£ssiÚ_rx
->
ba_wšdow
[
i
].
£Á
 = 
Œue
;

206  
çl£
;

207 
	}
}

209 
boŞ
 
	$¦si_ba_»¶ay_check_²
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
¦si_ba_äame_desc
 *
äame_desc
)

211 
¦si_skb_cb
 *
skb_cb
;

212 
u8
 
i
 = 0;

213 
boŞ
 
»t
 = 
çl£
;

215 ià(!
ba_»¶ay_check_’abË
)

216  
çl£
;

218 ià(
äame_desc
->
æag_Şd_tdls
)

219  
çl£
;

221 
skb_cb
 = (
¦si_skb_cb
 *)
äame_desc
->
sigÇl
->
cb
;

223 ià(!
skb_cb
->
is_ch”ed
)

224  
çl£
;

226 
i
 = 0; i < 
	`ARRAY_SIZE
(
»¶ay_check_ty³s
); i++) {

227 ià(
»¶ay_check_ty³s
[
i
].
İtiÚ_num
 =ğ
ba_»¶ay_check_İtiÚ
) {

228 
»t
 = 
»¶ay_check_ty³s
[
i
].
	`»¶ay_check_â
(
dev
, 
ba_£ssiÚ_rx
, 
äame_desc
);

231  
»t
;

232 
	}
}

	@cac.c

7 
	~"ÿc.h
"

9 
ÿc_t¥ec
 *
	gt¥ec_li¡
;

10 
	gt¥ec_li¡_Ãxt_id
;

11 
u8
 
	gdŸlog_tok’_Ãxt
;

14 
t¥ec_f›ld
 
	gt¥ec_f›lds
[] = {

24 { "nomš®_msdu_size", 0, 0, 2, 
OFFSETOF
(
nomš®_msdu_size
) },

25 { "max_msdu_size", 0, 0, 2, 
OFFSETOF
(
maximum_msdu_size
) },

26 { "mš_£rviû_š‹rv®", 0, 0, 4, 
OFFSETOF
(
mšimum_£rviû_š‹rv®
) },

27 { "max_£rviû_š‹rv®", 0, 0, 4, 
OFFSETOF
(
maximum_£rviû_š‹rv®
) },

28 { "šaùiv™y_š‹rv®", 0, 0, 4, 
OFFSETOF
(
šaùiv™y_š‹rv®
) },

29 { "su¥’siÚ_š‹rv®", 0, 0, 4, 
OFFSETOF
(
su¥’siÚ_š‹rv®
) },

30 { "£rviû_¡¬t_time", 0, 0, 4, 
OFFSETOF
(
£rviû_¡¬t_time
) },

31 { "mš_d©a_¿‹", 0, 0, 4, 
OFFSETOF
(
mšimum_d©a_¿‹
) },

32 { "m—n_d©a_¿‹", 0, 0, 4, 
OFFSETOF
(
m—n_d©a_¿‹
) },

33 { "³ak_d©a_¿‹", 0, 0, 4, 
OFFSETOF
(
³ak_d©a_¿‹
) },

34 { "max_bur¡_size", 0, 0, 4, 
OFFSETOF
(
maximum_bur¡_size
) },

35 { "d–ay_bound", 0, 0, 4, 
OFFSETOF
(
d–ay_bound
) },

36 { "mš_phy_¿‹", 0, 0, 4, 
OFFSETOF
(
mšimum_phy_¿‹
) },

38 
OFFSETOF
(
su½lus_bªdwidth_®lowªû
) },

39 { "medium_time", 0, 0, 2, 
OFFSETOF
(
medium_time
) },

43 cÚ¡ 
u8
 
	gTSRS_OUI_TYPE
[] = { 0x00, 0x40, 0x96, 0x08 };

44 cÚ¡ 
u8
 
	gEBW_OUI_TYPE
[] = { 0x00, 0x40, 0x96, 0x0F };

46 cÚ¡ 
	gNUM_TSPEC_FIELDS
 = (
t¥ec_f›lds
è/ (
t¥ec_f›ld
);

47 
u32
 
	g´evious_msdu_liãtime
 = 
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
;

48 
u8
 
	gccx_¡©us
 = 
BSS_CCX_DISABLED
;

50 
ÿc_£t_ric_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
);

51 
ÿc_g‘_rde_t¥ec_›
(
¦si_dev
 *
sdev
, 
u8
 *
assoc_r¥_›
, 
assoc_r¥_›_Ën
, cÚ¡ u8 **
t¥ec_›_¬r
);

60 
ÿc_t¥ec
 *
	$fšd_t¥ec_’Œy
(
id
, 
acû±ed
)

62 
ÿc_t¥ec
 *
™r
;

64 
™r
 = 
t¥ec_li¡
;

65 
™r
 !ğ
NULL
) {

66 ià((
™r
->
id
 =ğidè&& (™r->
acû±ed
 ==‡ccepted))

68 
™r
 = iŒ->
Ãxt
;

70  
™r
;

71 
	}
}

81 
	$ÿc_qu”y_t¥ec_f›ld
(
¦si_dev
 *
sdev
, 
ÿc_t¥ec
 *
’Œy
, cÚ¡ *
f›ld
, 
u32
 *
v®ue
)

83 
i
;

84 
u32
 
tsšfo
;

85 
u8
 
mask
;

86 
u8
 *
pos
;

88 ià((
’Œy
 =ğ
NULL
è|| (
f›ld
 =ğNULLè|| (
v®ue
 == NULL))

91 
i
 = 0; i < 
NUM_TSPEC_FIELDS
; i++)

92 ià(
	`¡rÿ£cmp
(
f›ld
, 
t¥ec_f›lds
[
i
].
Çme
) == 0)

94 ià(
i
 >ğ
NUM_TSPEC_FIELDS
) {

95 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC config field\n");

98 ià(
t¥ec_f›lds
[
i
].
is_tsšfo_f›ld
) {

99 
mask
 = 
t¥ec_f›lds
[
i
].
size
;

100 
tsšfo
 = 
	`CAC_GET_LE24
(&
’Œy
->
t¥ec
.
ts_šfo
[0]è& 
TSINFO_MASK
;

101 *
v®ue
 = (
tsšfo
 >> 
t¥ec_f›lds
[
i
].
off£t
è& 
mask
;

103 
pos
 = (
u8
 *)(&
’Œy
->
t¥ec
è+ 
t¥ec_f›lds
[
i
].
off£t
;

104 ià(
t¥ec_f›lds
[
i
].
size
 == 1)

105 *
v®ue
 = (*
pos
 & 0xFF);

106 ià(
t¥ec_f›lds
[
i
].
size
 == 2)

107 *
v®ue
 = 
	`CAC_GET_LE16
(
pos
);

109 *
v®ue
 = 
	`CAC_GET_LE32
(
pos
);

113 
	}
}

120 
Ãt_deviû
 *
	$g‘_Ãtdev_fÜ_¡©iÚ
(
¦si_dev
 *
sdev
)

122 
Ãt_deviû
 *
dev
;

123 
Ãtdev_vif
 *
ndev_vif
;

124 
s32
 
vif
;

126 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

127 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

128 ià(!
dev
)

130 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

131 ià(!
ndev_vif
)

133 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

134 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)

135  
dev
;

137  
NULL
;

138 
	}
}

147 
	$add_ebw_›
(
u8
 *
buf
, 
size_t
 
buf_Ën
, u8 
tsid
)

149 
u8
 *
pos
;

151 ià((
buf
 =ğ
NULL
è|| (
buf_Ën
 < 8))

154 
pos
 = 
buf
;

155 *
pos
++ = 
WLAN_EID_VENDOR_SPECIFIC
;

156 *
pos
++ = 6;

157 
	`memıy
(
pos
, 
EBW_OUI_TYPE
, (EBW_OUI_TYPE));

158 
pos
 +ğ(
EBW_OUI_TYPE
);

159 *
pos
++ = 
tsid
;

160 *
pos
++ = 0;

162  
pos
 - 
buf
;

163 
	}
}

174 
	$add_t¤s_›
(
u8
 *
buf
, 
size_t
 
buf_Ën
, u8 
tsid
,

175 
u8
 
¿‹s
[
CCX_MAX_NUM_RATES
], 
size_t
 
num_¿‹s
)

177 
u8
 *
pos
;

178 
size_t
 
›_Ën
 = 7 + 
num_¿‹s
;

179 
i
;

181 ià((
buf
 =ğ
NULL
è|| (
buf_Ën
 < 
›_Ën
è|| (
¿‹s
 == NULL) ||

182 (
num_¿‹s
 > 
CCX_MAX_NUM_RATES
))

185 
pos
 = 
buf
;

186 
	`mem£t
(
pos
, 0, 
›_Ën
);

187 *
pos
++ = 
WLAN_EID_VENDOR_SPECIFIC
;

188 *
pos
++ = 
›_Ën
 - 2;

189 
	`memıy
(
pos
, 
TSRS_OUI_TYPE
, (TSRS_OUI_TYPE));

190 
pos
 +ğ(
TSRS_OUI_TYPE
);

191 *
pos
++ = 
tsid
;

192 
i
 = 0; i < 
num_¿‹s
; i++)

193 *
pos
++ = 
¿‹s
[
i
];

195  
pos
 - 
buf
;

196 
	}
}

204 cÚ¡ 
u8
 *
	$bss_g‘_›
(
cfg80211_bss
 *
bss
, 
u8
 
›
)

206 cÚ¡ 
u8
 *
pos
;

207 
u8
 
›s_Ën
, 
›s_cur_Ën
;

209 
pos
 = (cÚ¡ 
u8
 *)(
bss
->
›s
);

210 
›s_Ën
 = (
u8
)
bss
->
›s
->
Ën
;

211 
›s_cur_Ën
 = 1;

213 
›s_cur_Ën
 <ğ
›s_Ën
) {

214 ià(
pos
[0] =ğ
›
)

215  
pos
;

217 
pos
 += 2 +…os[1];

218 
›s_cur_Ën
++;

221  
NULL
;

222 
	}
}

230 
	$bss_g‘_b™_¿‹s
(
cfg80211_bss
 *
bss
, 
u8
 **
¿‹s
)

232 cÚ¡ 
u8
 *
›
, *
›2
;

233 
i
, 
j
;

234 
Ën
;

235 
u8
 *
r
;

237 
›
 = 
	`bss_g‘_›
(
bss
, 
WLAN_EID_SUPP_RATES
);

238 
›2
 = 
	`bss_g‘_›
(
bss
, 
WLAN_EID_EXT_SUPP_RATES
);

240 
Ën
 = (
›
 ? ie[1] : 0è+ (
›2
 ? ie2[1] : 0);

242 ià(!
Ën
)

245 
r
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

246 ià(!
r
)

249 
i
 = 0; 
›
 && i < ie[1]; i++)

250 
r
[
i
] = 
›
[i + 2] & 0x7f;

252 
j
 = 0; 
›2
 && j < ie2[1]; j++)

253 
r
[
i
 + 
j
] = 
›2
[j + 2] & 0x7f;

255 *
¿‹s
 = 
r
;

256  
Ën
;

257 
	}
}

266 
	$ÿc_£nd_addts
(
¦si_dev
 *
sdev
, 
id
, 
ebw
)

268 
aùiÚ_addts_»q
 *
»q
;

269 
size_t
 
exŒa_›_Ën
 = 50;

270 
›_Ën
 = 0;

271 
size_t
 
»q_Ën
;

272 
ÿc_t¥ec
 *
’Œy
;

273 
u8
 
tsid
, 
i
;

274 
u8
 *
¿‹s
;

275 
u8
 
¿‹
 = 0;

276 
u8
 *
pos
;

277 
num_¿‹s
;

278 
Ãtdev_vif
 *
ndev_vif
;

279 
Ãt_deviû
 *
Ãtdev
;

280 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

281 
›“80211_hdr
 *
hdr
;

282 
u8
 *
buf
 = 
NULL
;

283 
u8
 *
bssid
;

284 
u8
 
r
 = 0;

286 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
id
, 0);

287 ià(
’Œy
 =ğ
NULL
) {

288 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Invalid TSPEC ID\n");

292 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

293 
Ãtdev
 = 
	`g‘_Ãtdev_fÜ_¡©iÚ
(
sdev
);

294 ià(
Ãtdev
 =ğ
NULL
) {

295 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

298 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

299 ià((
ndev_vif
 =ğ
NULL
è|| (ndev_vif->
¡a
.
¡a_bss
 == NULL)) {

300 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

303 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

305 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

306 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

307 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Not connected, can't send ADDTS\n");

308 
r
 = -1;

309 
ex™
;

311 
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

312 ià(
’Œy
->
acû±ed
) {

313 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: TSPEC‡lready‡ccepted\n");

314 
r
 = -1;

315 
ex™
;

318 
buf
 = 
	`km®loc
(
IEEE80211_HEADER_SIZE
 + (*
»q
è+ 
exŒa_›_Ën
, 
GFP_KERNEL
);

319 ià(
buf
 =ğ
NULL
) {

320 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo‡llocate ADDTS„equest\n");

321 
r
 = -1;

322 
ex™
;

325 
hdr
 = (
›“80211_hdr
 *)
buf
;

326 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

327 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
bssid
);

328 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
Ãtdev
->
dev_addr
);

329 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
bssid
);

331 
»q
 = (
aùiÚ_addts_»q
 *)(
buf
 + 
IEEE80211_HEADER_SIZE
);

332 
»q
->
hdr
.
ÿ‹gÜy
 = 
WLAN_CATEGORY_WMM
;

333 
»q
->
hdr
.
aùiÚ
 = 
WMM_ACTION_CODE_ADDTS_REQ
;

334 ià(
dŸlog_tok’_Ãxt
 == 0)

335 
dŸlog_tok’_Ãxt
++;

336 
»q
->
hdr
.
dŸlog_tok’
 = 
dŸlog_tok’_Ãxt
++;

337 
»q
->
hdr
.
¡©us_code
 = 0;

338 
tsid
 = (
	`CAC_GET_LE24
(
»q
->
t¥ec
.
ts_šfo
) >> 1) & 0xF;

343 ià(
’Œy
->
psb_¥ecif›d
 == 0) {

344 
¦si_³”
 *
³”
;

345 
u32
 
´iÜ™y
;

347 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

348 ià(!
³”
) {

349 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS:‚o Peer found\n");

350 
r
 = -1;

351 
ex™_ä“_buf
;

354 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
’Œy
, "u£r_´iÜ™y", &
´iÜ™y
);

355 ià(
³”
->
u­sd
 & 
	`BIT
(
	`¦si_äame_´iÜ™y_to_ac_queue
(
´iÜ™y
)))

356 
’Œy
->
t¥ec
.
ts_šfo
[1] |= 0x04;

358 
	`memıy
(&
»q
->
t¥ec
, &
’Œy
->tspec, (entry->tspec));

359 
»q_Ën
 = (*
»q
);

360 
pos
 = (
u8
 *)(
»q
 + 1);

361 
’Œy
->
ebw
 =ƒbw ? 1 : 0;

363 ià(
ebw
) {

364 
›_Ën
 +ğ
	`add_ebw_›
(
pos
, 
exŒa_›_Ën
, 
tsid
);

365 ià(
›_Ën
 <= 0)

366 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo‡dd EBW IE\n");

370 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
) {

371 
num_¿‹s
 = 
	`bss_g‘_b™_¿‹s
(
ndev_vif
->
¡a
.
¡a_bss
, &
¿‹s
);

372 ià(
num_¿‹s
 <= 0)

373 
¿‹
 = 12;

375 
i
 = 0; i < 
num_¿‹s
; i++)

376 ià((
¿‹s
[
i
] > 
¿‹
) && (rates[i] <= 48))

377 
¿‹
 = 
¿‹s
[
i
];

378 
	`kä“
(
¿‹s
);

385 ià((
¿‹
 * 
TSRS_RATE_PER_UNIT
è=ğ
»q
->
t¥ec
.
mšimum_phy_¿‹
)

388 ià((
¿‹
 * 
TSRS_RATE_PER_UNIT
è> 
»q
->
t¥ec
.
mšimum_phy_¿‹
) {

389 
›_Ën
 +ğ
	`add_t¤s_›
(
pos
 + ie_Ën, 
exŒa_›_Ën
 - ie_len,

390 
tsid
, &
¿‹
, 1);

391 ià(
›_Ën
 <= 0) {

392 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo‡dd TSRS IE\n");

393 
r
 = -1;

394 
ex™_ä“_buf
;

397 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: BSS„ateoo†ow\n");

398 
r
 = -1;

399 
ex™_ä“_buf
;

404 ià(
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãtdev
, 
buf
, (
IEEE80211_HEADER_SIZE
 + 
»q_Ën
 + 
›_Ën
),

405 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
,

406 
ho¡_g
, 0, 
sdev
->
fw_dw–l_time
, 0) != 0) {

407 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo send ADDTS„equest\n");

408 
r
 = -1;

409 
ex™_ä“_buf
;

411 
’Œy
->
dŸlog_tok’
 = 
»q
->
hdr
.dialog_token;

413 
ex™_ä“_buf
:

414 
	`kä“
(
buf
);

415 
ex™
:

416 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

417 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

418  
r
;

419 
	}
}

427 
	$ÿc_£nd_d–ts
(
¦si_dev
 *
sdev
, 
id
)

429 
aùiÚ_d–ts_»q
 *
»q
;

430 
ÿc_t¥ec
 *
’Œy
;

431 
size_t
 
»q_Ën
;

432 
u32
 
´iÜ™y
;

433 
rc
;

434 
Ãtdev_vif
 *
ndev_vif
;

435 
Ãt_deviû
 *
Ãtdev
;

436 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

437 
›“80211_hdr
 *
hdr
;

438 
u8
 *
buf
 = 
NULL
;

439 
u8
 *
bssid
;

440 
u8
 
r
 = 0;

441 
¦si_³”
 *
¡­“r
;

443 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
id
 , 1);

444 ià(
’Œy
 =ğ
NULL
) {

445 
	`SLSI_ERR
(
sdev
, "CAC-DELTS:‚ØTSPEC ha b“Àe¡ablished fÜsid=%d\n", 
id
);

449 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

450 
Ãtdev
 = 
	`g‘_Ãtdev_fÜ_¡©iÚ
(
sdev
);

451 ià(
Ãtdev
 =ğ
NULL
) {

452 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

455 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

456 ià((
ndev_vif
 =ğ
NULL
è|| (ndev_vif->
¡a
.
¡a_bss
 == NULL)) {

457 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

460 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

462 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

463 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

464 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Not connected, can't send DELTS\n");

465 
r
 = -1;

466 
ex™
;

469 
¡­“r
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

470 ià(
	`WARN_ON
(!
¡­“r
)) {

471 
r
 = -1;

472 
ex™
;

475 
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

476 
buf
 = 
	`km®loc
(24 + (*
»q
), 
GFP_KERNEL
);

477 ià(
buf
 =ğ
NULL
) {

478 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Failedo‡llocate DELTS„equest\n");

479 
r
 = -1;

480 
ex™
;

482 
hdr
 = (
›“80211_hdr
 *)
buf
;

483 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

484 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
bssid
);

485 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
Ãtdev
->
dev_addr
);

486 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
bssid
);

487 
»q
 = (
aùiÚ_d–ts_»q
 *)(
buf
 + 24);

488 
»q_Ën
 = (*
»q
);

489 
»q
->
hdr
.
ÿ‹gÜy
 = 
WLAN_CATEGORY_WMM
;

490 
»q
->
hdr
.
aùiÚ
 = 
WMM_ACTION_CODE_DELTS
;

491 
»q
->
hdr
.
dŸlog_tok’
 = 0;

492 
»q
->
hdr
.
¡©us_code
 = 0;

493 
	`memıy
(&
»q
->
t¥ec
, &
’Œy
->tspec, (entry->tspec));

498 ià(
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãtdev
, 
buf
, (
IEEE80211_HEADER_SIZE
 + 
»q_Ën
), 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0) != 0) {

499 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Failedo send DELTS„equest\n");

500 
r
 = -1;

501 
ex™_ä“_buf
;

503 
rc
 = 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
’Œy
, "u£r_´iÜ™y", &
´iÜ™y
);

504 ià(
rc
 != 0) {

505 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Error in„eading…riority fromspec!\n");

506 
r
 = -1;

507 
ex™_ä“_buf
;

510 ià(
	`¦si_mlme_d–_Œaffic_·¿m‘”s
(
sdev
, 
Ãtdev
, 
´iÜ™y
) != 0) {

511 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Failedo send DELTS„equest\n");

512 
r
 = -1;

513 
ex™_ä“_buf
;

525 
’Œy
->
acû±ed
 = 0;

526 
sdev
->
t¥ec_”rÜ_code
 = 0;

527 
¡­“r
->
t¥ec_e¡ablished
 &ğ~
	`BIT
(
´iÜ™y
);

529 
	`ÿc_£t_ric_›
(
sdev
, 
Ãtdev
);

531 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
 && 
´evious_msdu_liãtime
 !ğ
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
)

532 ià(
	`¦si_£nd_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, 
´evious_msdu_liãtime
) != 0) {

533 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: slsi_send_max_msdu_lifetime failed");

534 
ex™_ä“_buf
;

536 
ex™_ä“_buf
:

537 
	`kä“
(
buf
);

538 
ex™
:

539 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

540 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

541  
r
;

542 
	}
}

550 
	$ÿc_ü—‹_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

552 
ÿc_t¥ec
 *
’Œy
;

553 
id
;

554 
u8
 
tid_auto_dÚe
 = 0;

555 
Ãtdev_vif
 *
ndev_vif
;

556 
Ãt_deviû
 *
Ãtdev
;

558 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

559 
Ãtdev
 = 
	`g‘_Ãtdev_fÜ_¡©iÚ
(
sdev
);

560 ià(
Ãtdev
 =ğ
NULL
) {

561 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

564 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

565 ià(
ndev_vif
 =ğ
NULL
) {

566 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

569 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

571 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

572 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

573 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Not connected, can't create TSPEC\n");

574 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

575 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

578 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

579 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

581 ià(
¬gs
 =ğ
NULL
) {

583 ià(
t¥ec_li¡_Ãxt_id
 <= 7) {

584 
id
 = 
t¥ec_li¡_Ãxt_id
++;

586 
id
 = 0;

587 
t¥ec_li¡_Ãxt_id
 = 0;

588 
t¥ec_li¡_Ãxt_id
++;

590 
tid_auto_dÚe
 = 1;

593 ià((!
tid_auto_dÚe
è&& (
	`¡¹ošt
(
¬gs
, &
id
) < 0)) {

595 ià(
t¥ec_li¡_Ãxt_id
 <= 7) {

596 
id
 = 
t¥ec_li¡_Ãxt_id
++;

598 
id
 = 0;

599 
t¥ec_li¡_Ãxt_id
 = 0;

600 
t¥ec_li¡_Ãxt_id
++;

604 ià(
id
 < 
TSID_MIN
 || id > 
TSID_MAX
) {

605 
	`SLSI_ERR
(
sdev
, "CAC: Inv®id TSID =%d, mu¡ bš„ªg0-7\n", 
id
);

609 
’Œy
 = 
	`kz®loc
((*’Œy), 
GFP_KERNEL
);

610 ià(
’Œy
 =ğ
NULL
) {

611 
	`SLSI_ERR
(
sdev
, "CAC: Failedo‡llocate TSPEC\n");

615 
’Œy
->
id
 = id;

616 
’Œy
->
t¥ec
.
eid
 = 
WLAN_EID_VENDOR_SPECIFIC
;

617 
’Œy
->
t¥ec
.
Ëngth
 = ÓÁry->t¥ecè- ÓÁry->t¥ec.
eid
) - (entry->tspec.length);

618 
	`CAC_PUT_BE24
(
’Œy
->
t¥ec
.
oui
, 
WLAN_OUI_MICROSOFT
);

619 
’Œy
->
t¥ec
.
oui_ty³
 = 
WLAN_OUI_TYPE_MICROSOFT_WMM
;

620 
’Œy
->
t¥ec
.
oui_subty³
 = 
WMM_OUI_SUBTYPE_TSPEC_ELEMENT
;

621 
’Œy
->
t¥ec
.
v”siÚ
 = 
WMM_VERSION
;

622 
’Œy
->
acû±ed
 = 0;

623 
’Œy
->
psb_¥ecif›d
 = 0;

625 
’Œy
->
t¥ec
.
ts_šfo
[0] = 0x80;

627 
’Œy
->
Ãxt
 = 
t¥ec_li¡
;

628 
t¥ec_li¡
 = 
’Œy
;

629 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: C»©ed TSPECƒÁry fÜ id =%d\n", 
id
);

631  
’Œy
->
id
;

632 
	}
}

640 
	$ÿc_d–‘e_t¥ec
(
¦si_dev
 *
sdev
, 
id
)

642 
ÿc_t¥ec
 *
™r
;

643 
ÿc_t¥ec
 *
´ev
;

645 
™r
 = 
t¥ec_li¡
;

646 
´ev
 = 
NULL
;

647 
™r
 !ğ
NULL
) {

648 ià(
™r
->
id
 == id) {

649 ià(
´ev
)

650 
´ev
->
Ãxt
 = 
™r
->next;

652 
t¥ec_li¡
 = 
™r
->
Ãxt
;

654 ià(
™r
->
acû±ed
)

655 
	`ÿc_£nd_d–ts
(
sdev
, 
™r
->
id
);

657 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "CAC: TSPECƒÁry d–‘ed fÜ id =%d\n", 
id
);

658 
	`kä“
(
™r
);

662 
´ev
 = 
™r
;

663 
™r
 = iŒ->
Ãxt
;

665 
	`SLSI_ERR
(
sdev
, "CAC: Couldn'ˆfšd TSPEC w™h id %d fÜ d–‘iÚ", 
id
);

668 
	}
}

677 
	$ÿc_d–‘e_t¥ec_by_¡©e
(
¦si_dev
 *
sdev
, 
id
, 
acû±ed
)

679 
ÿc_t¥ec
 *
™r
;

680 
ÿc_t¥ec
 *
´ev
;

682 
™r
 = 
t¥ec_li¡
;

683 
´ev
 = 
NULL
;

684 
™r
 !ğ
NULL
) {

685 ià((
™r
->
id
 =ğidè&& (™r->
acû±ed
 ==‡ccepted)) {

686 ià(
´ev
)

687 
´ev
->
Ãxt
 = 
™r
->next;

689 
t¥ec_li¡
 = 
™r
->
Ãxt
;

691 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "CAC: D–‘šg TSPEC 0x%°w™h ID %d (acû±ed =%d)\n", 
™r
, 
id
, 
acû±ed
);

692 
	`kä“
(
™r
);

695 
´ev
 = 
™r
;

696 
™r
 = iŒ->
Ãxt
;

698 
	`SLSI_ERR
(
sdev
, "CAC: Couldn'ˆfšd TSPEC w™h ID %d (acû±ed =%d)\n", 
id
, 
acû±ed
);

701 
	}
}

711 
	$ÿc_cÚfig_t¥ec
(
¦si_dev
 *
sdev
, 
id
, cÚ¡ *
f›ld
, 
u32
 
v®ue
)

713 
ÿc_t¥ec
 *
’Œy
;

714 
i
;

715 
u32
 
max
 = 0xFFFFFFFF;

716 
u32
 
tsšfo
;

717 
u8
 
mask
;

718 
u8
 *
pos
;

720 ià(
f›ld
 =ğ
NULL
)

723 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
id
, 0);

724 ià(
’Œy
 =ğ
NULL
) {

725 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC ID\n");

729 
i
 = 0; i < 
NUM_TSPEC_FIELDS
; i++)

730 ià(
	`¡rÿ£cmp
(
f›ld
, 
t¥ec_f›lds
[
i
].
Çme
) == 0)

732 ià(
i
 >ğ
NUM_TSPEC_FIELDS
) {

733 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC config field\n");

736 ià(
t¥ec_f›lds
[
i
].
»ad_Úly
) {

737 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC field is„ead-only\n");

740 ià(
t¥ec_f›lds
[
i
].
is_tsšfo_f›ld
) {

741 
mask
 = 
t¥ec_f›lds
[
i
].
size
;

742 ià(
	`¡rÿ£cmp
(
f›ld
, "psb") == 0) {

743 ià(
v®ue
 <ğ
mask
)

744 
’Œy
->
psb_¥ecif›d
 = 1;

748 ià(
v®ue
 > 
mask
) {

749 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC cÚfig v®uexûeded maximum fÜ %s\n", 
t¥ec_f›lds
[
i
].
Çme
);

753 
tsšfo
 = 
	`CAC_GET_LE24
(&
’Œy
->
t¥ec
.
ts_šfo
[0]);

754 
tsšfo
 &ğ~(
u32
)(
mask
 << 
t¥ec_f›lds
[
i
].
off£t
);

755 
tsšfo
 |ğ(
u32
)((
v®ue
 & 
mask
è<< 
t¥ec_f›lds
[
i
].
off£t
);

756 
	`CAC_PUT_LE24
(
’Œy
->
t¥ec
.
ts_šfo
, 
tsšfo
);

758 ià(
t¥ec_f›lds
[
i
].
size
 < 4)

759 
max
 = ((1 << (
t¥ec_f›lds
[
i
].
size
 * 8)) - 1);

761 ià(
v®ue
 > 
max
) {

762 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC cÚfig v®uexûeded maximumfÜ %s\n", 
t¥ec_f›lds
[
i
].
Çme
);

766 
pos
 = (
u8
 *)(&
’Œy
->
t¥ec
è+ 
t¥ec_f›lds
[
i
].
off£t
;

767 ià(
t¥ec_f›lds
[
i
].
size
 == 1)

768 *
pos
 = (
v®ue
 & 0xFF);

769 ià(
t¥ec_f›lds
[
i
].
size
 == 2)

770 
	`CAC_PUT_LE16
(
pos
, 
v®ue
);

772 
	`CAC_PUT_LE32
(
pos
, 
v®ue
);

776 
	}
}

783 
	$ÿc_ù¾_ü—‹_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

785 
id
;

787 
id
 = 
	`ÿc_ü—‹_t¥ec
(
sdev
, 
¬gs
);

788 ià(
id
 < 0)

791  
id
;

792 
	}
}

800 
	$ÿc_ù¾_d–‘e_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

802 
id
;

804 ià(
	`¡¹ošt
(
¬gs
, &
id
) < 0) {

805 
	`SLSI_ERR
(
sdev
, "CAC-DELETE-TSPEC: Invalid TSPEC ID\n");

809 ià(
	`ÿc_d–‘e_t¥ec
(
sdev
, 
id
) < 0)

813 
	}
}

821 
	$ÿc_ù¾_cÚfig_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

823 *
id
;

824 *
f›ld
;

825 *
v®ue
;

826 
t¥ec_id
;

827 
u32
 
v®
;

829 
id
 = 
¬gs
;

830 
f›ld
 = 
	`¡rchr
(
id
, ' ');

831 ià(
f›ld
 =ğ
NULL
) {

832 
	`SLSI_ERR
(
sdev
, "CAC: field string is NULL\n");

835 *
f›ld
++ = '\0';

836 
v®ue
 = 
	`¡rchr
(
f›ld
, ' ');

837 ià(
v®ue
 =ğ
NULL
) {

838 
	`SLSI_ERR
(
sdev
, "CAC: field value is NULL\n");

841 *
v®ue
++ = '\0';

843 ià(
	`¡¹ošt
(
id
, &
t¥ec_id
) < 0) {

844 
	`SLSI_ERR
(
sdev
, "CAC: Conversionƒrror forspecid\n");

848 ià(
	`¡¹ošt
(
v®ue
, &
v®
) < 0) {

849 
	`SLSI_ERR
(
sdev
, "CAC: Conversionƒrror forspecid value\n");

853 ià(
	`ÿc_cÚfig_t¥ec
(
sdev
, 
t¥ec_id
, 
f›ld
, 
v®
) < 0)

857 
	}
}

865 
	$ÿc_ù¾_£nd_addts
(
¦si_dev
 *
sdev
, *
¬gs
)

867 *
id_¡r
;

868 *
ebw_¡r
;

869 
id
;

870 
ebw
 = 0;

872 ià(
¬gs
 =ğ
NULL
)

875 
id_¡r
 = 
¬gs
;

876 
ebw_¡r
 = 
	`¡rchr
(
id_¡r
, ' ');

877 ià(
ebw_¡r
 !ğ
NULL
) {

878 *
ebw_¡r
++ = '\0';

879 ià(!
	`¡ºcmp
(
ebw_¡r
, "ebw", 3))

880 
ebw
 = 1;

882 ià(
	`¡¹ošt
(
id_¡r
, &
id
) < 0) {

883 
	`SLSI_ERR
(
sdev
, "CAC: Conversionƒrror forspecid value\n");

886 ià(
	`ÿc_£nd_addts
(
sdev
, 
id
, 
ebw
) < 0)

890 
	}
}

898 
	$ÿc_ù¾_£nd_d–ts
(
¦si_dev
 *
sdev
, *
¬gs
)

900 
id
;

902 ià(
¬gs
 =ğ
NULL
)

905 ià(
	`¡¹ošt
(
¬gs
, &
id
) < 0) {

906 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC ID\n");

909 ià(
	`ÿc_£nd_d–ts
(
sdev
, 
id
) < 0)

913 
	}
}

921 
	$ÿc_´oûss_d–ts_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
aùiÚ_d–ts_»q
 *
»q
)

923 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

924 
ÿc_t¥ec
 *
™r
;

925 
u32
 
´iÜ™y
;

926 
rc
;

927 
¦si_³”
 *
¡­“r
;

928 
u8
 
tid
;

930 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

932 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

933 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
è|| (ndev_vif->¡a.
¡a_bss
 =ğ
NULL
)) {

934 
	`SLSI_ERR
(
sdev
, "CAC: Not connected, Unexpected DELTS„equest\n");

938 
¡­“r
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

939 ià(
	`WARN_ON
(!
¡­“r
))

942 
tid
 = (
	`CAC_GET_LE24
(
»q
->
t¥ec
.
ts_šfo
) >> 1) & 0xF;

943 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: TID iÀd–t »que¡ =%d\n", 
tid
);

945 
™r
 = 
	`fšd_t¥ec_’Œy
(
tid
, 1);

946 ià(
™r
 =ğ
NULL
) {

947 
	`SLSI_ERR
(
sdev
, "CAC: No matching TSPEC found\n");

951 
rc
 = 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
™r
, "u£r_´iÜ™y", &
´iÜ™y
);

952 ià(
rc
 != 0) {

953 
	`SLSI_ERR
(
sdev
, "CAC: Missing…riority from TSPEC!\n");

957 ià(
	`¦si_mlme_d–_Œaffic_·¿m‘”s
(
sdev
, 
Ãtdev
, 
´iÜ™y
) != 0) {

958 
	`SLSI_ERR
(
sdev
, "CAC: Failedo send DEL-TRAFFIC_PARAMETERS„equest\n");

971 
™r
->
acû±ed
 = 0;

972 
¡­“r
->
t¥ec_e¡ablished
 &ğ~
	`BIT
(
´iÜ™y
);

973 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "t¥ec_e¡ablished =%x\n", 
¡­“r
->
t¥ec_e¡ablished
);

975 
	`ÿc_£t_ric_›
(
sdev
, 
Ãtdev
);

977 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
 && 
´evious_msdu_liãtime
 !ğ
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
)

978 ià(
	`¦si_£nd_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, 
´evious_msdu_liãtime
) != 0) {

979 
	`SLSI_ERR
(
sdev
, "CAC: slsi_send_max_msdu_lifetime failed");

982 
	}
}

992 
	$ÿc_fšd_edÿ_›
(cÚ¡ 
u8
 *
›
, 
size_t
 
›_Ën
, u8 *
tsid
, 
u16
 *
liãtime
)

994 cÚ¡ 
u8
 *
pos
 = 
›
;

996 ià((
›
 =ğ
NULL
è|| (
›_Ën
 < 9) ||

997 (
tsid
 =ğ
NULL
è|| (
liãtime
 == NULL))

1000 
pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_CISCO
, 
WLAN_OUI_TYPE_CISCO_EDCA
, 
›
, 
›_Ën
);

1001 ià(
pos
 && (po + 9 <ğ
›
 + 
›_Ën
)) {

1002 *
tsid
 = 
pos
[6];

1003 *
liãtime
 = 
	`CAC_GET_LE16
(&
pos
[7]);

1008 
	}
}

1017 
	$ÿc_´oûss_addts_r¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
aùiÚ_addts_r¥
 *
r¥
, cÚ¡ 
u8
 *
›
, 
size_t
 
›_Ën
)

1019 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

1020 
ÿc_t¥ec
 *
™r
, *
’Œy
;

1021 
wmm_t¥ec_–em’t
 *
t¥ec
;

1022 
u32
 
´iÜ™y
, 
´ev_´iÜ™y
;

1023 
rc
;

1024 
u8
 
tsid
;

1025 
u16
 
msdu_liãtime
;

1026 
¦si_³”
 *
³”
;

1027 
u16
 
medium_time
;

1029 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1031 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "\n");

1033 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

1034 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
è|| (ndev_vif->¡a.
¡a_bss
 =ğ
NULL
)) {

1035 
	`SLSI_ERR
(
sdev
, "CAC: Not connected, INVALID state for ADDTS„esponse\n");

1039 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

1040 ià(
	`WARN_ON
(!
³”
))

1043 
™r
 = 
t¥ec_li¡
;

1044 
™r
 !ğ
NULL
) {

1045 ià(
™r
->
dŸlog_tok’
 =ğ
r¥
->
hdr
.dialog_token) {

1046 
™r
->
dŸlog_tok’
 = 0;

1049 
™r
 = iŒ->
Ãxt
;

1051 ià(
™r
 =ğ
NULL
) {

1052 
	`SLSI_ERR
(
sdev
, "CAC: No matching TSPEC found for ADDTS„esponse\n");

1056 ià(
r¥
->
hdr
.
¡©us_code
 !ğ
ADDTS_STATUS_ACCEPTED
) {

1057 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC„ejeùed (¡©us=0x%02X)", 
r¥
->
hdr
.
¡©us_code
);

1058 
	`ÿc_d–‘e_t¥ec_by_¡©e
(
sdev
, 
™r
->
id
, 0);

1062 ià((
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
è&& 
	`ÿc_fšd_edÿ_›
(
›
, 
›_Ën
, &
tsid
, &
msdu_liãtime
) != 0)

1063 
msdu_liãtime
 = 
MSDU_LIFETIME_DEFAULT
;

1065 
t¥ec
 = (
wmm_t¥ec_–em’t
 *)(
r¥
 + 1);

1066 
medium_time
 = 
t¥ec
->medium_time;

1068 
rc
 = 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
™r
, "u£r_´iÜ™y", &
´iÜ™y
);

1069 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: PriÜ™y fÜ cu¼’ˆt¥eøid %d=%d\n", 
™r
->
id
, 
´iÜ™y
);

1071 ià(
³”
->
t¥ec_e¡ablished
 == 0)

1072 
£t_·¿ms
;

1074 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "TSPEC‡lreadyƒstablished\n");

1080 
´iÜ™y
) {

1082 
FAPI_PRIORITY_QOS_UP1
:

1083 
FAPI_PRIORITY_QOS_UP2
:

1084 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP1
))

1085 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP1
;

1086 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP2
))

1087 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP2
;

1089 
£t_·¿ms
;

1093 
FAPI_PRIORITY_QOS_UP0
:

1094 
FAPI_PRIORITY_QOS_UP3
:

1095 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP0
))

1096 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP0
;

1097 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP3
))

1098 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP3
;

1100 
£t_·¿ms
;

1104 
FAPI_PRIORITY_QOS_UP4
:

1105 
FAPI_PRIORITY_QOS_UP5
:

1106 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP4
))

1107 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP4
;

1108 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP5
))

1109 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP5
;

1111 
£t_·¿ms
;

1115 
FAPI_PRIORITY_QOS_UP6
:

1116 
FAPI_PRIORITY_QOS_UP7
:

1117 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP6
))

1118 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP6
;

1119 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP7
))

1120 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP7
;

1122 
£t_·¿ms
;

1126 
	`SLSI_ERR
(
sdev
, "CAC: Invalid UP inhe„equest\n");

1131 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
™r
->
id
, 1);

1132 ià(
’Œy
) {

1133 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
’Œy
, "u£r_´iÜ™y", &
´ev_´iÜ™y
);

1134 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: Modify TSPEC (´ev_´iÜ™y =%d)\n", 
´ev_´iÜ™y
);

1140 
	`ÿc_d–‘e_t¥ec_by_¡©e
(
sdev
, 
’Œy
->
id
, 1);

1141 ià(
´iÜ™y
 !ğ
´ev_´iÜ™y
) {

1142 
™r
->
t¥ec
.
ts_šfo
[1] &= ~(7 << 3) ;

1143 
™r
->
t¥ec
.
ts_šfo
[1] |ğ
´ev_´iÜ™y
 << 3 ;

1144 
´iÜ™y
 = 
´ev_´iÜ™y
;

1152 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: Modify TSPEC for different TID\n");

1153 
’Œy
 = 
t¥ec_li¡
;

1154 
’Œy
 !ğ
NULL
) {

1155 ià((
’Œy
->
acû±ed
è&& (ÓÁry->
t¥ec
.
ts_šfo
[1] >> 3 & 0x07è=ğ
´ev_´iÜ™y
)) {

1156 
medium_time
 +ğ
’Œy
->
t¥ec
.medium_time;

1157 
´iÜ™y
 = 
´ev_´iÜ™y
;

1160 
’Œy
 =ƒÁry->
Ãxt
;

1162 ià(
’Œy
 =ğ
NULL
) {

1163 
	`SLSI_ERR
(
sdev
, "CAC: Failedo findƒntry for…revƒstablished TSPEC!!\n");

1168 
£t_·¿ms
:

1169 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "£ndšg¿ffiø·¿m tid [%d]", 
™r
->
id
);

1170 ià(
	`¦si_mlme_£t_Œaffic_·¿m‘”s
(
sdev
, 
Ãtdev
, 
´iÜ™y
, 
medium_time
, 
t¥ec
->
mšimum_d©a_¿‹
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
) != 0) {

1171 
	`SLSI_ERR
(
sdev
, "CAC: Failedo send SET_TRAFFIC_PARAMETERS„equest\n");

1176 
™r
->
t¥ec
.
medium_time
 = medium_time;

1195 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
) {

1196 ià((
	`¦si_»ad_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, &
´evious_msdu_liãtime
)) != 0) {

1197 
´evious_msdu_liãtime
 = 
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
;

1198 
	`SLSI_ERR
(
sdev
, "CAC: slsi_read_max_msdu_lifetime failed");

1202 ià(
	`¦si_£nd_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, 
msdu_liãtime
) != 0) {

1203 
	`SLSI_ERR
(
sdev
, "CAC: slsi_send_max_msdu_lifetime failed");

1208 
™r
->
acû±ed
 = 1;

1209 
sdev
->
t¥ec_”rÜ_code
 = 0;

1210 
³”
->
t¥ec_e¡ablished
 |ğ
	`BIT
(
´iÜ™y
);

1212 
	`ÿc_£t_ric_›
(
sdev
, 
Ãtdev
);

1213 
	}
}

1221 
	$ÿc_rx_wmm_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
›“80211_mgmt
 *
d©a
, 
size_t
 
Ën
)

1223 
›“80211_mgmt
 *
mgmt
 = 
d©a
;

1224 
aùiÚ_addts_r¥
 *
addts
;

1226 ià((
sdev
 =ğ
NULL
è|| (
d©a
 =ğNULLè|| (
Ãtdev
 =ğNULLè|| (
Ën
 == 0))

1229 ià(
mgmt
->
u
.
aùiÚ
.u.
wme_aùiÚ
.
aùiÚ_code
 =ğ
WMM_ACTION_CODE_ADDTS_RESP
) {

1230 
addts
 = (
aùiÚ_addts_r¥
 *)&
mgmt
->
u
.
aùiÚ
;

1231 
	`ÿc_´oûss_addts_r¥
(
sdev
, 
Ãtdev
, 
addts
, 
mgmt
->
u
.
aùiÚ
.u.
wme_aùiÚ
.
v¬ŸbË
, 
Ën
 - (*addts) + 1);

1232 } ià(
mgmt
->
u
.
aùiÚ
.u.
wme_aùiÚ
.
aùiÚ_code
 =ğ
WMM_ACTION_CODE_DELTS
) {

1233 
	`ÿc_´oûss_d–ts_»q
(
sdev
, 
Ãtdev
, (
aùiÚ_d–ts_»q
 *)&
mgmt
->
u
.
aùiÚ
);

1235 
	}
}

1242 
	$ÿc_g‘_aùive_t¥ecs
(
ÿc_aùiv©ed_t¥ec
 **
t¥ecs
)

1244 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1245 
couÁ
 = 0;

1246 
i
 = 0;

1248 ià(
t¥ecs
 =ğ
NULL
)

1251 
™r
 !ğ
NULL
) {

1252 ià(
™r
->
acû±ed
)

1253 
couÁ
++;

1254 
™r
 = iŒ->
Ãxt
;

1256 *
t¥ecs
 = 
	`km®loc_¬¿y
((
size_t
)
couÁ
, (
ÿc_aùiv©ed_t¥ec
), 
GFP_KERNEL
);

1257 
™r
 = 
t¥ec_li¡
;

1258 
™r
 !ğ
NULL
) {

1259 ià(
™r
->
acû±ed
) {

1260 
t¥ecs
[
i
]->
ebw
 = 
™r
->ebw;

1261 
	`memıy
(&
t¥ecs
[
i
]->
t¥ec
, &
™r
->tspec, (itr->tspec));

1262 
i
++;

1264 
™r
 = iŒ->
Ãxt
;

1267  
couÁ
;

1268 
	}
}

1279 
	$ÿc_d–‘e_t¥ec_li¡
(
¦si_dev
 *
sdev
)

1281 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1282 
ÿc_t¥ec
 *
‹mp
 = 
NULL
;

1284 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1286 
™r
 !ğ
NULL
) {

1287 
™r
->
acû±ed
 = 0;

1288 
™r
->
dŸlog_tok’
 = 0;

1289 
‹mp
 = 
™r
;

1290 
™r
 = iŒ->
Ãxt
;

1291 
	`kä“
(
‹mp
);

1293 
t¥ec_li¡
 = 
NULL
;

1294 
	}
}

1296 
	$ÿc_d—ùiv©e_t¥ecs
(
¦si_dev
 *
sdev
)

1298 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1300 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1302 
™r
) {

1303 
™r
->
acû±ed
 = 0;

1304 
™r
->
dŸlog_tok’
 = 0;

1305 
™r
 = iŒ->
Ãxt
;

1307 
	}
}

1309 
	$ÿc_£t_ric_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
)

1311 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1312 
t¥ec_couÁ
 = 0;

1313 
buf_Ën
 = 0;

1314 
u8
 *
buff
, *
add_šfo_›s
;

1315 
wmm_t¥ec_–em’t
 *
t¥ec_›
;

1316 
i
 = 0;

1317 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

1319 
™r
) {

1320 ià(
™r
->
acû±ed
)

1321 
t¥ec_couÁ
++;

1322 
™r
 = iŒ->
Ãxt
;

1325 ià(
t¥ec_couÁ
 == 0) {

1326 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
Ãtdev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
,

1327 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,

1328 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
);

1333 
buf_Ën
 = 6 + ((
wmm_t¥ec_–em’t
è* 
t¥ec_couÁ
);

1334 
buf_Ën
 +ğ
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
;

1335 
add_šfo_›s
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

1336 ià(!
add_šfo_›s
) {

1337 
	`SLSI_ERR
(
sdev
, "m®loøç. size:%d\n", 
buf_Ën
);

1340 
	`memıy
(
add_šfo_›s
, 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,‚dev_vif->¡a.
assoc_»q_add_šfo_–em_Ën
);

1342 
buff
 = 
add_šfo_›s
 + 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
;

1343 
buff
[0] = 
WLAN_EID_RIC_DATA
;

1344 
buff
[1] = 4;

1345 
buff
[2] = 0;

1347 
buff
[4] = 0;

1348 
buff
[5] = 0;

1350 
™r
 = 
t¥ec_li¡
;

1351 
i
 = 0;

1352 
™r
) {

1353 ià(
™r
->
acû±ed
) {

1354 
t¥ec_›
 = (
wmm_t¥ec_–em’t
 *)&
buff
[6 + 
i
 * (wmm_tspec_element)];

1355 
	`memıy
(
t¥ec_›
, &
™r
->
t¥ec
, (
wmm_t¥ec_–em’t
));

1356 ((
wmm_t¥ec_–em’t
 *)
t¥ec_›
)->
medium_time
 = 0;

1357 
i
++;

1359 
™r
 = iŒ->
Ãxt
;

1361 
buff
[3] = 
i
;

1362 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
Ãtdev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
add_šfo_›s
, 
buf_Ën
);

1363 
	`kä“
(
add_šfo_›s
);

1364 
	}
}

1366 
	$ÿc_g‘_rde_t¥ec_›
(
¦si_dev
 *
sdev
, 
u8
 *
assoc_r¥_›
, 
assoc_r¥_›_Ën
, cÚ¡ u8 **
t¥ec_›_¬r
)

1368 cÚ¡ 
u8
 *
›
;

1369 
u16
 
¡©us
;

1370 
t¥ec_couÁ
 = 0, 
i
 = 0;

1372 
›
 = 
assoc_r¥_›
;

1375 
›
 && (
assoc_r¥_›_Ën
 > i- 
assoc_r¥_›
)) {

1376 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RIC_DATA
, ie, 
assoc_r¥_›_Ën
 - (› - 
assoc_r¥_›
));

1377 ià(!
›
)

1379 
¡©us
 = 
	`CAC_GET_LE16
(&
›
[4]);

1380 ià(
¡©us
 != 0)

1383 
t¥ec_couÁ
 +ğ
›
[3];

1384 
›
 = ie + ie[1];

1388 ià(
t¥ec_couÁ
 > 
TSID_MAX
) {

1389 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "»ûived %d TSPEC buˆÿÀaccommod©Úly %d\n", 
t¥ec_couÁ
, 
TSID_MAX
);

1390 
t¥ec_couÁ
 = 
TSID_MAX
;

1394 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RIC_DATA
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
);

1395 
i
 < 
t¥ec_couÁ
 && 
›
) {

1396 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, ie,

1397 
assoc_r¥_›_Ën
 - (
›
 - 
assoc_r¥_›
));

1398 ià(!
›
)

1403 ià(
›
[1] > 6 && ie[6] =ğ
WMM_OUI_SUBTYPE_TSPEC_ELEMENT
) {

1404 
t¥ec_›_¬r
[
i
] = 
›
;

1405 
i
++;

1407 
›
 += ie[1];

1410  
i
;

1411 
	}
}

1413 
	$ÿc_upd©e_rßm_Œaffic_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1415 cÚ¡ 
u8
 *
t¥ec_›_¬r
[
TSID_MAX
];

1416 
assoc_r¥_t¥ec_couÁ
, 
i
;

1417 
u32
 
´iÜ™y
;

1418 
ÿc_t¥ec
 *
™r
;

1419 
wmm_t¥ec_–em’t
 *
assoc_r¥_t¥ec
;

1420 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

1421 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1423 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

1428 
	`ÿc_d—ùiv©e_t¥ecs
(
sdev
);

1430 ià(!
³”
) {

1431 
	`SLSI_ERR
(
sdev
, "AP…eerƒntry‚ot found\n");

1436 
assoc_r¥_t¥ec_couÁ
 = 
	`ÿc_g‘_rde_t¥ec_›
(
sdev
, 
³”
->
assoc_»¥_›
->
d©a
,

1437 
³”
->
assoc_»¥_›
->
Ën
, 
t¥ec_›_¬r
);

1439 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "assoc_r¥_t¥ec_couÁ:%d\n", 
assoc_r¥_t¥ec_couÁ
);

1441 ià(!
assoc_r¥_t¥ec_couÁ
)

1445 
i
 = 0; i < 
assoc_r¥_t¥ec_couÁ
; i++) {

1446 
assoc_r¥_t¥ec
 = (
wmm_t¥ec_–em’t
 *)
t¥ec_›_¬r
[
i
];

1447 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "r¥_t¥ec:[%d]s: [%x|%x|%x] mediumime[%x]\n", 
i
,

1448 
assoc_r¥_t¥ec
->
ts_šfo
[0],‡ssoc_rsp_tspec->ts_info[1],‡ssoc_rsp_tspec->ts_info[2],

1449 
assoc_r¥_t¥ec
->
medium_time
);

1451 
™r
 = 
	`fšd_t¥ec_’Œy
((
assoc_r¥_t¥ec
->
ts_šfo
[0] & 0x1E) >> 1, 0);

1452 ià(!
™r
) {

1453 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "tspecƒntry‚ot found\n");

1457 
™r
->
t¥ec
.
medium_time
 = 
assoc_r¥_t¥ec
->medium_time;

1458 
™r
->
t¥ec
.
mšimum_d©a_¿‹
 = 
assoc_r¥_t¥ec
->minimum_data_rate;

1459 
™r
->
acû±ed
 = 1;

1460 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
™r
, "u£r_´iÜ™y", &
´iÜ™y
);

1461 
³”
->
t¥ec_e¡ablished
 |ğ
	`BIT
(
´iÜ™y
);

1462 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "t¥eøadm™‹d id[%d]\n", 
™r
->
id
);

1463 
	`¦si_mlme_£t_Œaffic_·¿m‘”s
(
sdev
, 
dev
, 
´iÜ™y
, 
assoc_r¥_t¥ec
->
medium_time
,

1464 
assoc_r¥_t¥ec
->
mšimum_d©a_¿‹
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
);

1466 
	}
}

	@cac.h

7 #iâdeà
CAC_H


8 
	#CAC_H


	)

10 
	~<lšux/k”Ãl.h
>

11 
	~"dev.h
"

12 
	~"debug.h
"

13 
	~"mlme.h
"

14 
	~"mgt.h
"

17 
	#WLAN_OUI_CISCO
 0x004096

	)

18 
	#WLAN_OUI_TYPE_CISCO_EDCA
 0x09

	)

20 
	#WMM_OUI_SUBTYPE_INFORMATION_ELEMENT
 0

	)

21 
	#WMM_OUI_SUBTYPE_PARAMETER_ELEMENT
 1

	)

22 
	#WMM_OUI_SUBTYPE_TSPEC_ELEMENT
 2

	)

23 
	#WMM_VERSION
 1

	)

24 
	#WMM_ACTION_CODE_ADDTS_REQ
 0

	)

25 
	#WMM_ACTION_CODE_ADDTS_RESP
 1

	)

26 
	#WMM_ACTION_CODE_DELTS
 2

	)

27 
	#WMM_ADDTS_STATUS_ADMISSION_ACCEPTED
 0

	)

28 
	#WMM_ADDTS_STATUS_INVALID_PARAMETERS
 1

	)

30 
	#WMM_ADDTS_STATUS_REFUSED
 3

	)

34 
	#WMM_TSPEC_DIRECTION_UPLINK
 0

	)

35 
	#WMM_TSPEC_DIRECTION_DOWNLINK
 1

	)

37 
	#WMM_TSPEC_DIRECTION_BI_DIRECTIONAL
 3

	)

40 
	#WMM_TSPEC_PSB_UNSPECIFIED
 2

	)

42 
	#ADDTS_STATUS_ACCEPTED
 0x00

	)

43 
	#ADDTS_STATUS_INVALID_PARAM
 0x01

	)

44 
	#ADDTS_STATUS_REFUSED
 0x03

	)

45 
	#ADDTS_STATUS_DELAY
 0x2F

	)

46 
	#ADDTS_STATUS_UNSPECIFIED
 0xC8

	)

47 
	#ADDTS_STATUS_POLICY_CONFIG
 0xC9

	)

48 
	#ADDTS_STATUS_ASSOC_DENIED
 0xCA

	)

49 
	#ADDTS_STATUS_INVALID_PARAM2
 0xCB

	)

51 
	#TSINFO_MASK
 0x00FFFFFF

	)

53 
	#CCX_MAX_NUM_RATES
 8

	)

55 
	#TSID_MIN
 0

	)

56 
	#TSID_MAX
 7

	)

58 
	#TSRS_RATE_PER_UNIT
 500000

	)

59 
	#IEEE80211_HEADER_SIZE
 24

	)

61 
	#MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
 -1

	)

62 
	#BSS_CCX_DISABLED
 0

	)

63 
	#BSS_CCX_ENABLED
 1

	)

66 
	#CAC_GET_LE16
(
a
è((
u16
)((×)[1] << 8è| (a)[0]))

	)

67 
	#CAC_PUT_LE16
(
a
, 
v®
) \

69 (
a
)[1] = ((
u16
)(
v®
)) >> 8; \

70 (
a
)[0] = ((
u16
)(
v®
)) & 0xff; \

71 } 0)

	)

72 
	#CAC_PUT_BE24
(
a
, 
v®
) \

74 (
a
)[0] = (
u8
)((((
u32
)(
v®
)) >> 16) & 0xff); \

75 (
a
)[1] = (
u8
)((((
u32
)(
v®
)) >> 8) & 0xff); \

76 (
a
)[2] = (
u8
)(((
u32
)(
v®
)) & 0xff); \

77 } 0)

	)

78 
	#CAC_GET_LE24
(
a
è((((
u32
)×)[2]è<< 16è| (((u32)×)[1]è<< 8è| ((u32)×)[0]))

	)

79 
	#CAC_PUT_LE24
(
a
, 
v®
) \

81 (
a
)[2] = (
u8
)((((
u32
)(
v®
)) >> 16) & 0xff); \

82 (
a
)[1] = (
u8
)((((
u32
)(
v®
)) >> 8) & 0xff); \

83 (
a
)[0] = (
u8
)(((
u32
)(
v®
)) & 0xff); \

84 } 0)

	)

85 
	#CAC_GET_LE32
(
a
è((((
u32
)(a)[3]) << 24) | (((u32)(a)[2]) << 16) | \

86 (((
u32
)(
a
)[1]è<< 8è| ((u32)×)[0]))

	)

87 
	#CAC_PUT_LE32
(
a
, 
v®
) \

89 (
a
)[3] = (
u8
)((((
u32
)(
v®
)) >> 24) & 0xff); \

90 (
a
)[2] = (
u8
)((((
u32
)(
v®
)) >> 16) & 0xff); \

91 (
a
)[1] = (
u8
)((((
u32
)(
v®
)) >> 8) & 0xff); \

92 (
a
)[0] = (
u8
)(((
u32
)(
v®
)) & 0xff); \

93 } 0)

	)

95 
	#IEEE80211_FC
(
ty³
, 
¡y³
è(
u16
)Ñy³ | sty³)

	)

98 
	swmm_t¥ec_–em’t
 {

99 
	meid
;

100 
u8
 
	mËngth
;

101 
u8
 
	moui
[3];

102 
u8
 
	moui_ty³
;

103 
u8
 
	moui_subty³
;

104 
u8
 
	mv”siÚ
;

106 
u8
 
	mts_šfo
[3];

107 
u16
 
	mnomš®_msdu_size
;

108 
u16
 
	mmaximum_msdu_size
;

109 
u32
 
	mmšimum_£rviû_š‹rv®
;

110 
u32
 
	mmaximum_£rviû_š‹rv®
;

111 
u32
 
	mšaùiv™y_š‹rv®
;

112 
u32
 
	msu¥’siÚ_š‹rv®
;

113 
u32
 
	m£rviû_¡¬t_time
;

114 
u32
 
	mmšimum_d©a_¿‹
;

115 
u32
 
	mm—n_d©a_¿‹
;

116 
u32
 
	m³ak_d©a_¿‹
;

117 
u32
 
	mmaximum_bur¡_size
;

118 
u32
 
	md–ay_bound
;

119 
u32
 
	mmšimum_phy_¿‹
;

120 
u16
 
	msu½lus_bªdwidth_®lowªû
;

121 
u16
 
	mmedium_time
;

122 } 
	g__·cked
;

124 
	#MSDU_LIFETIME_DEFAULT
 512

	)

126 
	sÿc_aùiv©ed_t¥ec
 {

127 
wmm_t¥ec_–em’t
 
	mt¥ec
;

128 
	mebw
;

131 
	st¥ec_f›ld
 {

132 cÚ¡ *
	mÇme
;

133 
	m»ad_Úly
;

134 
	mis_tsšfo_f›ld
;

135 
u8
 
	msize
;

136 
u32
 
	moff£t
;

139 
	sÿc_t¥ec
 {

140 
ÿc_t¥ec
 *
	mÃxt
;

141 
	mid
;

142 
wmm_t¥ec_–em’t
 
	mt¥ec
;

143 
u8
 
	mpsb_¥ecif›d
;

144 
	mebw
;

145 
	macû±ed
;

146 
u8
 
	mdŸlog_tok’
;

149 
	#OFFSETOF
(
m
è((
size_t
)&((
wmm_t¥ec_–em’t
 *)0)->m)

	)

151 
	swmm_aùiÚ_hdr
 {

152 
u8
 
	mÿ‹gÜy
;

153 
u8
 
	maùiÚ
;

154 
u8
 
	mdŸlog_tok’
;

155 
u8
 
	m¡©us_code
;

156 } 
	g__·cked
;

158 
	saùiÚ_addts_»q
 {

159 
wmm_aùiÚ_hdr
 
	mhdr
;

160 
wmm_t¥ec_–em’t
 
	mt¥ec
;

161 } 
	g__·cked
;

163 
	saùiÚ_addts_r¥
 {

164 
wmm_aùiÚ_hdr
 
	mhdr
;

165 } 
	g__·cked
;

167 
	saùiÚ_d–ts_»q
 {

168 
wmm_aùiÚ_hdr
 
	mhdr
;

169 
wmm_t¥ec_–em’t
 
	mt¥ec
;

170 } 
	g__·cked
;

172 
ÿc_ù¾_ü—‹_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
);

173 
ÿc_ù¾_cÚfig_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
);

174 
ÿc_ù¾_£nd_addts
(
¦si_dev
 *
sdev
, *
¬gs
);

175 
ÿc_ù¾_£nd_d–ts
(
¦si_dev
 *
sdev
, *
¬gs
);

176 
ÿc_upd©e_loÿl_t¥ec
(
¦si_dev
 *
sdev
, 
u16
 
msdu_liãtime
, 
wmm_t¥ec_–em’t
 *
t¥ec
);

177 
ÿc_g‘_aùive_t¥ecs
(
ÿc_aùiv©ed_t¥ec
 **
t¥ecs
);

178 
ÿc_d–‘e_t¥ec_li¡
(
¦si_dev
 *
sdev
);

179 
ÿc_ù¾_d–‘e_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
);

180 
ÿc_rx_wmm_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
›“80211_mgmt
 *
d©a
, 
size_t
 
Ën
);

181 
ÿc_upd©e_rßm_Œaffic_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

	@cfg80211_ops.c

7 
	~<lšux/v”siÚ.h
>

8 
	~<Ãt/cfg80211.h
>

9 
	~<lšux/‘h”deviû.h
>

10 
	~"dev.h
"

11 
	~"cfg80211_İs.h
"

12 
	~"debug.h
"

13 
	~"mgt.h
"

14 
	~"mlme.h
"

15 
	~"Ãtif.h
"

16 
	~"unifiio.h
"

17 
	~"mib.h
"

18 
	~"scsc_wifogg”_ršg_pktç‹_­i.h
"

19 
	~"scsc_wifogg”_ršg_cÚÃùiv™y_­i.h
"

20 
	~"log2us.h
"

21 
	~"ba.h
"

22 
	~<scsc/scsc_w¬n.h
>

24 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


25 
	~"scsc_wifogg”_ršgs.h
"

27 
	~"Æ80211_v’dÜ.h
"

35 cÚ¡ 
u8
 
	g¦si_ex‹nded_ÿp
[] = {

39 cÚ¡ 
u8
 
	g¦si_ex‹nded_ÿp_mask
[] = {

43 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


44 
	#SLSI_DEFAULT_CH_MAX
 (64 + 
SLSI_NUM_6GHZ_CHANNELS
)

	)

46 
	#SLSI_DEFAULT_CH_MAX
 64

	)

49 
	s¦si_sÿn_·¿ms
 {

50 
›“80211_chªÃl
 *
	mchªÃls
[
SLSI_DEFAULT_CH_MAX
];

51 
	mchª_couÁ
;

52 
	msÿn_ty³
;

53 
u8
 *
	msÿn_›
;

54 
size_t
 
	msÿn_›_Ën
;

55 
	m¡r_wsc
;

56 
	m¡r_p2p
;

59 
ušt
 
	gk“p_®ive_³riod
 = 
SLSI_P2PGO_KEEP_ALIVE_PERIOD_SEC
;

60 
moduË_·¿m
(
k“p_®ive_³riod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

61 
MODULE_PARM_DESC
(
k“p_®ive_³riod
, "default is 10 seconds");

63 
boŞ
 
	$¦si_is_mhs_aùive
(
¦si_dev
 *
sdev
)

65 
Ãt_deviû
 *
mhs_dev
 = 
sdev
->
Ãtdev_­
;

66 
Ãtdev_vif
 *
ndev_vif
;

67 
boŞ
 
»t
;

69 ià(
mhs_dev
) {

70 
ndev_vif
 = 
	`Ãtdev_´iv
(
mhs_dev
);

71 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

72 
»t
 = 
ndev_vif
->
aùiv©ed
;

73 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

74  
»t
;

78 
	}
}

80 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(4, 12, 0))

81 
wœ–ess_dev
 *
	$¦si_add_vœtu®_štf
(
why
 *wiphy,

82 cÚ¡ *
Çme
,

83 
Çme_assign_ty³
,

84 
Æ80211_iáy³
 
ty³
,

85 
vif_·¿ms
 *
·¿ms
)

87 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

88 
wœ–ess_dev
 *
	$¦si_add_vœtu®_štf
(
why
 *wiphy,

89 cÚ¡ *
Çme
,

90 
Çme_assign_ty³
,

91 
Æ80211_iáy³
 
ty³
,

92 
u32
 *
æags
,

93 
vif_·¿ms
 *
·¿ms
)

96 
wœ–ess_dev
 *
	$¦si_add_vœtu®_štf
(
why
 *wiphy,

97 cÚ¡ *
Çme
,

98 
Æ80211_iáy³
 
ty³
,

99 
u32
 *
æags
,

100 
vif_·¿ms
 *
·¿ms
)

104 
Ãt_deviû
 *
dev
 = 
NULL
;

105 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

106 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

108 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 11, 0))

109 
	`SLSI_UNUSED_PARAMETER
(
æags
);

111 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "IÁàÇme:%s,y³:%d, maÿddr:%pM\n", 
Çme
, 
ty³
, 
·¿ms
->
maÿddr
);

112 ià(
	`¦si_is_mhs_aùive
(
sdev
)) {

113 
	`SLSI_ERR
(
sdev
, "MHS is‡ctive. cannot‡dd‚ew interface\n");

114  
	`ERR_PTR
(-
EOPNOTSUPP
);

116 
dev
 = 
	`¦si_dyÇmic_š‹rçû_ü—‹
(
why
, 
Çme
, 
ty³
, 
·¿ms
);

117 ià(!
dev
)

118 
ex™_w™h_”rÜ
;

119 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

121  &
ndev_vif
->
wdev
;

122 
ex™_w™h_”rÜ
:

123  
	`ERR_PTR
(-
ENODEV
);

124 
	}
}

126 
	$¦si_d–_vœtu®_štf
(
why
 *why, 
wœ–ess_dev
 *
wdev
)

128 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

129 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

131 ià(
	`WARN_ON
(!
dev
))

132  -
EINVAL
;

134 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Dev‚ame:%s\n", dev->
Çme
);

136 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

137 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

138 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev
);

139 ià(
dev
 =ğ
sdev
->
Ãtdev_­
)

140 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, 
NULL
);

141 ià(!
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
])

142 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
Ãtdev_­
);

143 ià(
dev
 =ğ
sdev
->
Ãtdev_p2p
)

144 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_p2p
, 
NULL
);

145 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

148 
	}
}

150 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(4, 12, 0))

151 
	$¦si_chªge_vœtu®_štf
(
why
 *wiphy,

152 
Ãt_deviû
 *
dev
,

153 
Æ80211_iáy³
 
ty³
,

154 
vif_·¿ms
 *
·¿ms
)

157 
	$¦si_chªge_vœtu®_štf
(
why
 *wiphy,

158 
Ãt_deviû
 *
dev
,

159 
Æ80211_iáy³
 
ty³
,

160 
u32
 *
æags
,

161 
vif_·¿ms
 *
·¿ms
)

165 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

166 
r
 = 0;

168 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 11, 0))

169 
	`SLSI_UNUSED_PARAMETER
(
æags
);

172 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

174 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "ty³:%u, iáy³:%d\n", 
ty³
, 
ndev_vif
->
iáy³
);

176 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
)) {

177 
r
 = -
EINVAL
;

178 
ex™
;

181 
ty³
) {

182 
NL80211_IFTYPE_UNSPECIFIED
:

183 
NL80211_IFTYPE_ADHOC
:

184 
NL80211_IFTYPE_STATION
:

185 
NL80211_IFTYPE_AP
:

186 
NL80211_IFTYPE_P2P_CLIENT
:

187 
NL80211_IFTYPE_P2P_GO
:

188 
NL80211_IFTYPE_MONITOR
:

189 
ndev_vif
->
iáy³
 = 
ty³
;

190 
dev
->
›“80211_±r
->
iáy³
 = 
ty³
;

191 ià(
·¿ms
)

192 
dev
->
›“80211_±r
->
u£_4addr
 = 
·¿ms
->use_4addr;

195 
r
 = -
EINVAL
;

199 
ex™
:

200 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

201  
r
;

202 
	}
}

204 
	$¦si_add_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

205 
u8
 
key_šdex
, 
boŞ
 
·œwi£
, cÚ¡ u8 *
mac_addr
,

206 
key_·¿ms
 *
·¿ms
)

208 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

209 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

210 
¦si_³”
 *
³”
 = 
NULL
;

211 
r
 = 0;

212 
u16
 
key_ty³
 = 
FAPI_KEYTYPE_GROUP
;

214 ià(
	`WARN_ON
(
·œwi£
 && !
mac_addr
))

215  -
EINVAL
;

217 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

219 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "(key_index:%d,…airwise:%d,‡ddress:%pM, cipher:0x%.8X, key_len:%d,"

220 "vif_ty³:%d)\n", 
key_šdex
, 
·œwi£
, 
mac_addr
, 
·¿ms
->
ch”
,…¬ams->
key_Ën
,

221 
ndev_vif
->
vif_ty³
);

223 ià(!
ndev_vif
->
aùiv©ed
) {

224 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "vif‚ot‡ctive\n");

225 
ex™
;

228 ià(
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_PMK
) {

229 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 
key_šdex
, 
key_ty³
, 
mac_addr
, 
·¿ms
);

230 
ex™
;

233 ià(
mac_addr
 && 
·œwi£
) {

235 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
mac_addr
);

236 ià(
³”
)

237 
mac_addr
 = 
³”
->
add»ss
;

238 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

240 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

241 ià(
³”
)

242 
mac_addr
 = 
³”
->
add»ss
;

243 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !
·œwi£
)

245 
mac_addr
 = 
dev
->
dev_addr
;

247 
r
 = -
EINVAL
;

248 
ex™
;

252 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

253 (
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_WEP40
 ||

254 
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_WEP104
è&& 
³”
) {

255 
u8
 
bc_mac_addr
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

257 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "WEP Key: store key\n");

258 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 
key_šdex
, 
FAPI_KEYTYPE_WEP
, 
bc_mac_addr
, 
·¿ms
);

259 ià(
r
 =ğ
FAPI_RESULTCODE_SUCCESS
) {

260 
ndev_vif
->
¡a
.
w•_key_£t
 = 
Œue
;

262 ià(
ndev_vif
->
add»ss
)

263 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

265 
	`SLSI_NET_ERR
(
dev
, "Error‡dding WEP key\n");

267 
ex™
;

270 ià(
·œwi£
) {

271 
key_ty³
 = 
FAPI_KEYTYPE_PAIRWISE
;

272 ià(
	`WARN_ON
(!
³”
)) {

273 
r
 = -
EINVAL
;

274 
ex™
;

276 } ià(
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_AES_CMAC
 ||…¬ams->ch” =ğ
WLAN_CIPHER_SUITE_BIP_GMAC_128
 ||

277 
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_BIP_GMAC_256
) {

278 
key_ty³
 = 
FAPI_KEYTYPE_IGTK
;

281 ià(
key_šdex
 == 6 || key_index == 7)

282 
key_ty³
 = 
FAPI_KEYTYPE_BIGTK
;

284 ià(
	`WARN
(!
mac_addr
, "mac_addr‚ot defined\n")) {

285 
r
 = -
EINVAL
;

286 
ex™
;

288 ià(!(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
key_šdex
 == 4)) {

289 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 
key_šdex
, 
key_ty³
, 
mac_addr
, 
·¿ms
);

290 ià(
r
) {

291 
	`SLSI_NET_ERR
(
dev
, "”rÜ iÀaddšg key (key_ty³: %d)\n", 
key_ty³
);

292 
ex™
;

296 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

297 
ndev_vif
->
¡a
.
—p_ho¡g
 = 0xFFFF;

299 ià(
ndev_vif
->
add»ss
)

300 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

303 ià(
key_ty³
 =ğ
FAPI_KEYTYPE_GROUP
) {

304 
ndev_vif
->
¡a
.
group_key_£t
 = 
Œue
;

305 
ndev_vif
->
­
.
ch”
 = 
·¿ms
->cipher;

306 } ià(
key_ty³
 =ğ
FAPI_KEYTYPE_PAIRWISE
) {

307 ià(
³”
) {

308 
	`¦si_ba_»¶ay_»£t_²
(
dev
, 
³”
);

309 
³”
->
·œwi£_key_£t
 = 
Œue
;

313 ià(
³”
) {

314 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

315 ià(
·œwi£
 && 
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_SMS4
) {

316 
	`¦si_mlme_cÚÃù_»¥
(
sdev
, 
dev
);

317 ià(
ndev_vif
->
add»ss
)

318 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

320 
	`¦si_£t_aş
(
sdev
, 
dev
);

321 
	`¦si_£t_·ck‘_f‹rs
(
sdev
, 
dev
);

322 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

325 ià(
ndev_vif
->
¡a
.
g¿tu™ous_¬p_Ãeded
) {

326 
ndev_vif
->
¡a
.
g¿tu™ous_¬p_Ãeded
 = 
çl£
;

327 
	`¦si_£nd_g¿tu™ous_¬p
(
sdev
, 
dev
);

329 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
·œwi£
) {

330 
	`¦si_mlme_cÚÃùed_»¥
(
sdev
, 
dev
, 
³”
->
aid
);

331 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

332 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

333 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
)

334 
ndev_vif
->
­
.
p2p_gc_keys_£t
 = 
Œue
;

338 
ex™
:

339 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

340  
r
;

341 
	}
}

343 
	$¦si_d–_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

344 
u8
 
key_šdex
, 
boŞ
 
·œwi£
, cÚ¡ u8 *
mac_addr
)

346 
	`SLSI_UNUSED_PARAMETER
(
why
);

347 
	`SLSI_UNUSED_PARAMETER
(
key_šdex
);

348 
	`SLSI_UNUSED_PARAMETER
(
·œwi£
);

349 
	`SLSI_UNUSED_PARAMETER
(
mac_addr
);

351 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

352 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DELETEKEYS.request\n");

353  -
EOPNOTSUPP
;

357 
	}
}

359 
	$¦si_chªÃl_sw™ch
(
why
 *why, 
Ãt_deviû
 *
dev
, 
cfg80211_c§_£‰šgs
 *
·¿ms
)

361 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

362 
Ãtdev_vif
 *
­_dev_vif
;

363 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

364 
Ãt_deviû
 *
wÏn_dev
;

365 
Ãtdev_vif
 *
ndev_¡a_vif
;

366 
»suÉ
 = 0;

367 
u16
 
ûÁ”_äeq
 = 0;

368 
u16
 
chª_šfo
 = 0;

369 
u16
 
cu¼’t_chª_šfo
 = 0;

370 
cfg80211_chª_def
 
chªdef
 = 
·¿ms
->chandef;

371 
cfg80211_chª_def
 
cu¼’t_chªdef
 = 
ndev_vif
->
chªdef_§ved
;

372 
Ãt_deviû
 *
­_dev
 = 
NULL
;

373 
›“80211_chªÃl
 *
chª
 = 
chªdef
.chan;

374 
width
 = 
chªdef
.width;

376 
wÏn_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

377 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

378 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_AP
) {

379 
	`SLSI_NET_ERR
(
dev
, "AP Mode is‚ot‡ctive\n");

380 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

381  -
EPERM
;

383 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

384 
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
wÏn_dev
);

385 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


386 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
)) {

387 ià(
ndev_¡a_vif
) {

388 
	`SLSI_MUTEX_LOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

389 ià(
ndev_¡a_vif
->
aùiv©ed
 &&‚dev_¡a_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

390 (
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

391 
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

392 
	`SLSI_NET_ERR
(
dev
, "Sta is in connected state (Chan Switch‚ot‡llowed in WiFi Sharing mode)\n");

393 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

394  -
EPERM
;

396 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

401 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

402 ià(
cu¼’t_chªdef
.
chª
->
ûÁ”_äeq
 == chan->center_freq) {

403 
cu¼’t_chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, &
cu¼’t_chªdef
);

404 ià(
cu¼’t_chª_šfo
 =ğ
	`¦si_g‘_chªn_šfo
(
sdev
, &
chªdef
)) {

405 
	`SLSI_NET_ERR
(
dev
, "ChªÃÈSw™ch„eque¡ed oÀcu¼’ˆchªÃÈäeq-> %u‡nd Chª infØ%d\n", 
cu¼’t_chªdef
.
chª
->
ûÁ”_äeq
, 
cu¼’t_chª_šfo
);

406 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

407  -
EPERM
;

410 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

412 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

413 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, &
chªdef
);

414 
ûÁ”_äeq
 = 
chª
->center_freq;

415 ià(
width
 !ğ
NL80211_CHAN_WIDTH_20_NOHT
 && width !ğ
NL80211_CHAN_WIDTH_20
)

416 
ûÁ”_äeq
 = 
	`¦si_g‘_ûÁ”_äeq1
(
sdev
, 
chª_šfo
, center_freq);

417 
­_dev_vif
 = 
	`Ãtdev_´iv
(
­_dev
);

418 
	`SLSI_MUTEX_LOCK
(
­_dev_vif
->
vif_mu‹x
);

419 
»suÉ
 = 
	`¦si_mlme_chªÃl_sw™ch
(
sdev
, 
­_dev
, 
ûÁ”_äeq
, 
chª_šfo
);

420 
	`SLSI_MUTEX_UNLOCK
(
­_dev_vif
->
vif_mu‹x
);

421  
»suÉ
;

422 
	}
}

424 
	$¦si_g‘_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

425 
u8
 
key_šdex
, 
boŞ
 
·œwi£
, cÚ¡ u8 *
mac_addr
,

426 *
cook›
,

427 (*
ÿÎback
)(*
cook›
, 
key_·¿ms
 *))

429 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

430 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

431 
key_·¿ms
 
·¿ms
;

433 
	#SLSI_MAX_KEY_SIZE
 8

	)

434 
u8
 
key_£q
[
SLSI_MAX_KEY_SIZE
] = { 0 };

435 
r
 = 0;

437 
	`SLSI_UNUSED_PARAMETER
(
mac_addr
);

439 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

440 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_GET_KEY_SEQUENCE.request\n");

441  -
EOPNOTSUPP
;

444 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

446 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "(key_šdex:%d,…aœwi£:%d, mac_addr:%pM, vif_ty³:%d)\n", 
key_šdex
,

447 
·œwi£
, 
mac_addr
, 
ndev_vif
->
vif_ty³
);

449 ià(!
ndev_vif
->
aùiv©ed
) {

450 
	`SLSI_NET_ERR
(
dev
, "vif‚ot‡ctive\n");

451 
r
 = -
EINVAL
;

452 
ex™
;

456 ià(
FAPI_VIFTYPE_AP
 !ğ
ndev_vif
->
vif_ty³
) {

457 
	`SLSI_NET_ERR
(
dev
, "Inv®id viàty³: %d\n", 
ndev_vif
->
vif_ty³
);

458 
r
 = -
EINVAL
;

459 
ex™
;

461 ià(
·œwi£
) {

462 
	`SLSI_NET_ERR
(
dev
, "Invalid keyype\n");

463 
r
 = -
EINVAL
;

464 
ex™
;

467 
	`mem£t
(&
·¿ms
, 0, (params));

469 
·¿ms
.
key
 = 
NULL
;

470 
·¿ms
.
key_Ën
 = 0;

471 
·¿ms
.
ch”
 = 
ndev_vif
->
­
.cipher;

472 ià(!(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
key_šdex
 == 4)) {

473 
r
 = 
	`¦si_mlme_g‘_key
(
sdev
, 
dev
, 
key_šdex
, 
FAPI_KEYTYPE_GROUP
, 
key_£q
, &
·¿ms
.
£q_Ën
);

475 ià(!
r
) {

476 
·¿ms
.
£q
 = 
key_£q
;

477 
	`ÿÎback
(
cook›
, &
·¿ms
);

480 #undeà
SLSI_MAX_KEY_SIZE


481 
ex™
:

482 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

483  
r
;

484 
	}
}

486 
boŞ
 
	$¦si_is_p2p_sÿn_»q
(
cfg80211_sÿn_»que¡
 *
»que¡
)

488 ià(
»que¡
->
›
 &&

489 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
WLAN_OUI_TYPE_WFA_P2P
, 
»que¡
->
›
,„eque¡->
›_Ën
) &&

490 
»que¡
->
ssids
 && 
	`SLSI_IS_P2P_SSID
Ôeque¡->ssids[0].
ssid
,„eque¡->ssids[0].
ssid_Ën
))

491  
Œue
;

492  
çl£
;

493 
	}
}

495 
	$¦si_p2p_ÿnûl_un£t_chªÃl
(
¦si_dev
 *
sdev
, 
cfg80211_sÿn_»que¡
 *
»que¡
)

497 
Ãt_deviû
 *
dev
 = 
»que¡
->
wdev
->
Ãtdev
;

498 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

500 ià(!
	`¦si_is_p2p_sÿn_»q
(
»que¡
))

503 ià(
ndev_vif
->
drv_š_p2p_´oûdu»
)

506 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
)) {

507 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

508 
	`¦si_mlme_un£t_chªÃl_»q
(
sdev
, 
dev
);

509 
ndev_vif
->
driv”_chªÃl
 = 0;

511 
	}
}

513 
	$¦si_£t_wÏn_sÿn_ty³_·¿m
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

514 
¦si_sÿn_·¿ms
 *
·¿ms
)

516 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

518 
·¿ms
->
sÿn_ty³
 = 
FAPI_SCANTYPE_FULL_SCAN
;

519 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

520 ià(
·¿ms
->
chª_couÁ
 == 1) {

521 
·¿ms
->
sÿn_ty³
 = 
FAPI_SCANTYPE_SINGLE_CHANNEL_SCAN
;

525 ià(
sdev
->
š™Ÿl_sÿn
) {

526 
sdev
->
š™Ÿl_sÿn
 = 
çl£
;

527 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTING
 &&

528 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)

529 
·¿ms
->
sÿn_ty³
 = 
FAPI_SCANTYPE_INITIAL_SCAN
;

531 
	}
}

533 
	$¦si_£t_p2p_socŸl_ch_·¿m
(
cfg80211_sÿn_»que¡
 *
»que¡
,

534 
¦si_sÿn_·¿ms
 *
·¿ms
)

536 
couÁ
 = 0, 
chªn
 = 0, 
i
 = 0;

538 
i
 = 0; i < 
»que¡
->
n_chªÃls
; i++) {

539 
chªn
 = 
·¿ms
->
chªÃls
[
i
]->
hw_v®ue
 & 0xFF;

540 ià(
	`SLSI_P2P_IS_SOCAIL_CHAN
(
chªn
)) {

541 
·¿ms
->
chªÃls
[
couÁ
] = 
»que¡
->chªÃls[
i
];

542 
couÁ
++;

545 
·¿ms
->
chª_couÁ
 = 
couÁ
;

546 
	}
}

548 
	$¦si_£t_p2p_sÿn_ty³_·¿m
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

549 
cfg80211_sÿn_»que¡
 *
»que¡
,

550 
¦si_sÿn_·¿ms
 *
·¿ms
)

552 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

554 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_GROUP_FORMED_GO
)

555 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

561 ià(
»que¡
->
n_chªÃls
 =ğ
SLSI_P2P_SOCIAL_CHAN_COUNT
 ||„equest->n_channels == 1) {

562 
·¿ms
->
sÿn_ty³
 = 
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
;

563 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

564 } ià(
»que¡
->
n_chªÃls
 > 
SLSI_P2P_SOCIAL_CHAN_COUNT
) {

565 ià(!
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
) {

566 
·¿ms
->
sÿn_ty³
 = 
FAPI_SCANTYPE_P2P_SCAN_FULL
;

567 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
Œue
;

569 
·¿ms
->
sÿn_ty³
 = 
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
;

570 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

571 
	`¦si_£t_p2p_socŸl_ch_·¿m
(
»que¡
, 
·¿ms
);

574 
	}
}

576 
	$¦si_£t_sÿn_ty³_·¿m
(
¦si_dev
 *
sdev
, 
cfg80211_sÿn_»que¡
 *
»que¡
,

577 
¦si_sÿn_·¿ms
 *
·¿ms
)

579 
Ãt_deviû
 *
dev
 = 
»que¡
->
wdev
->
Ãtdev
;

580 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

582 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

583 
	`¦si_£t_wÏn_sÿn_ty³_·¿m
(
sdev
, 
dev
, 
·¿ms
);

585 ià(
	`¦si_is_p2p_sÿn_»q
(
»que¡
))

586 
	`¦si_£t_p2p_sÿn_ty³_·¿m
(
sdev
, 
dev
, 
»que¡
, 
·¿ms
);

587 
	}
}

589 
boŞ
 
	$¦si_is_p2p_wsc_›_¡r_cÚd™iÚ
(
Ãt_deviû
 *
dev
, 
cfg80211_sÿn_»que¡
 *
»que¡
,

590 
¦si_sÿn_·¿ms
 *
·¿ms
)

592 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

594 #ifdeà
CONFIG_SCSC_WLAN_DUAL_STATION


595 ià((
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è||‚dev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
è&& 
»que¡
->
›
 &&

596 !(
·¿ms
->
sÿn_ty³
 =ğ
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
 ||…¬ams->sÿn_ty³ =ğ
FAPI_SCANTYPE_P2P_SCAN_FULL
))

597  
Œue
;

599 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& 
»que¡
->
›
)

600  
Œue
;

602  
çl£
;

603 
	}
}

605 
	$¦si_sÿn_£t_p2p_wps_¡r_·¿m
(cÚ¡ 
u8
 *
»que¡_›
, 
size_t
 
»que¡_›_Ën
,

606 
¦si_sÿn_·¿ms
 *
·¿ms
)

608 cÚ¡ 
u8
 *
›
;

614 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
»que¡_›
, 
»que¡_›_Ën
);

615 ià(
›
 && ie[1] > 
SLSI_WPS_REQUEST_TYPE_POS
) {

619 ià(
›
[
SLSI_WPS_REQUEST_TYPE_POS
] =ğ
SLSI_WPS_REQUEST_TYPE_ENROLEE_INFO_ONLY
)

620 
·¿ms
->
¡r_wsc
 = 
Œue
;

623 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
WLAN_OUI_TYPE_WFA_P2P
, 
»que¡_›
, 
»que¡_›_Ën
);

624 ià(
›
)

625 
·¿ms
->
¡r_p2p
 = 
Œue
;

626 
	}
}

628 
size_t
 
	$¦si_¡r_wsc_p2p_›
(cÚ¡ 
u8
 *
¤c_›
, 
size_t
 
¤c_›_Ën
, u8 *
de¡_›
, 
boŞ
 
¡r_wsc
, boŞ 
¡r_p2p
)

630 cÚ¡ 
u8
 *
›
;

631 cÚ¡ 
u8
 *
Ãxt_›
;

632 
size_t
 
de¡_›_Ën
 = 0;

634 ià(!
de¡_›
 || !(
¡r_p2p
 || 
¡r_wsc
))

635  
de¡_›_Ën
;

637 
›
 = 
¤c_›
; (› - src_›è< 
¤c_›_Ën
; iğ
Ãxt_›
) {

638 
Ãxt_›
 = 
›
 + ie[1] + 2;

640 ià(
›
[0] =ğ
WLAN_EID_VENDOR_SPECIFIC
 && ie[1] > 4) {

641 
i
;

642 
oui
 = 0;

644 
i
 = 0; i < 4; i++)

645 
oui
 = (ou˜<< 8è| 
›
[5 - 
i
];

647 ià(
¡r_wsc
 && 
oui
 =ğ
SLSI_WPS_OUI_PATTERN
)

649 ià(
¡r_p2p
 && 
oui
 =ğ
SLSI_P2P_OUI_PATTERN
)

653 ià(
Ãxt_›
 - 
¤c_›
 <ğ
¤c_›_Ën
) {

654 
	`memıy
(
de¡_›
 + 
de¡_›_Ën
, 
›
, ie[1] + 2);

655 
de¡_›_Ën
 +ğ
›
[1] + 2;

659  
de¡_›_Ën
;

660 
	}
}

662 
	$¦si_®loc_sÿn_›_·¿m
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
»q_›
, 
size_t
 
»q_›_Ën
,

663 
¦si_sÿn_·¿ms
 *
·¿ms
)

665 ià(
·¿ms
->
¡r_wsc
 ||…¬ams->
¡r_p2p
) {

666 
·¿ms
->
sÿn_›
 = 
	`km®loc
(
»q_›_Ën
, 
GFP_KERNEL
);

667 ià(!
·¿ms
->
sÿn_›
) {

668 
	`SLSI_NET_INFO
(
dev
, "Out of memory for scan IEs\n");

669  -
ENOMEM
;

671 
·¿ms
->
sÿn_›_Ën
 = 
	`¦si_¡r_wsc_p2p_›
(
»q_›
, 
»q_›_Ën
,

672 
·¿ms
->
sÿn_›
,…¬ams->
¡r_wsc
,…¬ams->
¡r_p2p
);

674 
·¿ms
->
sÿn_›
 = (
u8
 *)
»q_›
;

675 
·¿ms
->
sÿn_›_Ën
 = 
»q_›_Ën
;

678 
	}
}

680 
	$¦si_ä“_sÿn_›_·¿m
(
¦si_sÿn_·¿ms
 *
·¿ms
)

682 ià(
·¿ms
->
¡r_p2p
 ||…¬ams->
¡r_wsc
)

683 
	`kä“
(
·¿ms
->
sÿn_›
);

684 
	}
}

686 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


687 
	$¦si_£t_mac_¿ndomiz©iÚ
(
¦si_dev
 *
sdev
, 
cfg80211_sÿn_»que¡
 *
»que¡
,

688 
¦si_sÿn_·¿ms
 *
·¿ms
)

690 
Ãt_deviû
 *
dev
 = 
»que¡
->
wdev
->
Ãtdev
;

691 
u8
 
mac_addr_mask
[
ETH_ALEN
] = {0xFF};

692 
boŞ
 
wps_¡a
 = 
çl£
;

693 
r
 = 0;

694 cÚ¡ 
u8
 *
›
;

696 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
»que¡
->›,„eque¡->
›_Ën
);

697 ià(
›
 && ie[1] > 
SLSI_WPS_REQUEST_TYPE_POS
)

698 ià(
›
[
SLSI_WPS_REQUEST_TYPE_POS
] !ğ
SLSI_WPS_REQUEST_TYPE_ENROLEE_INFO_ONLY
)

699 
wps_¡a
 = 
Œue
;

705 ià(
»que¡
->
æags
 & 
NL80211_SCAN_FLAG_RANDOM_ADDR
 && !
wps_¡a
) {

706 ià(
sdev
->
fw_mac_¿ndomiz©iÚ_’abËd
) {

707 
	`memıy
(
sdev
->
sÿn_mac_addr
, 
»que¡
->
mac_addr
, 
ETH_ALEN
);

708 
r
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
»que¡
->
mac_addr_mask
);

709 ià(!
r
)

710 
sdev
->
sÿn_addr_£t
 = 1;

712 
	`SLSI_NET_INFO
(
dev
, "Mac Randomization is‚otƒnabled in Firmware\n");

713 
sdev
->
sÿn_addr_£t
 = 0;

715 } ià(
sdev
->
sÿn_addr_£t
) {

716 
	`mem£t
(
mac_addr_mask
, 0xFF, 
ETH_ALEN
);

717 
r
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
mac_addr_mask
);

718 
sdev
->
sÿn_addr_£t
 = 0;

720 
	}
}

723 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

724 
	$¦si_£t_¡a_fÜw¬d_b—cÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

726 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

727 
»t
 = 0;

729 ià(!
ndev_vif
->
is_ws_ruÂšg
)

732 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

735 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)

738 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Scan invokes DRIVER_BCN_ABORT\n");

739 
»t
 = 
	`¦si_mlme_£t_fÜw¬d_b—cÚ
(
sdev
, 
dev
, 
FAPI_ACTION_STOP
);

740 ià(
»t
 < 0)

741 
»t
 = 
	`¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
sdev
, 
dev
,

742 
SLSI_FORWARD_BEACON_ABORT_REASON_SCANNING
);

743 
	}
}

746 
	$¦si_upd©e_¡©e_sÿn_š_deviû_rŞe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

747 
¦si_sÿn_·¿ms
 *
·¿ms
)

749 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

751 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è|| 
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
))

754 ià(
·¿ms
->
sÿn_ty³
 =ğ
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
)

755 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_SCANNING
);

756 
	}
}

758 
	$¦si_sÿn_§ve_´obe_»q_›s
(
cfg80211_sÿn_»que¡
 *
»que¡
,

759 
¦si_sÿn_·¿ms
 *
·¿ms
)

761 
Ãt_deviû
 *
dev
 = 
»que¡
->
wdev
->
Ãtdev
;

762 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

764 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è|| !
·¿ms
->
sÿn_›_Ën
)

767 
	`kä“
(
ndev_vif
->
´obe_»q_›s
);

768 
ndev_vif
->
´obe_»q_›s
 = 
	`km®loc
(
»que¡
->
›_Ën
, 
GFP_KERNEL
);

769 ià(!
ndev_vif
->
´obe_»q_›s
) {

770 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

772 
ndev_vif
->
´obe_»q_›_Ën
 = 
·¿ms
->
sÿn_›_Ën
;

773 
	`memıy
(
ndev_vif
->
´obe_»q_›s
, 
·¿ms
->
sÿn_›
,…¬ams->
sÿn_›_Ën
);

775 
	}
}

777 
	$¦si_abÜt_hw_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

779 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

781 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

783 
	`SLSI_NET_INFO
(
dev
, "Abort on-going scan, vif_index:%d,"

784 "ndev_vif->sÿn[SLSI_SCAN_HW_ID].sÿn_»q:%p\n", 
ndev_vif
->
iâum
,

785 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
);

787 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

788 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
, 
çl£
);

789 
	`¦si_sÿn_com¶‘e
(
sdev
, 
dev
, 
SLSI_SCAN_HW_ID
, 
çl£
, false);

791 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

792 
	}
}

794 
	$¦si_abÜt_sÿn
(
why
 *why, 
wœ–ess_dev
 *
wdev
)

796 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

797 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

798 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

800 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

801 
	`¦si_abÜt_hw_sÿn
(
sdev
, 
dev
);

802 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

803 
	}
}

805 
	$¦si_sÿn
(
why
 *wiphy,

806 
cfg80211_sÿn_»que¡
 *
»que¡
)

808 
Ãt_deviû
 *
dev
 = 
NULL
;

809 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

810 
¦si_dev
 *
sdev
 = 
NULL
;

811 
r
 = 0, 
i
 = 0;

812 
¦si_sÿn_·¿ms
 
·¿ms
 = {

813 .
sÿn_ty³
 = 
FAPI_SCANTYPE_FULL_SCAN
, .
chª_couÁ
 = 0,

814 .
¡r_wsc
 = 
çl£
, .
¡r_p2p
 = false

817 ià(!
»que¡
->
wdev
 || !»que¡->wdev->
Ãtdev
) {

818 
	`SLSI_ERR_NODEV
("wdev or‚et_dev NULL\n");

819  -
EINVAL
;

822 
dev
 = 
»que¡
->
wdev
->
Ãtdev
;

823 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

824 
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

826 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

827 
	`SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

828  -
EOPNOTSUPP
;

832 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
) {

833 
	`SLSI_NET_INFO
(
dev
, "Scan„eceived in P2P Action Frame Tx/Rx state - Reject (exp_frame=%s)\n",

834 
	`¦si_·_subty³_‹xt
(()
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
));

835  -
EBUSY
;

838 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

840 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

841 
	`SLSI_NET_INFO
(
dev
, "Rejecting scan„equest‡s†ast scan is still„unning\n");

842 
r
 = -
EBUSY
;

843 
ex™
;

846 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

847 
	`¦si_£t_¡a_fÜw¬d_b—cÚ
(
sdev
, 
dev
);

849 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "chªÃls:%d, ssids:%d, ie_Ën:%d, vif_šdex:%d\n", 
»que¡
->
n_chªÃls
,

850 
»que¡
->
n_ssids
, (ìeque¡->
›_Ën
, 
ndev_vif
->
iâum
);

852 
	`¦si_p2p_ÿnûl_un£t_chªÃl
(
sdev
, 
»que¡
);

854 
i
 = 0; i < 
»que¡
->
n_chªÃls
; i++)

855 
·¿ms
.
chªÃls
[
i
] = 
»que¡
->channels[i];

856 
·¿ms
.
chª_couÁ
 = 
»que¡
->
n_chªÃls
;

857 
	`¦si_£t_sÿn_ty³_·¿m
(
sdev
, 
»que¡
, &
·¿ms
);

859 ià(
	`¦si_is_p2p_wsc_›_¡r_cÚd™iÚ
(
dev
, 
»que¡
, &
·¿ms
))

860 
	`¦si_sÿn_£t_p2p_wps_¡r_·¿m
(
»que¡
->
›
,„eque¡->
›_Ën
, &
·¿ms
);

861 
r
 = 
	`¦si_®loc_sÿn_›_·¿m
(
dev
, 
»que¡
->
›
,„eque¡->
›_Ën
, &
·¿ms
);

862 ià(
r
 < 0)

863 
ex™
;

866 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

868 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

869 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
SLSI_SCAN_HW_ID
);

870 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


871 
	`¦si_£t_mac_¿ndomiz©iÚ
(
sdev
, 
»que¡
, &
·¿ms
);

874 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

875 
dev
,

876 
·¿ms
.
sÿn_ty³
,

877 
FAPI_REPORTMODE_REAL_TIME
,

878 
»que¡
->
n_ssids
,

879 
»que¡
->
ssids
,

880 
·¿ms
.
chª_couÁ
,

881 
·¿ms
.
chªÃls
,

882 
NULL
,

883 
·¿ms
.
sÿn_›
,

884 
·¿ms
.
sÿn_›_Ën
,

885 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


886 
»que¡
->
n_6ghz_·¿ms
,

887 
»que¡
->
sÿn_6ghz_·¿ms
,

889 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

890 ià(
r
 == 0) {

891 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
»que¡
;

896 ià(
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
sÿn_timeout_wÜk
,

897 
	`m£cs_to_jiff›s
(
SLSI_FW_SCAN_DONE_TIMEOUT_MSEC
)))

898 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

900 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
Œue
;

901 
	`¦si_upd©e_¡©e_sÿn_š_deviû_rŞe
(
sdev
, 
dev
, &
·¿ms
);

902 
	`¦si_sÿn_§ve_´obe_»q_›s
(
»que¡
, &
·¿ms
);

904 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "add_sÿÀ”rÜ: %d\n", 
r
);

905 
r
 = -
EIO
;

907 
	`¦si_ä“_sÿn_›_·¿m
(&
·¿ms
);

908 
ex™
:

909 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

910  
r
;

911 
	}
}

913 
	$¦si_sched_sÿn_¡¬t
(
why
 *wiphy,

914 
Ãt_deviû
 *
dev
,

915 
cfg80211_sched_sÿn_»que¡
 *
»que¡
)

917 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

918 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

919 
r
;

920 
¦si_sÿn_·¿ms
 
·¿ms
;

922 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

923 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_ADD_SCAN.request\n");

924  -
EOPNOTSUPP
;

930 ià(!
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

931 
	`SLSI_NET_INFO
(
dev
, "ScheduËd sÿÀ»q„eûived oÀvià%d - Rejeù\n", 
ndev_vif
->
iâum
);

932  -
EINVAL
;

938 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
) {

939 
	`SLSI_NET_INFO
(
dev
, "Scheduled scan„eq„eceived in P2P Action Frame Tx/Rx state - Reject\n");

940  -
EBUSY
;

943 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

945 
	`SLSI_NET_INFO
(
dev
, "chªÃls:%d, ssids:%d, ie_Ën:%d, vif_šdex:%d, sÿn_¶ªs:%d\n", 
»que¡
->
n_chªÃls
,

946 
»que¡
->
n_ssids
, (ìeque¡->
›_Ën
, 
ndev_vif
->
iâum
,„eque¡->
n_sÿn_¶ªs
);

948 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sched_»q
) {

949 
r
 = -
EBUSY
;

950 
ex™
;

953 
	`mem£t
(&
·¿ms
, 0, (
¦si_sÿn_·¿ms
));

954 ià(
»que¡
->
›
)

955 
	`¦si_sÿn_£t_p2p_wps_¡r_·¿m
(
»que¡
->
›
,„eque¡->
›_Ën
, &
·¿ms
);

956 
r
 = 
	`¦si_®loc_sÿn_›_·¿m
(
dev
, 
»que¡
->
›
,„eque¡->
›_Ën
, &
·¿ms
);

957 ià(
r
 != 0)

958 
ex™
;

960 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
SLSI_SCAN_SCHED_ID
);

961 
r
 = 
	`¦si_mlme_add_sched_sÿn
(
sdev
, 
dev
, 
»que¡
, 
·¿ms
.
sÿn_›
,…¬ams.
sÿn_›_Ën
);

962 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
»que¡
;

963 
	`¦si_ä“_sÿn_›_·¿m
(&
·¿ms
);

965 ià(
r
 != 0) {

966 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "add_sÿÀ”rÜ: %d\n", 
r
);

967 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
NULL
;

968 
r
 = -
EIO
;

971 
ex™
:

972 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

973  
r
;

974 
	}
}

976 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(4, 12, 0))

977 
	$¦si_sched_sÿn_¡İ
(
why
 *why, 
Ãt_deviû
 *
dev
, 
u64
 
»qid
)

980 
	$¦si_sched_sÿn_¡İ
(
why
 *why, 
Ãt_deviû
 *
dev
)

983 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

984 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

985 
r
 = 0;

987 
	`SLSI_UNUSED_PARAMETER
(
»qid
);

988 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

989 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "vif_šdex:%d", 
ndev_vif
->
iâum
);

990 ià(!
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
) {

991 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "No sched scan„eq\n");

992 
ex™
;

995 
r
 = 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_SCHED_ID
), 
çl£
);

997 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
NULL
;

999 
ex™
:

1000 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1001  
r
;

1002 
	}
}

1004 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1005 
	$¦si_§ve_cÚÃùiÚ_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1006 
cfg80211_cÚÃù_·¿ms
 *
sme
,

1007 
›“80211_chªÃl
 *
chªÃl
, cÚ¡ 
u8
 *
bssid
,

1008 
u32
 
aùiÚ_äame_bm­
, u32 
aùiÚ_äame_su¥’d_bm­
)

1010 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1012 
	`mem£t
(&
ndev_vif
->
¡a
.
sme
, 0, (
cfg80211_cÚÃù_·¿ms
));

1013 
ndev_vif
->
¡a
.
sme
 = *sme;

1015 ià(
sme
->
›
 && sme->
›_Ën
)

1016 
ndev_vif
->
¡a
.
sme
.
›
 = 
	`¦si_mem_dup
((
u8
 *)sme->›, sme->
›_Ën
);

1018 
ndev_vif
->
¡a
.
sme
.
›
 = 
NULL
;

1020 ià(
sme
->
ssid
 && sme->
ssid_Ën
)

1021 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
	`¦si_mem_dup
((
u8
 *)sme->ssid, sme->
ssid_Ën
);

1023 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
NULL
;

1025 ià(
sme
->
key
 && sme->
key_Ën
)

1026 
ndev_vif
->
¡a
.
sme
.
key
 = 
	`¦si_mem_dup
((
u8
 *)sme->key, sme->
key_Ën
);

1028 
ndev_vif
->
¡a
.
sme
.
key
 = 
NULL
;

1030 
ndev_vif
->
¡a
.
aùiÚ_äame_bm­
 =‡ction_frame_bmap;

1031 
ndev_vif
->
¡a
.
aùiÚ_äame_su¥’d_bm­
 =‡ction_frame_suspend_bmap;

1032 
ndev_vif
->
¡a
.
cÚÃùed_bssid
 = 
	`¦si_mem_dup
((
u8
 *)
bssid
, 
ETH_ALEN
);

1033 
ndev_vif
->
¡a
.
cÚÃùed_ssid_Ën
 = ()
sme
->
ssid_Ën
;

1034 
ndev_vif
->
¡a
.
cÚÃùed_ssid
 = 
	`¦si_mem_dup
((
u8
 *)
sme
->
ssid
,‚dev_vif->¡a.
cÚÃùed_ssid_Ën
);

1035 
	}
}

1038 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1039 
	$¦si_£t_·¿ms_Ú_bss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
,

1040 
›“80211_chªÃl
 **
chªÃl
, cÚ¡ 
u8
 **
bssid
)

1042 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1044 
ndev_vif
->
¡a
.
akm_ty³
 = 
	`¦si_bss_cÚÃù_ty³_g‘
(
sdev
, 
sme
->
›
, sme->
›_Ën
);

1045 
ndev_vif
->
¡a
.
ssid_Ën
 = 
sme
->ssid_len;

1046 
	`memıy
(
ndev_vif
->
¡a
.
ssid
, 
sme
->ssid, sme->
ssid_Ën
);

1050 ià(!
sme
->
bssid
) {

1051 
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 = 
Œue
;

1052 ià(
sme
->
bssid_hšt
) {

1053 *
bssid
 = 
sme
->
bssid_hšt
;

1054 *
chªÃl
 = 
sme
->
chªÃl_hšt
;

1057 
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 = 
çl£
;

1059 
	}
}

1062 
	$¦si_check_wificÚÃù_to_cÚÃùedGo
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
)

1064 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1065 
Ãt_deviû
 *
p2p_dev
;

1066 
Ãtdev_vif
 *
ndev_p2p_vif
;

1068 ià(
bssid
) {

1069 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& 
sdev
->
p2p_¡©e
 =ğ
P2P_GROUP_FORMED_CLI
) {

1070 
p2p_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

1071 ià(
p2p_dev
) {

1072 
ndev_p2p_vif
 = 
	`Ãtdev_´iv
(
p2p_dev
);

1073 ià(
ndev_p2p_vif
->
¡a
.
¡a_bss
) {

1074 ià(
	`SLSI_ETHER_EQUAL
(
ndev_p2p_vif
->
¡a
.
¡a_bss
->
bssid
, bssid))

1075  -
EINVAL
;

1081 
	}
}

1083 
	$¦si_£t_rßm_»assoc
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

1085 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1086 
¦si_³”
 *
³”
;

1087 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

1088 
r
 = 0;

1091 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

1092 ià(
	`WARN_ON
(!
³”
))

1093  -
EINVAL
;

1095 ià(!
sme
->
bssid
 && !sme->
bssid_hšt
) {

1096 
	`SLSI_NET_ERR
(
dev
, "Require bssid in„eassoc but„eceived‚ull\n");

1097  -
EINVAL
;

1099 ià((
sme
->
bssid
 && !
	`memcmp
(
³”
->
add»ss
, sme->bssid, 
ETH_ALEN
)) ||

1100 (
sme
->
bssid_hšt
 && !
	`memcmp
(
³”
->
add»ss
, sme->bssid_hšt, 
ETH_ALEN
))) {

1101 
r
 = 
	`¦si_mlme_»assocŸ‹
(
sdev
, 
dev
);

1102 ià(
r
) {

1103 
	`SLSI_NET_ERR
(
dev
, "FaedØ»assocŸ‹ : %d\n", 
r
);

1105 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

1106 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1109 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

1110 
	`SLSI_NET_ERR
(
dev
, "Bss is‚ot stored in‚dev_vif sta\n");

1111  -
EINVAL
;

1113 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

1115 ià(!
cÚÃùed_ssid
) {

1116 
	`SLSI_NET_ERR
(
dev
, "Require ssid in„oam but„eceived‚ull\n");

1117  -
EINVAL
;

1120 ià(!
	`memcmp
(&
cÚÃùed_ssid
[2], 
sme
->
ssid
, connected_ssid[1])) {

1121 ià(!
sme
->
chªÃl
) {

1122 
	`SLSI_NET_ERR
(
dev
, "Roaming has been„ejected,‡s sme->channel is‚ull\n");

1123  -
EINVAL
;

1125 ià(
sme
->
bssid
) {

1126 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
sme
->
bssid
, sme->
chªÃl
->
ûÁ”_äeq
);

1127 } ià(
sme
->
bssid_hšt
) {

1128 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
sme
->
bssid_hšt
, sme->
chªÃl
->
ûÁ”_äeq
);

1130 
	`SLSI_NET_ERR
(
dev
, "Roaming has been„ejected,‡s bssid‡nd bssid_hint‡re‚ull\n");

1131  -
EINVAL
;

1133 ià(
r
) {

1134 
	`SLSI_NET_ERR
(
dev
, "FaedØrßm : %d\n", 
r
);

1135  -
EINVAL
;

1138 
	`SLSI_NET_ERR
(
dev
, "Connected but„eceived connecto‚ew ESS, without disconnect");

1139  -
EINVAL
;

1142  
r
;

1143 
	}
}

1145 
	$¦si_check_v®id_Ãtdev_vif_¡©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1147 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1150 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


1151 ià(
	`SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
è&&‚dev_vif->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1152 
	`SLSI_NET_ERR
(
dev
, "Iáy³: %d\n", 
ndev_vif
->
iáy³
);

1153  -
EINVAL
;

1157 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
)) {

1158 
	`SLSI_NET_ERR
(
dev
, "Viài ®»ady‡ùiv©ed: %d\n", 
ndev_vif
->
aùiv©ed
);

1159  -
EINVAL
;

1161 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

1162 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_UNSPECIFIED
) {

1163 
	`SLSI_NET_ERR
(
dev
, "VIF stus: %d\n", 
ndev_vif
->
¡a
.
vif_¡©us
);

1164  -
EINVAL
;

1167 
	}
}

1169 
	$¦si_£t_bm­
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 *
aùiÚ_äame_bm­
, u32 *
aùiÚ_äame_su¥’d_bm­
, 
u8
 *
deviû_add»ss
)

1171 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1172 
Ãt_deviû
 *
p2p_dev
;

1174 
ndev_vif
->
iáy³
) {

1175 
NL80211_IFTYPE_UNSPECIFIED
:

1176 
NL80211_IFTYPE_STATION
:

1177 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

1178 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

1179 *
aùiÚ_äame_bm­
 = 
SLSI_STA_ACTION_FRAME_BITMAP
;

1180 *
aùiÚ_äame_su¥’d_bm­
 = 
SLSI_STA_ACTION_FRAME_SUSPEND_BITMAP
;

1181 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1182 ià(
sdev
->
deviû_cÚfig
.
wes_mode
) {

1183 *
aùiÚ_äame_bm­
 |ğ
SLSI_ACTION_FRAME_VENDOR_SPEC
;

1184 *
aùiÚ_äame_su¥’d_bm­
 |ğ
SLSI_ACTION_FRAME_VENDOR_SPEC
;

1188 
NL80211_IFTYPE_P2P_CLIENT
:

1189 
	`¦si_p2p_group_¡¬t_»move_unsync_vif
(
sdev
);

1190 
p2p_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

1191 ià(
p2p_dev
)

1192 
	`SLSI_ETHER_COPY
(
deviû_add»ss
, 
p2p_dev
->
dev_addr
);

1193 *
aùiÚ_äame_bm­
 = 
SLSI_ACTION_FRAME_PUBLIC
;

1194 *
aùiÚ_äame_su¥’d_bm­
 = 
SLSI_ACTION_FRAME_PUBLIC
;

1197 
	`SLSI_NET_ERR
(
dev
, "Inv®id Deviû Ty³: %d\n", 
ndev_vif
->
iáy³
);

1198  -
EINVAL
;

1201 
	}
}

1203 
	$¦si_£t_¡a_bss_šfo
(
why
 *why, 
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
,

1204 
cfg80211_cÚÃù_·¿ms
 *
sme
, 
›“80211_chªÃl
 **
chªÃl
,

1205 cÚ¡ 
u8
 **
bssid
, 
u16
 
´ev_vif_ty³
)

1207 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1208 
u16
 
ÿ·b™y
 = 
WLAN_CAPABILITY_ESS
;

1209 
r
 = 0;

1211 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1212 
ÿ·b™y
 = 
sme
->
´ivacy
 ? 
IEEE80211_PRIVACY_ON
 : 
IEEE80211_PRIVACY_OFF
;

1214 ià(
sme
->
´ivacy
)

1215 
ÿ·b™y
 |ğ
WLAN_CAPABILITY_PRIVACY
;

1218 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
why
,

1219 *
chªÃl
,

1220 *
bssid
,

1221 
sme
->
ssid
,

1222 
sme
->
ssid_Ën
,

1223 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1224 
IEEE80211_BSS_TYPE_ANY
,

1226 
ÿ·b™y
,

1228 
ÿ·b™y
);

1230 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1231 ià(!
sme
->
bssid
 && !sme->
bssid_hšt
 && !
ndev_vif
->
¡a
.
¡a_bss
) {

1232 
li¡_h—d
 *
pos
;

1234 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

1235 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

1236 
li¡_h—d
 *
pos_bssid
;

1238 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
ndev_vif
->
¡a
.ssid_len ||

1239 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
) != 0 ||

1240 !(
ssid_šfo
->
akm_ty³
 & 
ndev_vif
->
¡a
.akm_type))

1242 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

1243 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

1245 ià(*
bssid
 && !
	`memcmp
(
bssid_šfo
->bssid, *bssid, 
ETH_ALEN
))

1247 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
why
,

1248 
	`›“80211_g‘_chªÃl
(
sdev
->
why
,

1249 (
bssid_šfo
->
äeq
 / 2)),

1250 
bssid_šfo
->
bssid
,

1251 
sme
->
ssid
,

1252 
sme
->
ssid_Ën
,

1253 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1254 
IEEE80211_BSS_TYPE_ANY
,

1256 
ÿ·b™y
,

1258 
ÿ·b™y
);

1259 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

1260 *
bssid
 = 
bssid_šfo
->bssid;

1261 *
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, (
bssid_šfo
->
äeq
 / 2));

1268 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

1269 
cfg80211_ssid
 
ssid
;

1271 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "BSS info is‚ot‡vailable - Perform scan\n");

1272 
ssid
.
ssid_Ën
 = 
sme
->ssid_len;

1273 
	`memıy
(
ssid
.ssid, 
sme
->ssid, ssid.
ssid_Ën
);

1274 ià(!(
ssid
.
ssid_Ën
 > 0 && *
chªÃl
)) {

1275 
r
 = 
	`¦si_mlme_cÚÃù_sÿn
(
sdev
, 
dev
, 1, &
ssid
, *
chªÃl
);

1276 ià(
r
) {

1277 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_connect_scan failed\n");

1278  
r
;

1280 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
why
,

1281 *
chªÃl
,

1282 *
bssid
,

1283 
sme
->
ssid
,

1284 
sme
->
ssid_Ën
,

1285 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1286 
IEEE80211_BSS_TYPE_ANY
,

1288 
ÿ·b™y
,

1290 
ÿ·b™y
);

1291 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

1292 ià(*
bssid
)

1293 
	`SLSI_NET_ERR
(
dev
, "cfg80211_g‘_bss(%.*s, " 
MACSTR
 ") Not found\n",

1294 ()
sme
->
ssid_Ën
, sme->
ssid
, 
	`MAC2STR
(*
bssid
));

1296 
	`SLSI_NET_ERR
(
dev
, "cfg80211_get_bss(%.*s) Not found\n",

1297 ()
sme
->
ssid_Ën
, sme->
ssid
);

1299 
ndev_vif
->
vif_ty³
 = 
´ev_vif_ty³
;

1300  -
ENOENT
;

1302 *
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

1303 *
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

1306 #ifdeà
CONFIG_SEC_FACTORY


1307 ià(
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 !ğ
SLSI_FREQ_BAND_AUTO
) {

1308 
suµÜ‹d_bªd
 = 
sdev
->
deviû_cÚfig
.supported_band;

1309 
bss_bªd
 = 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
->
bªd
;

1311 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "sup_bªd %d, bss_bªd %d\n", 
suµÜ‹d_bªd
, 
bss_bªd
);

1312 ià(
suµÜ‹d_bªd
 =ğ
SLSI_FREQ_BAND_2GHZ
 && 
bss_bªd
 !ğ
NL80211_BAND_2GHZ
)

1313  -
EPERM
;

1314 ià(
suµÜ‹d_bªd
 =ğ
SLSI_FREQ_BAND_5GHZ
 && 
bss_bªd
 !ğ
NL80211_BAND_5GHZ
)

1315  -
EPERM
;

1316 ià(
suµÜ‹d_bªd
 =ğ
SLSI_FREQ_BAND_6GHZ
 && 
bss_bªd
 !ğ
NL80211_BAND_6GHZ
)

1317  -
EPERM
;

1321 *
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

1322 *
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

1325 
	}
}

1327 
	$¦si_cÚfig_r¢_›
(
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

1329 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1331 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1332 cÚ¡ 
u8
 *
r¢
;

1334 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "N AKM Su™es: : %1d\n", 
sme
->
üy±o
.
n_akm_su™es
);

1335 
r¢
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
sme
->
›
, sme->
›_Ën
);

1337 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


1338 ià(
r¢
) {

1339 
pos
;

1346 
pos
 = 7 + 2 + (
r¢
[8] * 4) + 2;

1347 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0] = ((
r¢
[
pos
 + 4] << 24) | (rsn[pos + 3] << 16) | (rsn[pos + 2] << 8) | (rsn[pos + 1]));

1348 ià((
r¢
[
pos
 + 1] == 0x00 &&„sn[pos + 2] == 0x0f &&„sn[pos + 3] == 0xac) && (rsn[pos + 4] == 0x08 ||„sn[pos + 4] == 0x09)) {

1349 
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 = 3;

1350 
ndev_vif
->
¡a
.
u£_£t_pmk§
 = 1;

1351 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1352 
ndev_vif
->
¡a
.
w·3_auth_¡©e
 = 
SLSI_WPA3_PREAUTH
;

1354 } ià((
r¢
[
pos
 + 1] == 0x00 &&„sn[pos + 2] == 0x0f &&„sn[pos + 3] == 0xac) && (rsn[pos + 4] == 18)) {

1355 
ndev_vif
->
¡a
.
u£_£t_pmk§
 = 1;

1357 
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 = 0;

1358 
ndev_vif
->
¡a
.
u£_£t_pmk§
 = 0;

1361 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "RSN IE: : %1d\n", 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0]);

1363 ià(
r¢
) {

1364 
ndev_vif
->
¡a
.
r¢_›_Ën
 = 
r¢
[1];

1365 
	`kä“
(
ndev_vif
->
¡a
.
r¢_›
);

1366 
ndev_vif
->
¡a
.
r¢_›
 = 
NULL
;

1368 
ndev_vif
->
¡a
.
r¢_›
 = 
	`km®loc
Òdev_vif->¡a.
r¢_›_Ën
 + 2, 
GFP_KERNEL
);

1371 ià(
ndev_vif
->
¡a
.
r¢_›
)

1372 
	`memıy
(
ndev_vif
->
¡a
.
r¢_›
, 
r¢
,‚dev_vif->¡a.
r¢_›_Ën
 + 2);

1375 
	}
}

1377 
	$¦si_cÚÃù
(
why
 *why, 
Ãt_deviû
 *
dev
,

1378 
cfg80211_cÚÃù_·¿ms
 *
sme
)

1380 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1381 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1382 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

1383 
r
 = 0;

1384 
¦si_³”
 *
³”
;

1385 
u16
 
´ev_vif_ty³
;

1386 
u32
 
aùiÚ_äame_bm­
;

1387 
u32
 
aùiÚ_äame_su¥’d_bm­
;

1388 cÚ¡ 
u8
 *
bssid
;

1389 
›“80211_chªÃl
 *
chªÃl
;

1390 
u8
 
³”_add»ss
[
ETH_ALEN
] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

1391 
u16
 
ûÁ”_äeq
 = 0;

1393 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1394 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT.request\n");

1395  -
EOPNOTSUPP
;

1398 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1399 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

1400 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

1401 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1402  -
EINVAL
;

1405 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1406 
chªÃl
 = 
sme
->channel;

1407 
bssid
 = 
sme
->bssid;

1408 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1409 
	`¦si_£t_·¿ms_Ú_bss
(
sdev
, 
dev
, 
sme
, &
chªÃl
, &
bssid
);

1414 
r
 = 
	`¦si_is_bssid_š_bÏckli¡
(
sdev
, 
dev
, (
u8
 *)
bssid
);

1415 ià(
r
) {

1416 
	`SLSI_NET_ERR
(
dev
, "Blacklist bssid‚ot‡llowed\n");

1417 
ex™_w™h_”rÜ
;

1420 ià(
ndev_vif
->
¡a
.
¡a_bss
)

1421 
	`SLSI_ETHER_COPY
(
³”_add»ss
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
);

1423 
ûÁ”_äeq
 = 
chªÃl
 ? channel->center_freq : 0;

1425 ià(
	`WARN_ON
(!
sme
->
ssid
è|| WARN_ON(sme->
ssid_Ën
 > 
IEEE80211_MAX_SSID_LEN
))

1426 
ex™_w™h_”rÜ
;

1428 ià(
bssid
)

1429 
	`SLSI_NET_INFO
(
dev
, "%.* F»q=%d vifStus=%d Cu¼Bssid:" 
MACSTR
 " NewBssid:" MACSTR "‡uth_type: %d Qinfo:%d ieLen:%d\n",

1430 ()
sme
->
ssid_Ën
, sme->
ssid
, 
ûÁ”_äeq
, 
ndev_vif
->
¡a
.
vif_¡©us
,

1431 
	`MAC2STR
(
³”_add»ss
), MAC2STR(
bssid
), ()
sme
->
auth_ty³
, 
sdev
->
deviû_cÚfig
.
qos_šfo
, ()sme->
›_Ën
);

1433 
	`SLSI_NET_INFO
(
dev
, "%.* F»q=%d vifStus=%d Cu¼Bssid:" 
MACSTR
 "‡uth_type: %d Qinfo:%d ieLen:%d\n",

1434 ()
sme
->
ssid_Ën
, sme->
ssid
, 
ûÁ”_äeq
, 
ndev_vif
->
¡a
.
vif_¡©us
,

1435 
	`MAC2STR
(
³”_add»ss
), ()
sme
->
auth_ty³
, 
sdev
->
deviû_cÚfig
.
qos_šfo
, ()sme->
›_Ën
);

1437 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

1438 
	`SCSC_WLOG_PKTFATE_NEW_ASSOC
();

1439 ià(
bssid
) {

1440 
	`SCSC_WLOG_DRIVER_EVENT
(
WLOG_NORMAL
, 
WIFI_EVENT_ASSOCIATION_REQUESTED
, 3,

1441 
WIFI_TAG_BSSID
, 
ETH_ALEN
, 
bssid
,

1442 
WIFI_TAG_SSID
, 
sme
->
ssid_Ën
, sme->
ssid
,

1443 
WIFI_TAG_CHANNEL
, (
u16
), &
ûÁ”_äeq
);

1447 ià(
	`SLSI_IS_HS2_UNSYNC_VIF
(
ndev_vif
)) {

1448 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

1449 } ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1450 
	`SLSI_NET_ERR
(
dev
, "Connect„equested on incorrect vif\n");

1451 
ex™_w™h_”rÜ
;

1454 
r
 = 
	`¦si_check_wificÚÃù_to_cÚÃùedGo
(
sdev
, 
dev
, 
bssid
);

1455 ià(
r
 != 0) {

1456 
	`SLSI_NET_ERR
(
dev
, "Connect Request Rejected\n");

1457 
ex™_w™h_”rÜ
;

1461 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

1462 
r
 = 
	`¦si_£t_rßm_»assoc
(
dev
, 
sdev
, 
sme
);

1463 ià(
r
 == 0)

1464 
ex™
;

1466 
ex™_w™h_”rÜ
;

1469 
r
 = 
	`¦si_check_v®id_Ãtdev_vif_¡©e
(
sdev
, 
dev
);

1470 ià(
r
 != 0) {

1471 
	`SLSI_NET_ERR
(
dev
, "Invalid‚etdev vif state\n");

1472 
ex™_w™h_”rÜ
;

1475 
´ev_vif_ty³
 = 
ndev_vif
->
vif_ty³
;

1477 
r
 = 
	`¦si_£t_bm­
(
sdev
, 
dev
, &
aùiÚ_äame_bm­
, &
aùiÚ_äame_su¥’d_bm­
, 
deviû_add»ss
);

1478 ià(
r
 != 0)

1479 
ex™_w™h_”rÜ
;

1482 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_STATION
;

1484 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1485 
chªÃl
 = 
sme
->channel;

1486 
bssid
 = 
sme
->bssid;

1488 
r
 = 
	`¦si_£t_¡a_bss_šfo
(
why
, 
dev
, 
sdev
, 
sme
, &
chªÃl
, &
bssid
, 
´ev_vif_ty³
);

1489 ià(
r
 != 0)

1490 
ex™
;

1492 
ndev_vif
->
chª
 = 
chªÃl
;

1493 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1494 
ndev_vif
->
¡a
.
ssid_Ën
 = 
sme
->ssid_len;

1495 
	`memıy
(
ndev_vif
->
¡a
.
ssid
, 
sme
->ssid, sme->
ssid_Ën
);

1500 ià(
bssid
)

1501 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
bssid
, bssid);

1503 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

1504 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed\n");

1505 
ex™_w™h_bss
;

1507 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0) {

1508 
	`SLSI_NET_ERR
(
dev
, "slsi_vif_activated failed\n");

1509 
ex™_w™h_vif
;

1511 ià(
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
aùiÚ_äame_bm­
, 
aùiÚ_äame_su¥’d_bm­
) != 0) {

1512 
	`SLSI_NET_ERR
(
dev
, "AùiÚ f¿m»gi¡¿tiÚ faed fÜ b™m­ v®u0x%x 0x%x\n", 
aùiÚ_äame_bm­
, 
aùiÚ_äame_su¥’d_bm­
);

1513 
ex™_w™h_vif
;

1516 
r
 = 
	`¦si_£t_boo¡
(
sdev
, 
dev
);

1517 ià(
r
 != 0)

1518 
	`SLSI_NET_ERR
(
dev
, "Rss˜Boo¡ s‘ faed: %d\n", 
r
);

1523 ià(
ndev_vif
->
´obe_»q_›s
) {

1524 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1525 ià(
sme
->
üy±o
.
w·_v”siÚs
 == 2)

1526 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
Œue
;

1531 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
çl£
;

1533 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
Œue
;

1536 
r
 = 
	`¦si_add_´obe_›s_»que¡
(
sdev
, 
dev
);

1543 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

1544 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

1545 
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 = 
çl£
;

1546 
r
 = 
	`¦si_£t_ext_ÿp
(
sdev
, 
dev
, 
sme
->
›
, sme->
›_Ën
, 
¦si_ex‹nded_ÿp_mask
);

1547 ià(
r
 != 0)

1548 
	`SLSI_NET_ERR
(
dev
, "FaedØ£ˆex‹nded c­ab™y MIB: %d\n", 
r
);

1550 
	`¦si_cÚfig_r¢_›
(
dev
, 
sme
);

1552 
	`¦si_cÚn_log2us_cÚÃùšg
(
sdev
, 
dev
, 
sme
);

1554 
r
 = 
	`¦si_mlme_cÚÃù
(
sdev
, 
dev
, 
sme
, 
chªÃl
, 
bssid
);

1555 ià(
r
 != 0) {

1556 
ndev_vif
->
¡a
.
is_wps
 = 
çl£
;

1557 
	`SLSI_NET_ERR
(
dev
, "cÚÃù faed: %d\n", 
r
);

1558 
	`Ãtif_ÿ¼›r_off
(
dev
);

1559 
ex™_w™h_vif
;

1561 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, (
u8
 *)
bssid
, 
SLSI_STA_PEER_QUEUESET
 + 1);

1562 
ndev_vif
->
¡a
.
»¥_id
 = 0;

1563 ià(!
³”
)

1564 
ex™_w™h_”rÜ
;

1566 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1567 ià(
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
) {

1568 
	`¦si_§ve_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
, 
sme
, 
chªÃl
, 
bssid
,

1569 
aùiÚ_äame_bm­
, 
aùiÚ_äame_su¥’d_bm­
);

1570 
	`¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
sdev
, 
dev
, 
bssid
);

1573 
ex™
;

1575 
ex™_w™h_vif
:

1576 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1577 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1578 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1579 
ex™_w™h_bss
:

1580 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

1581 
	`¦si_cfg80211_put_bss
(
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

1582 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

1584 
ex™_w™h_”rÜ
:

1585 
	`¦si_cÚn_log2us_cÚÃùšg_ç
(
sdev
, 
dev
, 
bssid
, 
ûÁ”_äeq
, 3);

1586 
r
 = -
EINVAL
;

1587 
ex™
:

1588 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1589 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1590  
r
;

1591 
	}
}

1593 
	$¦si_discÚÃù
(
why
 *why, 
Ãt_deviû
 *
dev
,

1594 
u16
 
»asÚ_code
)

1596 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1597 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1598 
¦si_³”
 *
³”
;

1599 
r
 = 0;

1601 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

1602 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

1603 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1605 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "»asÚ: %d, vif_šdex = %d, vif_ty³ = %d\n", 
»asÚ_code
,

1606 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
);

1612 ià(!
ndev_vif
->
aùiv©ed
) {

1613 
r
 = 0;

1614 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

1615 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ_code
, 
NULL
, 0, 
çl£
, 
GFP_KERNEL
);

1617 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ_code
, 
NULL
, 0, 
GFP_KERNEL
);

1619 
	`SLSI_NET_INFO
(
dev
, "Vif is‡lready Deactivated\n");

1620 
ex™
;

1623 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

1625 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

1626 
	`SCSC_WLOG_DRIVER_EVENT
(
WLOG_NORMAL
, 
WIFI_EVENT_DISASSOCIATION_REQUESTED
, 2,

1627 
WIFI_TAG_BSSID
, 
ETH_ALEN
, 
³”
->
add»ss
,

1628 
WIFI_TAG_REASON_CODE
, (
u16
), &
»asÚ_code
);

1631 
ndev_vif
->
vif_ty³
) {

1632 
FAPI_VIFTYPE_STATION
:

1634 
	`¦si_»£t_throughput_¡©s
(
dev
);

1639 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_DISCONNECTING
;

1641 
	`Ãtif_ÿ¼›r_off
(
dev
);

1642 ià(
³”
->
v®id
)

1643 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1652 
r
 = 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
»asÚ_code
, 
Œue
);

1653 ià(
r
 != 0)

1654 
	`SLSI_NET_ERR
(
dev
, "Disconnection„eturned with failure\n");

1656 
r
 = 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 0, 
NULL
, 0);

1661 
	`SLSI_NET_WARN
(
dev
, "Inv®id - viàty³:%d, deviûy³:%d)\n", 
ndev_vif
->
vif_ty³
,‚dev_vif->
iáy³
);

1662 
r
 = -
EINVAL
;

1666 
ex™
:

1667 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1668  
r
;

1669 
	}
}

1671 
	$¦si_£t_deçuÉ_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

1672 
u8
 
key_šdex
, 
boŞ
 
uniÿ¡
, boŞ 
muÉiÿ¡
)

1674 
	`SLSI_UNUSED_PARAMETER
(
why
);

1675 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1676 
	`SLSI_UNUSED_PARAMETER
(
key_šdex
);

1677 
	`SLSI_UNUSED_PARAMETER
(
uniÿ¡
);

1678 
	`SLSI_UNUSED_PARAMETER
(
muÉiÿ¡
);

1681 
	}
}

1683 
	$¦si_cÚfig_deçuÉ_mgmt_key
(
why
 *wiphy,

1684 
Ãt_deviû
 *
dev
,

1685 
u8
 
key_šdex
)

1687 
	`SLSI_UNUSED_PARAMETER
(
why
);

1688 
	`SLSI_UNUSED_PARAMETER
(
key_šdex
);

1689 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1692 
	}
}

1694 
	$¦si_£t_why_·¿ms
(
why
 *why, 
u32
 
chªged
)

1696 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1697 
r
 = 0;

1699 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "slsi_set_wiphy_parms Frag Threshold = %d, RTS Threshold = %d",

1700 
why
->
äag_th»shŞd
, why->
¹s_th»shŞd
);

1702 ià((
chªged
 & 
WIPHY_PARAM_FRAG_THRESHOLD
è&& (
why
->
äag_th»shŞd
 != -1)) {

1703 
r
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_DOT11_FRAGMENTATION_THRESHOLD
, 
why
->
äag_th»shŞd
);

1704 ià(
r
 != 0) {

1705 
	`SLSI_ERR
(
sdev
, "Setting FRAG_THRESHOLD failed\n");

1706  
r
;

1710 ià((
chªged
 & 
WIPHY_PARAM_RTS_THRESHOLD
è&& (
why
->
¹s_th»shŞd
 != -1)) {

1711 
r
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_DOT11_RTS_THRESHOLD
, 
why
->
¹s_th»shŞd
);

1712 ià(
r
 != 0) {

1713 
	`SLSI_ERR
(
sdev
, "Setting RTS_THRESHOLD failed\n");

1714  
r
;

1718  
r
;

1719 
	}
}

1721 
	$¦si_£t_tx_pow”
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

1722 
Æ80211_tx_pow”_£‰šg
 
ty³
, 
mbm
)

1724 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1725 
r
 = 0;

1727 
	`SLSI_UNUSED_PARAMETER
(
wdev
);

1728 
	`SLSI_UNUSED_PARAMETER
(
ty³
);

1729 
	`SLSI_UNUSED_PARAMETER
(
mbm
);

1730 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1732 
r
 = -
EOPNOTSUPP
;

1734  
r
;

1735 
	}
}

1737 
	$¦si_g‘_chªÃl
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

1738 
cfg80211_chª_def
 *
chªdef
)

1740 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

1741 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1742 
äeq
 = 0;

1743 
width
 = 0;

1744 
r
 = 0;

1746 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)

1747  -
ENODATA
;

1749 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1750 
äeq
 = 
ndev_vif
->
¡a
.
bss_cf
;

1751 
width
 = 
ndev_vif
->
¡a
.
ch_width
;

1753 ià(
width
 == 20) {

1754 
width
 = 
NL80211_CHAN_WIDTH_20
;

1755 ià(
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
) {

1756 
r
 = -
EINVAL
;

1757 
ex™
;

1759 } ià(
width
 == 40) {

1760 
width
 = 
NL80211_CHAN_WIDTH_40
;

1761 ià(
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 + 10 &&

1762 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 - 10) {

1763 
r
 = -
EINVAL
;

1764 
ex™
;

1766 } ià(
width
 == 80) {

1767 
width
 = 
NL80211_CHAN_WIDTH_80
;

1768 ià(
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 + 30 &&

1769 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 + 10 &&

1770 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 - 10 &&

1771 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 - 30) {

1772 
r
 = -
EINVAL
;

1773 
ex™
;

1775 } ià(
width
 == 160) {

1776 
width
 = 
NL80211_CHAN_WIDTH_160
;

1777 ià(
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 + 70 &&

1778 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 + 50 &&

1779 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 + 30 &&

1780 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 + 10 &&

1781 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 - 10 &&

1782 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 - 30 &&

1783 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 - 50 &&

1784 
äeq
 !ğ
ndev_vif
->
chª
->
ûÁ”_äeq
 - 70) {

1785 
r
 = -
EINVAL
;

1786 
ex™
;

1790 ià(
ndev_vif
->
chª
)

1791 
chªdef
->
chª
 = 
ndev_vif
->chan;

1792 
chªdef
->
ûÁ”_äeq1
 = 
äeq
;

1793 
chªdef
->
width
 = width;

1794 
chªdef
->
ûÁ”_äeq2
 = 0;

1795 
ex™
:

1796 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1798  
r
;

1799 
	}
}

1801 
	$¦si_g‘_tx_pow”
(
why
 *why, 
wœ–ess_dev
 *
wdev
, *
dbm
)

1803 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1804 
r
 = 0;

1806 
	`SLSI_UNUSED_PARAMETER
(
wdev
);

1807 
	`SLSI_UNUSED_PARAMETER
(
dbm
);

1808 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1810 
r
 = -
EOPNOTSUPP
;

1812  
r
;

1813 
	}
}

1815 
	$¦si_d–_¡©iÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

1816 
¡©iÚ_d–_·¿m‘”s
 *
d–_·¿ms
)

1818 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1819 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1820 
¦si_³”
 *
³”
;

1821 
r
 = 0;

1822 
u16
 
»asÚ_code
 = 
WLAN_REASON_DEAUTH_LEAVING
;

1823 cÚ¡ 
u8
 *
mac
 = 
d–_·¿ms
->mac;

1824 
»asÚ_code
 = 
d–_·¿ms
->reason_code;

1826 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1828 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "%pM, vifType:%d, vifIndex:%d vifActivated:%d‡p.p2p_gc_keys_set = %d\n",

1829 
mac
, 
ndev_vif
->
vif_ty³
,‚dev_vif->
iâum
,‚dev_vif->
aùiv©ed
,‚dev_vif->
­
.
p2p_gc_keys_£t
);

1832 ià(!
ndev_vif
->
aùiv©ed
)

1833 
ex™
;

1835 ià(
FAPI_VIFTYPE_AP
 !ğ
ndev_vif
->
vif_ty³
) {

1836 
r
 = -
EINVAL
;

1837 
ex™
;

1840 ià(!
mac
)

1841 
ex™
;

1842 ià(
	`is_brßdÿ¡_‘h”_addr
(
mac
è&& 
»asÚ_code
 =ğ
WLAN_REASON_DEAUTH_LEAVING
) {

1843 
i
 = 0;

1845 
i
 < 
SLSI_PEER_INDEX_MAX
) {

1846 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

1847 ià(
³”
 &&…“r->
v®id
) {

1848 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1850 ++
i
;

1859 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
ÿche_w·_›
, &ndev_vif->­.
w·_›_Ën
);

1860 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
ÿche_wmm_›
, &ndev_vif->­.
wmm_›_Ën
);

1862 
	`Ãtif_ÿ¼›r_off
(
dev
);

1865 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1866 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1867 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1868 
ndev_vif
->
add»ss
 = 
	`ıu_to_be32
(0);

1870 ià(
ndev_vif
->
­
.
p2p_gc_keys_£t
) {

1871 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1872 
ndev_vif
->
­
.
p2p_gc_keys_£t
 = 
çl£
;

1875 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
mac
);

1876 ià(
³”
) {

1877 ià(
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTING
) {

1878 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "SLSI_STA_CONN_STATE_CONNECTING : mlme-disconnect-req dropped‡t driver\n");

1879 
ex™
;

1881 ià(
³”
->
is_wps
) {

1883 
	`SLSI_NET_INFO
(
dev
, "DISCONNECT‡fter WPS : mlme-disconnect-req dropped‡t driver\n");

1884 
ex™
;

1886 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1887 
r
 = 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
»asÚ_code
, 
Œue
);

1888 ià(
r
 != 0)

1889 
	`SLSI_NET_ERR
(
dev
, "Disconnection„eturned with failure\n");

1891 
r
 = 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
»asÚ_code
, 
NULL
, 0);

1895 
ex™
:

1896 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1897  
r
;

1898 
	}
}

1900 
	$¦si_g‘_¡©iÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

1901 cÚ¡ 
u8
 *
mac
, 
¡©iÚ_šfo
 *
sšfo
)

1903 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1904 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1905 
¦si_³”
 *
³”
;

1906 
r
 = 0;

1908 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1910 ià(!
ndev_vif
->
aùiv©ed
) {

1911 
r
 = -
EINVAL
;

1912 
ex™
;

1915 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
mac
);

1916 ià(!
³”
) {

1917 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "%pM : NÙ Found\n", 
mac
);

1918 
r
 = -
EINVAL
;

1919 
ex™
;

1922 ià(((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 && !Òdev_vif->
¡a
.
rßm_š_´og»ss
)) ||

1923 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
)) {

1925 
r
 = 
	`¦si_mlme_g‘_sšfo_mib
(
sdev
, 
dev
, 
³”
);

1926 ià(
r
) {

1927 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "çedØ»ad StiÚ InfØE¼Ü:%d\n", 
r
);

1928 
ex™
;

1932 *
sšfo
 = 
³”
->sinfo;

1933 
sšfo
->
g’”©iÚ
 = 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
;

1935 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

1936 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
,

1939 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "%pM,x:%d,xbytes:%llu,„x:%d,„xbytes:%llux_fail:%dx_retry:%d\n",

1941 
mac
,

1942 
³”
->
sšfo
.
tx_·ck‘s
,

1943 
³”
->
sšfo
.
tx_by‹s
,

1944 
³”
->
sšfo
.
rx_·ck‘s
,

1945 
³”
->
sšfo
.
rx_by‹s
,

1946 
³”
->
sšfo
.
tx_çed
,

1947 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

1948 
³”
->
sšfo
.
tx_»Œ›s
,

1949 
³”
->
sšfo
.
aœtime_lšk_m‘ric
);

1951 
³”
->
sšfo
.
tx_»Œ›s
);

1954 
ex™
:

1955 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1956  
r
;

1957 
	}
}

1959 
	$¦si_£t_pow”_mgmt
(
why
 *why, 
Ãt_deviû
 *
dev
,

1960 
boŞ
 
’abËd
, 
timeout
)

1962 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1963 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1964 
r
 = -
EINVAL
;

1965 
u16
 
pwr_mode
 = 
’abËd
 ? 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
 : 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

1967 
	`SLSI_UNUSED_PARAMETER
(
timeout
);

1968 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1969 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_POWERMGT.request\n");

1970  -
EOPNOTSUPP
;

1973 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

1974 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, RFest does‚ot support.\n");

1975  -
EOPNOTSUPP
;

1978 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1980 
	`SLSI_NET_INFO
(
dev
, "PS MODEƒÇbËd:%d, vif_ty³:%d, vif_šdex:%d\n", 
’abËd
, 
ndev_vif
->
vif_ty³
,

1981 
ndev_vif
->
iâum
);

1983 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

1984 
ndev_vif
->
£t_pow”_mode
 = 
pwr_mode
;

1985 
r
 = 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
pwr_mode
);

1987 
r
 = 0;

1990 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1991  
r
;

1992 
	}
}

1994 
	$¦si_tdls_İ”
(
why
 *why, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
³”
, 
Æ80211_tdls_İ”©iÚ
 
İ”
)

1996 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1997 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1998 
r
 = 0;

2000 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "İ”:%d, vif_ty³:%d, vif_šdex:%d\n", 
İ”
, 
ndev_vif
->
vif_ty³
,

2001 
ndev_vif
->
iâum
);

2003 ià(!(
why
->
æags
 & 
WIPHY_FLAG_SUPPORTS_TDLS
))

2004  -
ENOTSUPP
;

2006 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2008 ià(!
ndev_vif
->
aùiv©ed
 || 
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
,‚dev_vif) ||

2009 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

2010 
r
 = -
ENOTSUPP
;

2011 
ex™
;

2014 
İ”
) {

2015 
NL80211_TDLS_DISCOVERY_REQ
:

2016 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "NL80211_TDLS_DISCOVERY_REQ\n");

2017 
r
 = 
	`¦si_mlme_tdls_aùiÚ
(
sdev
, 
dev
, 
³”
, 
FAPI_TDLSACTION_DISCOVERY
);

2019 
NL80211_TDLS_SETUP
:

2020 
r
 = 
	`¦si_mlme_tdls_aùiÚ
(
sdev
, 
dev
, 
³”
, 
FAPI_TDLSACTION_FORCED_SETUP
);

2022 
NL80211_TDLS_TEARDOWN
:

2023 
r
 = 
	`¦si_mlme_tdls_aùiÚ
(
sdev
, 
dev
, 
³”
, 
FAPI_TDLSACTION_TEARDOWN
);

2026 
r
 = -
EOPNOTSUPP
;

2027 
ex™
;

2029 
ex™
:

2030 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2031  
r
;

2032 
	}
}

2034 
	$¦si_£t_qos_m­
(
why
 *why, 
Ãt_deviû
 *
dev
, 
cfg80211_qos_m­
 *
qos_m­
)

2036 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2037 
¦si_³”
 *
³”
;

2038 
r
 = 0;

2041 ià(!
qos_m­
)

2042  
r
;

2044 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2046 ià(!
ndev_vif
->
aùiv©ed
) {

2047 
r
 = -
EINVAL
;

2048 
ex™
;

2051 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

2052 
r
 = -
EINVAL
;

2053 
ex™
;

2056 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Set QoS Map\n");

2057 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

2058 ià(!
³”
 || !³”->
v®id
) {

2059 
r
 = -
EINVAL
;

2060 
ex™
;

2063 
	`memıy
(&
³”
->
qos_m­
, qos_m­, (
cfg80211_qos_m­
));

2064 
³”
->
qos_m­_£t
 = 
Œue
;

2066 
ex™
:

2067 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2068  
r
;

2069 
	}
}

2071 
	$¦si_£t_mÚ™Ü_chªÃl
(
why
 *why, 
cfg80211_chª_def
 *
chªdef
)

2073 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2074 
Ãt_deviû
 *
dev
;

2075 
Ãtdev_vif
 *
ndev_vif
;

2077 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "chªÃÈ(äeq:%u)\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

2079 
	`rcu_»ad_lock
();

2080 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2081 ià(!
dev
) {

2082 
	`SLSI_ERR
(
sdev
, "netdev No†ongerƒxists\n");

2083 
	`rcu_»ad_uÆock
();

2084  -
EINVAL
;

2086 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2087 
	`rcu_»ad_uÆock
();

2089 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2091 ià(
	`¦si_mlme_cÚfigu»_mÚ™Ü_mode
(
sdev
, 
dev
, 
chªdef
) != 0) {

2092 
	`SLSI_ERR
(
sdev
, "set Monitor channel failed\n");

2093 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2094  -
EINVAL
;

2096 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2098 
	}
}

2100 
	$¦si_su¥’d
(
why
 *why, 
cfg80211_wowÏn
 *
wow
)

2102 
	`SLSI_UNUSED_PARAMETER
(
wow
);

2105 
	}
}

2107 
	$¦si_»sume
(
why
 *wiphy)

2109 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2113 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2116 
	}
}

2118 
	$¦si_£t_pmk§
(
why
 *why, 
Ãt_deviû
 *
dev
,

2119 
cfg80211_pmk§
 *
pmk§
)

2121 
i
 = 0;

2122 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2123 
u8
 *
r¢›
;

2124 
u8
 *
buf
;

2125 
u16
 
r¢›_Ën
;

2126 
Ëá
 = 0;

2127 
u16
 
couÁ
 = 0;

2128 
»t
 = 0;

2129 
pos
 = 0;

2130 
buf_Ën
 = 0;

2131 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2133 ià(
ndev_vif
->
¡a
.
u£_£t_pmk§
) {

2134 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "\n");

2135 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2136 ià(
ndev_vif
->
¡a
.
r¢_›
) {

2137 
r¢›_Ën
 = 
ndev_vif
->
¡a
.
r¢_›_Ën
;

2139 
r¢›
 = 
	`km®loc
(2 + 
r¢›_Ën
 + 2 + 
PMKID_LEN
, 
GFP_KERNEL
);

2140 ià(
r¢›
) {

2141 
	`mem£t
(
r¢›
, 0, 
r¢›_Ën
 + 2 + 
PMKID_LEN
);

2143 
Ëá
 = 
r¢›_Ën
 + 2;

2144 
pos
 = 4;

2145 
Ëá
 -= 4;

2146 ià(
Ëá
 < 4) {

2147 
	`kä“
(
r¢›
);

2148 
	`kä“
(
ndev_vif
->
¡a
.
r¢_›
);

2149 
ndev_vif
->
¡a
.
r¢_›
 = 
NULL
;

2150 
»t
 = -
EINVAL
;

2151 
ex™
;

2153 
pos
 +ğ
RSN_SELECTOR_LEN
;

2154 
Ëá
 -ğ
RSN_SELECTOR_LEN
;

2157 
i
 = 0;

2158 
i
 < 2) {

2159 
pos
 += 2;

2160 
Ëá
 -= 2;

2161 
couÁ
 = 
	`Ë16_to_ıu
(*(
u16
 *)(&
ndev_vif
->
¡a
.
r¢_›
[
pos
 - 2]));

2162 
pos
 +ğ
couÁ
 * 
RSN_SELECTOR_LEN
;

2163 
Ëá
 -ğ
couÁ
 * 
RSN_SELECTOR_LEN
;

2164 
i
++;

2166 
pos
 += 2;

2167 
Ëá
 -= 2;

2168 
	`memıy
(
r¢›
, 
ndev_vif
->
¡a
.
r¢_›
, 
pos
);

2169 
couÁ
 = 0;

2170 ià(
Ëá
 > 0 &&†eft >= 2) {

2171 
couÁ
 = 
	`Ë16_to_ıu
(*(
u16
 *)(&
ndev_vif
->
¡a
.
r¢_›
[
pos
]));

2172 
Ëá
 -= 2;

2174 
pos
 += 2;

2175 
r¢›
[
pos
 - 2] = 1;

2176 
r¢›
[
pos
 - 1] = 0;

2178 
	`memıy
(&
r¢›
[
pos
], 
pmk§
->
pmkid
, 
PMKID_LEN
);

2179 
pos
 +ğ
PMKID_LEN
;

2180 ià(
couÁ
 && 
Ëá
 > 0) {

2181 
Ëá
 -ğ(
couÁ
 * 
PMKID_LEN
);

2182 
	`memıy
(&
r¢›
[
pos
], &
ndev_vif
->
¡a
.
r¢_›
[po + ((
couÁ
 - 1è* 
PMKID_LEN
)], 
Ëá
);

2183 } ià(
Ëá
 > 0) {

2184 
	`memıy
(&
r¢›
[
pos
], &
ndev_vif
->
¡a
.
r¢_›
[po - 
PMKID_LEN
], 
Ëá
);

2186 
pos
 +ğ
Ëá
;

2187 
r¢›_Ën
 = 
pos
;

2188 
r¢›
[1] = 
r¢›_Ën
 - 2;

2189 
buf_Ën
 = 
r¢›_Ën
 + 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
;

2190 
buf
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

2191 ià(!
buf
) {

2192 
	`SLSI_NET_ERR
(
dev
, "Out of memory for buffer\n");

2193 
»t
 = -
ENOMEM
;

2194 
	`kä“
(
r¢›
);

2195 
ex™
;

2197 
	`memıy
(
buf
, 
r¢›
, 
r¢›_Ën
);

2198 ià(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
)

2199 
	`memıy
(
buf
 + 
r¢›_Ën
, 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,‚dev_vif->¡a.
assoc_»q_add_šfo_–em_Ën
);

2200 
»t
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
buf
, 
buf_Ën
);

2201 ià(
»t
 != 0) {

2202 
	`SLSI_NET_ERR
(
dev
, "RSN IE with PMKID setting failed\n");

2203 
	`kä“
(
r¢›
);

2204 
	`kä“
(
buf
);

2205 
ex™
;

2207 
	`kä“
(
buf
);

2208 
	`kä“
(
r¢›
);

2210 
	`SLSI_NET_ERR
(
dev
, "Out of memory for RSN IE\n");

2211 
»t
 = -
ENOMEM
;

2212 
ex™
;

2215 
	`SLSI_NET_ERR
(
dev
, "RSN IE is‚ot…resent in Station VIF\n");

2216 
»t
 = -
EINVAL
;

2217 
ex™
;

2219 
ex™
:

2220 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2222  
»t
;

2223 
	}
}

2225 
	$¦si_d–_pmk§
(
why
 *why, 
Ãt_deviû
 *
dev
,

2226 
cfg80211_pmk§
 *
pmk§
)

2228 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2229 ià(
ndev_vif
->
¡a
.
u£_£t_pmk§
) {

2230 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "\n");

2231 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2232 ià(!
ndev_vif
->
aùiv©ed
)

2233 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "VIF‚ot‡ctivated\n");

2238 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2241 
	}
}

2243 
	$¦si_æush_pmk§
(
why
 *why, 
Ãt_deviû
 *
dev
)

2245 
	`SLSI_UNUSED_PARAMETER
(
why
);

2246 
	`SLSI_UNUSED_PARAMETER
(
dev
);

2248 
	}
}

2250 
	$¦si_»maš_Ú_chªÃl
(
why
 *wiphy,

2251 
wœ–ess_dev
 *
wdev
,

2252 
›“80211_chªÃl
 *
chª
,

2253 
du¿tiÚ
,

2254 
u64
 *
cook›
)

2256 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2257 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2258 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2259 
r
 = 0;

2261 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

2262 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

2263 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

2264 
ex™_w™h_”rÜ
;

2267 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2269 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "channel freq = %d, duration = %d, vif_type = %d, vif_index = %d,"

2270 "sdev->p2p_¡©ğ%s\n", 
chª
->
ûÁ”_äeq
, 
du¿tiÚ
, 
ndev_vif
->
vif_ty³
,‚dev_vif->
iâum
,

2271 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
));

2272 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

2273 
	`SLSI_NET_ERR
(
dev
, "Invalid vifype\n");

2274 
ex™_w™h_”rÜ
;

2277 ià(
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
)) {

2278 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
unsync
.
roc_cook›
);

2280 
	`cfg80211_»ady_Ú_chªÃl
(
wdev
, *
cook›
, 
chª
, 
du¿tiÚ
, 
GFP_KERNEL
);

2281 
	`cfg80211_»maš_Ú_chªÃl_expœed
(
wdev
, *
cook›
, 
chª
, 
GFP_KERNEL
);

2282 
ex™
;

2286 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

2287 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
)

2288 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
d–_vif_wÜk
,

2289 
	`m£cs_to_jiff›s
(
du¿tiÚ
 + 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
));

2295 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

2297 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

2298 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

2303 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
 || sdev->p2p_¡©=ğ
P2P_LISTENING
) {

2304 
ex™_w™h_roc
;

2308 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
) {

2309 ià(
	`¦si_p2p_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
du¿tiÚ
, 
Œue
) != 0)

2310 
ex™_w™h_”rÜ
;

2311 } ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_VIF_ACTIVE
) {

2313 ià(
ndev_vif
->
unsync
.
›s_chªged
) {

2314 
u16
 
pu½o£
 = 
FAPI_PURPOSE_PROBE_RESPONSE
;

2316 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
pu½o£
, 
ndev_vif
->
unsync
.
´obe_r¥_›s
,‚dev_vif->unsync.
´obe_r¥_›s_Ën
) != 0) {

2317 
	`SLSI_NET_ERR
(
dev
, "Probe Rsp IEs setting failed\n");

2318 
ex™_w™h_vif
;

2320 
ndev_vif
->
unsync
.
›s_chªged
 = 
çl£
;

2323 ià(
ndev_vif
->
driv”_chªÃl
 !ğ
chª
->
hw_v®ue
) {

2324 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0) {

2325 
	`SLSI_NET_ERR
(
dev
, "Channel setting failed\n");

2326 
ex™_w™h_vif
;

2328 
ndev_vif
->
chª
 = chan;

2329 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

2333 
	`SLSI_NET_ERR
(
dev
, "Driv” iÀšcÜ»ù P2P s‹ (%s)", 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
));

2334 
ex™_w™h_”rÜ
;

2337 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

2339 
ex™_w™h_roc
:

2345 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
roc_expœy_wÜk
,

2346 
	`m£cs_to_jiff›s
(
du¿tiÚ
 - 
SLSI_P2P_ROC_EXTRA_MSEC
));

2348 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
unsync
.
roc_cook›
);

2349 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Cook› = 0x%Îx\n", *
cook›
);

2351 
	`cfg80211_»ady_Ú_chªÃl
(
wdev
, *
cook›
, 
chª
, 
du¿tiÚ
, 
GFP_KERNEL
);

2352 
ex™
;

2354 
ex™_w™h_vif
:

2355 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

2356 
ex™_w™h_”rÜ
:

2357 
r
 = -
EINVAL
;

2358 
ex™
:

2359 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2360 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

2361  
r
;

2362 
	}
}

2364 
	$¦si_ÿnûl_»maš_Ú_chªÃl
(
why
 *wiphy,

2365 
wœ–ess_dev
 *
wdev
,

2366 
u64
 
cook›
)

2368 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2369 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2370 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2371 
r
 = 0;

2373 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2375 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Cookie = 0x%llx, vif_type = %d, vif_index = %d, sdev->p2p_state = %s,"

2376 "ndev_vif->­.p2p_gc_keys_£ˆğ%d,‚dev_vif->unsync.roc_cook› = 0x%Îx\n", 
cook›
,

2377 
ndev_vif
->
vif_ty³
,‚dev_vif->
iâum
, 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
),

2378 
ndev_vif
->
­
.
p2p_gc_keys_£t
,‚dev_vif->
unsync
.
roc_cook›
);

2380 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

2381 
	`SLSI_NET_ERR
(
dev
, "Invalid vifype\n");

2382 
r
 = -
EINVAL
;

2383 
ex™
;

2386 ià(!((
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
è|| (sdev->p2p_¡©=ğ
P2P_ACTION_FRAME_TX_RX
))) {

2387 
ex™
;

2390 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
 && 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
) {

2392 
	`SLSI_INFO
(
sdev
, "AùiÚ f¿m(%sèwa nÙ„eûived\n", 
	`¦si_·_subty³_‹xt
(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
));

2393 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

2396 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

2397 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,‚dev_vif->
chª
, 
GFP_KERNEL
);

2399 ià(!
ndev_vif
->
drv_š_p2p_´oûdu»
) {

2400 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

2401 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

2402 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
,

2403 
	`m£cs_to_jiff›s
(
SLSI_P2P_UNSET_CHANNEL_EXTRA_MSEC
));

2406 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

2407 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

2409 
ex™
:

2410 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2411  
r
;

2412 
	}
}

2414 
	$¦si_chªge_bss
(
why
 *why, 
Ãt_deviû
 *
dev
,

2415 
bss_·¿m‘”s
 *
·¿ms
)

2417 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2418 
r
 = 0;

2420 
	`SLSI_UNUSED_PARAMETER
(
·¿ms
);

2421 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2423  
r
;

2424 
	}
}

2426 
	$¦si_­_¡¬t_obss_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
)

2428 
cfg80211_ssid
 
ssids
;

2429 
›“80211_chªÃl
 *
chªÃl
;

2430 
n_ssids
 = 1, 
n_chªÃls
 = 1, 
i
;

2432 ià(!
ndev_vif
->
chª
) {

2433 
	`SLSI_NET_ERR
(
dev
, "ndev_vif->chan is‚ull\n");

2437 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "chªÃÈ%u\n", 
ndev_vif
->
chª
->
hw_v®ue
);

2439 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

2441 
ssids
.
ssid_Ën
 = 0;

2442 
i
 = 0; i < 
IEEE80211_MAX_SSID_LEN
; i++)

2443 
ssids
.
ssid
[
i
] = 0x00;

2445 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
ndev_vif
->
chª
->
ûÁ”_äeq
);

2447 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
Œue
;

2448 ()
	`¦si_mlme_add_sÿn
(
sdev
,

2449 
dev
,

2450 
FAPI_SCANTYPE_OBSS_SCAN
,

2451 
FAPI_REPORTMODE_REAL_TIME
,

2452 
n_ssids
,

2453 &
ssids
,

2454 
n_chªÃls
,

2455 &
chªÃl
,

2456 
NULL
,

2457 
NULL
,

2459 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


2461 
NULL
,

2463 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 );

2465 
	`¦si_­_obss_sÿn_dÚe_šd
(
dev
, 
ndev_vif
);

2466 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

2467 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

2468 
	}
}

2470 
	$¦si_­_¡¬t_v®id©e
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2472 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2474 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

2475 
	`SLSI_NET_ERR
(
dev
, "AP start„equested on incorrect vif\n");

2476 
ex™_w™h_”rÜ
;

2479 ià(!
£‰šgs
->
ssid_Ën
 || !£‰šgs->
ssid
) {

2480 
	`SLSI_NET_ERR
(
dev
, "SSID‚ot…rovided\n");

2481 
ex™_w™h_”rÜ
;

2484 ià(!
£‰šgs
->
b—cÚ
.
h—d_Ën
 || !£‰šgs->b—cÚ.
h—d
) {

2485 
	`SLSI_NET_ERR
(
dev
, "Beacon‚ot…rovided\n");

2486 
ex™_w™h_”rÜ
;

2489 ià(!
£‰šgs
->
b—cÚ_š‹rv®
) {

2490 
	`SLSI_NET_ERR
(
dev
, "Beacon Interval‚ot…rovided\n");

2491 
ex™_w™h_”rÜ
;

2494 
ndev_vif
->
chªdef
 = &
£‰šgs
->chandef;

2495 
ndev_vif
->
chª
 =‚dev_vif->
chªdef
->chan;

2496 
ndev_vif
->
chªdef_§ved
 = 
£‰šgs
->
chªdef
;

2498 ià(
	`WARN_ON
(!
ndev_vif
->
chª
))

2499 
ex™_w™h_”rÜ
;

2501 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
))

2502 
ex™_w™h_”rÜ
;

2504 ià(
	`WARN_ON
((
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_AP
è&& (ndev_vif->iáy³ !ğ
NL80211_IFTYPE_P2P_GO
)))

2505 
ex™_w™h_”rÜ
;

2507 ià((
ndev_vif
->
chª
->
hw_v®ue
 <ğ14è&& (!
sdev
->
fw_SoáAp_2g_40mhz_’abËd
) &&

2508 (
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_40
)) {

2509 
	`SLSI_NET_ERR
(
dev
, "CÚfigu¿tiÚƒ¼Ü: 40 MHz oÀ2.4 GHz i nÙ suµÜ‹d. ChªÃl_no: %d ChªÃl_width: %d\n", 
ndev_vif
->
chª
->
hw_v®ue
, 
	`¦si_g‘_chªn_šfo
(
sdev
,‚dev_vif->
chªdef
));

2510 
ex™_w™h_”rÜ
;

2515 
ex™_w™h_”rÜ
:

2516  -
EINVAL
;

2517 
	}
}

2519 
	$¦si_g‘_max_bw_mhz
(
¦si_dev
 *
sdev
, 
u16
 
´im_chª_cf
)

2521 
i
;

2522 
›“80211_»gdomaš
 *
»gd
 = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
;

2524 ià(!
»gd
) {

2525 
	`SLSI_WARN
(
sdev
, "NO„egdomain info\n");

2529 
i
 = 0; i < 
»gd
->
n_»g_ruËs
; i++) {

2530 ià((
»gd
->
»g_ruËs
[
i
].
äeq_¿nge
.
¡¬t_äeq_khz
 / 1000 <ğ
´im_chª_cf
 - 10) &&

2531 (
»gd
->
»g_ruËs
[
i
].
äeq_¿nge
.
’d_äeq_khz
 / 1000 >ğ
´im_chª_cf
 + 10))

2532  
»gd
->
»g_ruËs
[
i
].
äeq_¿nge
.
max_bªdwidth_khz
 / 1000;

2535 
	`SLSI_WARN
(
sdev
, "F»q(%dènÙ found iÀ»gdomaš\n", 
´im_chª_cf
);

2537 
	}
}

2539 
	$¦si_cÚfigu»_couÁry_code
(
¦si_dev
 *
sdev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2541 cÚ¡ 
u8
 *
couÁry_›
 = 
NULL
;

2542 
®pha2
[
SLSI_COUNTRY_CODE_LEN
];

2545 
couÁry_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2546 ià(
couÁry_›
) {

2547 
couÁry_›
 += 2;

2548 
	`memıy
(
®pha2
, 
couÁry_›
, 
SLSI_COUNTRY_CODE_LEN
);

2549 ià(
	`memcmp
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
,‡Íha2, 
SLSI_COUNTRY_CODE_LEN
 - 1) != 0) {

2550 ià(
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
®pha2
, 
SLSI_COUNTRY_CODE_LEN
) != 0)

2551  -
EINVAL
;

2555 
	}
}

2557 
	$¦si_­_¡¬t_g‘_šdoÜ_chª_5g
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
, *
šdoÜ_chªÃl
)

2559 
why
 *why = 
sdev
->wiphy;

2560 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2561 
›“80211_chªÃl
 *
chªÃl
 = 
NULL
;

2562 
u32
 
chª_æags
;

2563 
u16
 
ûÁ”_äeq
;

2565 ià(!
sk_šdoÜ_check_fÜ_wifi_sh¬šg
 && 
sdev
->
bªd_5g_suµÜ‹d
 &&

2566 ((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
 / 1000) == 5)) {

2567 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2568 ià(!
chªÃl
) {

2569 
	`SLSI_ERR
(
sdev
, "Invalid frequency %d usedo start AP. Channel‚ot found\n",

2570 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2571  -
EINVAL
;

2573 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
 && (
chªÃl
->
æags
 & 
IEEE80211_CHAN_INDOOR_ONLY
)) {

2574 
i
;

2576 
chª_æags
 = (
IEEE80211_CHAN_INDOOR_ONLY
 | 
IEEE80211_CHAN_RADAR
 |

2577 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_NO_IR
);

2579 
i
 = 0; i < 
why
->
bªds
[
NL80211_BAND_5GHZ
]->
n_chªÃls
; i++) {

2580 ià(!(
why
->
bªds
[
NL80211_BAND_5GHZ
]->
chªÃls
[
i
].
æags
 & 
chª_æags
)) {

2581 
ûÁ”_äeq
 = 
why
->
bªds
[
NL80211_BAND_5GHZ
]->
chªÃls
[
i
].center_freq;

2582 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
ûÁ”_äeq
);

2583 ià(!
£‰šgs
->
chªdef
.
chª
) {

2584 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Inv®id chª fÜ f»qu’cy %d\n", 
ûÁ”_äeq
);

2587 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
ûÁ”_äeq
;

2588 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "ap valid frequency:%d,chan_flags:%x\n",

2589 
ûÁ”_äeq
,

2590 
why
->
bªds
[
NL80211_BAND_5GHZ
]->
chªÃls
[
i
].
æags
);

2591 *
šdoÜ_chªÃl
 = 1;

2595 ià(*
šdoÜ_chªÃl
 == 0) {

2596 
	`SLSI_ERR
(
sdev
, "No valid channel foundo starthe AP");

2597  -
EINVAL
;

2602 
	}
}

2604 
	$¦si_modify_ht_ÿ·_›s
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2606 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2608 ià(
ndev_vif
->
chªdef
->
width
 <ğ
NL80211_CHAN_WIDTH_20
) {

2610 ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
)) {

2611 
u8
 
’fÜû_ht_ÿp1
 = 
sdev
->
fw_ht_ÿp
[0] & (
IEEE80211_HT_CAP_LDPC_CODING
 |

2612 
IEEE80211_HT_CAP_SGI_20
);

2613 
u8
 
’fÜû_ht_ÿp2
 = 
sdev
->
fw_ht_ÿp
[1] & (
IEEE80211_HT_CAP_RX_STBC
 >> 8);

2615 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2616 
£‰šgs
->
b—cÚ
.
_Ën
, 2, 
’fÜû_ht_ÿp1
);

2617 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2618 
£‰šgs
->
b—cÚ
.
_Ën
, 3, 
’fÜû_ht_ÿp2
);

2620 } ià(
	`cfg80211_chªdef_v®id
(
ndev_vif
->
chªdef
)) {

2621 
u8
 *
ht_İ”©iÚ_›
;

2622 
u8
 
£c_chª_off£t
 = 0;

2623 
u8
 
ch
;

2624 
u8
 
bw_40_mšus_chªÃls
[] = { 40, 48, 153, 161, 5, 6, 7, 8, 9, 10, 11 };

2626 
ht_İ”©iÚ_›
 = (
u8
 *)
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
£‰šgs
->
b—cÚ
.

,

2627 
£‰šgs
->
b—cÚ
.
_Ën
);

2628 ià(!
ht_İ”©iÚ_›
) {

2629 
	`SLSI_NET_ERR
(
dev
, "HT Operation IE is‚ot…assed by wpa_supplicant");

2630  -
EINVAL
;

2633 
£c_chª_off£t
 = 
IEEE80211_HT_PARAM_CHA_SEC_ABOVE
;

2634 
ch
 = 0; ch < 
	`ARRAY_SIZE
(
bw_40_mšus_chªÃls
); ch++)

2635 ià(
bw_40_mšus_chªÃls
[
ch
] =ğ
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
) {

2636 
£c_chª_off£t
 = 
IEEE80211_HT_PARAM_CHA_SEC_BELOW
;

2641 
ht_İ”©iÚ_›
 += 3;

2642 *(
ht_İ”©iÚ_›
è|ğ
£c_chª_off£t
;

2643 *(
ht_İ”©iÚ_›
è|ğ
IEEE80211_HT_PARAM_CHAN_WIDTH_ANY
;

2648 ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

,

2649 
£‰šgs
->
b—cÚ
.
_Ën
)) {

2650 
u8
 
’fÜû_ht_ÿp1
 = 
sdev
->
fw_ht_ÿp
[0] & (
IEEE80211_HT_CAP_SUP_WIDTH_20_40
 |

2651 
IEEE80211_HT_CAP_SGI_20
 |

2652 
IEEE80211_HT_CAP_SGI_40
 |

2653 
IEEE80211_HT_CAP_LDPC_CODING
);

2654 
u8
 
’fÜû_ht_ÿp2
 = 
sdev
->
fw_ht_ÿp
[1] & (
IEEE80211_HT_CAP_RX_STBC
 >> 8);

2656 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2657 
£‰šgs
->
b—cÚ
.
_Ën
, 2, 
’fÜû_ht_ÿp1
);

2658 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2659 
£‰šgs
->
b—cÚ
.
_Ën
, 3, 
’fÜû_ht_ÿp2
);

2663 
	}
}

2665 
	$¦si_£t_­_mode
(
Ãtdev_vif
 *
ndev_vif
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, 
boŞ
 
­³nd_vht_›s
)

2667 ià(
­³nd_vht_›s
) {

2668 
ndev_vif
->
­
.
mode
 = 
SLSI_80211_MODE_11AC
;

2669 } ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
) &&

2670 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
)) {

2671 
ndev_vif
->
­
.
mode
 = 
SLSI_80211_MODE_11N
;

2673 cÚ¡ 
u8
 *
›
;

2675 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2676 ià(
›
)

2677 
ndev_vif
->
­
.
mode
 = 
	`¦si_g‘_suµÜ‹d_mode
(
›
);

2679 
	}
}

2681 
	$¦si_¡Üe_£‰šgs_fÜ_»cov”y
(
cfg80211_­_£‰šgs
 *
£‰šgs
, 
Ãtdev_vif
 *
ndev_vif
)

2683 
ndev_vif
->
backup_£‰šgs
 = *
£‰šgs
;

2684 ià(&
ndev_vif
->
backup_£‰šgs
 =ğ
£‰šgs
)

2686 
ndev_vif
->
backup_£‰šgs
.
chªdef
.
chª
 =

2687 (
›“80211_chªÃl
 *)
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->
chªdef
.
chª
, (ieee80211_channel));

2688 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
h—d
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->b—cÚ.h—d, s‘tšgs->b—cÚ.
h—d_Ën
);

2689 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.

 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->b—cÚ., s‘tšgs->b—cÚ.
_Ën
);

2690 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
b—cÚ_›s
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.beacon_ies,

2691 
£‰šgs
->
b—cÚ
.
b—cÚ_›s_Ën
);

2692 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
´ob”e¥_›s
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.proberesp_ies,

2693 
£‰šgs
->
b—cÚ
.
´ob”e¥_›s_Ën
);

2694 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
assoüe¥_›s
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.assocresp_ies,

2695 
£‰šgs
->
b—cÚ
.
assoüe¥_›s_Ën
);

2696 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
´obe_»¥
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.probe_resp,

2697 
£‰šgs
->
b—cÚ
.
´obe_»¥_Ën
);

2698 
ndev_vif
->
backup_£‰šgs
.
ssid
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->ssid, s‘tšgs->
ssid_Ën
);

2699 ià(
£‰šgs
->
ht_ÿp
) {

2700 
ndev_vif
->
backup_£‰šgs
.
ht_ÿp
 =

2701 (
›“80211_ht_ÿp
 *)
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->
ht_ÿp
, (ieee80211_ht_cap));

2703 ià(
£‰šgs
->
vht_ÿp
) {

2704 
ndev_vif
->
backup_£‰šgs
.
vht_ÿp
 =

2705 (
›“80211_vht_ÿp
 *)
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->
vht_ÿp
, (ieee80211_vht_cap));

2707 
	}
}

2709 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2710 
boŞ
 
	$¦si_­_chªdef_vht_ht
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
wifi_sh¬šg_chªÃl_sw™ched
)

2712 
boŞ
 
	$¦si_­_chªdef_vht_ht
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
)

2715 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2716 
boŞ
 
­³nd_vht_›s
 = 
çl£
;

2718 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "ChªÃl: %d, Maximum bªdwidth: %d\n", 
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
,

2719 
	`¦si_g‘_max_bw_mhz
(
sdev
, 
ndev_vif
->
chªdef
->
chª
->
ûÁ”_äeq
));

2721 ià(
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
 >= 36 &&‚dev_vif->chandef->chan->hw_value < 165 &&

2722 
sdev
->
fw_vht_’abËd
 && sdev->
®low_sw™ch_80_mhz
 &&

2723 (
	`¦si_g‘_max_bw_mhz
(
sdev
, 
ndev_vif
->
chªdef
->
chª
->
ûÁ”_äeq
) >= 80)) {

2724 
u16
 
İ”_chª
 = 
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
;

2726 
­³nd_vht_›s
 = 
Œue
;

2727 
ndev_vif
->
chªdef
->
width
 = 
NL80211_CHAN_WIDTH_80
;

2729 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "5 GHz- Include VHT\n");

2730 ià(
İ”_chª
 >= 36 && oper_chan <= 48)

2731 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(42, 
NL80211_BAND_5GHZ
);

2732 ià(
İ”_chª
 >= 149 && oper_chan <= 161)

2733 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(155, 
NL80211_BAND_5GHZ
);

2734 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2736 ià(
wifi_sh¬šg_chªÃl_sw™ched
 == 1) {

2737 ià(
İ”_chª
 >= 52 && oper_chan <= 64)

2738 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(58,

2739 
NL80211_BAND_5GHZ
);

2740 ià(
İ”_chª
 >= 100 && oper_chan <= 112)

2741 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(106,

2742 
NL80211_BAND_5GHZ
);

2743 ià(
İ”_chª
 >= 116 && oper_chan <= 128)

2744 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(122,

2745 
NL80211_BAND_5GHZ
);

2746 ià(
İ”_chª
 >= 132 && oper_chan <= 144)

2747 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(138,

2748 
NL80211_BAND_5GHZ
);

2751 } ià(
sdev
->
fw_ht_’abËd
 && sdev->
®low_sw™ch_40_mhz
 &&

2752 
	`¦si_g‘_max_bw_mhz
(
sdev
, 
ndev_vif
->
chªdef
->
chª
->
ûÁ”_äeq
) >= 40 &&

2753 ((
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
 < 165 &&‚dev_vif->chandef->chan->hw_value >= 36))) {

2755 
u16
 
İ”_chª
 = 
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
;

2756 
u8
 
bw_40_mšus_chªÃls
[] = { 40, 48, 153, 161, 5, 6, 7, 8, 9, 10, 11 };

2757 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2758 
u8
 
bw_40_mšus_dfs_chªÃls
[] = { 144, 136, 128, 120, 112, 104, 64, 56 };

2760 
u8
 
ch
;

2762 
ndev_vif
->
chªdef
->
width
 = 
NL80211_CHAN_WIDTH_40
;

2763 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 =‚dev_vif->chªdef->
chª
->
ûÁ”_äeq
 + 10;

2764 
ch
 = 0; ch < 
	`ARRAY_SIZE
(
bw_40_mšus_chªÃls
); ch++)

2765 ià(
İ”_chª
 =ğ
bw_40_mšus_chªÃls
[
ch
]) {

2766 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 =‚dev_vif->chªdef->
chª
->
ûÁ”_äeq
 - 10;

2770 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2771 ià(
wifi_sh¬šg_chªÃl_sw™ched
 == 1) {

2772 
ch
 = 0; ch < 
	`ARRAY_SIZE
(
bw_40_mšus_dfs_chªÃls
); ch++)

2773 ià(
İ”_chª
 =ğ
bw_40_mšus_dfs_chªÃls
[
ch
]) {

2774 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 =‚dev_vif->chªdef->
chª
->
ûÁ”_äeq
 - 10;

2780  
­³nd_vht_›s
;

2781 
	}
}

2783 
	$¦si_¡İ_p2p_group_içû_Ú_­_¡¬t
(
¦si_dev
 *
sdev
)

2785 
Ãt_deviû
 *
p2p_dev
 = 
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
];

2786 
Ãtdev_vif
 *
ndev_p2p_vif
;

2788 
	`SLSI_NET_INFO
(
p2p_dev
, "P2P group interface is‚ot„emoved before starting AP\n");

2789 ià(!
p2p_dev
)

2791 
ndev_p2p_vif
 = 
	`Ãtdev_´iv
(
p2p_dev
);

2792 
	`SLSI_MUTEX_LOCK
(
ndev_p2p_vif
->
vif_mu‹x
);

2793 
	`¦si_vif_ş—nup
(
sdev
, 
p2p_dev
, 
Œue
, 0);

2794 
	`SLSI_MUTEX_UNLOCK
(
ndev_p2p_vif
->
vif_mu‹x
);

2795 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2796 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_p2p
, 
p2p_dev
);

2797 ià(
sdev
->
Ãtdev_­
)

2798 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
Ãtdev_­
);

2799 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2800 
	}
}

2802 
	$¦si_¡¬t_­
(
why
 *why, 
Ãt_deviû
 *
dev
,

2803 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2805 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2806 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2807 
Ãt_deviû
 *
wÏn_dev
;

2808 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

2809 
r
 = 0;

2810 cÚ¡ 
u8
 *
w·_›_pos
 = 
NULL
;

2811 
w·_›_Ën
 = 0;

2812 cÚ¡ 
u8
 *
wmm_›_pos
 = 
NULL
;

2813 
wmm_›_Ën
 = 0;

2814 
boŞ
 
­³nd_vht_›s
 = 
çl£
;

2815 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2816 
wifi_sh¬šg_chªÃl_sw™ched
 = 0;

2817 
Ãtdev_vif
 *
ndev_¡a_vif
;

2818 
šv®id_chªÃl
 = 0;

2820 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
 = 0;

2821 
u8
 *
ds_·¿ms_›
 = 
NULL
;

2822 
›“80211_mgmt
 *
mgmt
;

2823 
u16
 
b—cÚ_›_h—d_Ën
;

2824 
u8
 *
ht_İ”©iÚ_›
 = 
NULL
;

2825 
šdoÜ_chªÃl
 = 0;

2827 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

2828 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

2829 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

2830 
r
 = -
EINVAL
;

2831 
ex™_w™h_¡¬t_¡İ_mu‹x
;

2834 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
 && 
sdev
->
Ãtdev_­
 !ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
])

2835 
	`¦si_¡İ_p2p_group_içû_Ú_­_¡¬t
(
sdev
);

2837 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2839 
wÏn_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2840 ià(
wÏn_dev
)

2841 
	`¦si_abÜt_hw_sÿn
(
sdev
, 
wÏn_dev
);

2843 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "AP f»qu’cy„eûived: %d\n", 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2844 
mgmt
 = (
›“80211_mgmt
 *)
£‰šgs
->
b—cÚ
.
h—d
;

2845 
b—cÚ_›_h—d_Ën
 = 
£‰šgs
->
b—cÚ
.
h—d_Ën
 - ((
u8
 *)
mgmt
->
u
.b—cÚ.
v¬ŸbË
 - (u8 *)mgmt);

2846 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2847 
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
wÏn_dev
);

2848 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
)) {

2849 ià(
ndev_¡a_vif
) {

2850 
	`SLSI_MUTEX_LOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

2851 ià((
ndev_¡a_vif
->
aùiv©ed
è&& (ndev_¡a_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) &&

2852 (
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

2853 
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

2854 #ifdeà
CONFIG_SCSC_WLAN_SINGLE_ANTENNA


2855 
šv®id_chªÃl
 = 
	`¦si_g‘_mhs_ws_chª_vsdb
(
why
, 
dev
, 
£‰šgs
, 
sdev
,

2856 &
wifi_sh¬šg_chªÃl_sw™ched
);

2858 
šv®id_chªÃl
 = 
	`¦si_g‘_mhs_ws_chª_rsdb
(
why
, 
dev
, 
£‰šgs
, 
sdev
,

2859 &
wifi_sh¬šg_chªÃl_sw™ched
);

2861 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
 = 1;

2862 ià(
šv®id_chªÃl
) {

2863 
	`SLSI_NET_ERR
(
dev
, "Rejecting AP start„eq‡t host (invalid channel)\n");

2864 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

2865 
r
 = -
EINVAL
;

2866 
ex™_w™h_vif_mu‹x
;

2869 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Station frequency: %d, SoftAP frequency: %d\n",

2870 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
, 
£‰šgs
->
chªdef
.chan->center_freq);

2872 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

2877 
	`mem£t
(&
ndev_vif
->
­
, 0, (ndev_vif->ap));

2880 
r
 = 
	`¦si_cÚfigu»_couÁry_code
(
sdev
, 
£‰šgs
);

2881 ià(
r
 != 0)

2882 
ex™_w™h_vif_mu‹x
;

2884 
r
 = 
	`¦si_­_¡¬t_g‘_šdoÜ_chª_5g
(
sdev
, 
dev
, 
£‰šgs
, 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
, &
šdoÜ_chªÃl
);

2885 ià(
r
 != 0)

2886 
ex™_w™h_vif_mu‹x
;

2888 
r
 = 
	`¦si_­_¡¬t_v®id©e
(
dev
, 
sdev
, 
£‰šgs
);

2889 ià(
r
 != 0)

2890 
ex™_w™h_vif_mu‹x
;

2892 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
) {

2893 
Ãt_deviû
 *
p2p_dev
;

2895 
	`¦si_p2p_group_¡¬t_»move_unsync_vif
(
sdev
);

2896 
p2p_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

2897 
	`SLSI_ETHER_COPY
(
deviû_add»ss
, 
p2p_dev
->
dev_addr
);

2898 ià(
k“p_®ive_³riod
 !ğ
SLSI_P2PGO_KEEP_ALIVE_PERIOD_SEC
)

2899 ià(
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_MLMEGO_KEEP_ALIVE_TIMEOUT
,

2900 
k“p_®ive_³riod
) != 0) {

2901 
	`SLSI_NET_ERR
(
dev
, "P2PGO Keep Alive MIB set failed");

2902 
r
 = -
EINVAL
;

2903 
ex™_w™h_vif_mu‹x
;

2907 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2908 
­³nd_vht_›s
 = 
	`¦si_­_chªdef_vht_ht
(
dev
, 
sdev
, 
wifi_sh¬šg_chªÃl_sw™ched
);

2909 ià(
	`¦si_check_chªÃliz©iÚ
(
sdev
, 
ndev_vif
->
chªdef
, 
wifi_sh¬šg_chªÃl_sw™ched
) != 0) {

2911 
­³nd_vht_›s
 = 
	`¦si_­_chªdef_vht_ht
(
dev
, 
sdev
);

2912 ià(
	`¦si_check_chªÃliz©iÚ
(
sdev
, 
ndev_vif
->
chªdef
, 0) != 0) {

2914 
r
 = -
EINVAL
;

2915 
ex™_w™h_vif_mu‹x
;

2918 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
) {

2920 ià(
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_20
)

2921 
	`¦si_­_¡¬t_obss_sÿn
(
sdev
, 
dev
, 
ndev_vif
);

2924 
r
 = 
	`¦si_modify_ht_ÿ·_›s
(
dev
, 
sdev
, 
£‰šgs
);

2925 ià(
r
 != 0)

2926 
ex™_w™h_vif_mu‹x
;

2928 ià(
šdoÜ_chªÃl
 == 1

2929 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2930 || (
wifi_sh¬šg_chªÃl_sw™ched
 == 1)

2933 
	`¦si_modify_›s_Ú_chªÃl_sw™ch
(
dev
, 
£‰šgs
, 
ds_·¿ms_›
, 
ht_İ”©iÚ_›
, 
mgmt
, 
b—cÚ_›_h—d_Ën
);

2935 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_AP
;

2937 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

2938 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed\n");

2939 
r
 = -
EINVAL
;

2940 
ex™_w™h_vif_mu‹x
;

2943 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0) {

2944 
	`SLSI_NET_ERR
(
dev
, "slsi_vif_activated failed\n");

2945 
ex™_w™h_vif
;

2951 
w·_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2952 ià(
w·_›_pos
) {

2953 
w·_›_Ën
 = *(
w·_›_pos
 + 1) + 2;

2954 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "WPA IE found: L’gth = %zu\n", 
w·_›_Ën
);

2955 
	`SLSI_EC_GOTO
(
	`¦si_ÿche_›s
(
w·_›_pos
, 
w·_›_Ën
, &
ndev_vif
->
­
.
ÿche_w·_›
, &ndev_vif->­.w·_›_Ën), 
r
, 
ex™_w™h_vif
);

2958 
wmm_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2959 ià(
wmm_›_pos
) {

2960 
wmm_›_Ën
 = *(
wmm_›_pos
 + 1) + 2;

2961 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "WMM IE found: L’gth = %zu\n", 
wmm_›_Ën
);

2962 
	`SLSI_EC_GOTO
(
	`¦si_ÿche_›s
(
wmm_›_pos
, 
wmm_›_Ën
, &
ndev_vif
->
­
.
ÿche_wmm_›
, &ndev_vif->­.wmm_›_Ën), 
r
, 
ex™_w™h_vif
);

2965 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2972 ià((
wmm_›_pos
è|| (
w·_›_pos
è|| (
£‰šgs
->
b—cÚ
.
b—cÚ_›s_Ën
 > 0 && s‘tšgs->b—cÚ.
b—cÚ_›s
)) {

2973 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Add infoƒlements for beacon\n");

2974 
	`SLSI_EC_GOTO
(
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
£‰šgs
->
b—cÚ
.
b—cÚ_›s
, s‘tšgs->b—cÚ.
b—cÚ_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2975 
	`SLSI_EC_GOTO
(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_BEACON
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2976 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2979 ià((
wmm_›_pos
è|| (
w·_›_pos
è|| (
£‰šgs
->
b—cÚ
.
´ob”e¥_›s_Ën
 > 0 && s‘tšgs->b—cÚ.
´ob”e¥_›s
)) {

2980 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Add infoƒlements for…robe„esponse\n");

2981 
	`SLSI_EC_GOTO
(
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
£‰šgs
->
b—cÚ
.
´ob”e¥_›s
, s‘tšgs->b—cÚ.
´ob”e¥_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2982 
	`SLSI_EC_GOTO
(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2983 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2986 ià((
wmm_›_pos
è|| (
w·_›_pos
è|| (
£‰šgs
->
b—cÚ
.
assoüe¥_›s_Ën
 > 0 && s‘tšgs->b—cÚ.
assoüe¥_›s
)) {

2987 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Add infoƒlements for‡ssoc„esponse\n");

2988 
	`SLSI_EC_GOTO
(
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
£‰šgs
->
b—cÚ
.
assoüe¥_›s
, s‘tšgs->b—cÚ.
assoüe¥_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2989 
	`SLSI_EC_GOTO
(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_RESPONSE
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2990 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2993 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
) {

2994 
u32
 
af_bm­_aùive
 = 
SLSI_ACTION_FRAME_PUBLIC
;

2995 
u32
 
af_bm­_su¥’ded
 = 
SLSI_ACTION_FRAME_PUBLIC
;

2997 
r
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
af_bm­_aùive
, 
af_bm­_su¥’ded
);

2998 ià(
r
 != 0) {

2999 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_»gi¡”_aùiÚ_äamçed:„esuÉcodğ%d\n", 
r
);

3000 
ex™_w™h_vif
;

3004 
	`¦si_£t_­_mode
(
ndev_vif
, 
£‰šgs
, 
­³nd_vht_›s
);

3006 
r
 = 
	`¦si_mlme_¡¬t
(
sdev
, 
dev
, dev->
dev_addr
, 
£‰šgs
, 
w·_›_pos
, 
wmm_›_pos
, 
­³nd_vht_›s
);

3008 
	`cfg80211_ch_sw™ch_nÙify
(
dev
, &
£‰šgs
->
chªdef
);

3010 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


3011 ià(
r
 == 0)

3012 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Soft Ap started on frequency: %d\n",

3013 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

3014 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
))

3015 
ndev_vif
->
chª
 = 
£‰šgs
->
chªdef
.chan;

3017 ià(
r
 != 0) {

3018 
	`SLSI_NET_ERR
(
dev
, "S¹‡°çed:„esuÉcodğ%d f»qu’cy = %d\n", 
r
,

3019 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

3020 
ex™_w™h_vif
;

3021 } ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
) {

3022 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_GROUP_FORMED_GO
);

3024 
ndev_vif
->
­
.
b—cÚ_š‹rv®
 = 
£‰šgs
->beacon_interval;

3025 
ndev_vif
->
­
.
ssid_Ën
 = 
£‰šgs
->ssid_len;

3026 
	`memıy
(
ndev_vif
->
­
.
ssid
, 
£‰šgs
->ssid, s‘tšgs->
ssid_Ën
);

3028 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

3030 ià(
ndev_vif
->
add»ss
)

3032 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

3034 
r
 = 
	`¦si_»ad_discÚÃù_šd_timeout
(
sdev
, 
SLSI_PSID_UNIFI_DISCONNECT_TIMEOUT
);

3035 ià(
r
 != 0)

3036 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
 = *sdev->
sig_wa™_cfm_timeout
;

3038 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "¦si_»ad_discÚÃù_šd_timeout:imeouˆğ%d", 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
);

3039 
ex™_w™h_vif_mu‹x
;

3040 
ex™_w™h_vif
:

3041 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

3042 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

3043 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

3044 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

3045 
r
 = -
EINVAL
;

3046 
ex™_w™h_vif_mu‹x
:

3047 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3048 
ex™_w™h_¡¬t_¡İ_mu‹x
:

3049 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

3050 
	`¦si_¡Üe_£‰šgs_fÜ_»cov”y
(
£‰šgs
, 
ndev_vif
);

3051  
r
;

3052 
	}
}

3054 
	$¦si_chªge_b—cÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

3055 
cfg80211_b—cÚ_d©a
 *
šfo
)

3057 
	`SLSI_UNUSED_PARAMETER
(
šfo
);

3059  -
EOPNOTSUPP
;

3060 
	}
}

3062 
	$¦si_¡İ_­
(
why
 *why, 
Ãt_deviû
 *
dev
)

3064 
	`¦si_»£t_throughput_¡©s
(
dev
);

3067 
	}
}

3069 
	$¦si_p2p_group_mgmt_tx
(cÚ¡ 
›“80211_mgmt
 *
mgmt
, 
why
 *wiphy,

3070 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
,

3071 
wa™
, cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
,

3072 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
)

3074 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3075 
Ãtdev_vif
 *
ndev_vif
;

3076 
Ãt_deviû
 *
Ãtdev
;

3077 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

3078 
r
 = 0;

3079 
u32
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3080 
u16
 
äeq
 = 0;

3081 
u32
 
dw–l_time
 = 
SLSI_FORCE_SCHD_ACT_FRAME_MSEC
;

3082 
u16
 
d©a_un™_desc
 = 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
;

3084 ià(
sdev
->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
) {

3085 
	`SLSI_NET_ERR
(
dev
, "sdev->p2p_group_exp_äam: %d\n", 
sdev
->
p2p_group_exp_äame
);

3086  -
EINVAL
;

3089 
Ãtdev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

3090 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

3092 ià(!
ndev_vif
->
chª
) {

3093 
	`SLSI_NET_ERR
(
dev
, "ndev_vif->chan is‚ull\n");

3094  -
EINVAL
;

3097 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3098 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Sending Action frame (%s) on…2p group vif (%d), vif_index = %d,"

3100 "sdev->p2p_group_exp_äamğ%d\n", 
	`¦si_·_subty³_‹xt
(
subty³
), 
ndev_vif
->
aùiv©ed
,

3101 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
, 
chª
->
hw_v®ue
,‚dev_vif->chª->hw_v®ue, 
wa™
,

3102 
sdev
->
p2p_group_exp_äame
);

3104 ià(!((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
è|| (ndev_vif->iáy³ =ğ
NL80211_IFTYPE_P2P_CLIENT
)))

3105 
ex™_w™h_”rÜ
;

3107 ià(
chª
->
hw_v®ue
 !ğ
ndev_vif
->chan->hw_value) {

3108 
äeq
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chª
->
ûÁ”_äeq
);

3109 
dw–l_time
 = 
wa™
;

3113 ià(
subty³
 !ğ
SLSI_P2P_PA_GO_NEG_RSP
)

3114 
sdev
->
p2p_group_exp_äame
 = 
	`¦si_g‘_exp_³”_äame_subty³
(
subty³
);

3116 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãtdev
, 
buf
, 
Ën
, 
d©a_un™_desc
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 
äeq
, 
dw–l_time
 * 1000, 0);

3117 ià(
r
)

3118 
ex™_w™h_lock
;

3119 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3120 
r
 = 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

3121 
ex™_w™h_lock
;

3123 
ex™_w™h_”rÜ
:

3124 
r
 = -
EINVAL
;

3125 
ex™_w™h_lock
:

3126 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3127  
r
;

3128 
	}
}

3131 
	$¦si_p2p_mgmt_tx
(cÚ¡ 
›“80211_mgmt
 *
mgmt
, 
why
 *wiphy,

3132 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
,

3133 
›“80211_chªÃl
 *
chª
, 
wa™
,

3134 cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
, 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
)

3136 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3137 
»t
 = 0;

3139 ià(
	`›“80211_is_aùiÚ
(
mgmt
->
äame_cÚŒŞ
)) {

3140 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3141 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

3142 
u8
 
exp_³”_äame
;

3143 
u32
 
dw–l_time
 = 0;

3145 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "AùiÚ f¿m(%s), unsync_vif_aùiv(%d)\n", 
	`¦si_·_subty³_‹xt
(
subty³
), 
ndev_vif
->
aùiv©ed
);

3147 ià(
subty³
 =ğ
SLSI_PA_INVALID
) {

3148 
	`SLSI_NET_ERR
(
dev
, "Invalid Action frame subtype\n");

3149 
ex™_w™h_”rÜ
;

3153 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
)

3154 ià(
	`¦si_p2p_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
, 
çl£
) != 0)

3155 
ex™_w™h_”rÜ
;

3158 ià(
ndev_vif
->
driv”_chªÃl
 !ğ
chª
->
hw_v®ue
) {

3159 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
NULL
, 0) != 0)

3160 
	`SLSI_NET_ERR
(
dev
, "Clearing Probe Response IEs failed for unsync vif\n");

3161 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

3163 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0)

3164 
ex™_w™h_vif
;

3166 
ndev_vif
->
chª
 = chan;

3167 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

3172 
exp_³”_äame
 = 
	`¦si_g‘_exp_³”_äame_subty³
(
subty³
);

3174 ià(
exp_³”_äame
 !ğ
SLSI_PA_INVALID
) {

3175 ià((
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_RSP
è&& (
	`¦si_p2p_g‘_go_Ãg_r¥_¡©us
(
dev
, 
mgmt
è!ğ
SLSI_P2P_STATUS_CODE_SUCCESS
)) {

3176 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "GO_NEG_RSP Tx,…eer„esponse‚otƒxpected\n");

3177 
exp_³”_äame
 = 
SLSI_PA_INVALID
;

3179 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Peer„esponseƒxpected with‡ction frame (%s)\n",

3180 
	`¦si_·_subty³_‹xt
(
exp_³”_äame
));

3182 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

3183 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

3185 ià(
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_RSP
)

3186 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
Œue
;

3189 ià(
wa™
)

3190 
dw–l_time
 = 
wa™
;

3192 
dw–l_time
 = 
SLSI_FORCE_SCHD_ACT_FRAME_MSEC
;

3196 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3199 ià(
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 
dw–l_time
 * 1000, 0) != 0)

3200 
ex™_w™h_vif
;

3201 ià(
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_CFM
)

3202 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

3203 ià((
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_REQ
è|| (subty³ =ğ
SLSI_P2P_PA_PROV_DISC_REQ
))

3204 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
Œue
;

3206 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
 == 0) {

3207 
n_wa™
 = 0;

3209 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "StÜmgmˆäamtx d©¨fÜ cook› = 0x%Îx\n", *
cook›
);

3211 
»t
 = 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

3212 ià(
»t
 != 0)

3213 
ex™_w™h_vif
;

3214 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
exp_³”_äame
;

3216 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_ACTION_FRAME_TX_RX
);

3217 ià((
exp_³”_äame
 =ğ
SLSI_P2P_PA_GO_NEG_RSP
è|| (exp_³”_äam=ğ
SLSI_P2P_PA_GO_NEG_CFM
))

3222 
n_wa™
 = 
SLSI_P2P_NEG_PROC_UNSYNC_VIF_RETAIN_DURATION
;

3223 ià(
exp_³”_äame
 !ğ
SLSI_PA_INVALID
)

3225 
n_wa™
 = 
wa™
 + 
SLSI_P2P_MGMT_TX_EXTRA_MSEC
;

3226 ià(
n_wa™
) {

3227 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "»š unsynøviàfÜ du¿tiÚ (%dèm£c\n", 
n_wa™
);

3228 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
n_wa™
);

3234 
	`WLBT_WARN_ON
(
sdev
->
p2p_¡©e
 !ğ
P2P_ACTION_FRAME_TX_RX
);

3236 ià(!
dÚt_wa™_fÜ_ack
) {

3237 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "S’d immedŸ‹x_¡©u (cook› = 0x%Îx)\n", *
cook›
);

3238 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
, *
cook›
, 
buf
, 
Ën
, 
Œue
, 
GFP_KERNEL
);

3241 
ex™
;

3245 
	`SLSI_NET_ERR
(
dev
, "Drop Tx frame: Unexpected Management frame\n");

3246 
ex™_w™h_”rÜ
;

3248 
ex™_w™h_vif
:

3249 ià(
sdev
->
p2p_¡©e
 !ğ
P2P_LISTENING
)

3250 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3251 
ex™_w™h_”rÜ
:

3252 
»t
 = -
EINVAL
;

3253 
ex™
:

3254  
»t
;

3255 
	}
}

3257 
	$¦si_mgmt_tx_ÿnûl_wa™
(
why
 *wiphy,

3258 
wœ–ess_dev
 *
wdev
,

3259 
u64
 
cook›
)

3261 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3262 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3263 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3265 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3267 
	`SLSI_NET_INFO
(
dev
, "iface_num = %d, cookie = 0x%llx, vif_index = %d, vif_type = %d,"

3269 "sdev->wÏn_unsync_vif_¡©ğ%d\n", ()
ndev_vif
->
iâum
, 
cook›
,()ndev_vif->ifnum,

3270 ()
ndev_vif
->
vif_ty³
, 
sdev
->
p2p_¡©e
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,

3271 ()
sdev
->
p2p_group_exp_äame
, sdev->
wÏn_unsync_vif_¡©e
);

3274 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&& (
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
è&& (ndev_vif->
mgmt_tx_d©a
.
cook›
 == cookie)) {

3275 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

3276 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3278 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

3279 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3281 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)) {

3282 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

3284 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

3285 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

3287 } ià((
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
)è&& (sdev->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
)) {

3289 
	`¦si_ş—r_offchªÃl_d©a
(
sdev
, (!
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(sdev, 
ndev_vif
)è? 
Œue
 : 
çl£
);

3290 } ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& (
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_VIF_TX
è&& (ndev_vif->
mgmt_tx_d©a
.
cook›
 == cookie)) {

3291 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

3292 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
);

3293 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
SLSI_HS2_UNSYNC_VIF_EXTRA_MSEC
));

3294 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
) {

3295 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3296 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3298 } ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION


3299 && 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

3300 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
) {

3301 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3302 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3306 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3308 
	}
}

3310 
	$¦si_mgmt_äame_»gi¡”
(
why
 *wiphy,

3311 
wœ–ess_dev
 *
wdev
,

3312 
u16
 
äame_ty³
, 
boŞ
 
»g
)

3314 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3315 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3317 
	`SLSI_UNUSED_PARAMETER
(
äame_ty³
);

3318 
	`SLSI_UNUSED_PARAMETER
(
»g
);

3320 ià(
	`WARN_ON
(!
dev
))

3323 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

3324 
	}
}

3326 
	$¦si_wÏn_mgmt_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3327 
›“80211_chªÃl
 *
chª
, 
wa™
,

3328 cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
, 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
)

3330 
u32
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3331 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3332 
r
 = 0;

3333 
›“80211_mgmt
 *
mgmt
 = (›“80211_mgmˆ*)
buf
;

3334 
u8
 
exp_³”_äame
 = 
SLSI_PA_INVALID
;

3335 
subty³
 = 
SLSI_PA_INVALID
;

3337 ià(!
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
))

3338 
	`¦si_wÏn_dump_public_aùiÚ_subty³
(
sdev
, 
mgmt
, 
Œue
);

3340 ià(
	`›“80211_is_aùiÚ
(
mgmt
->
äame_cÚŒŞ
)) {

3341 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

3343 ià(
subty³
 !ğ
SLSI_PA_INVALID
)

3344 
exp_³”_äame
 = 
	`¦si_g‘_exp_³”_äame_subty³
(
subty³
);

3347 ià(!
ndev_vif
->
aùiv©ed
) {

3348 ià(
subty³
 >ğ
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 && subty³ <ğ
SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
) {

3349 
ndev_vif
->
mgmt_tx_gas_äame
 = 
Œue
;

3350 
	`SLSI_ETHER_COPY
(
ndev_vif
->
gas_äame_mac_addr
, 
mgmt
->
§
);

3352 
ndev_vif
->
mgmt_tx_gas_äame
 = 
çl£
;

3354 
r
 = 
	`¦si_wÏn_unsync_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
);

3355 ià(
r
)

3356  
r
;

3358 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 
wa™
 * 1000, 0);

3359 ià(
r
)

3360 
ex™_w™h_vif
;

3361 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_TX
;

3362 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
wa™
));

3365 ià(
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
)) {

3366 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Transmit onhe current frequency\n");

3368 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3369 
ndev_vif
->
¡a
.
§e_auth_ty³
 = 
mgmt
->
u
.
auth
.
auth_Œª§ùiÚ
;

3370 
wa™
 = 
sdev
->
§e_dw–l_time
;

3373 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
,

3374 
FAPI_MESSAGETYPE_IEEE80211_MGMT
, 
ho¡_g
, 0, 
wa™
 * 1000, 0);

3375 ià(
r
)

3376  
r
;

3377 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_PRECONNECT
) {

3378 ià(
subty³
 >ğ
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 && subty³ <ğ
SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
) {

3379 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3380 
ndev_vif
->
mgmt_tx_gas_äame
 = 
Œue
;

3381 
	`SLSI_ETHER_COPY
(
ndev_vif
->
gas_äame_mac_addr
, 
mgmt
->
§
);

3382 
r
 = 
	`¦si_wÏn_unsync_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
);

3383 ià(
r
)

3384  
r
;

3386 ià(
ndev_vif
->
mgmt_tx_gas_äame
) {

3387 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3388 
ndev_vif
->
mgmt_tx_gas_äame
 = 
çl£
;

3389 
r
 = 
	`¦si_wÏn_unsync_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
);

3390 ià(
r
)

3391  
r
;

3395 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
);

3397 ià(
ndev_vif
->
driv”_chªÃl
 !ğ
chª
->
hw_v®ue
) {

3398 
r
 = 
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0);

3399 ià(
r
)

3400 
ex™_w™h_vif
;

3402 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

3404 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "wÏÀunsynøviài aùive, s’d f¿mÚ chªÃÈäeq = %d\n", 
chª
->
ûÁ”_äeq
);

3405 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 
wa™
 * 1000, 0);

3406 ià(
r
)

3407 
ex™_w™h_vif
;

3408 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_TX
;

3409 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
wa™
));

3410 } ià(
ndev_vif
->
chª
 &&‚dev_vif->chª->
hw_v®ue
 == chan->hw_value) {

3412 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "STA VIF i aùivÚ samchªÃl, s’d f¿mÚ chªÃÈäeq %d\n", 
chª
->
ûÁ”_äeq
);

3413 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0);

3414 ià(
r
)

3415  
r
;

3417 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "STA VIF i aùivÚ‡ difã»Á chªÃl, s’d f¿mÚ chªÃÈäeq %d\n", 
chª
->
ûÁ”_äeq
);

3419 ià((
subty³
 =ğ
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 || subty³ =ğ
SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
è&& 
wa™
 > 
SLSI_FW_MAX_OFFCHANNEL_DWELL_TIME
)

3420 
wa™
 = 
SLSI_FW_MAX_OFFCHANNEL_DWELL_TIME
;

3421 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 
	`SLSI_FREQ_HOST_TO_FW
(
chª
->
ûÁ”_äeq
), 
wa™
 * 1000, 0);

3422 ià(
r
)

3423  
r
;

3427 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
exp_³”_äame
;

3428 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3429 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

3430  
r
;

3432 
ex™_w™h_vif
:

3433 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3434  
r
;

3435 
	}
}

3437 
	$¦si_mgmt_tx
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

3438 
cfg80211_mgmt_tx_·¿ms
 *
·¿ms
,

3439 
u64
 *
cook›
)

3448 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3449 
›“80211_chªÃl
 *
chª
 = 
·¿ms
->chan;

3450 
boŞ
 
offchª
 = 
·¿ms
->offchan;

3451 
wa™
 = 
·¿ms
->wait;

3452 cÚ¡ 
u8
 *
buf
 = 
·¿ms
->buf;

3453 
size_t
 
Ën
 = 
·¿ms
->len;

3454 
boŞ
 
no_cck
 = 
·¿ms
->no_cck;

3455 
boŞ
 
dÚt_wa™_fÜ_ack
 = 
·¿ms
->dont_wait_for_ack;

3456 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3457 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3458 cÚ¡ 
›“80211_mgmt
 *
mgmt
 = (cÚ¡ ›“80211_mgmˆ*)
buf
;

3459 
r
 = 0;

3461 
	`SLSI_UNUSED_PARAMETER
(
offchª
);

3462 
	`SLSI_UNUSED_PARAMETER
(
no_cck
);

3463 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

3464 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

3465 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

3466 
r
 = -
EINVAL
;

3467 
ex™
;

3470 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3471 
	`SLSI_NET_INFO
(
dev
, "fc:%d,†’:%d\n", 
mgmt
->
äame_cÚŒŞ
, 
Ën
);

3472 ià(!(
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
))) {

3473 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Mgmt Frame Tx: iface_num = %d, channel = %d, wait = %d,‚oAck = %d,"

3474 "offchªÃÈğ%d, mgmt->äame_cÚŒŞ = %d, vif_ty³ = %d\n", 
ndev_vif
->
iâum
, 
chª
->
hw_v®ue
,

3475 
wa™
, 
dÚt_wa™_fÜ_ack
, 
offchª
, 
mgmt
->
äame_cÚŒŞ
, 
ndev_vif
->
vif_ty³
);

3477 ià(!
ndev_vif
->
aùiv©ed
) {

3478 
	`SLSI_NET_ERR
(
dev
, "Drop Auth Frame: VIF‚ot‡ctivated\n");

3479 
r
 = -
EINVAL
;

3480 
ex™
;

3482 
	`SLSI_INFO
(
sdev
, "Send Auth Frame\n");

3485 ià(!(
	`›“80211_is_mgmt
(
mgmt
->
äame_cÚŒŞ
))) {

3486 
	`SLSI_NET_ERR
(
dev
, "Drop Tx frame: Not‡ Management frame\n");

3487 
r
 = -
EINVAL
;

3488 
ex™
;

3490 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è|| (ndev_vif->
iáy³
 =ğ
NL80211_IFTYPE_AP
 && (
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
)))) {

3491 
r
 = 
	`¦si_wÏn_mgmt_tx
(
	`SDEV_FROM_WIPHY
(
why
), 
dev
, 
chª
, 
wa™
, 
buf
, 
Ën
, 
dÚt_wa™_fÜ_ack
, 
cook›
);

3492 
ex™
;

3498 ià(
	`›“80211_is_´obe_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

3500 ià(!
dÚt_wa™_fÜ_ack
) {

3501 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3502 
	`cfg80211_mgmt_tx_¡©us
(
wdev
, *
cook›
, 
buf
, 
Ën
, 
Œue
, 
GFP_KERNEL
);

3504 
ex™
;

3507 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

3508 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3510 
	`¦si_abÜt_¡a_sÿn
(
sdev
);

3511 ià(
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
))

3512 
r
 = 
	`¦si_p2p_group_mgmt_tx
(
mgmt
, 
why
, 
dev
, 
chª
, 
wa™
, 
buf
, 
Ën
, 
dÚt_wa™_fÜ_ack
, 
cook›
);

3514 
r
 = 
	`¦si_p2p_mgmt_tx
(
mgmt
, 
why
, 
dev
, 
ndev_vif
, 
chª
, 
wa™
, 
buf
, 
Ën
, 
dÚt_wa™_fÜ_ack
, 
cook›
);

3515 } ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
))

3516 ià(
ndev_vif
->
chª
 && chª->
hw_v®ue
 ==‚dev_vif->chan->hw_value) {

3517 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3518 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3520 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0);

3521 ià(
r
) {

3522 
	`SLSI_NET_ERR
(
dev
, "FaedØ£nd‡ùiÚ f¿me,„ = %d\n", 
r
);

3523 
ex™
;

3525 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3526 
r
 = 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

3528 
ex™
:

3529 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3530 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

3531  
r
;

3532 
	}
}

3535 
u8
 
	$¦si_g‘_ecw
(
cw
)

3537 
ecw
 = 0;

3539 
cw
 = cw + 1;

3541 
cw
 = cw >> 1;

3542 
ecw
++;

3543 } 
cw
);

3544  
ecw
 - 1;

3545 
	}
}

3547 
	$¦si_£t_txq_·¿ms
(
why
 *why, 
Ãt_deviû
 *
ndev
,

3548 
›“80211_txq_·¿ms
 *
·¿ms
)

3550 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3551 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
ndev
);

3552 
¦si_wmm_·¿m‘”_–em’t
 *
wmm_›
 = &
ndev_vif
->
­
.wmm_ie;

3553 
r
 = 0;

3554 
ac
 = 
·¿ms
->ac;

3561 
u8
 
ac_šdex_m­
[4] = { 
AC_VO
, 
AC_VI
, 
AC_BE
, 
AC_BK
 };

3562 
ac_»m­³d
 = 
ac_šdex_m­
[
ac
];

3564 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3565 
	`SLSI_NET_DBG2
(
ndev
, 
SLSI_CFG80211
, "‡c= %x,‡c_remapped = %d‡ifs = %d, cmin=%x cmax = %x,xop = %x,"

3566 "vif_šdex = %d vif_ty³ = %d", 
ac
, 
ac_»m­³d
, 
·¿ms
->
aifs
,…¬ams->
cwmš
,…¬ams->
cwmax
,

3567 
·¿ms
->
txİ
, 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
);

3569 ià(
ndev_vif
->
aùiv©ed
) {

3570 
wmm_›
->
ac
[
ac_»m­³d
].
aci_aif¢
 = (ac_»m­³d << 5è| (
·¿ms
->
aifs
 & 0x0f);

3571 
wmm_›
->
ac
[
ac_»m­³d
].
ecw
 = ((
	`¦si_g‘_ecw
(
·¿ms
->
cwmax
)è<< 4è| ((¦si_g‘_ecwÕ¬ams->
cwmš
)) & 0x0f);

3572 
wmm_›
->
ac
[
ac_»m­³d
].
txİ_lim™
 = 
	`ıu_to_Ë16
(
·¿ms
->
txİ
);

3573 ià(
ac
 == 3) {

3574 
wmm_›
->
eid
 = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

3575 
wmm_›
->
Ën
 = 24;

3576 
wmm_›
->
oui
[0] = 0x00;

3577 
wmm_›
->
oui
[1] = 0x50;

3578 
wmm_›
->
oui
[2] = 0xf2;

3579 
wmm_›
->
oui_ty³
 = 
WLAN_OUI_TYPE_MICROSOFT_WMM
;

3580 
wmm_›
->
oui_subty³
 = 1;

3581 
wmm_›
->
v”siÚ
 = 1;

3582 
wmm_›
->
qos_šfo
 = 0;

3583 
wmm_›
->
»£rved
 = 0;

3584 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
ndev
, 
FAPI_PURPOSE_LOCAL
, (cÚ¡ 
u8
 *)
wmm_›
, (
¦si_wmm_·¿m‘”_–em’t
));

3585 ià(
r
)

3586 
	`SLSI_NET_ERR
(
ndev
, "E¼Ü s’dšg TX QueuP¬am‘” fÜ APƒ¼Ü = %d", 
r
);

3589 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3590  
r
;

3591 
	}
}

3593 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3594 
	$¦si_synchrÚi£d_»¥Ú£
(
why
 *why, 
Ãt_deviû
 *
dev
,

3595 
cfg80211_ex‹º®_auth_·¿ms
 *
·¿ms
)

3597 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3598 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3599 
r
;

3601 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3602 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3603 ià(
ndev_vif
->
¡a
.
w·3_§e_»cÚÃùiÚ
 && !
	`SLSI_ETHER_EQUAL
(
·¿ms
->
bssid
,‚dev_vif->sta.bssid)) {

3604 
	`SLSI_NET_ERR
(
dev
, "Drİšg synchrÚi£d_»¥ fÜ bssid:%pM\n", 
·¿ms
->
bssid
);

3605 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3606 
ndev_vif
->
¡a
.
w·3_§e_»cÚÃùiÚ
 = 
çl£
;

3610 
r
 = 
	`¦si_mlme_synchrÚi£d_»¥Ú£
(
sdev
, 
dev
, 
·¿ms
);

3611 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3612  
r
;

3613 
	}
}

3616 
	$¦si_upd©e_á_›s
(
why
 *why, 
Ãt_deviû
 *
dev
, 
cfg80211_upd©e_á_›s_·¿ms
 *
á›
)

3618 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3619 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3620 
r
 = 0;

3622 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3624 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3625 cÚ¡ 
u8
 *
keo_›_pos
 = 
NULL
;

3626 
u8
 *
›_buf
 = 
NULL
;

3627 
›_Ën
 = 0;

3628 
›_buf_Ën
 = 0;

3630 
keo_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_SAMSUNG
, 
WLAN_OUI_TYPE_SAMSUNG_KEO
,

3631 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,

3632 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
);

3633 ià(
keo_›_pos
) {

3634 
›_buf_Ën
 = 
á›
->
›_Ën
 +

3635 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 -

3636 (
keo_›_pos
 - 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
);

3637 
›_buf
 = 
	`km®loc
(
›_buf_Ën
, 
GFP_KERNEL
);

3638 ià(!
›_buf
) {

3639 
	`SLSI_NET_ERR
(
dev
, "kmalloc failed\n");

3640 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3641  -
ENOMEM
;

3643 
›_Ën
 = 
á›
->ie_len;

3644 ià(
›_buf_Ën
 < 
›_Ën
) {

3645 
	`SLSI_NET_ERR
(
dev
, "ft_ie buffer overflow!!\n");

3646 
	`kä“
(
›_buf
);

3647 
›_buf
 = 
NULL
;

3648 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3649  -
EINVAL
;

3651 
	`memıy
(
›_buf
, 
á›
->
›
, 
›_Ën
);

3652 ià((
›_buf_Ën
 - 
›_Ën
è>ğ(()
keo_›_pos
[1] + 2)) {

3653 
	`memıy
(&
›_buf
[
›_Ën
], 
keo_›_pos
, (()keo_ie_pos[1] + 2));

3654 
›_Ën
 +ğ(
keo_›_pos
[1] + 2);

3655 
keo_›_pos
 += (keo_ie_pos[1] + 2);

3657 
	`SLSI_NET_ERR
(
dev
, "ie_buf buffer overflow!!\n");

3658 
	`kä“
(
›_buf
);

3659 
›_buf
 = 
NULL
;

3660 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3661  -
EINVAL
;

3663 (
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 -

3664 (
keo_›_pos
 - 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
)) > 2) {

3665 
keo_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_SAMSUNG
, 
WLAN_OUI_TYPE_SAMSUNG_KEO
,

3666 
keo_›_pos
,

3667 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 -

3668 (
keo_›_pos
 - 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
));

3669 ià(!
keo_›_pos
)

3671 ià((
›_buf_Ën
 - 
›_Ën
è>ğ(()
keo_›_pos
[1] + 2)) {

3672 
	`memıy
(&
›_buf
[
›_Ën
], 
keo_›_pos
, (keo_ie_pos[1] + 2));

3673 
›_Ën
 +ğ(
keo_›_pos
[1] + 2);

3674 
keo_›_pos
 += (keo_ie_pos[1] + 2);

3676 
	`SLSI_NET_ERR
(
dev
, "ie_buf buffer overflow!\n");

3677 
	`kä“
(
›_buf
);

3678 
›_buf
 = 
NULL
;

3679 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3680  -
EINVAL
;

3683 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
›_buf
, 
›_Ën
);

3685 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
á›
->
›
, ft›->
›_Ën
);

3687 
	`kä“
(
›_buf
);

3688 
›_buf
 = 
NULL
;

3691 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3692  
r
;

3693 
	}
}

3695 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


3696 
	$¦si_£t_mac_aş_³r_mac
(
why
 *why, 
Ãt_deviû
 *
dev
,

3697 cÚ¡ 
cfg80211_aş_d©a
 *
·¿ms
)

3699 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3700 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3701 
r
 = 0;

3702 
i
 = 0;

3703 
m®loc_Ën
 = 0;

3704 
cfg80211_aş_d©a
 *
§ved_aş_d©a
 = 
NULL
;

3705 
Ï¡_šdex
 = 0;

3706 
mac_add»ss
 
z”o_addr
 = {0};

3707 
boŞ
 
found_æag
 = 
çl£
;

3709 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

3710 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_ACL.request\n");

3711  -
EOPNOTSUPP
;

3713 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3714 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
) {

3715 
	`SLSI_NET_ERR
(
dev
, "Inv®id viàty³: %d\n", 
ndev_vif
->
vif_ty³
);

3716 
r
 = -
EINVAL
;

3717 
ex™
;

3719 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "ACL:: PŞicy: %d Numb” oà¡©iÚs: %d\n", 
·¿ms
->
aş_pŞicy
,…¬ams->
n_aş_’Œ›s
);

3721 ià(
·¿ms
->
n_aş_’Œ›s
 != 1) {

3722 
	`SLSI_NET_ERR
(
dev
, "n_acl_entries != 1, No‡ctionaken\n");

3723 
ex™
;

3726 
§ved_aş_d©a
 = 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
;

3727 ià(!
§ved_aş_d©a
) {

3728 ià(
·¿ms
->
aş_pŞicy
 =ğ
NL80211_ACL_POLICY_DENY_UNLESS_LISTED
) {

3729 
	`SLSI_NET_ERR
(
dev
, "Deletion„equested onƒmpty†ist\n");

3730 
r
 = -
EINVAL
;

3731 
ex™
;

3733 
m®loc_Ën
 = (
cfg80211_aş_d©a
è+ (
mac_add»ss
è* 
SLSI_ACL_MAX_BSSID_COUNT
;

3734 
§ved_aş_d©a
 = 
	`km®loc
(
m®loc_Ën
, 
GFP_KERNEL
);

3735 ià(!
§ved_aş_d©a
) {

3736 
	`SLSI_ERR
(
sdev
, "Memory Allocation failure for ACL List");

3737 
r
 = -
ENOMEM
;

3738 
ex™
;

3740 
	`mem£t
(
§ved_aş_d©a
, 0, 
m®loc_Ën
);

3741 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
§ved_aş_d©a
;

3744 
Ï¡_šdex
 = 
§ved_aş_d©a
->
n_aş_’Œ›s
;

3745 ià(
·¿ms
->
aş_pŞicy
 =ğ
NL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
) {

3746 ià(
	`SLSI_ETHER_EQUAL
(
·¿ms
->
mac_addrs
[0].
addr
, 
z”o_addr
.addr)) {

3747 
	`SLSI_NET_ERR
(
dev
, "Addition of‡ddr 00:00:00:00:00:00 in blacklist\n");

3748 
r
 = -
EINVAL
;

3749 
ex™
;

3751 
i
 = 0 ; i < 
Ï¡_šdex
; i++) {

3752 ià(
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
·¿ms
->mac_addrs[0].addr)) {

3753 
	`SLSI_NET_INFO
(
dev
, "Mac‡ddr‡lready…resent in blacklist\n");

3754 
r
 = 0;

3755 
ex™
;

3758 
i
 = 0 ; i < 
Ï¡_šdex
 + 1 && i < 
SLSI_ACL_MAX_BSSID_COUNT
; i++) {

3759 ià(
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
z”o_addr
.addr)) {

3760 
	`SLSI_ETHER_COPY
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
·¿ms
->mac_addrs[0].addr);

3761 ià(
i
 =ğ
Ï¡_šdex
)

3762 
Ï¡_šdex
 = 
i
 + 1;

3766 ià(
i
 =ğ
SLSI_ACL_MAX_BSSID_COUNT
) {

3767 
	`SLSI_NET_ERR
(
dev
, "Blacklist is full\n");

3768 
r
 = -
EINVAL
;

3769 
ex™
;

3771 } ià(
·¿ms
->
aş_pŞicy
 =ğ
NL80211_ACL_POLICY_DENY_UNLESS_LISTED
) {

3772 
found_æag
 = 
çl£
;

3773 
i
 = 0 ; i < 
Ï¡_šdex
; i++) {

3774 ià(
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
·¿ms
->mac_addrs[0].addr)) {

3775 
	`SLSI_ETHER_COPY
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
z”o_addr
.addr);

3776 
found_æag
 = 
Œue
;

3777 ià(
i
 =ğ
Ï¡_šdex
 - 1) {

3778 
i
 >ğ0 && 
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[i].
addr
, 
z”o_addr
.addr))

3779 
i
--;

3780 
Ï¡_šdex
 = 
i
 + 1;

3785 ià(!
found_æag
) {

3786 
r
 = -
EINVAL
;

3787 
	`SLSI_NET_ERR
(
dev
, "Deletion„equested for‡ddr‚ot…resent in blacklist");

3788 
ex™
;

3791 
§ved_aş_d©a
->
n_aş_’Œ›s
 = 
Ï¡_šdex
;

3792 
r
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 
ndev_vif
->
iâum
, 
§ved_aş_d©a
->
aş_pŞicy
, saved_aş_d©a->
n_aş_’Œ›s
, saved_aş_d©a->
mac_addrs
);

3793 
ex™
:

3794 ià(!
Ï¡_šdex
) {

3795 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
NULL
;

3796 
	`kä“
(
§ved_aş_d©a
);

3798 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3799  
r
;

3800 
	}
}

3803 
	$¦si_£t_mac_aş
(
why
 *why, 
Ãt_deviû
 *
dev
,

3804 cÚ¡ 
cfg80211_aş_d©a
 *
·¿ms
)

3806 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3807 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3808 
r
 = 0;

3810 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

3811 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_ACL.request\n");

3812  -
EOPNOTSUPP
;

3814 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3815 ià(
FAPI_VIFTYPE_AP
 !ğ
ndev_vif
->
vif_ty³
) {

3816 
	`SLSI_NET_ERR
(
dev
, "Inv®id viàty³: %d\n", 
ndev_vif
->
vif_ty³
);

3817 
r
 = -
EINVAL
;

3818 
ex™
;

3820 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "ACL:: PŞicy: %d Numb” oà¡©iÚs: %d\n", 
·¿ms
->
aş_pŞicy
,…¬ams->
n_aş_’Œ›s
);

3821 
r
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 
ndev_vif
->
iâum
, 
·¿ms
->
aş_pŞicy
,…¬ams->
n_aş_’Œ›s
, (
mac_add»ss
 *í¬ams->
mac_addrs
);

3822 ià(
r
 != 0)

3823 
	`SLSI_NET_ERR
(
dev
, "mlme_set_acl_req„eturned with CFM failure\n");

3824 
ex™
:

3825 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3826  
r
;

3827 
	}
}

3829 
cfg80211_İs
 
	g¦si_İs
 = {

3830 .
add_vœtu®_štf
 = 
¦si_add_vœtu®_štf
,

3831 .
	gd–_vœtu®_štf
 = 
¦si_d–_vœtu®_štf
,

3832 .
	gchªge_vœtu®_štf
 = 
¦si_chªge_vœtu®_štf
,

3834 .
	gsÿn
 = 
¦si_sÿn
,

3835 .
	gabÜt_sÿn
 = 
¦si_abÜt_sÿn
,

3836 .
	gcÚÃù
 = 
¦si_cÚÃù
,

3837 .
	gdiscÚÃù
 = 
¦si_discÚÃù
,

3839 .
	gadd_key
 = 
¦si_add_key
,

3840 .
	gd–_key
 = 
¦si_d–_key
,

3841 .
	gg‘_key
 = 
¦si_g‘_key
,

3842 .
	g£t_deçuÉ_key
 = 
¦si_£t_deçuÉ_key
,

3843 .
	g£t_deçuÉ_mgmt_key
 = 
¦si_cÚfig_deçuÉ_mgmt_key
,

3845 .
	g£t_why_·¿ms
 = 
¦si_£t_why_·¿ms
,

3847 .
	gd–_¡©iÚ
 = 
¦si_d–_¡©iÚ
,

3848 .
	gg‘_¡©iÚ
 = 
¦si_g‘_¡©iÚ
,

3849 .
	g£t_tx_pow”
 = 
¦si_£t_tx_pow”
,

3850 .
	gg‘_tx_pow”
 = 
¦si_g‘_tx_pow”
,

3851 .
	g£t_pow”_mgmt
 = 
¦si_£t_pow”_mgmt
,

3852 .
	gg‘_chªÃl
 = 
¦si_g‘_chªÃl
,

3854 .
	gsu¥’d
 = 
¦si_su¥’d
,

3855 .
	g»sume
 = 
¦si_»sume
,

3857 .
	g£t_pmk§
 = 
¦si_£t_pmk§
,

3858 .
	gd–_pmk§
 = 
¦si_d–_pmk§
,

3859 .
	gæush_pmk§
 = 
¦si_æush_pmk§
,

3861 .
	g»maš_Ú_chªÃl
 = 
¦si_»maš_Ú_chªÃl
,

3862 .
	gÿnûl_»maš_Ú_chªÃl
 = 
¦si_ÿnûl_»maš_Ú_chªÃl
,

3864 .
	gchªge_bss
 = 
¦si_chªge_bss
,

3866 .
	g¡¬t_­
 = 
¦si_¡¬t_­
,

3867 .
	gchªge_b—cÚ
 = 
¦si_chªge_b—cÚ
,

3868 .
	g¡İ_­
 = 
¦si_¡İ_­
,

3870 .
	gsched_sÿn_¡¬t
 = 
¦si_sched_sÿn_¡¬t
,

3871 .
	gsched_sÿn_¡İ
 = 
¦si_sched_sÿn_¡İ
,

3873 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 7, 0))

3874 .
	gmgmt_äame_»gi¡”
 = 
¦si_mgmt_äame_»gi¡”
,

3876 .
	gmgmt_tx
 = 
¦si_mgmt_tx
,

3877 .
	gmgmt_tx_ÿnûl_wa™
 = 
¦si_mgmt_tx_ÿnûl_wa™
,

3878 .
	g£t_txq_·¿ms
 = 
¦si_£t_txq_·¿ms
,

3879 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3880 .
	gex‹º®_auth
 = 
¦si_synchrÚi£d_»¥Ú£
,

3882 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


3883 .
	g£t_mac_aş
 = 
¦si_£t_mac_aş_³r_mac
,

3885 .
	g£t_mac_aş
 = 
¦si_£t_mac_aş
,

3887 .
	gupd©e_á_›s
 = 
¦si_upd©e_á_›s
,

3888 .
	gtdls_İ”
 = 
¦si_tdls_İ”
,

3889 .
	g£t_mÚ™Ü_chªÃl
 = 
¦si_£t_mÚ™Ü_chªÃl
,

3890 .
	g£t_qos_m­
 = 
¦si_£t_qos_m­
,

3891 .
	gchªÃl_sw™ch
 = 
¦si_chªÃl_sw™ch


3894 
	#RATE_LEGACY
(
_¿‹
, 
_hw_v®ue
, 
_æags
) { \

3895 .
b™¿‹
 = (
_¿‹
), \

3896 .
hw_v®ue
 = (
_hw_v®ue
), \

3897 .
æags
 = (
_æags
), \

3898 }

	)

3900 
	#CHAN2G
(
_äeq
, 
_idx
) { \

3901 .
bªd
 = 
NL80211_BAND_2GHZ
, \

3902 .
ûÁ”_äeq
 = (
_äeq
), \

3903 .
hw_v®ue
 = (
_idx
), \

3904 .
max_pow”
 = 17, \

3905 }

	)

3907 
	#CHAN5G
(
_äeq
, 
_idx
) { \

3908 .
bªd
 = 
NL80211_BAND_5GHZ
, \

3909 .
ûÁ”_äeq
 = (
_äeq
), \

3910 .
hw_v®ue
 = (
_idx
), \

3911 .
max_pow”
 = 17, \

3912 }

	)

3914 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


3915 
	#CHAN6G
(
_äeq
, 
_idx
) { \

3916 .
bªd
 = 
NL80211_BAND_6GHZ
, \

3917 .
ûÁ”_äeq
 = (
_äeq
), \

3918 .
hw_v®ue
 = (
_idx
), \

3919 .
max_pow”
 = 17, \

3920 }

	)

3923 
›“80211_chªÃl
 
	g¦si_2ghz_chªÃls
[] = {

3924 
CHAN2G
(2412, 1),

3925 
CHAN2G
(2417, 2),

3926 
CHAN2G
(2422, 3),

3927 
CHAN2G
(2427, 4),

3928 
CHAN2G
(2432, 5),

3929 
CHAN2G
(2437, 6),

3930 
CHAN2G
(2442, 7),

3931 
CHAN2G
(2447, 8),

3932 
CHAN2G
(2452, 9),

3933 
CHAN2G
(2457, 10),

3934 
CHAN2G
(2462, 11),

3935 
CHAN2G
(2467, 12),

3936 
CHAN2G
(2472, 13),

3937 
CHAN2G
(2484, 14),

3940 
›“80211_¿‹
 
	g¦si_11g_¿‹s
[] = {

3941 
RATE_LEGACY
(10, 1, 0),

3942 
RATE_LEGACY
(20, 2, 
IEEE80211_RATE_SHORT_PREAMBLE
),

3943 
RATE_LEGACY
(55, 3, 
IEEE80211_RATE_SHORT_PREAMBLE
),

3944 
RATE_LEGACY
(110, 6, 
IEEE80211_RATE_SHORT_PREAMBLE
),

3945 
RATE_LEGACY
(60, 4, 0),

3946 
RATE_LEGACY
(90, 5, 0),

3947 
RATE_LEGACY
(120, 7, 0),

3948 
RATE_LEGACY
(180, 8, 0),

3949 
RATE_LEGACY
(240, 9, 0),

3950 
RATE_LEGACY
(360, 10, 0),

3951 
RATE_LEGACY
(480, 11, 0),

3952 
RATE_LEGACY
(540, 12, 0),

3955 
›“80211_chªÃl
 
	g¦si_5ghz_chªÃls
[] = {

3957 
CHAN5G
(5180, 36),

3958 
CHAN5G
(5200, 40),

3959 
CHAN5G
(5220, 44),

3960 
CHAN5G
(5240, 48),

3962 
CHAN5G
(5260, 52),

3963 
CHAN5G
(5280, 56),

3964 
CHAN5G
(5300, 60),

3965 
CHAN5G
(5320, 64),

3967 
CHAN5G
(5500, 100),

3968 
CHAN5G
(5520, 104),

3969 
CHAN5G
(5540, 108),

3970 
CHAN5G
(5560, 112),

3971 
CHAN5G
(5580, 116),

3972 
CHAN5G
(5600, 120),

3973 
CHAN5G
(5620, 124),

3974 
CHAN5G
(5640, 128),

3975 
CHAN5G
(5660, 132),

3976 
CHAN5G
(5680, 136),

3977 
CHAN5G
(5700, 140),

3978 
CHAN5G
(5720, 144),

3980 
CHAN5G
(5745, 149),

3981 
CHAN5G
(5765, 153),

3982 
CHAN5G
(5785, 157),

3983 
CHAN5G
(5805, 161),

3984 
CHAN5G
(5825, 165),

3986 
CHAN5G
(5845, 169),

3987 
CHAN5G
(5865, 173),

3988 
CHAN5G
(5885, 177),

3991 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


3992 
›“80211_chªÃl
 
	g¦si_6ghz_chªÃls
[] = {

3994 
CHAN6G
(5955, 1),

3995 
CHAN6G
(5975, 5),

3996 
CHAN6G
(5995, 9),

3997 
CHAN6G
(6015, 13),

3998 
CHAN6G
(6035, 17),

3999 
CHAN6G
(6055, 21),

4000 
CHAN6G
(6075, 25),

4001 
CHAN6G
(6095, 29),

4002 
CHAN6G
(6115, 33),

4003 
CHAN6G
(6135, 37),

4004 
CHAN6G
(6155, 41),

4005 
CHAN6G
(6175, 45),

4006 
CHAN6G
(6195, 49),

4007 
CHAN6G
(6215, 53),

4008 
CHAN6G
(6235, 57),

4009 
CHAN6G
(6255, 61),

4010 
CHAN6G
(6275, 65),

4011 
CHAN6G
(6295, 69),

4012 
CHAN6G
(6315, 73),

4013 
CHAN6G
(6335, 77),

4014 
CHAN6G
(6355, 81),

4015 
CHAN6G
(6375, 85),

4016 
CHAN6G
(6395, 89),

4017 
CHAN6G
(6415, 93),

4019 
CHAN6G
(6435, 97),

4020 
CHAN6G
(6455, 101),

4021 
CHAN6G
(6475, 105),

4022 
CHAN6G
(6495, 109),

4023 
CHAN6G
(6515, 113),

4025 
CHAN6G
(6535, 117),

4026 
CHAN6G
(6555, 121),

4027 
CHAN6G
(6575, 125),

4028 
CHAN6G
(6595, 129),

4029 
CHAN6G
(6615, 133),

4030 
CHAN6G
(6635, 137),

4031 
CHAN6G
(6655, 141),

4032 
CHAN6G
(6675, 145),

4033 
CHAN6G
(6695, 149),

4034 
CHAN6G
(6715, 153),

4035 
CHAN6G
(6735, 157),

4036 
CHAN6G
(6755, 161),

4037 
CHAN6G
(6775, 165),

4038 
CHAN6G
(6795, 169),

4039 
CHAN6G
(6815, 173),

4040 
CHAN6G
(6835, 177),

4041 
CHAN6G
(6855, 181),

4043 
CHAN6G
(6875, 185),

4044 
CHAN6G
(6895, 189),

4045 
CHAN6G
(6915, 193),

4046 
CHAN6G
(6935, 197),

4047 
CHAN6G
(6955, 201),

4048 
CHAN6G
(6975, 205),

4049 
CHAN6G
(6995, 209),

4050 
CHAN6G
(7015, 213),

4051 
CHAN6G
(7035, 217),

4052 
CHAN6G
(7055, 221),

4053 
CHAN6G
(7075, 225),

4054 
CHAN6G
(7095, 229),

4055 
CHAN6G
(7115, 233),

4061 
›“80211_¿‹
 
	gwifi_11a_¿‹s
[] = {

4062 
RATE_LEGACY
(60, 4, 0),

4063 
RATE_LEGACY
(90, 5, 0),

4064 
RATE_LEGACY
(120, 7, 0),

4065 
RATE_LEGACY
(180, 8, 0),

4066 
RATE_LEGACY
(240, 9, 0),

4067 
RATE_LEGACY
(360, 10, 0),

4068 
RATE_LEGACY
(480, 11, 0),

4069 
RATE_LEGACY
(540, 12, 0),

4072 
›“80211_¡a_ht_ÿp
 
	g¦si_ht_ÿp
 = {

4073 .
ht_suµÜ‹d
 = 
Œue
,

4074 .
	gÿp
 = 
IEEE80211_HT_CAP_SUP_WIDTH_20_40
 |

4075 
IEEE80211_HT_CAP_LDPC_CODING
 |

4076 
IEEE80211_HT_CAP_RX_STBC
 |

4077 
IEEE80211_HT_CAP_GRN_FLD
 |

4078 
IEEE80211_HT_CAP_SGI_20
 |

4079 
IEEE80211_HT_CAP_SGI_40
,

4080 .
	gampdu_çùÜ
 = 
IEEE80211_HT_MAX_AMPDU_64K
,

4081 .
	gampdu_d’s™y
 = 
IEEE80211_HT_MPDU_DENSITY_4
,

4082 .
	gmcs
 = {

4083 .
rx_mask
 = { 0xff, 0, },

4084 .
	grx_highe¡
 = 
ıu_to_Ë16
(0),

4085 .
	gtx_·¿ms
 = 0,

4089 
›“80211_¡a_vht_ÿp
 
	g¦si_vht_ÿp
 = {

4090 .
vht_suµÜ‹d
 = 
Œue
,

4091 .
	gÿp
 = 
IEEE80211_VHT_CAP_MAX_MPDU_LENGTH_7991
 |

4092 
IEEE80211_VHT_CAP_SHORT_GI_80
 |

4093 
IEEE80211_VHT_CAP_RXSTBC_1
 |

4094 
IEEE80211_VHT_CAP_SU_BEAMFORMEE_CAPABLE
 |

4095 (5 << 
IEEE80211_VHT_CAP_MAX_A_MPDU_LENGTH_EXPONENT_SHIFT
),

4096 .
	gvht_mcs
 = {

4097 .
rx_mcs_m­
 = 
ıu_to_Ë16
(0xfffe),

4098 .
	grx_highe¡
 = 
ıu_to_Ë16
(0),

4099 .
	gtx_mcs_m­
 = 
ıu_to_Ë16
(0xfffe),

4100 .
	gtx_highe¡
 = 
ıu_to_Ë16
(0),

4104 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


4105 
›“80211_sbªd_iáy³_d©a
 
	g¦si_¡a_he_ÿp
[] = {

4107 .
ty³s_mask
 = 
BIT
(
NL80211_IFTYPE_STATION
),

4108 .
	ghe_ÿp
 = {

4109 .
has_he
 = 
Œue
,

4110 .
	ghe_ÿp_–em
 = {

4111 .
mac_ÿp_šfo
[0] =

4112 
IEEE80211_HE_MAC_CAP0_HTC_HE
,

4113 .
	gmac_ÿp_šfo
[1] =

4114 
IEEE80211_HE_MAC_CAP1_TF_MAC_PAD_DUR_16US
,

4115 .
	gmac_ÿp_šfo
[3] =

4116 
IEEE80211_HE_MAC_CAP3_OMI_CONTROL
,

4117 .
	gphy_ÿp_šfo
[0] =

4118 
IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_IN_2G
 |

4119 
IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_80MHZ_IN_5G
 |

4120 
IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_RU_MAPPING_IN_2G
,

4121 .
	gphy_ÿp_šfo
[1] =

4122 
IEEE80211_HE_PHY_CAP1_DEVICE_CLASS_A
 |

4123 
IEEE80211_HE_PHY_CAP1_LDPC_CODING_IN_PAYLOAD
 |

4124 
IEEE80211_HE_PHY_CAP1_HE_LTF_AND_GI_FOR_HE_PPDUS_0_8US
,

4125 .
	gphy_ÿp_šfo
[2] =

4126 
IEEE80211_HE_PHY_CAP2_NDP_4x_LTF_AND_3_2US
,

4127 .
	gphy_ÿp_šfo
[6] =

4128 
IEEE80211_HE_PHY_CAP6_PPE_THRESHOLD_PRESENT
,

4129 .
	gphy_ÿp_šfo
[7] =

4130 
IEEE80211_HE_PHY_CAP7_POWER_BOOST_FACTOR_AR
 |

4131 
IEEE80211_HE_PHY_CAP7_MAX_NC_1
,

4132 .
	gphy_ÿp_šfo
[9] =

4133 
IEEE80211_HE_PHY_CAP9_NOMIMAL_PKT_PADDING_16US
 |

4134 
IEEE80211_HE_PHY_CAP9_LONGER_THAN_16_SIGB_OFDM_SYM
 |

4135 
IEEE80211_HE_PHY_CAP9_TX_1024_QAM_LESS_THAN_242_TONE_RU
 |

4136 
IEEE80211_HE_PHY_CAP9_RX_1024_QAM_LESS_THAN_242_TONE_RU
,

4138 .
	ghe_mcs_nss_suµ
 = {

4139 .
rx_mcs_80
 = 
ıu_to_Ë16
(0xfffa),

4140 .
	gtx_mcs_80
 = 
ıu_to_Ë16
(0xfffa),

4142 .
	gµe_th»s
 = { 0x79, 0x1C, 0xC7, 0x71, 0x1C, 0xC7, 0x71 },

4144 .
	ghe_6ghz_ÿ·
 = {

4145 .
ÿ·
 = 0,

4150 #ifdeà
CONFIG_SCSC_WLAN_HE


4151 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(4, 19, 0))

4152 cÚ¡ 
›“80211_sbªd_iáy³_d©a
 
	g¦si_soá­_he_ÿp
[] = {

4154 .
ty³s_mask
 = 
BIT
(
NL80211_IFTYPE_AP
),

4155 .
	ghe_ÿp
 = {

4156 .
has_he
 = 
Œue
,

4157 .
	ghe_ÿp_–em
 = {

4158 .
mac_ÿp_šfo
[0] =

4159 
IEEE80211_HE_MAC_CAP0_HTC_HE
,

4160 .
	gmac_ÿp_šfo
[1] =

4161 
IEEE80211_HE_MAC_CAP1_TF_MAC_PAD_DUR_16US
,

4162 .
	gmac_ÿp_šfo
[3] =

4163 
IEEE80211_HE_MAC_CAP3_OMI_CONTROL
,

4164 .
	gphy_ÿp_šfo
[0] =

4165 
IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_IN_2G
 |

4166 
IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_80MHZ_IN_5G
 |

4167 
IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_RU_MAPPING_IN_2G
,

4168 .
	gphy_ÿp_šfo
[1] =

4169 
IEEE80211_HE_PHY_CAP1_DEVICE_CLASS_A
 |

4170 
IEEE80211_HE_PHY_CAP1_LDPC_CODING_IN_PAYLOAD
 |

4171 
IEEE80211_HE_PHY_CAP1_HE_LTF_AND_GI_FOR_HE_PPDUS_0_8US
,

4172 .
	gphy_ÿp_šfo
[2] =

4173 
IEEE80211_HE_PHY_CAP2_NDP_4x_LTF_AND_3_2US
,

4174 .
	gphy_ÿp_šfo
[6] =

4175 
IEEE80211_HE_PHY_CAP6_PPE_THRESHOLD_PRESENT
,

4176 .
	gphy_ÿp_šfo
[7] =

4177 
IEEE80211_HE_PHY_CAP7_POWER_BOOST_FACTOR_AR
 |

4178 
IEEE80211_HE_PHY_CAP7_MAX_NC_1
,

4179 .
	gphy_ÿp_šfo
[9] =

4180 
IEEE80211_HE_PHY_CAP9_NOMIMAL_PKT_PADDING_16US
 |

4181 
IEEE80211_HE_PHY_CAP9_LONGER_THAN_16_SIGB_OFDM_SYM
 |

4182 
IEEE80211_HE_PHY_CAP9_TX_1024_QAM_LESS_THAN_242_TONE_RU
 |

4183 
IEEE80211_HE_PHY_CAP9_RX_1024_QAM_LESS_THAN_242_TONE_RU
,

4185 .
	ghe_mcs_nss_suµ
 = {

4186 .
rx_mcs_80
 = 
ıu_to_Ë16
(0xfffa),

4187 .
	gtx_mcs_80
 = 
ıu_to_Ë16
(0xfffa),

4189 .
	gµe_th»s
 = { 0x79, 0x1C, 0xC7, 0x71, 0x1C, 0xC7, 0x71 },

4196 
›“80211_suµÜ‹d_bªd
 
	g¦si_bªd_2ghz
 = {

4197 .
chªÃls
 = 
¦si_2ghz_chªÃls
,

4198 .
	gbªd
 = 
NL80211_BAND_2GHZ
,

4199 .
	gn_chªÃls
 = 
ARRAY_SIZE
(
¦si_2ghz_chªÃls
),

4200 .
	gb™¿‹s
 = 
¦si_11g_¿‹s
,

4201 .
	gn_b™¿‹s
 = 
ARRAY_SIZE
(
¦si_11g_¿‹s
),

4204 
›“80211_suµÜ‹d_bªd
 
	g¦si_bªd_5ghz
 = {

4205 .
chªÃls
 = 
¦si_5ghz_chªÃls
,

4206 .
	gbªd
 = 
NL80211_BAND_5GHZ
,

4207 .
	gn_chªÃls
 = 
ARRAY_SIZE
(
¦si_5ghz_chªÃls
),

4208 .
	gb™¿‹s
 = 
wifi_11a_¿‹s
,

4209 .
	gn_b™¿‹s
 = 
ARRAY_SIZE
(
wifi_11a_¿‹s
),

4212 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


4213 
›“80211_suµÜ‹d_bªd
 
	g¦si_bªd_6ghz
 = {

4214 .
chªÃls
 = 
¦si_6ghz_chªÃls
,

4215 .
	gbªd
 = 
NL80211_BAND_6GHZ
,

4216 .
	gn_chªÃls
 = 
ARRAY_SIZE
(
¦si_6ghz_chªÃls
),

4217 .
	gb™¿‹s
 = 
wifi_11a_¿‹s
,

4218 .
	gn_b™¿‹s
 = 
ARRAY_SIZE
(
wifi_11a_¿‹s
),

4219 .
	ght_ÿp
 = {

4220 .
ht_suµÜ‹d
 = 
çl£
,

4222 .
	gvht_ÿp
 = {

4223 .
vht_suµÜ‹d
 = 
çl£
,

4228 cÚ¡ 
u32
 
	g¦si_ch”_su™es
[] = {

4229 
WLAN_CIPHER_SUITE_WEP40
,

4230 
WLAN_CIPHER_SUITE_WEP104
,

4231 
WLAN_CIPHER_SUITE_TKIP
,

4232 
WLAN_CIPHER_SUITE_CCMP
,

4233 
WLAN_CIPHER_SUITE_AES_CMAC
,

4234 
WLAN_CIPHER_SUITE_SMS4
,

4235 
WLAN_CIPHER_SUITE_PMK
,

4236 
WLAN_CIPHER_SUITE_GCMP
,

4237 
WLAN_CIPHER_SUITE_GCMP_256
,

4238 
WLAN_CIPHER_SUITE_CCMP_256
,

4239 
WLAN_CIPHER_SUITE_BIP_GMAC_128
,

4240 
WLAN_CIPHER_SUITE_BIP_GMAC_256


4243 cÚ¡ 
›“80211_txrx_¡y³s


4244 
	g›“80211_deçuÉ_mgmt_¡y³s
[
NUM_NL80211_IFTYPES
] = {

4245 [
NL80211_IFTYPE_AP
] = {

4246 .
tx
 = 0xffff,

4247 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4) |

4248 
BIT
(
IEEE80211_STYPE_AUTH
 >> 4)

4250 [
NL80211_IFTYPE_STATION
] = {

4251 .
tx
 = 0xffff,

4252 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4) |

4253 
BIT
(
IEEE80211_STYPE_PROBE_REQ
 >> 4) |

4254 
BIT
(
IEEE80211_STYPE_AUTH
 >> 4)

4256 [
NL80211_IFTYPE_P2P_GO
] = {

4257 .
tx
 = 0xffff,

4258 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4) |

4259 
BIT
(
IEEE80211_STYPE_PROBE_REQ
 >> 4)

4261 [
NL80211_IFTYPE_P2P_CLIENT
] = {

4262 .
tx
 = 0xffff,

4263 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4)

4268 
›“80211_içû_lim™
 
	giçû_lim™s
[] = {

4269 #ifdeà
CONFIG_SCSC_WLAN_STA_ONLY


4272 .
max
 = 
CONFIG_SCSC_WLAN_MAX_INTERFACES
,

4273 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_STATION
),

4278 .
	gmax
 = 1,

4279 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_AP
),

4286 .
	gmax
 = 
CONFIG_SCSC_WLAN_MAX_INTERFACES
,

4287 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_STATION
),

4290 .
	gmax
 = 1,

4291 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_P2P_CLIENT
è| BIT(
NL80211_IFTYPE_P2P_GO
),

4295 .
	gmax
 = 1,

4296 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_ADHOC
),

4301 
›“80211_»gdomaš
 
	g¦si_»gdomaš
 = {

4302 .
»g_ruËs
 = {

4303 
REG_RULE
(0, 0, 0, 0, 0, 0),

4304 
REG_RULE
(0, 0, 0, 0, 0, 0),

4305 
REG_RULE
(0, 0, 0, 0, 0, 0),

4306 
REG_RULE
(0, 0, 0, 0, 0, 0),

4307 
REG_RULE
(0, 0, 0, 0, 0, 0),

4308 
REG_RULE
(0, 0, 0, 0, 0, 0),

4309 
REG_RULE
(0, 0, 0, 0, 0, 0),

4310 
REG_RULE
(0, 0, 0, 0, 0, 0),

4311 
REG_RULE
(0, 0, 0, 0, 0, 0),

4312 
REG_RULE
(0, 0, 0, 0, 0, 0),

4313 
REG_RULE
(0, 0, 0, 0, 0, 0),

4314 
REG_RULE
(0, 0, 0, 0, 0, 0),

4315 
REG_RULE
(0, 0, 0, 0, 0, 0),

4316 
REG_RULE
(0, 0, 0, 0, 0, 0),

4317 
REG_RULE
(0, 0, 0, 0, 0, 0),

4318 
REG_RULE
(0, 0, 0, 0, 0, 0),

4319 
REG_RULE
(0, 0, 0, 0, 0, 0),

4320 
REG_RULE
(0, 0, 0, 0, 0, 0),

4321 
REG_RULE
(0, 0, 0, 0, 0, 0),

4322 
REG_RULE
(0, 0, 0, 0, 0, 0),

4326 
›“80211_içû_combš©iÚ
 
	giçû_comb
[] = {

4328 .
lim™s
 = 
içû_lim™s
,

4329 .
	gn_lim™s
 = 
ARRAY_SIZE
(
içû_lim™s
),

4330 .
	gnum_difã»Á_chªÃls
 = 2,

4331 .
	gmax_š‹rçûs
 = 
CONFIG_SCSC_WLAN_MAX_INTERFACES
,

4335 #ifdeà
CONFIG_PM


4336 
cfg80211_wowÏn
 
	g¦si_wowÏn_cÚfig
 = {

4337 .
ªy
 = 
Œue
,

4341 
¦si_dev
 *
	$¦si_cfg80211_Ãw
(
deviû
 *
dev
)

4343 
why
 *wiphy;

4344 
¦si_dev
 *
sdev
 = 
NULL
;

4346 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "wiphy_new()\n");

4347 
why
 = 
	`why_Ãw
(&
¦si_İs
, (
¦si_dev
));

4348 ià(!
why
) {

4349 
	`SLSI_ERR_NODEV
("wiphy_new() failed");

4350  
NULL
;

4353 
sdev
 = (
¦si_dev
 *)
why
->
´iv
;

4355 
sdev
->
why
 = wiphy;

4357 
	`£t_why_dev
(
why
, 
dev
);

4360 
why
->
æags
 |ğ
WIPHY_FLAG_NETNS_OK
;

4361 
why
->
æags
 |ğ
WIPHY_FLAG_PS_ON_BY_DEFAULT
;

4362 
why
->
æags
 |ğ
WIPHY_FLAG_CONTROL_PORT_PROTOCOL
;

4363 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

4364 
why
->
æags
 |ğ
WIPHY_FLAG_SUPPORTS_FW_ROAM
;

4366 
why
->
æags
 |ğ
WIPHY_FLAG_HAS_CHANNEL_SWITCH
;

4367 
why
->
max_num_c§_couÁ”s
 = 2;

4369 
why
->
æags
 |ğ
WIPHY_FLAG_HAVE_AP_SME
 |

4370 
WIPHY_FLAG_AP_PROBE_RESP_OFFLOAD
 |

4371 
WIPHY_FLAG_AP_UAPSD
;

4373 
why
->
max_aş_mac_addrs
 = 
SLSI_AP_PEER_CONNECTIONS_MAX
;

4375 
why
->
´ivid
 = 
sdev
;

4377 
why
->
š‹rçû_modes
 =

4378 #ifdeà
CONFIG_SCSC_WLAN_STA_ONLY


4379 
	`BIT
(
NL80211_IFTYPE_STATION
);

4381 
	`BIT
(
NL80211_IFTYPE_P2P_GO
) |

4382 
	`BIT
(
NL80211_IFTYPE_P2P_CLIENT
) |

4383 
	`BIT
(
NL80211_IFTYPE_STATION
) |

4384 
	`BIT
(
NL80211_IFTYPE_AP
) |

4385 
	`BIT
(
NL80211_IFTYPE_MONITOR
) |

4386 
	`BIT
(
NL80211_IFTYPE_ADHOC
);

4388 
¦si_bªd_2ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

4389 
¦si_bªd_5ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

4390 
¦si_bªd_5ghz
.
vht_ÿp
 = 
¦si_vht_ÿp
;

4392 #ifdeà
CONFIG_SCSC_WLAN_HE


4393 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

4394 
¦si_bªd_2ghz
.
iáy³_d©a
 = 
¦si_soá­_he_ÿp
;

4395 
¦si_bªd_2ghz
.
n_iáy³_d©a
 = 
	`ARRAY_SIZE
(
¦si_soá­_he_ÿp
);

4396 
¦si_bªd_5ghz
.
iáy³_d©a
 = 
¦si_soá­_he_ÿp
;

4397 
¦si_bªd_5ghz
.
n_iáy³_d©a
 = 
	`ARRAY_SIZE
(
¦si_soá­_he_ÿp
);

4401 
why
->
sigÇl_ty³
 = 
CFG80211_SIGNAL_TYPE_MBM
;

4403 
why
->
bªds
[
NL80211_BAND_2GHZ
] = &
¦si_bªd_2ghz
;

4404 
why
->
bªds
[
NL80211_BAND_5GHZ
] = &
¦si_bªd_5ghz
;

4406 
	`mem£t
(&
sdev
->
deviû_cÚfig
, 0, (
¦si_dev_cÚfig
));

4407 
sdev
->
deviû_cÚfig
.
bªd_5G
 = &
¦si_bªd_5ghz
;

4408 
sdev
->
deviû_cÚfig
.
bªd_2G
 = &
¦si_bªd_2ghz
;

4409 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
 = &
¦si_»gdomaš
;

4411 
why
->
æags
 |ğ
WIPHY_FLAG_HAS_REMAIN_ON_CHANNEL
;

4412 
why
->
max_»maš_Ú_chªÃl_du¿tiÚ
 = 5000;

4414 
why
->
ch”_su™es
 = 
¦si_ch”_su™es
;

4415 
why
->
n_ch”_su™es
 = 
	`ARRAY_SIZE
(
¦si_ch”_su™es
);

4417 
why
->
ex‹nded_ÿ·b™›s
 = 
¦si_ex‹nded_ÿp
;

4418 
why
->
ex‹nded_ÿ·b™›s_mask
 = 
¦si_ex‹nded_ÿp_mask
;

4419 
why
->
ex‹nded_ÿ·b™›s_Ën
 = 
	`ARRAY_SIZE
(
¦si_ex‹nded_ÿp
);

4421 
why
->
mgmt_¡y³s
 = 
›“80211_deçuÉ_mgmt_¡y³s
;

4424 
why
->
n_içû_combš©iÚs
 = 
	`ARRAY_SIZE
(
içû_comb
);

4425 
why
->
içû_combš©iÚs
 = 
içû_comb
;

4428 
why
->
max_sÿn_ssids
 = 10;

4429 
why
->
max_sÿn_›_Ën
 = 2048;

4431 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 11, 0))

4433 
why
->
æags
 |ğ
WIPHY_FLAG_SUPPORTS_SCHED_SCAN
;

4435 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

4437 
why
->
max_sched_sÿn_»qs
 = 1;

4439 
why
->
max_sched_sÿn_¶ªs
 = 1;

4440 #ifdeà
CONFIG_SCSC_WLAN_EXPONENTIAL_SCHED_SCAN


4441 
why
->
max_sched_sÿn_¶ªs
 = 2;

4442 
why
->
max_sched_sÿn_¶ª_š‹rv®
 = 60;

4443 
why
->
max_sched_sÿn_¶ª_™”©iÚs
 = 3;

4445 
	`why_ext_ã©u»_£t
(
why
, 
NL80211_EXT_FEATURE_SCHED_SCAN_RELATIVE_RSSI
);

4448 
	`why_ext_ã©u»_£t
(
why
, 
NL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA
);

4451 #ià!
	`defšed
(
__x86_64__
)

4452 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

4454 
	`why_ext_ã©u»_£t
(
why
, 
NL80211_EXT_FEATURE_BEACON_PROTECTION
);

4455 #ià
	`defšed
(
CONFIG_SCSC_WLAN_OCV_SUPPORT
è|| (
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 10, 0))

4457 
	`why_ext_ã©u»_£t
(
why
, 
NL80211_EXT_FEATURE_OPERATING_CHANNEL_VALIDATION
);

4463 
why
->
max_sched_sÿn_ssids
 = 16;

4466 
why
->
max_m©ch_£ts
 = 16;

4468 
why
->
max_sched_sÿn_›_Ën
 = 2048;

4470 #ifdeà
CONFIG_PM


4471 
why
->
wowÏn
 = 
NULL
;

4472 
why
->
wowÏn_cÚfig
 = &
¦si_wowÏn_cÚfig
;

4475 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

4476 
why
->
»guÏtÜy_æags
 |ğ(
REGULATORY_STRICT_REG
 |

4477 
REGULATORY_CUSTOM_REG
 |

4478 
REGULATORY_DISABLE_BEACON_HINTS
 |

4479 
REGULATORY_COUNTRY_IE_IGNORE
);

4481 
why
->
»guÏtÜy_æags
 |ğ(
REGULATORY_STRICT_REG
 |

4482 
REGULATORY_CUSTOM_REG
 |

4483 
REGULATORY_DISABLE_BEACON_HINTS
);

4485 #iâdeà
CONFIG_SCSC_WLAN_STA_ONLY


4487 
why
->
æags
 |ğ
WIPHY_FLAG_OFFCHAN_TX
;

4490 
why
->
´obe_»¥_ofæßd
 |=

4491 
NL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS
 |

4492 
NL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS2
 |

4493 
NL80211_PROBE_RESP_OFFLOAD_SUPPORT_P2P
;

4496 
why
->
æags
 |ğ
WIPHY_FLAG_SUPPORTS_TDLS
;

4499 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


4500 
why
->
ã©u»s
 |ğ
NL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
;

4501 
why
->
ã©u»s
 |ğ
NL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
;

4503 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


4504 
why
->
ã©u»s
 |ğ
NL80211_FEATURE_SAE
;

4506 #ifdeà
CONFIG_SCSC_WLAN_HE


4508 
why
->
suµÜt_mbssid
 = 1;

4509 
why
->
suµÜt_Úly_he_mbssid
 = 1;

4511  
sdev
;

4512 
	}
}

4514 
	$¦si_cfg80211_»gi¡”
(
¦si_dev
 *
sdev
)

4516 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "wiphy_register()\n");

4517  
	`why_»gi¡”
(
sdev
->
why
);

4518 
	}
}

4520 
	$¦si_cfg80211_uÄegi¡”
(
¦si_dev
 *
sdev
)

4522 #ifdeà
CONFIG_PM


4523 
sdev
->
why
->
wowÏn
 = 
NULL
;

4524 
sdev
->
why
->
wowÏn_cÚfig
 = 
NULL
;

4526 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "wiphy_unregister()\n");

4527 
	`why_uÄegi¡”
(
sdev
->
why
);

4528 
	}
}

4530 
	$¦si_cfg80211_ä“
(
¦si_dev
 *
sdev
)

4532 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "wiphy_free()\n");

4533 
	`why_ä“
(
sdev
->
why
);

4534 
	}
}

4536 
boŞ
 
	$¦si_upd©e_why_6ghz
(
¦si_dev
 *
sdev
)

4538 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


4539 
boŞ
 
¥l™_sÿn_’abËd
 = 
çl£
;

4540 
u16
 
he_6ghz_ÿ·
 = 0;

4541 
u32
 
‹mp
, 
i
;

4543 ià(!
sdev
->
bªd_6g_suµÜ‹d
) {

4544 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = 
NULL
;

4545 
sdev
->
deviû_cÚfig
.
bªd_6G
 = 
NULL
;

4546 
sdev
->
why
->
æags
 &ğ~
WIPHY_FLAG_SPLIT_SCAN_6GHZ
;

4547  
çl£
;

4550 
he_6ghz_ÿ·
 |ğ
	`u16_’code_b™s
(
¦si_ht_ÿp
.
ampdu_d’s™y
, 
IEEE80211_HE_6GHZ_CAP_MIN_MPDU_START
);

4551 
‹mp
 = 
	`u32_g‘_b™s
(
¦si_vht_ÿp
.
ÿp
, 
IEEE80211_VHT_CAP_MAX_A_MPDU_LENGTH_EXPONENT_MASK
);

4552 
he_6ghz_ÿ·
 |ğ
	`u16_’code_b™s
(
‹mp
, 
IEEE80211_HE_6GHZ_CAP_MAX_AMPDU_LEN_EXP
);

4553 
‹mp
 = 
	`u32_g‘_b™s
(
¦si_vht_ÿp
.
ÿp
, 
IEEE80211_VHT_CAP_MAX_MPDU_MASK
);

4554 
he_6ghz_ÿ·
 |ğ
	`u16_’code_b™s
(
‹mp
, 
IEEE80211_HE_6GHZ_CAP_MAX_MPDU_LEN
);

4556 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_¡a_he_ÿp
); i++)

4557 
¦si_¡a_he_ÿp
[
i
].
he_6ghz_ÿ·
.
ÿ·
 = 
	`ıu_to_Ë16
(he_6ghz_capa);

4559 
¦si_bªd_6ghz
.
iáy³_d©a
 = 
¦si_¡a_he_ÿp
;

4560 
¦si_bªd_6ghz
.
n_iáy³_d©a
 = 
	`ARRAY_SIZE
(
¦si_¡a_he_ÿp
);

4562 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = &
¦si_bªd_6ghz
;

4563 
sdev
->
deviû_cÚfig
.
bªd_6G
 = &
¦si_bªd_6ghz
;

4564 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
SLSI_FREQ_BAND_AUTO
;

4565 
sdev
->
deviû_cÚfig
.
suµÜ‹d_rßm_bªd
 |ğ
FAPI_BAND_6GHZ
;

4567 
¥l™_sÿn_’abËd
 = 
	`¦si_dev_6ghz_¥l™_sÿn_’abËd
();

4568 ià(
¥l™_sÿn_’abËd
)

4569 
sdev
->
why
->
æags
 |ğ
WIPHY_FLAG_SPLIT_SCAN_6GHZ
;

4571 
	`SLSI_INFO
(
sdev
, "6GHz s¶™ sÿÀ’abË : %d (he_6ghz_ÿ· : 0x%x)\n", 
¥l™_sÿn_’abËd
, 
he_6ghz_ÿ·
);

4572  
Œue
;

4574  
çl£
;

4576 
	}
}

4578 
	$¦si_cfg80211_upd©e_why
(
¦si_dev
 *
sdev
)

4580 
boŞ
 
suµÜt_6ghz
 = 
çl£
;

4584 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = &
¦si_bªd_2ghz
;

4585 
sdev
->
deviû_cÚfig
.
bªd_2G
 = &
¦si_bªd_2ghz
;

4586 
sdev
->
deviû_cÚfig
.
suµÜ‹d_rßm_bªd
 = 
FAPI_BAND_2_4GHZ
;

4589 ià(
sdev
->
bªd_5g_suµÜ‹d
) {

4590 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = &
¦si_bªd_5ghz
;

4591 
sdev
->
deviû_cÚfig
.
bªd_5G
 = &
¦si_bªd_5ghz
;

4592 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
SLSI_FREQ_BAND_AUTO
;

4593 
sdev
->
deviû_cÚfig
.
suµÜ‹d_rßm_bªd
 |ğ
FAPI_BAND_5GHZ
;

4595 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = 
NULL
;

4596 
sdev
->
deviû_cÚfig
.
bªd_5G
 = 
NULL
;

4597 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
SLSI_FREQ_BAND_2GHZ
;

4601 ià(
sdev
->
fw_ht_’abËd
) {

4602 
¦si_ht_ÿp
.
ht_suµÜ‹d
 = 
Œue
;

4603 
¦si_ht_ÿp
.
ÿp
 = 
	`Ë16_to_ıu
(*(
u16
 *)
sdev
->
fw_ht_ÿp
);

4604 
¦si_ht_ÿp
.
ampdu_d’s™y
 = (
sdev
->
fw_ht_ÿp
[2] & 
IEEE80211_HT_AMPDU_PARM_DENSITY
è>> 
IEEE80211_HT_AMPDU_PARM_DENSITY_SHIFT
;

4605 
¦si_ht_ÿp
.
ampdu_çùÜ
 = 
sdev
->
fw_ht_ÿp
[2] & 
IEEE80211_HT_AMPDU_PARM_FACTOR
;

4607 
¦si_ht_ÿp
.
ht_suµÜ‹d
 = 
çl£
;

4609 
¦si_bªd_2ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

4610 
¦si_bªd_5ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

4613 ià(
sdev
->
fw_vht_’abËd
) {

4614 
¦si_vht_ÿp
.
vht_suµÜ‹d
 = 
Œue
;

4615 
¦si_vht_ÿp
.
ÿp
 = 
	`Ë32_to_ıu
(*(
u32
 *)
sdev
->
fw_vht_ÿp
);

4617 
¦si_vht_ÿp
.
vht_suµÜ‹d
 = 
çl£
;

4619 
¦si_bªd_5ghz
.
vht_ÿp
 = 
¦si_vht_ÿp
;

4621 
suµÜt_6ghz
 = 
	`¦si_upd©e_why_6ghz
(
sdev
);

4623 
	`SLSI_INFO
(
sdev
, "BANDS SUPPORTED -> 2.4:'%c' 5:'%c' 6:'%c'\n",

4624 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] ? 'Y' : 'N',

4625 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] ? 'Y' : 'N',

4626 
suµÜt_6ghz
 ? 'Y' : 'N');

4628 
	`SLSI_INFO
(
sdev
, "HT/VHT SUPPORTED -> HT:'%c' VHT:'%c'\n", sdev->
fw_ht_’abËd
 ? 'Y' : 'N',

4629 
sdev
->
fw_vht_’abËd
 ? 'Y' : 'N');

4630 
	`SLSI_INFO
(
sdev
, "HT -> c­:0x%04x‡mpdu_d’s™y:%d‡mpdu_çùÜ:%d\n", 
¦si_ht_ÿp
.
ÿp
, slsi_ht_ÿp.
ampdu_d’s™y
, slsi_ht_ÿp.
ampdu_çùÜ
);

4631 
	`SLSI_INFO
(
sdev
, "VHT -> c­:0x%08x\n", 
¦si_vht_ÿp
.
ÿp
);

4632 
	}
}

	@cfg80211_ops.h

7 #iâdeà
__SLSI_CFG80211_OPS_H__


8 
	#__SLSI_CFG80211_OPS_H__


	)

10 
	~<Ãt/cfg80211.h
>

12 
	g¦si_dev
;

14 
	#SDEV_FROM_WIPHY
(
why
è((
¦si_dev
 *)(why)->
´iv
)

	)

15 
	#WLAN_CIPHER_SUITE_PMK
 0x00904C00

	)

17 
	#SLSI_WPS_REQUEST_TYPE_POS
 15

	)

18 
	#SLSI_WPS_REQUEST_TYPE_ENROLEE_INFO_ONLY
 0x00

	)

19 
	#SLSI_WPS_OUI_PATTERN
 0x04F25000

	)

20 
	#SLSI_P2P_OUI_PATTERN
 0x099a6f50

	)

21 
	#SLSI_VENDOR_OUI_AND_TYPE_LEN
 4

	)

22 
	#PMKID_LEN
 16

	)

23 
	#RSN_SELECTOR_LEN
 4

	)

24 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


25 
	#SLSI_ACL_MAX_BSSID_COUNT
 255

	)

28 
¦si_dev
 *
¦si_cfg80211_Ãw
(
deviû
 *
dev
);

29 
¦si_cfg80211_»gi¡”
(
¦si_dev
 *
sdev
);

30 
¦si_cfg80211_uÄegi¡”
(
¦si_dev
 *
sdev
);

31 
¦si_cfg80211_ä“
(
¦si_dev
 *
sdev
);

32 
¦si_cfg80211_upd©e_why
(
¦si_dev
 *
sdev
);

33 
¦si_wÏn_mgmt_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

34 
›“80211_chªÃl
 *
chª
, 
wa™
,

35 cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
, 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
);

	@cm_if.c

9 
	~"mgt.h
"

10 
	~"dev.h
"

11 
	~"debug.h
"

12 
	~"scsc_wifi_cm_if.h
"

13 
	~"uts.h
"

14 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


15 
	~"h4_§m¶”.h
"

17 
	~<lšux/fs.h
>

19 
	~<scsc/scsc_mx.h
>

20 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

21 
	~<scsc/scsc_log_cŞËùÜ.h
>

24 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0)

25 
MODULE_IMPORT_NS
(
VFS_š‹º®_I_am_»®ly_a_fesy¡em_ªd_am_NOT_a_driv”
);

28 
boŞ
 
	gEÇbËTe¡Mode
;

29 
moduË_·¿m
(
EÇbËTe¡Mode
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

30 
MODULE_PARM_DESC
(
EÇbËTe¡Mode
, "Enable WlanLiteest mode driver.");

32 
BLOCKING_NOTIFIER_HEAD
(
¦si_wÏn_nÙif›r
);

34 
mu‹x
 
	g¦si_¡¬t_mu‹x
;

35 
	g»cov”y_š_´og»ss
;

36 
u16
 
	gÏ‹¡_scsc_·nic_code
;

38 
	#SLSI_RETRY_STOP_COUNT_ERROR
 1

	)

41 
	s¦si_cm_ùx
 {

42 
¦si_dev
 *
	msdev
;

46 
¦si_cm_ùx
 
	gcm_ùx
;

48 
¦si_h_block_bh
(
¦si_dev
 *
sdev
);

50 
	$¦si_wÏn_£rviû_nÙif›r_»gi¡”
(
nÙif›r_block
 *
nb
)

52  
	`blockšg_nÙif›r_chaš_»gi¡”
(&
¦si_wÏn_nÙif›r
, 
nb
);

53 
	}
}

55 
	$¦si_wÏn_£rviû_nÙif›r_uÄegi¡”
(
nÙif›r_block
 *
nb
)

57  
	`blockšg_nÙif›r_chaš_uÄegi¡”
(&
¦si_wÏn_nÙif›r
, 
nb
);

58 
	}
}

60 
	$wÏn_su¥’d
(
scsc_£rviû_ş›Á
 *
ş›Á
)

62 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

64 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

65 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_SUSPEND
, 
sdev
);

68 
	}
}

70 
	$wÏn_»sume
(
scsc_£rviû_ş›Á
 *
ş›Á
)

72 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

74 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

75 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_RESUME
, 
sdev
);

78 
	}
}

80 
	$¦si_­³nd_log_to_sy¡em_bufãr
(
¦si_dev
 *
sdev
)

82 
pos
 = 0;

83 
buf_size
 = 128;

84 
i
 = 0;

85 *
log_to_sys_”rÜ_bufãr
 = 
NULL
;

86 
Ãtdev_vif
 *
ndev_vif
;

88 
log_to_sys_”rÜ_bufãr
 = 
	`kz®loc
(128, 
GFP_KERNEL
);

89 ià(!
log_to_sys_”rÜ_bufãr
) {

90 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory\n");

94 
	`sú´štf
(
log_to_sys_”rÜ_bufãr
 + 
pos
, 
buf_size
 -…os, "Ãtdev_up_couÁ=%d ", 
sdev
->
Ãtdev_up_couÁ
);

96 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

97 ià(
sdev
->
Ãtdev
[
i
]) {

98 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

99 ià(
ndev_vif
->
is_avaabË
)

100 
pos
 +ğ
	`sú´štf
(
log_to_sys_”rÜ_bufãr
 +…os, 
buf_size
 -…os, "[%d: vif_ty³ = %d] ", 
i
, 
ndev_vif
->
vif_ty³
);

103 
pos
 +ğ
	`sú´štf
(
log_to_sys_”rÜ_bufãr
 +…os, 
buf_size
 -…os, "\n");

104 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

105 
	}
}

107 
u8
 
	$wÏn_çu»_nÙifiÿtiÚ
(
scsc_£rviû_ş›Á
 *
ş›Á
, 
mx_sy£¼_decode
 *
”r
)

109 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

110 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

112 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
”r
->
Ëv–
);

113 
	`SLSI_INFO_NODEV
("SubSy¡em:%d,Lev–:%d,Ty³:%d,Sub_code:%d\n", 
”r
->
subsys
,ƒ¼->
Ëv–
,ƒ¼->
ty³
,ƒ¼->
subcode
);

115 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: SubSystem:%d,Level:%d,Type:%d,Sub_code:%d\n",

116 
__func__
, 
”r
->
subsys
,ƒ¼->
Ëv–
,ƒ¼->
ty³
,ƒ¼->
subcode
);

117 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

119  
”r
->
Ëv–
;

120 
	}
}

122 
	$wÏn_çu»_»£t_v2
(
scsc_£rviû_ş›Á
 *
ş›Á
, 
u8
 
Ëv–
, 
u16
 
scsc_sy£¼_code
)

124 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

125 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

127 
	`SLSI_INFO_NODEV
("Lev–:%d scsc_sy£¼_code:%d\n", 
Ëv–
, 
scsc_sy£¼_code
);

129 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: Lev–:%d scsc_sy£¼_code:%d\n", 
__func__
, 
Ëv–
, 
scsc_sy£¼_code
);

130 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

132 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

133 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
Ëv–
);

134 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

135 ià(
Ëv–
 < 5) {

136 
	`SLSI_WARN_NODEV
("Low†ev–ƒ¼Ü†ev–:%d\n", 
Ëv–
);

137 } ià(
Ëv–
 == 5 ||†evel == 6) {

138 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_SUBSYSTEM_RESET
, 
sdev
);

139 } ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

140 #iâdeà
SCSC_SEP_VERSION


141 ià(
sdev
->
fÜûd_£_7
) {

142 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

143 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 7);

144 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

146 
sdev
->
fÜûd_£_7
 = 
çl£
;

148 
Ï‹¡_scsc_·nic_code
 = 
scsc_sy£¼_code
;

150 
	}
}

152 
boŞ
 
	$wÏn_¡İ_Ú_çu»_v2
(
scsc_£rviû_ş›Á
 *
ş›Á
, 
mx_sy£¼_decode
 *
”r
)

154 
¡©e
;

155 
u8
 
sy¡em_”rÜ_Ëv–
;

156 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

157 #iâdeà
SCSC_SEP_VERSION


158 
Ãtdev_vif
 *
wÏn_dev_vif
;

160 *
”rÜ
 = "Subsystem Restart";

161 #ifdeà
CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY


162 
Ãtdev_vif
 *
ndev_vif
;

163 
i
;

166 
	`SLSI_INFO_NODEV
("¡©e:%d,ƒ¼_Ëv–:%d\n", 
sdev
->
cm_if
.
cm_if_¡©e
, 
”r
->
Ëv–
);

167 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

168 
»cov”y_š_´og»ss
 = 1;

169 
sdev
->
»cov”y_¡©us
 = 1;

170 #iâdeà
SCSC_SEP_VERSION


171 
sdev
->
fÜûd_£_7
 = 
çl£
;

174 
	`¦si_­³nd_log_to_sy¡em_bufãr
(
sdev
);

176 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

178 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

179 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
”r
->
Ëv–
);

183 
sy¡em_”rÜ_Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

184 ià(!
sy¡em_”rÜ_Ëv–
 || sy¡em_”rÜ_Ëv– =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

185 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
);

186 #iâdeà
SCSC_SEP_VERSION


191 ià(
sdev
->
Ãtdev_up_couÁ
 =ğ1 && sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]) {

192 
wÏn_dev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

193 ià(
wÏn_dev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
 && wÏn_dev_vif->
is_avaabË
) {

194 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 7);

195 
sdev
->
fÜûd_£_7
 = 
Œue
;

196 
	`SLSI_INFO_NODEV
("Reducing„eset†evel: L8->L7\n");

201 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

202 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_BLOCKED
);

203 
sdev
->
ç_»pÜ‹d
 = 
Œue
;

209 ià(
sdev
->
»cov”y_Ãxt_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

210 
	`¦si_h_block_bh
(
sdev
);

213 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

214 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

215 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_STOP
, 
sdev
);

216 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

217 #ifdeà
CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY


218 
sy¡em_”rÜ_Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

219 ià(
sy¡em_”rÜ_Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

220 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

221 ià(
sdev
->
Ãtdev
[
i
]) {

222 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

223 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
) {

224 ià(
	`¦si_£nd_hªged_v’dÜ_ev’t
(
sdev
,

225 
Ï‹¡_scsc_·nic_code
) < 0)

226 
	`SLSI_ERR
(
sdev
, "Failedo send hangƒvent\n");

233 
	`SLSI_INFO_NODEV
("Wi-Fi service driver‚ot started\n");

236 
	`SLSI_INFO_NODEV
("Sending SLSI_NL80211_SUBSYSTEM_RESTART_EVENT\n");

237 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_SUBSYSTEM_RESTART_EVENT
, 
”rÜ
, 
	`¡¾’
(error));

238 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

239 
	`SLSI_INFO_NODEV
("Done!\n");

240  
Œue
;

241 
	}
}

246 
	$¦si_wÏn_£rviû_´obe
(
scsc_mx_moduË_ş›Á
 *
moduË_ş›Á
, 
scsc_mx
 *
mx
, 
scsc_moduË_ş›Á_»asÚ
 
»asÚ
)

248 
¦si_dev
 *
sdev
;

249 
deviû
 *
dev
;

250 
scsc_£rviû_ş›Á
 
mx_wÏn_ş›Á
;

251 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

252 
buf
[
SCSC_LOG_FAPI_VERSION_SIZE
];

254 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

256 
	`SLSI_UNUSED_PARAMETER
(
moduË_ş›Á
);

258 
	`SLSI_INFO_NODEV
("WLAN service…robe\n");

260 
	`mem£t
((*)&
mx_wÏn_ş›Á
, 0, (
size_t
)(mx_wlan_client));

261 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

263 ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
 && !
»cov”y_š_´og»ss
)

264 
dÚe
;

266 ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
) {

267 
	`SLSI_INFO_NODEV
("Probe„ecovery\n");

268 
sdev
 = 
cm_ùx
.sdev;

269 
»cov”y_š_´og»ss
 = 0;

270 
sdev
->
ç_»pÜ‹d
 = 
çl£
;

271 
sdev
->
»cov”y_¡©us
 = 0;

272 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

273 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_CHIP_READY
, 
sdev
);

274 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

275 
	`com¶‘e_®l
(&
sdev
->
»cov”y_com¶‘ed
);

276 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘ed\n", 
__func__
);

277 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

280 
mx_wÏn_ş›Á
.
çu»_nÙifiÿtiÚ
 = 
wÏn_çu»_nÙifiÿtiÚ
;

281 
mx_wÏn_ş›Á
.
¡İ_Ú_çu»_v2
 = 
wÏn_¡İ_Ú_çu»_v2
;

282 
mx_wÏn_ş›Á
.
çu»_»£t_v2
 = 
wÏn_çu»_»£t_v2
;

283 
mx_wÏn_ş›Á
.
su¥’d
 = 
wÏn_su¥’d
;

284 
mx_wÏn_ş›Á
.
»sume
 = 
wÏn_»sume
;

286 
dev
 = 
	`scsc_£rviû_g‘_deviû_by_mx
(
mx
);

293 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

294 
sdev
 = 
	`¦si_dev_©ch
(
dev
, 
mx
, &
mx_wÏn_ş›Á
);

295 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

296 ià(!
sdev
) {

297 
	`SLSI_ERR_NODEV
("WLAN‡ttach failed - slsi_dev_attach\n");

298 
dÚe
;

301 
cm_ùx
.
sdev
 = sdev;

303 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_PROBING
);

304 
	`g‘_deviû
(
dev
);

306 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


307 
	`h4_§m¶”_ü—‹
(
sdev
, 
mx
);

309 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

310 
	`mem£t
(
buf
, 0, 
SCSC_LOG_FAPI_VERSION_SIZE
);

315 
	`¢´štf
(
buf
, 
SCSC_LOG_FAPI_VERSION_SIZE
, "ma:%u.%u, mlme:%u.%u, debug:%u.%u,est:%u.%u",

316 
	`FAPI_MAJOR_VERSION
(
FAPI_DATA_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_DATA_SAP_VERSION),

317 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_CONTROL_SAP_VERSION),

318 
	`FAPI_MAJOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_DEBUG_SAP_VERSION),

319 
	`FAPI_MAJOR_VERSION
(
FAPI_TEST_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_TEST_SAP_VERSION));

321 
	`scsc_log_cŞËùÜ_wr™e_çpi
(
buf
, 
SCSC_LOG_FAPI_VERSION_SIZE
);

325 ià(
»asÚ
 !ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
)

326 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_PROBED
);

327 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 0);

328 
dÚe
:

329 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

330 
	}
}

335 
	$£rviû_ş—n_up_locked
(
¦si_dev
 *
sdev
)

337 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_REMOVING
);

338 
	`put_deviû
(
sdev
->
dev
);

340 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_REMOVED
);

342 
sdev
->
maxw–l_cÜe
 = 
NULL
;

349 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

350 
	`¦si_dev_d‘ach
(
sdev
);

351 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

352 
	}
}

354 
	$¦si_wÏn_£rviû_»move
(
scsc_mx_moduË_ş›Á
 *
moduË_ş›Á
, 
scsc_mx
 *
mx
, 
scsc_moduË_ş›Á_»asÚ
 
»asÚ
)

356 
¦si_dev
 *
sdev
;

357 
¡©e
;

358 
Ëv–
 = 0;

359 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

361 
	`SLSI_UNUSED_PARAMETER
(
mx
);

362 
	`SLSI_UNUSED_PARAMETER
(
moduË_ş›Á
);

364 
sdev
 = 
cm_ùx
.sdev;

365 ià(!
sdev
) {

366 
	`SLSI_INFO_NODEV
("no sdev\n");

370 ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
 && !
»cov”y_š_´og»ss
) {

371 
	`SLSI_INFO_NODEV
("WLAN service„emove -„ecovery. Service‚ot‡ctive.\n");

372 } ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
 && 
»cov”y_š_´og»ss
) {

373 
r
;

375 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

377 
	`SLSI_INFO_NODEV
("WLAN s”viû„emov-„ecov”y, E¼Ü Lev–:%d\n", 
Ëv–
);

379 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y, E¼Ü Lev–:%d\n", 
__func__
, 
Ëv–
);

380 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

386 ià(
sdev
->
»cov”y_Ãxt_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

387 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

388 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_FAILURE_RESET
, 
sdev
);

390 ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

391 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

397 
	`com¶‘e_®l
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

398 ià(
sdev
->
»cov”y_Ãxt_¡©e
 =ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

399 
	`SLSI_INFO_NODEV
("Recovery -‚ext state stopping\n");

401 
	`SLSI_INFO_NODEV
("Calling slsi_send_hanged_vendor_event with†atest_scsc_panic_code=0x%x\n",

402 
Ï‹¡_scsc_·nic_code
);

403 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Calling slsi_send_hanged_vendor_event,…anic_code=0x%x\n",

404 
Ï‹¡_scsc_·nic_code
);

405 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

407 ià(
	`¦si_£nd_hªged_v’dÜ_ev’t
(
sdev
, 
Ï‹¡_scsc_·nic_code
) < 0) {

408 
	`SLSI_ERR
(
sdev
, "Failedo send hangƒvent\n");

409 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Failedo send vendor hangƒvent\n");

410 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

416 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

419 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

421 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
,

422 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

423 ià(
r
 == 0) {

424 
	`SLSI_INFO
(
sdev
, "»cov”y_¡İ_com¶‘iÚimedout,‚‘dev_up_couÁ = %d\n", sdev->
Ãtdev_up_couÁ
);

425 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "recovery_stop_completionimedout[%d]\n",

426 
sdev
->
»cov”y_timeout
);

427 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

428 ià(
sdev
->
Ãtdev_up_couÁ
) {

429 
sdev
->
»cov”y_ç_§ã
 = 
Œue
;

430 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

431 
	`¦si_¡İ_ch
(
sdev
);

432 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

433 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
sy¡em_”rÜ_u£r_ç_wÜk
);

437 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

438 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

439 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

442 
	`SLSI_INFO_NODEV
("WLAN service„emove\n");

444 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


445 
	`h4_§m¶”_de¡roy
(
sdev
, 
mx
);

448 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

449 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

450 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STARTED
 &&

451 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

452 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
 &&

453 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_BLOCKED
) {

454 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

455 
	`SLSI_INFO_NODEV
("¡©e-ev’ˆ”rÜ %d\n", 
¡©e
);

459 
	`£rviû_ş—n_up_locked
(
sdev
);

460 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

462 
	`SLSI_INFO_NODEV
("Done!\n");

463 
	}
}

466 
	$¦si_h_block_bh
(
¦si_dev
 *
sdev
)

468 
	`SLSI_WARN
(
sdev
, "HIP state seto #SLSI_HIP_STATE_BLOCKED#\n");

469 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_BLOCKED
);

470 
	}
}

472 
scsc_mx_moduË_ş›Á
 
	gwÏn_driv”
 = {

473 .
Çme
 = "WLAN driver",

474 .
	g´obe
 = 
¦si_wÏn_£rviû_´obe
,

475 .
	g»move
 = 
¦si_wÏn_£rviû_»move
,

478 
	$¦si_sm_£rviû_driv”_»gi¡”
()

480 
¦si_cm_ùx
 *
ùx
 = &
cm_ùx
;

482 
	`mem£t
(
ùx
, 0, (*ctx));

483 
	`mu‹x_š™
(&
¦si_¡¬t_mu‹x
);

484 
	`scsc_mx_moduË_»gi¡”_ş›Á_moduË
(&
wÏn_driv”
);

487 
	}
}

489 
	$¦si_sm_£rviû_driv”_uÄegi¡”
()

491 
	`scsc_mx_moduË_uÄegi¡”_ş›Á_moduË
(&
wÏn_driv”
);

492 
	}
}

497 
	$¦si_sm_£rviû_çed
(
¦si_dev
 *
sdev
, cÚ¡ *
»asÚ
, 
boŞ
 
is_wÜk
)

499 
¡©e
;

501 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

503 ià(
is_wÜk
)

504 
	`com¶‘e_®l
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

506 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

507 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STARTED
 &&

508 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

509 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

510 
	`SLSI_INFO
(
sdev
, "S‹ %d - ignÜšgƒv’t\n", 
¡©e
);

515 ià(!
sdev
->
ç_»pÜ‹d
) {

517 
	`SLSI_ERR
(
sdev
, "scsc_wifibt: FATAL ERROR: %s\n", 
»asÚ
);

519 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_BLOCKED
);

520 
	`¦si_h_block_bh
(
sdev
);

521 
	`scsc_mx_£rviû_£rviû_çed
(
sdev
->
£rviû
, 
»asÚ
);

522 
	`scsc_mx_£rviû_mif_dump_»gi¡”s
(
sdev
->
£rviû
);

523 
sdev
->
ç_»pÜ‹d
 = 
Œue
;

526 ià(
is_wÜk
)

527 
	`»š™_com¶‘iÚ
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

529 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

530 
	}
}

533 
boŞ
 
	$¦si_is_‹¡_mode_’abËd
()

535  
EÇbËTe¡Mode
;

536 
	}
}

538 
	#SLSI_SM_WLAN_SERVICE_RECOVERY_COMPLETED_TIMEOUT
 20000

	)

539 
	#SLSI_SM_WLAN_SERVICE_RECOVERY_DISABLED_TIMEOUT
 2000

	)

541 
	$¦si_sm_»cov”y_£rviû_¡İ
(
¦si_dev
 *
sdev
)

543 
”r
 = 0;

544 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

546 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

547 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

548 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Stopping WLAN service\n");

549 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

551 
sdev
->
wÏn_£rviû_Ú
 = 0;

552 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPING
);

554 ià(!
sdev
->
£rviû
) {

555 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

556 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

557 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

558 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

559 
”r
 = -
EINVAL
;

560 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

561  
”r
;

564 
”r
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

565 ià(
”r
 =ğ-
EILSEQ
 ||ƒ¼ =ğ-
EIO
)

566 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼: %d\n", 
”r
);

568 
”r
 = 0;

569 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

570 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

571  
”r
;

572 
	}
}

574 
	$¦si_sm_»cov”y_£rviû_şo£
(
¦si_dev
 *
sdev
)

576 
”r
 = 0;

577 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

579 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

580 ià(!
sdev
->
£rviû
) {

581 
	`SLSI_WARN
(
sdev
, "sdev->service is NULL\n");

582 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

583  -
EINVAL
;

586 
	`SLSI_INFO_NODEV
("Closing WLAN service\n");

587 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Closing WLAN service\n");

588 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

590 
”r
 = 
	`scsc_mx_£rviû_şo£
(
sdev
->
£rviû
);

591 ià(
”r
 =ğ-
EILSEQ
 ||ƒ¼ =ğ-
EIO
)

592 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_şo£ faedƒ¼: %d\n", 
”r
);

594 
”r
 = 0;

595 ià(!
”r
)

596 
sdev
->
£rviû
 = 
NULL
;

597 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

598  
”r
;

599 
	}
}

601 
	$¦si_sm_»cov”y_£rviû_İ’
(
¦si_dev
 *
sdev
)

603 
”r
 = 0;

604 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

606 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

607 
	`SLSI_INFO_NODEV
("Open WLAN service\n");

608 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Open WLAN service\n");

609 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

611 
sdev
->
£rviû
 = 
	`scsc_mx_£rviû_İ’
(sdev->
maxw–l_cÜe
, 
SCSC_SERVICE_ID_WLAN
, &sdev->
mx_wÏn_ş›Á
, &
”r
);

612 ià(
”r
 =ğ-
EILSEQ
 ||ƒ¼ =ğ-
EIO
)

613 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_İ’ faedƒ¼: %d\n", 
”r
);

615 
”r
 = 0;

616 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

617  
”r
;

618 
	}
}

620 
	$¦si_sm_»cov”y_£rviû_¡¬t
(
¦si_dev
 *
sdev
)

622 
”r
 = 0, 
”r2
 = 0;

623 
¦si_h4
 *
h
 = &
sdev
->
h4_š¡
;

624 
scsc_miäam_»f
 
»f
;

625 
¡©e
;

626 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

628 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

629 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

630 
	`SLSI_INFO
(
sdev
,

632 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
, 
¡©e
);

633 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

634 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

635 
	`SLSI_INFO
(
sdev
, "S‹-ev’ˆ”rÜ %d\n", 
¡©e
);

636 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

637  -
EINVAL
;

640 ià(!
sdev
->
£rviû
) {

641 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

642 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

643 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

644 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

645 
”r
 = -
EINVAL
;

646 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

647  
”r
;

650 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTING
);

651 #ifdeà
CONFIG_SCSC_PCIE


652 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 1.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

654 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 2.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

656 ià(
”r
) {

657 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_miäam_®loøçedƒ¼: %d\n", 
”r
);

658 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "scsc_mx_£rviû_miäam_®loøçedƒ¼: %d\n", 
”r
);

659 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

660 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

661 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

662  
”r
;

665 
”r
 = 
	`¦si_h_¡¬t
(
sdev
);

666 ià(
”r
) {

667 
	`SLSI_WARN
(
sdev
, "¦si_h_¡¬ˆçedƒ¼: %d\n", 
”r
);

668 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "¦si_h_¡¬ˆçedƒ¼: %d\n", 
”r
);

669 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

670 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

671 
	`¦si_h_¡İ
(
sdev
);

672 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

673  
”r
;

676 
”r
 = 
	`scsc_mx_£rviû_mif_±r_to_addr
(
sdev
->
£rviû
, 
h
->
h_cÚŒŞ
, &
»f
);

677 ià(
”r
) {

678 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_mif_±r_to_add¸çedƒ¼: %d\n", 
”r
);

679 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "scsc_mx_£rviû_mif_±r_to_add¸çedƒ¼: %d\n", 
”r
);

680 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

681 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

682 
	`¦si_h_¡İ
(
sdev
);

683 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

684  
”r
;

687 
”r
 = 
	`scsc_mx_£rviû_¡¬t
(
sdev
->
£rviû
, 
»f
);

688 ià(
”r
) {

689 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_¡¬ˆçedƒ¼: %d\n", 
”r
);

690 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "scsc_mx_£rviû_¡¬ˆçedƒ¼: %d\n", 
”r
);

691 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

692 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

693 
	`¦si_h_¡İ
(
sdev
);

694 ià(
”r
 =ğ-
EILSEQ
) {

695 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

696 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

698 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

699  
”r
;

701 
”r
 = 
	`¦si_h_£tup
(
sdev
);

702 ià(
”r
) {

703 
	`SLSI_WARN
(
sdev
, "¦si_h_£tu°çedƒ¼: %d\n", 
”r
);

704 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "¦si_h_£tu°çedƒ¼: %d\n", 
”r
);

705 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

706 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

707 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

708 ià(
”r2
)

709 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

710 ià(
”r2
 =ğ-
EILSEQ
) {

711 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

712 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

714 
	`¦si_h_¡İ
(
sdev
);

715 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

716  
”r
;

719 
”r
 = 
	`¦si_h_§p_£tup
(
sdev
);

720 ià(
”r
) {

721 
	`SLSI_WARN
(
sdev
, "¦si_h_§p_£tu°çedƒ¼: %d\n", 
”r
);

722 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "¦si_h_§p_£tu°çedƒ¼: %d\n", 
”r
);

723 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

724 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

725 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

726 ià(
”r2
)

727 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

728 ià(
”r2
 =ğ-
EILSEQ
) {

729 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

730 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

732 
	`¦si_h_¡İ
(
sdev
);

733 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

734  
”r
;

736 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTED
);

737 
sdev
->
wÏn_£rviû_Ú
 = 1;

738 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: wÏn_£rviû_Ú[1]\n", 
__func__
);

739 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

740 
sdev
->
»quœe_£rviû_şo£
 = 
çl£
;

741 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

742  
”r
;

743 
	}
}

745 
	$¦si_sm_wÏn_£rviû_İ’
(
¦si_dev
 *
sdev
)

747 
”r
 = 0;

748 
¡©e
;

749 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

751 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

752 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

753 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

754 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

755 
	`SLSI_INFO
(
sdev
, "S‹-ev’ˆ”rÜ %d\n", 
¡©e
);

756 
”r
 = -
EINVAL
;

757 
ex™
;

760 
sdev
->
»cov”y_timeout
 = 
	`mxmª_»cov”y_di§bËd
(è? 
SLSI_SM_WLAN_SERVICE_RECOVERY_DISABLED_TIMEOUT
 : 
SLSI_SM_WLAN_SERVICE_RECOVERY_COMPLETED_TIMEOUT
;

763 
	`SLSI_INFO
(
sdev
, "Open WLAN service\n");

764 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "O³ÀWLAN s”viû,„ecov”yimeouˆğ%d\n", 
sdev
->
»cov”y_timeout
);

765 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

767 
sdev
->
£rviû
 = 
	`scsc_mx_£rviû_İ’
(sdev->
maxw–l_cÜe
, 
SCSC_SERVICE_ID_WLAN
, &sdev->
mx_wÏn_ş›Á
, &
”r
);

768 ià(!
sdev
->
£rviû
) {

769 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_PROBED
);

770 
	`SLSI_WARN
(
sdev
, "Service open failed\n");

771 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû o³Àçed,ƒ¼=%d\n", 
”r
);

772 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

773 
”r
 = -
EINVAL
;

774 
ex™
;

777 
ex™
:

778 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

779  
”r
;

780 
	}
}

782 #ià
defšed
(
CONFIG_SLUB_DEBUG_ON
è|| defšed(
CONFIG_DEBUG_PREEMPT
è|| defšed(
CONFIG_DEBUG_RT_MUTEXES
) || \

783 
defšed
(
CONFIG_DEBUG_SPINLOCK
è&& defšed(
CONFIG_DEBUG_MUTEXES
è&& defšed(
CONFIG_DEBUG_LOCK_ALLOC
) || \

784 
defšed
(
CONFIG_DEBUG_LOCK_ALLOC
è&& defšed(
CONFIG_DEBUG_ATOMIC_SLEEP
è&& 
	$defšed
(
CONFIG_DEBUG_LIST
)

785 
	#KERNEL_DEBUG_OPTIONS_ENABLED


	)

788 
	$¦si_sm_wÏn_£rviû_¡¬t
(
¦si_dev
 *
sdev
)

790 
¦si_h4
 *
h
 = &
sdev
->
h4_š¡
;

791 
scsc_miäam_»f
 
»f
;

792 
”r
 = 0;

793 
”r2
 = 0;

794 
¡©e
;

795 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

797 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

798 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

799 
	`SLSI_INFO
(
sdev
,

801 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
, 
¡©e
);

803 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecovery_status = %d,„ecovery_in_progress = %d\n",

804 
__func__
, 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
);

805 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

807 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

808 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

809 
	`SLSI_INFO
(
sdev
, "S‹-ev’ˆ”rÜ %d\n", 
¡©e
);

810 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

811  -
EINVAL
;

814 ià(!
sdev
->
£rviû
) {

815 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

816 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

817 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

818 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

819 
”r
 = -
EINVAL
;

820 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

821  
”r
;

824 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTING
);

826 #ifdeà
KERNEL_DEBUG_OPTIONS_ENABLED


827 
	`SLSI_WARN
(
sdev
, "Kernel config debug options‡reƒnabled. This might impacthehroughput…erformance.\n");

831 
	`SLSI_INFO
(
sdev
, "Allocate mifram\n");

833 #ifdeà
CONFIG_SCSC_PCIE


834 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 1.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

836 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 2.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

838 ià(
”r
) {

839 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_miäam_®loøçedƒ¼: %d\n", 
”r
);

840 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

841 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

842  
”r
;

845 
	`SLSI_INFO
(
sdev
, "Start HIP\n");

846 
”r
 = 
	`¦si_h_¡¬t
(
sdev
);

847 ià(
”r
) {

848 
	`SLSI_WARN
(
sdev
, "¦si_h_¡¬ˆçedƒ¼: %d\n", 
”r
);

849 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

850 
	`¦si_h_¡İ
(
sdev
);

851 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

852  
”r
;

855 
”r
 = 
	`scsc_mx_£rviû_mif_±r_to_addr
(
sdev
->
£rviû
, 
h
->
h_cÚŒŞ
, &
»f
);

856 ià(
”r
) {

857 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_mif_±r_to_add¸çedƒ¼: %d\n", 
”r
);

858 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

859 
	`¦si_h_¡İ
(
sdev
);

860 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

861  
”r
;

864 
	`SLSI_INFO
(
sdev
, "Starting WLAN service\n");

865 
”r
 = 
	`scsc_mx_£rviû_¡¬t
(
sdev
->
£rviû
, 
»f
);

866 ià(
”r
) {

867 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_¡¬ˆçedƒ¼: %d\n", 
”r
);

868 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

869 ià(
”r
 =ğ-
EILSEQ
) {

870 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

871 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

873 
	`¦si_h_¡İ
(
sdev
);

874 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

875  
”r
;

877 
”r
 = 
	`¦si_h_£tup
(
sdev
);

878 ià(
”r
) {

879 
	`SLSI_WARN
(
sdev
, "¦si_h_£tu°çedƒ¼: %d\n", 
”r
);

880 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

881 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

882 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

883 ià(
”r2
)

884 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

885 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

886 ià(
”r2
)

887 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

888 ià(
”r2
 =ğ-
EILSEQ
) {

889 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

890 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

892 
	`¦si_h_¡İ
(
sdev
);

893 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

894  
”r2
;

897 
”r
 = 
	`¦si_h_§p_£tup
(
sdev
);

898 ià(
”r
) {

899 
	`SLSI_WARN
(
sdev
, "¦si_h_§p_£tu°çedƒ¼: %d\n", 
”r
);

900 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

901 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

902 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

903 ià(
”r2
)

904 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

905 ià(
”r2
 =ğ-
EILSEQ
) {

906 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

907 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

909 
	`¦si_h_¡İ
(
sdev
);

910 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

911  
”r2
;

913 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTED
);

914 
sdev
->
wÏn_£rviû_Ú
 = 1;

915 
sdev
->
»quœe_£rviû_şo£
 = 
çl£
;

916 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

918 
	}
}

920 
	$__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
¦si_dev
 *
sdev
)

922 
r
;

923 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

925 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

926 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_»move_com¶‘iÚ
,

927 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

928 ià(
r
 == 0) {

929 
	`SLSI_INFO
(
sdev
, "recovery_remove_completionimeout\n");

931 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_»move_com¶‘iÚimeout\n", 
__func__
);

932 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

935 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

936 
sdev
->
»cov”y_Ãxt_¡©e
 = 
SCSC_WIFI_CM_IF_STATE_STOPPED
;

938 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

939 
	}
}

941 
	$¦si_sm_wÏn_£rviû_¡İ
(
¦si_dev
 *
sdev
)

943 
cm_if_¡©e
;

944 
”r
 = 0;

946 
u8
 
»Œy_couÁ
 = 
SLSI_RETRY_STOP_COUNT_ERROR
;

947 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

949 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

950 
cm_if_¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.cm_if_state);

951 
	`SLSI_INFO
(
sdev
,

953 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
, 
cm_if_¡©e
);

955 ià(!
sdev
->
£rviû
) {

956 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

957 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

958 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

959 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

960 
”r
 = -
EINVAL
;

961 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

962  
”r
;

965 ià(
cm_if_¡©e
 =ğ
SCSC_WIFI_CM_IF_STATE_BLOCKED
) {

966 
	`__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
sdev
);

968 ià(
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
è=ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

969 
	`SLSI_INFO
(
sdev
, "sk mx_£rviû_şo£ cm_if_¡©e=%d\n", 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

970 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

971  -
EUSERS
;

980 
sk_¡©e_check
;

983 ià(
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STARTED
 &&

984 
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_REMOVED
 &&

985 
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
) {

986 
	`SLSI_INFO
(
sdev
, "Service‚ot started or incorrect state %d\n",

987 
cm_if_¡©e
);

988 
ex™
;

998 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPING
);

999 
sk_¡©e_check
:

1000 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

1001 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: Stİpšg WLAN s”viû\n", 
__func__
);

1003 
”r
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

1004 ià(
”r
 =ğ-
EILSEQ
) {

1008 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼: %d‡‰em± Ëá: %d\n", 
”r
, 
»Œy_couÁ
);

1009 
	`__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
sdev
);

1012 ià(!
»Œy_couÁ
)

1013 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

1014 ià(
»Œy_couÁ
--)

1015 
sk_¡©e_check
;

1016 } ià(
”r
 =ğ-
EIO
) {

1017 
»asÚ
[80];

1019 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼: %d\n", 
”r
);

1025 
sdev
->
»cov”y_Ãxt_¡©e
 = 
SCSC_WIFI_CM_IF_STATE_STOPPING
;

1026 
	`¢´štf
(
»asÚ
, (reason), "WLAN scsc_mx_service_stop failed");

1028 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

1029 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
çl£
);

1030 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

1032 
	`__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
sdev
);

1033 } ià(
”r
 =ğ-
EPERM
) {

1037 
	`SLSI_INFO
(
sdev
, "»fu£d dutØ´eviou çu»,„ecov”y i di§bËd: %d\n", 
”r
);

1038 } ià(
”r
 != 0) {

1039 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faed, unknowÀ”r: %d\n", 
”r
);

1042 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

1043 
ex™
:

1044 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

1046 
	}
}

1048 
	#SLSI_SM_WLAN_SERVICE_CLOSE_RETRY
 60

	)

1049 
	$¦si_sm_wÏn_£rviû_şo£
(
¦si_dev
 *
sdev
)

1051 
cm_if_¡©e
, 
r
 = 0;

1052 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

1054 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

1055 
sdev
->
wÏn_£rviû_Ú
 = 0;

1056 
cm_if_¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.cm_if_state);

1057 ià(
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

1058 
	`SLSI_INFO
(
sdev
, "S”viû‚Ù stİ³d. cm_if_¡©ğ%d s”viû i ğ%d\n", 
cm_if_¡©e
, sdev->
£rviû
);

1064 ià(
cm_if_¡©e
 =ğ
SCSC_WIFI_CM_IF_STATE_PROBED
) {

1065 
	`SLSI_INFO_NODEV
("Closing WLAN service onƒrror\n");

1066 ià(
sdev
->
£rviû
)

1067 
r
 = 
	`scsc_mx_£rviû_şo£
(
sdev
->
£rviû
);

1069 
ex™
;

1072 
	`SLSI_INFO_NODEV
("Closšg WLAN s”viû. S”viû i %d\n", 
sdev
->
£rviû
);

1074 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: Closšg WLAN s”viû. S”viû i %d\n", 
__func__
, 
sdev
->
£rviû
);

1075 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

1077 ià(
sdev
->
£rviû
) {

1078 
	`scsc_mx_£rviû_miäam_ä“
(
sdev
->
£rviû
, sdev->
h4_š¡
.
h_»f
);

1079 
r
 = 
	`scsc_mx_£rviû_şo£
(
sdev
->
£rviû
);

1080 ià(
r
 =ğ-
EIO
) {

1084 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

1085 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

1086 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_şo£ faed w™hƒ¼Ü:%d\n", 
r
);

1087 } ià(
r
 =ğ-
EPERM
) {

1088 
	`SLSI_ERR
(
sdev
, "scsc_mx_£rviû_şo£ -„ecov”y i di§bËd (%d)\n", 
r
);

1092 ià(
»cov”y_š_´og»ss
)

1093 
	`com¶‘e_®l
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

1094 
ex™
:

1095 ià(!
r
)

1096 
sdev
->
£rviû
 = 
NULL
;

1097 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

1098 
	}
}

1100 
¦si_dev
 *
	$¦si_g‘_sdev
()

1102  
cm_ùx
.
sdev
;

1103 
	}
}

	@const.h

7 #iâdeà
_SLSI_CONST_H__


8 
	#_SLSI_CONST_H__


	)

10 
	~<lšux/v”siÚ.h
>

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/›“80211.h
>

14 #ifdeà
__ılu¥lus


19 
	#SLSI_TDLS_PEER_CONNECTIONS_MAX
 4

	)

20 
	#SLSI_AP_PEER_CONNECTIONS_MAX
 10

	)

26 
	#SLSI_ADHOC_PEER_CONNECTIONS_MAX
 16

	)

29 
	#SLSI_TDLS_PEER_INDEX_MIN
 2

	)

30 
	#SLSI_TDLS_PEER_INDEX_MAX
 15

	)

31 
	#SLSI_PEER_INDEX_MIN
 1

	)

32 
	#SLSI_PEER_INDEX_MAX
 16

	)

34 
	#SLSI_STA_PEER_QUEUESET
 0

	)

36 
	#SLSI_BA_TRAFFIC_STREAM_MAX
 8

	)

37 
	#SLSI_BA_BUFFER_SIZE_MAX
 64

	)

40 #ifdeà
__ılu¥lus


	@debug.c

7 
	~<lšux/sysfs.h
>

8 
	~<lšux/pŞl.h
>

9 
	~<lšux/cdev.h
>

11 
	~"debug.h
"

12 
	~"´ocfs.h
"

13 
	~"uts.h
"

15 #iâdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


16 cÚ¡ 
	gSLSI_INIT_DEINIT
;

17 cÚ¡ 
	gSLSI_NETDEV
 = 1;

18 cÚ¡ 
	gSLSI_CFG80211
 = 2;

19 cÚ¡ 
	gSLSI_MLME
 = 3;

20 cÚ¡ 
	gSLSI_SUMMARY_FRAMES
 = 4;

21 cÚ¡ 
	gSLSI_HYDRA
 = 5;

22 cÚ¡ 
	gSLSI_TX
 = 6;

23 cÚ¡ 
	gSLSI_RX
 = 7;

24 cÚ¡ 
	gSLSI_UDI
 = 8;

26 cÚ¡ 
	gSLSI_WIFI_FCQ
 = 9;

28 cÚ¡ 
	gSLSI_HIP
 = 10;

29 cÚ¡ 
	gSLSI_HIP_INIT_DEINIT
 = 11;

30 cÚ¡ 
	gSLSI_HIP_FW_DL
 = 12;

31 cÚ¡ 
	gSLSI_HIP_SDIO_OP
 = 13;

32 cÚ¡ 
	gSLSI_HIP_PS
 = 14;

33 cÚ¡ 
	gSLSI_HIP_TH
 = 15;

34 cÚ¡ 
	gSLSI_HIP_FH
 = 16;

35 cÚ¡ 
	gSLSI_HIP_SIG
 = 17;

37 cÚ¡ 
	gSLSI_FUNC_TRACE
 = 18;

38 cÚ¡ 
	gSLSI_TEST
 = 19;

39 cÚ¡ 
	gSLSI_SRC_SINK
 = 20;

40 cÚ¡ 
	gSLSI_FW_TEST
 = 21;

41 cÚ¡ 
	gSLSI_RX_BA
 = 22;

43 cÚ¡ 
	gSLSI_TDLS
 = 23;

44 cÚ¡ 
	gSLSI_GSCAN
 = 24;

45 cÚ¡ 
	gSLSI_MBULK
 = 25;

46 cÚ¡ 
	gSLSI_FLOWC
 = 26;

47 cÚ¡ 
	gSLSI_SMAPPER
 = 27;

49 cÚ¡ 
	gSLSI_PM
 = 28;

52 
¦si_dbg_£t_·¿m_cb
(cÚ¡ *
v®
, cÚ¡ 
k”Ãl_·¿m
 *
kp
);

53 
¦si_dbg_g‘_·¿m_cb
(*
bufãr
, cÚ¡ 
k”Ãl_·¿m
 *
kp
);

55 
k”Ãl_·¿m_İs
 
	g·¿m_İs_log
 = {

56 .
£t
 = 
¦si_dbg_£t_·¿m_cb
,

57 .
	gg‘
 = 
¦si_dbg_g‘_·¿m_cb
,

60 
	#ADD_DEBUG_MODULE_PARAM
(
Çme
, 
deçuÉ_Ëv–
, 
f‹r
) \

61 
¦si_dbg_lvl_
 ## 
Çme
 = 
deçuÉ_Ëv–
; \

62 
	`moduË_·¿m_cb
(
¦si_dbg_lvl_
 ## 
Çme
, &
·¿m_İs_log
, (*)&
f‹r
, 
S_IRUGO
 | 
S_IWUSR
); \

63 
	`MODULE_PARM_DESC
(
¦si_dbg_lvl_
 ## 
Çme
, " Debug†ev– (0~4èfÜh" #Çm" moduË (0 = offèdeçuÉ=" #deçuÉ_Ëv–)

	)

65 #iâdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


67 
ADD_DEBUG_MODULE_PARAM
(
š™_deš™
, 3, 
SLSI_INIT_DEINIT
);

68 
ADD_DEBUG_MODULE_PARAM
(
Ãtdev
, 2, 
SLSI_NETDEV
);

69 
ADD_DEBUG_MODULE_PARAM
(
cfg80211
, 1, 
SLSI_CFG80211
);

70 
ADD_DEBUG_MODULE_PARAM
(
mlme
, 2, 
SLSI_MLME
);

71 
ADD_DEBUG_MODULE_PARAM
(
summ¬y_äames
, 0, 
SLSI_SUMMARY_FRAMES
);

72 
ADD_DEBUG_MODULE_PARAM
(
hyd¿
, 0, 
SLSI_HYDRA
);

73 
ADD_DEBUG_MODULE_PARAM
(
tx
, 0, 
SLSI_TX
);

74 
ADD_DEBUG_MODULE_PARAM
(
rx
, 0, 
SLSI_RX
);

75 
ADD_DEBUG_MODULE_PARAM
(
udi
, 2, 
SLSI_UDI
);

77 
ADD_DEBUG_MODULE_PARAM
(
wifi_fcq
, 0, 
SLSI_WIFI_FCQ
);

79 
ADD_DEBUG_MODULE_PARAM
(
h
, 0, 
SLSI_HIP
);

80 
ADD_DEBUG_MODULE_PARAM
(
h_š™_deš™
, 0, 
SLSI_HIP_INIT_DEINIT
);

81 
ADD_DEBUG_MODULE_PARAM
(
h_fw_dl
, 0, 
SLSI_HIP_FW_DL
);

82 
ADD_DEBUG_MODULE_PARAM
(
h_sdio_İ
, 0, 
SLSI_HIP_SDIO_OP
);

83 
ADD_DEBUG_MODULE_PARAM
(
h_ps
, 0, 
SLSI_HIP_PS
);

84 
ADD_DEBUG_MODULE_PARAM
(
h_th
, 0, 
SLSI_HIP_TH
);

85 
ADD_DEBUG_MODULE_PARAM
(
h_fh
, 0, 
SLSI_HIP_FH
);

86 
ADD_DEBUG_MODULE_PARAM
(
h_sig
, 0, 
SLSI_HIP_SIG
);

88 
ADD_DEBUG_MODULE_PARAM
(
func_Œaû
, 0, 
SLSI_FUNC_TRACE
);

89 
ADD_DEBUG_MODULE_PARAM
(
‹¡
, 0, 
SLSI_TEST
);

90 
ADD_DEBUG_MODULE_PARAM
(
¤c_sšk
, 0, 
SLSI_SRC_SINK
);

91 
ADD_DEBUG_MODULE_PARAM
(
fw_‹¡
, 0, 
SLSI_FW_TEST
);

92 
ADD_DEBUG_MODULE_PARAM
(
rx_ba
, 0, 
SLSI_RX_BA
);

94 
ADD_DEBUG_MODULE_PARAM
(
tdls
, 2, 
SLSI_TDLS
);

95 
ADD_DEBUG_MODULE_PARAM
(
gsÿn
, 3, 
SLSI_GSCAN
);

96 
ADD_DEBUG_MODULE_PARAM
(
mbulk
, 0, 
SLSI_MBULK
);

97 
ADD_DEBUG_MODULE_PARAM
(
æowc
, 0, 
SLSI_FLOWC
);

98 
ADD_DEBUG_MODULE_PARAM
(
sm­³r
, 0, 
SLSI_SMAPPER
);

99 
ADD_DEBUG_MODULE_PARAM
(
pm
, 0, 
SLSI_PM
);

102 
	g¦si_dbg_lvl_®l
;

104 *
	g¦si_dbg_f‹rs
[] = {

105 &
¦si_dbg_lvl_š™_deš™
,

106 &
¦si_dbg_lvl_Ãtdev
,

107 &
¦si_dbg_lvl_cfg80211
,

108 &
¦si_dbg_lvl_mlme
,

109 &
¦si_dbg_lvl_summ¬y_äames
,

110 &
¦si_dbg_lvl_hyd¿
,

111 &
¦si_dbg_lvl_tx
,

112 &
¦si_dbg_lvl_rx
,

113 &
¦si_dbg_lvl_udi
,

115 &
¦si_dbg_lvl_wifi_fcq
,

117 &
¦si_dbg_lvl_h
,

118 &
¦si_dbg_lvl_h_š™_deš™
,

119 &
¦si_dbg_lvl_h_fw_dl
,

120 &
¦si_dbg_lvl_h_sdio_İ
,

121 &
¦si_dbg_lvl_h_ps
,

122 &
¦si_dbg_lvl_h_th
,

123 &
¦si_dbg_lvl_h_fh
,

124 &
¦si_dbg_lvl_h_sig
,

126 &
¦si_dbg_lvl_func_Œaû
,

127 &
¦si_dbg_lvl_‹¡
,

128 &
¦si_dbg_lvl_¤c_sšk
,

129 &
¦si_dbg_lvl_fw_‹¡
,

130 &
¦si_dbg_lvl_rx_ba
,

132 &
¦si_dbg_lvl_tdls
,

133 &
¦si_dbg_lvl_gsÿn
,

134 &
¦si_dbg_lvl_mbulk
,

135 &
¦si_dbg_lvl_æowc
,

136 &
¦si_dbg_lvl_sm­³r
,

137 &
¦si_dbg_lvl_pm
,

140 
	g¦si_dbg_lvl_com·t_®l
;

141 
moduË_·¿m
(
¦si_dbg_lvl_com·t_®l
, , 
S_IRUGO
 | 
S_IWUSR
);

143 *
	g¦si_dbg_f‹rs
[] = {

144 &
¦si_dbg_lvl_com·t_®l
,

145 &
¦si_dbg_lvl_com·t_®l
,

146 &
¦si_dbg_lvl_com·t_®l
,

147 &
¦si_dbg_lvl_com·t_®l
,

148 &
¦si_dbg_lvl_com·t_®l
,

149 &
¦si_dbg_lvl_com·t_®l
,

150 &
¦si_dbg_lvl_com·t_®l
,

151 &
¦si_dbg_lvl_com·t_®l
,

152 &
¦si_dbg_lvl_com·t_®l
,

153 &
¦si_dbg_lvl_com·t_®l
,

154 &
¦si_dbg_lvl_com·t_®l
,

155 &
¦si_dbg_lvl_com·t_®l
,

156 &
¦si_dbg_lvl_com·t_®l
,

157 &
¦si_dbg_lvl_com·t_®l
,

158 &
¦si_dbg_lvl_com·t_®l
,

159 &
¦si_dbg_lvl_com·t_®l
,

160 &
¦si_dbg_lvl_com·t_®l
,

161 &
¦si_dbg_lvl_com·t_®l
,

162 &
¦si_dbg_lvl_com·t_®l
,

163 &
¦si_dbg_lvl_com·t_®l
,

164 &
¦si_dbg_lvl_com·t_®l
,

165 &
¦si_dbg_lvl_com·t_®l
,

166 &
¦si_dbg_lvl_com·t_®l
,

167 &
¦si_dbg_lvl_com·t_®l
,

168 &
¦si_dbg_lvl_com·t_®l
,

169 &
¦si_dbg_lvl_com·t_®l
,

170 &
¦si_dbg_lvl_com·t_®l
,

171 &
¦si_dbg_lvl_com·t_®l
,

172 &
¦si_dbg_lvl_com·t_®l
,

173 &
¦si_dbg_lvl_com·t_®l
,

174 &
¦si_dbg_lvl_com·t_®l
,

175 &
¦si_dbg_lvl_com·t_®l
,

176 &
¦si_dbg_lvl_com·t_®l
,

177 &
¦si_dbg_lvl_com·t_®l
,

178 &
¦si_dbg_lvl_com·t_®l
,

179 &
¦si_dbg_lvl_com·t_®l
,

180 &
¦si_dbg_lvl_com·t_®l
,

181 &
¦si_dbg_lvl_com·t_®l
,

182 &
¦si_dbg_lvl_com·t_®l
,

183 &
¦si_dbg_lvl_com·t_®l
,

184 &
¦si_dbg_lvl_com·t_®l
,

185 &
¦si_dbg_lvl_com·t_®l
,

186 &
¦si_dbg_lvl_com·t_®l
,

187 &
¦si_dbg_lvl_com·t_®l
,

188 &
¦si_dbg_lvl_com·t_®l
,

189 &
¦si_dbg_lvl_com·t_®l
,

190 &
¦si_dbg_lvl_com·t_®l
,

191 &
¦si_dbg_lvl_com·t_®l
,

192 &
¦si_dbg_lvl_com·t_®l
,

193 &
¦si_dbg_lvl_com·t_®l
,

194 &
¦si_dbg_lvl_com·t_®l
,

195 &
¦si_dbg_lvl_com·t_®l
,

196 &
¦si_dbg_lvl_com·t_®l
,

197 &
¦si_dbg_lvl_com·t_®l
,

198 &
¦si_dbg_lvl_com·t_®l
,

199 &
¦si_dbg_lvl_com·t_®l
,

200 &
¦si_dbg_lvl_com·t_®l
,

201 &
¦si_dbg_lvl_com·t_®l
,

202 &
¦si_dbg_lvl_com·t_®l
,

203 &
¦si_dbg_lvl_com·t_®l
,

204 &
¦si_dbg_lvl_com·t_®l
,

205 &
¦si_dbg_lvl_com·t_®l
,

206 &
¦si_dbg_lvl_com·t_®l
,

207 &
¦si_dbg_lvl_com·t_®l
,

208 &
¦si_dbg_lvl_com·t_®l
,

209 &
¦si_dbg_lvl_com·t_®l
,

210 &
¦si_dbg_lvl_com·t_®l
,

211 &
¦si_dbg_lvl_com·t_®l
,

212 &
¦si_dbg_lvl_com·t_®l
,

213 &
¦si_dbg_lvl_com·t_®l
,

214 &
¦si_dbg_lvl_com·t_®l
,

215 &
¦si_dbg_lvl_com·t_®l
,

216 &
¦si_dbg_lvl_com·t_®l
,

217 &
¦si_dbg_lvl_com·t_®l
,

218 &
¦si_dbg_lvl_com·t_®l
,

221 
	g¦si_dbg_lvl_®l
;

224 cÚ¡ 
	gSLSI_DF_MAX
 = ((
¦si_dbg_f‹rs
) / (slsi_dbg_filters[0]));

226 cÚ¡ 
	gSLSI_OVERRIDE_ALL_FILTER
 = -1;

229 
	$¦si_dec¡r_to_št
(cÚ¡ *
dec_¡r
, *
»s
)

231 
tmp_»s
 = 0;

232 
sign
 = 0;

233 cÚ¡ *
tmp_ch¬
 = 
dec_¡r
;

235 
sign
 = (*
tmp_ch¬
 == '-') ? -1 : ((*tmp_char == '+') ? 1 : 0);

236 ià(
sign
 != 0)

237 
tmp_ch¬
++;

239 *
tmp_ch¬
) {

240 ià(*
tmp_ch¬
 == '\n')

242 ià((*
tmp_ch¬
 < '0') || (*tmp_char > '9'))

244 
tmp_»s
 =mp_» * 10 + (*
tmp_ch¬
 - '0');

245 
tmp_ch¬
++;

248 *
»s
 = (
sign
 < 0è? (-
tmp_»s
) :mp_res;

250 
	}
}

252 
	$¦si_dbg_£t_·¿m_cb
(cÚ¡ *
v®
, cÚ¡ 
k”Ãl_·¿m
 *
kp
)

254 
Ãw_v®
;

255 
f‹r
;

257 ià(
	`¦si_dec¡r_to_št
(
v®
, &
Ãw_v®
) < 0) {

258 
	`´_šfo
("%s: faedØcÚv”ˆ% tØšt\n", 
__func__
, 
v®
);

261 
f‹r
 = *((*)(
kp
->
¬g
));

263 ià(
f‹r
 < -1 || f‹¸>ğ
SLSI_DF_MAX
) {

264 
	`´_šfo
("%s: f‹¸%d ouˆoà¿nge\n", 
__func__
, 
f‹r
);

268 ià(
f‹r
 =ğ
SLSI_OVERRIDE_ALL_FILTER
) {

269 ià(
Ãw_v®
 == -1) {

270 
	`´_šfo
("Ov”riddÛ nÙakefãù beÿu£ slsi_dbg_lvl_®l=%d\n", 
Ãw_v®
);

272 
i
;

274 
	`´_šfo
("S‘tšg‡Î debug moduË tØËv– %d\n", 
Ãw_v®
);

275 
i
 = 0; i < 
SLSI_DF_MAX
; i++)

276 *
¦si_dbg_f‹rs
[
i
] = 
Ãw_v®
;

278 
¦si_dbg_lvl_®l
 = 
Ãw_v®
;

281 
	`´_šfo
("S‘tšg debug moduË %dØËv– %d\n", 
f‹r
, 
Ãw_v®
);

282 *
¦si_dbg_f‹rs
[
f‹r
] = 
Ãw_v®
;

286 
	}
}

288 
	$¦si_dbg_g‘_·¿m_cb
(*
bufãr
, cÚ¡ 
k”Ãl_·¿m
 *
kp
)

290 
	#KERN_PARAM_OPS_MAX_BUF_SIZE
 (4 * 1024)

	)

291 
f‹r
;

292 
v®
 = 0;

294 
f‹r
 = *((*)(
kp
->
¬g
));

296 ià(
f‹r
 =ğ
SLSI_OVERRIDE_ALL_FILTER
)

297 
v®
 = 
¦si_dbg_lvl_®l
;

298 ià(
f‹r
 < 0 || f‹¸>ğ
SLSI_DF_MAX
)

299 
	`´_šfo
("%s: f‹¸%d ouˆoà¿nge\n", 
__func__
, 
f‹r
);

301 
v®
 = *
¦si_dbg_f‹rs
[
f‹r
];

303  
	`¢´štf
(
bufãr
, 
KERN_PARAM_OPS_MAX_BUF_SIZE
, "%i", 
v®
);

304 
	}
}

306 
moduË_·¿m_cb
(
¦si_dbg_lvl_®l
, &
·¿m_İs_log
, (*)&
SLSI_OVERRIDE_ALL_FILTER
, 
S_IRUGO
 | 
S_IWUSR
);

307 
MODULE_PARM_DESC
(
¦si_dbg_lvl_®l
, "Override debug†evel (0~4) for‡llhe†og modules (-1 = do‚ot override) default=0");

	@debug.h

7 #iâdeà
__DEBUG_H__


8 
	#__DEBUG_H__


	)

10 
	~<lšux/k”Ãl.h
>

11 
	~"dev.h
"

12 
	~<scsc/scsc_logršg.h
>

17 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


18 #iâdeà
MAC2STR


19 
	#MAC2STR
(
a
è×)[0], (a)[1], (a)[2], (a)[3], (a)[4], (a)[5]

	)

20 
	#MACSTR
 "%02x:%02x:%02x:%02x:%02x:%02x"

	)

23 #iâdeà
MAC2STR


24 
	#MAC2STR
(
a
è×)[0], (a)[4], (a)[5]

	)

25 
	#MACSTR
 "%02x:**:**:**:%02x:%02x"

	)

29 #iâdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


30 cÚ¡ 
SLSI_INIT_DEINIT
;

31 cÚ¡ 
SLSI_NETDEV
;

32 cÚ¡ 
SLSI_CFG80211
;

33 cÚ¡ 
SLSI_MLME
;

34 cÚ¡ 
SLSI_SUMMARY_FRAMES
;

35 cÚ¡ 
SLSI_HYDRA
;

36 cÚ¡ 
SLSI_TX
;

37 cÚ¡ 
SLSI_RX
;

38 cÚ¡ 
SLSI_UDI
;

40 cÚ¡ 
SLSI_WIFI_FCQ
;

42 cÚ¡ 
SLSI_HIP
;

43 cÚ¡ 
SLSI_HIP_INIT_DEINIT
;

44 cÚ¡ 
SLSI_HIP_FW_DL
;

45 cÚ¡ 
SLSI_HIP_SDIO_OP
;

46 cÚ¡ 
SLSI_HIP_PS
;

47 cÚ¡ 
SLSI_HIP_TH
;

48 cÚ¡ 
SLSI_HIP_FH
;

49 cÚ¡ 
SLSI_HIP_SIG
;

51 cÚ¡ 
SLSI_FUNC_TRACE
;

52 cÚ¡ 
SLSI_TEST
;

53 cÚ¡ 
SLSI_SRC_SINK
;

54 cÚ¡ 
SLSI_FW_TEST
;

55 cÚ¡ 
SLSI_RX_BA
;

57 cÚ¡ 
SLSI_TDLS
;

58 cÚ¡ 
SLSI_GSCAN
;

59 cÚ¡ 
SLSI_MBULK
;

60 cÚ¡ 
SLSI_FLOWC
;

61 cÚ¡ 
SLSI_SMAPPER
;

62 cÚ¡ 
SLSI_PM
;

65 *
¦si_dbg_f‹rs
[];

67 #iâdeà
´_w¬n


68 
	#´_w¬n
 
´_w¬nšg


	)

78 
	#SLSI_EWI_NODEV_LABEL
 "›“80211…hy.: "

	)

79 
	#SLSI_EWI_DEV
(
sdev
è(
	`lik–y
((sdevè&& ((sdev)->
why
)è? &((sdev)->why->
dev
è: 
NULL
)

	)

80 
	#SLSI_EWI_NET_DEV
(
ndev
è(
	`lik–y
Òdevè? 
	`SLSI_EWI_DEV
(((
Ãtdev_vif
 *)
	`Ãtdev_´iv
Òdev))->
sdev
è: 
NULL
)

	)

81 
	#SLSI_EWI_NET_NAME
(
ndev
è(
	`lik–y
Òdevè? 
	`Ãtdev_Çme
Òdevè: 
NULL
)

	)

83 
	#SLSI_EWI
(
ouut
, 
sdev
, 
Ïb–
, 
fmt
, 
¬g
 ...è
	`ouut
(
	`SLSI_EWI_DEV
(sdev), 
SCSC_PREFIX
†ab– ": %s: " fmt, 
__func__
, ##‡rg)

	)

84 
	#SLSI_EWI_NET
(
ouut
, 
ndev
, 
Ïb–
, 
fmt
, 
¬g
 ...è
	`ouut
(
	`SLSI_EWI_NET_DEV
Òdev), 
SCSC_PREFIX
 "%s: "†ab– ": %s: " fmt, 
	`SLSI_EWI_NET_NAME
Òdev), 
__func__
, ##‡rg)

	)

85 
	#SLSI_EWI_NODEV
(
ouut
, 
Ïb–
, 
fmt
, 
¬g
 ...è
	`ouut
(
SLSI_EWI_NODEV_LABEL
 
SCSC_PREFIX
†ab– ": %s: " fmt, 
__func__
, ##‡rg)

	)

87 
	#SLSI_EWI_HEX
(
ouut
, 
kËv–
, 
sdev
, 
Ïb–
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

89 
	`SLSI_EWI
(
ouut
, 
sdev
, 
Ïb–
, 
fmt
, ## 
¬g
); \

90 
	`´št_hex_dump
(
kËv–
, 
SCSC_PREFIX
, 
DUMP_PREFIX_OFFSET
, 16, 1, 
p
, 
Ën
, 0); \

91 } 0)

	)

93 
	#SLSI_EWI_HEX_NET
(
ouut
, 
kËv–
, 
dev
, 
Ïb–
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

95 
	`SLSI_EWI_NET
(
ouut
, 
dev
, 
Ïb–
, 
fmt
, ## 
¬g
); \

96 
	`´št_hex_dump
(
kËv–
, 
SCSC_PREFIX
, 
DUMP_PREFIX_OFFSET
, 16, 1, 
p
, 
Ën
, 0); \

97 } 0)

	)

99 
	#SLSI_EWI_HEX_NODEV
(
ouut
, 
kËv–
, 
Ïb–
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

101 
	`SLSI_EWI_NODEV
(
ouut
, 
Ïb–
, 
fmt
, ## 
¬g
); \

102 
	`´št_hex_dump
(
kËv–
, 
SCSC_PREFIX
, 
DUMP_PREFIX_OFFSET
, 16, 1, 
p
, 
Ën
, 0); \

103 } 0)

	)

105 
	#SLSI_ERR
(
sdev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI
(
dev_”r
, sdev, "E", fmt, ##‡rg)

	)

106 
	#SLSI_WARN
(
sdev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI
(
dev_w¬n
, sdev, "W", fmt, ##‡rg)

	)

107 
	#SLSI_INFO
(
sdev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI
(
dev_šfo
, sdev, "I", fmt, ##‡rg)

	)

109 
	#SLSI_NET_ERR
(
ndev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_NET
(
dev_”r
,‚dev, "E", fmt, ##‡rg)

	)

110 
	#SLSI_NET_WARN
(
ndev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_NET
(
dev_w¬n
,‚dev, "W", fmt, ##‡rg)

	)

111 
	#SLSI_NET_INFO
(
ndev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_NET
(
dev_šfo
,‚dev, "I", fmt, ##‡rg)

	)

113 
	#SLSI_ERR_NODEV
(
fmt
, 
¬g
 ...è
	`SLSI_EWI_NODEV
(
´_”r
, "E", fmt, ##‡rg)

	)

114 
	#SLSI_WARN_NODEV
(
fmt
, 
¬g
 ...è
	`SLSI_EWI_NODEV
(
´_w¬n
, "W", fmt, ##‡rg)

	)

115 
	#SLSI_INFO_NODEV
(
fmt
, 
¬g
 ...è
	`SLSI_EWI_NODEV
(
´_šfo
, "I", fmt, ##‡rg)

	)

117 
	#SLSI_ERR_HEX
(
sdev
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX
(
dev_”r
, 
KERN_ERR
, sdev, "E",…,†’, fmt, ##‡rg)

	)

118 
	#SLSI_WARN_HEX
(
sdev
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX
(
dev_w¬n
, 
KERN_WARN
, sdev, "W",…,†’, fmt, ##‡rg)

	)

119 
	#SLSI_INFO_HEX
(
sdev
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX
(
dev_šfo
, 
KERN_INFO
, sdev, "I",…,†’, fmt, ##‡rg)

	)

121 
	#SLSI_ERR_HEX_NODEV
(
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX_NODEV
(
´_”r
, 
KERN_ERR
, "E",…,†’, fmt, ##‡rg)

	)

122 
	#SLSI_WARN_HEX_NODEV
(
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX_NODEV
(
´_w¬n
, 
KERN_WARN
, "W",…,†’, fmt, ##‡rg)

	)

123 
	#SLSI_INFO_HEX_NODEV
(
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX_NODEV
(
´_šfo
, 
KERN_INFO
, "I",…,†’, fmt, ##‡rg)

	)

125 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


127 
	#SLSI_DBG
(
sdev
, 
f‹r
, 
dbg_lvl
, 
fmt
, 
¬g
 ...) \

129 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

130 
	`SLSI_EWI
(
dev_šfo
, 
sdev
, #dbg_lvl, 
fmt
, ## 
¬g
); \

132 } 0)

	)

134 
	#SLSI_DBG_NET
(
ndev
, 
f‹r
, 
dbg_lvl
, 
fmt
, 
¬g
 ...) \

136 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

137 
	`SLSI_EWI_NET
(
dev_šfo
, 
ndev
, #dbg_lvl, 
fmt
, ## 
¬g
); \

139 } 0)

	)

141 
	#SLSI_DBG_NODEV
(
f‹r
, 
dbg_lvl
, 
fmt
, 
¬g
 ...) \

143 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

144 
	`SLSI_EWI_NODEV
(
´_šfo
, #dbg_lvl, 
fmt
, ## 
¬g
); \

146 } 0)

	)

148 
	#SLSI_DBG1
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 1, fmt, ##‡rg)

	)

149 
	#SLSI_DBG2
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 2, fmt, ##‡rg)

	)

150 
	#SLSI_DBG3
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 3, fmt, ##‡rg)

	)

151 
	#SLSI_DBG4
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 4, fmt, ##‡rg)

	)

153 
	#SLSI_NET_DBG1
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 1, fmt, ##‡rg)

	)

154 
	#SLSI_NET_DBG2
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 2, fmt, ##‡rg)

	)

155 
	#SLSI_NET_DBG3
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 3, fmt, ##‡rg)

	)

156 
	#SLSI_NET_DBG4
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 4, fmt, ##‡rg)

	)

158 
	#SLSI_DBG1_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 1, fmt, ##‡rg)

	)

159 
	#SLSI_DBG2_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 2, fmt, ##‡rg)

	)

160 
	#SLSI_DBG3_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 3, fmt, ##‡rg)

	)

161 
	#SLSI_DBG4_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 4, fmt, ##‡rg)

	)

164 
	#LOG_CONDITIONALLY
(
cÚd™iÚ
, 
LOG_ENTRY
) \

166 ià(
	`uÆik–y
(
cÚd™iÚ
)) \

167 
LOG_ENTRY
; \

168 } 0)

	)

171 
	#LOG_BOOL_FLAG
(
æag
) \

172 (
æag
è? "TRUE" : "FALSE"

	)

174 
	#SLSI_DBG_HEX_OUT
(
sdev
, 
f‹r
, 
dbg_lvl
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

176 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

177 
	`SLSI_EWI_HEX
(
dev_šfo
, 
KERN_INFO
, 
sdev
, #dbg_lvl, 
p
, 
Ën
, 
fmt
, ## 
¬g
); \

179 } 0)

	)

181 
	#SLSI_DBG_HEX_OUT_NET
(
sdev
, 
f‹r
, 
dbg_lvl
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

183 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

184 
	`SLSI_EWI_HEX_NET
(
dev_šfo
, 
KERN_INFO
, 
dev
, #dbg_lvl, 
p
, 
Ën
, 
fmt
, ## 
¬g
); \

186 } 0)

	)

188 
	#SLSI_DBG_HEX_OUT_NODEV
(
f‹r
, 
dbg_lvl
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

190 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

191 
	`SLSI_EWI_HEX_NODEV
(
´_šfo
, 
KERN_INFO
, #dbg_lvl, 
p
, 
Ën
, 
fmt
, ## 
¬g
); \

193 } 0)

	)

195 
	#SLSI_DBG_HEX
(
sdev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_HEX_OUT
(sdev, f‹r, 4,…,†’, fmt, ##‡rg)

	)

196 
	#SLSI_NET_DBG_HEX
(
dev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_HEX_OUT_NET
(dev, f‹r, 4,…,†’, fmt, ##‡rg)

	)

197 
	#SLSI_DBG_HEX_NODEV
(
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_HEX_OUT_NODEV
(f‹r, 4,…,†’, fmt, ##‡rg)

	)

199 
	#FUNC_ENTER
(
sdev
è
	`SLSI_DBG4
(sdev, 
SLSI_FUNC_TRACE
, "--->\n")

	)

200 
	#FUNC_EXIT
(
sdev
è
	`SLSI_DBG4
(sdev, 
SLSI_FUNC_TRACE
, "<---\n")

	)

202 
	#FUNC_ENTER_NODEV
(è
	`SLSI_DBG4_NODEV
(
SLSI_FUNC_TRACE
, "--->\n")

	)

203 
	#FUNC_EXIT_NODEV
(è
	`SLSI_DBG4_NODEV
(
SLSI_FUNC_TRACE
, "<---\n")

	)

205 
¦si_debug_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, cÚ¡ *
´efix
);

208 
	#SLSI_DBG1
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

209 
	#SLSI_DBG2
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

210 
	#SLSI_DBG3
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

211 
	#SLSI_DBG4
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

212 
	#SLSI_NET_DBG1
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

213 
	#SLSI_NET_DBG2
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

214 
	#SLSI_NET_DBG3
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

215 
	#SLSI_NET_DBG4
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

216 
	#SLSI_DBG1_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

217 
	#SLSI_DBG2_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

218 
	#SLSI_DBG3_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

219 
	#SLSI_DBG4_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

221 
	#LOG_CONDITIONALLY
(
cÚd™iÚ
, 
LOG_ENTRY
èdØ{} 0)

	)

222 
	#LOG_BOOL_FLAG
(
æag
èdØ{} 0)

	)

224 
	#SLSI_DBG_HEX
(
sdev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

225 
	#SLSI_NET_DBG_HEX
(
dev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

226 
	#SLSI_DBG_HEX_NODEV
(
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

228 
	#FUNC_ENTER
(
sdev
)

	)

229 
	#FUNC_EXIT
(
sdev
)

	)

231 
	#FUNC_ENTER_NODEV
()

	)

232 
	#FUNC_EXIT_NODEV
()

	)

234 
šlše
 
	$¦si_debug_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, cÚ¡ *
´efix
)

236 ()
sdev
;

237 ()
dev
;

238 ()
skb
;

239 ()
´efix
;

240 
	}
}

244 #ifdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


246 #undeà
SLSI_ERR


247 #undeà
SLSI_WARN


248 #undeà
SLSI_INFO


249 
	#SLSI_ERR
(
sdev
, 
fmt
, 
¬g
 ...è
	`SCSC_ERR_SDEV
(sdev, fmt, ##‡rg)

	)

250 
	#SLSI_WARN
(
sdev
, 
fmt
, 
¬g
 ...è
	`SCSC_WARNING_SDEV
(sdev, fmt, ##‡rg)

	)

251 
	#SLSI_INFO
(
sdev
, 
fmt
, 
¬g
 ...è
	`SCSC_INFO_SDEV
(sdev, fmt, ##‡rg)

	)

253 #undeà
SLSI_NET_ERR


254 #undeà
SLSI_NET_WARN


255 #undeà
SLSI_NET_INFO


256 
	#SLSI_NET_ERR
(
ndev
, 
fmt
, 
¬g
 ...è
	`SCSC_ERR_NDEV
Òdev, fmt, ##‡rg)

	)

257 
	#SLSI_NET_WARN
(
ndev
, 
fmt
, 
¬g
 ...è
	`SCSC_WARNING_NDEV
Òdev, fmt, ##‡rg)

	)

258 
	#SLSI_NET_INFO
(
ndev
, 
fmt
, 
¬g
 ...è
	`SCSC_INFO_NDEV
Òdev, fmt, ##‡rg)

	)

260 #undeà
SLSI_ERR_NODEV


261 #undeà
SLSI_WARN_NODEV


262 #undeà
SLSI_INFO_NODEV


263 
	#SLSI_ERR_NODEV
(
fmt
, 
¬g
 ...è
	`SCSC_ERR
(fmt, ##‡rg)

	)

264 
	#SLSI_WARN_NODEV
(
fmt
, 
¬g
 ...è
	`SCSC_WARNING
(fmt, ##‡rg)

	)

265 
	#SLSI_INFO_NODEV
(
fmt
, 
¬g
 ...è
	`SCSC_INFO
(fmt, ##‡rg)

	)

267 #undeà
SLSI_DBG1


268 #undeà
SLSI_DBG2


269 #undeà
SLSI_DBG3


270 #undeà
SLSI_DBG4


271 
	#SLSI_DBG1
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG1_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

272 
	#SLSI_DBG2
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG2_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

273 
	#SLSI_DBG3
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG3_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

274 
	#SLSI_DBG4
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG4_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

276 #undeà
SLSI_NET_DBG1


277 #undeà
SLSI_NET_DBG2


278 #undeà
SLSI_NET_DBG3


279 #undeà
SLSI_NET_DBG4


280 
	#SLSI_NET_DBG1
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG1_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

281 
	#SLSI_NET_DBG2
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG2_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

282 
	#SLSI_NET_DBG3
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG3_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

283 
	#SLSI_NET_DBG4
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG4_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

285 #undeà
SLSI_DBG1_NODEV


286 #undeà
SLSI_DBG2_NODEV


287 #undeà
SLSI_DBG3_NODEV


288 #undeà
SLSI_DBG4_NODEV


289 
	#SLSI_DBG1_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG1
(f‹r, fmt, ##‡rg)

	)

290 
	#SLSI_DBG2_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG2
(f‹r, fmt, ##‡rg)

	)

291 
	#SLSI_DBG3_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG3
(f‹r, fmt, ##‡rg)

	)

292 
	#SLSI_DBG4_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG4
(f‹r, fmt, ##‡rg)

	)

	@debug_frame.c

7 
	~<lšux/›“80211.h
>

8 
	~<lšux/¿‹lim™.h
>

10 
	~"debug.h
"

11 
	~"çpi.h
"

12 
	~"cÚ¡.h
"

13 
	~"mgt.h
"

15 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


18 
	g¦si_debug_summ¬y_äame
 = 3;

19 
moduË_·¿m
(
¦si_debug_summ¬y_äame
, , 
S_IRUGO
 | 
S_IWUSR
);

20 
MODULE_PARM_DESC
(
¦si_debug_summ¬y_äame
, "Debug†evel (0: disable, 1: mgmt only (no scan), 2: mgmt‡nd imp frames, 3:‡ll");

22 
	s¦si_decode_’Œy
 {

23 cÚ¡ *
	mÇme
;

24 (*
	mdecode_â
)(
u8
 *
	mäame
, 
u16
 
	mäame_Ëngth
, *
	m»suÉ
, 
size_t
 
	m»suÉ_Ëngth
);

27 
	s¦si_decode_¢­
 {

28 cÚ¡ 
u8
 
	m¢­
[8];

29 cÚ¡ *
	mÇme
;

30 
size_t
 (*
decode_â
)(
u8
 *
	mäame
, 
u16
 
	mäame_Ëngth
, *
	m»suÉ
, size_ˆ
	m»suÉ_Ëngth
);

33 
	s¦si_v®ue_Çme_decode
 {

34 cÚ¡ 
u16
 
	mv®ue
;

35 cÚ¡ *
	mÇme
;

36 
size_t
 (*
decode_â
)(
u8
 *
	mäame
, 
u16
 
	mäame_Ëngth
, *
	m»suÉ
, size_ˆ
	m»suÉ_Ëngth
);

39 
size_t
 
	$¦si_decode_basic_›_šfo
(
u8
 *
›s
, 
u16
 
›s_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

41 
size_t
 
size_wr™‹n
 = 0;

42 cÚ¡ 
u8
 *
ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
›s
, 
›s_Ëngth
);

43 cÚ¡ 
u8
 *
r¢
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
›s
, 
›s_Ëngth
);

44 cÚ¡ 
u8
 *
w·
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
›s
, 
›s_Ëngth
);

45 cÚ¡ 
u8
 *
wps
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
›s
, 
›s_Ëngth
);

46 cÚ¡ 
u8
 *
htİ
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
›s
, 
›s_Ëngth
);

47 cÚ¡ 
u8
 *
couÁry
 = 
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
›s
, 
›s_Ëngth
);

49 ià(
htİ
 && htop[1]) {

50 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " chªÃl:%d", 
htİ
[2]);

52 cÚ¡ 
u8
 *
ds
 = 
	`cfg80211_fšd_›
(
WLAN_EID_DS_PARAMS
, 
›s
, 
›s_Ëngth
);

54 ià(
ds
)

55 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " chªÃl:%d", 
ds
[2]);

58 ià(
ssid
) {

59 ià(
ssid
[1])

60 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " %.*s", 
ssid
[1], (*)&ssid[2]);

62 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " <HIDDEN>");

65 ià(
couÁry
)

66 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " couÁry:%c%c%c", 
couÁry
[2], country[3], country[4]);

67 ià(
w·
)

68 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " wpa");

69 ià(
r¢
)

70 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " wpa2");

71 ià(
wps
)

72 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " wps");

73  
size_wr™‹n
;

74 
	}
}

76 
	$¦si_decode_äame_›s_Úly
(
u8
 
off£t
, u8 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

78 
size_t
 
¡r_Ën
;

80 
»suÉ
[0] = '(';

81 
¡r_Ën
 = 
	`¦si_decode_basic_›_šfo
(
äame
 + 
off£t
,

82 
äame_Ëngth
 - 
off£t
,

83 
»suÉ
 + 1,

84 
»suÉ_Ëngth
 - 1);

85 
»suÉ
[1 + 
¡r_Ën
] = ')';

86 
»suÉ
[2 + 
¡r_Ën
] = '\0';

87 
	}
}

89 
size_t
 
	$¦si_decode_äame_Ëu16
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
, cÚ¡ *
Çme
)

91 
u16
 
v®ue
 = 
äame
[0] | frame[1] << 8;

93 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

95  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "%s:%u", 
Çme
, 
v®ue
);

96 
	}
}

98 
	#SLSI_ASSOC_REQ_IE_OFFSET
 4

	)

99 
	$¦si_decode_assoc_»q
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

101 
	`¦si_decode_äame_›s_Úly
(
SLSI_ASSOC_REQ_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

102 
	}
}

104 
	#SLSI_ASSOC_RSP_STATUS_OFFSET
 2

	)

105 
	#SLSI_ASSOC_RSP_IE_OFFSET
 6

	)

106 
	$¦si_decode_assoc_r¥
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

108 
size_t
 
¡r_Ën
 = 0;

110 
»suÉ
[
¡r_Ën
++] = '(';

111 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_ASSOC_RSP_STATUS_OFFSET
,

112 
äame_Ëngth
 - 
SLSI_ASSOC_RSP_STATUS_OFFSET
,

113 
»suÉ
 + 
¡r_Ën
,

114 
»suÉ_Ëngth
 - 
¡r_Ën
,

116 
¡r_Ën
 +ğ
	`¦si_decode_basic_›_šfo
(
äame
 + 
SLSI_ASSOC_RSP_IE_OFFSET
,

117 
äame_Ëngth
 - 
SLSI_ASSOC_RSP_IE_OFFSET
,

118 
»suÉ
 + 
¡r_Ën
,

119 
»suÉ_Ëngth
 - 
¡r_Ën
);

120 
»suÉ
[
¡r_Ën
++] = ')';

121 
»suÉ
[
¡r_Ën
] = '\0';

122 
	}
}

124 
	#SLSI_DEAUTH_REASON_OFFSET
 0

	)

125 
	$¦si_decode_d—uth
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

127 
size_t
 
¡r_Ën
 = 0;

129 
»suÉ
[
¡r_Ën
++] = '(';

130 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_DEAUTH_REASON_OFFSET
,

131 
äame_Ëngth
 - 
SLSI_DEAUTH_REASON_OFFSET
,

132 
»suÉ
 + 
¡r_Ën
,

133 
»suÉ_Ëngth
 - 
¡r_Ën
,

135 
»suÉ
[
¡r_Ën
++] = ')';

136 
»suÉ
[
¡r_Ën
] = '\0';

137 
	}
}

139 
	#SLSI_AUTH_ALGO_OFFSET
 0

	)

140 
	#SLSI_AUTH_SEQ_OFFSET
 2

	)

141 
	#SLSI_AUTH_STATUS_OFFSET
 4

	)

142 
	$¦si_decode_auth
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

144 
size_t
 
¡r_Ën
 = 0;

146 
»suÉ
[
¡r_Ën
++] = '(';

147 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_AUTH_ALGO_OFFSET
,

148 
äame_Ëngth
 - 
SLSI_AUTH_ALGO_OFFSET
,

149 
»suÉ
 + 
¡r_Ën
,

150 
»suÉ_Ëngth
 - 
¡r_Ën
,

152 
»suÉ
[
¡r_Ën
++] = ' ';

153 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_AUTH_SEQ_OFFSET
,

154 
äame_Ëngth
 - 
SLSI_AUTH_SEQ_OFFSET
,

155 
»suÉ
 + 
¡r_Ën
,

156 
»suÉ_Ëngth
 - 
¡r_Ën
,

158 
»suÉ
[
¡r_Ën
++] = ' ';

159 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_AUTH_STATUS_OFFSET
,

160 
äame_Ëngth
 - 
SLSI_AUTH_STATUS_OFFSET
,

161 
»suÉ
 + 
¡r_Ën
,

162 
»suÉ_Ëngth
 - 
¡r_Ën
,

164 
»suÉ
[
¡r_Ën
++] = ' ';

165 
»suÉ
[
¡r_Ën
++] = ')';

166 
»suÉ
[
¡r_Ën
] = '\0';

167 
	}
}

169 
	#SLSI_REASSOC_IE_OFFSET
 10

	)

170 
	$¦si_decode_»assoc_»q
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

172 
	`¦si_decode_äame_›s_Úly
(
SLSI_REASSOC_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

173 
	}
}

175 
	#SLSI_BEACON_IE_OFFSET
 12

	)

176 
	$¦si_decode_b—cÚ
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

178 
	`¦si_decode_äame_›s_Úly
(
SLSI_BEACON_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

179 
	}
}

181 
	#SLSI_PROBEREQ_IE_OFFSET
 0

	)

182 
	$¦si_decode_´obe_»q
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

184 
	`¦si_decode_äame_›s_Úly
(
SLSI_PROBEREQ_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

185 
	}
}

187 
	#SLSI_ACTION_BLOCK_ACK_ADDBA_REQ
 0

	)

188 
	#SLSI_ACTION_BLOCK_ACK_ADDBA_RSP
 1

	)

189 
	#SLSI_ACTION_BLOCK_ACK_DELBA
 2

	)

190 
size_t
 
	$¦si_decode_aùiÚ_blockack
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

192 
u8
 
aùiÚ
 = 
äame
[1];

194 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

196 
aùiÚ
) {

197 
SLSI_ACTION_BLOCK_ACK_ADDBA_REQ
:

199 
u8
 
tok’
 = 
äame
[2];

201  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ADDBAReqÑok’:%u)", 
tok’
);

203 
SLSI_ACTION_BLOCK_ACK_ADDBA_RSP
:

205 
u8
 
tok’
 = 
äame
[2];

206 
u16
 
¡©us
 = 
äame
[3] | frame[4] << 8;

208  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ADDBAR¥Ñok’:%u, stus:%u)", 
tok’
, 
¡©us
);

210 
SLSI_ACTION_BLOCK_ACK_DELBA
:

212 
u16
 
»asÚ_code
 = 
äame
[4] | frame[5] << 8;

214  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->DELBAÔ—sÚ_code:%u)", 
»asÚ_code
);

217  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->AùiÚ(%u)", 
aùiÚ
);

219 
	}
}

221 
	#SLSI_ACTION_PUBLIC_DISCOVERY_RSP
 14

	)

223 
size_t
 
	$¦si_decode_aùiÚ_public
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

225 
u8
 
aùiÚ
 = 
äame
[1];

227 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

229 
aùiÚ
) {

230 
SLSI_ACTION_PUBLIC_DISCOVERY_RSP
:

232 
u8
 
tok’
 = 
äame
[2];

234  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->Discov”yR¥Ñok’:%u)", 
tok’
);

237  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->AùiÚ(%u)", 
aùiÚ
);

239 
	}
}

241 
	#SLSI_ACTION_TDLS_SETUP_REQ
 0

	)

242 
	#SLSI_ACTION_TDLS_SETUP_RSP
 1

	)

243 
	#SLSI_ACTION_TDLS_SETUP_CFM
 2

	)

244 
	#SLSI_ACTION_TDLS_TEARDOWN
 3

	)

245 
	#SLSI_ACTION_TDLS_PEER_TRAFFIC_IND
 4

	)

246 
	#SLSI_ACTION_TDLS_CHANNEL_SWITCH_REQ
 5

	)

247 
	#SLSI_ACTION_TDLS_CHANNEL_SWITCH_RSP
 6

	)

248 
	#SLSI_ACTION_TDLS_PEER_PSM_REQ
 7

	)

249 
	#SLSI_ACTION_TDLS_PEER_PSM_RSP
 8

	)

250 
	#SLSI_ACTION_TDLS_PEER_TRAFFIC_RSP
 9

	)

251 
	#SLSI_ACTION_TDLS_DISCOVERY_REQ
 10

	)

253 
size_t
 
	$¦si_decode_aùiÚ_tdls
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

255 
u8
 
aùiÚ
 = 
äame
[1];

257 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

259 
aùiÚ
) {

260 
SLSI_ACTION_TDLS_SETUP_REQ
:

262 
u8
 
tok’
 = 
äame
[2];

264  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upReqÑok’:%u)", 
tok’
);

266 
SLSI_ACTION_TDLS_SETUP_RSP
:

268 
u16
 
¡©us
 = 
äame
[2] | frame[3] << 8;

269 
u8
 
tok’
 = 
äame
[4];

271  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upR¥Ñok’:%u, stus:%u)", 
tok’
, 
¡©us
);

273 
SLSI_ACTION_TDLS_SETUP_CFM
:

275 
u16
 
¡©us
 = 
äame
[2] | frame[3] << 8;

276 
u8
 
tok’
 = 
äame
[4];

278  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upCfmÑok’:%u, stus:%u)", 
tok’
, 
¡©us
);

280 
SLSI_ACTION_TDLS_TEARDOWN
:

282 
u16
 
»asÚ
 = 
äame
[2] | frame[3] << 8;

284  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upCfmÔ—sÚ:%u)", 
»asÚ
);

286 
SLSI_ACTION_TDLS_PEER_TRAFFIC_IND
:

288 
u8
 
tok’
 = 
äame
[2];

290  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rT¿fficIndÑok’:%u)", 
tok’
);

292 
SLSI_ACTION_TDLS_CHANNEL_SWITCH_REQ
:

294 
u8
 
chªÃl
 = 
äame
[2];

296  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ChªÃlSw™chReq(chªÃl:%u)", 
chªÃl
);

298 
SLSI_ACTION_TDLS_CHANNEL_SWITCH_RSP
:

300 
u16
 
¡©us
 = 
äame
[2] | frame[3] << 8;

302  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ChªÃlSw™chR¥(¡©us:%u)", 
¡©us
);

304 
SLSI_ACTION_TDLS_PEER_PSM_REQ
:

306 
u8
 
tok’
 = 
äame
[2];

308  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rPSMReqÑok’:%u)", 
tok’
);

310 
SLSI_ACTION_TDLS_PEER_PSM_RSP
:

312 
u8
 
tok’
 = 
äame
[2];

313 
u16
 
¡©us
 = 
äame
[3] | frame[4] << 8;

315  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rPSMR¥Ñok’:%u, stus:%u)", 
tok’
, 
¡©us
);

317 
SLSI_ACTION_TDLS_PEER_TRAFFIC_RSP
:

319 
u8
 
tok’
 = 
äame
[2];

321  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rT¿fficR¥Ñok’:%u)", 
tok’
);

323 
SLSI_ACTION_TDLS_DISCOVERY_REQ
:

325 
u8
 
tok’
 = 
äame
[2];

327  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->Discov”yReqÑok’:%u)", 
tok’
);

330  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->AùiÚ(%u)", 
aùiÚ
);

332 
	}
}

334 cÚ¡ 
¦si_v®ue_Çme_decode
 
	gaùiÚ_ÿ‹gÜ›s
[] = {

335 { 3, "BlockAck", 
¦si_decode_aùiÚ_blockack
 },

336 { 0, "S³ùrumMªagem’t", 
NULL
 },

337 { 1, "QoS", 
NULL
 },

338 { 2, "DLS", 
NULL
 },

339 { 4, "Public", 
¦si_decode_aùiÚ_public
 },

340 { 5, "RadioM—su»m’t", 
NULL
 },

341 { 6, "Fa¡BSST¿ns™iÚ", 
NULL
 },

342 { 7, "HT", 
NULL
 },

343 { 8, "SAQu”y", 
NULL
 },

344 { 9, "PrÙeùedDu®OfPublicAùiÚ", 
NULL
 },

345 { 12, "TDLS", 
¦si_decode_aùiÚ_tdls
 },

346 { 17, "Re£rvedWFA", 
NULL
 },

347 { 126, "V’dÜS³cificPrÙeùed", 
NULL
 },

348 { 127, "V’dÜS³cific", 
NULL
 },

349 { 132, "PublicÓ¼Ü)", 
¦si_decode_aùiÚ_public
 },

352 
	#SLSI_ACTION_CAT_BLOCK_ACK
 3

	)

353 
	$¦si_decode_aùiÚ
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

355 
u8
 
ÿ‹gÜy
 = 
äame
[0];

356 
u32
 
i
;

358 
i
 = 0; i < 
	`ARRAY_SIZE
(
aùiÚ_ÿ‹gÜ›s
); i++)

359 ià(
aùiÚ_ÿ‹gÜ›s
[
i
].
v®ue
 =ğ
ÿ‹gÜy
) {

360 
size_wr™‹n
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
aùiÚ_ÿ‹gÜ›s
[
i
].
Çme
);

362 ià(
aùiÚ_ÿ‹gÜ›s
[
i
].
decode_â
)

363 
aùiÚ_ÿ‹gÜ›s
[
i
].
	`decode_â
(
äame
, 
äame_Ëngth
, 
»suÉ
 + 
size_wr™‹n
, 
»suÉ_Ëngth
 - size_written);

366 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ÿ‹gÜy:%u", 
ÿ‹gÜy
);

367 
	}
}

369 cÚ¡ *
	g¦si_¬p_İcodes
[] = {

398 
size_t
 
	$¦si_decode_¬p
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

405 
u16
 
İcode
 = 
äame
[6] << 8 | frame[7];

406 
u8
 *
sha
 = &
äame
[8];

407 
u8
 *
¥a
 = &
äame
[14];

408 
u8
 *
tha
 = &
äame
[18];

409 
u8
 *
a
 = &
äame
[24];

411 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

413 ià(
İcode
 < 
	`ARRAY_SIZE
(
¦si_¬p_İcodes
))

414  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s(sha:%.2X:%.2X:%.2X:%.2X:%.2X:%.2X, spa:%u.%u.%u.%u,ha:%.2X:%.2X:%.2X:%.2X:%.2X:%.2X,pa:%u.%u.%u.%u)",

415 
¦si_¬p_İcodes
[
İcode
],

416 
sha
[0], sha[1], sha[2], sha[3], sha[4], sha[5],

417 
¥a
[0], spa[1], spa[2], spa[3],

418 
tha
[0],ha[1],ha[2],ha[3],ha[4],ha[5],

419 
a
[0],pa[1],pa[2],pa[3]);

421  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->(İcode:%u)", 
İcode
);

422 
	}
}

424 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_decode_—pŞ_·ck‘_ty³s
[] = {

425 { 1, "Id’t™y", 
NULL
 },

426 { 2, "NÙifiÿtiÚ", 
NULL
 },

427 { 3, "Nak", 
NULL
 },

428 { 4, "MD5Ch®Ënge", 
NULL
 },

429 { 5, "OÃTimePasswÜd", 
NULL
 },

430 { 6, "G’”icTok’C¬d", 
NULL
 },

431 { 9, "RSA PubliøKey Auth’tiÿtiÚ", 
NULL
 },

432 { 10, "DSS Un©”®", 
NULL
 },

433 { 11, "KEA", 
NULL
 },

434 { 12, "KEA-VALIDATE", 
NULL
 },

435 { 13, "EAP-TLS", 
NULL
 },

436 { 14, "Deãnd” Tok’ (AXENT)", 
NULL
 },

437 { 15, "RSA Secur™y SecurID EAP", 
NULL
 },

438 { 16, "ArcÙ Sy¡em EAP", 
NULL
 },

439 { 17, "EAP-CiscØWœ–ess", 
NULL
 },

440 { 18, "EAP-SIM", 
NULL
 },

441 { 19, "SRP-SHA1 P¬ˆ1", 
NULL
 },

442 { 21, "EAP-TTLS", 
NULL
 },

443 { 22, "RemÙAcûs S”viû", 
NULL
 },

444 { 23, "EAP-AKA", 
NULL
 },

445 { 24, "EAP-3Com Wœ–ess", 
NULL
 },

446 { 25, "PEAP", 
NULL
 },

447 { 26, "MS-EAP-Auth’tiÿtiÚ", 
NULL
 },

448 { 27, "MAKE", 
NULL
 },

449 { 28, "CRYPTOC¬d", 
NULL
 },

450 { 29, "EAP-MSCHAP-V2", 
NULL
 },

451 { 30, "DyÇmID", 
NULL
 },

452 { 31, "Rob EAP", 
NULL
 },

453 { 32, "EAP-POTP", 
NULL
 },

454 { 33, "MS-Auth’tiÿtiÚ-TLV", 
NULL
 },

455 { 34, "S’ŒiNET", 
NULL
 },

456 { 35, "EAP-AùiÚ‹øWœ–ess", 
NULL
 },

457 { 36, "Cog’ˆSy¡em Biom‘ric Auth’tiÿtiÚ EAP", 
NULL
 },

458 { 37, "AœFÜŒes EAP", 
NULL
 },

459 { 38, "EAP-HTTP Dige¡", 
NULL
 },

460 { 39, "Secu»Su™EAP", 
NULL
 },

461 { 40, "DeviûCÚÃù EAP", 
NULL
 },

462 { 41, "EAP-SPEKE", 
NULL
 },

463 { 42, "EAP-MOBAC", 
NULL
 },

464 { 43, "EAP-FAST", 
NULL
 },

465 { 44, "ZLXEAP", 
NULL
 },

466 { 45, "EAP-Lšk", 
NULL
 },

467 { 46, "EAP-PAX", 
NULL
 },

468 { 47, "EAP-PSK", 
NULL
 },

469 { 48, "EAP-SAKE", 
NULL
 },

470 { 49, "EAP-IKEv2", 
NULL
 },

471 { 50, "EAP-AKA", 
NULL
 },

472 { 51, "EAP-GPSK", 
NULL
 },

473 { 52, "EAP-pwd", 
NULL
 },

474 { 53, "EAP-EKE V1", 
NULL
 },

475 { 254, "WPS", 
NULL
 }

478 
size_t
 
	$¦si_decode_—pŞ_·ck‘
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

480 cÚ¡ *cÚ¡ 
¦si_decode_—pŞ_·ck‘_codes
[] = {

488 
size_t
 
size_wr™‹n
 = 0;

489 
u32
 
i
;

490 
u8
 
code
 = 
äame
[0];

491 
u8
 
id
 = 
äame
[1];

492 
u16
 
Ëngth
 = 
äame
[2] << 8 | frame[3];

493 cÚ¡ *
code_¡r
 = "";

495 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

497 ià(
code
 >= 1 && code <= 4)

498 
code_¡r
 = 
¦si_decode_—pŞ_·ck‘_codes
[
code
];

500 ià(
Ëngth
 > 4 && (
code
 == 1 || code == 2)) {

501 
u8
 
ty³
 = 
äame
[4];

503 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_decode_—pŞ_·ck‘_ty³s
); i++)

504 ià(
¦si_decode_—pŞ_·ck‘_ty³s
[
i
].
v®ue
 =ğ
ty³
) {

505 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, ":%s:% id:%u", 
¦si_decode_—pŞ_·ck‘_ty³s
[
i
].
Çme
, 
code_¡r
, 
id
);

506  
size_wr™‹n
;

508 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, ":ty³:%u: % id:%u", 
ty³
, 
code_¡r
, 
id
);

510 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, ":% id:%u†’gth:%u", 
code_¡r
, 
id
, 
Ëngth
);

512  
size_wr™‹n
;

513 
	}
}

515 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_—pŞ_·ck‘_ty³
[] = {

516 { 0, "E­Pack‘", 
¦si_decode_—pŞ_·ck‘
 },

517 { 1, "E­ŞS¹", 
NULL
 },

518 { 2, "E­ŞLogoff", 
NULL
 },

519 { 3, "E­ŞKey", 
NULL
 }

522 
size_t
 
	$¦si_decode_—pŞ
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

524 
size_t
 
size_wr™‹n
 = 0;

525 
u8
 
·ck‘_ty³
 = 
äame
[1];

526 
u16
 
Ëngth
 = 
äame
[2] << 8 | frame[3];

528 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

530 ià(
·ck‘_ty³
 < 
	`ARRAY_SIZE
(
¦si_—pŞ_·ck‘_ty³
)) {

531 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
¦si_—pŞ_·ck‘_ty³
[
·ck‘_ty³
].
Çme
);

532 ià(
¦si_—pŞ_·ck‘_ty³
[
·ck‘_ty³
].
decode_â
)

533 
size_wr™‹n
 +ğ
¦si_—pŞ_·ck‘_ty³
[
·ck‘_ty³
].
	`decode_â
(
äame
 + 4, 
Ëngth
, 
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written);

534  
size_wr™‹n
;

536  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->·ck‘_ty³:%u", 
·ck‘_ty³
);

538 
	}
}

540 
size_t
 
	$¦si_decode_tdls
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

542 
u8
 
·ylßd_ty³
 = 
äame
[0];

544 ià(
·ylßd_ty³
 == 2) {

545 
	`¦si_decode_aùiÚ
(
äame
 + 1, 
äame_Ëngth
 - 1, 
»suÉ
, 
»suÉ_Ëngth
);

548  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->UnknownÕaylßd:%u", 
·ylßd_ty³
);

550 
	}
}

552 
size_t
 
	$¦si_decode_v4_icmp_echo
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

554 
u16
 
id
 = 
äame
[0] << 8 | frame[1];

555 
u16
 
£q
 = 
äame
[2] << 8 | frame[3];

557 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

559  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, " id:%u seq:%u", 
id
, 
£q
);

560 
	}
}

562 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_v4_icmp_ty³s
[] = {

563 { 0, "EchoR•ly", 
¦si_decode_v4_icmp_echo
 },

564 { 8, "EchØ ", 
¦si_decode_v4_icmp_echo
 },

565 { 3, "De¡š©iÚ UÄ—chabË Ack", 
NULL
 },

566 { 4, "Sourû Qu’ch", 
NULL
 },

567 { 5, "Redœeù", 
NULL
 },

568 { 6, "AÉ”Ç‹ Ho¡ Add»ss", 
NULL
 },

569 { 9, "Rou‹¸Adv”ti£m’t", 
NULL
 },

570 { 10, "Rou‹¸S–eùiÚ", 
NULL
 },

571 { 11, "TimExûeded", 
NULL
 },

572 { 12, "P¬am‘” ProbËm", 
NULL
 },

573 { 13, "Time¡amp", 
NULL
 },

574 { 14, "Time¡am°R•ly", 
NULL
 },

575 { 15, "InfÜm©iÚ Reque¡", 
NULL
 },

576 { 16, "InfÜm©iÚ R•ly", 
NULL
 },

577 { 17, "Add»s Mask Reque¡", 
NULL
 },

578 { 18, "Add»s Mask R•ly", 
NULL
 },

579 { 19, "Re£rved (fÜ Secur™y)", 
NULL
 },

580 { 30, "T¿ûrou‹", 
NULL
 },

581 { 31, "D©ag¿m CÚv”siÚ E¼Ü", 
NULL
 },

582 { 32, "MobHo¡ Redœeù", 
NULL
 },

583 { 33, "IPv6 Wh”e-A»-You", 
NULL
 },

584 { 34, "IPv6 I-Am-H”e", 
NULL
 },

585 { 35, "MobRegi¡¿tiÚ Reque¡", 
NULL
 },

586 { 36, "MobRegi¡¿tiÚ R•ly", 
NULL
 },

587 { 39, "SKIP", 
NULL
 },

588 { 40, "PhÙuris", 
NULL
 },

589 { 253, "RFC3692-¡yË Ex³rim’ˆ1", 
NULL
 },

590 { 254, "RFC3692-¡yË Ex³rim’ˆ2", 
NULL
 }

593 
size_t
 
	$¦si_decode_v4_icmp
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

595 
size_t
 
size_wr™‹n
 = 0;

596 
u32
 
i
;

597 
u8
 
ty³
 = 
äame
[0];

598 
u8
 
code
 = 
äame
[1];

600 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_v4_icmp_ty³s
); i++)

601 ià(
¦si_v4_icmp_ty³s
[
i
].
v®ue
 =ğ
ty³
) {

602 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s(code:%u)", 
¦si_v4_icmp_ty³s
[
i
].
Çme
, 
code
);

603 ià(
¦si_v4_icmp_ty³s
[
i
].
decode_â
)

604 
size_wr™‹n
 +ğ
¦si_v4_icmp_ty³s
[
i
].
	`decode_â
(
äame
 + 4, 
äame_Ëngth
 - 4, 
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written);

605  
size_wr™‹n
;

607  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ty³(%u)", 
ty³
);

608 
	}
}

610 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_v4_udp_boÙp_dhı_İtiÚ53
[] = {

611 { 1, "DHCP_DISCOVER", 
NULL
 },

612 { 2, "DHCP_OFFER", 
NULL
 },

613 { 3, "DHCP_REQUEST", 
NULL
 },

614 { 4, "DHCP_DECLINE", 
NULL
 },

615 { 5, "DHCP_ACK", 
NULL
 },

616 { 6, "DHCP_NAK", 
NULL
 },

617 { 7, "DHCP_RELEASE", 
NULL
 },

618 { 8, "DHCP_INFORM", 
NULL
 },

621 
	#SLSI_IPV4_UDP_BOOTP_CIADDR_OFFSET
 16

	)

622 
	#SLSI_IPV4_UDP_BOOTP_YIADDR_OFFSET
 20

	)

623 
	#SLSI_IPV4_UDP_BOOTP_GIADDR_OFFSET
 24

	)

624 
	#SLSI_IPV4_UDP_BOOTP_MAGIC_OFFSET
 236

	)

625 
size_t
 
	$¦si_decode_v4_udp_boÙp
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

627 
u32
 
i
;

628 
u8
 *
cŸddr
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_CIADDR_OFFSET
];

629 
u8
 *
yŸddr
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_YIADDR_OFFSET
];

630 
u8
 *
gŸddr
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_GIADDR_OFFSET
];

631 
u8
 *
magic
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_MAGIC_OFFSET
];

633 ià(
magic
[0] == 0x63 && magic[1] == 0x82 && magic[2] == 0x53 && magic[3] == 0x63) {

634 
u8
 *
p
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_MAGIC_OFFSET
 + 4];

636 
p
 <… + 
äame_Ëngth
) {

637 
u8
 
İtiÚ
 = 
p
[0];

638 
u8
 
İtiÚ_Ëngth
 = 
p
[1];

640 ià(
İtiÚ
 =ğ53 && 
İtiÚ_Ëngth
 == 1) {

641 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_v4_udp_boÙp_dhı_İtiÚ53
); i++)

642 ià(
¦si_v4_udp_boÙp_dhı_İtiÚ53
[
i
].
v®ue
 =ğ
p
[2])

643  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s(ci:%u.%u.%u.%u yi:%u.%u.%u.%u gi:%u.%u.%u.%u)",

644 
¦si_v4_udp_boÙp_dhı_İtiÚ53
[
i
].
Çme
,

645 
cŸddr
[0], ciaddr[1], ciaddr[2], ciaddr[3],

646 
yŸddr
[0], yiaddr[1], yiaddr[2], yiaddr[3],

647 
gŸddr
[0], giaddr[1], giaddr[2], giaddr[3]);

648  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->option53(%u ci:%u.%u.%u.%u yi:%u.%u.%u.%u gi:%u.%u.%u.%u)",

649 
p
[2],

650 
cŸddr
[0], ciaddr[1], ciaddr[2], ciaddr[3],

651 
yŸddr
[0], yiaddr[1], yiaddr[2], yiaddr[3],

652 
gŸddr
[0], giaddr[1], giaddr[2], giaddr[3]);

654 ià(
İtiÚ
 == 0)

656 
p
 =… + 2 + 
İtiÚ_Ëngth
;

660 
	}
}

662 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_v4_udp_pÜts
[] = {

663 { 53, "DNS", 
NULL
 },

664 { 67, "BoÙp", 
¦si_decode_v4_udp_boÙp
 },

665 { 68, "BoÙp", 
¦si_decode_v4_udp_boÙp
 },

668 
size_t
 
	$¦si_decode_v4_udp
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

682 
size_t
 
size_wr™‹n
 = 0;

683 
u32
 
i
;

684 
u16
 
¥Üt
 = 
äame
[0] << 8 | frame[1];

685 
u16
 
dpÜt
 = 
äame
[2] << 8 | frame[3];

686 
u16
 
Ëngth
 = 
äame
[4] << 8 | frame[5];

690 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_v4_udp_pÜts
); i++)

691 ià(
¦si_v4_udp_pÜts
[
i
].
v®ue
 =ğ
dpÜt
 || slsi_v4_udp_pÜts[i].v®u=ğ
¥Üt
) {

692 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
¦si_v4_udp_pÜts
[
i
].
Çme
);

693 ià(
¦si_v4_udp_pÜts
[
i
].
decode_â
)

694 
size_wr™‹n
 +ğ
¦si_v4_udp_pÜts
[
i
].
	`decode_â
(
äame
 + 8, 
Ëngth
, 
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written);

696 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, "(dpÜt:%u, size:%u)", 
dpÜt
, 
äame_Ëngth
 - 8);

697  
size_wr™‹n
;

699  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "(dpÜt:%u, size:%u)", 
dpÜt
, 
äame_Ëngth
 - 8);

700 
	}
}

702 
size_t
 
	$¦si_decode_v4_tı
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

725 
u16
 
dpÜt
 = 
äame
[2] << 8 | frame[3];

726 
u8
 
æags
 = 
äame
[13];

727 
boŞ
 
fš
 = 
æags
 & 0x01;

728 
boŞ
 
syn
 = 
æags
 & 0x02;

729 
boŞ
 
r¡
 = 
æags
 & 0x04;

730 
boŞ
 
psh
 = 
æags
 & 0x08;

731 
boŞ
 
ack
 = 
æags
 & 0x10;

732 
boŞ
 
urg
 = 
æags
 & 0x20;

734  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "(dport:%u%s%s%s%s%s%s size:%u)",

735 
dpÜt
,

736 
fš
 ? " FIN" : "",

737 
syn
 ? " SYN" : "",

738 
r¡
 ? " RST" : "",

739 
psh
 ? " PSH" : "",

740 
ack
 ? " ACK" : "",

741 
urg
 ? " URG" : "",

742 
äame_Ëngth
 - 24);

743 
	}
}

745 
	#SLSI_IPV4_PROTO_ICMP
 1

	)

746 
	#SLSI_IPV4_PROTO_IGMP
 2

	)

747 
	#SLSI_IPV4_PROTO_TCP
 6

	)

748 
	#SLSI_IPV4_PROTO_UDP
 17

	)

749 
size_t
 
	$¦si_decode_v4
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

751 
size_t
 
size_wr™‹n
 = 0;

752 
u16
 
_d©a_off£t
 = 20;

754 
u8
 
hËn
 = 
äame
[0] & 0x0F;

760 
u8
 
´Ùo
 = 
äame
[9];

762 
u8
 *
¤c_
 = &
äame
[12];

763 
u8
 *
de¡_
 = &
äame
[16];

765 ià(
hËn
 > 5)

766 
_d©a_off£t
 +ğ(
hËn
 - 5) * 4;

768 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "(s:%u.%u.%u.%u d:%u.%u.%u.%u)",

769 
¤c_
[0], src_ip[1], src_ip[2], src_ip[3],

770 
de¡_
[0], dest_ip[1], dest_ip[2], dest_ip[3]);

772 
´Ùo
) {

773 
SLSI_IPV4_PROTO_TCP
:

774 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->TCP");

775 
size_wr™‹n
 +ğ
	`¦si_decode_v4_tı
(
äame
 + 
_d©a_off£t
,

776 
äame_Ëngth
 - 
_d©a_off£t
,

777 
»suÉ
 + 
size_wr™‹n
,

778 
»suÉ_Ëngth
 - 
size_wr™‹n
);

780 
SLSI_IPV4_PROTO_UDP
:

781 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->UDP");

782 
size_wr™‹n
 +ğ
	`¦si_decode_v4_udp
(
äame
 + 
_d©a_off£t
,

783 
äame_Ëngth
 - 
_d©a_off£t
,

784 
»suÉ
 + 
size_wr™‹n
,

785 
»suÉ_Ëngth
 - 
size_wr™‹n
);

787 
SLSI_IPV4_PROTO_ICMP
:

788 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->ICMP");

789 
size_wr™‹n
 +ğ
	`¦si_decode_v4_icmp
(
äame
 + 
_d©a_off£t
,

790 
äame_Ëngth
 - 
_d©a_off£t
,

791 
»suÉ
 + 
size_wr™‹n
,

792 
»suÉ_Ëngth
 - 
size_wr™‹n
);

794 
SLSI_IPV4_PROTO_IGMP
:

795 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->IGMP");

798 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, "->´Ùo:%u", 
´Ùo
);

801  
size_wr™‹n
;

802 
	}
}

804 cÚ¡ 
¦si_decode_¢­
 
	g¢­_ty³s
[] = {

805 { { 0x08, 0x00 }, "IpV4", 
¦si_decode_v4
 },

806 { { 0x08, 0x06 }, "A½", 
¦si_decode_¬p
 },

807 { { 0x88, 0x8}, "E­Ş", 
¦si_decode_—pŞ
 },

808 { { 0x89, 0x0d }, 
NULL
, 
¦si_decode_tdls
 },

809 { { 0x86, 0xdd }, "IpV6", 
NULL
 },

810 { { 0x88, 0xb4 }, "W­i", 
NULL
 },

813 
	$¦si_decode_´Ùo_d©a
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

815 
u32
 
i
;

817 
i
 = 0; i < 
	`ARRAY_SIZE
(
¢­_ty³s
); i++)

818 ià(
	`memcmp
(
¢­_ty³s
[
i
].
¢­
, 
äame
, 2) == 0) {

819 
¦’
 = 0;

821 ià(
¢­_ty³s
[
i
].
Çme
)

822 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
¢­_ty³s
[
i
].
Çme
);

823 ià(
¢­_ty³s
[
i
].
decode_â
)

824 
¦’
 +ğ
¢­_ty³s
[
i
].
	`decode_â
(
äame
 + 2, 
äame_Ëngth
 - 2, 
»suÉ
 + sËn, 
»suÉ_Ëngth
 - slen);

828 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "ÕrÙo:0x%.2X%.2X)", 
äame
[0], frame[1]);

829 
	}
}

831 
	$¦si_decode_80211_d©a
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

833  
	`¦si_decode_´Ùo_d©a
(
äame
 + 6, 
äame_Ëngth
 - 6, 
»suÉ
, 
»suÉ_Ëngth
);

834 
	}
}

836 cÚ¡ 
¦si_decode_’Œy
 
	gäame_ty³s
[4][16] = {

838 { "AssocReq", 
¦si_decode_assoc_»q
 },

839 { "AssocR¥", 
¦si_decode_assoc_r¥
 },

840 { "R—ssocReq", 
¦si_decode_»assoc_»q
 },

841 { "R—ssocR¥", 
¦si_decode_assoc_r¥
 },

842 { "ProbeReq", 
¦si_decode_´obe_»q
 },

843 { "ProbeR¥", 
¦si_decode_b—cÚ
 },

844 { "TimšgAdv", 
NULL
 },

845 { "Re£rved", 
NULL
 },

846 { "B—cÚ ", 
¦si_decode_b—cÚ
 },

847 { "Atim", 
NULL
 },

848 { "Di§ssoc", 
¦si_decode_d—uth
 },

849 { "Auth", 
¦si_decode_auth
 },

850 { "D—uth", 
¦si_decode_d—uth
 },

851 { "AùiÚ", 
¦si_decode_aùiÚ
 },

852 { "AùiÚNoAck", 
¦si_decode_aùiÚ
 },

853 { "Re£rved", 
NULL
 }

856 { "Re£rved", 
NULL
 },

857 { "Re£rved", 
NULL
 },

858 { "Re£rved", 
NULL
 },

859 { "Re£rved", 
NULL
 },

860 { "Re£rved", 
NULL
 },

861 { "Re£rved", 
NULL
 },

862 { "Re£rved", 
NULL
 },

863 { "Re£rved", 
NULL
 },

864 { "BlockAckReq", 
NULL
 },

865 { "BlockAck", 
NULL
 },

866 { "PsPŞl", 
NULL
 },

867 { "RTS", 
NULL
 },

868 { "CTS", 
NULL
 },

869 { "Ack", 
NULL
 },

870 { "CF-End", 
NULL
 },

871 { "CF-End+Ack", 
NULL
 }

874 { "D©a", 
¦si_decode_80211_d©a
 },

875 { "D©a+CF-Ack", 
¦si_decode_80211_d©a
 },

876 { "D©a+CF-PŞl", 
¦si_decode_80211_d©a
 },

877 { "D©a+CF-Ack+PŞl", 
¦si_decode_80211_d©a
 },

878 { "NuÎ", 
NULL
 },

879 { "CF-Ack", 
NULL
 },

880 { "CF-PŞl", 
NULL
 },

881 { "CF-Ack+PŞl", 
NULL
 },

882 { "QosD©a", 
¦si_decode_80211_d©a
 },

883 { "QosD©a+CF-Ack", 
¦si_decode_80211_d©a
 },

884 { "QosD©a+CF-PŞl", 
¦si_decode_80211_d©a
 },

885 { "QosD©a+CF-Ack+PŞl", 
¦si_decode_80211_d©a
 },

886 { "QosNuÎ", 
NULL
 },

887 { "Re£rved", 
NULL
 },

888 { "QosCF-PŞl", 
NULL
 },

889 { "QosCF-Ack+PŞl", 
NULL
 }

892 { "Re£rved", 
NULL
 },

893 { "Re£rved", 
NULL
 },

894 { "Re£rved", 
NULL
 },

895 { "Re£rved", 
NULL
 },

896 { "Re£rved", 
NULL
 },

897 { "Re£rved", 
NULL
 },

898 { "Re£rved", 
NULL
 },

899 { "Re£rved", 
NULL
 },

900 { "Re£rved", 
NULL
 },

901 { "Re£rved", 
NULL
 },

902 { "Re£rved", 
NULL
 },

903 { "Re£rved", 
NULL
 },

904 { "Re£rved", 
NULL
 },

905 { "Re£rved", 
NULL
 },

906 { "Re£rved", 
NULL
 },

907 { "Re£rved", 
NULL
 },

911 
boŞ
 
	$¦si_decode_80211_äame
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

913 
›“80211_hdr
 *
hdr
 = (›“80211_hd¸*)
äame
;

914 
u16
 
fc_ıu
 = 
	`ıu_to_Ë16
(
hdr
->
äame_cÚŒŞ
);

915 
áy³_idx
 = (
fc_ıu
 & 0xf) >> 2;

916 cÚ¡ 
¦si_decode_’Œy
 *
’Œy
;

917 
hd¾’
;

918 
¦’
;

921 ià(
¦si_debug_summ¬y_äame
 =ğ1 && 
áy³_idx
 != 0)

922  
çl£
;

925 ià(
¦si_debug_summ¬y_äame
 < 3 &&

926 (
	`›“80211_is_´obe_»q
(
fc_ıu
è|| 
	`›“80211_is_´obe_»¥
(fc_ıuè|| 
	`›“80211_is_b—cÚ
(fc_cpu)))

927  
çl£
;

929 
’Œy
 = &
äame_ty³s
[
áy³_idx
][(
fc_ıu
 >> 4) & 0xf];

930 
hd¾’
 = 
	`›“80211_hd¾’
(
hdr
->
äame_cÚŒŞ
);

931 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, 
’Œy
->
Çme
);

933 ià(
’Œy
->
decode_â
)

934 
’Œy
->
	`decode_â
(
äame
 + 
hd¾’
, 
äame_Ëngth
 - hd¾’, 
»suÉ
 + 
¦’
, 
»suÉ_Ëngth
 - slen);

935  
Œue
;

936 
	}
}

938 
boŞ
 
	$¦si_decode_l3_äame
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

940 
¦’
;

943 ià(
¦si_debug_summ¬y_äame
 == 1)

944  
çl£
;

947 ià(
¦si_debug_summ¬y_äame
 == 2) {

948 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
äame
;

949 
u16
 
‘h_ty³
 = 
	`be16_to_ıu
(
ehdr
->
h_´Ùo
);

951 
‘h_ty³
) {

952 
ETH_P_IP
:

953 ià(
	`¦si_is_dhı_·ck‘
(
äame
è=ğ
SLSI_TX_IS_NOT_DHCP
)

954  
çl£
;

957 
ETH_P_PAE
:

958 
ETH_P_WAI
:

959 
ETH_P_ARP
:

963  
çl£
;

966 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "eth");

967 
	`¦si_decode_´Ùo_d©a
(
äame
 + 12, 
äame_Ëngth
 - 12, 
»suÉ
 + 
¦’
, 
»suÉ_Ëngth
 - slen);

968  
Œue
;

969 
	}
}

971 
boŞ
 
	$¦si_decode_amsdu_subäame
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

973 
¦’
;

976 ià(
¦si_debug_summ¬y_äame
 == 1)

977  
çl£
;

980 ià(
¦si_debug_summ¬y_äame
 == 2) {

981 
msduhdr
 *
msdu_hdr
 = (msduhd¸*)
äame
;

982 
u16
 
‘h_ty³
 = 
	`be16_to_ıu
(
msdu_hdr
->
ty³
);

984 
‘h_ty³
) {

985 
ETH_P_IP
:

990 ià(
	`¦si_is_dhı_·ck‘
(
äame
 + 8è=ğ
SLSI_TX_IS_NOT_DHCP
)

991  
çl£
;

994 
ETH_P_PAE
:

995 
ETH_P_WAI
:

996 
ETH_P_ARP
:

1000  
çl£
;

1003 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "eth");

1004 
	`¦si_decode_´Ùo_d©a
(
äame
 + 20, 
äame_Ëngth
 - 20, 
»suÉ
 + 
¦’
, 
»suÉ_Ëngth
 - slen);

1005  
Œue
;

1006 
	}
}

1008 
šlše
 
boŞ
 
	$¦si_debug_äame_¿‹lim™ed
()

1010 
	`DEFINE_RATELIMIT_STATE
(
_rs
, (5 * 
HZ
), 200);

1012 ià(
	`__¿‹lim™
(&
_rs
))

1013  
Œue
;

1014  
çl£
;

1015 
	}
}

1018 
	$¦si_debug_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, cÚ¡ *
´efix
)

1020 
äame_šfo
[384];

1021 
u8
 *
äame
 = 
	`çpi_g‘_d©a
(
skb
);

1022 
u16
 
Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

1023 
u8
 *
d¡
 = 
NULL
;

1024 
u8
 *
¤c
 = 
NULL
;

1025 
u16
 
äam‘y³
 = 0xFFFF;

1026 
boŞ
 
´št
 = 
çl£
;

1027 
u16
 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1028 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

1029 
s16
 
rssi
 = 0;

1031 ià(!
¦si_debug_summ¬y_äame
)

1034 ià(!
Ën
)

1037 
id
) {

1038 
MA_UNITDATA_REQ
:

1039 
MA_UNITDATA_IND
:

1040 ià(!
	`¦si_debug_äame_¿‹lim™ed
())

1047 
äame_šfo
[0] = '\0';

1048 
id
) {

1050 
MA_UNITDATA_REQ
:

1051 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
d©a_un™_desütÜ
);

1053 
MA_UNITDATA_IND
:

1054 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_INLINE
)

1055 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
);

1058 
MLME_SEND_FRAME_REQ
:

1059 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
d©a_un™_desütÜ
);

1061 
MLME_RECEIVED_FRAME_IND
:

1062 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
d©a_un™_desütÜ
);

1064 
MLME_SCAN_IND
:

1065 
äam‘y³
 = 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
;

1066 
rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.rssi);

1067 
vif
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
sÿn_id
) >> 8;

1069 
MLME_CONNECT_CFM
:

1070 
MLME_CONNECT_IND
:

1071 
MLME_PROCEDURE_STARTED_IND
:

1072 
MLME_CONNECTED_IND
:

1073 
MLME_REASSOCIATE_IND
:

1074 
MLME_ROAMED_IND
:

1075 
äam‘y³
 = 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
;

1081 
äam‘y³
) {

1082 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
:

1084 
›“80211_hdr
 *
hdr
 = (›“80211_hd¸*)
äame
;

1086 
d¡
 = 
hdr
->
addr1
;

1087 
¤c
 = 
hdr
->
addr2
;

1088 
´št
 = 
	`¦si_decode_80211_äame
(
äame
, 
Ën
, 
äame_šfo
, (frame_info));

1091 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
:

1093 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
äame
;

1095 
d¡
 = 
ehdr
->
h_de¡
;

1096 
¤c
 = 
ehdr
->
h_sourû
;

1097 
´št
 = 
	`¦si_decode_l3_äame
(
äame
, 
Ën
, 
äame_šfo
, (frame_info));

1100 
FAPI_DATAUNITDESCRIPTOR_AMSDU_SUBFRAME
:

1102 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
äame
;

1104 
d¡
 = 
ehdr
->
h_de¡
;

1105 
¤c
 = 
ehdr
->
h_sourû
;

1106 
´št
 = 
	`¦si_decode_amsdu_subäame
(
äame
, 
Ën
, 
äame_šfo
, (frame_info));

1112 ià(
´št
) {

1113 
	`SLSI_DBG4
(
sdev
, 
SLSI_SUMMARY_FRAMES
, "%-5s: %s(vif:%u„ssi:%-3d, s:%pM d:%pM)->%s\n",

1114 
dev
 ? 
	`Ãtdev_Çme
(devè: "", 
´efix
, 
vif
, 
rssi
, 
¤c
, 
d¡
, 
äame_šfo
);

1116 
	}
}

	@dev.c

7 
	~"dev.h
"

8 
	~"h.h
"

9 
	~"mgt.h
"

10 
	~"debug.h
"

11 
	~"udi.h
"

12 
	~"h_bh.h
"

13 
	~"cfg80211_İs.h
"

14 
	~"Ãtif.h
"

15 
	~"´ocfs.h
"

16 
	~"ba.h
"

17 
	~"Æ80211_v’dÜ.h
"

18 
	~"log2us.h
"

19 
	~"qsfs.h
"

21 
	~"§p_mlme.h
"

22 
	~"§p_ma.h
"

23 
	~"§p_dbg.h
"

24 
	~"§p_‹¡.h
"

25 
	~"scsc_wÏn_mm­.h
"

27 #ifdeà
CONFIG_SCSC_WLAN_KIC_OPS


28 
	~"kic.h
"

31 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


32 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 < 4

37 #ifdeà
CONFIG_SCSC_WLAN_TX_API


38 
	~"tx_­i.h
"

41 #ifdeà
CONFIG_SCSC_WLAN_CPUHP_MONITOR


42 
	~"¦si_ıuhp_mÚ™Ü.h
"

45 *
	g¦si_mib_fe
 = "wlan.hcf";

46 
moduË_·¿m_Çmed
(
mib_fe
, 
¦si_mib_fe
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

47 
MODULE_PARM_DESC
(
mib_fe
, "mib data filename");

49 *
	g¦si_mib_fe2
 = "wlan_sw.hcf";

50 
moduË_·¿m_Çmed
(
mib_fe2
, 
¦si_mib_fe2
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

51 
MODULE_PARM_DESC
(
mib_fe2
, "sw mib data filename");

53 *
	gloÿl_mib_fe
 = "localmib.hcf";

54 
moduË_·¿m
(
loÿl_mib_fe
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

55 
MODULE_PARM_DESC
(
loÿl_mib_fe
, "local mib data filename (Optionalƒxtra mib values)");

57 *
	gmaddr_fe
 = "mac.txt";

58 
moduË_·¿m
(
maddr_fe
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

59 
MODULE_PARM_DESC
(
maddr_fe
, "mac‡ddress filename");

61 
boŞ
 
	g‹rm_udi_u£rs
 = 
Œue
;

62 
moduË_·¿m
(
‹rm_udi_u£rs
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

63 
MODULE_PARM_DESC
(
‹rm_udi_u£rs
, "Tryoerminate UDI user space users (applications) connected onhe cdev (0, 1)");

65 
	gsig_wa™_cfm_timeout
 = 6000;

66 
moduË_·¿m
(
sig_wa™_cfm_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

67 
MODULE_PARM_DESC
(
sig_wa™_cfm_timeout
, "Signal waitimeout in milliseconds (default: 3000)");

69 
boŞ
 
	gÎs_di§bËd
;

70 
moduË_·¿m
(
Îs_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

71 
MODULE_PARM_DESC
(
Îs_di§bËd
, "Disable LLS:o disable LLS set 1");

73 #ifdeà
SCSC_SEP_VERSION


74 
boŞ
 
	ggsÿn_di§bËd
 = 1;

76 
boŞ
 
	ggsÿn_di§bËd
;

78 
moduË_·¿m
(
gsÿn_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

79 
MODULE_PARM_DESC
(
gsÿn_di§bËd
, "Disable gscan:o disable gscan set 1");

81 
boŞ
 
	gÎ¦ogs_di§bËd
;

82 
moduË_·¿m
(
Î¦ogs_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

83 
MODULE_PARM_DESC
(
Î¦ogs_di§bËd
, "Disable†lslogs:o disable†lslogs set 1");

85 
boŞ
 
	g•no_di§bËd
;

86 
moduË_·¿m
(
•no_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

87 
MODULE_PARM_DESC
(
•no_di§bËd
, "DisableƒPNO:o disableƒPNO set 1.\nNote: forƒPNOo work gscan should beƒnabled");

89 
boŞ
 
	gvo_vi_block_ack_di§bËd
;

90 
moduË_·¿m
(
vo_vi_block_ack_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

91 
MODULE_PARM_DESC
(
vo_vi_block_ack_di§bËd
, "Disable VO VI Block Ack†ogic‡dded for WMM AC Cert : 5.1.4");

93 
	gmax_sÿn_»suÉ_couÁ
 = 10000;

94 
moduË_·¿m
(
max_sÿn_»suÉ_couÁ
, , 
S_IRUGO
 | 
S_IWUSR
);

95 
MODULE_PARM_DESC
(
max_sÿn_»suÉ_couÁ
, "Max scan„esultso be„eported");

97 #ifdeà
CONFIG_SCSC_WLAN_RTT


98 
boŞ
 
	g¹t_di§bËd
;

100 
boŞ
 
	g¹t_di§bËd
 = 1;

102 
moduË_·¿m
(
¹t_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

103 
MODULE_PARM_DESC
(
¹t_di§bËd
, "Disable„tt:o disable„tt set 1");

105 
boŞ
 
	gÇn_di§bËd
;

106 
moduË_·¿m
(
Çn_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

107 
MODULE_PARM_DESC
(
Çn_di§bËd
, "Disable NAN:o disable NAN set 1.");

109 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


110 
boŞ
 
	gÇn_šşude_v6_v
 = 
Œue
;

111 
moduË_·¿m
(
Çn_šşude_v6_v
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

112 
MODULE_PARM_DESC
(
Çn_šşude_v6_v
, "include ipv6‡ddresslv:o disable NAN set 0. Enabled by default");

114 
	gÇn_max_ndp_š¡ªûs
 = 1;

115 
moduË_·¿m
(
Çn_max_ndp_š¡ªûs
, , 
S_IRUGO
 | 
S_IWUSR
);

116 
MODULE_PARM_DESC
(
Çn_max_ndp_š¡ªûs
, "max‚dp sessions");

118 #ifdeà
SCSC_SEP_VERSION


119 
	gÇn_max_ndi_içûs
 = 1;

121 
	gÇn_max_ndi_içûs
 = 5;

124 
moduË_·¿m
(
Çn_max_ndi_içûs
, , 
S_IRUGO
 | 
S_IWUSR
);

125 
MODULE_PARM_DESC
(
Çn_max_ndi_içûs
, "max‚di interface");

127 
boŞ
 
	gdi§bË_Çn_mac_¿ndom
;

128 
moduË_·¿m
(
di§bË_Çn_mac_¿ndom
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

129 
MODULE_PARM_DESC
(
di§bË_Çn_mac_¿ndom
, "Disable NAN mac_randomization: set 1.");

132 #ifdeà
SCSC_SEP_VERSION


133 
	gÇn_ndp_d–ay_ms
 = 550;

134 
	gÇn_ndp_max_d–ay_ms
 = 600;

136 
	gÇn_ndp_d–ay_ms
 = 750;

137 
	gÇn_ndp_max_d–ay_ms
 = 800;

140 
moduË_·¿m
(
Çn_ndp_d–ay_ms
, , 
S_IRUGO
 | 
S_IWUSR
);

141 
MODULE_PARM_DESC
(
Çn_ndp_d–ay_ms
, "ndp delayime");

142 
moduË_·¿m
(
Çn_ndp_max_d–ay_ms
, , 
S_IRUGO
 | 
S_IWUSR
);

143 
MODULE_PARM_DESC
(
Çn_ndp_max_d–ay_ms
, "max‚dp delayime");

147 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


148 
boŞ
 
	gdi§bË_6ghz_¥l™_sÿn
;

149 
moduË_·¿m
(
di§bË_6ghz_¥l™_sÿn
, 
boŞ
, 0644);

150 
MODULE_PARM_DESC
(
di§bË_6ghz_¥l™_sÿn
, "Disable 6ghz split scan: set 1");

153 
boŞ
 
	$¦si_dev_gsÿn_suµÜ‹d
()

155  !
gsÿn_di§bËd
;

156 
	}
}

158 
boŞ
 
	$¦si_dev_¹t_suµÜ‹d
()

160  !
¹t_di§bËd
;

161 
	}
}

163 
boŞ
 
	$¦si_dev_Î¦ogs_suµÜ‹d
()

165  !
Î¦ogs_di§bËd
;

166 
	}
}

168 
boŞ
 
	$¦si_dev_Îs_suµÜ‹d
()

170  !
Îs_di§bËd
;

171 
	}
}

173 
boŞ
 
	$¦si_dev_•no_suµÜ‹d
()

175  !
•no_di§bËd
;

176 
	}
}

178 
boŞ
 
	$¦si_dev_vo_vi_block_ack
()

180  
vo_vi_block_ack_di§bËd
;

181 
	}
}

183 
	$¦si_dev_g‘_sÿn_»suÉ_couÁ
()

185  
max_sÿn_»suÉ_couÁ
;

186 
	}
}

188 
	$¦si_dev_Çn_suµÜ‹d
(
¦si_dev
 *
sdev
)

190 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

191 ià(
sdev
)

192  
sdev
->
Çn_’abËd
 && !
Çn_di§bËd
;

193  
çl£
;

195  
çl£
;

197 
	}
}

199 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


200 
boŞ
 
	$¦si_dev_Çn_is_v6_lšk_v_šşude
()

202  
Çn_šşude_v6_v
;

203 
	}
}

205 
	$¦si_g‘_Çn_max_ndp_š¡ªûs
()

207  
Çn_max_ndp_š¡ªûs
;

208 
	}
}

210 
	$¦si_g‘_Çn_max_ndi_içûs
()

212  
Çn_max_ndi_içûs
;

213 
	}
}

215 
	$¦si_g‘_Çn_ndp_d–ay
()

217  
Çn_ndp_d–ay_ms
;

218 
	}
}

220 
	$¦si_g‘_Çn_ndp_max_time
()

222 ià(
Çn_ndp_d–ay_ms
 >ğ
Çn_ndp_max_d–ay_ms
)

223 
Çn_ndp_max_d–ay_ms
 = 
Çn_ndp_d–ay_ms
 + 50;

225  
Çn_ndp_max_d–ay_ms
;

226 
	}
}

228 
boŞ
 
	$¦si_g‘_Çn_mac_¿ndom
()

230  !
di§bË_Çn_mac_¿ndom
;

231 
	}
}

235 
boŞ
 
	$¦si_dev_6ghz_¥l™_sÿn_’abËd
()

237 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


238  !
di§bË_6ghz_¥l™_sÿn
;

240  
çl£
;

242 
	}
}

244 
	$¦si_dev_š‘addr_chªged
(
nÙif›r_block
 *
nb
, 
d©a
, *
¬g
)

246 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
nb
, ¦si_dev, 
š‘addr_nÙif›r
);

247 
š_içddr
 *
iç
 = 
¬g
;

248 
Ãt_deviû
 *
dev
 = 
iç
->
iç_dev
->dev;

249 
wœ–ess_dev
 *
wdev
 = 
dev
->
›“80211_±r
;

250 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

252 ià(!
wdev
)

253  
NOTIFY_DONE
;

255 ià(
wdev
->
why
 !ğ
sdev
->wiphy)

256  
NOTIFY_DONE
;

258 ià(
d©a
 =ğ
NETDEV_DOWN
) {

259 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_NETDEV
, "Returning 0 for NETDEV_DOWNƒvent\n");

263 
	`SLSI_NET_INFO
(
dev
, "IP: %pI4\n", &
iç
->
iç_add»ss
);

264 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

265 #iâdeà
SLSI_TEST_DEV


266 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& 
	`¦si_wake_lock_aùive
(&
sdev
->
wÏn_wl_rßm
)) {

267 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_NETDEV
, "Releasinghe„oaming wakelock\n");

268 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_rßm
);

272 ià(
ndev_vif
->
¡a
.
is_wps
) {

273 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
,

275 
ndev_vif
->
¡a
.
is_wps
 = 
çl£
;

279 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
iç
->
iç_add»ss
);

280 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

282 
	}
}

284 #ià
IS_ENABLED
(
CONFIG_IPV6
)

285 
	$¦si_dev_š‘6addr_chªged
(
nÙif›r_block
 *
nb
, 
d©a
, *
¬g
)

287 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
nb
, ¦si_dev, 
š‘6addr_nÙif›r
);

288 
š‘6_içddr
 *
iç
 = 
¬g
;

289 
Ãt_deviû
 *
dev
 = 
iç
->
idev
->dev;

290 
wœ–ess_dev
 *
wdev
 = 
dev
->
›“80211_±r
;

291 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

293 ()
d©a
;

295 ià(!
wdev
)

296  
NOTIFY_DONE
;

298 ià(
wdev
->
why
 !ğ
sdev
->wiphy)

299  
NOTIFY_DONE
;

301 
	`SLSI_NET_INFO
(
dev
, "IPv6: %pI6\n", &
iç
->
addr
.
s6_addr
);

303 
	`¦si_¥šlock_lock
(&
ndev_vif
->
v6addr_lock
);

304 
	`memıy
(&
ndev_vif
->
v6add»ss
, &
iç
->
addr
, (
š6_addr
));

305 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
v6addr_lock
);

308 
	}
}

311 
	$¦si_dump_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
)

313 
	`mu‹x_lock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

314 
	`SLSI_INFO
(
sdev
, "Sy¡emƒ¼Ü saved†ogs:\n--BEGIN--\n%s--END--\n", sdev->
sys_”rÜ_log_buf
.
log_buf
);

315 
	`mu‹x_uÆock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

316 
	}
}

318 
	$¦si_add_log_to_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
, *
šput_bufãr
)

320 
pos
 = 
sdev
->
sys_”rÜ_log_buf
.pos;

321 
buf_size
 = 
sdev
->
sys_”rÜ_log_buf
.
log_buf_size
 - 
pos
;

322 
u32
 
time
[2] = { 0 };

324 
	`g‘_k”Ãl_time¡amp
(
time
);

325 
	`mu‹x_lock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

326 
sdev
->
sys_”rÜ_log_buf
.
pos
 +ğ
	`sú´štf
(sdev->sys_”rÜ_log_buf.
log_buf
 +…os, 
buf_size
 -…os, "[%d.%d] ", 
time
[0],ime[1]);

328 
pos
 = 
sdev
->
sys_”rÜ_log_buf
.pos;

329 
buf_size
 = 
sdev
->
sys_”rÜ_log_buf
.
log_buf_size
 - 
pos
;

331 
sdev
->
sys_”rÜ_log_buf
.
pos
 +ğ
	`sú´štf
(sdev->sys_”rÜ_log_buf.
log_buf
 +…os, 
buf_size
 -…os, 
šput_bufãr
);

332 
	`mu‹x_uÆock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

333 
	}
}

335 
	$¦si_sys_”rÜ_log_š™
(
¦si_dev
 *
sdev
)

337 
	`mu‹x_š™
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

338 
sdev
->
sys_”rÜ_log_buf
.
pos
 = 0;

339 
sdev
->
sys_”rÜ_log_buf
.
log_buf
 = 
NULL
;

340 
sdev
->
sys_”rÜ_log_buf
.
log_buf_size
 = 
SYSTEM_ERROR_BUFFER_SZ
;

342 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "AÎoÿtšg %d memÜy fÜ sy¡em_”rÜ_log_bufãr\n", sdev->
sys_”rÜ_log_buf
.
log_buf_size
);

343 
sdev
->
sys_”rÜ_log_buf
.
log_buf
 = 
	`kz®loc
(sdev->sys_”rÜ_log_buf.
log_buf_size
, 
GFP_KERNEL
);

344 ià(!
sdev
->
sys_”rÜ_log_buf
.
log_buf
)

345 
	`SLSI_ERR_NODEV
("Failedo‡llocate system_error_log_buffer\n");

346 
	}
}

348 
¦si_dev
 *
	$¦si_dev_©ch
(
deviû
 *
dev
, 
scsc_mx
 *
cÜe
, 
scsc_£rviû_ş›Á
 *
mx_wÏn_ş›Á
)

350 
¦si_dev
 *
sdev
;

351 
i
;

353 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "Add Device\n");

355 
sdev
 = 
	`¦si_cfg80211_Ãw
(
dev
);

356 ià(!
sdev
) {

357 
	`SLSI_ERR_NODEV
("No sdev\n");

358  
NULL
;

361 #ifdeà
CONFIG_SCSC_WLAN_CPUHP_MONITOR


362 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Initialisehe CPU Hotplug Monitor\n");

363 ià(
	`¦si_ıuhp_mÚ™Ü_š™
() < 0) {

364 
	`SLSI_ERR_NODEV
("Failedo init CPU Hotplug Monitor\n");

365 
	`WARN_ON
(1);

369 
sdev
->
mlme_blocked
 = 
çl£
;

370 
sdev
->
wÏn_£rviû_Ú
 = 0;

371 
sdev
->
»quœe_£rviû_şo£
 = 
çl£
;

373 
	`SLSI_MUTEX_INIT
(
sdev
->
Ãtdev_add_»move_mu‹x
);

374 
	`mu‹x_š™
(&
sdev
->
Ãtdev_»move_mu‹x
);

375 
	`SLSI_MUTEX_INIT
(
sdev
->
¡¬t_¡İ_mu‹x
);

376 
	`SLSI_MUTEX_INIT
(
sdev
->
deviû_cÚfig_mu‹x
);

377 
	`SLSI_MUTEX_INIT
(
sdev
->
logg”_mu‹x
);

378 
	`¦si_¥šlock_ü—‹
(&
sdev
->
Ãtdev_lock
);

379 
	`¦si_¥šlock_ü—‹
(&
sdev
->
wake_¡©s_lock
);

380 
sdev
->
dev
 = dev;

381 
sdev
->
maxw–l_cÜe
 = 
cÜe
;

382 
	`memıy
(&
sdev
->
mx_wÏn_ş›Á
, mx_wÏn_ş›Á, (
scsc_£rviû_ş›Á
));

384 
sdev
->
ç_»pÜ‹d
 = 
çl£
;

385 
sdev
->
p2p_û¹if
 = 
çl£
;

386 
sdev
->
®low_sw™ch_40_mhz
 = 
Œue
;

387 
sdev
->
®low_sw™ch_80_mhz
 = 
Œue
;

388 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

389 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

390 
sdev
->
mib
[2].
mib_fe_Çme
 = 
loÿl_mib_fe
;

391 
sdev
->
loÿl_mib
.
mib_fe_Çme
 = 
loÿl_mib_fe
;

392 
sdev
->
maddr_fe_Çme
 = 
maddr_fe
;

393 
sdev
->
deviû_cÚfig
.
qos_šfo
 = -1;

394 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = 
SLSI_HOSTSTATE_CELLULAR_ACTIVE
;

395 
sdev
->
acs_chªÃl_sw™ched
 = 
çl£
;

396 
	`mem£t
(&
sdev
->
ch_šfo_mib
, 0xFF, (
¦si_ch_šfo_mib
));

398 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


399 
sdev
->
num_5g_»¡riùed_chªÃls
 = 0;

402 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


403 
sdev
->
deviû_cÚfig
.
okc_mode
 = 0;

404 
sdev
->
deviû_cÚfig
.
wes_mode
 = 0;

405 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 0;

408 
	`¦si_log_ş›Ás_š™
(
sdev
);

409 
	`¦si_Œaffic_mÚ_ş›Ás_š™
(
sdev
);

410 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

411 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl
.
ws
, "wlan");

412 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_mlme_evt
.
ws
, "wlan_wl_mlme_evt");

413 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_mlme
.
ws
, "wlan_mlme");

414 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_ma
.
ws
, "wlan_ma");

415 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_rßm
.
ws
, "wlan_roam");

416 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_š™
.
ws
, "wlan_init");

418 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl
, 
WAKE_LOCK_SUSPEND
, "wlan");

419 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_mlme_evt
, 
WAKE_LOCK_SUSPEND
, "wlan_wl_mlme_evt");

420 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_mlme
, 
WAKE_LOCK_SUSPEND
, "wlan_mlme");

421 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_ma
, 
WAKE_LOCK_SUSPEND
, "wlan_ma");

422 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_rßm
, 
WAKE_LOCK_SUSPEND
, "wlan_roam");

423 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_š™
, 
WAKE_LOCK_SUSPEND
, "wlan_init");

426 
sdev
->
»cov”y_Ãxt_¡©e
 = 0;

427 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

428 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

429 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

430 
	`š™_com¶‘iÚ
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

431 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

432 
sdev
->
»cov”y_¡©us
 = 0;

434 
sdev
->
‹rm_udi_u£rs
 = &term_udi_users;

435 
sdev
->
sig_wa™_cfm_timeout
 = &sig_wait_cfm_timeout;

436 
	`¦si_sig_£nd_š™
(&
sdev
->
sig_wa™
);

437 
	`¦si_sys_”rÜ_log_š™
(
sdev
);

438 
	`¦si_qsf_š™
(
sdev
);

440 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++)

441 
	`©omic_£t
(&
sdev
->
tx_ho¡_g
[
i
], ((1 << 2) | i));

443 ià(
	`¦si_skb_wÜk_š™
(
sdev
, 
NULL
, &sdev->
rx_dbg_§p
, "¦si_wÏn_rx_dbg_§p", 
¦si_rx_dbg_§p_wÜk
) != 0)

444 
”r_if
;

446 ià(
	`¦si_Ãtif_š™
(
sdev
) != 0) {

447 
	`SLSI_ERR
(
sdev
, "Can‚ot createhe‚etwork interface\n");

448 
”r_ù¾_wq_š™
;

450 
	`¦si_h_š™
(
sdev
, 
dev
);

452 ià(
	`¦si_udi_node_š™
(
sdev
, 
dev
) != 0) {

453 
	`SLSI_ERR
(
sdev
, "failedo init UDI\n");

454 
”r_h_š™
;

457 
	`¦si_ü—‹_´oc_dœ
(
sdev
);

460 
	`¦si_»gd_š™
(
sdev
);

462 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


463 
	`¦si_Æ80211_v’dÜ_š™
(
sdev
);

466 ià(
	`¦si_cfg80211_»gi¡”
(
sdev
) != 0) {

467 
	`SLSI_ERR
(
sdev
, "failedo„egister with cfg80211\n");

468 
”r_udi_´oc_š™
;

471 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

472 
sdev
->
š‘6addr_nÙif›r
.
nÙif›r_ÿÎ
 = 
¦si_dev_š‘6addr_chªged
;

473 ià(
	`»gi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
) != 0) {

474 
	`SLSI_ERR
(
sdev
, "failedo„egister inet6addr_notifier\n");

475 
”r_cfg80211_»gi¡”ed
;

479 
sdev
->
š‘addr_nÙif›r
.
nÙif›r_ÿÎ
 = 
¦si_dev_š‘addr_chªged
;

480 ià(
	`»gi¡”_š‘addr_nÙif›r
(&
sdev
->
š‘addr_nÙif›r
) != 0) {

481 
	`SLSI_ERR
(
sdev
, "failedo„egister inetaddr_notifier\n");

482 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

483 
	`uÄegi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
);

485 
”r_cfg80211_»gi¡”ed
;

488 #ifdeà
SLSI_TEST_DEV


489 
	`¦si_š™_Ãtdev_mac_addr
(
sdev
);

491 
	`¦si_rx_ba_š™
(
sdev
);

493 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]) != 0) {

494 
	`SLSI_ERR
(
sdev
, "failedo„egister with wlan‚etdev\n");

495 
”r_š‘addr_»gi¡”ed
;

497 #ifdeà
CONFIG_SCSC_WLAN_STA_ONLY


498 
	`SLSI_ERR
(
sdev
, "CONFIG_SCSC_WLAN_STA_ONLY:‚ot„egistering…2p‚etdev\n");

500 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]) != 0) {

501 
	`SLSI_ERR
(
sdev
, "failedo„egister with…2p‚etdev\n");

502 
”r_wÏn_»gi¡”ed
;

504 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

505 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

506 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]) != 0) {

507 
	`SLSI_ERR
(
sdev
, "failedo„egister with…2px_wlan1‚etdev\n");

508 
”r_p2p_»gi¡”ed
;

510 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

513 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

514 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_NAN
]) != 0) {

515 
	`SLSI_ERR
(
sdev
, "failedo„egister with NAN‚etdev\n");

516 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

517 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

518 
”r_p2px_wÏn_»gi¡”ed
;

520 
”r_p2p_»gi¡”ed
;

523 
”r_p2p_»gi¡”ed
;

528 #ifdeà
CONFIG_SCSC_WLAN_KIC_OPS


529 ià(
	`wifi_kic_»gi¡”
(
sdev
) < 0)

530 
	`SLSI_ERR
(
sdev
, "failedo„egister Wi-Fi KIC ops\n");

532 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


533 
sdev
->
’hªûd_pkt_f‹r_’abËd
 = 
Œue
;

535 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

536 
sdev
->
cu¼’t_t¥ec_id
 = -1;

537 
sdev
->
t¥ec_”rÜ_code
 = -1;

540 
sdev
->
deviû_wq
 = 
	`®loc_Üd”ed_wÜkqueue
("slsi_wlan_wq", 0);

541 ià(!
sdev
->
deviû_wq
) {

542 
	`SLSI_ERR
(
sdev
, "Cannot‡llocate workqueue\n");

543 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

544 
”r_Çn_»gi¡”ed
;

546 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

547 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

548 
”r_p2px_wÏn_»gi¡”ed
;

550 
”r_p2p_»gi¡”ed
;

553 
”r_p2p_»gi¡”ed
;

557 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


558 #ià(
	`KERNEL_VERSION
(5, 12, 0è<ğ
LINUX_VERSION_CODE
)

559 
	`INIT_WORK
(&
sdev
->
Çn_d©a_š‹rçû_ü—‹_wÜk
, 
¦si_Çn_d©a_š‹rçû_ü—‹_wq
);

560 
	`INIT_WORK
(&
sdev
->
Çn_d©a_š‹rçû_d–‘e_wÜk
, 
¦si_Çn_d©a_š‹rçû_d–‘e_wq
);

561 
	`INIT_LIST_HEAD
(&
sdev
->
Çn_d©a_š‹rçû_ü—‹_d©a
);

562 
	`INIT_LIST_HEAD
(&
sdev
->
Çn_d©a_š‹rçû_d–‘e_d©a
);

565 
	`INIT_WORK
(&
sdev
->
»cov”y_wÜk_Ú_¡İ
, 
¦si_çu»_»£t
);

566 
	`INIT_WORK
(&
sdev
->
»cov”y_wÜk
, 
¦si_subsy¡em_»£t
);

567 
	`INIT_WORK
(&
sdev
->
»cov”y_wÜk_Ú_¡¬t
, 
¦si_ch_»cov”y
);

568 
	`INIT_WORK
(&
sdev
->
sy¡em_”rÜ_u£r_ç_wÜk
, 
¦si_sy¡em_”rÜ_»cov”y
);

569 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

570 
	`INIT_WORK
(&
sdev
->
ch£t_loggšg_wÜk
, 
¦si_cŞËù_ch£t_logs
);

572 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

573 
	`INIT_DELAYED_WORK
(&
sdev
->
uÅau£_¬p_q_wÜk
, 
¦si_¬p_q_¡uck_wÜk_hªdË
);

575 
	`¦si_cÚn_log2us_š™
(
sdev
);

576 
	`INIT_WORK
(&
sdev
->
Œigg”_wÏn_ç_wÜk
, 
¦si_Œigg”_£rviû_çu»
);

577  
sdev
;

579 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

580 
”r_Çn_»gi¡”ed
:

581 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_NAN
]);

584 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

585 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

586 
”r_p2px_wÏn_»gi¡”ed
:

587 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

588 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, 
NULL
);

592 
”r_p2p_»gi¡”ed
:

593 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]);

595 
”r_wÏn_»gi¡”ed
:

596 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

598 
”r_š‘addr_»gi¡”ed
:

599 
	`uÄegi¡”_š‘addr_nÙif›r
(&
sdev
->
š‘addr_nÙif›r
);

600 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

601 
	`uÄegi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
);

604 
”r_cfg80211_»gi¡”ed
:

605 
	`¦si_cfg80211_uÄegi¡”
(
sdev
);

607 
”r_udi_´oc_š™
:

608 
	`¦si_Œaffic_mÚ_ş›Ás_deš™
(
sdev
);

609 
	`¦si_»move_´oc_dœ
(
sdev
);

610 
	`¦si_udi_node_deš™
(
sdev
);

612 
”r_h_š™
:

613 
	`¦si_h_deš™
(
sdev
);

614 
	`¦si_Ãtif_deš™
(
sdev
);

616 
”r_ù¾_wq_š™
:

617 
	`¦si_skb_wÜk_deš™
(&
sdev
->
rx_dbg_§p
);

619 
”r_if
:

620 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl
);

621 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_mlme_evt
);

622 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_mlme
);

623 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_ma
);

624 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_rßm
);

625 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_š™
);

627 
	`¦si_cfg80211_ä“
(
sdev
);

628  
NULL
;

629 
	}
}

631 
	$¦si_dev_d‘ach
(
¦si_dev
 *
sdev
)

633 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Remove Device\n");

635 
	`¦si_¡İ
(
sdev
);

636 
	`¦si_cÚn_log2us_deš™
(
sdev
);

637 #iâdeà
SLSI_TEST_DEV


638 
	`kä“
(
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff
);

640 
	`¦si_qsf_deš™
();

642 #ifdeà
CONFIG_SCSC_WLAN_KIC_OPS


643 
	`wifi_kic_uÄegi¡”
();

645 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

646 
	`ÿnûl_d–ayed_wÜk_sync
(&
sdev
->
uÅau£_¬p_q_wÜk
);

648 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

649 
	`com¶‘e_®l
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

650 
	`com¶‘e_®l
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

651 
	`com¶‘e_®l
(&
sdev
->
»cov”y_com¶‘ed
);

652 
	`com¶‘e_®l
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

653 
	`com¶‘e_®l
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

655 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister inetaddr_notifier\n");

656 
	`uÄegi¡”_š‘addr_nÙif›r
(&
sdev
->
š‘addr_nÙif›r
);

658 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

659 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister inet6addr_notifier\n");

660 
	`uÄegi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
);

663 
	`WARN_ON
(!
sdev
->
deviû_wq
);

664 ià(
sdev
->
deviû_wq
)

665 
	`æush_wÜkqueue
(
sdev
->
deviû_wq
);

667 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


668 
	`¦si_Æ80211_v’dÜ_deš™
(
sdev
);

671 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister‚etif\n");

672 
	`¦si_Ãtif_»move_®l
(
sdev
);

674 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister cfg80211\n");

675 
	`¦si_cfg80211_uÄegi¡”
(
sdev
);

677 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Remove…rocƒntries\n");

678 
	`¦si_»move_´oc_dœ
(
sdev
);

680 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialisehe Traffic monitor\n");

681 
	`¦si_Œaffic_mÚ_ş›Ás_deš™
(
sdev
);

683 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialisehe UDI\n");

684 
	`¦si_log_ş›Ás_‹rmš©e
(
sdev
);

685 
	`¦si_udi_node_deš™
(
sdev
);

687 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialise Hip\n");

688 
	`¦si_h_deš™
(
sdev
);

690 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialise‚etif\n");

691 
	`¦si_Ãtif_deš™
(
sdev
);

693 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialise Regulatory\n");

694 
	`¦si_»gd_deš™
(
sdev
);

696 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Stop Work Queues\n");

697 
	`¦si_skb_wÜk_deš™
(&
sdev
->
rx_dbg_§p
);

699 #ifdeà
CONFIG_SCSC_WLAN_CPUHP_MONITOR


700 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialisehe CPU Hotplug Monitor\n");

701 
	`¦si_ıuhp_mÚ™Ü_deš™
();

704 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Clean up wakelocks\n");

705 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl
);

706 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_mlme_evt
);

707 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_mlme
);

708 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_ma
);

709 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_rßm
);

710 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_š™
);

712 #ifdeà
CONFIG_SCSC_WLAN_TX_API


713 
	`¦si_dev_d‘ach_po¡
(
sdev
);

715 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Free cfg80211\n");

716 
	`¦si_cfg80211_ä“
(
sdev
);

717 
	}
}

719 
__š™
 
	$¦si_dev_lßd
()

721 
	`SLSI_INFO_NODEV
("Loading Maxwell Wi-Fi driver\n");

723 ià(
	`¦si_udi_š™
())

724 
	`SLSI_INFO_NODEV
("Failedo init udi - continuing\n");

726 ià(
	`¦si_sm_£rviû_driv”_»gi¡”
())

727 
	`SLSI_INFO_NODEV
("slsi_sm_service_driver_register failed - continuing\n");

730 
	`§p_mlme_š™
();

731 
	`§p_ma_š™
();

732 
	`§p_dbg_š™
();

733 
	`§p_‹¡_š™
();

736 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 9

737 
	`¦si_ü—‹_sysfs_maÿddr
();

738 
	`¦si_ü—‹_sysfs_v”siÚ_šfo
();

740 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

741 
	`¦si_ü—‹_sysfs_debug_dump
();

742 
	`scsc_wÏn_mm­_ü—‹
();

744 
	`¦si_ü—‹_sysfs_pm
();

745 
	`¦si_ü—‹_sysfs_ªt
();

746 
	`SLSI_INFO_NODEV
("--- Maxwell Wi-Fi driver†oaded successfully ---\n");

748 
	}
}

750 
__ex™
 
	$¦si_dev_uÆßd
()

752 
	`SLSI_INFO_NODEV
("Unloading Maxwell Wi-Fi driver\n");

754 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 9

755 
	`¦si_de¡roy_sysfs_maÿddr
();

756 
	`¦si_de¡roy_sysfs_v”siÚ_šfo
();

758 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

759 
	`scsc_wÏn_mm­_de¡roy
();

760 
	`¦si_de¡roy_sysfs_debug_dump
();

762 
	`¦si_de¡roy_sysfs_pm
();

763 
	`¦si_de¡roy_sysfs_ªt
();

765 
	`§p_mlme_deš™
();

766 
	`§p_ma_deš™
();

767 
	`§p_dbg_deš™
();

768 
	`§p_‹¡_deš™
();

770 
	`¦si_sm_£rviû_driv”_uÄegi¡”
();

772 
	`¦si_udi_deš™
();

774 
	`SLSI_INFO_NODEV
("--- Maxwell Wi-Fi driver unloaded successfully ---\n");

775 
	}
}

777 
moduË_š™
(
¦si_dev_lßd
);

778 
moduË_ex™
(
¦si_dev_uÆßd
);

780 
MODULE_DESCRIPTION
("mx140 Wi-Fi Driver");

781 
MODULE_AUTHOR
("SLSI");

782 
MODULE_LICENSE
("GPL‡nd‡dditional„ights");

	@dev.h

7 #iâdeà
__SLSI_DEVICE_H__


8 
	#__SLSI_DEVICE_H__


	)

10 
	~<lšux/š™.h
>

11 
	~<lšux/deviû.h
>

12 
	~<lšux/š‘deviû.h
>

13 
	~<Ãt/addrcÚf.h
>

15 
	~<lšux/v”siÚ.h
>

16 
	~<lšux/moduË.h
>

17 
	~<lšux/¡ršg.h
>

18 
	~<lšux/k”Ãl.h
>

19 
	~<lšux/Ãtdeviû.h
>

20 
	~<lšux/‘h”deviû.h
>

21 
	~<lšux/¿‹lim™.h
>

22 
	~<lšux/.h
>

24 
	~<lšux/com¶‘iÚ.h
>

25 
	~<lšux/wÜkqueue.h
>

26 
	~<lšux/time.h
>

27 
	~<lšux/sched.h
>

28 
	~<lšux/v”siÚ.h
>

29 
	~<lšux/Æ80211.h
>

30 
	~<lšux/wœ–ess.h
>

31 
	~<lšux/´oc_fs.h
>

32 
	~<lšux/›“80211.h
>

33 
	~<Ãt/cfg80211.h
>

34 
	~<lšux/Æ80211.h
>

35 
	~<lšux/fœmw¬e.h
>

37 
	~<scsc/scsc_mx.h
>

39 
	~"çpi.h
"

40 
	~"cÚ¡.h
"

41 
	~"uts.h
"

42 
	~"h.h
"

43 
	~"log_ş›Ás.h
"

44 
	~"¤c_sšk.h
"

45 #iâdeà
CONFIG_SCSC_WLAN_TX_API


46 
	~"scsc_wifi_fcq.h
"

48 
	~"scsc_wifi_cm_if.h
"

49 
	~"h4.h
"

50 
	~"Æ80211_v’dÜ.h
"

51 
	~"Œaffic_mÚ™Ü.h
"

52 
	~"»g_šfo.h
"

54 
	#FAPI_MAJOR_VERSION
(
v
è(((vè>> 8è& 0xFF)

	)

55 
	#FAPI_MINOR_VERSION
(
v
è((vè& 0xFF)

	)

58 
	#SLSI_FREQ_BAND_AUTO
 0

	)

59 
	#SLSI_FREQ_BAND_5GHZ
 1

	)

60 
	#SLSI_FREQ_BAND_2GHZ
 2

	)

61 
	#SLSI_FREQ_BAND_2_4GHZ_5GHZ_6GHZ
 3

	)

62 
	#SLSI_FREQ_BAND_6GHZ
 4

	)

63 
	#SLSI_FREQ_BAND_5GHZ_6GHZ
 5

	)

64 
	#SLSI_FREQ_BAND_2_4GHZ_6GHZ
 6

	)

67 
	#SLSI_80211_MODE_11B
 0

	)

68 
	#SLSI_80211_MODE_11G
 1

	)

69 
	#SLSI_80211_MODE_11N
 2

	)

70 
	#SLSI_80211_MODE_11A
 3

	)

71 
	#SLSI_80211_MODE_11AC
 4

	)

72 
	#SLSI_80211_MODE_11AX
 5

	)

74 
	#SLSI_FW_API_RATE_HT_SELECTOR_FIELD
 0xc000

	)

75 
	#SLSI_FW_API_RATE_NON_HT_SELECTED
 0x4000

	)

76 
	#SLSI_FW_API_RATE_HT_SELECTED
 0x8000

	)

77 
	#SLSI_FW_API_RATE_VHT_SELECTED
 0xc000

	)

78 
	#SLSI_FW_API_RATE_HE_SELECTED
 0x10000

	)

80 
	#SLSI_FW_API_RATE_VHT_MCS_FIELD
 0x000F

	)

81 
	#SLSI_FW_API_RATE_HT_MCS_FIELD
 0x003F

	)

82 
	#SLSI_FW_API_RATE_INDEX_FIELD
 0x1fff

	)

83 
	#SLSI_FW_API_RATE_VHT_NSS_FIELD
 0x0070

	)

84 
	#SLSI_FW_API_RATE_HT_NSS_FIELD
 0x0040

	)

86 
	#SLSI_FW_API_RATE_BW_FIELD
 0x0600

	)

87 
	#SLSI_FW_API_RATE_BW_40MHZ
 0x0200

	)

88 
	#SLSI_FW_API_RATE_BW_20MHZ
 0x0000

	)

90 
	#SLSI_FW_API_RATE_SGI
 0x0100

	)

91 
	#SLSI_FW_API_RATE_GF
 0x0080

	)

92 
	#SLSI_FW_API_RATE_11AX_GI_POSN
 17

	)

93 
	#SLSI_FW_API_RATE_11AX_GI
 (0x3 << 
SLSI_FW_API_RATE_11AX_GI_POSN
)

	)

94 
	#SLSI_FW_API_GET_11AX_GI
(
v®
è((v® & 
SLSI_FW_API_RATE_11AX_GI
è>> 
SLSI_FW_API_RATE_11AX_GI_POSN
)

	)

96 
	#HEAD_SAR_BACKOFF_DISABLED
 -1

	)

97 
	#HEAD_SAR_BACKOFF_ENABLED
 0

	)

98 
	#BODY_SAR_BACKOFF_DISABLED
 1

	)

99 
	#BODY_SAR_BACKOFF_ENABLED
 2

	)

100 
	#NR_MMWAVE_SAR_BACKOFF_DISABLED
 3

	)

101 
	#NR_MMWAVE_SAR_BACKOFF_ENABLED
 4

	)

102 
	#NR_SUB6_SAR_BACKOFF_DISABLED
 5

	)

103 
	#NR_SUB6_SAR_BACKOFF_ENABLED
 6

	)

104 
	#SAR_BACKOFF_DISABLE_ALL
 7

	)

105 
	#MHS_SAR_BACKOFF_DISABLED
 8

	)

106 
	#MHS_SAR_BACKOFF_ENABLED
 9

	)

108 
	#SUB6_SAR_1_BAND
 7

	)

109 
	#SUB6_SAR_2_BAND
 38

	)

110 
	#SUB6_SAR_3_BAND
 40

	)

111 
	#SUB6_SAR_4_BAND
 41

	)

112 
	#SUB6_SAR_5_BAND
 77

	)

113 
	#SUB6_SAR_6_BAND
 78

	)

115 
	#SLSI_HOSTSTATE_LCD_ACTIVE
 0x0001

	)

116 
	#SLSI_HOSTSTATE_CELLULAR_ACTIVE
 0x0002

	)

117 
	#SLSI_HOSTSTATE_MHS_SAR_ACTIVE
 0x0010

	)

118 
	#SLSI_HOSTSTATE_HEAD_SAR_ACTIVE
 0x0020

	)

119 
	#SLSI_HOSTSTATE_GRIP_SAR_ACTIVE
 0x0040

	)

120 
	#SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
 0x0080

	)

121 
	#SLSI_HOSTSTATE_SAR_INIT_MASK
 0x0083

	)

122 
	#SLSI_HOSTSTATE_BASE_MASK
 0x000C

	)

123 
	#SLSI_HOSTSTATE_BASE_NONE
 0

	)

124 
	#SLSI_HOSTSTATE_BASE_MMW
 1

	)

125 
	#SLSI_HOSTSTATE_BASE_SUB6
 2

	)

126 
	#SLSI_HOSTSTATE_BASE_POS
 2

	)

127 
	#SLSI_HOSTSTATE_SUB6_BAND_MASK
 0x0700

	)

128 
	#SLSI_HOSTSTATE_SUB6_BAND_POS
 8

	)

129 
	#SLSI_HOST_TAG_ARP_MASK
 
	`BIT
(15)

	)

130 
	#SLSI_ARP_UNPAUSE_THRESHOLD
 4

	)

132 
	#SLSI_MIN_RTT_ID
 1

	)

133 
	#SLSI_MAX_RTT_ID
 7

	)

135 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


136 
	#SLSI_MAX_ARP_SEND_FRAME
 8

	)

139 
	#HOME_TIME_BIT
 
	`BIT
(0)

	)

140 
	#HOME_AWAY_TIME_BIT
 
	`BIT
(1)

	)

141 
	#MAX_CHANNEL_TIME_BIT
 
	`BIT
(2)

	)

142 
	#MAX_CHANNEL_PASSIVE_TIME_BIT
 
	`BIT
(3)

	)

143 
	#LATENCY_ALL_SET_MASK
 (
HOME_TIME_BIT
 | \

144 
HOME_AWAY_TIME_BIT
 | \

145 
MAX_CHANNEL_TIME_BIT
 | \

146 
MAX_CHANNEL_PASSIVE_TIME_BIT
)

	)

148 
	#FAPI_VIFTYPE_UNSYNCHRONISED
 0

	)

151 
	#SYSTEM_ERROR_BUFFER_SZ
 4096

	)

152 
	#SLSI_QSF_BUFF_LEN
 128

	)

160 cÚ¡ 
u16
 
	g¦si_¿‹s_bË
[3][2][12] = {

187 cÚ¡ 
u16
 
	g¦si_he_¿‹s_bË_2x2
[4][12][3] = {

215 
	smsduhdr
 {

216 
	mh_de¡
[
ETH_ALEN
];

217 
	mh_sourû
[
ETH_ALEN
];

218 
__be16
 
	mËn
;

219 
	md§p
;

220 
	ms§p
;

221 
	mui
;

222 
	moui
[3];

223 
__be16
 
	mty³
;

224 } 
__©Œibu‹__
((
·cked
));

226 
šlše
 
	$‘hr_ii_to_subäame_msdu
(
sk_buff
 *
skb
)

228 
‘hhdr
 *
ehdr
;

229 
msduhdr
 
msduh
;

231 
ehdr
 = 
	`‘h_hdr
(
skb
);

232 
	`‘h”_addr_cİy
(
msduh
.
h_de¡
, 
ehdr
->h_dest);

233 
	`‘h”_addr_cİy
(
msduh
.
h_sourû
, 
ehdr
->h_source);

235 
msduh
.
Ën
 = 
	`ıu_to_be16
(
skb
->len - 6);

236 
msduh
.
d§p
 = 0xaa;

237 
msduh
.
s§p
 = 0xaa;

238 
msduh
.
ui
 = 0x03;

239 
	`mem£t
(
msduh
.
oui
, 0x0, 3);

240 
msduh
.
ty³
 = 
ehdr
->
h_´Ùo
;

241 ()
	`skb_push
(
skb
, (
msduhdr
è- (
‘hhdr
));

243 
skb
->
mac_h—d”
 -ğ((
msduhdr
è- (
‘hhdr
));

244 
	`memıy
(
skb
->
d©a
, &
msduh
, (
msduhdr
));

245 
	}
}

247 
	#SLSI_TX_PROCESS_ID_MIN
 (0xC001)

	)

248 
	#SLSI_TX_PROCESS_ID_MAX
 (0xCF00)

	)

249 
	#SLSI_TX_PROCESS_ID_UDI_MIN
 (0xCF01)

	)

250 
	#SLSI_TX_PROCESS_ID_UDI_MAX
 (0xCFFE)

	)

256 
	#SLSI_RX_WAKELOCK_TIME
 (200)

	)

257 
	#SLSI_RX_PN_LEN
 6

	)

258 
	#MAX_BA_BUFFER_SIZE
 64

	)

259 
	#NUM_BA_SESSIONS_PER_PEER
 8

	)

260 
	#SLSI_NCHO_MAX_CHANNEL_LIST
 20

	)

261 
	#SLSI_NCHO_MAX_FREQUENCY_LIST
 20

	)

262 
	#SLSI_MAX_CHANNEL_LIST
 20

	)

263 
	#SLSI_MAX_FREQUENCY_LIST
 20

	)

264 
	#SLSI_MAX_RX_BA_SESSIONS
 (8)

	)

265 
	#SLSI_STA_ACTION_FRAME_BITMAP
 (
SLSI_ACTION_FRAME_PUBLIC
 | 
SLSI_ACTION_FRAME_WMM
 | 
SLSI_ACTION_FRAME_WNM
 |\

266 
SLSI_ACTION_FRAME_QOS
 | 
SLSI_ACTION_FRAME_PROTECTED_DUAL
)

	)

267 
	#SLSI_STA_ACTION_FRAME_SUSPEND_BITMAP
 (
SLSI_ACTION_FRAME_PUBLIC
 | 
SLSI_ACTION_FRAME_WMM
 | 
SLSI_ACTION_FRAME_WNM
 |\

268 
SLSI_ACTION_FRAME_QOS
 | 
SLSI_ACTION_FRAME_PROTECTED_DUAL
)

	)

271 
	#SLSI_DEFAULT_AP_DISCONNECT_IND_TIMEOUT
 3000

	)

273 
	#NUM_COUNTRY
 (300)

	)

275 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


276 
	#SLSI_MUTEX_INIT
(
¦si_mu‹x__
) \

278 (
¦si_mu‹x__
).
owÃr
 = 
NULL
; \

279 
	`mu‹x_š™
(&(
¦si_mu‹x__
).
mu‹x
); \

280 (
¦si_mu‹x__
).
v®id
 = 
Œue
; \

281 } 0)

	)

283 
	#SLSI_MUTEX_LOCK
(
¦si_mu‹x_to_lock
) \

285 (
¦si_mu‹x_to_lock
).
lše_no_befÜe
 = 
__LINE__
; \

286 (
¦si_mu‹x_to_lock
).
fe_Çme_befÜe
 = 
__FILE__
; \

287 
	`mu‹x_lock
(&(
¦si_mu‹x_to_lock
).
mu‹x
); \

288 (
¦si_mu‹x_to_lock
).
owÃr
 = 
cu¼’t
; \

289 (
¦si_mu‹x_to_lock
).
lše_no_aá”
 = 
__LINE__
; \

290 (
¦si_mu‹x_to_lock
).
fe_Çme_aá”
 = 
__FILE__
; \

291 (
¦si_mu‹x_to_lock
).
funùiÚ
 = 
__func__
; \

292 } 0)

	)

294 
	#SLSI_MUTEX_UNLOCK
(
¦si_mu‹x_to_uÆock
) \

296 (
¦si_mu‹x_to_uÆock
).
owÃr
 = 
NULL
; \

297 
	`mu‹x_uÆock
(&(
¦si_mu‹x_to_uÆock
).
mu‹x
); \

298 } 0)

	)

299 
	#SLSI_MUTEX_IS_LOCKED
(
¦si_mu‹x__
è
	`mu‹x_is_locked
(&(¦si_mu‹x__).
mu‹x
)

	)

301 
	s¦si_mu‹x
 {

302 
boŞ
 
	mv®id
;

303 
u32
 
	mlše_no_befÜe
;

304 cÚ¡ 
u8
 *
	mfe_Çme_befÜe
;

306 
mu‹x
 
	mmu‹x
;

307 
u32
 
	mlše_no_aá”
;

308 cÚ¡ 
u8
 *
	mfe_Çme_aá”
;

309 cÚ¡ 
u8
 *
	mfunùiÚ
;

310 
sk_¡ruù
 *
	mowÃr
;

314 
	#SLSI_MUTEX_INIT
(
mu‹x__
è
	`mu‹x_š™
(&(mu‹x__))

	)

315 
	#SLSI_MUTEX_LOCK
(
mu‹x_to_lock
è
	`mu‹x_lock
(&(mu‹x_to_lock))

	)

316 
	#SLSI_MUTEX_UNLOCK
(
mu‹x_to_uÆock
è
	`mu‹x_uÆock
(&(mu‹x_to_uÆock))

	)

317 
	#SLSI_MUTEX_IS_LOCKED
(
mu‹x__
è
	`mu‹x_is_locked
(&(mu‹x__))

	)

320 
	#OS_UNUSED_PARAMETER
(
x
è(()(x))

	)

322 
	#SLSI_HOST_TAG_TRAFFIC_QUEUE
(
hg
è(hg & 0x00000003)

	)

339 
	s¦si_sig_£nd
 {

341 
¥šlock_t
 
	m£nd_sigÇl_lock
;

342 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


343 
¦si_mu‹x
 
	mmu‹x
;

346 
mu‹x
 
	mmu‹x
;

348 
com¶‘iÚ
 
	mcom¶‘iÚ
;

350 
u16
 
	m´oûss_id
;

351 
u16
 
	m»q_id
;

352 
u16
 
	mcfm_id
;

353 
u16
 
	mšd_id
;

354 
sk_buff
 *
	mcfm
;

355 
sk_buff
 *
	mšd
;

356 
sk_buff
 *
	mmib_”rÜ
;

359 
šlše
 
	$¦si_sig_£nd_š™
(
¦si_sig_£nd
 *
sig_£nd
)

361 
	`¥š_lock_š™
(&
sig_£nd
->
£nd_sigÇl_lock
);

362 
sig_£nd
->
»q_id
 = 0;

363 
sig_£nd
->
cfm_id
 = 0;

364 
sig_£nd
->
´oûss_id
 = 
SLSI_TX_PROCESS_ID_MIN
;

365 
	`SLSI_MUTEX_INIT
(
sig_£nd
->
mu‹x
);

366 
	`š™_com¶‘iÚ
(&
sig_£nd
->
com¶‘iÚ
);

367 
	}
}

369 
	s¦si_ba_wšdow_’Œy
 {

370 
boŞ
 
	m£Á
;

371 
u16
 
	m¢
;

374 
	s¦si_ba_äame_desc
 {

375 
boŞ
 
	maùive
;

376 
sk_buff
 *
	msigÇl
;

377 
u16
 
	mtid
;

378 
u16
 
	m¢
;

379 
boŞ
 
	mæag_Şd_¢
;

380 
boŞ
 
	mæag_Şd_tdls
;

381 
u8
 
	m²
[
SLSI_RX_PN_LEN
];

384 
	s¦si_ba_£ssiÚ_rx
 {

385 
boŞ
 
	maùive
;

386 
boŞ
 
	mu£d
;

387 *
	mvif
;

388 
¦si_ba_wšdow_’Œy
 
	mba_wšdow
[
MAX_BA_BUFFER_SIZE
];

389 
¦si_ba_äame_desc
 
	mbufãr
[
MAX_BA_BUFFER_SIZE
];

390 
u16
 
	mbufãr_size
;

391 
u16
 
	moccup›d_¦Ùs
;

392 
u16
 
	mex³ùed_¢
;

393 
u16
 
	m¡¬t_¢
;

394 
u16
 
	mhighe¡_»ûived_¢
;

395 
boŞ
 
	mşosšg
;

396 
boŞ
 
	mŒigg”_ba_aá”_s¢
;

397 
u8
 
	mtid
;

400 
boŞ
 
	mtim”_Ú
;

401 
tim”_li¡
 
	mba_age_tim”
;

402 
Ãt_deviû
 *
	mdev
;

404 
¦si_³”
 *
	m³”
;

407 
u32
 
	mba_timeouts
;

408 
u32
 
	mba_drİs_Şd
;

409 
u32
 
	mba_drİs_»¶ay
;

412 
	#SLSI_TID_MAX
 (16)

	)

413 
	#SLSI_AMPDU_F_INITIATED
 (0x0001)

	)

414 
	#SLSI_AMPDU_F_CREATED
 (0x0002)

	)

415 
	#SLSI_AMPDU_F_OPERATIONAL
 (0x0004)

	)

417 
	#SLSI_SCAN_HW_ID
 0

	)

418 
	#SLSI_SCAN_SCHED_ID
 1

	)

419 
	#SLSI_SCAN_MAX
 3

	)

421 
	#SLSI_SCAN_SSID_MAP_MAX
 10

	)

422 
	#SLSI_SCAN_SSID_MAP_EXPIRY_AGE
 2

	)

423 
	#SLSI_FW_SCAN_DONE_TIMEOUT_MSEC
 (20 * 1000)

	)

424 
	#MAX_CHANNEL_COUNT
 40

	)

425 
	#SLSI_RX_SYNCH_IND_DELAY
 50

	)

426 
	#MAX_FREQUENCY_COUNT
 40

	)

428 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

429 
	e¦si_bss_£cur™y
 {

430 
	mSLSI_BSS_SECURED_NO
 = 
BIT
(0),

431 
	mSLSI_BSS_SECURED_PSK
 = 
BIT
(1),

432 
	mSLSI_BSS_SECURED_1x
 = 
BIT
(2),

433 
	mSLSI_BSS_SECURED_SAE
 = 
BIT
(3)

436 
	s¦si_ssid_šfo
 {

437 
li¡_h—d
 
	mli¡
;

438 
cfg80211_ssid
 
	mssid
;

439 
li¡_h—d
 
	mbssid_li¡
;

440 
u8
 
	makm_ty³
;

443 
	s¦si_bssid_šfo
 {

444 
li¡_h—d
 
	mli¡
;

445 
u8
 
	mbssid
[
ETH_ALEN
];

446 
u16
 
	mäeq
;

447 
	mrssi
;

448 
boŞ
 
	mcÚÃù_©‹m±ed
;

452 
	s¦si_bssid_bÏckli¡_šfo
 {

453 
li¡_h—d
 
	mli¡
;

454 
u8
 
	mbssid
[
ETH_ALEN
];

455 
	m’d_time
;

458 
	s¦si_ioùl_bÏckli¡_šfo
 {

459 
li¡_h—d
 
	mli¡
;

460 
u8
 
	mbssid
[
ETH_ALEN
];

463 
	s¦si_sÿn_»suÉ
 {

464 
u8
 
	mbssid
[
ETH_ALEN
];

465 
u8
 
	mhidd’
;

466 
	mrssi
;

467 
sk_buff
 *
	m´obe_»¥
;

468 
sk_buff
 *
	mb—cÚ
;

469 
¦si_sÿn_»suÉ
 *
	mÃxt
;

470 
	mbªd
;

471 
u8
 
	mssid
[32];

472 
u8
 
	mssid_Ëngth
;

473 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

474 
u8
 
	makm_ty³
;

481 
	s¦si_sÿn
 {

483 
cfg80211_sÿn_»que¡
 *
	msÿn_»q
;

484 
¦si_acs_»que¡
 *
	macs_»que¡
;

485 
cfg80211_sched_sÿn_»que¡
 *
	msched_»q
;

486 
boŞ
 
	m»queue_timeout_wÜk
;

489 
boŞ
 
	mis_blockšg_sÿn
;

491 
¦si_sÿn_»suÉ
 *
	msÿn_»suÉs
;

494 
	s¦si_ssid_m­
 {

495 
u8
 
	mbssid
[
ETH_ALEN
];

496 
u8
 
	mssid
[32];

497 
u8
 
	mssid_Ën
;

498 
u8
 
	mage
;

499 
	mbªd
;

502 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


503 
	s¦si_’hªûd_¬p_couÁ”s
 {

504 
u16
 
	m¬p_»q_couÁ_äom_Ãtdev
;

505 
u16
 
	m¬p_»q_couÁ_to_low”_mac
;

506 
u16
 
	m¬p_»q_rx_couÁ_by_low”_mac
;

507 
u16
 
	m¬p_»q_couÁ_tx_sucûss
;

508 
u16
 
	m¬p_r¥_rx_couÁ_by_low”_mac
;

509 
u16
 
	m¬p_r¥_rx_couÁ_by_uµ”_mac
;

510 
u16
 
	m¬p_r¥_couÁ_to_Ãtdev
;

511 
u16
 
	m¬p_r¥_couÁ_out_of_Üd”_drİ
;

512 
u16
 
	m­_lšk_aùive
;

513 
boŞ
 
	mis_du¶iÿ‹_addr_d‘eùed
;

517 
	s¦si_³”
 {

521 
boŞ
 
	mv®id
;

522 
u8
 
	madd»ss
[
ETH_ALEN
];

525 
u8
 
	mcÚÃùed_¡©e
;

526 
u16
 
	maid
;

527 
u16
 
	mæow_id
;

529 
boŞ
 
	mis_wps
;

530 
u16
 
	mÿ·b™›s
;

531 
boŞ
 
	mqos_’abËd
;

532 
u8
 
	mqueue£t
;

533 #iâdeà
CONFIG_SCSC_WLAN_TX_API


534 
scsc_wifi_fcq_d©a_q£t
 
	md©a_qs
;

535 
scsc_wifi_fcq_ù¾_q
 
	mù¾_q
;

537 
boŞ
 
	mauthÜized
;

538 
boŞ
 
	m·œwi£_key_£t
;

541 
sk_buff
 *
	massoc_›
;

542 
sk_buff_h—d
 
	mbufã»d_äames
;

544 
sk_buff
 *
	massoc_»¥_›
;

551 
u8
 
	mwmm_acm
;

557 
u8
 
	mt¥ec_e¡ablished
;

558 
u8
 
	mu­sd
;

565 
¡©iÚ_šfo
 
	msšfo
;

567 
¿‹lim™_¡©e
 
	msšfo_mib_g‘_rs
;

568 
u8
 
	mrx_²
[
NUM_BA_SESSIONS_PER_PEER
][
SLSI_RX_PN_LEN
];

569 
¦si_ba_£ssiÚ_rx
 *
	mba_£ssiÚ_rx
[
NUM_BA_SESSIONS_PER_PEER
];

572 
boŞ
 
	mqos_m­_£t
;

573 
cfg80211_qos_m­
 
	mqos_m­
;

574 
u16
 
	mndl_vif
;

575 
u8
 
	mndp_couÁ
;

576 #ifdeà
CONFIG_SCSC_WLAN_TX_API


577 *
	mtx_³”_d©a
;

582 
	#SLSI_VIFTYPE_UNSPECIFIED
 0xFFFF

	)

584 
	s¦si_vif_mgmt_tx
 {

585 
u64
 
	mcook›
;

586 
u16
 
	mho¡_g
;

587 cÚ¡ 
u8
 *
	mbuf
;

588 
size_t
 
	mbuf_Ën
;

589 
u8
 
	mexp_äame
;

592 
	s¦si_wmm_ac
 {

593 
u8
 
	maci_aif¢
;

594 
u8
 
	mecw
;

595 
u16
 
	mtxİ_lim™
;

596 } 
	g__·cked
;

610 
	s¦si_wmm_·¿m‘”_–em’t
 {

611 
u8
 
	meid
;

612 
u8
 
	mËn
;

613 
u8
 
	moui
[3];

614 
u8
 
	moui_ty³
;

615 
u8
 
	moui_subty³
;

616 
u8
 
	mv”siÚ
;

617 
u8
 
	mqos_šfo
;

618 
u8
 
	m»£rved
;

619 
¦si_wmm_ac
 
	mac
[4];

620 } 
	g__·cked
;

622 
	#SLSI_MIN_FILTER_ID
 0x80

	)

625 
	#SLSI_AP_ALL_IPV6_PKTS_FILTER_ID
 0x80

	)

628 #ià
IS_ENABLED
(
CONFIG_IPV6
)

630 
	e¦si_f‹r_id
 {

631 
	mSLSI_LOCAL_ARP_FILTER_ID
 = 
SLSI_MIN_FILTER_ID
,

632 
	mSLSI_ALL_BC_MC_FILTER_ID
,

633 
	mSLSI_LOCAL_NS_FILTER_ID
,

634 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


635 
	mSLSI_NAT_IPSEC_FILTER_ID
,

637 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


638 
	mSLSI_OPT_OUT_ALL_FILTER_ID
,

639 
	mSLSI_OPT_IN_TCP4_FILTER_ID
,

640 
	mSLSI_OPT_IN_TCP6_FILTER_ID
,

642 
	mSLSI_MULTI_TO_UNICAST_IPV4_ID
,

643 
	mSLSI_MULTI_TO_UNICAST_IPV6_ID
,

644 
	mSLSI_ALL_ARP_FILTER_ID
,

645 
	mSLSI_REGD_MC_FILTER_ID
,

648 
	e¦si_f‹r_id
 {

649 
	mSLSI_LOCAL_ARP_FILTER_ID
 = 
SLSI_MIN_FILTER_ID
,

650 
	mSLSI_ALL_BC_MC_FILTER_ID
,

651 
	mSLSI_ALL_IPV6_PKTS_FILTER_ID
,

652 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


653 
	mSLSI_NAT_IPSEC_FILTER_ID
,

655 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


656 
	mSLSI_OPT_OUT_ALL_FILTER_ID
,

657 
	mSLSI_OPT_IN_TCP4_FILTER_ID
,

658 
	mSLSI_OPT_IN_TCP6_FILTER_ID
,

660 
	mSLSI_MULTI_TO_UNICAST_IPV4_ID
,

661 
	mSLSI_ALL_ARP_FILTER_ID
,

662 
	mSLSI_REGD_MC_FILTER_ID
,

666 
	#SLSI_MAX_PKT_FILTERS
 16

	)

668 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


670 
	#SLSI_MC_ADDR_ENTRY_MAX
 (
SLSI_MIN_FILTER_ID
 + 
SLSI_MAX_PKT_FILTERS
 - 
SLSI_REGD_MC_FILTER_ID
)

	)

672 
	#SLSI_MC_ADDR_ENTRY_MAX
 (
SLSI_MIN_FILTER_ID
 + 
SLSI_MAX_PKT_FILTERS
 - 
SLSI_REGD_MC_FILTER_ID
 + 1)

	)

682 
	#SLSI_VIF_STATUS_UNSPECIFIED
 0

	)

683 
	#SLSI_VIF_STATUS_CONNECTING
 1

	)

684 
	#SLSI_VIF_STATUS_CONNECTED
 2

	)

685 
	#SLSI_VIF_STATUS_DISCONNECTING
 3

	)

688 
	#SLSI_MAX_KEEPALIVE_ID
 3

	)

690 
	s¦si_Ï¡_cÚÃùed_bss
 {

691 
u8
 
	madd»ss
[
ETH_ALEN
];

692 
	mª‹Âa_mode
;

693 
	mrssi
;

694 
	mmode
;

695 
	m·s¥ošt_v”siÚ
;

696 
	m¢r
;

697 
	mnoi£_Ëv–
;

698 
u16
 
	mbªdwidth
;

699 
u16
 
	mrßmšg_couÁ
;

700 
u16
 
	mchªÃl_äeq
;

701 
u16
 
	mtx_d©a_¿‹
;

702 
u8
 
	mrßmšg_akm
;

703 
u8
 
	mkv
;

704 
u32
 
	mkv›
;

705 
boŞ
 
	mmimo_u£d
;

706 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
 + 1];

707 
u8
 
	mssid_Ën
;

710 
	e¦si_w·3_auth_¡©e
 {

711 
	mSLSI_WPA3_PREAUTH
,

712 
	mSLSI_WPA3_AUTHENTICATING
,

713 
	mSLSI_WPA3_AUTHENTICATED


716 
	s¦si_vif_¡a
 {

718 
u8
 
	mvif_¡©us
;

719 
boŞ
 
	mis_wps
;

720 
boŞ
 
	mrßm_Ú_discÚÃù
;

721 
u16
 
	m—p_ho¡g
;

722 
u16
 
	mm4_ho¡_g
;

723 
u16
 
	mk“·live_ho¡_g
[
SLSI_MAX_KEEPALIVE_ID
];

725 
sk_buff
 *
	mrßm_mlme_´oûdu»_¡¬‹d_šd
;

730 
u16
 
	m»¥_id
;

731 
boŞ
 
	mg¿tu™ous_¬p_Ãeded
;

734 
u8
 
	m»gd_mc_addr_couÁ
;

735 
u8
 
	m»gd_mc_addr
[
SLSI_MC_ADDR_ENTRY_MAX
][
ETH_ALEN
];

736 
¦si_¥šlock
 
	m»gd_mc_addr_lock
;

738 
boŞ
 
	mgroup_key_£t
;

739 
boŞ
 
	mw•_key_£t
;

740 
sk_buff
 *
	mmlme_sÿn_šd_skb
;

741 
boŞ
 
	mrßm_š_´og»ss
;

742 
	mtdls_³”_¡a_»cÜds
;

743 
boŞ
 
	mtdls_’abËd
;

744 
cfg80211_bss
 *
	m¡a_bss
;

745 
u8
 *
	massoc_»q_add_šfo_–em
;

746 
	massoc_»q_add_šfo_–em_Ën
;

749 
li¡_h—d
 
	mÃtwÜk_m­
;

750 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

751 
li¡_h—d
 
	mssid_šfo
;

752 
li¡_h—d
 
	mbÏckli¡_h—d
;

755 
¦si_wmm_ac
 
	mwmm_ac
[4];

756 
boŞ
 
	mnd_ofæßd_’abËd
;

757 
	md©a_¿‹_mbps
;

758 
	mmax_¿‹_mbps
;

761 
¦si_Ï¡_cÚÃùed_bss
 
	mÏ¡_cÚÃùed_bss
;

762 
cfg80211_üy±o_£‰šgs
 
	müy±o
;

765 
©omic_t
 
	mdrİ_rßmed_šd
;

766 
u8
 *
	mv’dÜ_discÚÃù_›s
;

767 
	mv’dÜ_discÚÃù_›s_Ën
;

768 
u8
 
	mbssid
[
ETH_ALEN
];

769 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
];

770 
u8
 
	mssid_Ën
;

771 
u8
 *
	mr¢_›
;

772 
	mr¢_›_Ën
;

773 
	mu£_£t_pmk§
;

776 
u16
 
	mchªÃls_24_ghz
;

777 
u32
 
	mchªÃls_5_ghz
;

778 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

779 
boŞ
 
	mdrv_bss_£ËùiÚ
;

780 
boŞ
 
	mdrv_cÚÃù_»q_Úgošg
;

783 
cfg80211_cÚÃù_·¿ms
 
	msme
;

784 cÚ¡ 
u8
 *
	mcÚÃùed_bssid
;

785 cÚ¡ 
u8
 *
	mcÚÃùed_ssid
;

786 
	mcÚÃùed_ssid_Ën
;

787 
u8
 
	makm_ty³
;

788 
	mb—cÚ_št
;

789 
¦si_w·3_auth_¡©e
 
	mw·3_auth_¡©e
;

790 
u32
 
	maùiÚ_äame_bm­
;

791 
u32
 
	maùiÚ_äame_su¥’d_bm­
;

792 
boŞ
 
	mw·3_§e_»cÚÃùiÚ
;

794 
	mcÚÃù_úf_time
;

795 
u16
 
	mbss_cf
;

796 
u16
 
	mch_width
;

797 
u16
 
	m´im¬y_chª_pos
;

798 
u16
 
	m§e_auth_ty³
;

799 
u16
 
	mowe_group_duršg_cÚÃùiÚ
;

802 
	s¦si_vif_unsync
 {

803 
d–ayed_wÜk
 
	mroc_expœy_wÜk
;

804 
d–ayed_wÜk
 
	md–_vif_wÜk
;

805 
d–ayed_wÜk
 
	mhs2_d–_vif_wÜk
;

806 
d–ayed_wÜk
 
	mun£t_chªÃl_expœy_wÜk
;

807 
u64
 
	mroc_cook›
;

808 
u8
 *
	m´obe_r¥_›s
;

809 
size_t
 
	m´obe_r¥_›s_Ën
;

810 
boŞ
 
	m›s_chªged
;

811 
boŞ
 
	mli¡’_ofæßd
;

812 
boŞ
 
	m¦si_p2p_cÚtšuous_fuÎsÿn
;

815 
	s¦si_Ï¡_discÚÃùed_¡a
 {

816 
u8
 
	madd»ss
[
ETH_ALEN
];

817 
u32
 
	mrx_»Œy_·ck‘s
;

818 
u32
 
	mrx_bc_mc_·ck‘s
;

819 
u16
 
	mÿ·b™›s
;

820 
	mbªdwidth
;

821 
	mª‹Âa_mode
;

822 
	mrssi
;

823 
	mmode
;

824 
u16
 
	mtx_d©a_¿‹
;

825 
boŞ
 
	mmimo_u£d
;

826 
u16
 
	m»asÚ
;

827 
	msuµÜt_mode
;

828 
	msuµÜ‹d_bªd
;

831 
	s¦si_vif_­
 {

832 
¦si_wmm_·¿m‘”_–em’t
 
	mwmm_›
;

833 
¦si_Ï¡_discÚÃùed_¡a
 
	mÏ¡_discÚÃùed_¡a
;

834 
u8
 *
	mÿche_wmm_›
;

835 
u8
 *
	mÿche_w·_›
;

836 
u8
 *
	madd_šfo_›s
;

837 
size_t
 
	mwmm_›_Ën
;

838 
size_t
 
	mw·_›_Ën
;

839 
size_t
 
	madd_šfo_›s_Ën
;

840 
boŞ
 
	mp2p_gc_keys_£t
;

841 
boŞ
 
	m´ivacy
;

842 
boŞ
 
	mqos_’abËd
;

843 
	mb—cÚ_š‹rv®
;

844 
	mmode
;

845 
boŞ
 
	mnÚ_ht_bss_´e£Á
;

846 #iâdeà
CONFIG_SCSC_WLAN_TX_API


847 
scsc_wifi_fcq_d©a_q£t
 
	mgroup_d©a_qs
;

849 
u32
 
	mch”
;

850 
u16
 
	mchªÃl_äeq
;

851 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
];

852 
u8
 
	mssid_Ën
;

853 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


854 
cfg80211_aş_d©a
 *
	maş_d©a_bÏckli¡
;

858 
	s¦si_Çn_ndl_šfo
 {

859 
u8
 
	m³”_nmi
[
ETH_ALEN
];

860 
s8
 
	mndp_couÁ
;

863 
	s¦si_Çn_discov”y_šfo
 {

864 
u8
 
	m³”_addr
[
ETH_ALEN
];

865 
u8
 
	m£ssiÚ_id
;

866 
u8
 
	mm©ch_id
;

867 
¦si_Çn_discov”y_šfo
 *
	mÃxt
;

870 
	endp_¦Ù_¡©us
 {

871 
	mndp_¦Ù_¡©us_ä“
,

872 
	mndp_¦Ù_¡©us_š_u£
,

873 
	mndp_¦Ù_¡©us_‹rmš©šg
,

876 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


877 
	s¦si_vif_Çn
 {

878 
¦si_h®_Çn_cÚfig_»q
 
	mcÚfig
;

879 
u32
 
	m£rviû_id_m­
;

880 
u32
 
	mfŞlowup_id_m­
;

881 
u32
 
	mndp_š¡ªû_id_m­
;

882 
u32
 
	mÃxt_£rviû_id
;

883 
u32
 
	mÃxt_ndp_š¡ªû_id
;

884 
u16
 
	mndp_aùive_id_m­
;

885 
¦si_Çn_ndl_šfo
 
	mndl_li¡
[
SLSI_NAN_MAX_NDP_INSTANCES
];

886 
u8
 
	mndp_ndi
[
SLSI_NAN_MAX_NDP_INSTANCES
][
ETH_ALEN
];

887 
u16
 
	mndp_š¡ªû_id2ndl_vif
[
SLSI_NAN_MAX_NDP_INSTANCES
];

888 
u16
 
	mndp_loÿl_ndp_š¡ªû_id
[
SLSI_NAN_MAX_NDP_INSTANCES
];

889 
ndp_¦Ù_¡©us
 
	mndp_¡©e
[
SLSI_NAN_MAX_NDP_INSTANCES
];

894 
u16
 
	mfŞlowup_Œªs_id_m­
[
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
][2];

895 
com¶‘iÚ
 
	mndp_d–ay
;

897 
u8
 
	mdi§bË_şu¡”_m”ge
;

898 
u16
 
	mÇn_sdf_æags
[
SLSI_NAN_MAX_SERVICE_ID
 + 1];

900 
u8
 
	mndp_couÁ
;

902 
u8
 
	mloÿl_nmi
[
ETH_ALEN
];

903 
u32
 
	mİ”©šg_chªÃl
[2];

904 
u8
 
	mrŞe
;

905 
u8
 
	m¡©e
;

906 
u8
 
	mma¡”_´ef_v®ue
;

907 
u32
 
	mamr_low”
;

908 
u32
 
	mamr_high”
;

909 
u8
 
	mhİcouÁ
;

910 
u32
 
	m¿ndom_mac_š‹rv®_£c
;

911 
u8
 
	mm©chid
;

912 
¦si_Çn_discov”y_šfo
 *
	mdisc_šfo
;

913 
	mndp_¡¬t_time
;

914 
	mÇn_’abË_¡©us
;

918 
	#TCP_ACK_SUPPRESSION_RECORDS_MAX
 16

	)

919 
	#TCP_ACK_SUPPRESSION_RECORD_UNUSED_TIMEOUT
 10

	)

921 
	#TCP_ACK_SUPPRESSION_OPTIONS_OFFSET
 20

	)

922 
	#TCP_ACK_SUPPRESSION_OPTION_EOL
 0

	)

923 
	#TCP_ACK_SUPPRESSION_OPTION_NOP
 1

	)

924 
	#TCP_ACK_SUPPRESSION_OPTION_MSS
 2

	)

925 
	#TCP_ACK_SUPPRESSION_OPTION_WINDOW
 3

	)

926 
	#TCP_ACK_SUPPRESSION_OPTION_SACK
 5

	)

928 
	#SLSI_IS_VIF_CHANNEL_5G
(
ndev_vif
è((Òdev_vif)->
chª
è? (Òdev_vif)->chª->
hw_v®ue
 > 14è: 0)

	)

930 
	s¦si_tı_ack_s
 {

931 
u32
 
	mdaddr
;

932 
u32
 
	mdpÜt
;

933 
u32
 
	m§ddr
;

934 
u32
 
	m¥Üt
;

935 
sk_buff_h—d
 
	mli¡
;

936 
u8
 
	mwšdow_muÉl›r
;

937 
u16
 
	mmss
;

938 
u32
 
	mack_£q
;

939 
u16
 
	m¦ow_¡¬t_couÁ
;

940 
u8
 
	mcouÁ
;

941 
u8
 
	mmax
;

942 
u8
 
	mage
;

943 
tim”_li¡
 
	mtim”
;

944 
boŞ
 
	m¡©e
;

945 
ktime_t
 
	mÏ¡_£Á
;

946 
boŞ
 
	mtı_¦ow_¡¬t
;

949 
u16
 
	mhy¡”esis
;

950 
u32
 
	mÏ¡_tı_¿‹
;

951 
ktime_t
 
	mÏ¡_§m¶e_time
;

952 
u32
 
	mÏ¡_ack_£q
;

953 
u64
 
	mnum_by‹s
;

954 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


955 
u8
 
	m¡»am_id
;

956 
u8
 
	mrx_wšdow_sÿË
;

958 
Ãtdev_vif
 *
	mndev_vif
;

961 
	s¦si_tı_ack_¡©s
 {

962 
u32
 
	mck_acks
;

963 
u32
 
	mck_suµ»s£d
;

964 
u32
 
	mck_£Á
;

965 
u32
 
	mck_max
;

966 
u32
 
	mck_timeout
;

967 
u32
 
	mck_dacks
;

968 
u32
 
	mck_§cks
;

969 
u32
 
	mck_d–ay_acks
;

970 
u32
 
	mck_low_wšdow
;

971 
u32
 
	mck_noÿche
;

972 
u32
 
	mck_nÜecÜd
;

973 
u32
 
	mck_hasd©a
;

974 
u32
 
	mck_psh
;

975 
u32
 
	mck_drİ³d
;

976 
u32
 
	mck_ktime
;

977 
u32
 
	mck_Ï¡»cÜd
;

978 
u32
 
	mck_£¬ch»cÜd
;

979 
u32
 
	mck_eû
;

982 
	#SLSI_NETIF_SET_TID_OFF
 0

	)

983 
	#SLSI_NETIF_SET_TID_ALL_UDP
 1

	)

985 
	s¦si_Ãtif_£t_tid_©Œ
 {

986 
u8
 
	mmode
;

987 
u32
 
	muid
;

988 
u8
 
	mtid
;

991 
	sÃtdev_vif
 {

992 
¦si_dev
 *
	msdev
;

993 
wœ–ess_dev
 
	mwdev
;

994 
©omic_t
 
	mis_»gi¡”ed
;

995 
boŞ
 
	mis_avaabË
;

996 
boŞ
 
	mis_fw_‹¡
;

997 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

998 
boŞ
 
	mis_ws_ruÂšg
;

1004 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1005 
¦si_mu‹x
 
	mvif_mu‹x
;

1008 
mu‹x
 
	mvif_mu‹x
;

1010 
¦si_sig_£nd
 
	msig_wa™
;

1011 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


1012 
¦si_skb_wÜk
 
	mrx_d©a
;

1014 
¦si_skb_wÜk
 
	mrx_mlme
;

1015 
u16
 
	miâum
;

1016 
Æ80211_iáy³
 
	miáy³
;

1017 
›“80211_chªÃl
 *
	mchª
;

1018 
u16
 
	mdriv”_chªÃl
;

1019 
boŞ
 
	mdrv_š_p2p_´oûdu»
;

1020 
cfg80211_chª_def
 *
	mchªdef
;

1021 
cfg80211_chª_def
 
	mchªdef_§ved
;

1027 
__be32
 
	madd»ss
;

1029 #ià
IS_ENABLED
(
CONFIG_IPV6
)

1030 
š6_addr
 
	mv6add»ss
;

1031 
¦si_¥šlock
 
	mv6addr_lock
;

1033 
Ãt_deviû_¡©s
 
	m¡©s
;

1034 
u32
 
	mrx_·ck‘s
[
SLSI_LLS_AC_MAX
];

1035 
u32
 
	mtx_·ck‘s
[
SLSI_LLS_AC_MAX
];

1036 
u32
 
	mtx_no_ack
[
SLSI_LLS_AC_MAX
];

1037 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1038 
¦si_mu‹x
 
	msÿn_mu‹x
;

1039 
¦si_mu‹x
 
	msÿn_»suÉ_mu‹x
;

1042 
mu‹x
 
	msÿn_mu‹x
;

1043 
mu‹x
 
	msÿn_»suÉ_mu‹x
;

1046 
¦si_sÿn
 
	msÿn
[
SLSI_SCAN_MAX
];

1048 
¦si_¤c_sšk_·¿ms
 
	m¤c_sšk_·¿ms
;

1049 
u16
 
	mpow”_mode
;

1050 
u16
 
	m£t_pow”_mode
;

1052 
boŞ
 
	maùiv©ed
;

1053 
u16
 
	mvif_ty³
;

1054 
¦si_¥šlock
 
	m³”_lock
;

1055 
	m³”_¡a_»cÜds
;

1056 
¦si_³”
 *
	m³”_¡a_»cÜd
[
SLSI_ADHOC_PEER_CONNECTIONS_MAX
];

1063 
	mcfg80211_sšfo_g’”©iÚ
;

1066 
¦si_¥šlock
 
	mba_lock
;

1067 
sk_buff_h—d
 
	mba_com¶‘e
;

1068 
©omic_t
 
	mba_æush
;

1070 
u64
 
	mmgmt_tx_cook›
;

1071 
¦si_vif_mgmt_tx
 
	mmgmt_tx_d©a
;

1072 
d–ayed_wÜk
 
	msÿn_timeout_wÜk
;

1073 
d–ayed_wÜk
 
	mbÏckli¡_d–_wÜk
;

1074 
boŞ
 
	md–‘e_´obe_»q_›s
;

1078 
u8
 *
	m´obe_»q_›s
;

1079 
size_t
 
	m´obe_»q_›_Ën
;

1081 
¦si_vif_unsync
 
	munsync
;

1082 
¦si_vif_¡a
 
	m¡a
;

1083 
¦si_vif_­
 
	m­
;

1084 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1085 
¦si_vif_Çn
 
	mÇn
;

1087 
boŞ
 
	mmgmt_tx_gas_äame
;

1088 
u8
 
	mgas_äame_mac_addr
[
ETH_ALEN
];

1089 
boŞ
 
	macs
;

1091 
¦si_¥šlock
 
	mtı_ack_lock
;

1092 
¦si_tı_ack_s
 *
	mÏ¡_tı_ack
;

1093 
¦si_tı_ack_s
 
	mack_suµ»ssiÚ
[
TCP_ACK_SUPPRESSION_RECORDS_MAX
];

1094 
¦si_tı_ack_¡©s
 
	mtı_ack_¡©s
;

1096 
ktime_t
 
	mÏ¡_tim”_time
;

1097 
u32
 
	m»pÜt_time
;

1098 
u32
 
	mnum_by‹s_tx_³r_tim”
;

1099 
u32
 
	mnum_by‹s_rx_³r_tim”
;

1100 
u32
 
	mnum_by‹s_tx_³r_£c
;

1101 
u32
 
	mnum_by‹s_rx_³r_£c
;

1102 
u32
 
	mthroughput_tx
;

1103 
u32
 
	mthroughput_rx
;

1104 
u32
 
	mthroughput_tx_bps
;

1105 
u32
 
	mthroughput_rx_bps
;

1106 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


1107 
boŞ
 
	m’hªûd_¬p_d‘eù_’abËd
;

1108 
¦si_’hªûd_¬p_couÁ”s
 
	m’hªûd_¬p_¡©s
;

1109 
u8
 
	mrg‘__addr
[4];

1110 
	m’hªûd_¬p_ho¡_g
[
SLSI_MAX_ARP_SEND_FRAME
];

1112 
cfg80211_­_£‰šgs
 
	mbackup_£‰šgs
;

1113 #ià!
defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

1114 
©omic_t
 
	m¬p_tx_couÁ
;

1116 
wÜk_¡ruù
 
	msched_sÿn_¡İ_wk
;

1117 
u8
 
	mŒaffic_mÚ_¡©e
;

1118 
wÜk_¡ruù
 
	mŒaffic_mÚ_wÜk
;

1119 
wÜk_¡ruù
 
	m£t_muÉiÿ¡_f‹r_wÜk
;

1120 
¦si_Ãtif_£t_tid_©Œ
 
	m£t_tid_©Œ
;

1121 
wÜk_¡ruù
 
	mupd©e_pkt_f‹r_wÜk
;

1122 
boŞ
 
	mis_İt_out_·ck‘
;

1123 
cfg80211_aş_d©a
 *
	maş_d©a_suµliÿÁ
;

1124 
cfg80211_aş_d©a
 *
	maş_d©a_h®
;

1125 
li¡_h—d
 
	maş_d©a_fw_li¡
;

1126 
li¡_h—d
 
	maş_d©a_ioùl_li¡
;

1127 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1128 *
	mtx_Ãtdev_d©a
;

1132 
	s¦si_802_11d_»g_domaš
 {

1133 
u8
 *
	mcouÁryli¡
;

1134 
›“80211_»gdomaš
 *
	m»gdomaš
;

1135 
	mcouÁry_Ën
;

1138 
	s¦si_­f_ÿ·b™›s
 {

1139 
u16
 
	mv”siÚ
;

1140 
u16
 
	mmax_Ëngth
;

1143 
	s¦si_ioùl_¬gs
 {

1144 
	m¬g_couÁ
;

1145 
u8
 *
	m¬gs
[];

1148 
	s¦si_rßm_sÿn_chªÃls
 {

1149 
	mn
;

1150 
u8
 
	mchªÃls
[
SLSI_MAX_CHANNEL_LIST
];

1153 
	e¦si_sub6_¡©e
 {

1154 
	mSUB6_SAR_1
 = 1,

1155 
	mSUB6_SAR_2
,

1156 
	mSUB6_SAR_3
,

1157 
	mSUB6_SAR_4
,

1158 
	mSUB6_SAR_5
,

1159 
	mSUB6_SAR_6
,

1162 
	s¦si_dev_cÚfig
 {

1166 
	msuµÜ‹d_bªd
;

1168 
›“80211_suµÜ‹d_bªd
 *
	mbªd_6G
;

1169 
›“80211_suµÜ‹d_bªd
 *
	mbªd_5G
;

1170 
›“80211_suµÜ‹d_bªd
 *
	mbªd_2G
;

1177 
	mu£r_su¥’d_mode
;

1183 
	mrx_f‹r_num
;

1188 
boŞ
 
	mrx_f‹r_ruË_¡¬‹d
;

1191 
	#SLSI_NO_OF_SCAN_CHANLS_FOR_AUTO_CHAN_MAX
 14

	)

1192 
	m­_auto_chª
;

1195 
	mqos_šfo
;

1196 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1198 
	mokc_mode
;

1201 
	mwes_mode
;

1203 
	mrßm_sÿn_mode
;

1205 
	mdfs_sÿn_mode
;

1207 
	mncho_mode
;

1210 
¦si_rßm_sÿn_chªÃls
 
	mwes_rßm_sÿn_li¡
;

1212 
¦si_802_11d_»g_domaš
 
	mdomaš_šfo
;

1214 
¦si_rßm_sÿn_chªÃls
 
	mËgacy_rßm_sÿn_li¡
;

1216 
	m­_discÚÃù_šd_timeout
;

1218 
u16
 
	mho¡_¡©e
;

1219 
boŞ
 
	mho¡_¡©e_sub6_bªd
;

1221 
	mrssi_boo¡_5g
;

1222 
	mrssi_boo¡_2g
;

1223 
boŞ
 
	mdi§bË_ch12_ch13
;

1224 
boŞ
 
	mfw_’hªûd_¬p_d‘eù_suµÜ‹d
;

1225 
boŞ
 
	mfw_­f_suµÜ‹d
;

1226 
¦si_­f_ÿ·b™›s
 
	m­f_ÿp
;

1227 
	msuµÜ‹d_rßm_bªd
;

1230 
	#SLSI_DEVICE_STATE_ATTACHING
 0

	)

1231 
	#SLSI_DEVICE_STATE_STOPPED
 1

	)

1232 
	#SLSI_DEVICE_STATE_STARTING
 2

	)

1233 
	#SLSI_DEVICE_STATE_STARTED
 3

	)

1234 
	#SLSI_DEVICE_STATE_STOPPING
 4

	)

1236 
	#SLSI_NET_INDEX_WLAN
 1

	)

1237 
	#SLSI_NET_INDEX_P2P
 2

	)

1238 
	#SLSI_NET_INDEX_P2PX_SWLAN
 3

	)

1239 
	#SLSI_NET_INDEX_NAN
 4

	)

1240 
	#SLSI_NET_INDEX_DETECT
 (
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1)

	)

1243 
	e¦si_p2p_¡©es
 {

1244 
	mP2P_IDLE_NO_VIF
,

1245 
	mP2P_IDLE_VIF_ACTIVE
,

1246 
	mP2P_SCANNING
,

1247 
	mP2P_LISTENING
,

1248 
	mP2P_ACTION_FRAME_TX_RX
,

1249 
	mP2P_GROUP_FORMED_CLI
,

1250 
	mP2P_GROUP_FORMED_GO
,

1258 
	e¦si_wÏn_¡©e
 {

1259 
	mWLAN_UNSYNC_NO_VIF
 = 0,

1260 
	mWLAN_UNSYNC_VIF_ACTIVE
,

1261 
	mWLAN_UNSYNC_VIF_TX


1265 
	#SLSI_WAKELOCK_TIME_MSEC_EAPOL
 (1000)

	)

1267 
	s¦si_ch_šfo_mib
 {

1268 
u16
 
	mch_v”siÚ
;

1271 
	s¦si_¶©_šfo_mib
 {

1272 
u16
 
	m¶©_bud
;

1276 
šlše
 *
	$¦si_p2p_¡©e_‹xt
(
u8
 
¡©e
)

1278 
¡©e
) {

1279 
P2P_IDLE_NO_VIF
:

1281 
P2P_IDLE_VIF_ACTIVE
:

1283 
P2P_SCANNING
:

1285 
P2P_LISTENING
:

1287 
P2P_ACTION_FRAME_TX_RX
:

1289 
P2P_GROUP_FORMED_CLI
:

1291 
P2P_GROUP_FORMED_GO
:

1296 
	}
}

1298 
	#SLSI_WLAN_MAX_HCF_PLATFORM_LEN
 (128)

	)

1300 
	s¦si_dev_mib_šfo
 {

1301 *
	mmib_fe_Çme
;

1302 
	mmib_hash
;

1305 
u8
 *
	mmib_d©a
;

1306 
u32
 
	mmib_Ën
;

1307 
	m¶©fÜm
[
SLSI_WLAN_MAX_HCF_PLATFORM_LEN
];

1310 
	#SLSI_WLAN_MAX_MIB_FILE
 3

	)

1312 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1313 
	s¦si_dev_mib_cŞËù_fe
 {

1314 
	mfe_Çme
[32];

1315 
u16
 
	mËn
;

1316 
u8
 *
	md©a
;

1317 } 
	g__·cked
;

1319 
	s¦si_dev_mib_cŞËù
 {

1320 
boŞ
 
	m’abËd
;

1322 
¥šlock_t
 
	mš_cŞËùiÚ
;

1323 
	mnum_fes
;

1325 
¦si_dev_mib_cŞËù_fe
 
	mfe
[
SLSI_WLAN_MAX_MIB_FILE
 + 1];

1330 
	sbuff_li¡
 {

1331 
buff_li¡
 *
	mÃxt
;

1332 
u8
 
	m¡r
[256];

1333 
	mËn
;

1336 
	scÚn_log2us
 {

1338 
¥šlock_t
 
	mcÚn_lock
;

1339 
buff_li¡
 *
	mli¡
;

1340 
buff_li¡
 *
	mli¡_rßm_ÿnd
;

1341 
¿‹lim™_¡©e
 
	mrs
;

1342 
wÜk_¡ruù
 
	mlog2us_wÜk
;

1343 
wÜkqueue_¡ruù
 *
	mlog2us_wÜkq
;

1344 
	mbur¡
;

1345 
boŞ
 
	m¡İ
;

1346 
	mfuÎ_sÿn_rßm
;

1347 
u8
 
	m—pŞ_±k_msg_ty³
;

1348 
u16
 
	mho¡_g_—p
;

1349 
	m—p_»¥_Ën
;

1350 
boŞ
 
	mis_—pŞ_gtk
;

1351 
boŞ
 
	mis_—pŞ_±k
;

1352 
	m—p_¡r_ty³
;

1353 
boŞ
 
	mcÚn_æag
;

1354 
u32
 
	mbtcÛx_sco
:1;

1355 
u32
 
	mbtcÛx_sÿn
:1;

1356 
u32
 
	mbtcÛx_hid
:1;

1357 
	mrßm_­_couÁ
;

1358 
	mÿnd_numb”
;

1359 
	mÿnd_couÁ
;

1360 
	mrßm_äeq_couÁ
;

1361 
	mrßm_äeq_li¡
[
MAX_FREQUENCY_COUNT
];

1364 
	sši_cÚf
 {

1365 
u8
 *
	mši_cÚf_buff
;

1366 
u16
 
	mši_cÚf_buff_pos
;

1369 
	ssys_”rÜ_log
 {

1370 
	mpos
;

1371 *
	mlog_buf
;

1372 
	mlog_buf_size
;

1373 
mu‹x
 
	mlog_buf_mu‹x
;

1376 
	s¦si_dev
 {

1378 
deviû
 *
	mdev
;

1379 
why
 *
	mwhy
;

1381 
¦si_h
 
	mh
;

1382 
¦si_h4
 
	mh4_š¡
;

1384 
scsc_wifi_cm_if
 
	mcm_if
;

1385 
scsc_mx
 *
	mmaxw–l_cÜe
;

1386 
scsc_£rviû_ş›Á
 
	mmx_wÏn_ş›Á
;

1387 
scsc_£rviû
 *
	m£rviû
;

1388 
¦si_ch_šfo_mib
 
	mch_šfo_mib
;

1389 
¦si_¶©_šfo_mib
 
	m¶©_šfo_mib
;

1390 
u32
 
	m»g_dom_v”siÚ
;

1392 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1393 
¦si_mu‹x
 
	mÃtdev_add_»move_mu‹x
;

1396 
mu‹x
 
	mÃtdev_add_»move_mu‹x
;

1399 
mu‹x
 
	mÃtdev_»move_mu‹x
;

1400 
	mÃtdev_up_couÁ
;

1401 
Ãt_deviû
 
__rcu
 *
	mÃtdev
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

1402 
Ãt_deviû
 
__rcu
 *
	mÃtdev_­
;

1403 
Ãt_deviû
 
__rcu
 *
	mÃtdev_p2p
;

1404 
u8
 
	mÃtdev_add»s£s
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1][
ETH_ALEN
];

1405 
boŞ
 
	m»quœe_vif_d–‘e
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

1406 
	mdeviû_¡©e
;

1409 
u32
 
	magg_dev_throughput_tx
;

1410 
u32
 
	magg_dev_throughput_rx
;

1413 
©omic_t
 
	mš_·u£_¡©e
;

1414 
wÜk_¡ruù
 
	m»cov”y_wÜk_Ú_¡İ
;

1415 
wÜk_¡ruù
 
	m»cov”y_wÜk
;

1416 
wÜk_¡ruù
 
	m»cov”y_wÜk_Ú_¡¬t
;

1417 
wÜk_¡ruù
 
	mŒigg”_wÏn_ç_wÜk
;

1418 
wÜk_¡ruù
 
	msy¡em_”rÜ_u£r_ç_wÜk
;

1419 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

1420 
wÜk_¡ruù
 
	mch£t_loggšg_wÜk
;

1423 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1424 
¦si_mu‹x
 
	m¡¬t_¡İ_mu‹x
;

1427 
mu‹x
 
	m¡¬t_¡İ_mu‹x
;

1430 
¦si_log_ş›Ás
 
	mlog_ş›Ás
;

1431 *
	muf_cdev
;

1434 
	m´ocfs_š¡ªû
;

1435 
´oc_dœ_’Œy
 *
	m´ocfs_dœ
;

1438 
u8
 
	mhw_addr
[
ETH_ALEN
];

1439 
¦si_dev_mib_šfo
 
	mmib
[
SLSI_WLAN_MAX_MIB_FILE
];

1440 
¦si_dev_mib_šfo
 
	mloÿl_mib
;

1441 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1442 
¦si_dev_mib_cŞËù
 
	mcŞËù_mib
;

1444 *
	mmaddr_fe_Çme
;

1445 
boŞ
 *
	m‹rm_udi_u£rs
;

1446 *
	msig_wa™_cfm_timeout
;

1448 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1449 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

1450 
scsc_wake_lock
 
	mwÏn_wl
;

1451 
scsc_wake_lock
 
	mwÏn_wl_mlme_evt
;

1452 
scsc_wake_lock
 
	mwÏn_wl_mlme
;

1453 
scsc_wake_lock
 
	mwÏn_wl_ma
;

1454 
scsc_wake_lock
 
	mwÏn_wl_rßm
;

1455 
scsc_wake_lock
 
	mwÏn_wl_š™
;

1457 
wake_lock
 
	mwÏn_wl
;

1458 
scsc_wake_lock
 
	mwÏn_wl_mlme_evt
;

1459 
wake_lock
 
	mwÏn_wl_mlme
;

1460 
wake_lock
 
	mwÏn_wl_ma
;

1461 
wake_lock
 
	mwÏn_wl_rßm
;

1462 
wake_lock
 
	mwÏn_wl_š™
;

1465 
¦si_sig_£nd
 
	msig_wa™
;

1466 
¦si_skb_wÜk
 
	mrx_dbg_§p
;

1467 
©omic_t
 
	mtx_ho¡_g
[
SLSI_LLS_AC_MAX
];

1468 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1469 
¦si_mu‹x
 
	mdeviû_cÚfig_mu‹x
;

1472 
mu‹x
 
	mdeviû_cÚfig_mu‹x
;

1474 
¦si_dev_cÚfig
 
	mdeviû_cÚfig
;

1476 
nÙif›r_block
 
	mš‘addr_nÙif›r
;

1477 #ià
IS_ENABLED
(
CONFIG_IPV6
)

1478 
nÙif›r_block
 
	mš‘6addr_nÙif›r
;

1481 
wÜkqueue_¡ruù
 *
	mdeviû_wq
;

1482 
¦si_p2p_¡©es
 
	mp2p_¡©e
;

1484 
¦si_wÏn_¡©e
 
	mwÏn_unsync_vif_¡©e
;

1486 
	mcu¼’t_t¥ec_id
;

1487 
	mt¥ec_”rÜ_code
;

1488 
u8
 
	mp2p_group_exp_äame
;

1489 
boŞ
 
	mš™Ÿl_sÿn
;

1491 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1492 
¦si_gsÿn
 *
	mgsÿn
;

1493 
¦si_gsÿn_»suÉ
 *
	mgsÿn_hash_bË
[
SLSI_GSCAN_HASH_TABLE_SIZE
];

1494 
	mnum_gsÿn_»suÉs
;

1495 
	mbufãr_th»shŞd
;

1496 
	mbufãr_cÚsumed
;

1497 
¦si_buck‘
 
	mbuck‘
[
SLSI_GSCAN_MAX_BUCKETS
];

1498 
li¡_h—d
 
	mhÙli¡_»suÉs
;

1499 
boŞ
 
	m•no_aùive
;

1501 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1502 
u8
 
	msÿn_mac_addr
[6];

1503 
boŞ
 
	msÿn_addr_£t
;

1505 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1506 
	mmšÜ_´of
;

1508 
¦si_ba_£ssiÚ_rx
 
	mrx_ba_bufãr_poŞ
[
SLSI_MAX_RX_BA_SESSIONS
];

1509 
¦si_¥šlock
 
	mrx_ba_bufãr_poŞ_lock
;

1510 
boŞ
 
	mç_»pÜ‹d
;

1511 
boŞ
 
	mp2p_û¹if
;

1512 
boŞ
 
	mmlme_blocked
;

1513 
©omic_t
 
	mdebug_šds
;

1514 
	m»cov”y_Ãxt_¡©e
;

1515 
com¶‘iÚ
 
	m»cov”y_»move_com¶‘iÚ
;

1516 
com¶‘iÚ
 
	m»cov”y_¡İ_com¶‘iÚ
;

1517 
com¶‘iÚ
 
	m»cov”y_com¶‘ed
;

1518 
com¶‘iÚ
 
	m£rviû_ç_¡¬‹d_šdiÿtiÚ
;

1519 
com¶‘iÚ
 
	m»cov”y_ç_§ã_com¶‘e
;

1520 
	m»cov”y_¡©us
;

1521 
boŞ
 
	m»cov”y_ç_§ã
;

1522 
¦si_ssid_m­
 
	mssid_m­
[
SLSI_SCAN_SSID_MAP_MAX
];

1523 
boŞ
 
	mbªd_5g_suµÜ‹d
;

1524 
boŞ
 
	mbªd_6g_suµÜ‹d
;

1525 
	msuµÜ‹d_2g_chªÃls
[14];

1526 
	msuµÜ‹d_5g_chªÃls
[25];

1527 
	m’abËd_chªÃl_couÁ
;

1528 
boŞ
 
	mfw_ht_’abËd
;

1529 
u8
 
	mfw_ht_ÿp
[4];

1530 
boŞ
 
	mfw_vht_’abËd
;

1531 
u8
 
	mfw_vht_ÿp
[4];

1532 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


1533 
u8
 
	mwifi_sh¬šg_5ghz_chªÃl
[8];

1534 
	mv®id_5g_chª
[25];

1535 
	mwifi_sh¬šg_5g_»¡riùed_chªÃls
[25];

1536 
	mnum_5g_»¡riùed_chªÃls
;

1538 
boŞ
 
	mfw_SoáAp_2g_40mhz_’abËd
;

1539 
boŞ
 
	mÇn_’abËd
;

1540 
u16
 
	massoc_»suÉ_code
;

1541 
boŞ
 
	m®low_sw™ch_40_mhz
;

1542 
boŞ
 
	m®low_sw™ch_80_mhz
;

1543 #ifdeà
SCSC_SEP_VERSION


1545 
boŞ
 
	mdu®bªd_cÚcu¼’cy
;

1546 
u32
 
	msoá­_max_ş›Á
;

1548 
u32
 
	mfw_dw–l_time
;

1549 
u32
 
	m§e_dw–l_time
;

1550 
	mÎs_num_¿dio
;

1552 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1553 
¦si_mu‹x
 
	mlogg”_mu‹x
;

1556 
mu‹x
 
	mlogg”_mu‹x
;

1558 
¦si_Œaffic_mÚ_ş›Ás
 
	mŒaffic_mÚ_ş›Ás
;

1560 
¦si_¹t_id_·¿ms
 *
	m¹t_id_·¿ms
[
SLSI_MAX_RTT_ID
];

1561 
boŞ
 
	macs_chªÃl_sw™ched
;

1562 
	m»cov”y_timeout
;

1563 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1564 
boŞ
 
	mfw_mac_¿ndomiz©iÚ_’abËd
;

1567 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


1568 
boŞ
 
	m’hªûd_pkt_f‹r_’abËd
;

1570 
»g_d©aba£
 
	m»gdb
;

1571 
u8
 
	mfÜûd_bªdwidth
;

1572 
boŞ
 
	m»quœe_£rviû_şo£
;

1573 
boŞ
 
	mmac_chªged
;

1574 #ià!
defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

1575 
©omic_t
 
	mù¾_·u£_¡©e
;

1576 
u16
 
	mfw_max_¬p_couÁ
;

1577 
©omic_t
 
	m¬p_tx_couÁ
;

1579 
d–ayed_wÜk
 
	muÅau£_¬p_q_wÜk
;

1581 
u8
 
	mfw_ext_ÿp_›
[9];

1582 
u32
 
	mfw_ext_ÿp_›_Ën
;

1583 
¦si_¥šlock
 
	mÃtdev_lock
;

1584 
	mhome_time
;

1585 
	mhome_away_time
;

1586 
	mmax_chªÃl_time
;

1587 
	mmax_chªÃl_·ssive_time
;

1588 
	mwÏn_£rviû_Ú
;

1589 
boŞ
 
	md‘eù_vif_aùive
;

1590 
¦si_wÏn_driv”_wake_»asÚ_út
 
	mwake_»asÚ_¡©s
;

1591 
¦si_¥šlock
 
	mwake_¡©s_lock
;

1592 
u8
 
	mÏ‹ncy_·¿m_mask
;

1593 
boŞ
 
	mmax_dtim_»cv
;

1594 #iâdeà
SCSC_SEP_VERSION


1595 
boŞ
 
	mfÜûd_£_7
;

1597 
boŞ
 
	migmp_ofæßd_aùiv©ed
;

1598 
cÚn_log2us
 
	mcÚn_log2us_ùx
;

1599 
ši_cÚf
 
	mši_cÚf_¡ruù
;

1600 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1601 *
	mtx_sdev_d©a
;

1603 
	mdeçuÉ_sÿn_›s_Ën
;

1604 
u8
 *
	mdeçuÉ_sÿn_›s
;

1605 
sys_”rÜ_log
 
	msys_”rÜ_log_buf
;

1606 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1607 
u8
 
	mÇn_şu¡”_id
[
ETH_ALEN
];

1608 #ià(
KERNEL_VERSION
(5, 12, 0è<ğ
LINUX_VERSION_CODE
)

1609 
wÜk_¡ruù
 
	mÇn_d©a_š‹rçû_ü—‹_wÜk
;

1610 
wÜk_¡ruù
 
	mÇn_d©a_š‹rçû_d–‘e_wÜk
;

1611 
li¡_h—d
 
	mÇn_d©a_š‹rçû_ü—‹_d©a
;

1612 
li¡_h—d
 
	mÇn_d©a_š‹rçû_d–‘e_d©a
;

1615 
u32
 
	mfw_bud_id
;

1616 
u8
 
	mqsfs_ã©u»_£t
[
SLSI_QSF_BUFF_LEN
];

1617 
u32
 
	mqsf_ã©u»_£t_Ën
;

1625 
	s¦si_rßmšg_ÃtwÜk_m­_’Œy
 {

1626 
li¡_h—d
 
	mli¡
;

1627 
	mÏ¡_£’_jiff›s
;

1628 
cfg80211_ssid
 
	mssid
;

1629 
u8
 
	mš™Ÿl_bssid
[
ETH_ALEN
];

1630 
boŞ
 
	mÚly_Úe_­_£’
;

1631 
u16
 
	mchªÃls_24_ghz
;

1637 
u32
 
	mchªÃls_5_ghz
;

1638 
	mchªÃl_jiff›s
[39];

1641 
	#LLC_SNAP_HDR_LEN
 8

	)

1642 
	sÎc_¢­_hdr
 {

1643 
u8
 
	mÎc_d§p
;

1644 
u8
 
	mÎc_s§p
;

1645 
u8
 
	mÎc_ù¾
;

1646 
u8
 
	m¢­_oui
[3];

1647 
u16
 
	m¢­_ty³
;

1648 } 
	g__·cked
;

1650 
¦si_rx_d©a_d–iv”_skb
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
ùx_Çpi
);

1651 
¦si_rx_dbg_§p_wÜk
(
wÜk_¡ruù
 *
wÜk
);

1652 
¦si_rx_Ãtdev_d©a_wÜk
(
wÜk_¡ruù
 *
wÜk
);

1653 
¦si_rx_Ãtdev_mlme_wÜk
(
wÜk_¡ruù
 *
wÜk
);

1654 
¦si_rx_’queue_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 
vif
);

1655 
›“80211_chªÃl
 *
¦si_rx_sÿn_·ss_to_cfg80211
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1656 
sk_buff
 *
skb
, 
boŞ
 
»Ëa£_skb
);

1657 
¦si_rx_bufã»d_äames
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

1658 
¦si_rx_blockšg_sigÇls
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

1659 
¦si_sÿn_com¶‘e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
abÜ‹d
,

1660 
boŞ
 
æush_sÿn_»suÉs
);

1661 
¦si_tx_·u£_queues
(
¦si_dev
 *
sdev
);

1662 
¦si_tx_uÅau£_queues
(
¦si_dev
 *
sdev
);

1663 
¦si_tx_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1664 
¦si_tx_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1665 
¦si_tx_d©a_low”
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

1666 
boŞ
 
¦si_is_‹¡_mode_’abËd
();

1667 
boŞ
 
¦si_is_rf_‹¡_mode_’abËd
();

1668 
¦si_š™_Ãtdev_mac_addr
(
¦si_dev
 *
sdev
);

1669 
boŞ
 
¦si_dev_Îs_suµÜ‹d
();

1670 
boŞ
 
¦si_dev_gsÿn_suµÜ‹d
();

1671 
boŞ
 
¦si_dev_•no_suµÜ‹d
();

1672 
boŞ
 
¦si_dev_vo_vi_block_ack
();

1673 
¦si_dev_g‘_sÿn_»suÉ_couÁ
();

1674 
boŞ
 
¦si_dev_Î¦ogs_suµÜ‹d
();

1675 
¦si_dev_Çn_suµÜ‹d
(
¦si_dev
 *
sdev
);

1676 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1677 
boŞ
 
¦si_dev_Çn_is_v6_lšk_v_šşude
();

1678 
¦si_g‘_Çn_max_ndp_š¡ªûs
();

1679 
¦si_g‘_Çn_max_ndi_içûs
();

1680 
¦si_g‘_Çn_ndp_d–ay
();

1681 
¦si_g‘_Çn_ndp_max_time
();

1682 
boŞ
 
¦si_g‘_Çn_mac_¿ndom
();

1684 
boŞ
 
¦si_dev_6ghz_¥l™_sÿn_’abËd
();

1685 
¦si_sched_sÿn_¡İ³d
(
wÜk_¡ruù
 *
wÜk
);

1686 
boŞ
 
¦si_dev_¹t_suµÜ‹d
();

1687 
¦si_dev
 *
¦si_g‘_sdev
();

1688 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1689 
boŞ
 
is_msdu_’abË
();

1692 
¦si_dump_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
);

1693 
¦si_add_log_to_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
, *
šput_bufãr
);

1694 
¦si_´oûss_ši_cÚfig_fe
(
¦si_dev
 *
sdev
);

1696 
šlše
 
u16
 
	$¦si_tx_ho¡_g
(
¦si_dev
 *
sdev
, 
¦si_Œaffic_q
 
tq
)

1698 
u16
 
ho¡_g
 = 0;

1706 
ho¡_g
 = (
u16
)
	`©omic_add_»tuº
(4, &
sdev
->
tx_ho¡_g
[
tq
]);

1707 
ho¡_g
 &ğ~
SLSI_HOST_TAG_ARP_MASK
;

1709  
ho¡_g
;

1710 
	}
}

1712 
šlše
 
u16
 
	$¦si_tx_mgmt_ho¡_g
(
¦si_dev
 *
sdev
)

1715  
	`¦si_tx_ho¡_g
(
sdev
, 0);

1716 
	}
}

1718 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1719 
šlše
 
Ãt_deviû
 *
	$¦si_Çn_g‘_Ãtdev_rcu
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

1721 
u8
 
bÿ¡_addr
[
ETH_ALEN
] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

1722 
u8
 *
¤c_addr
 = 
NULL
;

1723 
u8
 *
de¡_addr
 = 
NULL
;

1724 
u8
 
idx
 = 0;

1726 
	`WARN_ON
(!
	`rcu_»ad_lock_h–d
());

1728 
	`çpi_g‘_sigid
(
skb
)) {

1729 
MA_BLOCKACKREQ_IND
:

1731 
›“80211_b¬
 *
b¬
 = (
	`çpi_g‘_d©®’
(
skb
)è? (›“80211_b¬ *)
	`çpi_g‘_d©a
(skbè: 
NULL
;

1733 ià(!
b¬
)

1734  
NULL
;

1735 
de¡_addr
 = 
b¬
->
¿
;

1738 
MLME_BLOCKACK_ACTION_IND
:

1740 
›“80211_mgmt
 *
mgmt
 = (
	`çpi_g‘_mgm’
(
skb
)è? 
	`çpi_g‘_mgmt
(skbè: 
NULL
;

1742 ià(!
mgmt
) {

1743 
de¡_addr
 = 
bÿ¡_addr
;

1744 
¤c_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_blockack_aùiÚ_šd
.
³”_¡a_add»ss
);

1746 
de¡_addr
 = 
mgmt
->
da
;

1750 
MA_UNITDATA_IND
:

1752 
›“80211_hdr
 *
hdr
 = (›“80211_hd¸*)
	`çpi_g‘_d©a
(
skb
);

1753 
u32
 
d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

1755 ià(!
hdr
 || 
d©a_Ën
 < (*hdr)) {

1756 
	`WARN
(1, "šv®id†’:%d\n", 
d©a_Ën
);

1757  
NULL
;

1760 
¤c_addr
 = 
	`›“80211_g‘_SA
(
hdr
);

1761 
de¡_addr
 = 
	`›“80211_g‘_DA
(
hdr
);

1765 
	`WARN
(1, "UnhªdËd sigÇl: 0x%.4x\n", 
	`çpi_g‘_sigid
(
skb
));

1766  
NULL
;

1769 
idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; idx <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; idx++) {

1770 
Ãtdev_vif
 *
ndev_vif
;

1771 
u8
 
i
 = 0;

1773 ià(
sdev
->
Ãtdev
[
idx
]) {

1783 ià(
de¡_addr
 && 
	`is_muÉiÿ¡_‘h”_addr
(dest_addr)) {

1784 
ndev_vif
 = (
Ãtdev_vif
 *)
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
idx
]);

1785 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

1786 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++) {

1787 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&

1788 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
v®id
 &&

1789 
¤c_addr
 &&

1790 
	`‘h”_addr_equ®
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
¤c_addr
)) {

1791 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

1792  
	`rcu_d”eã»nû
(
sdev
->
Ãtdev
[
idx
]);

1795 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

1796 } ià(
de¡_addr
 && 
	`‘h”_addr_equ®
(de¡_addr, 
sdev
->
Ãtdev
[
idx
]->
dev_addr
)) {

1797  
	`rcu_d”eã»nû
(
sdev
->
Ãtdev
[
idx
]);

1801  
NULL
;

1802 
	}
}

1805 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_rcu
(
¦si_dev
 *
sdev
, 
u16
 
iâum
)

1807 
	`WARN_ON
(!
	`rcu_»ad_lock_h–d
());

1808 ià(
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1810  
NULL
;

1812  
	`rcu_d”eã»nû
(
sdev
->
Ãtdev
[
iâum
]);

1813 
	}
}

1815 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_locked
(
¦si_dev
 *
sdev
, 
u16
 
iâum
)

1817 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1818 ià(
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1819 
	`WARN
(1, "iâum:%d", 
iâum
);

1820  
NULL
;

1822  
sdev
->
Ãtdev
[
iâum
];

1823 
	}
}

1825 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev
(
¦si_dev
 *
sdev
, 
u16
 
iâum
)

1827 
Ãt_deviû
 *
dev
;

1829 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1830 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
iâum
);

1831 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1833  
dev
;

1834 
	}
}

1836 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_mac_addr_locked
(
¦si_dev
 *
sdev
, 
u8
 *
mac_addr
, 
¡¬t_idx
)

1838 
i
;

1839 
dev_addr_z”o_check
[
ETH_ALEN
] = {0};

1841 ià(!
	`memcmp
(
mac_addr
, 
dev_addr_z”o_check
, 
ETH_ALEN
))

1842  
NULL
;

1844 ià(!
¡¬t_idx
)

1845 
¡¬t_idx
 = 1;

1846 
i
 = 
¡¬t_idx
; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

1847 ià(
sdev
->
Ãtdev
[
i
] && 
	`‘h”_addr_equ®
(
mac_addr
, sdev->Ãtdev[i]->
dev_addr
))

1848  
sdev
->
Ãtdev
[
i
];

1850  
NULL
;

1851 
	}
}

1853 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_mac_addr
(
¦si_dev
 *
sdev
, 
u8
 *
mac_addr
, 
¡¬t_idx
)

1855 
Ãt_deviû
 *
dev
;

1857 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1858 
dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr_locked
(
sdev
, 
mac_addr
, 
¡¬t_idx
);

1859 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1861  
dev
;

1862 
	}
}

1864 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_iâame_locked
(
¦si_dev
 *
sdev
, 
u8
 *
iâame
)

1866 
i
;

1868 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1869 
i
 = 1; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

1870 ià(
sdev
->
Ãtdev
[
i
] && 
	`¡rcmp
(
iâame
, sdev->Ãtdev[i]->
Çme
) == 0)

1871  
sdev
->
Ãtdev
[
i
];

1873  
NULL
;

1874 
	}
}

1876 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_iâame
(
¦si_dev
 *
sdev
, 
u8
 *
iâame
)

1878 
Ãt_deviû
 *
dev
;

1880 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1881 
dev
 = 
	`¦si_g‘_Ãtdev_by_iâame_locked
(
sdev
, 
iâame
);

1882 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1884  
dev
;

1885 
	}
}

1887 
šlše
 
	$¦si_g‘_suµÜ‹d_mode
(cÚ¡ 
u8
 *
³”_›
)

1889 cÚ¡ 
u8
 *
³”_›_d©a
;

1890 
u8
 
³”_›_Ën
;

1891 
i
;

1892 
suµÜ‹d_¿‹
;

1894 
³”_›_Ën
 = 
³”_›
[1];

1895 
³”_›_d©a
 = &
³”_›
[2];

1896 
i
 = 0; i < 
³”_›_Ën
; i++) {

1897 
suµÜ‹d_¿‹
 = ((
³”_›_d©a
[
i
] & 0x7F) / 2);

1898 ià(
suµÜ‹d_¿‹
 > 11)

1899  
SLSI_80211_MODE_11G
;

1901  
SLSI_80211_MODE_11B
;

1902 
	}
}

1904 
	#SLSI_WAKEUP_PKT_MARK
 0x80000000

	)

1907 *
¦si_mib_fe
;

1908 *
¦si_mib_fe2
;

1910 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


1911 
by·ss_backlog
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

	@fapi.h

9 #iâdeà
_FAPI_H__


10 
	#_FAPI_H__


	)

12 #ifdeà
__ılu¥lus


16 
	#FAPI_SIG_TYPE_MASK
 0x0F00

	)

17 
	#FAPI_SIG_TYPE_REQ
 0x0000

	)

18 
	#FAPI_SIG_TYPE_CFM
 0x0100

	)

19 
	#FAPI_SIG_TYPE_RES
 0x0200

	)

20 
	#FAPI_SIG_TYPE_IND
 0x0300

	)

22 
	#FAPI_SAP_TYPE_MASK
 0xF000

	)

23 
	#FAPI_SAP_TYPE_MA
 0x1000

	)

24 
	#FAPI_SAP_TYPE_MLME
 0x2000

	)

25 
	#FAPI_SAP_TYPE_DEBUG
 0x8000

	)

26 
	#FAPI_SAP_TYPE_TEST
 0x9000

	)

28 
	#FAPI_CONTROL_SAP_ENG_VERSION
 0x0000

	)

29 
	#FAPI_DEBUG_SAP_ENG_VERSION
 0x0000

	)

30 
	#FAPI_DATA_SAP_ENG_VERSION
 0x0000

	)

31 
	#FAPI_TEST_SAP_ENG_VERSION
 0x0003

	)

32 
	#FAPI_DEBUG_SAP_VERSION
 0x0e00

	)

33 
	#FAPI_TEST_SAP_VERSION
 0x0f00

	)

34 
	#FAPI_DATA_SAP_VERSION
 0x0f00

	)

35 
	#FAPI_CONTROL_SAP_VERSION
 0x0f02

	)

37 
	#FAPI_ACLPOLICY_BLACKLIST
 0x0000

	)

38 
	#FAPI_ACLPOLICY_WHITELIST
 0x0001

	)

40 
	#FAPI_ACTION_STOP
 0x0000

	)

41 
	#FAPI_ACTION_START
 0x0001

	)

43 
	#FAPI_APFFILTERMODE_DISABLED
 0x0000

	)

44 
	#FAPI_APFFILTERMODE_SUSPEND
 0x0001

	)

45 
	#FAPI_APFFILTERMODE_ACTIVE
 0x0002

	)

47 
	#FAPI_AUTHENTICATIONTYPE_OPEN_SYSTEM
 0x0000

	)

48 
	#FAPI_AUTHENTICATIONTYPE_SHARED_KEY
 0x0001

	)

49 
	#FAPI_AUTHENTICATIONTYPE_SAE
 0x0003

	)

50 
	#FAPI_AUTHENTICATIONTYPE_FILS_SHARED_NO_PFS
 0x0004

	)

51 
	#FAPI_AUTHENTICATIONTYPE_LEAP
 0x0080

	)

53 
	#FAPI_BAND_AUTO
 0x0000

	)

54 
	#FAPI_BAND_2_4GHZ
 0x0001

	)

55 
	#FAPI_BAND_5GHZ
 0x0002

	)

56 
	#FAPI_BAND_2_4GHZ_5GHZ
 0x0003

	)

57 
	#FAPI_BAND_6GHZ
 0x0004

	)

58 
	#FAPI_BAND_2_4GHZ_6GHZ
 0x0005

	)

59 
	#FAPI_BAND_5GHZ_6GHZ
 0x0006

	)

60 
	#FAPI_BAND_2_4GHZ_5GHZ_6GHZ
 0x0007

	)

62 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ
 0x00

	)

63 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ
 0x01

	)

64 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ
 0x02

	)

65 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ
 0x03

	)

67 
	#FAPI_CHANNELCONFIGURATION_AUTO
 0x0000

	)

68 
	#FAPI_CHANNELCONFIGURATION_USER_REQUESTED
 0x0001

	)

70 
	#FAPI_CWSTARTFLAGS_NONE
 0x0000

	)

71 
	#FAPI_CWSTARTFLAGS_SCAN_CHANNEL
 0x0001

	)

73 
	#FAPI_CWTYPE_SINE
 0x0000

	)

74 
	#FAPI_CWTYPE_RAMP
 0x0001

	)

75 
	#FAPI_CWTYPE_TWO_TONE
 0x0002

	)

76 
	#FAPI_CWTYPE_DC
 0x0003

	)

77 
	#FAPI_CWTYPE_PRN
 0x0004

	)

79 
	#FAPI_DATARATE_NONE
 0x0000

	)

80 
	#FAPI_DATARATE_11B20_1MBPS
 0x0001

	)

81 
	#FAPI_DATARATE_11B20_2MBPS
 0x0002

	)

82 
	#FAPI_DATARATE_11B20_5M5BPS
 0x0005

	)

83 
	#FAPI_DATARATE_11B20_11MBPS
 0x000b

	)

84 
	#FAPI_DATARATE_11A20_6MBPS
 0x2006

	)

85 
	#FAPI_DATARATE_11A20_9MBPS
 0x2009

	)

86 
	#FAPI_DATARATE_11A20_12MBPS
 0x200c

	)

87 
	#FAPI_DATARATE_11A20_18MBPS
 0x2012

	)

88 
	#FAPI_DATARATE_11A20_24MBPS
 0x2018

	)

89 
	#FAPI_DATARATE_11A20_36MBPS
 0x2024

	)

90 
	#FAPI_DATARATE_11A20_48MBPS
 0x2030

	)

91 
	#FAPI_DATARATE_11A20_54MBPS
 0x2036

	)

92 
	#FAPI_DATARATE_11N20_6M5BPS
 0x4000

	)

93 
	#FAPI_DATARATE_11N20_13MBPS
 0x4001

	)

94 
	#FAPI_DATARATE_11N20_19M5BPS
 0x4002

	)

95 
	#FAPI_DATARATE_11N20_26MBPS
 0x4003

	)

96 
	#FAPI_DATARATE_11N20_39MBPS
 0x4004

	)

97 
	#FAPI_DATARATE_11N20_52MBPS
 0x4005

	)

98 
	#FAPI_DATARATE_11N20_58M5BPS
 0x4006

	)

99 
	#FAPI_DATARATE_11N20_65MBPS
 0x4007

	)

100 
	#FAPI_DATARATE_11N20_7M2BPS_SGI
 0x4040

	)

101 
	#FAPI_DATARATE_11N20_14M4BPS_SGI
 0x4041

	)

102 
	#FAPI_DATARATE_11N20_21M7BPS_SGI
 0x4042

	)

103 
	#FAPI_DATARATE_11N20_28M9BPS_SGI
 0x4043

	)

104 
	#FAPI_DATARATE_11N20_43M3BPS_SGI
 0x4044

	)

105 
	#FAPI_DATARATE_11N20_57M8BPS_SGI
 0x4045

	)

106 
	#FAPI_DATARATE_11N20_65MBPS_SGI
 0x4046

	)

107 
	#FAPI_DATARATE_11N20_72M2BPS_SGI
 0x4047

	)

108 
	#FAPI_DATARATE_11N20_13MBPS_NSS2
 0x4088

	)

109 
	#FAPI_DATARATE_11N20_26MBPS_NSS2
 0x4089

	)

110 
	#FAPI_DATARATE_11N20_39MBPS_NSS2
 0x408a

	)

111 
	#FAPI_DATARATE_11N20_52MBPS_NSS2
 0x408b

	)

112 
	#FAPI_DATARATE_11N20_78MBPS_NSS2
 0x408c

	)

113 
	#FAPI_DATARATE_11N20_104MBPS_NSS2
 0x408d

	)

114 
	#FAPI_DATARATE_11N20_117MBPS_NSS2
 0x408e

	)

115 
	#FAPI_DATARATE_11N20_130MBPS_NSS2
 0x408f

	)

116 
	#FAPI_DATARATE_11N20_14M4BPS_SGI_NSS2
 0x40c8

	)

117 
	#FAPI_DATARATE_11N20_28M9BPS_SGI_NSS2
 0x40c9

	)

118 
	#FAPI_DATARATE_11N20_43M3BPS_SGI_NSS2
 0x40ÿ

	)

119 
	#FAPI_DATARATE_11N20_57M8BPS_SGI_NSS2
 0x40cb

	)

120 
	#FAPI_DATARATE_11N20_86M7BPS_SGI_NSS2
 0x40cc

	)

121 
	#FAPI_DATARATE_11N20_115M6BPS_SGI_NSS2
 0x40cd

	)

122 
	#FAPI_DATARATE_11N20_130MBPS_SGI_NSS2
 0x40û

	)

123 
	#FAPI_DATARATE_11N20_144M4BPS_SGI_NSS2
 0x40cf

	)

124 
	#FAPI_DATARATE_11N40_13M5BPS
 0x4400

	)

125 
	#FAPI_DATARATE_11N40_27MBPS
 0x4401

	)

126 
	#FAPI_DATARATE_11N40_40M5BPS
 0x4402

	)

127 
	#FAPI_DATARATE_11N40_54MBPS
 0x4403

	)

128 
	#FAPI_DATARATE_11N40_81MBPS
 0x4404

	)

129 
	#FAPI_DATARATE_11N40_108MBPS
 0x4405

	)

130 
	#FAPI_DATARATE_11N40_121M5BPS
 0x4406

	)

131 
	#FAPI_DATARATE_11N40_135MBPS
 0x4407

	)

132 
	#FAPI_DATARATE_11N40_6MBPS
 0x4420

	)

133 
	#FAPI_DATARATE_11N40_15MBPS_SGI
 0x4440

	)

134 
	#FAPI_DATARATE_11N40_30MBPS_SGI
 0x4441

	)

135 
	#FAPI_DATARATE_11N40_45MBPS_SGI
 0x4442

	)

136 
	#FAPI_DATARATE_11N40_60MBPS_SGI
 0x4443

	)

137 
	#FAPI_DATARATE_11N40_90MBPS_SGI
 0x4444

	)

138 
	#FAPI_DATARATE_11N40_120MBPS_SGI
 0x4445

	)

139 
	#FAPI_DATARATE_11N40_135MBPS_SGI
 0x4446

	)

140 
	#FAPI_DATARATE_11N40_150MBPS_SGI
 0x4447

	)

141 
	#FAPI_DATARATE_11N40_6M7BPS_SGI
 0x4460

	)

142 
	#FAPI_DATARATE_11N40_27MBPS_NSS2
 0x4488

	)

143 
	#FAPI_DATARATE_11N40_54MBPS_NSS2
 0x4489

	)

144 
	#FAPI_DATARATE_11N40_81MBPS_NSS2
 0x448a

	)

145 
	#FAPI_DATARATE_11N40_108MBPS_NSS2
 0x448b

	)

146 
	#FAPI_DATARATE_11N40_162MBPS_NSS2
 0x448c

	)

147 
	#FAPI_DATARATE_11N40_216MBPS_NSS2
 0x448d

	)

148 
	#FAPI_DATARATE_11N40_243MBPS_NSS2
 0x448e

	)

149 
	#FAPI_DATARATE_11N40_270MBPS_NSS2
 0x448f

	)

150 
	#FAPI_DATARATE_11N40_30MBPS_SGI_NSS2
 0x44c8

	)

151 
	#FAPI_DATARATE_11N40_60MBPS_SGI_NSS2
 0x44c9

	)

152 
	#FAPI_DATARATE_11N40_90MBPS_SGI_NSS2
 0x44ÿ

	)

153 
	#FAPI_DATARATE_11N40_120MBPS_SGI_NSS2
 0x44cb

	)

154 
	#FAPI_DATARATE_11N40_180MBPS_SGI_NSS2
 0x44cc

	)

155 
	#FAPI_DATARATE_11N40_240MBPS_SGI_NSS2
 0x44cd

	)

156 
	#FAPI_DATARATE_11N40_270MBPS_SGI_NSS2
 0x44û

	)

157 
	#FAPI_DATARATE_11N40_300MBPS_SGI_NSS2
 0x44cf

	)

158 
	#FAPI_DATARATE_11AC20_6M5BPS
 0x6000

	)

159 
	#FAPI_DATARATE_11AC20_13MBPS
 0x6001

	)

160 
	#FAPI_DATARATE_11AC20_19M5BPS
 0x6002

	)

161 
	#FAPI_DATARATE_11AC20_26MBPS
 0x6003

	)

162 
	#FAPI_DATARATE_11AC20_39MBPS
 0x6004

	)

163 
	#FAPI_DATARATE_11AC20_52MBPS
 0x6005

	)

164 
	#FAPI_DATARATE_11AC20_58M5BPS
 0x6006

	)

165 
	#FAPI_DATARATE_11AC20_65MBPS
 0x6007

	)

166 
	#FAPI_DATARATE_11AC20_78MBPS
 0x6008

	)

167 
	#FAPI_DATARATE_11AC20_97M5BPS
 0x600a

	)

168 
	#FAPI_DATARATE_11AC20_7M2BPS_SGI
 0x6040

	)

169 
	#FAPI_DATARATE_11AC20_14M4BPS_SGI
 0x6041

	)

170 
	#FAPI_DATARATE_11AC20_21M7BPS_SGI
 0x6042

	)

171 
	#FAPI_DATARATE_11AC20_28M9BPS_SGI
 0x6043

	)

172 
	#FAPI_DATARATE_11AC20_43M3BPS_SGI
 0x6044

	)

173 
	#FAPI_DATARATE_11AC20_57M8BPS_SGI
 0x6045

	)

174 
	#FAPI_DATARATE_11AC20_65MBPS_SGI
 0x6046

	)

175 
	#FAPI_DATARATE_11AC20_72M2BPS_SGI
 0x6047

	)

176 
	#FAPI_DATARATE_11AC20_86M7BPS_SGI
 0x6048

	)

177 
	#FAPI_DATARATE_11AC20_108M3BPS_SGI
 0x604a

	)

178 
	#FAPI_DATARATE_11AC20_13MBPS_NSS2
 0x6080

	)

179 
	#FAPI_DATARATE_11AC20_26MBPS_NSS2
 0x6081

	)

180 
	#FAPI_DATARATE_11AC20_39MBPS_NSS2
 0x6082

	)

181 
	#FAPI_DATARATE_11AC20_52MBPS_NSS2
 0x6083

	)

182 
	#FAPI_DATARATE_11AC20_78MBPS_NSS2
 0x6084

	)

183 
	#FAPI_DATARATE_11AC20_104MBPS_NSS2
 0x6085

	)

184 
	#FAPI_DATARATE_11AC20_117MBPS_NSS2
 0x6086

	)

185 
	#FAPI_DATARATE_11AC20_130MBPS_NSS2
 0x6087

	)

186 
	#FAPI_DATARATE_11AC20_156MBPS_NSS2
 0x6088

	)

187 
	#FAPI_DATARATE_11AC20_195MBPS_NSS2
 0x608a

	)

188 
	#FAPI_DATARATE_11AC20_14M4BPS_SGI_NSS2
 0x60c0

	)

189 
	#FAPI_DATARATE_11AC20_28M9BPS_SGI_NSS2
 0x60c1

	)

190 
	#FAPI_DATARATE_11AC20_43M3BPS_SGI_NSS2
 0x60c2

	)

191 
	#FAPI_DATARATE_11AC20_57M8BPS_SGI_NSS2
 0x60c3

	)

192 
	#FAPI_DATARATE_11AC20_86M7BPS_SGI_NSS2
 0x60c4

	)

193 
	#FAPI_DATARATE_11AC20_115M6BPS_SGI_NSS2
 0x60c5

	)

194 
	#FAPI_DATARATE_11AC20_130MBPS_SGI_NSS2
 0x60c6

	)

195 
	#FAPI_DATARATE_11AC20_144M4BPS_SGI_NSS2
 0x60c7

	)

196 
	#FAPI_DATARATE_11AC20_173M3BPS_SGI_NSS2
 0x60c8

	)

197 
	#FAPI_DATARATE_11AC20_216M7BPS_SGI_NSS2
 0x60ÿ

	)

198 
	#FAPI_DATARATE_11AC40_13M5BPS
 0x6400

	)

199 
	#FAPI_DATARATE_11AC40_27MBPS
 0x6401

	)

200 
	#FAPI_DATARATE_11AC40_40M5BPS
 0x6402

	)

201 
	#FAPI_DATARATE_11AC40_54MBPS
 0x6403

	)

202 
	#FAPI_DATARATE_11AC40_81MBPS
 0x6404

	)

203 
	#FAPI_DATARATE_11AC40_108MBPS
 0x6405

	)

204 
	#FAPI_DATARATE_11AC40_121M5BPS
 0x6406

	)

205 
	#FAPI_DATARATE_11AC40_135MBPS
 0x6407

	)

206 
	#FAPI_DATARATE_11AC40_162MBPS
 0x6408

	)

207 
	#FAPI_DATARATE_11AC40_180MBPS
 0x6409

	)

208 
	#FAPI_DATARATE_11AC40_202M5BPS
 0x640a

	)

209 
	#FAPI_DATARATE_11AC40_225MBPS
 0x640b

	)

210 
	#FAPI_DATARATE_11AC40_15MBPS_SGI
 0x6440

	)

211 
	#FAPI_DATARATE_11AC40_30MBPS_SGI
 0x6441

	)

212 
	#FAPI_DATARATE_11AC40_45MBPS_SGI
 0x6442

	)

213 
	#FAPI_DATARATE_11AC40_60MBPS_SGI
 0x6443

	)

214 
	#FAPI_DATARATE_11AC40_90MBPS_SGI
 0x6444

	)

215 
	#FAPI_DATARATE_11AC40_120MBPS_SGI
 0x6445

	)

216 
	#FAPI_DATARATE_11AC40_135MBPS_SGI
 0x6446

	)

217 
	#FAPI_DATARATE_11AC40_150MBPS_SGI
 0x6447

	)

218 
	#FAPI_DATARATE_11AC40_180MBPS_SGI
 0x6448

	)

219 
	#FAPI_DATARATE_11AC40_200MBPS_SGI
 0x6449

	)

220 
	#FAPI_DATARATE_11AC40_225MBPS_SGI
 0x644a

	)

221 
	#FAPI_DATARATE_11AC40_250MBPS_SGI
 0x644b

	)

222 
	#FAPI_DATARATE_11AC40_27MBPS_NSS2
 0x6480

	)

223 
	#FAPI_DATARATE_11AC40_54MBPS_NSS2
 0x6481

	)

224 
	#FAPI_DATARATE_11AC40_81MBPS_NSS2
 0x6482

	)

225 
	#FAPI_DATARATE_11AC40_108MBPS_NSS2
 0x6483

	)

226 
	#FAPI_DATARATE_11AC40_162MBPS_NSS2
 0x6484

	)

227 
	#FAPI_DATARATE_11AC40_216MBPS_NSS2
 0x6485

	)

228 
	#FAPI_DATARATE_11AC40_243MBPS_NSS2
 0x6486

	)

229 
	#FAPI_DATARATE_11AC40_270MBPS_NSS2
 0x6487

	)

230 
	#FAPI_DATARATE_11AC40_324MBPS_NSS2
 0x6488

	)

231 
	#FAPI_DATARATE_11AC40_360MBPS_NSS2
 0x6489

	)

232 
	#FAPI_DATARATE_11AC40_405MBPS_NSS2
 0x648a

	)

233 
	#FAPI_DATARATE_11AC40_450MBPS_NSS2
 0x648b

	)

234 
	#FAPI_DATARATE_11AC40_30MBPS_SGI_NSS2
 0x64c0

	)

235 
	#FAPI_DATARATE_11AC40_60MBPS_SGI_NSS2
 0x64c1

	)

236 
	#FAPI_DATARATE_11AC40_90MBPS_SGI_NSS2
 0x64c2

	)

237 
	#FAPI_DATARATE_11AC40_120MBPS_SGI_NSS2
 0x64c3

	)

238 
	#FAPI_DATARATE_11AC40_180MBPS_SGI_NSS2
 0x64c4

	)

239 
	#FAPI_DATARATE_11AC40_240MBPS_SGI_NSS2
 0x64c5

	)

240 
	#FAPI_DATARATE_11AC40_270MBPS_SGI_NSS2
 0x64c6

	)

241 
	#FAPI_DATARATE_11AC40_300MBPS_SGI_NSS2
 0x64c7

	)

242 
	#FAPI_DATARATE_11AC40_360MBPS_SGI_NSS2
 0x64c8

	)

243 
	#FAPI_DATARATE_11AC40_400MBPS_SGI_NSS2
 0x64c9

	)

244 
	#FAPI_DATARATE_11AC40_450MBPS_SGI_NSS2
 0x64ÿ

	)

245 
	#FAPI_DATARATE_11AC40_500MBPS_SGI_NSS2
 0x64cb

	)

246 
	#FAPI_DATARATE_11AC80_29M3BPS
 0x6800

	)

247 
	#FAPI_DATARATE_11AC80_58M5BPS
 0x6801

	)

248 
	#FAPI_DATARATE_11AC80_87M8BPS
 0x6802

	)

249 
	#FAPI_DATARATE_11AC80_117MBPS
 0x6803

	)

250 
	#FAPI_DATARATE_11AC80_175M5BPS
 0x6804

	)

251 
	#FAPI_DATARATE_11AC80_234MBPS
 0x6805

	)

252 
	#FAPI_DATARATE_11AC80_263M3BPS
 0x6806

	)

253 
	#FAPI_DATARATE_11AC80_292M5BPS
 0x6807

	)

254 
	#FAPI_DATARATE_11AC80_351MBPS
 0x6808

	)

255 
	#FAPI_DATARATE_11AC80_390MBPS
 0x6809

	)

256 
	#FAPI_DATARATE_11AC80_438M8BPS
 0x680a

	)

257 
	#FAPI_DATARATE_11AC80_487M5BPS
 0x680b

	)

258 
	#FAPI_DATARATE_11AC80_32M5BPS_SGI
 0x6840

	)

259 
	#FAPI_DATARATE_11AC80_65MBPS_SGI
 0x6841

	)

260 
	#FAPI_DATARATE_11AC80_97M5BPS_SGI
 0x6842

	)

261 
	#FAPI_DATARATE_11AC80_130MBPS_SGI
 0x6843

	)

262 
	#FAPI_DATARATE_11AC80_195MBPS_SGI
 0x6844

	)

263 
	#FAPI_DATARATE_11AC80_260MBPS_SGI
 0x6845

	)

264 
	#FAPI_DATARATE_11AC80_292M5BPS_SGI
 0x6846

	)

265 
	#FAPI_DATARATE_11AC80_325MBPS_SGI
 0x6847

	)

266 
	#FAPI_DATARATE_11AC80_390MBPS_SGI
 0x6848

	)

267 
	#FAPI_DATARATE_11AC80_433M3BPS_SGI
 0x6849

	)

268 
	#FAPI_DATARATE_11AC80_487M5BPS_SGI
 0x684a

	)

269 
	#FAPI_DATARATE_11AC80_541M7BPS_SGI
 0x684b

	)

270 
	#FAPI_DATARATE_11AC80_58M5BPS_NSS2
 0x6880

	)

271 
	#FAPI_DATARATE_11AC80_117MBPS_NSS2
 0x6881

	)

272 
	#FAPI_DATARATE_11AC80_175M5BPS_NSS2
 0x6882

	)

273 
	#FAPI_DATARATE_11AC80_234MBPS_NSS2
 0x6883

	)

274 
	#FAPI_DATARATE_11AC80_351MBPS_NSS2
 0x6884

	)

275 
	#FAPI_DATARATE_11AC80_468MBPS_NSS2
 0x6885

	)

276 
	#FAPI_DATARATE_11AC80_526M5BPS_NSS2
 0x6886

	)

277 
	#FAPI_DATARATE_11AC80_585MBPS_NSS2
 0x6887

	)

278 
	#FAPI_DATARATE_11AC80_702MBPS_NSS2
 0x6888

	)

279 
	#FAPI_DATARATE_11AC80_780MBPS_NSS2
 0x6889

	)

280 
	#FAPI_DATARATE_11AC80_877M5BPS_NSS2
 0x688a

	)

281 
	#FAPI_DATARATE_11AC80_975MBPS_NSS2
 0x688b

	)

282 
	#FAPI_DATARATE_11AC80_65MBPS_SGI_NSS2
 0x68c0

	)

283 
	#FAPI_DATARATE_11AC80_130MBPS_SGI_NSS2
 0x68c1

	)

284 
	#FAPI_DATARATE_11AC80_195MBPS_SGI_NSS2
 0x68c2

	)

285 
	#FAPI_DATARATE_11AC80_260MBPS_SGI_NSS2
 0x68c3

	)

286 
	#FAPI_DATARATE_11AC80_390MBPS_SGI_NSS2
 0x68c4

	)

287 
	#FAPI_DATARATE_11AC80_520MBPS_SGI_NSS2
 0x68c5

	)

288 
	#FAPI_DATARATE_11AC80_585MBPS_SGI_NSS2
 0x68c6

	)

289 
	#FAPI_DATARATE_11AC80_650MBPS_SGI_NSS2
 0x68c7

	)

290 
	#FAPI_DATARATE_11AC80_780MBPS_SGI_NSS2
 0x68c8

	)

291 
	#FAPI_DATARATE_11AC80_866M7BPS_SGI_NSS2
 0x68c9

	)

292 
	#FAPI_DATARATE_11AC80_975MBPS_SGI_NSS2
 0x68ÿ

	)

293 
	#FAPI_DATARATE_11AC80_1083M3BPS_SGI_NSS2
 0x68cb

	)

294 
	#FAPI_DATARATE_11AC160_58M5BPS
 0x6c00

	)

295 
	#FAPI_DATARATE_11AC160_117MBPS
 0x6c01

	)

296 
	#FAPI_DATARATE_11AC160_175M5BPS
 0x6c02

	)

297 
	#FAPI_DATARATE_11AC160_234MBPS
 0x6c03

	)

298 
	#FAPI_DATARATE_11AC160_351MBPS
 0x6c04

	)

299 
	#FAPI_DATARATE_11AC160_468MBPS
 0x6c05

	)

300 
	#FAPI_DATARATE_11AC160_526M5BPS
 0x6c06

	)

301 
	#FAPI_DATARATE_11AC160_585MBPS
 0x6c07

	)

302 
	#FAPI_DATARATE_11AC160_702MBPS
 0x6c08

	)

303 
	#FAPI_DATARATE_11AC160_780MBPS
 0x6c09

	)

304 
	#FAPI_DATARATE_11AC160_877M5BPS
 0x6c0a

	)

305 
	#FAPI_DATARATE_11AC160_975MBPS
 0x6c0b

	)

306 
	#FAPI_DATARATE_11AC160_65MBPS_SGI
 0x6c40

	)

307 
	#FAPI_DATARATE_11AC160_130MBPS_SGI
 0x6c41

	)

308 
	#FAPI_DATARATE_11AC160_195MBPS_SGI
 0x6c42

	)

309 
	#FAPI_DATARATE_11AC160_260MBPS_SGI
 0x6c43

	)

310 
	#FAPI_DATARATE_11AC160_390MBPS_SGI
 0x6c44

	)

311 
	#FAPI_DATARATE_11AC160_520MBPS_SGI
 0x6c45

	)

312 
	#FAPI_DATARATE_11AC160_585MBPS_SGI
 0x6c46

	)

313 
	#FAPI_DATARATE_11AC160_650MBPS_SGI
 0x6c47

	)

314 
	#FAPI_DATARATE_11AC160_780MBPS_SGI
 0x6c48

	)

315 
	#FAPI_DATARATE_11AC160_866M7BPS_SGI
 0x6c49

	)

316 
	#FAPI_DATARATE_11AC160_975MBPS_SGI
 0x6c4a

	)

317 
	#FAPI_DATARATE_11AC160_1083M3BPS_SGI
 0x6c4b

	)

318 
	#FAPI_DATARATE_11AC160_117MBPS_NSS2
 0x6c80

	)

319 
	#FAPI_DATARATE_11AC160_234MBPS_NSS2
 0x6c81

	)

320 
	#FAPI_DATARATE_11AC160_351MBPS_NSS2
 0x6c82

	)

321 
	#FAPI_DATARATE_11AC160_468MBPS_NSS2
 0x6c83

	)

322 
	#FAPI_DATARATE_11AC160_702MBPS_NSS2
 0x6c84

	)

323 
	#FAPI_DATARATE_11AC160_936MBPS_NSS2
 0x6c85

	)

324 
	#FAPI_DATARATE_11AC160_1053MBPS_NSS2
 0x6c86

	)

325 
	#FAPI_DATARATE_11AC160_1170MBPS_NSS2
 0x6c87

	)

326 
	#FAPI_DATARATE_11AC160_1404MBPS_NSS2
 0x6c88

	)

327 
	#FAPI_DATARATE_11AC160_1560MBPS_NSS2
 0x6c89

	)

328 
	#FAPI_DATARATE_11AC160_1755MBPS_NSS2
 0x6c8a

	)

329 
	#FAPI_DATARATE_11AC160_1950MBPS_NSS2
 0x6c8b

	)

330 
	#FAPI_DATARATE_11AC160_130MBPS_SGI_NSS2
 0x6cc0

	)

331 
	#FAPI_DATARATE_11AC160_260MBPS_SGI_NSS2
 0x6cc1

	)

332 
	#FAPI_DATARATE_11AC160_390MBPS_SGI_NSS2
 0x6cc2

	)

333 
	#FAPI_DATARATE_11AC160_520MBPS_SGI_NSS2
 0x6cc3

	)

334 
	#FAPI_DATARATE_11AC160_780MBPS_SGI_NSS2
 0x6cc4

	)

335 
	#FAPI_DATARATE_11AC160_1040MBPS_SGI_NSS2
 0x6cc5

	)

336 
	#FAPI_DATARATE_11AC160_1170MBPS_SGI_NSS2
 0x6cc6

	)

337 
	#FAPI_DATARATE_11AC160_1300MBPS_SGI_NSS2
 0x6cc7

	)

338 
	#FAPI_DATARATE_11AC160_1560MBPS_SGI_NSS2
 0x6cc8

	)

339 
	#FAPI_DATARATE_11AC160_1733M3BPS_SGI_NSS2
 0x6cc9

	)

340 
	#FAPI_DATARATE_11AC160_1950MBPS_SGI_NSS2
 0x6cÿ

	)

341 
	#FAPI_DATARATE_11AC160_2166M7BPS_SGI_NSS2
 0x6ccb

	)

342 
	#FAPI_DATARATE_11AX20_8M6BPS_1GI
 0x8000

	)

343 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI
 0x8001

	)

344 
	#FAPI_DATARATE_11AX20_25M8BPS_1GI
 0x8002

	)

345 
	#FAPI_DATARATE_11AX20_34M4BPS_1GI
 0x8003

	)

346 
	#FAPI_DATARATE_11AX20_51M6BPS_1GI
 0x8004

	)

347 
	#FAPI_DATARATE_11AX20_68M8BPS_1GI
 0x8005

	)

348 
	#FAPI_DATARATE_11AX20_77M4BPS_1GI
 0x8006

	)

349 
	#FAPI_DATARATE_11AX20_86MBPS_1GI
 0x8007

	)

350 
	#FAPI_DATARATE_11AX20_103M2BPS_1GI
 0x8008

	)

351 
	#FAPI_DATARATE_11AX20_114M7BPS_1GI
 0x8009

	)

352 
	#FAPI_DATARATE_11AX20_129MBPS_1GI
 0x800a

	)

353 
	#FAPI_DATARATE_11AX20_143M4BPS_1GI
 0x800b

	)

354 
	#FAPI_DATARATE_11AX20_8M1BPS_2GI
 0x8010

	)

355 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI
 0x8011

	)

356 
	#FAPI_DATARATE_11AX20_24M4BPS_2GI
 0x8012

	)

357 
	#FAPI_DATARATE_11AX20_32M5BPS_2GI
 0x8013

	)

358 
	#FAPI_DATARATE_11AX20_48M8BPS_2GI
 0x8014

	)

359 
	#FAPI_DATARATE_11AX20_65MBPS_2GI
 0x8015

	)

360 
	#FAPI_DATARATE_11AX20_73M1BPS_2GI
 0x8016

	)

361 
	#FAPI_DATARATE_11AX20_81M3BPS_2GI
 0x8017

	)

362 
	#FAPI_DATARATE_11AX20_97M5BPS_2GI
 0x8018

	)

363 
	#FAPI_DATARATE_11AX20_108M3BPS_2GI
 0x8019

	)

364 
	#FAPI_DATARATE_11AX20_121M9BPS_2GI
 0x801a

	)

365 
	#FAPI_DATARATE_11AX20_135M4BPS_2GI
 0x801b

	)

366 
	#FAPI_DATARATE_11AX20_7M3BPS_4GI
 0x8020

	)

367 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI
 0x8021

	)

368 
	#FAPI_DATARATE_11AX20_21M9BPS_4GI
 0x8022

	)

369 
	#FAPI_DATARATE_11AX20_29M3BPS_4GI
 0x8023

	)

370 
	#FAPI_DATARATE_11AX20_43M9BPS_4GI
 0x8024

	)

371 
	#FAPI_DATARATE_11AX20_58M5BPS_4GI
 0x8025

	)

372 
	#FAPI_DATARATE_11AX20_65M8BPS_4GI
 0x8026

	)

373 
	#FAPI_DATARATE_11AX20_73M1BPS_4GI
 0x8027

	)

374 
	#FAPI_DATARATE_11AX20_87M8BPS_4GI
 0x8028

	)

375 
	#FAPI_DATARATE_11AX20_97M5BPS_4GI
 0x8029

	)

376 
	#FAPI_DATARATE_11AX20_109M7BPS_4GI
 0x802a

	)

377 
	#FAPI_DATARATE_11AX20_121M9BPS_4GI
 0x802b

	)

378 
	#FAPI_DATARATE_11AX20_4M3BPS_1GI_DCM
 0x8040

	)

379 
	#FAPI_DATARATE_11AX20_8M6BPS_1GI_DCM
 0x8041

	)

380 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI_DCM
 0x8043

	)

381 
	#FAPI_DATARATE_11AX20_25M8BPS_1GI_DCM
 0x8044

	)

382 
	#FAPI_DATARATE_11AX20_4MBPS_2GI_DCM
 0x8050

	)

383 
	#FAPI_DATARATE_11AX20_8M1BPS_2GI_DCM
 0x8051

	)

384 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI_DCM
 0x8053

	)

385 
	#FAPI_DATARATE_11AX20_24M4BPS_2GI_DCM
 0x8054

	)

386 
	#FAPI_DATARATE_11AX20_3M6BPS_4GI_DCM
 0x8060

	)

387 
	#FAPI_DATARATE_11AX20_7M3BPS_4GI_DCM
 0x8061

	)

388 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI_DCM
 0x8063

	)

389 
	#FAPI_DATARATE_11AX20_21M9BPS_4GI_DCM
 0x8064

	)

390 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI_NSS2
 0x8080

	)

391 
	#FAPI_DATARATE_11AX20_34M4BPS_1GI_NSS2
 0x8081

	)

392 
	#FAPI_DATARATE_11AX20_51M6BPS_1GI_NSS2
 0x8082

	)

393 
	#FAPI_DATARATE_11AX20_68M8BPS_1GI_NSS2
 0x8083

	)

394 
	#FAPI_DATARATE_11AX20_103M2BPS_1GI_NSS2
 0x8084

	)

395 
	#FAPI_DATARATE_11AX20_137M6BPS_1GI_NSS2
 0x8085

	)

396 
	#FAPI_DATARATE_11AX20_154M9BPS_1GI_NSS2
 0x8086

	)

397 
	#FAPI_DATARATE_11AX20_172M1BPS_1GI_NSS2
 0x8087

	)

398 
	#FAPI_DATARATE_11AX20_206M5BPS_1GI_NSS2
 0x8088

	)

399 
	#FAPI_DATARATE_11AX20_229M4BPS_1GI_NSS2
 0x8089

	)

400 
	#FAPI_DATARATE_11AX20_258M1BPS_1GI_NSS2
 0x808a

	)

401 
	#FAPI_DATARATE_11AX20_286M8BPS_1GI_NSS2
 0x808b

	)

402 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI_NSS2
 0x8090

	)

403 
	#FAPI_DATARATE_11AX20_32M5BPS_2GI_NSS2
 0x8091

	)

404 
	#FAPI_DATARATE_11AX20_48M8BPS_2GI_NSS2
 0x8092

	)

405 
	#FAPI_DATARATE_11AX20_65MBPS_2GI_NSS2
 0x8093

	)

406 
	#FAPI_DATARATE_11AX20_97M5BPS_2GI_NSS2
 0x8094

	)

407 
	#FAPI_DATARATE_11AX20_130MBPS_2GI_NSS2
 0x8095

	)

408 
	#FAPI_DATARATE_11AX20_146M3BPS_2GI_NSS2
 0x8096

	)

409 
	#FAPI_DATARATE_11AX20_162M5BPS_2GI_NSS2
 0x8097

	)

410 
	#FAPI_DATARATE_11AX20_195MBPS_2GI_NSS2
 0x8098

	)

411 
	#FAPI_DATARATE_11AX20_216M7BPS_2GI_NSS2
 0x8099

	)

412 
	#FAPI_DATARATE_11AX20_243M8BPS_2GI_NSS2
 0x809a

	)

413 
	#FAPI_DATARATE_11AX20_270M8BPS_2GI_NSS2
 0x809b

	)

414 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI_NSS2
 0x80a0

	)

415 
	#FAPI_DATARATE_11AX20_29M3BPS_4GI_NSS2
 0x80a1

	)

416 
	#FAPI_DATARATE_11AX20_43M9BPS_4GI_NSS2
 0x80a2

	)

417 
	#FAPI_DATARATE_11AX20_58M5BPS_4GI_NSS2
 0x80a3

	)

418 
	#FAPI_DATARATE_11AX20_87M8BPS_4GI_NSS2
 0x80a4

	)

419 
	#FAPI_DATARATE_11AX20_117MBPS_4GI_NSS2
 0x80a5

	)

420 
	#FAPI_DATARATE_11AX20_131M6BPS_4GI_NSS2
 0x80a6

	)

421 
	#FAPI_DATARATE_11AX20_146M3BPS_4GI_NSS2
 0x80a7

	)

422 
	#FAPI_DATARATE_11AX20_175M5BPS_4GI_NSS2
 0x80a8

	)

423 
	#FAPI_DATARATE_11AX20_195MBPS_4GI_NSS2
 0x80a9

	)

424 
	#FAPI_DATARATE_11AX20_219M4BPS_4GI_NSS2
 0x80¯

	)

425 
	#FAPI_DATARATE_11AX20_243M8BPS_4GI_NSS2
 0x80ab

	)

426 
	#FAPI_DATARATE_11AX20_8M6BPS_1GI_NSS2_DCM
 0x80c0

	)

427 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI_NSS2_DCM
 0x80c1

	)

428 
	#FAPI_DATARATE_11AX20_34M4BPS_1GI_NSS2_DCM
 0x80c3

	)

429 
	#FAPI_DATARATE_11AX20_51M6BPS_1GI_NSS2_DCM
 0x80c4

	)

430 
	#FAPI_DATARATE_11AX20_8M1BPS_2GI_NSS2_DCM
 0x80d0

	)

431 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI_NSS2_DCM
 0x80d1

	)

432 
	#FAPI_DATARATE_11AX20_32M5BPS_2GI_NSS2_DCM
 0x80d3

	)

433 
	#FAPI_DATARATE_11AX20_48M8BPS_2GI_NSS2_DCM
 0x80d4

	)

434 
	#FAPI_DATARATE_11AX20_7M3BPS_4GI_NSS2_DCM
 0x80e0

	)

435 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI_NSS2_DCM
 0x80e1

	)

436 
	#FAPI_DATARATE_11AX20_29M3BPS_4GI_NSS2_DCM
 0x80e3

	)

437 
	#FAPI_DATARATE_11AX20_43M9BPS_4GI_NSS2_DCM
 0x80e4

	)

438 
	#FAPI_DATARATE_11AX40_17M2BPS_1GI
 0x8400

	)

439 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI
 0x8401

	)

440 
	#FAPI_DATARATE_11AX40_51M6BPS_1GI
 0x8402

	)

441 
	#FAPI_DATARATE_11AX40_68M8BPS_1GI
 0x8403

	)

442 
	#FAPI_DATARATE_11AX40_103M2BPS_1GI
 0x8404

	)

443 
	#FAPI_DATARATE_11AX40_137M6BPS_1GI
 0x8405

	)

444 
	#FAPI_DATARATE_11AX40_154M9BPS_1GI
 0x8406

	)

445 
	#FAPI_DATARATE_11AX40_172M1BPS_1GI
 0x8407

	)

446 
	#FAPI_DATARATE_11AX40_206M5BPS_1GI
 0x8408

	)

447 
	#FAPI_DATARATE_11AX40_229M4BPS_1GI
 0x8409

	)

448 
	#FAPI_DATARATE_11AX40_258M1BPS_1GI
 0x840a

	)

449 
	#FAPI_DATARATE_11AX40_286M8BPS_1GI
 0x840b

	)

450 
	#FAPI_DATARATE_11AX40_16M3BPS_2GI
 0x8410

	)

451 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI
 0x8411

	)

452 
	#FAPI_DATARATE_11AX40_48M8BPS_2GI
 0x8412

	)

453 
	#FAPI_DATARATE_11AX40_65MBPS_2GI
 0x8413

	)

454 
	#FAPI_DATARATE_11AX40_97M5BPS_2GI
 0x8414

	)

455 
	#FAPI_DATARATE_11AX40_130MBPS_2GI
 0x8415

	)

456 
	#FAPI_DATARATE_11AX40_146M3BPS_2GI
 0x8416

	)

457 
	#FAPI_DATARATE_11AX40_162M5BPS_2GI
 0x8417

	)

458 
	#FAPI_DATARATE_11AX40_195MBPS_2GI
 0x8418

	)

459 
	#FAPI_DATARATE_11AX40_216M7BPS_2GI
 0x8419

	)

460 
	#FAPI_DATARATE_11AX40_243M8BPS_2GI
 0x841a

	)

461 
	#FAPI_DATARATE_11AX40_270M8BPS_2GI
 0x841b

	)

462 
	#FAPI_DATARATE_11AX40_14M6BPS_4GI
 0x8420

	)

463 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI
 0x8421

	)

464 
	#FAPI_DATARATE_11AX40_43M9BPS_4GI
 0x8422

	)

465 
	#FAPI_DATARATE_11AX40_58M5BPS_4GI
 0x8423

	)

466 
	#FAPI_DATARATE_11AX40_87M8BPS_4GI
 0x8424

	)

467 
	#FAPI_DATARATE_11AX40_117MBPS_4GI
 0x8425

	)

468 
	#FAPI_DATARATE_11AX40_131M6BPS_4GI
 0x8426

	)

469 
	#FAPI_DATARATE_11AX40_146M3BPS_4GI
 0x8427

	)

470 
	#FAPI_DATARATE_11AX40_175M5BPS_4GI
 0x8428

	)

471 
	#FAPI_DATARATE_11AX40_195MBPS_4GI
 0x8429

	)

472 
	#FAPI_DATARATE_11AX40_219M4BPS_4GI
 0x842a

	)

473 
	#FAPI_DATARATE_11AX40_243M8BPS_4GI
 0x842b

	)

474 
	#FAPI_DATARATE_11AX40_8M6BPS_1GI_DCM
 0x8440

	)

475 
	#FAPI_DATARATE_11AX40_17M2BPS_1GI_DCM
 0x8441

	)

476 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI_DCM
 0x8443

	)

477 
	#FAPI_DATARATE_11AX40_51M6BPS_1GI_DCM
 0x8444

	)

478 
	#FAPI_DATARATE_11AX40_8M1BPS_2GI_DCM
 0x8450

	)

479 
	#FAPI_DATARATE_11AX40_16M3BPS_2GI_DCM
 0x8451

	)

480 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI_DCM
 0x8453

	)

481 
	#FAPI_DATARATE_11AX40_48M8BPS_2GI_DCM
 0x8454

	)

482 
	#FAPI_DATARATE_11AX40_7M3BPS_4GI_DCM
 0x8460

	)

483 
	#FAPI_DATARATE_11AX40_14M6BPS_4GI_DCM
 0x8461

	)

484 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI_DCM
 0x8463

	)

485 
	#FAPI_DATARATE_11AX40_43M9BPS_4GI_DCM
 0x8464

	)

486 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI_NSS2
 0x8480

	)

487 
	#FAPI_DATARATE_11AX40_68M8BPS_1GI_NSS2
 0x8481

	)

488 
	#FAPI_DATARATE_11AX40_103M2BPS_1GI_NSS2
 0x8482

	)

489 
	#FAPI_DATARATE_11AX40_137M6BPS_1GI_NSS2
 0x8483

	)

490 
	#FAPI_DATARATE_11AX40_206M5BPS_1GI_NSS2
 0x8484

	)

491 
	#FAPI_DATARATE_11AX40_275M3BPS_1GI_NSS2
 0x8485

	)

492 
	#FAPI_DATARATE_11AX40_309M7BPS_1GI_NSS2
 0x8486

	)

493 
	#FAPI_DATARATE_11AX40_344M1BPS_1GI_NSS2
 0x8487

	)

494 
	#FAPI_DATARATE_11AX40_412M9BPS_1GI_NSS2
 0x8488

	)

495 
	#FAPI_DATARATE_11AX40_458M8BPS_1GI_NSS2
 0x8489

	)

496 
	#FAPI_DATARATE_11AX40_516M2BPS_1GI_NSS2
 0x848a

	)

497 
	#FAPI_DATARATE_11AX40_573M5BPS_1GI_NSS2
 0x848b

	)

498 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI_NSS2
 0x8490

	)

499 
	#FAPI_DATARATE_11AX40_65MBPS_2GI_NSS2
 0x8491

	)

500 
	#FAPI_DATARATE_11AX40_97M5BPS_2GI_NSS2
 0x8492

	)

501 
	#FAPI_DATARATE_11AX40_130MBPS_2GI_NSS2
 0x8493

	)

502 
	#FAPI_DATARATE_11AX40_195MBPS_2GI_NSS2
 0x8494

	)

503 
	#FAPI_DATARATE_11AX40_260MBPS_2GI_NSS2
 0x8495

	)

504 
	#FAPI_DATARATE_11AX40_292M5BPS_2GI_NSS2
 0x8496

	)

505 
	#FAPI_DATARATE_11AX40_325MBPS_2GI_NSS2
 0x8497

	)

506 
	#FAPI_DATARATE_11AX40_390MBPS_2GI_NSS2
 0x8498

	)

507 
	#FAPI_DATARATE_11AX40_433M3BPS_2GI_NSS2
 0x8499

	)

508 
	#FAPI_DATARATE_11AX40_487M5BPS_2GI_NSS2
 0x849a

	)

509 
	#FAPI_DATARATE_11AX40_541M7BPS_2GI_NSS2
 0x849b

	)

510 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI_NSS2
 0x84a0

	)

511 
	#FAPI_DATARATE_11AX40_58M5BPS_4GI_NSS2
 0x84a1

	)

512 
	#FAPI_DATARATE_11AX40_87M8BPS_4GI_NSS2
 0x84a2

	)

513 
	#FAPI_DATARATE_11AX40_117MBPS_4GI_NSS2
 0x84a3

	)

514 
	#FAPI_DATARATE_11AX40_175M5BPS_4GI_NSS2
 0x84a4

	)

515 
	#FAPI_DATARATE_11AX40_234MBPS_4GI_NSS2
 0x84a5

	)

516 
	#FAPI_DATARATE_11AX40_263M3BPS_4GI_NSS2
 0x84a6

	)

517 
	#FAPI_DATARATE_11AX40_292M5BPS_4GI_NSS2
 0x84a7

	)

518 
	#FAPI_DATARATE_11AX40_351MBPS_4GI_NSS2
 0x84a8

	)

519 
	#FAPI_DATARATE_11AX40_390MBPS_4GI_NSS2
 0x84a9

	)

520 
	#FAPI_DATARATE_11AX40_438M8BPS_4GI_NSS2
 0x84¯

	)

521 
	#FAPI_DATARATE_11AX40_487M5BPS_4GI_NSS2
 0x84ab

	)

522 
	#FAPI_DATARATE_11AX40_17M2BPS_1GI_NSS2_DCM
 0x84c0

	)

523 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI_NSS2_DCM
 0x84c1

	)

524 
	#FAPI_DATARATE_11AX40_68M8BPS_1GI_NSS2_DCM
 0x84c3

	)

525 
	#FAPI_DATARATE_11AX40_103M2BPS_1GI_NSS2_DCM
 0x84c4

	)

526 
	#FAPI_DATARATE_11AX40_16M3BPS_2GI_NSS2_DCM
 0x84d0

	)

527 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI_NSS2_DCM
 0x84d1

	)

528 
	#FAPI_DATARATE_11AX40_65MBPS_2GI_NSS2_DCM
 0x84d3

	)

529 
	#FAPI_DATARATE_11AX40_97M5BPS_2GI_NSS2_DCM
 0x84d4

	)

530 
	#FAPI_DATARATE_11AX40_14M6BPS_4GI_NSS2_DCM
 0x84e0

	)

531 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI_NSS2_DCM
 0x84e1

	)

532 
	#FAPI_DATARATE_11AX40_58M5BPS_4GI_NSS2_DCM
 0x84e3

	)

533 
	#FAPI_DATARATE_11AX40_87M8BPS_4GI_NSS2_DCM
 0x84e4

	)

534 
	#FAPI_DATARATE_11AX80_36MBPS_1GI
 0x8800

	)

535 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI
 0x8801

	)

536 
	#FAPI_DATARATE_11AX80_108M1BPS_1GI
 0x8802

	)

537 
	#FAPI_DATARATE_11AX80_144M1BPS_1GI
 0x8803

	)

538 
	#FAPI_DATARATE_11AX80_216M2BPS_1GI
 0x8804

	)

539 
	#FAPI_DATARATE_11AX80_288M2BPS_1GI
 0x8805

	)

540 
	#FAPI_DATARATE_11AX80_324M3BPS_1GI
 0x8806

	)

541 
	#FAPI_DATARATE_11AX80_360M3BPS_1GI
 0x8807

	)

542 
	#FAPI_DATARATE_11AX80_432M4BPS_1GI
 0x8808

	)

543 
	#FAPI_DATARATE_11AX80_480M4BPS_1GI
 0x8809

	)

544 
	#FAPI_DATARATE_11AX80_540M4BPS_1GI
 0x880a

	)

545 
	#FAPI_DATARATE_11AX80_600M4BPS_1GI
 0x880b

	)

546 
	#FAPI_DATARATE_11AX80_34MBPS_2GI
 0x8810

	)

547 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI
 0x8811

	)

548 
	#FAPI_DATARATE_11AX80_102M1BPS_2GI
 0x8812

	)

549 
	#FAPI_DATARATE_11AX80_136M1BPS_2GI
 0x8813

	)

550 
	#FAPI_DATARATE_11AX80_204M2BPS_2GI
 0x8814

	)

551 
	#FAPI_DATARATE_11AX80_272M2BPS_2GI
 0x8815

	)

552 
	#FAPI_DATARATE_11AX80_306M3BPS_2GI
 0x8816

	)

553 
	#FAPI_DATARATE_11AX80_340M3BPS_2GI
 0x8817

	)

554 
	#FAPI_DATARATE_11AX80_408M3BPS_2GI
 0x8818

	)

555 
	#FAPI_DATARATE_11AX80_453M7BPS_2GI
 0x8819

	)

556 
	#FAPI_DATARATE_11AX80_510M4BPS_2GI
 0x881a

	)

557 
	#FAPI_DATARATE_11AX80_567M1BPS_2GI
 0x881b

	)

558 
	#FAPI_DATARATE_11AX80_30M6BPS_4GI
 0x8820

	)

559 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI
 0x8821

	)

560 
	#FAPI_DATARATE_11AX80_91M9BPS_4GI
 0x8822

	)

561 
	#FAPI_DATARATE_11AX80_122M5BPS_4GI
 0x8823

	)

562 
	#FAPI_DATARATE_11AX80_183M8BPS_4GI
 0x8824

	)

563 
	#FAPI_DATARATE_11AX80_245MBPS_4GI
 0x8825

	)

564 
	#FAPI_DATARATE_11AX80_275M6BPS_4GI
 0x8826

	)

565 
	#FAPI_DATARATE_11AX80_306M3BPS_4GI
 0x8827

	)

566 
	#FAPI_DATARATE_11AX80_367M5BPS_4GI
 0x8828

	)

567 
	#FAPI_DATARATE_11AX80_408M3BPS_4GI
 0x8829

	)

568 
	#FAPI_DATARATE_11AX80_459M4BPS_4GI
 0x882a

	)

569 
	#FAPI_DATARATE_11AX80_510M4BPS_4GI
 0x882b

	)

570 
	#FAPI_DATARATE_11AX80_18MBPS_1GI_DCM
 0x8840

	)

571 
	#FAPI_DATARATE_11AX80_36MBPS_1GI_DCM
 0x8841

	)

572 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI_DCM
 0x8843

	)

573 
	#FAPI_DATARATE_11AX80_108M1BPS_1GI_DCM
 0x8844

	)

574 
	#FAPI_DATARATE_11AX80_17MBPS_2GI_DCM
 0x8850

	)

575 
	#FAPI_DATARATE_11AX80_34MBPS_2GI_DCM
 0x8851

	)

576 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI_DCM
 0x8853

	)

577 
	#FAPI_DATARATE_11AX80_102M1BPS_2GI_DCM
 0x8854

	)

578 
	#FAPI_DATARATE_11AX80_15M3BPS_4GI_DCM
 0x8860

	)

579 
	#FAPI_DATARATE_11AX80_30M6BPS_4GI_DCM
 0x8861

	)

580 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI_DCM
 0x8863

	)

581 
	#FAPI_DATARATE_11AX80_91M9BPS_4GI_DCM
 0x8864

	)

582 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI_NSS2
 0x8880

	)

583 
	#FAPI_DATARATE_11AX80_144M1BPS_1GI_NSS2
 0x8881

	)

584 
	#FAPI_DATARATE_11AX80_216M2BPS_1GI_NSS2
 0x8882

	)

585 
	#FAPI_DATARATE_11AX80_288M2BPS_1GI_NSS2
 0x8883

	)

586 
	#FAPI_DATARATE_11AX80_432M4BPS_1GI_NSS2
 0x8884

	)

587 
	#FAPI_DATARATE_11AX80_576M5BPS_1GI_NSS2
 0x8885

	)

588 
	#FAPI_DATARATE_11AX80_648M5BPS_1GI_NSS2
 0x8886

	)

589 
	#FAPI_DATARATE_11AX80_720M6BPS_1GI_NSS2
 0x8887

	)

590 
	#FAPI_DATARATE_11AX80_864M7BPS_1GI_NSS2
 0x8888

	)

591 
	#FAPI_DATARATE_11AX80_960M7BPS_1GI_NSS2
 0x8889

	)

592 
	#FAPI_DATARATE_11AX80_1080M9BPS_1GI_NSS2
 0x888a

	)

593 
	#FAPI_DATARATE_11AX80_1201MBPS_1GI_NSS2
 0x888b

	)

594 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI_NSS2
 0x8890

	)

595 
	#FAPI_DATARATE_11AX80_136M1BPS_2GI_NSS2
 0x8891

	)

596 
	#FAPI_DATARATE_11AX80_204M2BPS_2GI_NSS2
 0x8892

	)

597 
	#FAPI_DATARATE_11AX80_272M2BPS_2GI_NSS2
 0x8893

	)

598 
	#FAPI_DATARATE_11AX80_408M3BPS_2GI_NSS2
 0x8894

	)

599 
	#FAPI_DATARATE_11AX80_544M4BPS_2GI_NSS2
 0x8895

	)

600 
	#FAPI_DATARATE_11AX80_612M5BPS_2GI_NSS2
 0x8896

	)

601 
	#FAPI_DATARATE_11AX80_680M6BPS_2GI_NSS2
 0x8897

	)

602 
	#FAPI_DATARATE_11AX80_816M7BPS_2GI_NSS2
 0x8898

	)

603 
	#FAPI_DATARATE_11AX80_907M4BPS_2GI_NSS2
 0x8899

	)

604 
	#FAPI_DATARATE_11AX80_1020M8BPS_2GI_NSS2
 0x889a

	)

605 
	#FAPI_DATARATE_11AX80_1134M3BPS_2GI_NSS2
 0x889b

	)

606 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI_NSS2
 0x88a0

	)

607 
	#FAPI_DATARATE_11AX80_122M5BPS_4GI_NSS2
 0x88a1

	)

608 
	#FAPI_DATARATE_11AX80_183M8BPS_4GI_NSS2
 0x88a2

	)

609 
	#FAPI_DATARATE_11AX80_245MBPS_4GI_NSS2
 0x88a3

	)

610 
	#FAPI_DATARATE_11AX80_367M5BPS_4GI_NSS2
 0x88a4

	)

611 
	#FAPI_DATARATE_11AX80_490MBPS_4GI_NSS2
 0x88a5

	)

612 
	#FAPI_DATARATE_11AX80_551M3BPS_4GI_NSS2
 0x88a6

	)

613 
	#FAPI_DATARATE_11AX80_612M5BPS_4GI_NSS2
 0x88a7

	)

614 
	#FAPI_DATARATE_11AX80_735MBPS_4GI_NSS2
 0x88a8

	)

615 
	#FAPI_DATARATE_11AX80_816M6BPS_4GI_NSS2
 0x88a9

	)

616 
	#FAPI_DATARATE_11AX80_918M8BPS_4GI_NSS2
 0x88¯

	)

617 
	#FAPI_DATARATE_11AX80_1020M8BPS_4GI_NSS2
 0x88ab

	)

618 
	#FAPI_DATARATE_11AX80_36MBPS_1GI_NSS2_DCM
 0x88c0

	)

619 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI_NSS2_DCM
 0x88c1

	)

620 
	#FAPI_DATARATE_11AX80_144M1BPS_1GI_NSS2_DCM
 0x88c3

	)

621 
	#FAPI_DATARATE_11AX80_216M2BPS_1GI_NSS2_DCM
 0x88c4

	)

622 
	#FAPI_DATARATE_11AX80_34MBPS_2GI_NSS2_DCM
 0x88d0

	)

623 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI_NSS2_DCM
 0x88d1

	)

624 
	#FAPI_DATARATE_11AX80_136M1BPS_2GI_NSS2_DCM
 0x88d3

	)

625 
	#FAPI_DATARATE_11AX80_204M2BPS_2GI_NSS2_DCM
 0x88d4

	)

626 
	#FAPI_DATARATE_11AX80_30M6BPS_4GI_NSS2_DCM
 0x88e0

	)

627 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI_NSS2_DCM
 0x88e1

	)

628 
	#FAPI_DATARATE_11AX80_122M5BPS_4GI_NSS2_DCM
 0x88e3

	)

629 
	#FAPI_DATARATE_11AX80_183M8BPS_4GI_NSS2_DCM
 0x88e4

	)

630 
	#FAPI_DATARATE_11AX160_72M1BPS_1GI
 0x8c00

	)

631 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI
 0x8c01

	)

632 
	#FAPI_DATARATE_11AX160_216M2BPS_1GI
 0x8c02

	)

633 
	#FAPI_DATARATE_11AX160_288M2BPS_1GI
 0x8c03

	)

634 
	#FAPI_DATARATE_11AX160_432M4BPS_1GI
 0x8c04

	)

635 
	#FAPI_DATARATE_11AX160_576M5BPS_1GI
 0x8c05

	)

636 
	#FAPI_DATARATE_11AX160_648M5BPS_1GI
 0x8c06

	)

637 
	#FAPI_DATARATE_11AX160_720M6BPS_1GI
 0x8c07

	)

638 
	#FAPI_DATARATE_11AX160_864M7BPS_1GI
 0x8c08

	)

639 
	#FAPI_DATARATE_11AX160_960M7BPS_1GI
 0x8c09

	)

640 
	#FAPI_DATARATE_11AX160_1080M9BPS_1GI
 0x8c0a

	)

641 
	#FAPI_DATARATE_11AX160_1201MBPS_1GI
 0x8c0b

	)

642 
	#FAPI_DATARATE_11AX160_68M1BPS_2GI
 0x8c10

	)

643 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI
 0x8c11

	)

644 
	#FAPI_DATARATE_11AX160_204M2BPS_2GI
 0x8c12

	)

645 
	#FAPI_DATARATE_11AX160_272M2BPS_2GI
 0x8c13

	)

646 
	#FAPI_DATARATE_11AX160_408M3BPS_2GI
 0x8c14

	)

647 
	#FAPI_DATARATE_11AX160_544M4BPS_2GI
 0x8c15

	)

648 
	#FAPI_DATARATE_11AX160_612M5BPS_2GI
 0x8c16

	)

649 
	#FAPI_DATARATE_11AX160_680M6BPS_2GI
 0x8c17

	)

650 
	#FAPI_DATARATE_11AX160_816M7BPS_2GI
 0x8c18

	)

651 
	#FAPI_DATARATE_11AX160_907M4BPS_2GI
 0x8c19

	)

652 
	#FAPI_DATARATE_11AX160_1020M8BPS_2GI
 0x8c1a

	)

653 
	#FAPI_DATARATE_11AX160_1134M2BPS_2GI
 0x8c1b

	)

654 
	#FAPI_DATARATE_11AX160_61M3BPS_4GI
 0x8c20

	)

655 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI
 0x8c21

	)

656 
	#FAPI_DATARATE_11AX160_183M8BPS_4GI
 0x8c22

	)

657 
	#FAPI_DATARATE_11AX160_245MBPS_4GI
 0x8c23

	)

658 
	#FAPI_DATARATE_11AX160_367M5BPS_4GI
 0x8c24

	)

659 
	#FAPI_DATARATE_11AX160_490MBPS_4GI
 0x8c25

	)

660 
	#FAPI_DATARATE_11AX160_551M3BPS_4GI
 0x8c26

	)

661 
	#FAPI_DATARATE_11AX160_612M5BPS_4GI
 0x8c27

	)

662 
	#FAPI_DATARATE_11AX160_735MBPS_4GI
 0x8c28

	)

663 
	#FAPI_DATARATE_11AX160_816M6BPS_4GI
 0x8c29

	)

664 
	#FAPI_DATARATE_11AX160_918M8BPS_4GI
 0x8c2a

	)

665 
	#FAPI_DATARATE_11AX160_1020M8BPS_4GI
 0x8c2b

	)

666 
	#FAPI_DATARATE_11AX160_36MBPS_1GI_DCM
 0x8c40

	)

667 
	#FAPI_DATARATE_11AX160_72M1BPS_1GI_DCM
 0x8c41

	)

668 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI_DCM
 0x8c43

	)

669 
	#FAPI_DATARATE_11AX160_216M2BPS_1GI_DCM
 0x8c44

	)

670 
	#FAPI_DATARATE_11AX160_34MBPS_2GI_DCM
 0x8c50

	)

671 
	#FAPI_DATARATE_11AX160_68M1BPS_2GI_DCM
 0x8c51

	)

672 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI_DCM
 0x8c53

	)

673 
	#FAPI_DATARATE_11AX160_204M2BPS_2GI_DCM
 0x8c54

	)

674 
	#FAPI_DATARATE_11AX160_30M6BPS_4GI_DCM
 0x8c60

	)

675 
	#FAPI_DATARATE_11AX160_61M3BPS_4GI_DCM
 0x8c61

	)

676 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI_DCM
 0x8c63

	)

677 
	#FAPI_DATARATE_11AX160_183M8BPS_4GI_DCM
 0x8c64

	)

678 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI_NSS2
 0x8c80

	)

679 
	#FAPI_DATARATE_11AX160_288M2BPS_1GI_NSS2
 0x8c81

	)

680 
	#FAPI_DATARATE_11AX160_432M4BPS_1GI_NSS2
 0x8c82

	)

681 
	#FAPI_DATARATE_11AX160_576M5BPS_1GI_NSS2
 0x8c83

	)

682 
	#FAPI_DATARATE_11AX160_864M7BPS_1GI_NSS2
 0x8c84

	)

683 
	#FAPI_DATARATE_11AX160_1152M9BPS_1GI_NSS2
 0x8c85

	)

684 
	#FAPI_DATARATE_11AX160_1297M1BPS_1GI_NSS2
 0x8c86

	)

685 
	#FAPI_DATARATE_11AX160_1441M2BPS_1GI_NSS2
 0x8c87

	)

686 
	#FAPI_DATARATE_11AX160_1729M4BPS_1GI_NSS2
 0x8c88

	)

687 
	#FAPI_DATARATE_11AX160_1921M5BPS_1GI_NSS2
 0x8c89

	)

688 
	#FAPI_DATARATE_11AX160_2161M8BPS_1GI_NSS2
 0x8c8a

	)

689 
	#FAPI_DATARATE_11AX160_2401M9BPS_1GI_NSS2
 0x8c8b

	)

690 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI_NSS2
 0x8c90

	)

691 
	#FAPI_DATARATE_11AX160_272M2BPS_2GI_NSS2
 0x8c91

	)

692 
	#FAPI_DATARATE_11AX160_408M3BPS_2GI_NSS2
 0x8c92

	)

693 
	#FAPI_DATARATE_11AX160_544M4BPS_2GI_NSS2
 0x8c93

	)

694 
	#FAPI_DATARATE_11AX160_816M7BPS_2GI_NSS2
 0x8c94

	)

695 
	#FAPI_DATARATE_11AX160_1088M9BPS_2GI_NSS2
 0x8c95

	)

696 
	#FAPI_DATARATE_11AX160_1225MBPS_2GI_NSS2
 0x8c96

	)

697 
	#FAPI_DATARATE_11AX160_1361M1BPS_2GI_NSS2
 0x8c97

	)

698 
	#FAPI_DATARATE_11AX160_1633M3BPS_2GI_NSS2
 0x8c98

	)

699 
	#FAPI_DATARATE_11AX160_1814M8BPS_2GI_NSS2
 0x8c99

	)

700 
	#FAPI_DATARATE_11AX160_2041M7BPS_2GI_NSS2
 0x8c9a

	)

701 
	#FAPI_DATARATE_11AX160_2268M5BPS_2GI_NSS2
 0x8c9b

	)

702 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI_NSS2
 0x8ÿ0

	)

703 
	#FAPI_DATARATE_11AX160_245MBPS_4GI_NSS2
 0x8ÿ1

	)

704 
	#FAPI_DATARATE_11AX160_367M5BPS_4GI_NSS2
 0x8ÿ2

	)

705 
	#FAPI_DATARATE_11AX160_490MBPS_4GI_NSS2
 0x8ÿ3

	)

706 
	#FAPI_DATARATE_11AX160_735MBPS_4GI_NSS2
 0x8ÿ4

	)

707 
	#FAPI_DATARATE_11AX160_980MBPS_4GI_NSS2
 0x8ÿ5

	)

708 
	#FAPI_DATARATE_11AX160_1102M5BPS_4GI_NSS2
 0x8ÿ6

	)

709 
	#FAPI_DATARATE_11AX160_1225MBPS_4GI_NSS2
 0x8ÿ7

	)

710 
	#FAPI_DATARATE_11AX160_1470MBPS_4GI_NSS2
 0x8ÿ8

	)

711 
	#FAPI_DATARATE_11AX160_1633M3BPS_4GI_NSS2
 0x8ÿ9

	)

712 
	#FAPI_DATARATE_11AX160_1837M5BPS_4GI_NSS2
 0x8ÿa

	)

713 
	#FAPI_DATARATE_11AX160_2041M6BPS_4GI_NSS2
 0x8ÿb

	)

714 
	#FAPI_DATARATE_11AX160_72M1BPS_1GI_NSS2_DCM
 0x8cc0

	)

715 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI_NSS2_DCM
 0x8cc1

	)

716 
	#FAPI_DATARATE_11AX160_288M2BPS_1GI_NSS2_DCM
 0x8cc3

	)

717 
	#FAPI_DATARATE_11AX160_432M4BPS_1GI_NSS2_DCM
 0x8cc4

	)

718 
	#FAPI_DATARATE_11AX160_68M1BPS_2GI_NSS2_DCM
 0x8cd0

	)

719 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI_NSS2_DCM
 0x8cd1

	)

720 
	#FAPI_DATARATE_11AX160_272M2BPS_2GI_NSS2_DCM
 0x8cd3

	)

721 
	#FAPI_DATARATE_11AX160_408M3BPS_2GI_NSS2_DCM
 0x8cd4

	)

722 
	#FAPI_DATARATE_11AX160_61M3BPS_4GI_NSS2_DCM
 0x8û0

	)

723 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI_NSS2_DCM
 0x8û1

	)

724 
	#FAPI_DATARATE_11AX160_245MBPS_4GI_NSS2_DCM
 0x8û3

	)

725 
	#FAPI_DATARATE_11AX160_367M5BPS_4GI_NSS2_DCM
 0x8û4

	)

726 
	#FAPI_DATARATE_CTR_TOTAL
 0xe000

	)

727 
	#FAPI_DATARATE_CTR_NO_ERROR
 0xe001

	)

728 
	#FAPI_DATARATE_CTR_CRC_ERROR
 0xe002

	)

729 
	#FAPI_DATARATE_CTR_BAD_SIGNAL
 0xe003

	)

730 
	#FAPI_DATARATE_CTR_STBC
 0xe004

	)

731 
	#FAPI_DATARATE_CTR_DUPLICATE
 0xe005

	)

732 
	#FAPI_DATARATE_CTR_ERROR
 0xe006

	)

733 
	#FAPI_DATARATE_CTR_LDPC
 0xe007

	)

734 
	#FAPI_DATARATE_CTR_BEAMFORMED
 0xe008

	)

735 
	#FAPI_DATARATE_CTR_FROM_AP
 0xe009

	)

736 
	#FAPI_DATARATE_CTR_INVALID_RSSI
 0xe00a

	)

738 
	#FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
 0x0000

	)

739 
	#FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
 0x0001

	)

740 
	#FAPI_DATAUNITDESCRIPTOR_AMSDU_SUBFRAME
 0x0002

	)

742 
	#FAPI_DEVICEROLE_INFRASTRUCTURE_STATION
 0x0001

	)

743 
	#FAPI_DEVICEROLE_P2P_GO
 0x0002

	)

744 
	#FAPI_DEVICEROLE_P2P_DEVICE
 0x0003

	)

745 
	#FAPI_DEVICEROLE_P2P_CLIENT
 0x0004

	)

747 
	#FAPI_DEVICESTATE_IDLE
 0

	)

748 
	#FAPI_DEVICESTATE_RX_RUNNING
 1

	)

749 
	#FAPI_DEVICESTATE_TX_RUNNING
 2

	)

750 
	#FAPI_DEVICESTATE_CW_RUNNING
 3

	)

751 
	#FAPI_DEVICESTATE_BIST_RUNNING
 4

	)

753 
	#FAPI_DIRECTION_TRANSMIT
 0x0000

	)

754 
	#FAPI_DIRECTION_RECEIVE
 0x0001

	)

756 
	#FAPI_ENDPOINT_HOSTIO
 0x0001

	)

757 
	#FAPI_ENDPOINT_DPLP
 0x0002

	)

759 
	#FAPI_EVENT_WIFI_EVENT_ASSOCIATION_REQUESTED
 0x0000

	)

760 
	#FAPI_EVENT_WIFI_EVENT_AUTH_RECEIVED
 0x0001

	)

761 
	#FAPI_EVENT_WIFI_EVENT_ASSOC_COMPLETE
 0x0002

	)

762 
	#FAPI_EVENT_WIFI_EVENT_FW_AUTH_SENT
 0x0003

	)

763 
	#FAPI_EVENT_WIFI_EVENT_FW_ASSOC_STARTED
 0x0004

	)

764 
	#FAPI_EVENT_WIFI_EVENT_FW_RE_ASSOC_STARTED
 0x0005

	)

765 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_SCAN_REQUESTED
 0x0006

	)

766 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_SCAN_RESULT_FOUND
 0x0007

	)

767 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_SCAN_COMPLETE
 0x0008

	)

768 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_STARTED
 0x0009

	)

769 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_COMPLETE
 0x000a

	)

770 
	#FAPI_EVENT_WIFI_EVENT_DISASSOCIATION_REQUESTED
 0x000b

	)

771 
	#FAPI_EVENT_WIFI_EVENT_RE_ASSOCIATION_REQUESTED
 0x000c

	)

772 
	#FAPI_EVENT_WIFI_EVENT_ROAM_REQUESTED
 0x000d

	)

773 
	#FAPI_EVENT_WIFI_EVENT_BEACON_RECEIVED
 0x000e

	)

774 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_STARTED
 0x000f

	)

775 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_COMPLETE
 0x0010

	)

776 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STARTED
 0x0011

	)

777 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STOPPED
 0x0012

	)

778 
	#FAPI_EVENT_WIFI_EVENT_CHANNEL_SWITCH_ANOUNCEMENT
 0x0014

	)

779 
	#FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START
 0x0015

	)

780 
	#FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP
 0x0016

	)

781 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_EAPOL_FRAME_TRANSMIT_REQUESTED
 0x0017

	)

782 
	#FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED
 0x0018

	)

783 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_EAPOL_FRAME_RECEIVED
 0x001a

	)

784 
	#FAPI_EVENT_WIFI_EVENT_BLOCK_ACK_NEGOTIATION_COMPLETE
 0x001b

	)

785 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCO_START
 0x001c

	)

786 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCO_STOP
 0x001d

	)

787 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCAN_START
 0x001e

	)

788 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCAN_STOP
 0x001f

	)

789 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_HID_START
 0x0020

	)

790 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_HID_STOP
 0x0021

	)

791 
	#FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_SENT
 0x0022

	)

792 
	#FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_RECEIVED
 0x0023

	)

793 
	#FAPI_EVENT_WIFI_EVENT_ROAM_ASSOC_STARTED
 0x0024

	)

794 
	#FAPI_EVENT_WIFI_EVENT_ROAM_ASSOC_COMPLETE
 0x0025

	)

795 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_STOP
 0x0026

	)

796 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_CYCLE_STARTED
 0x0027

	)

797 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_CYCLE_COMPLETED
 0x0028

	)

798 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_BUCKET_STARTED
 0x0029

	)

799 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_BUCKET_COMPLETED
 0x002a

	)

800 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_RESULTS_AVAILABLE
 0x002b

	)

801 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_CAPABILITIES
 0x002c

	)

802 
	#FAPI_EVENT_WIFI_EVENT_ROAM_CANDIDATE_FOUND
 0x002d

	)

803 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_CONFIG
 0x002e

	)

804 
	#FAPI_EVENT_WIFI_EVENT_AUTH_TIMEOUT
 0x002f

	)

805 
	#FAPI_EVENT_WIFI_EVENT_ASSOC_TIMEOUT
 0x0030

	)

806 
	#FAPI_EVENT_WIFI_EVENT_MEM_ALLOC_FAILURE
 0x0031

	)

807 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_ADD
 0x0032

	)

808 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_REMOVE
 0x0033

	)

809 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_NETWORK_FOUND
 0x0034

	)

810 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_SCAN_REQUESTED
 0x0035

	)

811 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_SCAN_RESULT_FOUND
 0x0036

	)

812 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_SCAN_COMPLETE
 0x0037

	)

813 
	#FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_REQUEST
 0x0038

	)

814 
	#FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_RESPONSE
 0x0039

	)

815 
	#FAPI_EVENT_WIFI_EVENT_FW_NR_FRAME_REQUEST
 0x003a

	)

816 
	#FAPI_EVENT_WIFI_EVENT_FW_CONNECTION_ATTEMPT_ABORTED
 0x003c

	)

817 
	#FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_TIMEOUT
 0x003d

	)

818 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_RESULT
 0x003e

	)

819 
	#FAPI_EVENT_WIFI_EVENT_ROAM_RSSI_THRESHOLD
 0x003f

	)

820 
	#FAPI_EVENT_WIFI_EVENT_FW_BEACON_REPORT_REQUEST
 0x0040

	)

821 
	#FAPI_EVENT_WIFI_EVENT_FW_FTM_RANGE_REQUEST
 0x0041

	)

822 
	#FAPI_EVENT_WIFI_EVENT_FW_NAN_ROLE_TYPE
 0x0042

	)

823 
	#FAPI_EVENT_WIFI_EVENT_FW_FRAME_TRANSMIT_FAILURE
 0x0043

	)

824 
	#FAPI_EVENT_WIFI_EVENT_FW_NR_FRAME_RESPONSE
 0x0044

	)

825 
	#FAPI_EVENT_WIFI_EVENT_NAN_AVAILABILITY_UPDATE
 0x0045

	)

826 
	#FAPI_EVENT_WIFI_EVENT_NAN_ULW_UPDATE
 0x0046

	)

827 
	#FAPI_EVENT_WIFI_EVENT_NAN_TRAFFIC_UPDATE
 0x0047

	)

828 
	#FAPI_EVENT_WIFI_EVENT_BLACKOUT_START
 0x0064

	)

829 
	#FAPI_EVENT_WIFI_EVENT_BLACKOUT_STOP
 0x0065

	)

830 
	#FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
 0x0100

	)

831 
	#FAPI_EVENT_WIFI_EVENT_NAN_SUBSCRIBE_TERMINATED
 0x0101

	)

832 
	#FAPI_EVENT_WIFI_EVENT_NAN_MATCH_EXPIRED
 0x0102

	)

833 
	#FAPI_EVENT_WIFI_EVENT_NAN_ADDRESS_CHANGED
 0x0103

	)

834 
	#FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_STARTED
 0x0104

	)

835 
	#FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_JOINED
 0x0105

	)

836 
	#FAPI_EVENT_WIFI_EVENT_NAN_TRANSMIT_FOLLOWUP
 0x0106

	)

838 
	#FAPI_GI_0_8_MICROSECONDS
 0x0

	)

839 
	#FAPI_GI_1_6_MICROSECONDS
 0x1

	)

840 
	#FAPI_GI_0_4_MICROSECONDS
 0x2

	)

841 
	#FAPI_GI_3_2_MICROSECONDS
 0x3

	)

843 
	#FAPI_HIDDENSSID_NOT_HIDDEN
 0x0000

	)

844 
	#FAPI_HIDDENSSID_HIDDEN_ZERO_LENGTH
 0x0001

	)

845 
	#FAPI_HIDDENSSID_HIDDEN_ZERO_DATA
 0x0002

	)

847 
	#FAPI_KEYTYPE_GROUP
 0x0000

	)

848 
	#FAPI_KEYTYPE_PAIRWISE
 0x0001

	)

849 
	#FAPI_KEYTYPE_WEP
 0x0002

	)

850 
	#FAPI_KEYTYPE_IGTK
 0x0003

	)

851 
	#FAPI_KEYTYPE_PMK
 0x0004

	)

852 
	#FAPI_KEYTYPE_BIGTK
 0x0005

	)

853 
	#FAPI_KEYTYPE_FIRST_ILLEGAL
 0x0006

	)

855 
	#FAPI_MACID_AUTO
 0

	)

856 
	#FAPI_MACID_DIET
 1

	)

857 
	#FAPI_MACID_PRI
 2

	)

858 
	#FAPI_MACID_SEC
 3

	)

860 
	#FAPI_MESSAGETYPE_EAP_MESSAGE
 0x0001

	)

861 
	#FAPI_MESSAGETYPE_EAPOL_KEY_M123
 0x0002

	)

862 
	#FAPI_MESSAGETYPE_EAPOL_KEY_M4
 0x0003

	)

863 
	#FAPI_MESSAGETYPE_ARP
 0x0004

	)

864 
	#FAPI_MESSAGETYPE_DHCP
 0x0005

	)

865 
	#FAPI_MESSAGETYPE_NEIGHBOR_DISCOVERY
 0x0006

	)

866 
	#FAPI_MESSAGETYPE_WAI_MESSAGE
 0x0007

	)

867 
	#FAPI_MESSAGETYPE_ANY_OTHER
 0x0008

	)

868 
	#FAPI_MESSAGETYPE_IEEE80211_ACTION
 0x0010

	)

869 
	#FAPI_MESSAGETYPE_IEEE80211_MGMT
 0x0011

	)

871 
	#FAPI_MODE_SOURCE
 0x0001

	)

872 
	#FAPI_MODE_SINK
 0x0002

	)

873 
	#FAPI_MODE_LOOPBACK
 0x0003

	)

875 
	#FAPI_NANAVAILABILITYDURATION_16MS
 0x00

	)

876 
	#FAPI_NANAVAILABILITYDURATION_32MS
 0x01

	)

877 
	#FAPI_NANAVAILABILITYDURATION_64MS
 0x02

	)

879 
	#FAPI_NANOPERATIONCONTROL_MAC_ADDRESS_EVENT
 0x0002

	)

880 
	#FAPI_NANOPERATIONCONTROL_START_CLUSTER_EVENT
 0x0004

	)

881 
	#FAPI_NANOPERATIONCONTROL_JOINED_CLUSTER_EVENT
 0x0008

	)

883 
	#FAPI_NANSDFCONTROL_PUBLISH_END_EVENT
 0x0001

	)

884 
	#FAPI_NANSDFCONTROL_SUBSCRIBE_END_EVENT
 0x0002

	)

885 
	#FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
 0x0004

	)

886 
	#FAPI_NANSDFCONTROL_RECEIVED_FOLLOWUP_EVENT
 0x0008

	)

887 
	#FAPI_NANSDFCONTROL_FOLLOWUP_TRANSMIT_STATUS
 0x0010

	)

889 
	#FAPI_NANTLVTYPE_NANCONFIGURATION
 0x0101

	)

890 
	#FAPI_NANTLVTYPE_2_4_BANDSPECIFICCONFIG
 0x0102

	)

891 
	#FAPI_NANTLVTYPE_5_BANDSPECIFICCONFIG
 0x0103

	)

892 
	#FAPI_NANTLVTYPE_SUBSCRIBESPECIFIC
 0x0104

	)

893 
	#FAPI_NANTLVTYPE_DISCOVERYCOMMONCONFIG
 0x0105

	)

894 
	#FAPI_NANTLVTYPE_SERVICENAME
 0x0106

	)

895 
	#FAPI_NANTLVTYPE_SERVICESPECIFICINFO
 0x0107

	)

896 
	#FAPI_NANTLVTYPE_EXTENDEDSERVICESPECIFICINFO
 0x0108

	)

897 
	#FAPI_NANTLVTYPE_RXMATCHFILTER
 0x0109

	)

898 
	#FAPI_NANTLVTYPE_TXMATCHFILTER
 0x010a

	)

899 
	#FAPI_NANTLVTYPE_MATCHFILTER
 0x010b

	)

900 
	#FAPI_NANTLVTYPE_INTERFACEADDRESSSET
 0x010c

	)

901 
	#FAPI_NANTLVTYPE_MATCHIND
 0x010d

	)

902 
	#FAPI_NANTLVTYPE_DATAPATHSECURITY
 0x010e

	)

903 
	#FAPI_NANTLVTYPE_APPINFO
 0x010f

	)

904 
	#FAPI_NANTLVTYPE_RANGING
 0x0110

	)

905 
	#FAPI_NANTLVTYPE_NANCONFIGREQUESTSUPPLEMENTAL
 0x0111

	)

906 
	#FAPI_NANTLVTYPE_NANRTTCONFIG
 0x0112

	)

907 
	#FAPI_NANTLVTYPE_NANRTTRESULT
 0x0113

	)

909 
	#FAPI_OPERATINGCLASSSET_UNKNOWN
 0x0000

	)

910 
	#FAPI_OPERATINGCLASSSET_FCC
 0x0001

	)

911 
	#FAPI_OPERATINGCLASSSET_ETSI
 0x0002

	)

912 
	#FAPI_OPERATINGCLASSSET_JAPAN
 0x0003

	)

913 
	#FAPI_OPERATINGCLASSSET_GLOBAL
 0x0004

	)

914 
	#FAPI_OPERATINGCLASSSET_CHINA
 0x0006

	)

916 
	#FAPI_OPTION_INLINE
 0x0001

	)

917 
	#FAPI_OPTION_SYSMMU
 0x0002

	)

918 
	#FAPI_OPTION_LINKED
 0x0004

	)

919 
	#FAPI_OPTION_KEYRSC
 0x0008

	)

920 
	#FAPI_OPTION_DISCARD
 0xff00

	)

922 
	#FAPI_PACKETFILTERMODE_OPT_OUT
 0x01

	)

923 
	#FAPI_PACKETFILTERMODE_OPT_IN
 0x02

	)

924 
	#FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
 0x04

	)

925 
	#FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
 0x08

	)

927 
	#FAPI_PHY_HE_RATE
 0x0

	)

928 
	#FAPI_PHY_NON_HT_RATE
 0x1

	)

929 
	#FAPI_PHY_HT_RATE
 0x2

	)

930 
	#FAPI_PHY_VHT_RATE
 0x3

	)

932 
	#FAPI_PMALLOCAREA_PMALLOC_STATS
 0x0000

	)

933 
	#FAPI_PMALLOCAREA_PMALLOC_FSM_STATS
 0x0001

	)

934 
	#FAPI_PMALLOCAREA_HOSTIO_SIG_SIZES
 0x0002

	)

936 
	#FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
 0x0000

	)

937 
	#FAPI_POWERMANAGEMENTMODE_POWER_SAVE
 0x0001

	)

939 
	#FAPI_PRIMARYCHANNELPOSITION_P0
 0x00

	)

940 
	#FAPI_PRIMARYCHANNELPOSITION_P1
 0x01

	)

941 
	#FAPI_PRIMARYCHANNELPOSITION_P2
 0x02

	)

942 
	#FAPI_PRIMARYCHANNELPOSITION_P3
 0x03

	)

943 
	#FAPI_PRIMARYCHANNELPOSITION_P4
 0x04

	)

944 
	#FAPI_PRIMARYCHANNELPOSITION_P5
 0x05

	)

945 
	#FAPI_PRIMARYCHANNELPOSITION_P6
 0x06

	)

946 
	#FAPI_PRIMARYCHANNELPOSITION_P7
 0x07

	)

947 
	#FAPI_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x08

	)

949 
	#FAPI_PRIORITY_QOS_UP0
 0x0000

	)

950 
	#FAPI_PRIORITY_QOS_UP1
 0x0001

	)

951 
	#FAPI_PRIORITY_QOS_UP2
 0x0002

	)

952 
	#FAPI_PRIORITY_QOS_UP3
 0x0003

	)

953 
	#FAPI_PRIORITY_QOS_UP4
 0x0004

	)

954 
	#FAPI_PRIORITY_QOS_UP5
 0x0005

	)

955 
	#FAPI_PRIORITY_QOS_UP6
 0x0006

	)

956 
	#FAPI_PRIORITY_QOS_UP7
 0x0007

	)

957 
	#FAPI_PRIORITY_CONTENTION
 0x8000

	)

959 
	#FAPI_PROCEDURETYPE_UNKNOWN
 0x0000

	)

960 
	#FAPI_PROCEDURETYPE_CONNECTION_STARTED
 0x0001

	)

961 
	#FAPI_PROCEDURETYPE_DEVICE_DISCOVERED
 0x0002

	)

962 
	#FAPI_PROCEDURETYPE_ROAMING_STARTED
 0x0003

	)

964 
	#FAPI_PROCESSOR_DEFAULT
 0x0

	)

965 
	#FAPI_PROCESSOR_CHIPCPU
 0x1

	)

966 
	#FAPI_PROCESSOR_HOSTCPU
 0x3

	)

968 
	#FAPI_PROTOCOL_UDP
 0x0001

	)

969 
	#FAPI_PROTOCOL_TCP
 0x0002

	)

971 
	#FAPI_PURPOSE_BEACON
 0x0001

	)

972 
	#FAPI_PURPOSE_PROBE_RESPONSE
 0x0002

	)

973 
	#FAPI_PURPOSE_ASSOCIATION_RESPONSE
 0x0004

	)

974 
	#FAPI_PURPOSE_LOCAL
 0x0008

	)

975 
	#FAPI_PURPOSE_ASSOCIATION_REQUEST
 0x0010

	)

976 
	#FAPI_PURPOSE_PROBE_REQUEST
 0x0020

	)

978 
	#FAPI_RADIOBAND_AUTO
 0

	)

979 
	#FAPI_RADIOBAND_2G
 1

	)

980 
	#FAPI_RADIOBAND_5G
 2

	)

981 
	#FAPI_RADIOBAND_6G
 3

	)

983 
	#FAPI_RADIOBITMAP_RADIO_0
 0x0001

	)

984 
	#FAPI_RADIOBITMAP_RADIO_1
 0x0002

	)

986 
	#FAPI_REASONCODE_RESERVED
 0x0000

	)

987 
	#FAPI_REASONCODE_UNSPECIFIED_REASON
 0x0001

	)

988 
	#FAPI_REASONCODE_DEAUTHENTICATED_INVALID_AUTHENTICATION
 0x0002

	)

989 
	#FAPI_REASONCODE_DEAUTHENTICATED_LEAVING
 0x0003

	)

990 
	#FAPI_REASONCODE_DEAUTHENTICATED_NO_MORE_STATIONS
 0x0005

	)

991 
	#FAPI_REASONCODE_DEAUTHENTICATED_INVALID_CLASS_2_FRAME
 0x0006

	)

992 
	#FAPI_REASONCODE_DEAUTHENTICATED_INVALID_CLASS_3_FRAME
 0x0007

	)

993 
	#FAPI_REASONCODE_DEAUTHENTICATED_BSS_TRANSITION_MANAGEMENT
 0x000c

	)

994 
	#FAPI_REASONCODE_DEAUTHENTICATED_REASON_INVALID_IE
 0x000d

	)

995 
	#FAPI_REASONCODE_DEAUTHENTICATED_4_WAY_HANDSHAKE_TIMEOUT
 0x000f

	)

996 
	#FAPI_REASONCODE_DEAUTHENTICATED_GROUP_HANDSHAKE_TIMEOUT
 0x0010

	)

997 
	#FAPI_REASONCODE_DEAUTHENTICATED_HANDSHAKE_ELEMENT_MISMATCH
 0x0011

	)

998 
	#FAPI_REASONCODE_DEAUTHENTICATED_REASON_INVALID_RSNE
 0x0014

	)

999 
	#FAPI_REASONCODE_DEAUTHENTICATED_802_1_X_AUTH_FAILED
 0x0017

	)

1000 
	#FAPI_REASONCODE_TDLS_PEER_UNREACHABLE
 0x0019

	)

1001 
	#FAPI_REASONCODE_TDLS_TEARDOWN_UNSPECIFIED_REASON
 0x001a

	)

1002 
	#FAPI_REASONCODE_QOS_UNSPECIFIED_REASON
 0x0020

	)

1003 
	#FAPI_REASONCODE_QOS_EXCESSIVE_NOT_ACK
 0x0022

	)

1004 
	#FAPI_REASONCODE_QOS_TXOP_LIMIT_EXCEEDED
 0x0023

	)

1005 
	#FAPI_REASONCODE_QSTA_LEAVING
 0x0024

	)

1006 
	#FAPI_REASONCODE_END
 0x0025

	)

1007 
	#FAPI_REASONCODE_UNKNOWN
 0x0026

	)

1008 
	#FAPI_REASONCODE_TIMEOUT
 0x0027

	)

1009 
	#FAPI_REASONCODE_KEEP_ALIVE_FAILURE
 0x0028

	)

1010 
	#FAPI_REASONCODE_START
 0x0029

	)

1011 
	#FAPI_REASONCODE_DEAUTHENTICATED_REASON_INVALID_PMKID
 0x0031

	)

1012 
	#FAPI_REASONCODE_INVALID_PMKID
 0x0049

	)

1013 
	#FAPI_REASONCODE_SYNCHRONISATION_LOSS
 0x8003

	)

1014 
	#FAPI_REASONCODE_SECURITY_REQUIRED
 0x8004

	)

1015 
	#FAPI_REASONCODE_ROAMING_FAILURE_LINK_LOSS_NO_CANDIDATE
 0x8005

	)

1016 
	#FAPI_REASONCODE_HOTSPOT_MAX_CLIENT_REACHED
 0x8006

	)

1017 
	#FAPI_REASONCODE_CHANNEL_SWITCH_FAILURE
 0x8007

	)

1018 
	#FAPI_REASONCODE_REPORTING_ABORTED_SCANNING
 0x8008

	)

1019 
	#FAPI_REASONCODE_REPORTING_ABORTED_ROAMING
 0x8009

	)

1020 
	#FAPI_REASONCODE_OUT_OF_RANGE_SEQUENCE_NUMBER
 0x800a

	)

1021 
	#FAPI_REASONCODE_MISUSE_OF_AMSDU
 0x800b

	)

1022 
	#FAPI_REASONCODE_TDLS_INSUFFICIENT_TRAFFIC
 0x800c

	)

1023 
	#FAPI_REASONCODE_TDLS_NO_TRAFFIC
 0x800d

	)

1024 
	#FAPI_REASONCODE_TDLS_ROAMED
 0x800e

	)

1025 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_TIMEOUT
 0x9001

	)

1026 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_USER_REQUEST
 0x9002

	)

1027 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_COUNT_REACHED
 0x9003

	)

1028 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_DISCOVERY_SHUTDOWN
 0x9004

	)

1029 
	#FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_SUCCESS
 0x9006

	)

1030 
	#FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_FAILURE
 0x9007

	)

1031 
	#FAPI_REASONCODE_NDP_ACCEPTED
 0x9008

	)

1032 
	#FAPI_REASONCODE_NDP_REJECTED
 0x9009

	)

1033 
	#FAPI_REASONCODE_NDP_RESPONSE_TIMEOUT
 0x900a

	)

1034 
	#FAPI_REASONCODE_HOST_INITIATED
 0xa000

	)

1035 
	#FAPI_REASONCODE_PEER_INITIATED
 0xa001

	)

1036 
	#FAPI_REASONCODE_CONCURRENT_OPERATION_SAME_BAND
 0xa002

	)

1037 
	#FAPI_REASONCODE_CONCURRENT_OPERATION_DIFFERENT_BAND
 0xa003

	)

1038 
	#FAPI_REASONCODE_ROAMING_OR_ECSA
 0xa004

	)

1039 
	#FAPI_REASONCODE_BT_COEX
 0xa005

	)

1040 
	#FAPI_REASONCODE_WTC_REASON_MOVE_TO_CELLULAR
 0xb000

	)

1041 
	#FAPI_REASONCODE_WTC_REASON_UNSPECIFIED
 0xb001

	)

1042 
	#FAPI_REASONCODE_WTC_REASON_NOT_SUPPORTED
 0xb002

	)

1043 
	#FAPI_REASONCODE_WTC_REASON_NO_CELLULAR_NETWORK
 0xb003

	)

1044 
	#FAPI_REASONCODE_WTC_REASON_CONTROLLED_BY_FRAMEWORK
 0xb004

	)

1045 
	#FAPI_REASONCODE_WTC_REASON_ROAM_TO_BETTER_AP
 0xb005

	)

1046 
	#FAPI_REASONCODE_WTC_REASON_SUSPEND_MODE
 0xb006

	)

1047 
	#FAPI_REASONCODE_WTC_REASON_RSSI_STRONG_ENOUGH
 0xb007

	)

1049 
	#FAPI_REPORTMODE_RESERVED
 0x0001

	)

1050 
	#FAPI_REPORTMODE_END_OF_SCAN_CYCLE
 0x0002

	)

1051 
	#FAPI_REPORTMODE_REAL_TIME
 0x0004

	)

1052 
	#FAPI_REPORTMODE_NO_BATCH
 0x0008

	)

1054 
	#FAPI_RESULTCODE_SUCCESS
 0x0000

	)

1055 
	#FAPI_RESULTCODE_UNSPECIFIED_FAILURE
 0x0001

	)

1056 
	#FAPI_RESULTCODE_INVALID_PARAMETERS
 0x0026

	)

1057 
	#FAPI_RESULTCODE_REJECTED_INVALID_IE
 0x0028

	)

1058 
	#FAPI_RESULTCODE_NOT_ALLOWED
 0x0030

	)

1059 
	#FAPI_RESULTCODE_NOT_PRESENT
 0x0031

	)

1060 
	#FAPI_RESULTCODE_TRANSMISSION_FAILURE
 0x004f

	)

1061 
	#FAPI_RESULTCODE_TOO_MANY_SIMULTANEOUS_REQUESTS
 0x8001

	)

1062 
	#FAPI_RESULTCODE_BSS_ALREADY_STARTED_OR_JOINED
 0x8002

	)

1063 
	#FAPI_RESULTCODE_NOT_SUPPORTED
 0x8003

	)

1064 
	#FAPI_RESULTCODE_INVALID_STATE
 0x8004

	)

1065 
	#FAPI_RESULTCODE_INSUFFICIENT_RESOURCE
 0x8006

	)

1066 
	#FAPI_RESULTCODE_INVALID_VIRTUAL_INTERFACE_INDEX
 0x800a

	)

1067 
	#FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
 0x800b

	)

1068 
	#FAPI_RESULTCODE_HOST_REQUEST_FAILED
 0x800c

	)

1069 
	#FAPI_RESULTCODE_INVALID_FREQUENCY
 0x800e

	)

1070 
	#FAPI_RESULTCODE_PROBE_TIMEOUT
 0x800f

	)

1071 
	#FAPI_RESULTCODE_AUTH_TIMEOUT
 0x8010

	)

1072 
	#FAPI_RESULTCODE_ASSOC_TIMEOUT
 0x8011

	)

1073 
	#FAPI_RESULTCODE_ASSOC_ABORT
 0x8012

	)

1074 
	#FAPI_RESULTCODE_AUTH_NO_ACK
 0x8013

	)

1075 
	#FAPI_RESULTCODE_ASSOC_NO_ACK
 0x8014

	)

1076 
	#FAPI_RESULTCODE_AUTH_TX_FAIL
 0x8015

	)

1077 
	#FAPI_RESULTCODE_ASSOC_TX_FAIL
 0x8016

	)

1078 
	#FAPI_RESULTCODE_AUTH_FAILED_CODE
 0x8100

	)

1079 
	#FAPI_RESULTCODE_ASSOC_FAILED_CODE
 0x8200

	)

1080 
	#FAPI_RESULTCODE_INVALID_TLV_VALUE
 0x9000

	)

1081 
	#FAPI_RESULTCODE_NAN_PROTOCOL_FAILURE
 0x9001

	)

1082 
	#FAPI_RESULTCODE_NAN_INVALID_SESSION_ID
 0x9002

	)

1083 
	#FAPI_RESULTCODE_NAN_INVALID_REQUESTOR_INSTANCE_ID
 0x9003

	)

1084 
	#FAPI_RESULTCODE_UNSUPPORTED_CONCURRENCY
 0x9004

	)

1085 
	#FAPI_RESULTCODE_NAN_INVALID_NDP_ID
 0x9005

	)

1086 
	#FAPI_RESULTCODE_NAN_INVALID_MATCH_ID
 0x9006

	)

1087 
	#FAPI_RESULTCODE_NAN_NO_OTA_ACK
 0x9007

	)

1088 
	#FAPI_RESULTCODE_NAN_INVALID_AVAILABILITY
 0x9008

	)

1089 
	#FAPI_RESULTCODE_NAN_IMMUTABLE_UNACCEPTABLE
 0x9009

	)

1090 
	#FAPI_RESULTCODE_NAN_REJECTED_SECURITY_POLICY
 0x900a

	)

1091 
	#FAPI_RESULTCODE_NDP_REJECTED
 0x900b

	)

1092 
	#FAPI_RESULTCODE_NDL_UNACCEPTABLE
 0x900c

	)

1093 
	#FAPI_RESULTCODE_NDL_FAILED_SCHEDULE
 0x900d

	)

1094 
	#FAPI_RESULTCODE_TWT_SETUP_REJECTED
 0xa001

	)

1095 
	#FAPI_RESULTCODE_TWT_SETUP_TIMEOUT
 0xa002

	)

1096 
	#FAPI_RESULTCODE_TWT_SETUP_INVALID_IE
 0xa003

	)

1097 
	#FAPI_RESULTCODE_TWT_SETUP_PARAMS_VALUE_REJECTED
 0xa004

	)

1099 
	#FAPI_ROAMINGSCAN_NONE
 0x0000

	)

1100 
	#FAPI_ROAMINGSCAN_PARTIAL
 0x0001

	)

1101 
	#FAPI_ROAMINGSCAN_FULL
 0x0002

	)

1103 
	#FAPI_ROAMINGTYPE_LEGACY
 0x0000

	)

1104 
	#FAPI_ROAMINGTYPE_NCHO
 0x0001

	)

1106 
	#FAPI_RTTBANDWIDTH_20MHZ
 0x0004

	)

1107 
	#FAPI_RTTBANDWIDTH_40MHZ
 0x0008

	)

1108 
	#FAPI_RTTBANDWIDTH_80MHZ
 0x0010

	)

1109 
	#FAPI_RTTBANDWIDTH_160MHZ
 0x0020

	)

1111 
	#FAPI_RTTPEERTYPE_NOT_SPECIFIED
 0x00

	)

1112 
	#FAPI_RTTPEERTYPE_AP
 0x01

	)

1113 
	#FAPI_RTTPEERTYPE_STA
 0x02

	)

1114 
	#FAPI_RTTPEERTYPE_P2P_GO
 0x03

	)

1115 
	#FAPI_RTTPEERTYPE_P2P_CLIENT
 0x04

	)

1116 
	#FAPI_RTTPEERTYPE_NAN
 0x05

	)

1118 
	#FAPI_RTTPREAMBLE_LEGACY
 0x0001

	)

1119 
	#FAPI_RTTPREAMBLE_HT
 0x0002

	)

1120 
	#FAPI_RTTPREAMBLE_VHT
 0x0004

	)

1121 
	#FAPI_RTTPREAMBLE_HE
 0x0006

	)

1123 
	#FAPI_RTTSTATUS_SUCCESS
 0x0000

	)

1124 
	#FAPI_RTTSTATUS_UNSPECIFIED_FAILURE
 0x0001

	)

1125 
	#FAPI_RTTSTATUS_FAIL_NO_RESPONSE
 0x0002

	)

1126 
	#FAPI_RTTSTATUS_FAIL_REJECTED
 0x0003

	)

1127 
	#FAPI_RTTSTATUS_FAIL_NOT_SCHEDULED
 0x0004

	)

1128 
	#FAPI_RTTSTATUS_FAIL_TIMEOUT
 0x0005

	)

1129 
	#FAPI_RTTSTATUS_FAIL_INCORRECT_CHANNEL
 0x0006

	)

1130 
	#FAPI_RTTSTATUS_FAIL_FTM_NOT_SUPPORTED
 0x0007

	)

1131 
	#FAPI_RTTSTATUS_FAIL_MEASUREMENT_ABORTED
 0x0008

	)

1132 
	#FAPI_RTTSTATUS_FAIL_INVALID_TIME_STAMP
 0x0009

	)

1133 
	#FAPI_RTTSTATUS_FAIL_NO_FTM_RECEIVED
 0x000a

	)

1134 
	#FAPI_RTTSTATUS_FAIL_BURST_NOT_SCHEDULED
 0x000b

	)

1135 
	#FAPI_RTTSTATUS_FAIL_BUSY_TRY_LATER
 0x000c

	)

1136 
	#FAPI_RTTSTATUS_FAIL_INVALID_REQUEST
 0x000d

	)

1137 
	#FAPI_RTTSTATUS_FAIL_FTM_PARAMETER_OVERRIDE
 0x000f

	)

1139 
	#FAPI_RTTTYPE_ONE_SIDED
 0x01

	)

1140 
	#FAPI_RTTTYPE_TWO_SIDED
 0x02

	)

1142 
	#FAPI_RULEFLAG_NO_IR
 0x01

	)

1143 
	#FAPI_RULEFLAG_DFS
 0x02

	)

1144 
	#FAPI_RULEFLAG_NO_OFDM
 0x04

	)

1145 
	#FAPI_RULEFLAG_NO_OUTDOOR
 0x10

	)

1146 
	#FAPI_RULEFLAG_AUTO_BW
 0x20

	)

1148 
	#FAPI_RXSTARTFLAGS_NONE
 0x0000

	)

1149 
	#FAPI_RXSTARTFLAGS_SCAN_CHANNEL
 0x0001

	)

1150 
	#FAPI_RXSTARTFLAGS_FILTERING
 0x0002

	)

1151 
	#FAPI_RXSTARTFLAGS_BEAMFORMING
 0x0004

	)

1152 
	#FAPI_RXSTARTFLAGS_ACK
 0x0008

	)

1153 
	#FAPI_RXSTARTFLAGS_LP_MODE
 0x0010

	)

1154 
	#FAPI_RXSTARTFLAGS_CHAN_RSSI
 0x0020

	)

1155 
	#FAPI_RXSTARTFLAGS_DISABLE_EXTERNAL_LNA
 0x0040

	)

1156 
	#FAPI_RXSTARTFLAGS_VALIDATE
 0x0080

	)

1157 
	#FAPI_RXSTARTFLAGS_HIGH_POWER_DETECT
 0x0100

	)

1158 
	#FAPI_RXSTARTFLAGS_MEDIUM_POWER
 0x0200

	)

1160 
	#FAPI_SCANMODE_LEGACY
 0x0000

	)

1161 
	#FAPI_SCANMODE_LOW_LATENCY
 0x0001

	)

1162 
	#FAPI_SCANMODE_LOW_LATENCY_2
 0x0002

	)

1163 
	#FAPI_SCANMODE_LOW_LATENCY_3
 0x0003

	)

1165 
	#FAPI_SCANPOLICY_PASSIVE
 0x0001

	)

1166 
	#FAPI_SCANPOLICY_TEST_MODE
 0x0002

	)

1167 
	#FAPI_SCANPOLICY_ANY_RA
 0x0004

	)

1168 
	#FAPI_SCANPOLICY_2_4GHZ
 0x0008

	)

1169 
	#FAPI_SCANPOLICY_5GHZ
 0x0010

	)

1170 
	#FAPI_SCANPOLICY_NON_DFS
 0x0020

	)

1171 
	#FAPI_SCANPOLICY_DFS
 0x0040

	)

1172 
	#FAPI_SCANPOLICY_ON_CHANNEL
 0x0080

	)

1173 
	#FAPI_SCANPOLICY_6GHZ
 0x0100

	)

1174 
	#FAPI_SCANPOLICY_6GHZ_PSC
 0x0200

	)

1175 
	#FAPI_SCANPOLICY_6GHZ_CO_LOCATED
 0x0400

	)

1177 
	#FAPI_SCANTYPE_INITIAL_SCAN
 0x0001

	)

1178 
	#FAPI_SCANTYPE_FULL_SCAN
 0x0002

	)

1179 
	#FAPI_SCANTYPE_SCHEDULED_SCAN
 0x0003

	)

1180 
	#FAPI_SCANTYPE_P2P_SCAN_FULL
 0x0004

	)

1181 
	#FAPI_SCANTYPE_P2P_SCAN_SOCIAL
 0x0005

	)

1182 
	#FAPI_SCANTYPE_OBSS_SCAN
 0x0006

	)

1183 
	#FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
 0x0007

	)

1184 
	#FAPI_SCANTYPE_GSCAN
 0x0009

	)

1185 
	#FAPI_SCANTYPE_SINGLE_CHANNEL_SCAN
 0x000a

	)

1186 
	#FAPI_SCANTYPE_MEASUREMENT_SCAN
 0x0010

	)

1187 
	#FAPI_SCANTYPE_SOFT_CACHED_ROAMING_SCAN
 0x0011

	)

1188 
	#FAPI_SCANTYPE_SOFT_FULL_ROAMING_SCAN
 0x0012

	)

1189 
	#FAPI_SCANTYPE_HARD_CACHED_ROAMING_SCAN
 0x0013

	)

1190 
	#FAPI_SCANTYPE_HARD_FULL_ROAMING_SCAN
 0x0014

	)

1191 
	#FAPI_SCANTYPE_OBSS_SCAN_INTERNAL
 0x0015

	)

1192 
	#FAPI_SCANTYPE_NAN_SCAN
 0x0016

	)

1193 
	#FAPI_SCANTYPE_FTM_NEIGHBOUR_SCAN
 0x0017

	)

1194 
	#FAPI_SCANTYPE_OBSS_NARROW_BW_SCAN
 0x0018

	)

1195 
	#FAPI_SCANTYPE_FIRST_ILLEGAL
 0x0019

	)

1197 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO
 0x0001

	)

1198 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO_CCA
 0x0002

	)

1199 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO_CHANNELS
 0x0004

	)

1200 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO_SCAN
 0x0008

	)

1201 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE
 0x0010

	)

1202 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE_TXRATE
 0x0020

	)

1203 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE_AC
 0x0040

	)

1204 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE_CONTENSION
 0x0080

	)

1206 
	#FAPI_TDLSACTION_DISCOVERY
 0x0000

	)

1207 
	#FAPI_TDLSACTION_FORCED_SETUP
 0x0001

	)

1208 
	#FAPI_TDLSACTION_TEARDOWN
 0x0002

	)

1209 
	#FAPI_TDLSACTION_CANDIDATE_SETUP
 0x0003

	)

1211 
	#FAPI_TDLSEVENT_CONNECTED
 0x0001

	)

1212 
	#FAPI_TDLSEVENT_DISCONNECTED
 0x0002

	)

1213 
	#FAPI_TDLSEVENT_DISCOVERED
 0x0003

	)

1215 
	#FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
 0x0000

	)

1216 
	#FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
 0x0001

	)

1217 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE1
 0x00010

	)

1218 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE2
 0x00011

	)

1219 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE3
 0x00012

	)

1220 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE4
 0x00013

	)

1221 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE5
 0x00014

	)

1222 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE6
 0x00015

	)

1223 
	#FAPI_TRANSMISSIONSTATUS_TX_LIFETIME
 0x0002

	)

1224 
	#FAPI_TRANSMISSIONSTATUS_NO_BSS
 0x0003

	)

1225 
	#FAPI_TRANSMISSIONSTATUS_EXCESSIVE_DATA_LENGTH
 0x0004

	)

1226 
	#FAPI_TRANSMISSIONSTATUS_UNAVAILABLE_KEY_MAPPING
 0x0005

	)

1227 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE
 0x0006

	)

1228 
	#FAPI_TRANSMISSIONSTATUS_DATA_RETRY_LIMIT
 0x0007

	)

1229 
	#FAPI_TRANSMISSIONSTATUS_NON_DATA_RETRY_LIMIT
 0x0008

	)

1230 
	#FAPI_TRANSMISSIONSTATUS_DATA_TX_LIFETIME
 0x0009

	)

1231 
	#FAPI_TRANSMISSIONSTATUS_NON_DATA_TX_LIFETIME
 0x000a

	)

1232 
	#FAPI_TRANSMISSIONSTATUS_DATA_CANCELLED
 0x000b

	)

1233 
	#FAPI_TRANSMISSIONSTATUS_NON_DATA_CANCELLED
 0x000c

	)

1235 
	#FAPI_TXDATATYPE_DATA_WORD
 0x0000

	)

1236 
	#FAPI_TXDATATYPE_DATA_RANDOM
 0x0001

	)

1237 
	#FAPI_TXDATATYPE_DATA_CUSTOM
 0x0002

	)

1239 
	#FAPI_TXHEMODE_HE_SU
 0x0000

	)

1240 
	#FAPI_TXHEMODE_HE_ER_SU
 0x0001

	)

1241 
	#FAPI_TXHEMODE_HE_ER_SU_10MHZ
 0x0002

	)

1242 
	#FAPI_TXHEMODE_HE_MU_TB_STANDALONE
 0x0003

	)

1243 
	#FAPI_TXHEMODE_HE_MU_TB
 0x0004

	)

1245 
	#FAPI_TXREADFLAGS_NONE
 0x0000

	)

1246 
	#FAPI_TXREADFLAGS_FRAME_COUNTING
 0x0001

	)

1247 
	#FAPI_TXREADFLAGS_THERMAL_CUTOUT
 0x0002

	)

1249 
	#FAPI_TXSETPARAMSFLAGS_NONE
 0x0000

	)

1250 
	#FAPI_TXSETPARAMSFLAGS_ACK
 0x0001

	)

1251 
	#FAPI_TXSETPARAMSFLAGS_DUPLICATE_80
 0x0002

	)

1252 
	#FAPI_TXSETPARAMSFLAGS_DUPLICATE_40
 0x0004

	)

1253 
	#FAPI_TXSETPARAMSFLAGS_DEAFEN_RX
 0x0008

	)

1254 
	#FAPI_TXSETPARAMSFLAGS_CS
 0x0010

	)

1255 
	#FAPI_TXSETPARAMSFLAGS_SCAN_CHANNEL
 0x0020

	)

1256 
	#FAPI_TXSETPARAMSFLAGS_SHORT_PREAMBLE
 0x0040

	)

1257 
	#FAPI_TXSETPARAMSFLAGS_DISABLE_SCRAMBLER
 0x0080

	)

1258 
	#FAPI_TXSETPARAMSFLAGS_LDPC
 0x0100

	)

1259 
	#FAPI_TXSETPARAMSFLAGS_STBC
 0x0200

	)

1260 
	#FAPI_TXSETPARAMSFLAGS_DISABLE_SPREADER
 0x0400

	)

1261 
	#FAPI_TXSETPARAMSFLAGS_GREENFIELD_PREAMBLE
 0x0800

	)

1262 
	#FAPI_TXSETPARAMSFLAGS_RX_LOW_POWER
 0x1000

	)

1263 
	#FAPI_TXSETPARAMSFLAGS_IBSS_FRAMES
 0x2000

	)

1264 
	#FAPI_TXSETPARAMSFLAGS_BEAMFORMING
 0x4000

	)

1265 
	#FAPI_TXSETPARAMSFLAGS_DISABLE_EXTERNAL_LNA
 0x8000

	)

1267 
	#FAPI_TXSETPARAMSFLAGS2_NONE
 0x0000

	)

1268 
	#FAPI_TXSETPARAMSFLAGS2_IFS
 0x0001

	)

1269 
	#FAPI_TXSETPARAMSFLAGS2_VALIDATE
 0x0002

	)

1270 
	#FAPI_TXSETPARAMSFLAGS2_FILTERING
 0x0004

	)

1271 
	#FAPI_TXSETPARAMSFLAGS2_MEDIUM_POWER
 0x0008

	)

1272 
	#FAPI_TXSETPARAMSFLAGS2_DYNAMIC_BANDWIDTH
 0x0010

	)

1274 
	#FAPI_TYPEOFAIRPOWER_EIRP
 0x00

	)

1275 
	#FAPI_TYPEOFAIRPOWER_TPO
 0x01

	)

1276 
	#FAPI_TYPEOFAIRPOWER_RAW
 0x02

	)

1278 
	#FAPI_USAGE_NO_USE
 0x0

	)

1279 
	#FAPI_USAGE_USE
 0x1

	)

1281 
	#FAPI_VIFRANGE_VIF_INDEX_MIN
 0x0001

	)

1282 
	#FAPI_VIFRANGE_VIF_INDEX_MAX
 0x000f

	)

1284 
	#FAPI_VIFTYPE_STATION
 0x0002

	)

1285 
	#FAPI_VIFTYPE_AP
 0x0003

	)

1286 
	#FAPI_VIFTYPE_WLANLITE
 0x0004

	)

1287 
	#FAPI_VIFTYPE_NAN
 0x0005

	)

1288 
	#FAPI_VIFTYPE_DISCOVERY
 0x0006

	)

1289 
	#FAPI_VIFTYPE_PRECONNECT
 0x0007

	)

1290 
	#FAPI_VIFTYPE_DETECT
 0x0008

	)

1291 
	#FAPI_VIFTYPE_MONITOR
 0x0010

	)

1292 
	#FAPI_VIFTYPE_SCAN
 0x0020

	)

1293 
	#FAPI_VIFTYPE_OFFCHANNEL
 0x0021

	)

1294 
	#FAPI_VIFTYPE_RANGE
 0x0022

	)

1296 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P0
 0x0000

	)

1297 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P1
 0x0001

	)

1298 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P2
 0x0002

	)

1299 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P3
 0x0003

	)

1300 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P4
 0x0004

	)

1301 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P5
 0x0005

	)

1302 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P6
 0x0006

	)

1303 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P7
 0x0007

	)

1304 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0008

	)

1305 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P0
 0x0100

	)

1306 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P1
 0x0101

	)

1307 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P2
 0x0102

	)

1308 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P3
 0x0103

	)

1309 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P4
 0x0104

	)

1310 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P5
 0x0105

	)

1311 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P6
 0x0106

	)

1312 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P7
 0x0107

	)

1313 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0108

	)

1314 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P0
 0x0200

	)

1315 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P1
 0x0201

	)

1316 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P2
 0x0202

	)

1317 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P3
 0x0203

	)

1318 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P4
 0x0204

	)

1319 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P5
 0x0205

	)

1320 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P6
 0x0206

	)

1321 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P7
 0x0207

	)

1322 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0208

	)

1323 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P0
 0x0300

	)

1324 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P1
 0x0301

	)

1325 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P2
 0x0302

	)

1326 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P3
 0x0303

	)

1327 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P4
 0x0304

	)

1328 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P5
 0x0305

	)

1329 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P6
 0x0306

	)

1330 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P7
 0x0307

	)

1331 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0308

	)

1333 
	#MA_UNITDATA_REQ
 0x1000

	)

1334 
	#MA_SPARE_1_REQ
 0x1002

	)

1335 
	#MA_SPARE_2_REQ
 0x1003

	)

1336 
	#MA_SPARE_3_REQ
 0x1004

	)

1337 
	#MA_SPARE_SIGNAL_1_REQ
 0x1005

	)

1338 
	#MA_SPARE_SIGNAL_2_REQ
 0x1006

	)

1339 
	#MA_SPARE_SIGNAL_3_REQ
 0x1007

	)

1340 
	#MA_SPARE_1_CFM
 0x1102

	)

1341 
	#MA_SPARE_2_CFM
 0x1103

	)

1342 
	#MA_SPARE_3_CFM
 0x1104

	)

1343 
	#MA_SPARE_SIGNAL_1_CFM
 0x1105

	)

1344 
	#MA_SPARE_SIGNAL_2_CFM
 0x1106

	)

1345 
	#MA_SPARE_SIGNAL_3_CFM
 0x1107

	)

1346 
	#MA_SPARE_1_RES
 0x1200

	)

1347 
	#MA_SPARE_2_RES
 0x1201

	)

1348 
	#MA_SPARE_3_RES
 0x1202

	)

1349 
	#MA_SPARE_SIGNAL_1_RES
 0x1203

	)

1350 
	#MA_SPARE_SIGNAL_2_RES
 0x1204

	)

1351 
	#MA_SPARE_SIGNAL_3_RES
 0x1205

	)

1352 
	#MA_UNITDATA_IND
 0x1300

	)

1353 
	#MA_BLOCKACKREQ_IND
 0x1301

	)

1354 
	#MA_SPARE_1_IND
 0x1302

	)

1355 
	#MA_SPARE_2_IND
 0x1303

	)

1356 
	#MA_SPARE_3_IND
 0x1304

	)

1357 
	#MA_SPARE_SIGNAL_1_IND
 0x1305

	)

1358 
	#MA_SPARE_SIGNAL_2_IND
 0x1306

	)

1359 
	#MA_SPARE_SIGNAL_3_IND
 0x1307

	)

1360 
	#MLME_GET_REQ
 0x2001

	)

1361 
	#MLME_SET_REQ
 0x2002

	)

1362 
	#MLME_POWERMGT_REQ
 0x2003

	)

1363 
	#MLME_ADD_INFO_ELEMENTS_REQ
 0x2004

	)

1364 
	#MLME_ADD_SCAN_REQ
 0x2005

	)

1365 
	#MLME_DEL_SCAN_REQ
 0x2006

	)

1366 
	#MLME_ADD_VIF_REQ
 0x2007

	)

1367 
	#MLME_DEL_VIF_REQ
 0x2008

	)

1368 
	#MLME_START_REQ
 0x2009

	)

1369 
	#MLME_SET_CHANNEL_REQ
 0x200a

	)

1370 
	#MLME_CONNECT_REQ
 0x200b

	)

1371 
	#MLME_REASSOCIATE_REQ
 0x200c

	)

1372 
	#MLME_ROAM_REQ
 0x200d

	)

1373 
	#MLME_DISCONNECT_REQ
 0x200e

	)

1374 
	#MLME_REGISTER_ACTION_FRAME_REQ
 0x200f

	)

1375 
	#MLME_SEND_FRAME_REQ
 0x2010

	)

1376 
	#MLME_RESET_DWELL_TIME_REQ
 0x2011

	)

1377 
	#MLME_SET_TRAFFIC_PARAMETERS_REQ
 0x2012

	)

1378 
	#MLME_DEL_TRAFFIC_PARAMETERS_REQ
 0x2013

	)

1379 
	#MLME_SET_PACKET_FILTER_REQ
 0x2014

	)

1380 
	#MLME_SET_IP_ADDRESS_REQ
 0x2015

	)

1381 
	#MLME_SET_ACL_REQ
 0x2016

	)

1382 
	#MLME_SETKEYS_REQ
 0x2018

	)

1383 
	#MLME_GET_KEY_SEQUENCE_REQ
 0x201a

	)

1384 
	#MLME_SET_CACHED_CHANNELS_REQ
 0x201f

	)

1385 
	#MLME_SET_WHITELIST_SSID_REQ
 0x2020

	)

1386 
	#MLME_TDLS_ACTION_REQ
 0x2021

	)

1387 
	#MLME_CHANNEL_SWITCH_REQ
 0x2022

	)

1388 
	#MLME_MONITOR_RSSI_REQ
 0x2023

	)

1389 
	#MLME_START_LINK_STATISTICS_REQ
 0x2024

	)

1390 
	#MLME_STOP_LINK_STATISTICS_REQ
 0x2025

	)

1391 
	#MLME_HOST_STATE_REQ
 0x2028

	)

1392 
	#MLME_ADD_RANGE_REQ
 0x2029

	)

1393 
	#MLME_DEL_RANGE_REQ
 0x202a

	)

1394 
	#MLME_SET_NOA_REQ
 0x202b

	)

1395 
	#MLME_SET_CTWINDOW_REQ
 0x202c

	)

1396 
	#MLME_NAN_START_REQ
 0x202d

	)

1397 
	#MLME_NAN_CONFIG_REQ
 0x202e

	)

1398 
	#MLME_NAN_PUBLISH_REQ
 0x202f

	)

1399 
	#MLME_NAN_SUBSCRIBE_REQ
 0x2030

	)

1400 
	#MLME_NAN_FOLLOWUP_REQ
 0x2031

	)

1401 
	#MLME_UNSET_CHANNEL_REQ
 0x2032

	)

1402 
	#MLME_SET_COUNTRY_REQ
 0x2033

	)

1403 
	#MLME_FORWARD_BEACON_REQ
 0x2034

	)

1404 
	#MLME_NDP_REQUEST_REQ
 0x2035

	)

1405 
	#MLME_NDP_RESPONSE_REQ
 0x2036

	)

1406 
	#MLME_NDP_TERMINATE_REQ
 0x2037

	)

1407 
	#MLME_ROAMING_CHANNEL_LIST_REQ
 0x203a

	)

1408 
	#MLME_SET_BSS_MAX_CHANNEL_WIDTH_REQ
 0x203b

	)

1409 
	#MLME_SET_SCAN_MODE_REQ
 0x203c

	)

1410 
	#MLME_INSTALL_APF_REQ
 0x203d

	)

1411 
	#MLME_READ_APF_REQ
 0x203e

	)

1412 
	#MLME_SET_NUM_ANTENNAS_REQ
 0x203f

	)

1413 
	#MLME_ARP_DETECT_REQ
 0x2040

	)

1414 
	#MLME_SET_ROAMING_TYPE_REQ
 0x2041

	)

1415 
	#MLME_SET_BAND_REQ
 0x2042

	)

1416 
	#MLME_SET_ROAMING_PARAMETERS_REQ
 0x2043

	)

1417 
	#MLME_WIFISHARING_PERMITTED_CHANNELS_REQ
 0x2044

	)

1418 
	#MLME_ROAMING_STATE_REQ
 0x2045

	)

1419 
	#MLME_SPARE_8_REQ
 0x2046

	)

1420 
	#MLME_CONFIGURE_MONITOR_MODE_REQ
 0x2047

	)

1421 
	#MLME_SPARE_9_REQ
 0x2048

	)

1422 
	#MLME_SPARE_10_REQ
 0x2049

	)

1423 
	#MLME_SPARE_11_REQ
 0x204a

	)

1424 
	#MLME_NAN_RANGE_REQ
 0x204b

	)

1425 
	#MLME_NAN_RANGE_CANCEL_REQ
 0x204c

	)

1426 
	#MLME_DELBA_REQ
 0x204d

	)

1427 
	#MLME_GET_NUM_ANTENNAS_REQ
 0x204e

	)

1428 
	#MLME_START_DETECT_REQ
 0x204f

	)

1429 
	#MLME_SPARE_12_REQ
 0x2050

	)

1430 
	#MLME_SPARE_13_REQ
 0x2051

	)

1431 
	#MLME_SET_WTC_MODE_REQ
 0x2052

	)

1432 
	#MLME_TWT_SETUP_REQ
 0x2053

	)

1433 
	#MLME_TWT_TEARDOWN_REQ
 0x2054

	)

1434 
	#MLME_TWT_SUSPEND_REQ
 0x2055

	)

1435 
	#MLME_TWT_STATUS_QUERY_REQ
 0x2056

	)

1436 
	#MLME_AP_RPS_PARAMS_REQ
 0x2057

	)

1437 
	#MLME_AP_RPS_REQ
 0x2058

	)

1438 
	#MLME_SET_AP_TX_POWER_REQ
 0x2059

	)

1439 
	#MLME_GET_AP_TX_POWER_REQ
 0x205a

	)

1440 
	#MLME_SPARE_SIGNAL_1_REQ
 0x205b

	)

1441 
	#MLME_SPARE_SIGNAL_2_REQ
 0x205c

	)

1442 
	#MLME_SPARE_SIGNAL_3_REQ
 0x205d

	)

1443 
	#MLME_GET_CFM
 0x2101

	)

1444 
	#MLME_SET_CFM
 0x2102

	)

1445 
	#MLME_POWERMGT_CFM
 0x2103

	)

1446 
	#MLME_ADD_INFO_ELEMENTS_CFM
 0x2104

	)

1447 
	#MLME_ADD_SCAN_CFM
 0x2105

	)

1448 
	#MLME_DEL_SCAN_CFM
 0x2106

	)

1449 
	#MLME_ADD_VIF_CFM
 0x2107

	)

1450 
	#MLME_DEL_VIF_CFM
 0x2108

	)

1451 
	#MLME_START_CFM
 0x2109

	)

1452 
	#MLME_SET_CHANNEL_CFM
 0x210a

	)

1453 
	#MLME_CONNECT_CFM
 0x210b

	)

1454 
	#MLME_REASSOCIATE_CFM
 0x210c

	)

1455 
	#MLME_ROAM_CFM
 0x210d

	)

1456 
	#MLME_DISCONNECT_CFM
 0x210e

	)

1457 
	#MLME_REGISTER_ACTION_FRAME_CFM
 0x210f

	)

1458 
	#MLME_SEND_FRAME_CFM
 0x2110

	)

1459 
	#MLME_RESET_DWELL_TIME_CFM
 0x2111

	)

1460 
	#MLME_SET_TRAFFIC_PARAMETERS_CFM
 0x2112

	)

1461 
	#MLME_DEL_TRAFFIC_PARAMETERS_CFM
 0x2113

	)

1462 
	#MLME_SET_PACKET_FILTER_CFM
 0x2114

	)

1463 
	#MLME_SET_IP_ADDRESS_CFM
 0x2115

	)

1464 
	#MLME_SET_ACL_CFM
 0x2116

	)

1465 
	#MLME_SETKEYS_CFM
 0x2118

	)

1466 
	#MLME_GET_KEY_SEQUENCE_CFM
 0x211a

	)

1467 
	#MLME_SET_CACHED_CHANNELS_CFM
 0x211f

	)

1468 
	#MLME_SET_WHITELIST_SSID_CFM
 0x2120

	)

1469 
	#MLME_TDLS_ACTION_CFM
 0x2121

	)

1470 
	#MLME_CHANNEL_SWITCH_CFM
 0x2122

	)

1471 
	#MLME_MONITOR_RSSI_CFM
 0x2123

	)

1472 
	#MLME_START_LINK_STATISTICS_CFM
 0x2124

	)

1473 
	#MLME_STOP_LINK_STATISTICS_CFM
 0x2125

	)

1474 
	#MLME_HOST_STATE_CFM
 0x2128

	)

1475 
	#MLME_ADD_RANGE_CFM
 0x2129

	)

1476 
	#MLME_DEL_RANGE_CFM
 0x212a

	)

1477 
	#MLME_SET_NOA_CFM
 0x212b

	)

1478 
	#MLME_SET_CTWINDOW_CFM
 0x212c

	)

1479 
	#MLME_NAN_START_CFM
 0x212d

	)

1480 
	#MLME_NAN_CONFIG_CFM
 0x212e

	)

1481 
	#MLME_NAN_PUBLISH_CFM
 0x212f

	)

1482 
	#MLME_NAN_SUBSCRIBE_CFM
 0x2130

	)

1483 
	#MLME_NAN_FOLLOWUP_CFM
 0x2131

	)

1484 
	#MLME_UNSET_CHANNEL_CFM
 0x2132

	)

1485 
	#MLME_SET_COUNTRY_CFM
 0x2133

	)

1486 
	#MLME_FORWARD_BEACON_CFM
 0x2134

	)

1487 
	#MLME_NDP_REQUEST_CFM
 0x2135

	)

1488 
	#MLME_NDP_RESPONSE_CFM
 0x2136

	)

1489 
	#MLME_NDP_TERMINATE_CFM
 0x2137

	)

1490 
	#MLME_ROAMING_CHANNEL_LIST_CFM
 0x213a

	)

1491 
	#MLME_SET_BSS_MAX_CHANNEL_WIDTH_CFM
 0x213b

	)

1492 
	#MLME_SET_SCAN_MODE_CFM
 0x213c

	)

1493 
	#MLME_INSTALL_APF_CFM
 0x213d

	)

1494 
	#MLME_READ_APF_CFM
 0x213e

	)

1495 
	#MLME_SET_NUM_ANTENNAS_CFM
 0x213f

	)

1496 
	#MLME_ARP_DETECT_CFM
 0x2140

	)

1497 
	#MLME_SET_ROAMING_TYPE_CFM
 0x2141

	)

1498 
	#MLME_SET_BAND_CFM
 0x2142

	)

1499 
	#MLME_SET_ROAMING_PARAMETERS_CFM
 0x2143

	)

1500 
	#MLME_WIFISHARING_PERMITTED_CHANNELS_CFM
 0x2144

	)

1501 
	#MLME_ROAMING_STATE_CFM
 0x2145

	)

1502 
	#MLME_SPARE_8_CFM
 0x2146

	)

1503 
	#MLME_CONFIGURE_MONITOR_MODE_CFM
 0x2147

	)

1504 
	#MLME_SPARE_9_CFM
 0x2148

	)

1505 
	#MLME_SPARE_10_CFM
 0x2149

	)

1506 
	#MLME_SPARE_11_CFM
 0x214a

	)

1507 
	#MLME_NAN_RANGE_CFM
 0x214b

	)

1508 
	#MLME_NAN_RANGE_CANCEL_CFM
 0x214c

	)

1509 
	#MLME_DELBA_CFM
 0x214d

	)

1510 
	#MLME_GET_NUM_ANTENNAS_CFM
 0x214e

	)

1511 
	#MLME_START_DETECT_CFM
 0x214f

	)

1512 
	#MLME_SPARE_12_CFM
 0x2150

	)

1513 
	#MLME_SPARE_13_CFM
 0x2151

	)

1514 
	#MLME_SET_WTC_MODE_CFM
 0x2152

	)

1515 
	#MLME_TWT_SETUP_CFM
 0x2153

	)

1516 
	#MLME_TWT_TEARDOWN_CFM
 0x2154

	)

1517 
	#MLME_TWT_SUSPEND_CFM
 0x2155

	)

1518 
	#MLME_TWT_STATUS_QUERY_CFM
 0x2156

	)

1519 
	#MLME_AP_RPS_PARAMS_CFM
 0x2157

	)

1520 
	#MLME_AP_RPS_CFM
 0x2158

	)

1521 
	#MLME_SET_AP_TX_POWER_CFM
 0x2159

	)

1522 
	#MLME_GET_AP_TX_POWER_CFM
 0x215a

	)

1523 
	#MLME_SPARE_SIGNAL_1_CFM
 0x215b

	)

1524 
	#MLME_SPARE_SIGNAL_2_CFM
 0x215c

	)

1525 
	#MLME_SPARE_SIGNAL_3_CFM
 0x215d

	)

1526 
	#MLME_CONNECT_RES
 0x2200

	)

1527 
	#MLME_CONNECTED_RES
 0x2201

	)

1528 
	#MLME_REASSOCIATE_RES
 0x2202

	)

1529 
	#MLME_ROAMED_RES
 0x2203

	)

1530 
	#MLME_SYNCHRONISED_RES
 0x2205

	)

1531 
	#MLME_SPARE_2_RES
 0x2206

	)

1532 
	#MLME_SPARE_3_RES
 0x2207

	)

1533 
	#MLME_SPARE_4_RES
 0x2208

	)

1534 
	#MLME_SPARE_5_RES
 0x2209

	)

1535 
	#MLME_SPARE_SIGNAL_1_RES
 0x220a

	)

1536 
	#MLME_SPARE_SIGNAL_2_RES
 0x220b

	)

1537 
	#MLME_SPARE_SIGNAL_3_RES
 0x220c

	)

1538 
	#MLME_SCAN_IND
 0x2300

	)

1539 
	#MLME_SCAN_DONE_IND
 0x2301

	)

1540 
	#MLME_LISTEN_END_IND
 0x2302

	)

1541 
	#MLME_CONNECT_IND
 0x2303

	)

1542 
	#MLME_CONNECTED_IND
 0x2304

	)

1543 
	#MLME_REASSOCIATE_IND
 0x2305

	)

1544 
	#MLME_ROAM_IND
 0x2306

	)

1545 
	#MLME_ROAMED_IND
 0x2307

	)

1546 
	#MLME_DISCONNECTED_IND
 0x2309

	)

1547 
	#MLME_PROCEDURE_STARTED_IND
 0x230a

	)

1548 
	#MLME_MIC_FAILURE_IND
 0x230b

	)

1549 
	#MLME_FRAME_TRANSMISSION_IND
 0x230c

	)

1550 
	#MLME_RECEIVED_FRAME_IND
 0x230d

	)

1551 
	#MLME_TDLS_PEER_IND
 0x230f

	)

1552 
	#MLME_RSSI_REPORT_IND
 0x2312

	)

1553 
	#MLME_AC_PRIORITY_UPDATE_IND
 0x2313

	)

1554 
	#MLME_RANGE_IND
 0x2314

	)

1555 
	#MLME_RANGE_DONE_IND
 0x2315

	)

1556 
	#MLME_EVENT_LOG_IND
 0x2316

	)

1557 
	#MLME_NAN_EVENT_IND
 0x2317

	)

1558 
	#MLME_NAN_SERVICE_IND
 0x2318

	)

1559 
	#MLME_NAN_FOLLOWUP_IND
 0x2319

	)

1560 
	#MLME_CHANNEL_SWITCHED_IND
 0x231a

	)

1561 
	#MLME_SYNCHRONISED_IND
 0x231b

	)

1562 
	#MLME_BEACON_REPORTING_EVENT_IND
 0x231c

	)

1563 
	#MLME_ROAMING_CHANNEL_LIST_IND
 0x231d

	)

1564 
	#MLME_BLACKLISTED_IND
 0x231e

	)

1565 
	#MLME_NDP_REQUEST_IND
 0x231f

	)

1566 
	#MLME_NDP_REQUESTED_IND
 0x2320

	)

1567 
	#MLME_NDP_RESPONSE_IND
 0x2321

	)

1568 
	#MLME_NDP_TERMINATED_IND
 0x2323

	)

1569 
	#MLME_NAN_RANGE_CANCELLED_IND
 0x2324

	)

1570 
	#MLME_SPARE_6_IND
 0x2325

	)

1571 
	#MLME_NAN_RANGE_IND
 0x2326

	)

1572 
	#MLME_SPARE_7_IND
 0x2327

	)

1573 
	#MLME_START_DETECT_IND
 0x2328

	)

1574 
	#MLME_SPARE_8_IND
 0x2329

	)

1575 
	#MLME_TWT_SETUP_IND
 0x232a

	)

1576 
	#MLME_TWT_TEARDOWN_IND
 0x232b

	)

1577 
	#MLME_TWT_NOTIFY_IND
 0x232c

	)

1578 
	#MLME_SPARE_9_IND
 0x232d

	)

1579 
	#MLME_SPARE_10_IND
 0x232e

	)

1580 
	#MLME_BLOCKACK_ACTION_IND
 0x232f

	)

1581 
	#MLME_SPARE_SIGNAL_1_IND
 0x2330

	)

1582 
	#MLME_SPARE_SIGNAL_2_IND
 0x2331

	)

1583 
	#MLME_SPARE_SIGNAL_3_IND
 0x2332

	)

1584 
	#DEBUG_SPARE_1_REQ
 0x8000

	)

1585 
	#DEBUG_SPARE_2_REQ
 0x8001

	)

1586 
	#DEBUG_SPARE_3_REQ
 0x8002

	)

1587 
	#DEBUG_SPARE_SIGNAL_1_REQ
 0x8003

	)

1588 
	#DEBUG_SPARE_SIGNAL_2_REQ
 0x8004

	)

1589 
	#DEBUG_SPARE_SIGNAL_3_REQ
 0x8005

	)

1590 
	#DEBUG_SPARE_1_CFM
 0x8100

	)

1591 
	#DEBUG_SPARE_2_CFM
 0x8101

	)

1592 
	#DEBUG_SPARE_3_CFM
 0x8102

	)

1593 
	#DEBUG_SPARE_SIGNAL_1_CFM
 0x8103

	)

1594 
	#DEBUG_SPARE_SIGNAL_2_CFM
 0x8104

	)

1595 
	#DEBUG_SPARE_SIGNAL_3_CFM
 0x8105

	)

1596 
	#DEBUG_SPARE_1_RES
 0x8200

	)

1597 
	#DEBUG_SPARE_2_RES
 0x8201

	)

1598 
	#DEBUG_SPARE_3_RES
 0x8202

	)

1599 
	#DEBUG_SPARE_SIGNAL_1_RES
 0x8203

	)

1600 
	#DEBUG_SPARE_SIGNAL_2_RES
 0x8204

	)

1601 
	#DEBUG_SPARE_SIGNAL_3_RES
 0x8205

	)

1602 
	#DEBUG_WORD12IND
 0x8301

	)

1603 
	#DEBUG_FAULT_IND
 0x8302

	)

1604 
	#DEBUG_WORDS_IND
 0x8303

	)

1605 
	#DEBUG_SPARE_2_IND
 0x8304

	)

1606 
	#DEBUG_SPARE_3_IND
 0x8305

	)

1607 
	#DEBUG_SPARE_4_IND
 0x8306

	)

1608 
	#DEBUG_SPARE_SIGNAL_1_IND
 0x8307

	)

1609 
	#DEBUG_SPARE_SIGNAL_2_IND
 0x8308

	)

1610 
	#DEBUG_SPARE_SIGNAL_3_IND
 0x8309

	)

1611 
	#TEST_BLOCK_REQUESTS_REQ
 0x9000

	)

1612 
	#TEST_PANIC_REQ
 0x9001

	)

1613 
	#TEST_SUSPEND_REQ
 0x9002

	)

1614 
	#TEST_RESUME_REQ
 0x9003

	)

1615 
	#RADIO_LOGGING_REQ
 0x9004

	)

1616 
	#WLANLITE_CW_START_REQ
 0x9005

	)

1617 
	#WLANLITE_CW_STOP_REQ
 0x9006

	)

1618 
	#WLANLITE_TX_SET_PARAMS_REQ
 0x9007

	)

1619 
	#WLANLITE_TX_START_REQ
 0x9008

	)

1620 
	#WLANLITE_TX_READ_REQ
 0x9009

	)

1621 
	#WLANLITE_TX_STOP_REQ
 0x900a

	)

1622 
	#WLANLITE_RX_START_REQ
 0x900b

	)

1623 
	#WLANLITE_RX_READ_REQ
 0x900c

	)

1624 
	#WLANLITE_RX_STOP_REQ
 0x900d

	)

1625 
	#WLANLITE_STATUS_REQ
 0x900e

	)

1626 
	#TEST_PMALLOC_REQ
 0x900f

	)

1627 
	#TEST_CONFIGURE_MONITOR_MODE_REQ
 0x9010

	)

1628 
	#TEST_CHECK_FW_ALIVE_REQ
 0x9012

	)

1629 
	#DEBUG_GENERIC_REQ
 0x9013

	)

1630 
	#DEBUG_PKT_SINK_START_REQ
 0x9014

	)

1631 
	#DEBUG_PKT_SINK_STOP_REQ
 0x9015

	)

1632 
	#DEBUG_PKT_SINK_REPORT_REQ
 0x9016

	)

1633 
	#DEBUG_PKT_GEN_START_REQ
 0x9017

	)

1634 
	#DEBUG_PKT_GEN_STOP_REQ
 0x9018

	)

1635 
	#DEBUG_PKT_GEN_REPORT_REQ
 0x9019

	)

1636 
	#WLANLITE_RADIO_SELECT_REQ
 0x901a

	)

1637 
	#TEST_HIP_TESTER_START_REQ
 0x901b

	)

1638 
	#TEST_HIP_TESTER_STOP_REQ
 0x901c

	)

1639 
	#TEST_HIP_TESTER_SET_PARAMS_REQ
 0x901d

	)

1640 
	#TEST_HIP_TESTER_REPORT_REQ
 0x901e

	)

1641 
	#TEST_BIST_GET_TX_GAIN_REQ
 0x901f

	)

1642 
	#TEST_START_WLANLITE_REQ
 0x9020

	)

1643 
	#TEST_SPARE_2_REQ
 0x9021

	)

1644 
	#TEST_SPARE_3_REQ
 0x9022

	)

1645 
	#PHY_EVENT_LOGGING_REQ
 0x9023

	)

1646 
	#TEST_SPARE_4_REQ
 0x9024

	)

1647 
	#TEST_SPARE_SIGNAL_1_REQ
 0x9025

	)

1648 
	#TEST_SPARE_SIGNAL_2_REQ
 0x9026

	)

1649 
	#TEST_SPARE_SIGNAL_3_REQ
 0x9027

	)

1650 
	#RADIO_LOGGING_CFM
 0x9100

	)

1651 
	#WLANLITE_CW_START_CFM
 0x9101

	)

1652 
	#WLANLITE_TX_SET_PARAMS_CFM
 0x9102

	)

1653 
	#WLANLITE_CW_STOP_CFM
 0x9103

	)

1654 
	#WLANLITE_TX_START_CFM
 0x9104

	)

1655 
	#WLANLITE_TX_READ_CFM
 0x9105

	)

1656 
	#WLANLITE_TX_STOP_CFM
 0x9106

	)

1657 
	#WLANLITE_RX_START_CFM
 0x9107

	)

1658 
	#WLANLITE_RX_READ_CFM
 0x9108

	)

1659 
	#WLANLITE_RX_STOP_CFM
 0x9109

	)

1660 
	#WLANLITE_STATUS_CFM
 0x910a

	)

1661 
	#TEST_PMALLOC_CFM
 0x910b

	)

1662 
	#TEST_CONFIGURE_MONITOR_MODE_CFM
 0x910c

	)

1663 
	#TEST_CHECK_FW_ALIVE_CFM
 0x910e

	)

1664 
	#TEST_SUSPEND_CFM
 0x910f

	)

1665 
	#TEST_RESUME_CFM
 0x9110

	)

1666 
	#DEBUG_GENERIC_CFM
 0x9111

	)

1667 
	#WLANLITE_RADIO_SELECT_CFM
 0x9112

	)

1668 
	#TEST_HIP_TESTER_START_CFM
 0x9113

	)

1669 
	#TEST_HIP_TESTER_STOP_CFM
 0x9114

	)

1670 
	#TEST_HIP_TESTER_SET_PARAMS_CFM
 0x9115

	)

1671 
	#TEST_BIST_GET_TX_GAIN_CFM
 0x9116

	)

1672 
	#TEST_START_WLANLITE_CFM
 0x9117

	)

1673 
	#TEST_SPARE_2_CFM
 0x9118

	)

1674 
	#TEST_SPARE_3_CFM
 0x9119

	)

1675 
	#PHY_EVENT_LOGGING_CFM
 0x911a

	)

1676 
	#TEST_SPARE_4_CFM
 0x911b

	)

1677 
	#TEST_SPARE_SIGNAL_1_CFM
 0x911c

	)

1678 
	#TEST_SPARE_SIGNAL_2_CFM
 0x911d

	)

1679 
	#TEST_SPARE_SIGNAL_3_CFM
 0x911e

	)

1680 
	#TEST_SPARE_1_RES
 0x9200

	)

1681 
	#TEST_SPARE_2_RES
 0x9201

	)

1682 
	#TEST_SPARE_3_RES
 0x9202

	)

1683 
	#TEST_SPARE_SIGNAL_1_RES
 0x9203

	)

1684 
	#TEST_SPARE_SIGNAL_2_RES
 0x9204

	)

1685 
	#TEST_SPARE_SIGNAL_3_RES
 0x9205

	)

1686 
	#RADIO_LOGGING_IND
 0x9300

	)

1687 
	#DEBUG_GENERIC_IND
 0x9301

	)

1688 
	#DEBUG_PKT_SINK_REPORT_IND
 0x9302

	)

1689 
	#DEBUG_PKT_GEN_REPORT_IND
 0x9303

	)

1690 
	#TEST_HIP_TESTER_REPORT_IND
 0x9304

	)

1691 
	#TEST_SPARE_1_IND
 0x9305

	)

1692 
	#TEST_SPARE_2_IND
 0x9306

	)

1693 
	#TEST_SPARE_3_IND
 0x9307

	)

1694 
	#PHY_EVENT_LOGGING_IND
 0x9308

	)

1695 
	#TEST_SPARE_SIGNAL_1_IND
 0x9309

	)

1696 
	#TEST_SPARE_SIGNAL_2_IND
 0x930a

	)

1697 
	#TEST_SPARE_SIGNAL_3_IND
 0x930b

	)

1699 
	sçpi_sigÇl_h—d”
 {

1700 
__Ë16
 
id
;

1701 
__Ë16
 
»ûiv”_pid
;

1702 
__Ë16
 
£nd”_pid
;

1703 
__Ë32
 
fw_»ã»nû
;

1704 } 
__·cked
;

1706 
	sçpi_vif_sigÇl_h—d”
 {

1707 
__Ë16
 
id
;

1708 
__Ë16
 
»ûiv”_pid
;

1709 
__Ë16
 
£nd”_pid
;

1710 
__Ë32
 
fw_»ã»nû
;

1711 
__Ë16
 
vif
;

1712 } 
__·cked
;

1714 
	sçpi_sigÇl
 {

1715 
__Ë16
 
id
;

1716 
__Ë16
 
»ûiv”_pid
;

1717 
__Ë16
 
£nd”_pid
;

1718 
__Ë32
 
fw_»ã»nû
;

1722 
__Ë16
 
vif
;

1723 
__Ë16
 
æow_id
;

1724 
u8
 
add»ss
[
ETH_ALEN
];

1725 
__Ë16
 
cÚfigu¿tiÚ_İtiÚ
;

1726 
__Ë32
 
¥¬e_1
;

1727 
__Ë32
 
¥¬e_2
;

1728 
__Ë32
 
¥¬e_3
;

1729 
u8
 
dr
[0];

1730 } 
__·cked
 
ma_un™d©a_»q
;

1732 
__Ë16
 
vif
;

1733 
__Ë32
 
¥¬e_1
;

1734 
__Ë32
 
¥¬e_2
;

1735 
__Ë32
 
¥¬e_3
;

1736 
u8
 
dr
[0];

1737 } 
__·cked
 
ma_¥¬e_1_»q
;

1739 
__Ë16
 
vif
;

1740 
__Ë32
 
¥¬e_1
;

1741 
__Ë32
 
¥¬e_2
;

1742 
__Ë32
 
¥¬e_3
;

1743 
u8
 
dr
[0];

1744 } 
__·cked
 
ma_¥¬e_2_»q
;

1746 
__Ë16
 
vif
;

1747 
__Ë32
 
¥¬e_1
;

1748 
__Ë32
 
¥¬e_2
;

1749 
__Ë32
 
¥¬e_3
;

1750 
u8
 
dr
[0];

1751 } 
__·cked
 
ma_¥¬e_3_»q
;

1753 
__Ë16
 
vif
;

1754 
__Ë32
 
¥¬e_1
;

1755 
__Ë32
 
¥¬e_2
;

1756 
__Ë32
 
¥¬e_3
;

1757 
u8
 
dr
[0];

1758 } 
__·cked
 
ma_¥¬e_sigÇl_1_»q
;

1760 
__Ë16
 
vif
;

1761 
__Ë32
 
¥¬e_1
;

1762 
__Ë32
 
¥¬e_2
;

1763 
__Ë32
 
¥¬e_3
;

1764 
u8
 
dr
[0];

1765 } 
__·cked
 
ma_¥¬e_sigÇl_2_»q
;

1767 
__Ë16
 
vif
;

1768 
__Ë32
 
¥¬e_1
;

1769 
__Ë32
 
¥¬e_2
;

1770 
__Ë32
 
¥¬e_3
;

1771 
u8
 
dr
[0];

1772 } 
__·cked
 
ma_¥¬e_sigÇl_3_»q
;

1774 
__Ë16
 
vif
;

1775 
__Ë16
 
»suÉ_code
;

1776 
__Ë32
 
time¡amp
;

1777 
__Ë32
 
¥¬e_1
;

1778 
__Ë32
 
¥¬e_2
;

1779 
__Ë32
 
¥¬e_3
;

1780 
u8
 
dr
[0];

1781 } 
__·cked
 
ma_¥¬e_1_cfm
;

1783 
__Ë16
 
vif
;

1784 
__Ë16
 
»suÉ_code
;

1785 
__Ë32
 
time¡amp
;

1786 
__Ë32
 
¥¬e_1
;

1787 
__Ë32
 
¥¬e_2
;

1788 
__Ë32
 
¥¬e_3
;

1789 
u8
 
dr
[0];

1790 } 
__·cked
 
ma_¥¬e_2_cfm
;

1792 
__Ë16
 
vif
;

1793 
__Ë16
 
»suÉ_code
;

1794 
__Ë32
 
time¡amp
;

1795 
__Ë32
 
¥¬e_1
;

1796 
__Ë32
 
¥¬e_2
;

1797 
__Ë32
 
¥¬e_3
;

1798 
u8
 
dr
[0];

1799 } 
__·cked
 
ma_¥¬e_3_cfm
;

1801 
__Ë16
 
vif
;

1802 
__Ë16
 
»suÉ_code
;

1803 
__Ë32
 
¥¬e_1
;

1804 
__Ë32
 
¥¬e_2
;

1805 
__Ë32
 
¥¬e_3
;

1806 
u8
 
dr
[0];

1807 } 
__·cked
 
ma_¥¬e_sigÇl_1_cfm
;

1809 
__Ë16
 
vif
;

1810 
__Ë16
 
»suÉ_code
;

1811 
__Ë32
 
¥¬e_1
;

1812 
__Ë32
 
¥¬e_2
;

1813 
__Ë32
 
¥¬e_3
;

1814 
u8
 
dr
[0];

1815 } 
__·cked
 
ma_¥¬e_sigÇl_2_cfm
;

1817 
__Ë16
 
vif
;

1818 
__Ë16
 
»suÉ_code
;

1819 
__Ë32
 
¥¬e_1
;

1820 
__Ë32
 
¥¬e_2
;

1821 
__Ë32
 
¥¬e_3
;

1822 
u8
 
dr
[0];

1823 } 
__·cked
 
ma_¥¬e_sigÇl_3_cfm
;

1825 
__Ë16
 
vif
;

1826 
__Ë32
 
¥¬e_1
;

1827 
__Ë32
 
¥¬e_2
;

1828 
__Ë32
 
¥¬e_3
;

1829 
u8
 
dr
[0];

1830 } 
__·cked
 
ma_¥¬e_1_»s
;

1832 
__Ë16
 
vif
;

1833 
__Ë32
 
¥¬e_1
;

1834 
__Ë32
 
¥¬e_2
;

1835 
__Ë32
 
¥¬e_3
;

1836 
u8
 
dr
[0];

1837 } 
__·cked
 
ma_¥¬e_2_»s
;

1839 
__Ë16
 
vif
;

1840 
__Ë32
 
¥¬e_1
;

1841 
__Ë32
 
¥¬e_2
;

1842 
__Ë32
 
¥¬e_3
;

1843 
u8
 
dr
[0];

1844 } 
__·cked
 
ma_¥¬e_3_»s
;

1846 
__Ë16
 
vif
;

1847 
__Ë32
 
¥¬e_1
;

1848 
__Ë32
 
¥¬e_2
;

1849 
__Ë32
 
¥¬e_3
;

1850 
u8
 
dr
[0];

1851 } 
__·cked
 
ma_¥¬e_sigÇl_1_»s
;

1853 
__Ë16
 
vif
;

1854 
__Ë32
 
¥¬e_1
;

1855 
__Ë32
 
¥¬e_2
;

1856 
__Ë32
 
¥¬e_3
;

1857 
u8
 
dr
[0];

1858 } 
__·cked
 
ma_¥¬e_sigÇl_2_»s
;

1860 
__Ë16
 
vif
;

1861 
__Ë32
 
¥¬e_1
;

1862 
__Ë32
 
¥¬e_2
;

1863 
__Ë32
 
¥¬e_3
;

1864 
u8
 
dr
[0];

1865 } 
__·cked
 
ma_¥¬e_sigÇl_3_»s
;

1867 
__Ë16
 
vif
;

1868 
__Ë16
 
cÚfigu¿tiÚ_İtiÚ
;

1869 
__Ë32
 
time¡amp
;

1870 
__Ë32
 
¥¬e_1
;

1871 
__Ë32
 
¥¬e_2
;

1872 
__Ë32
 
¥¬e_3
;

1873 
u8
 
dr
[0];

1874 } 
__·cked
 
ma_un™d©a_šd
;

1876 
__Ë16
 
vif
;

1877 
__Ë32
 
time¡amp
;

1878 
__Ë32
 
¥¬e_1
;

1879 
__Ë32
 
¥¬e_2
;

1880 
__Ë32
 
¥¬e_3
;

1881 
u8
 
dr
[0];

1882 } 
__·cked
 
ma_blockack»q_šd
;

1884 
__Ë16
 
vif
;

1885 
__Ë32
 
time¡amp
;

1886 
__Ë32
 
¥¬e_1
;

1887 
__Ë32
 
¥¬e_2
;

1888 
__Ë32
 
¥¬e_3
;

1889 
u8
 
dr
[0];

1890 } 
__·cked
 
ma_¥¬e_1_šd
;

1892 
__Ë16
 
vif
;

1893 
__Ë32
 
time¡amp
;

1894 
__Ë32
 
¥¬e_1
;

1895 
__Ë32
 
¥¬e_2
;

1896 
__Ë32
 
¥¬e_3
;

1897 
u8
 
dr
[0];

1898 } 
__·cked
 
ma_¥¬e_2_šd
;

1900 
__Ë16
 
vif
;

1901 
__Ë32
 
time¡amp
;

1902 
__Ë32
 
¥¬e_1
;

1903 
__Ë32
 
¥¬e_2
;

1904 
__Ë32
 
¥¬e_3
;

1905 
u8
 
dr
[0];

1906 } 
__·cked
 
ma_¥¬e_3_šd
;

1908 
__Ë16
 
vif
;

1909 
__Ë32
 
¥¬e_1
;

1910 
__Ë32
 
¥¬e_2
;

1911 
__Ë32
 
¥¬e_3
;

1912 
u8
 
dr
[0];

1913 } 
__·cked
 
ma_¥¬e_sigÇl_1_šd
;

1915 
__Ë16
 
vif
;

1916 
__Ë32
 
¥¬e_1
;

1917 
__Ë32
 
¥¬e_2
;

1918 
__Ë32
 
¥¬e_3
;

1919 
u8
 
dr
[0];

1920 } 
__·cked
 
ma_¥¬e_sigÇl_2_šd
;

1922 
__Ë16
 
vif
;

1923 
__Ë32
 
¥¬e_1
;

1924 
__Ë32
 
¥¬e_2
;

1925 
__Ë32
 
¥¬e_3
;

1926 
u8
 
dr
[0];

1927 } 
__·cked
 
ma_¥¬e_sigÇl_3_šd
;

1929 
__Ë16
 
vif
;

1930 
__Ë32
 
¥¬e_1
;

1931 
__Ë32
 
¥¬e_2
;

1932 
__Ë32
 
¥¬e_3
;

1933 
u8
 
dr
[0];

1934 } 
__·cked
 
mlme_g‘_»q
;

1936 
__Ë16
 
vif
;

1937 
__Ë32
 
¥¬e_1
;

1938 
__Ë32
 
¥¬e_2
;

1939 
__Ë32
 
¥¬e_3
;

1940 
u8
 
dr
[0];

1941 } 
__·cked
 
mlme_£t_»q
;

1943 
__Ë16
 
vif
;

1944 
__Ë16
 
pow”_mªagem’t_mode
;

1945 
__Ë32
 
¥¬e_1
;

1946 
__Ë32
 
¥¬e_2
;

1947 
__Ë32
 
¥¬e_3
;

1948 
u8
 
dr
[0];

1949 } 
__·cked
 
mlme_pow”mgt_»q
;

1951 
__Ë16
 
vif
;

1952 
__Ë16
 
pu½o£
;

1953 
__Ë32
 
¥¬e_1
;

1954 
__Ë32
 
¥¬e_2
;

1955 
__Ë32
 
¥¬e_3
;

1956 
u8
 
dr
[0];

1957 } 
__·cked
 
mlme_add_šfo_–em’ts_»q
;

1959 
__Ë16
 
vif
;

1960 
__Ë16
 
sÿn_id
;

1961 
__Ë16
 
sÿn_ty³
;

1962 
u8
 
deviû_add»ss
[
ETH_ALEN
];

1963 
__Ë16
 
»pÜt_mode_b™m­
;

1964 
__Ë32
 
¥¬e_1
;

1965 
__Ë32
 
¥¬e_2
;

1966 
__Ë32
 
¥¬e_3
;

1967 
u8
 
dr
[0];

1968 } 
__·cked
 
mlme_add_sÿn_»q
;

1970 
__Ë16
 
vif
;

1971 
__Ë16
 
sÿn_id
;

1972 
__Ë32
 
¥¬e_1
;

1973 
__Ë32
 
¥¬e_2
;

1974 
__Ë32
 
¥¬e_3
;

1975 
u8
 
dr
[0];

1976 } 
__·cked
 
mlme_d–_sÿn_»q
;

1978 
__Ë16
 
vif
;

1979 
u8
 
š‹rçû_add»ss
[
ETH_ALEN
];

1980 
__Ë16
 
vœtu®_š‹rçû_ty³
;

1981 
u8
 
deviû_add»ss
[
ETH_ALEN
];

1982 
__Ë32
 
¥¬e_1
;

1983 
__Ë32
 
¥¬e_2
;

1984 
__Ë32
 
¥¬e_3
;

1985 
u8
 
dr
[0];

1986 } 
__·cked
 
mlme_add_vif_»q
;

1988 
__Ë16
 
vif
;

1989 
__Ë32
 
¥¬e_1
;

1990 
__Ë32
 
¥¬e_2
;

1991 
__Ë32
 
¥¬e_3
;

1992 
u8
 
dr
[0];

1993 } 
__·cked
 
mlme_d–_vif_»q
;

1995 
__Ë16
 
vif
;

1996 
u8
 
bssid
[
ETH_ALEN
];

1997 
__Ë16
 
b—cÚ_³riod
;

1998 
__Ë16
 
dtim_³riod
;

1999 
__Ë16
 
ÿ·b™y_šfÜm©iÚ
;

2000 
__Ë16
 
auth’tiÿtiÚ_ty³
;

2001 
__Ë16
 
hidd’_ssid
;

2002 
__Ë16
 
chªÃl_äequ’cy
;

2003 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2004 
__Ë16
 
chªÃl_cÚfigu¿tiÚ
;

2005 
__Ë32
 
¥¬e_1
;

2006 
__Ë32
 
¥¬e_2
;

2007 
__Ë32
 
¥¬e_3
;

2008 
u8
 
dr
[0];

2009 } 
__·cked
 
mlme_¡¬t_»q
;

2011 
__Ë16
 
vif
;

2012 
__Ë16
 
avaab™y_du¿tiÚ
;

2013 
__Ë16
 
avaab™y_š‹rv®
;

2014 
__Ë16
 
couÁ
;

2015 
__Ë16
 
chªÃl_äequ’cy
;

2016 
__Ë32
 
¥¬e_1
;

2017 
__Ë32
 
¥¬e_2
;

2018 
__Ë32
 
¥¬e_3
;

2019 
u8
 
dr
[0];

2020 } 
__·cked
 
mlme_£t_chªÃl_»q
;

2022 
__Ë16
 
vif
;

2023 
u8
 
bssid
[
ETH_ALEN
];

2024 
__Ë16
 
auth’tiÿtiÚ_ty³
;

2025 
__Ë16
 
chªÃl_äequ’cy
;

2026 
__Ë32
 
¥¬e_1
;

2027 
__Ë32
 
¥¬e_2
;

2028 
__Ë32
 
¥¬e_3
;

2029 
u8
 
dr
[0];

2030 } 
__·cked
 
mlme_cÚÃù_»q
;

2032 
__Ë16
 
vif
;

2033 
__Ë32
 
¥¬e_1
;

2034 
__Ë32
 
¥¬e_2
;

2035 
__Ë32
 
¥¬e_3
;

2036 
u8
 
dr
[0];

2037 } 
__·cked
 
mlme_»assocŸ‹_»q
;

2039 
__Ë16
 
vif
;

2040 
u8
 
bssid
[
ETH_ALEN
];

2041 
__Ë16
 
chªÃl_äequ’cy
;

2042 
__Ë32
 
¥¬e_1
;

2043 
__Ë32
 
¥¬e_2
;

2044 
__Ë32
 
¥¬e_3
;

2045 
u8
 
dr
[0];

2046 } 
__·cked
 
mlme_rßm_»q
;

2048 
__Ë16
 
vif
;

2049 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

2050 
__Ë16
 
»asÚ_code
;

2051 
__Ë32
 
¥¬e_1
;

2052 
__Ë32
 
¥¬e_2
;

2053 
__Ë32
 
¥¬e_3
;

2054 
u8
 
dr
[0];

2055 } 
__·cked
 
mlme_discÚÃù_»q
;

2057 
__Ë16
 
vif
;

2058 
__Ë32
 
aùiÚ_äame_ÿ‹gÜy_b™m­_aùive
;

2059 
__Ë32
 
aùiÚ_äame_ÿ‹gÜy_b™m­_su¥’ded
;

2060 
__Ë32
 
¥¬e_1
;

2061 
__Ë32
 
¥¬e_2
;

2062 
__Ë32
 
¥¬e_3
;

2063 
u8
 
dr
[0];

2064 } 
__·cked
 
mlme_»gi¡”_aùiÚ_äame_»q
;

2066 
__Ë16
 
vif
;

2067 
__Ë16
 
ho¡_g
;

2068 
__Ë16
 
d©a_un™_desütÜ
;

2069 
__Ë16
 
mes§ge_ty³
;

2070 
__Ë16
 
chªÃl_äequ’cy
;

2071 
__Ë32
 
dw–l_time
;

2072 
__Ë32
 
³riod
;

2073 
__Ë32
 
¥¬e_1
;

2074 
__Ë32
 
¥¬e_2
;

2075 
__Ë32
 
¥¬e_3
;

2076 
u8
 
dr
[0];

2077 } 
__·cked
 
mlme_£nd_äame_»q
;

2079 
__Ë16
 
vif
;

2080 
__Ë32
 
¥¬e_1
;

2081 
__Ë32
 
¥¬e_2
;

2082 
__Ë32
 
¥¬e_3
;

2083 
u8
 
dr
[0];

2084 } 
__·cked
 
mlme_»£t_dw–l_time_»q
;

2086 
__Ë16
 
vif
;

2087 
__Ë16
 
u£r_´iÜ™y
;

2088 
__Ë16
 
medium_time
;

2089 
__Ë16
 
mšimum_d©a_¿‹
;

2090 
u8
 
³”_add»ss
[
ETH_ALEN
];

2091 
__Ë32
 
¥¬e_1
;

2092 
__Ë32
 
¥¬e_2
;

2093 
__Ë32
 
¥¬e_3
;

2094 
u8
 
dr
[0];

2095 } 
__·cked
 
mlme_£t_Œaffic_·¿m‘”s_»q
;

2097 
__Ë16
 
vif
;

2098 
__Ë16
 
u£r_´iÜ™y
;

2099 
__Ë32
 
¥¬e_1
;

2100 
__Ë32
 
¥¬e_2
;

2101 
__Ë32
 
¥¬e_3
;

2102 
u8
 
dr
[0];

2103 } 
__·cked
 
mlme_d–_Œaffic_·¿m‘”s_»q
;

2105 
__Ë16
 
vif
;

2106 
__Ë32
 
¥¬e_1
;

2107 
__Ë32
 
¥¬e_2
;

2108 
__Ë32
 
¥¬e_3
;

2109 
u8
 
dr
[0];

2110 } 
__·cked
 
mlme_£t_·ck‘_f‹r_»q
;

2112 
__Ë16
 
vif
;

2113 
__Ë16
 
add»ss_ty³
;

2114 
u8
 
muÉiÿ¡_add»ss
[
ETH_ALEN
];

2115 
__Ë32
 
¥¬e_1
;

2116 
__Ë32
 
¥¬e_2
;

2117 
__Ë32
 
¥¬e_3
;

2118 
u8
 
dr
[0];

2119 } 
__·cked
 
mlme_£t__add»ss_»q
;

2121 
__Ë16
 
vif
;

2122 
__Ë16
 
’Œ›s
;

2123 
__Ë16
 
aş_pŞicy
;

2124 
__Ë32
 
¥¬e_1
;

2125 
__Ë32
 
¥¬e_2
;

2126 
__Ë32
 
¥¬e_3
;

2127 
u8
 
dr
[0];

2128 } 
__·cked
 
mlme_£t_aş_»q
;

2130 
__Ë16
 
vif
;

2131 
__Ë16
 
Ëngth
;

2132 
__Ë16
 
key_id
;

2133 
__Ë16
 
key_ty³
;

2134 
u8
 
add»ss
[
ETH_ALEN
];

2135 
__Ë16
 
keyrsc
[8];

2136 
__Ë32
 
ch”_su™e_£ËùÜ
;

2137 
__Ë16
 
ÿche_id’tif›r
;

2138 
__Ë32
 
¥¬e_1
;

2139 
__Ë32
 
¥¬e_2
;

2140 
__Ë32
 
¥¬e_3
;

2141 
u8
 
dr
[0];

2142 } 
__·cked
 
mlme_£tkeys_»q
;

2144 
__Ë16
 
vif
;

2145 
__Ë16
 
key_id
;

2146 
__Ë16
 
key_ty³
;

2147 
__Ë32
 
¥¬e_1
;

2148 
__Ë32
 
¥¬e_2
;

2149 
__Ë32
 
¥¬e_3
;

2150 
u8
 
dr
[0];

2151 } 
__·cked
 
mlme_g‘_key_£qu’û_»q
;

2153 
__Ë16
 
vif
;

2154 
__Ë32
 
¥¬e_1
;

2155 
__Ë32
 
¥¬e_2
;

2156 
__Ë32
 
¥¬e_3
;

2157 
u8
 
dr
[0];

2158 } 
__·cked
 
mlme_£t_ÿched_chªÃls_»q
;

2160 
__Ë16
 
vif
;

2161 
__Ë32
 
¥¬e_1
;

2162 
__Ë32
 
¥¬e_2
;

2163 
__Ë32
 
¥¬e_3
;

2164 
u8
 
dr
[0];

2165 } 
__·cked
 
mlme_£t_wh™–i¡_ssid_»q
;

2167 
__Ë16
 
vif
;

2168 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

2169 
__Ë16
 
tdls_aùiÚ
;

2170 
__Ë32
 
¥¬e_1
;

2171 
__Ë32
 
¥¬e_2
;

2172 
__Ë32
 
¥¬e_3
;

2173 
u8
 
dr
[0];

2174 } 
__·cked
 
mlme_tdls_aùiÚ_»q
;

2176 
__Ë16
 
vif
;

2177 
__Ë16
 
chªÃl_äequ’cy
;

2178 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2179 
__Ë32
 
¥¬e_1
;

2180 
__Ë32
 
¥¬e_2
;

2181 
__Ë32
 
¥¬e_3
;

2182 
u8
 
dr
[0];

2183 } 
__·cked
 
mlme_chªÃl_sw™ch_»q
;

2185 
__Ë16
 
vif
;

2186 
__Ë16
 
low_rssi_th»shŞd
;

2187 
__Ë16
 
high_rssi_th»shŞd
;

2188 
__Ë16
 
rssi_mÚ™Üšg_’abËd
;

2189 
__Ë32
 
¥¬e_1
;

2190 
__Ë32
 
¥¬e_2
;

2191 
__Ë32
 
¥¬e_3
;

2192 
u8
 
dr
[0];

2193 } 
__·cked
 
mlme_mÚ™Ü_rssi_»q
;

2195 
__Ë16
 
vif
;

2196 
__Ë16
 
mpdu_size_th»shŞd
;

2197 
__Ë16
 
agg»ssive_¡©i¡ics_g©h”šg_’abËd
;

2198 
__Ë32
 
¥¬e_1
;

2199 
__Ë32
 
¥¬e_2
;

2200 
__Ë32
 
¥¬e_3
;

2201 
u8
 
dr
[0];

2202 } 
__·cked
 
mlme_¡¬t_lšk_¡©i¡ics_»q
;

2204 
__Ë16
 
vif
;

2205 
__Ë16
 
¡©i¡ics_¡İ_b™m­
;

2206 
__Ë32
 
¥¬e_1
;

2207 
__Ë32
 
¥¬e_2
;

2208 
__Ë32
 
¥¬e_3
;

2209 
u8
 
dr
[0];

2210 } 
__·cked
 
mlme_¡İ_lšk_¡©i¡ics_»q
;

2212 
__Ë16
 
vif
;

2213 
__Ë16
 
ho¡_¡©e
;

2214 
__Ë32
 
¥¬e_1
;

2215 
__Ë32
 
¥¬e_2
;

2216 
__Ë32
 
¥¬e_3
;

2217 
u8
 
dr
[0];

2218 } 
__·cked
 
mlme_ho¡_¡©e_»q
;

2220 
__Ë16
 
vif
;

2221 
__Ë16
 
¹t_id
;

2222 
u8
 
deviû_add»ss
[
ETH_ALEN
];

2223 
__Ë32
 
¥¬e_1
;

2224 
__Ë32
 
¥¬e_2
;

2225 
__Ë32
 
¥¬e_3
;

2226 
u8
 
dr
[0];

2227 } 
__·cked
 
mlme_add_¿nge_»q
;

2229 
__Ë16
 
vif
;

2230 
__Ë16
 
¹t_id
;

2231 
__Ë16
 
’Œ›s
;

2232 
__Ë32
 
¥¬e_1
;

2233 
__Ë32
 
¥¬e_2
;

2234 
__Ë32
 
¥¬e_3
;

2235 
u8
 
dr
[0];

2236 } 
__·cked
 
mlme_d–_¿nge_»q
;

2238 
__Ë16
 
vif
;

2239 
__Ë16
 
»que¡_id
;

2240 
__Ë16
 
nß_couÁ
;

2241 
__Ë32
 
š‹rv®
;

2242 
__Ë32
 
du¿tiÚ
;

2243 
__Ë32
 
¥¬e_1
;

2244 
__Ë32
 
¥¬e_2
;

2245 
__Ë32
 
¥¬e_3
;

2246 
u8
 
dr
[0];

2247 } 
__·cked
 
mlme_£t_nß_»q
;

2249 
__Ë16
 
vif
;

2250 
__Ë16
 
ùwšdow
;

2251 
__Ë32
 
¥¬e_1
;

2252 
__Ë32
 
¥¬e_2
;

2253 
__Ë32
 
¥¬e_3
;

2254 
u8
 
dr
[0];

2255 } 
__·cked
 
mlme_£t_ùwšdow_»q
;

2257 
__Ë16
 
vif
;

2258 
__Ë16
 
Çn_İ”©iÚ_cÚŒŞ_æags
;

2259 
__Ë32
 
¥¬e_1
;

2260 
__Ë32
 
¥¬e_2
;

2261 
__Ë32
 
¥¬e_3
;

2262 
u8
 
dr
[0];

2263 } 
__·cked
 
mlme_Çn_¡¬t_»q
;

2265 
__Ë16
 
vif
;

2266 
__Ë16
 
Çn_İ”©iÚ_cÚŒŞ_æags
;

2267 
__Ë32
 
¥¬e_1
;

2268 
__Ë32
 
¥¬e_2
;

2269 
__Ë32
 
¥¬e_3
;

2270 
u8
 
dr
[0];

2271 } 
__·cked
 
mlme_Çn_cÚfig_»q
;

2273 
__Ë16
 
vif
;

2274 
__Ë16
 
£ssiÚ_id
;

2275 
__Ë16
 
Çn_sdf_æags
;

2276 
__Ë32
 
¥¬e_1
;

2277 
__Ë32
 
¥¬e_2
;

2278 
__Ë32
 
¥¬e_3
;

2279 
u8
 
dr
[0];

2280 } 
__·cked
 
mlme_Çn_publish_»q
;

2282 
__Ë16
 
vif
;

2283 
__Ë16
 
£ssiÚ_id
;

2284 
__Ë16
 
Çn_sdf_æags
;

2285 
__Ë32
 
¥¬e_1
;

2286 
__Ë32
 
¥¬e_2
;

2287 
__Ë32
 
¥¬e_3
;

2288 
u8
 
dr
[0];

2289 } 
__·cked
 
mlme_Çn_subsüibe_»q
;

2291 
__Ë16
 
vif
;

2292 
__Ë16
 
£ssiÚ_id
;

2293 
__Ë16
 
m©ch_id
;

2294 
__Ë16
 
Çn_sdf_æags
;

2295 
__Ë32
 
¥¬e_1
;

2296 
__Ë32
 
¥¬e_2
;

2297 
__Ë32
 
¥¬e_3
;

2298 
u8
 
dr
[0];

2299 } 
__·cked
 
mlme_Çn_fŞlowup_»q
;

2301 
__Ë16
 
vif
;

2302 
__Ë32
 
¥¬e_1
;

2303 
__Ë32
 
¥¬e_2
;

2304 
__Ë32
 
¥¬e_3
;

2305 
u8
 
dr
[0];

2306 } 
__·cked
 
mlme_un£t_chªÃl_»q
;

2308 
__Ë16
 
vif
;

2309 
__Ë16
 
couÁry_code
;

2310 
__Ë16
 
İ”©šg_şass_£t
;

2311 
__Ë32
 
¥¬e_1
;

2312 
__Ë32
 
¥¬e_2
;

2313 
__Ë32
 
¥¬e_3
;

2314 
u8
 
dr
[0];

2315 } 
__·cked
 
mlme_£t_couÁry_»q
;

2317 
__Ë16
 
vif
;

2318 
__Ë16
 
ws_aùiÚ
;

2319 
__Ë32
 
¥¬e_1
;

2320 
__Ë32
 
¥¬e_2
;

2321 
__Ë32
 
¥¬e_3
;

2322 
u8
 
dr
[0];

2323 } 
__·cked
 
mlme_fÜw¬d_b—cÚ_»q
;

2325 
__Ë16
 
vif
;

2326 
__Ë16
 
ndl_vif_šdex
;

2327 
__Ë16
 
m©ch_id
;

2328 
u8
 
loÿl_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

2329 
u8
 
³”_nmi
[
ETH_ALEN
];

2330 
__Ë16
 
ndp_š¡ªû_id
;

2331 
__Ë32
 
¥¬e_1
;

2332 
__Ë32
 
¥¬e_2
;

2333 
__Ë32
 
¥¬e_3
;

2334 
u8
 
dr
[0];

2335 } 
__·cked
 
mlme_ndp_»que¡_»q
;

2337 
__Ë16
 
vif
;

2338 
__Ë16
 
»que¡_id
;

2339 
__Ë16
 
ndl_vif_šdex
;

2340 
__Ë16
 
»asÚ_code
;

2341 
u8
 
loÿl_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

2342 
__Ë16
 
ndp_š¡ªû_id
;

2343 
__Ë32
 
¥¬e_1
;

2344 
__Ë32
 
¥¬e_2
;

2345 
__Ë32
 
¥¬e_3
;

2346 
u8
 
dr
[0];

2347 } 
__·cked
 
mlme_ndp_»¥Ú£_»q
;

2349 
__Ë16
 
vif
;

2350 
__Ë16
 
ndp_š¡ªû_id
;

2351 
__Ë32
 
¥¬e_1
;

2352 
__Ë32
 
¥¬e_2
;

2353 
__Ë32
 
¥¬e_3
;

2354 
u8
 
dr
[0];

2355 } 
__·cked
 
mlme_ndp_‹rmš©e_»q
;

2357 
__Ë16
 
vif
;

2358 
__Ë32
 
¥¬e_1
;

2359 
__Ë32
 
¥¬e_2
;

2360 
__Ë32
 
¥¬e_3
;

2361 
u8
 
dr
[0];

2362 } 
__·cked
 
mlme_rßmšg_chªÃl_li¡_»q
;

2364 
__Ë16
 
vif
;

2365 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2366 
__Ë16
 
´ÙeùiÚ_scİe
;

2367 
__Ë32
 
¥¬e_1
;

2368 
__Ë32
 
¥¬e_2
;

2369 
__Ë32
 
¥¬e_3
;

2370 
u8
 
dr
[0];

2371 } 
__·cked
 
mlme_£t_bss_max_chªÃl_width_»q
;

2373 
__Ë16
 
vif
;

2374 
__Ë16
 
sÿn_mode
;

2375 
__Ë16
 
max_chªÃl_time_aùive
;

2376 
__Ë16
 
home_away_time
;

2377 
__Ë16
 
home_time
;

2378 
__Ë16
 
max_chªÃl_time_·ssive
;

2379 
__Ë32
 
¥¬e_1
;

2380 
__Ë32
 
¥¬e_2
;

2381 
__Ë32
 
¥¬e_3
;

2382 
u8
 
dr
[0];

2383 } 
__·cked
 
mlme_£t_sÿn_mode_»q
;

2385 
__Ë16
 
vif
;

2386 
__Ë16
 
f‹r_mode
;

2387 
__Ë32
 
¥¬e_1
;

2388 
__Ë32
 
¥¬e_2
;

2389 
__Ë32
 
¥¬e_3
;

2390 
u8
 
dr
[0];

2391 } 
__·cked
 
mlme_š¡®l_­f_»q
;

2393 
__Ë16
 
vif
;

2394 
__Ë32
 
¥¬e_1
;

2395 
__Ë32
 
¥¬e_2
;

2396 
__Ë32
 
¥¬e_3
;

2397 
u8
 
dr
[0];

2398 } 
__·cked
 
mlme_»ad_­f_»q
;

2400 
__Ë16
 
vif
;

2401 
__Ë16
 
numb”_of_ª‹Âas
;

2402 
__Ë16
 
äame_ty³
;

2403 
__Ë16
 
num_tx_ª‹Âas_ov”ride
;

2404 
__Ë32
 
¥¬e_1
;

2405 
__Ë32
 
¥¬e_2
;

2406 
__Ë32
 
¥¬e_3
;

2407 
u8
 
dr
[0];

2408 } 
__·cked
 
mlme_£t_num_ª‹Âas_»q
;

2410 
__Ë16
 
vif
;

2411 
__Ë16
 
¬p_d‘eù_aùiÚ
;

2412 
__Ë32
 
¥¬e_1
;

2413 
__Ë32
 
¥¬e_2
;

2414 
__Ë32
 
¥¬e_3
;

2415 
u8
 
dr
[0];

2416 } 
__·cked
 
mlme_¬p_d‘eù_»q
;

2418 
__Ë16
 
vif
;

2419 
__Ë16
 
rßmšg_ty³
;

2420 
__Ë32
 
¥¬e_1
;

2421 
__Ë32
 
¥¬e_2
;

2422 
__Ë32
 
¥¬e_3
;

2423 
u8
 
dr
[0];

2424 } 
__·cked
 
mlme_£t_rßmšg_ty³_»q
;

2426 
__Ë16
 
vif
;

2427 
__Ë16
 
bªd
;

2428 
__Ë32
 
¥¬e_1
;

2429 
__Ë32
 
¥¬e_2
;

2430 
__Ë32
 
¥¬e_3
;

2431 
u8
 
dr
[0];

2432 } 
__·cked
 
mlme_£t_bªd_»q
;

2434 
__Ë16
 
vif
;

2435 
__Ë32
 
¥¬e_1
;

2436 
__Ë32
 
¥¬e_2
;

2437 
__Ë32
 
¥¬e_3
;

2438 
u8
 
dr
[0];

2439 } 
__·cked
 
mlme_£t_rßmšg_·¿m‘”s_»q
;

2441 
__Ë16
 
vif
;

2442 
__Ë32
 
¥¬e_1
;

2443 
__Ë32
 
¥¬e_2
;

2444 
__Ë32
 
¥¬e_3
;

2445 
u8
 
dr
[0];

2446 } 
__·cked
 
mlme_wifish¬šg_³rm™‹d_chªÃls_»q
;

2448 
__Ë16
 
vif
;

2449 
__Ë16
 
rßmšg_¡©e
;

2450 
__Ë32
 
¥¬e_1
;

2451 
__Ë32
 
¥¬e_2
;

2452 
__Ë32
 
¥¬e_3
;

2453 
u8
 
dr
[0];

2454 } 
__·cked
 
mlme_rßmšg_¡©e_»q
;

2456 
__Ë16
 
vif
;

2457 
__Ë32
 
¥¬e_1
;

2458 
__Ë32
 
¥¬e_2
;

2459 
__Ë32
 
¥¬e_3
;

2460 
u8
 
dr
[0];

2461 } 
__·cked
 
mlme_¥¬e_8_»q
;

2463 
__Ë16
 
vif
;

2464 
__Ë16
 
chªÃl_äequ’cy_£gm’t0
;

2465 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2466 
__Ë16
 
chªÃl_äequ’cy_£gm’t1
;

2467 
__Ë32
 
¥¬e_1
;

2468 
__Ë32
 
¥¬e_2
;

2469 
__Ë32
 
¥¬e_3
;

2470 
u8
 
dr
[0];

2471 } 
__·cked
 
mlme_cÚfigu»_mÚ™Ü_mode_»q
;

2473 
__Ë16
 
vif
;

2474 
__Ë32
 
¥¬e_1
;

2475 
__Ë32
 
¥¬e_2
;

2476 
__Ë32
 
¥¬e_3
;

2477 
u8
 
dr
[0];

2478 } 
__·cked
 
mlme_¥¬e_9_»q
;

2480 
__Ë16
 
vif
;

2481 
__Ë32
 
¥¬e_1
;

2482 
__Ë32
 
¥¬e_2
;

2483 
__Ë32
 
¥¬e_3
;

2484 
u8
 
dr
[0];

2485 } 
__·cked
 
mlme_¥¬e_10_»q
;

2487 
__Ë16
 
vif
;

2488 
__Ë32
 
¥¬e_1
;

2489 
__Ë32
 
¥¬e_2
;

2490 
__Ë32
 
¥¬e_3
;

2491 
u8
 
dr
[0];

2492 } 
__·cked
 
mlme_¥¬e_11_»q
;

2494 
__Ë16
 
vif
;

2495 
__Ë32
 
¥¬e_1
;

2496 
__Ë32
 
¥¬e_2
;

2497 
__Ë32
 
¥¬e_3
;

2498 
u8
 
dr
[0];

2499 } 
__·cked
 
mlme_Çn_¿nge_»q
;

2501 
__Ë16
 
vif
;

2502 
__Ë32
 
¥¬e_1
;

2503 
__Ë32
 
¥¬e_2
;

2504 
__Ë32
 
¥¬e_3
;

2505 
u8
 
dr
[0];

2506 } 
__·cked
 
mlme_Çn_¿nge_ÿnûl_»q
;

2508 
__Ë16
 
vif
;

2509 
u8
 
³”_q¡a_add»ss
[
ETH_ALEN
];

2510 
__Ë16
 
£qu’û_numb”
;

2511 
__Ë16
 
u£r_´iÜ™y
;

2512 
__Ë16
 
»asÚ
;

2513 
__Ë16
 
dœeùiÚ
;

2514 
__Ë32
 
¥¬e_1
;

2515 
__Ë32
 
¥¬e_2
;

2516 
__Ë32
 
¥¬e_3
;

2517 
u8
 
dr
[0];

2518 } 
__·cked
 
mlme_d–ba_»q
;

2520 
__Ë16
 
vif
;

2521 
__Ë32
 
¥¬e_1
;

2522 
__Ë32
 
¥¬e_2
;

2523 
__Ë32
 
¥¬e_3
;

2524 
u8
 
dr
[0];

2525 } 
__·cked
 
mlme_g‘_num_ª‹Âas_»q
;

2527 
__Ë16
 
vif
;

2528 
__Ë32
 
¥¬e_1
;

2529 
__Ë32
 
¥¬e_2
;

2530 
__Ë32
 
¥¬e_3
;

2531 
u8
 
dr
[0];

2532 } 
__·cked
 
mlme_¡¬t_d‘eù_»q
;

2534 
__Ë16
 
vif
;

2535 
__Ë32
 
¥¬e_1
;

2536 
__Ë32
 
¥¬e_2
;

2537 
__Ë32
 
¥¬e_3
;

2538 
u8
 
dr
[0];

2539 } 
__·cked
 
mlme_¥¬e_12_»q
;

2541 
__Ë16
 
vif
;

2542 
__Ë32
 
¥¬e_1
;

2543 
__Ë32
 
¥¬e_2
;

2544 
__Ë32
 
¥¬e_3
;

2545 
u8
 
dr
[0];

2546 } 
__·cked
 
mlme_¥¬e_13_»q
;

2548 
__Ë16
 
vif
;

2549 
__Ë16
 
wifi_to_ûÎuÏr_mode
;

2550 
__Ë16
 
rßmšg_sÿn
;

2551 
__Ë16
 
wtc_rssi_th»shŞd
;

2552 
__Ë16
 
wtc_ÿndid©e24g_rssi_th»shŞd
;

2553 
__Ë16
 
wtc_ÿndid©e5g_rssi_th»shŞd
;

2554 
__Ë16
 
wtc_ÿndid©e6g_rssi_th»shŞd
;

2555 
__Ë32
 
¥¬e_1
;

2556 
__Ë32
 
¥¬e_2
;

2557 
__Ë32
 
¥¬e_3
;

2558 
u8
 
dr
[0];

2559 } 
__·cked
 
mlme_£t_wtc_mode_»q
;

2561 
__Ë16
 
vif
;

2562 
__Ë16
 
twt_£tup_id
;

2563 
__Ë16
 
twt_ÃgÙŸtiÚ_ty³
;

2564 
__Ë16
 
twt_æow_ty³
;

2565 
__Ë16
 
twt_Œigg”_ty³
;

2566 
__Ë32
 
desœed_wake_du¿tiÚ
;

2567 
__Ë32
 
desœed_wake_š‹rv®
;

2568 
__Ë32
 
desœed_rg‘_wake_time
;

2569 
__Ë32
 
mšimum_wake_š‹rv®
;

2570 
__Ë32
 
maximum_wake_š‹rv®
;

2571 
__Ë32
 
mšimum_wake_du¿tiÚ
;

2572 
__Ë32
 
maximum_wake_du¿tiÚ
;

2573 
__Ë16
 
av”age_·ck‘_numb”
;

2574 
__Ë16
 
av”age_·ck‘_size
;

2575 
__Ë32
 
¥¬e_1
;

2576 
__Ë32
 
¥¬e_2
;

2577 
__Ë32
 
¥¬e_3
;

2578 
u8
 
dr
[0];

2579 } 
__·cked
 
mlme_twt_£tup_»q
;

2581 
__Ë16
 
vif
;

2582 
__Ë16
 
twt_£tup_id
;

2583 
__Ë16
 
twt_ÃgÙŸtiÚ_ty³
;

2584 
__Ë32
 
¥¬e_1
;

2585 
__Ë32
 
¥¬e_2
;

2586 
__Ë32
 
¥¬e_3
;

2587 
u8
 
dr
[0];

2588 } 
__·cked
 
mlme_twt_‹¬down_»q
;

2590 
__Ë16
 
vif
;

2591 
__Ë16
 
twt_£tup_id
;

2592 
__Ë32
 
twt_su¥’d_du¿tiÚ
;

2593 
__Ë32
 
¥¬e_1
;

2594 
__Ë32
 
¥¬e_2
;

2595 
__Ë32
 
¥¬e_3
;

2596 
u8
 
dr
[0];

2597 } 
__·cked
 
mlme_twt_su¥’d_»q
;

2599 
__Ë16
 
vif
;

2600 
__Ë16
 
twt_£tup_id
;

2601 
__Ë32
 
¥¬e_1
;

2602 
__Ë32
 
¥¬e_2
;

2603 
__Ë32
 
¥¬e_3
;

2604 
u8
 
dr
[0];

2605 } 
__·cked
 
mlme_twt_¡©us_qu”y_»q
;

2607 
__Ë16
 
vif
;

2608 
__Ë16
 
·ck‘s_th»shŞd
;

2609 
__Ë16
 
ps_pha£
;

2610 
__Ë16
 
m—su»m’t_du¿tiÚ
;

2611 
__Ë16
 
di§bË_ps_w™h_cÚÃùed_¡a
;

2612 
__Ë32
 
¥¬e_1
;

2613 
__Ë32
 
¥¬e_2
;

2614 
__Ë32
 
¥¬e_3
;

2615 
u8
 
dr
[0];

2616 } 
__·cked
 
mlme_­_½s_·¿ms_»q
;

2618 
__Ë16
 
vif
;

2619 
__Ë16
 
½s_¡©e
;

2620 
__Ë32
 
¥¬e_1
;

2621 
__Ë32
 
¥¬e_2
;

2622 
__Ë32
 
¥¬e_3
;

2623 
u8
 
dr
[0];

2624 } 
__·cked
 
mlme_­_½s_»q
;

2626 
__Ë16
 
vif
;

2627 
__Ë16
 
tx_pow”
;

2628 
__Ë32
 
¥¬e_1
;

2629 
__Ë32
 
¥¬e_2
;

2630 
__Ë32
 
¥¬e_3
;

2631 
u8
 
dr
[0];

2632 } 
__·cked
 
mlme_£t_­_tx_pow”_»q
;

2634 
__Ë16
 
vif
;

2635 
__Ë32
 
¥¬e_1
;

2636 
__Ë32
 
¥¬e_2
;

2637 
__Ë32
 
¥¬e_3
;

2638 
u8
 
dr
[0];

2639 } 
__·cked
 
mlme_g‘_­_tx_pow”_»q
;

2641 
__Ë16
 
vif
;

2642 
__Ë32
 
¥¬e_1
;

2643 
__Ë32
 
¥¬e_2
;

2644 
__Ë32
 
¥¬e_3
;

2645 
u8
 
dr
[0];

2646 } 
__·cked
 
mlme_¥¬e_sigÇl_1_»q
;

2648 
__Ë16
 
vif
;

2649 
__Ë32
 
¥¬e_1
;

2650 
__Ë32
 
¥¬e_2
;

2651 
__Ë32
 
¥¬e_3
;

2652 
u8
 
dr
[0];

2653 } 
__·cked
 
mlme_¥¬e_sigÇl_2_»q
;

2655 
__Ë16
 
vif
;

2656 
__Ë32
 
¥¬e_1
;

2657 
__Ë32
 
¥¬e_2
;

2658 
__Ë32
 
¥¬e_3
;

2659 
u8
 
dr
[0];

2660 } 
__·cked
 
mlme_¥¬e_sigÇl_3_»q
;

2662 
__Ë16
 
vif
;

2663 
__Ë32
 
time¡amp
;

2664 
__Ë32
 
¥¬e_1
;

2665 
__Ë32
 
¥¬e_2
;

2666 
__Ë32
 
¥¬e_3
;

2667 
u8
 
dr
[0];

2668 } 
__·cked
 
mlme_g‘_cfm
;

2670 
__Ë16
 
vif
;

2671 
__Ë32
 
time¡amp
;

2672 
__Ë32
 
¥¬e_1
;

2673 
__Ë32
 
¥¬e_2
;

2674 
__Ë32
 
¥¬e_3
;

2675 
u8
 
dr
[0];

2676 } 
__·cked
 
mlme_£t_cfm
;

2678 
__Ë16
 
vif
;

2679 
__Ë16
 
»suÉ_code
;

2680 
__Ë32
 
time¡amp
;

2681 
__Ë32
 
¥¬e_1
;

2682 
__Ë32
 
¥¬e_2
;

2683 
__Ë32
 
¥¬e_3
;

2684 
u8
 
dr
[0];

2685 } 
__·cked
 
mlme_pow”mgt_cfm
;

2687 
__Ë16
 
vif
;

2688 
__Ë16
 
»suÉ_code
;

2689 
__Ë32
 
time¡amp
;

2690 
__Ë32
 
¥¬e_1
;

2691 
__Ë32
 
¥¬e_2
;

2692 
__Ë32
 
¥¬e_3
;

2693 
u8
 
dr
[0];

2694 } 
__·cked
 
mlme_add_šfo_–em’ts_cfm
;

2696 
__Ë16
 
vif
;

2697 
__Ë16
 
»suÉ_code
;

2698 
__Ë16
 
sÿn_id
;

2699 
__Ë32
 
time¡amp
;

2700 
__Ë32
 
¥¬e_1
;

2701 
__Ë32
 
¥¬e_2
;

2702 
__Ë32
 
¥¬e_3
;

2703 
u8
 
dr
[0];

2704 } 
__·cked
 
mlme_add_sÿn_cfm
;

2706 
__Ë16
 
vif
;

2707 
__Ë16
 
»suÉ_code
;

2708 
__Ë16
 
sÿn_id
;

2709 
__Ë32
 
time¡amp
;

2710 
__Ë32
 
¥¬e_1
;

2711 
__Ë32
 
¥¬e_2
;

2712 
__Ë32
 
¥¬e_3
;

2713 
u8
 
dr
[0];

2714 } 
__·cked
 
mlme_d–_sÿn_cfm
;

2716 
__Ë16
 
vif
;

2717 
__Ë16
 
»suÉ_code
;

2718 
__Ë32
 
time¡amp
;

2719 
__Ë32
 
¥¬e_1
;

2720 
__Ë32
 
¥¬e_2
;

2721 
__Ë32
 
¥¬e_3
;

2722 
u8
 
dr
[0];

2723 } 
__·cked
 
mlme_add_vif_cfm
;

2725 
__Ë16
 
vif
;

2726 
__Ë16
 
»suÉ_code
;

2727 
__Ë32
 
time¡amp
;

2728 
__Ë32
 
¥¬e_1
;

2729 
__Ë32
 
¥¬e_2
;

2730 
__Ë32
 
¥¬e_3
;

2731 
u8
 
dr
[0];

2732 } 
__·cked
 
mlme_d–_vif_cfm
;

2734 
__Ë16
 
vif
;

2735 
__Ë16
 
»suÉ_code
;

2736 
__Ë32
 
time¡amp
;

2737 
__Ë32
 
¥¬e_1
;

2738 
__Ë32
 
¥¬e_2
;

2739 
__Ë32
 
¥¬e_3
;

2740 
u8
 
dr
[0];

2741 } 
__·cked
 
mlme_¡¬t_cfm
;

2743 
__Ë16
 
vif
;

2744 
__Ë16
 
»suÉ_code
;

2745 
__Ë32
 
time¡amp
;

2746 
__Ë32
 
¥¬e_1
;

2747 
__Ë32
 
¥¬e_2
;

2748 
__Ë32
 
¥¬e_3
;

2749 
u8
 
dr
[0];

2750 } 
__·cked
 
mlme_£t_chªÃl_cfm
;

2752 
__Ë16
 
vif
;

2753 
__Ë16
 
»suÉ_code
;

2754 
__Ë32
 
time¡amp
;

2755 
__Ë32
 
¥¬e_1
;

2756 
__Ë32
 
¥¬e_2
;

2757 
__Ë32
 
¥¬e_3
;

2758 
u8
 
dr
[0];

2759 } 
__·cked
 
mlme_cÚÃù_cfm
;

2761 
__Ë16
 
vif
;

2762 
__Ë16
 
»suÉ_code
;

2763 
__Ë32
 
time¡amp
;

2764 
__Ë32
 
¥¬e_1
;

2765 
__Ë32
 
¥¬e_2
;

2766 
__Ë32
 
¥¬e_3
;

2767 
u8
 
dr
[0];

2768 } 
__·cked
 
mlme_»assocŸ‹_cfm
;

2770 
__Ë16
 
vif
;

2771 
__Ë16
 
»suÉ_code
;

2772 
__Ë32
 
time¡amp
;

2773 
__Ë32
 
¥¬e_1
;

2774 
__Ë32
 
¥¬e_2
;

2775 
__Ë32
 
¥¬e_3
;

2776 
u8
 
dr
[0];

2777 } 
__·cked
 
mlme_rßm_cfm
;

2779 
__Ë16
 
vif
;

2780 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

2781 
__Ë16
 
»suÉ_code
;

2782 
__Ë32
 
time¡amp
;

2783 
__Ë32
 
¥¬e_1
;

2784 
__Ë32
 
¥¬e_2
;

2785 
__Ë32
 
¥¬e_3
;

2786 
u8
 
dr
[0];

2787 } 
__·cked
 
mlme_discÚÃù_cfm
;

2789 
__Ë16
 
vif
;

2790 
__Ë16
 
»suÉ_code
;

2791 
__Ë32
 
time¡amp
;

2792 
__Ë32
 
¥¬e_1
;

2793 
__Ë32
 
¥¬e_2
;

2794 
__Ë32
 
¥¬e_3
;

2795 
u8
 
dr
[0];

2796 } 
__·cked
 
mlme_»gi¡”_aùiÚ_äame_cfm
;

2798 
__Ë16
 
vif
;

2799 
__Ë16
 
ho¡_g
;

2800 
__Ë16
 
»suÉ_code
;

2801 
__Ë32
 
time¡amp
;

2802 
__Ë32
 
¥¬e_1
;

2803 
__Ë32
 
¥¬e_2
;

2804 
__Ë32
 
¥¬e_3
;

2805 
u8
 
dr
[0];

2806 } 
__·cked
 
mlme_£nd_äame_cfm
;

2808 
__Ë16
 
vif
;

2809 
__Ë16
 
»suÉ_code
;

2810 
__Ë32
 
time¡amp
;

2811 
__Ë32
 
¥¬e_1
;

2812 
__Ë32
 
¥¬e_2
;

2813 
__Ë32
 
¥¬e_3
;

2814 
u8
 
dr
[0];

2815 } 
__·cked
 
mlme_»£t_dw–l_time_cfm
;

2817 
__Ë16
 
vif
;

2818 
__Ë16
 
»suÉ_code
;

2819 
__Ë32
 
time¡amp
;

2820 
__Ë32
 
¥¬e_1
;

2821 
__Ë32
 
¥¬e_2
;

2822 
__Ë32
 
¥¬e_3
;

2823 
u8
 
dr
[0];

2824 } 
__·cked
 
mlme_£t_Œaffic_·¿m‘”s_cfm
;

2826 
__Ë16
 
vif
;

2827 
__Ë16
 
»suÉ_code
;

2828 
__Ë32
 
time¡amp
;

2829 
__Ë32
 
¥¬e_1
;

2830 
__Ë32
 
¥¬e_2
;

2831 
__Ë32
 
¥¬e_3
;

2832 
u8
 
dr
[0];

2833 } 
__·cked
 
mlme_d–_Œaffic_·¿m‘”s_cfm
;

2835 
__Ë16
 
vif
;

2836 
__Ë32
 
time¡amp
;

2837 
__Ë32
 
¥¬e_1
;

2838 
__Ë32
 
¥¬e_2
;

2839 
__Ë32
 
¥¬e_3
;

2840 
u8
 
dr
[0];

2841 } 
__·cked
 
mlme_£t_·ck‘_f‹r_cfm
;

2843 
__Ë16
 
vif
;

2844 
__Ë16
 
»suÉ_code
;

2845 
__Ë32
 
time¡amp
;

2846 
__Ë32
 
¥¬e_1
;

2847 
__Ë32
 
¥¬e_2
;

2848 
__Ë32
 
¥¬e_3
;

2849 
u8
 
dr
[0];

2850 } 
__·cked
 
mlme_£t__add»ss_cfm
;

2852 
__Ë16
 
vif
;

2853 
__Ë16
 
»suÉ_code
;

2854 
__Ë32
 
time¡amp
;

2855 
__Ë32
 
¥¬e_1
;

2856 
__Ë32
 
¥¬e_2
;

2857 
__Ë32
 
¥¬e_3
;

2858 
u8
 
dr
[0];

2859 } 
__·cked
 
mlme_£t_aş_cfm
;

2861 
__Ë16
 
vif
;

2862 
__Ë16
 
»suÉ_code
;

2863 
__Ë32
 
time¡amp
;

2864 
__Ë32
 
¥¬e_1
;

2865 
__Ë32
 
¥¬e_2
;

2866 
__Ë32
 
¥¬e_3
;

2867 
u8
 
dr
[0];

2868 } 
__·cked
 
mlme_£tkeys_cfm
;

2870 
__Ë16
 
vif
;

2871 
__Ë16
 
£qu’û_numb”
[8];

2872 
__Ë16
 
»suÉ_code
;

2873 
__Ë32
 
time¡amp
;

2874 
__Ë32
 
¥¬e_1
;

2875 
__Ë32
 
¥¬e_2
;

2876 
__Ë32
 
¥¬e_3
;

2877 
u8
 
dr
[0];

2878 } 
__·cked
 
mlme_g‘_key_£qu’û_cfm
;

2880 
__Ë16
 
vif
;

2881 
__Ë16
 
»suÉ_code
;

2882 
__Ë32
 
time¡amp
;

2883 
__Ë32
 
¥¬e_1
;

2884 
__Ë32
 
¥¬e_2
;

2885 
__Ë32
 
¥¬e_3
;

2886 
u8
 
dr
[0];

2887 } 
__·cked
 
mlme_£t_ÿched_chªÃls_cfm
;

2889 
__Ë16
 
vif
;

2890 
__Ë16
 
»suÉ_code
;

2891 
__Ë32
 
time¡amp
;

2892 
__Ë32
 
¥¬e_1
;

2893 
__Ë32
 
¥¬e_2
;

2894 
__Ë32
 
¥¬e_3
;

2895 
u8
 
dr
[0];

2896 } 
__·cked
 
mlme_£t_wh™–i¡_ssid_cfm
;

2898 
__Ë16
 
vif
;

2899 
__Ë16
 
»suÉ_code
;

2900 
__Ë32
 
time¡amp
;

2901 
__Ë32
 
¥¬e_1
;

2902 
__Ë32
 
¥¬e_2
;

2903 
__Ë32
 
¥¬e_3
;

2904 
u8
 
dr
[0];

2905 } 
__·cked
 
mlme_tdls_aùiÚ_cfm
;

2907 
__Ë16
 
vif
;

2908 
__Ë16
 
»suÉ_code
;

2909 
__Ë32
 
time¡amp
;

2910 
__Ë32
 
¥¬e_1
;

2911 
__Ë32
 
¥¬e_2
;

2912 
__Ë32
 
¥¬e_3
;

2913 
u8
 
dr
[0];

2914 } 
__·cked
 
mlme_chªÃl_sw™ch_cfm
;

2916 
__Ë16
 
vif
;

2917 
__Ë16
 
»suÉ_code
;

2918 
__Ë32
 
time¡amp
;

2919 
__Ë32
 
¥¬e_1
;

2920 
__Ë32
 
¥¬e_2
;

2921 
__Ë32
 
¥¬e_3
;

2922 
u8
 
dr
[0];

2923 } 
__·cked
 
mlme_mÚ™Ü_rssi_cfm
;

2925 
__Ë16
 
vif
;

2926 
__Ë16
 
»suÉ_code
;

2927 
__Ë32
 
time¡amp
;

2928 
__Ë32
 
¥¬e_1
;

2929 
__Ë32
 
¥¬e_2
;

2930 
__Ë32
 
¥¬e_3
;

2931 
u8
 
dr
[0];

2932 } 
__·cked
 
mlme_¡¬t_lšk_¡©i¡ics_cfm
;

2934 
__Ë16
 
vif
;

2935 
__Ë16
 
»suÉ_code
;

2936 
__Ë32
 
time¡amp
;

2937 
__Ë32
 
¥¬e_1
;

2938 
__Ë32
 
¥¬e_2
;

2939 
__Ë32
 
¥¬e_3
;

2940 
u8
 
dr
[0];

2941 } 
__·cked
 
mlme_¡İ_lšk_¡©i¡ics_cfm
;

2943 
__Ë16
 
vif
;

2944 
__Ë16
 
»suÉ_code
;

2945 
__Ë32
 
time¡amp
;

2946 
__Ë32
 
¥¬e_1
;

2947 
__Ë32
 
¥¬e_2
;

2948 
__Ë32
 
¥¬e_3
;

2949 
u8
 
dr
[0];

2950 } 
__·cked
 
mlme_ho¡_¡©e_cfm
;

2952 
__Ë16
 
vif
;

2953 
__Ë16
 
»suÉ_code
;

2954 
__Ë16
 
¹t_id
;

2955 
__Ë32
 
time¡amp
;

2956 
__Ë32
 
¥¬e_1
;

2957 
__Ë32
 
¥¬e_2
;

2958 
__Ë32
 
¥¬e_3
;

2959 
u8
 
dr
[0];

2960 } 
__·cked
 
mlme_add_¿nge_cfm
;

2962 
__Ë16
 
vif
;

2963 
__Ë16
 
»suÉ_code
;

2964 
__Ë16
 
¹t_id
;

2965 
__Ë32
 
time¡amp
;

2966 
__Ë32
 
¥¬e_1
;

2967 
__Ë32
 
¥¬e_2
;

2968 
__Ë32
 
¥¬e_3
;

2969 
u8
 
dr
[0];

2970 } 
__·cked
 
mlme_d–_¿nge_cfm
;

2972 
__Ë16
 
vif
;

2973 
__Ë16
 
»suÉ_code
;

2974 
__Ë32
 
time¡amp
;

2975 
__Ë32
 
¥¬e_1
;

2976 
__Ë32
 
¥¬e_2
;

2977 
__Ë32
 
¥¬e_3
;

2978 
u8
 
dr
[0];

2979 } 
__·cked
 
mlme_£t_nß_cfm
;

2981 
__Ë16
 
vif
;

2982 
__Ë16
 
»suÉ_code
;

2983 
__Ë32
 
time¡amp
;

2984 
__Ë32
 
¥¬e_1
;

2985 
__Ë32
 
¥¬e_2
;

2986 
__Ë32
 
¥¬e_3
;

2987 
u8
 
dr
[0];

2988 } 
__·cked
 
mlme_£t_ùwšdow_cfm
;

2990 
__Ë16
 
vif
;

2991 
__Ë16
 
»suÉ_code
;

2992 
__Ë32
 
time¡amp
;

2993 
__Ë32
 
¥¬e_1
;

2994 
__Ë32
 
¥¬e_2
;

2995 
__Ë32
 
¥¬e_3
;

2996 
u8
 
dr
[0];

2997 } 
__·cked
 
mlme_Çn_¡¬t_cfm
;

2999 
__Ë16
 
vif
;

3000 
__Ë16
 
»suÉ_code
;

3001 
__Ë32
 
time¡amp
;

3002 
__Ë32
 
¥¬e_1
;

3003 
__Ë32
 
¥¬e_2
;

3004 
__Ë32
 
¥¬e_3
;

3005 
u8
 
dr
[0];

3006 } 
__·cked
 
mlme_Çn_cÚfig_cfm
;

3008 
__Ë16
 
vif
;

3009 
__Ë16
 
»suÉ_code
;

3010 
__Ë32
 
time¡amp
;

3011 
__Ë32
 
¥¬e_1
;

3012 
__Ë32
 
¥¬e_2
;

3013 
__Ë32
 
¥¬e_3
;

3014 
u8
 
dr
[0];

3015 } 
__·cked
 
mlme_Çn_publish_cfm
;

3017 
__Ë16
 
vif
;

3018 
__Ë16
 
»suÉ_code
;

3019 
__Ë32
 
time¡amp
;

3020 
__Ë32
 
¥¬e_1
;

3021 
__Ë32
 
¥¬e_2
;

3022 
__Ë32
 
¥¬e_3
;

3023 
u8
 
dr
[0];

3024 } 
__·cked
 
mlme_Çn_subsüibe_cfm
;

3026 
__Ë16
 
vif
;

3027 
__Ë16
 
»suÉ_code
;

3028 
__Ë32
 
time¡amp
;

3029 
__Ë32
 
¥¬e_1
;

3030 
__Ë32
 
¥¬e_2
;

3031 
__Ë32
 
¥¬e_3
;

3032 
u8
 
dr
[0];

3033 } 
__·cked
 
mlme_Çn_fŞlowup_cfm
;

3035 
__Ë16
 
vif
;

3036 
__Ë16
 
»suÉ_code
;

3037 
__Ë32
 
time¡amp
;

3038 
__Ë32
 
¥¬e_1
;

3039 
__Ë32
 
¥¬e_2
;

3040 
__Ë32
 
¥¬e_3
;

3041 
u8
 
dr
[0];

3042 } 
__·cked
 
mlme_un£t_chªÃl_cfm
;

3044 
__Ë16
 
vif
;

3045 
__Ë16
 
»suÉ_code
;

3046 
__Ë32
 
time¡amp
;

3047 
__Ë32
 
¥¬e_1
;

3048 
__Ë32
 
¥¬e_2
;

3049 
__Ë32
 
¥¬e_3
;

3050 
u8
 
dr
[0];

3051 } 
__·cked
 
mlme_£t_couÁry_cfm
;

3053 
__Ë16
 
vif
;

3054 
__Ë16
 
»suÉ_code
;

3055 
__Ë32
 
time¡amp
;

3056 
__Ë32
 
¥¬e_1
;

3057 
__Ë32
 
¥¬e_2
;

3058 
__Ë32
 
¥¬e_3
;

3059 
u8
 
dr
[0];

3060 } 
__·cked
 
mlme_fÜw¬d_b—cÚ_cfm
;

3062 
__Ë16
 
vif
;

3063 
__Ë16
 
»suÉ_code
;

3064 
__Ë32
 
time¡amp
;

3065 
__Ë32
 
¥¬e_1
;

3066 
__Ë32
 
¥¬e_2
;

3067 
__Ë32
 
¥¬e_3
;

3068 
u8
 
dr
[0];

3069 } 
__·cked
 
mlme_ndp_»que¡_cfm
;

3071 
__Ë16
 
vif
;

3072 
__Ë16
 
»suÉ_code
;

3073 
__Ë32
 
time¡amp
;

3074 
__Ë32
 
¥¬e_1
;

3075 
__Ë32
 
¥¬e_2
;

3076 
__Ë32
 
¥¬e_3
;

3077 
u8
 
dr
[0];

3078 } 
__·cked
 
mlme_ndp_»¥Ú£_cfm
;

3080 
__Ë16
 
vif
;

3081 
__Ë16
 
»suÉ_code
;

3082 
__Ë32
 
time¡amp
;

3083 
__Ë32
 
¥¬e_1
;

3084 
__Ë32
 
¥¬e_2
;

3085 
__Ë32
 
¥¬e_3
;

3086 
u8
 
dr
[0];

3087 } 
__·cked
 
mlme_ndp_‹rmš©e_cfm
;

3089 
__Ë16
 
vif
;

3090 
__Ë16
 
»suÉ_code
;

3091 
__Ë32
 
time¡amp
;

3092 
__Ë32
 
¥¬e_1
;

3093 
__Ë32
 
¥¬e_2
;

3094 
__Ë32
 
¥¬e_3
;

3095 
u8
 
dr
[0];

3096 } 
__·cked
 
mlme_rßmšg_chªÃl_li¡_cfm
;

3098 
__Ë16
 
vif
;

3099 
__Ë16
 
»suÉ_code
;

3100 
__Ë32
 
time¡amp
;

3101 
__Ë32
 
¥¬e_1
;

3102 
__Ë32
 
¥¬e_2
;

3103 
__Ë32
 
¥¬e_3
;

3104 
u8
 
dr
[0];

3105 } 
__·cked
 
mlme_£t_bss_max_chªÃl_width_cfm
;

3107 
__Ë16
 
vif
;

3108 
__Ë16
 
»suÉ_code
;

3109 
__Ë32
 
time¡amp
;

3110 
__Ë32
 
¥¬e_1
;

3111 
__Ë32
 
¥¬e_2
;

3112 
__Ë32
 
¥¬e_3
;

3113 
u8
 
dr
[0];

3114 } 
__·cked
 
mlme_£t_sÿn_mode_cfm
;

3116 
__Ë16
 
vif
;

3117 
__Ë16
 
»suÉ_code
;

3118 
__Ë32
 
time¡amp
;

3119 
__Ë32
 
¥¬e_1
;

3120 
__Ë32
 
¥¬e_2
;

3121 
__Ë32
 
¥¬e_3
;

3122 
u8
 
dr
[0];

3123 } 
__·cked
 
mlme_š¡®l_­f_cfm
;

3125 
__Ë16
 
vif
;

3126 
__Ë16
 
»suÉ_code
;

3127 
__Ë32
 
time¡amp
;

3128 
__Ë32
 
¥¬e_1
;

3129 
__Ë32
 
¥¬e_2
;

3130 
__Ë32
 
¥¬e_3
;

3131 
u8
 
dr
[0];

3132 } 
__·cked
 
mlme_»ad_­f_cfm
;

3134 
__Ë16
 
vif
;

3135 
__Ë16
 
»suÉ_code
;

3136 
__Ë32
 
time¡amp
;

3137 
__Ë32
 
¥¬e_1
;

3138 
__Ë32
 
¥¬e_2
;

3139 
__Ë32
 
¥¬e_3
;

3140 
u8
 
dr
[0];

3141 } 
__·cked
 
mlme_£t_num_ª‹Âas_cfm
;

3143 
__Ë16
 
vif
;

3144 
__Ë16
 
»suÉ_code
;

3145 
__Ë32
 
time¡amp
;

3146 
__Ë32
 
¥¬e_1
;

3147 
__Ë32
 
¥¬e_2
;

3148 
__Ë32
 
¥¬e_3
;

3149 
u8
 
dr
[0];

3150 } 
__·cked
 
mlme_¬p_d‘eù_cfm
;

3152 
__Ë16
 
vif
;

3153 
__Ë16
 
»suÉ_code
;

3154 
__Ë32
 
time¡amp
;

3155 
__Ë32
 
¥¬e_1
;

3156 
__Ë32
 
¥¬e_2
;

3157 
__Ë32
 
¥¬e_3
;

3158 
u8
 
dr
[0];

3159 } 
__·cked
 
mlme_£t_rßmšg_ty³_cfm
;

3161 
__Ë16
 
vif
;

3162 
__Ë16
 
»suÉ_code
;

3163 
__Ë32
 
time¡amp
;

3164 
__Ë32
 
¥¬e_1
;

3165 
__Ë32
 
¥¬e_2
;

3166 
__Ë32
 
¥¬e_3
;

3167 
u8
 
dr
[0];

3168 } 
__·cked
 
mlme_£t_bªd_cfm
;

3170 
__Ë16
 
vif
;

3171 
__Ë16
 
»suÉ_code
;

3172 
__Ë32
 
time¡amp
;

3173 
__Ë32
 
¥¬e_1
;

3174 
__Ë32
 
¥¬e_2
;

3175 
__Ë32
 
¥¬e_3
;

3176 
u8
 
dr
[0];

3177 } 
__·cked
 
mlme_£t_rßmšg_·¿m‘”s_cfm
;

3179 
__Ë16
 
vif
;

3180 
__Ë16
 
»suÉ_code
;

3181 
__Ë32
 
time¡amp
;

3182 
__Ë32
 
¥¬e_1
;

3183 
__Ë32
 
¥¬e_2
;

3184 
__Ë32
 
¥¬e_3
;

3185 
u8
 
dr
[0];

3186 } 
__·cked
 
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
;

3188 
__Ë16
 
vif
;

3189 
__Ë16
 
»suÉ_code
;

3190 
__Ë32
 
time¡amp
;

3191 
__Ë32
 
¥¬e_1
;

3192 
__Ë32
 
¥¬e_2
;

3193 
__Ë32
 
¥¬e_3
;

3194 
u8
 
dr
[0];

3195 } 
__·cked
 
mlme_rßmšg_¡©e_cfm
;

3197 
__Ë16
 
vif
;

3198 
__Ë16
 
»suÉ_code
;

3199 
__Ë32
 
time¡amp
;

3200 
__Ë32
 
¥¬e_1
;

3201 
__Ë32
 
¥¬e_2
;

3202 
__Ë32
 
¥¬e_3
;

3203 
u8
 
dr
[0];

3204 } 
__·cked
 
mlme_¥¬e_8_cfm
;

3206 
__Ë16
 
vif
;

3207 
__Ë16
 
»suÉ_code
;

3208 
__Ë32
 
time¡amp
;

3209 
__Ë32
 
¥¬e_1
;

3210 
__Ë32
 
¥¬e_2
;

3211 
__Ë32
 
¥¬e_3
;

3212 
u8
 
dr
[0];

3213 } 
__·cked
 
mlme_cÚfigu»_mÚ™Ü_mode_cfm
;

3215 
__Ë16
 
vif
;

3216 
__Ë16
 
»suÉ_code
;

3217 
__Ë32
 
time¡amp
;

3218 
__Ë32
 
¥¬e_1
;

3219 
__Ë32
 
¥¬e_2
;

3220 
__Ë32
 
¥¬e_3
;

3221 
u8
 
dr
[0];

3222 } 
__·cked
 
mlme_¥¬e_9_cfm
;

3224 
__Ë16
 
vif
;

3225 
__Ë16
 
»suÉ_code
;

3226 
__Ë32
 
time¡amp
;

3227 
__Ë32
 
¥¬e_1
;

3228 
__Ë32
 
¥¬e_2
;

3229 
__Ë32
 
¥¬e_3
;

3230 
u8
 
dr
[0];

3231 } 
__·cked
 
mlme_¥¬e_10_cfm
;

3233 
__Ë16
 
vif
;

3234 
__Ë16
 
»suÉ_code
;

3235 
__Ë32
 
time¡amp
;

3236 
__Ë32
 
¥¬e_1
;

3237 
__Ë32
 
¥¬e_2
;

3238 
__Ë32
 
¥¬e_3
;

3239 
u8
 
dr
[0];

3240 } 
__·cked
 
mlme_¥¬e_11_cfm
;

3242 
__Ë16
 
vif
;

3243 
__Ë16
 
»suÉ_code
;

3244 
__Ë32
 
time¡amp
;

3245 
__Ë32
 
¥¬e_1
;

3246 
__Ë32
 
¥¬e_2
;

3247 
__Ë32
 
¥¬e_3
;

3248 
u8
 
dr
[0];

3249 } 
__·cked
 
mlme_Çn_¿nge_cfm
;

3251 
__Ë16
 
vif
;

3252 
__Ë16
 
»suÉ_code
;

3253 
__Ë32
 
time¡amp
;

3254 
__Ë32
 
¥¬e_1
;

3255 
__Ë32
 
¥¬e_2
;

3256 
__Ë32
 
¥¬e_3
;

3257 
u8
 
dr
[0];

3258 } 
__·cked
 
mlme_Çn_¿nge_ÿnûl_cfm
;

3260 
__Ë16
 
vif
;

3261 
__Ë16
 
»suÉ_code
;

3262 
__Ë32
 
time¡amp
;

3263 
__Ë32
 
¥¬e_1
;

3264 
__Ë32
 
¥¬e_2
;

3265 
__Ë32
 
¥¬e_3
;

3266 
u8
 
dr
[0];

3267 } 
__·cked
 
mlme_d–ba_cfm
;

3269 
__Ë16
 
vif
;

3270 
__Ë16
 
»suÉ_code
;

3271 
__Ë16
 
numb”_of_ª‹Âas
;

3272 
__Ë32
 
time¡amp
;

3273 
__Ë32
 
¥¬e_1
;

3274 
__Ë32
 
¥¬e_2
;

3275 
__Ë32
 
¥¬e_3
;

3276 
u8
 
dr
[0];

3277 } 
__·cked
 
mlme_g‘_num_ª‹Âas_cfm
;

3279 
__Ë16
 
vif
;

3280 
__Ë16
 
»suÉ_code
;

3281 
__Ë32
 
time¡amp
;

3282 
__Ë32
 
¥¬e_1
;

3283 
__Ë32
 
¥¬e_2
;

3284 
__Ë32
 
¥¬e_3
;

3285 
u8
 
dr
[0];

3286 } 
__·cked
 
mlme_¡¬t_d‘eù_cfm
;

3288 
__Ë16
 
vif
;

3289 
__Ë16
 
»suÉ_code
;

3290 
__Ë32
 
time¡amp
;

3291 
__Ë32
 
¥¬e_1
;

3292 
__Ë32
 
¥¬e_2
;

3293 
__Ë32
 
¥¬e_3
;

3294 
u8
 
dr
[0];

3295 } 
__·cked
 
mlme_¥¬e_12_cfm
;

3297 
__Ë16
 
vif
;

3298 
__Ë16
 
»suÉ_code
;

3299 
__Ë32
 
time¡amp
;

3300 
__Ë32
 
¥¬e_1
;

3301 
__Ë32
 
¥¬e_2
;

3302 
__Ë32
 
¥¬e_3
;

3303 
u8
 
dr
[0];

3304 } 
__·cked
 
mlme_¥¬e_13_cfm
;

3306 
__Ë16
 
vif
;

3307 
__Ë16
 
»suÉ_code
;

3308 
__Ë32
 
time¡amp
;

3309 
__Ë32
 
¥¬e_1
;

3310 
__Ë32
 
¥¬e_2
;

3311 
__Ë32
 
¥¬e_3
;

3312 
u8
 
dr
[0];

3313 } 
__·cked
 
mlme_£t_wtc_mode_cfm
;

3315 
__Ë16
 
vif
;

3316 
__Ë16
 
»suÉ_code
;

3317 
__Ë32
 
time¡amp
;

3318 
__Ë32
 
¥¬e_1
;

3319 
__Ë32
 
¥¬e_2
;

3320 
__Ë32
 
¥¬e_3
;

3321 
u8
 
dr
[0];

3322 } 
__·cked
 
mlme_twt_£tup_cfm
;

3324 
__Ë16
 
vif
;

3325 
__Ë16
 
»suÉ_code
;

3326 
__Ë32
 
time¡amp
;

3327 
__Ë32
 
¥¬e_1
;

3328 
__Ë32
 
¥¬e_2
;

3329 
__Ë32
 
¥¬e_3
;

3330 
u8
 
dr
[0];

3331 } 
__·cked
 
mlme_twt_‹¬down_cfm
;

3333 
__Ë16
 
vif
;

3334 
__Ë16
 
»suÉ_code
;

3335 
__Ë32
 
time¡amp
;

3336 
__Ë32
 
¥¬e_1
;

3337 
__Ë32
 
¥¬e_2
;

3338 
__Ë32
 
¥¬e_3
;

3339 
u8
 
dr
[0];

3340 } 
__·cked
 
mlme_twt_su¥’d_cfm
;

3342 
__Ë16
 
vif
;

3343 
__Ë16
 
»suÉ_code
;

3344 
__Ë16
 
twt_£tup_id
;

3345 
__Ë16
 
twt_£ssiÚ_¡©e
;

3346 
__Ë32
 
twt_wake_du¿tiÚ
;

3347 
__Ë32
 
twt_wake_š‹rv®
;

3348 
__Ë32
 
time¡amp
;

3349 
__Ë32
 
¥¬e_1
;

3350 
__Ë32
 
¥¬e_2
;

3351 
__Ë32
 
¥¬e_3
;

3352 
u8
 
dr
[0];

3353 } 
__·cked
 
mlme_twt_¡©us_qu”y_cfm
;

3355 
__Ë16
 
vif
;

3356 
__Ë16
 
»suÉ_code
;

3357 
__Ë32
 
time¡amp
;

3358 
__Ë32
 
¥¬e_1
;

3359 
__Ë32
 
¥¬e_2
;

3360 
__Ë32
 
¥¬e_3
;

3361 
u8
 
dr
[0];

3362 } 
__·cked
 
mlme_­_½s_·¿ms_cfm
;

3364 
__Ë16
 
vif
;

3365 
__Ë16
 
»suÉ_code
;

3366 
__Ë32
 
time¡amp
;

3367 
__Ë32
 
¥¬e_1
;

3368 
__Ë32
 
¥¬e_2
;

3369 
__Ë32
 
¥¬e_3
;

3370 
u8
 
dr
[0];

3371 } 
__·cked
 
mlme_­_½s_cfm
;

3373 
__Ë16
 
vif
;

3374 
__Ë16
 
»suÉ_code
;

3375 
__Ë32
 
time¡amp
;

3376 
__Ë32
 
¥¬e_1
;

3377 
__Ë32
 
¥¬e_2
;

3378 
__Ë32
 
¥¬e_3
;

3379 
u8
 
dr
[0];

3380 } 
__·cked
 
mlme_£t_­_tx_pow”_cfm
;

3382 
__Ë16
 
vif
;

3383 
__Ë16
 
»suÉ_code
;

3384 
__Ë16
 
tx_pow”
;

3385 
__Ë32
 
time¡amp
;

3386 
__Ë32
 
¥¬e_1
;

3387 
__Ë32
 
¥¬e_2
;

3388 
__Ë32
 
¥¬e_3
;

3389 
u8
 
dr
[0];

3390 } 
__·cked
 
mlme_g‘_­_tx_pow”_cfm
;

3392 
__Ë16
 
vif
;

3393 
__Ë16
 
»suÉ_code
;

3394 
__Ë32
 
¥¬e_1
;

3395 
__Ë32
 
¥¬e_2
;

3396 
__Ë32
 
¥¬e_3
;

3397 
u8
 
dr
[0];

3398 } 
__·cked
 
mlme_¥¬e_sigÇl_1_cfm
;

3400 
__Ë16
 
vif
;

3401 
__Ë16
 
»suÉ_code
;

3402 
__Ë32
 
¥¬e_1
;

3403 
__Ë32
 
¥¬e_2
;

3404 
__Ë32
 
¥¬e_3
;

3405 
u8
 
dr
[0];

3406 } 
__·cked
 
mlme_¥¬e_sigÇl_2_cfm
;

3408 
__Ë16
 
vif
;

3409 
__Ë16
 
»suÉ_code
;

3410 
__Ë32
 
¥¬e_1
;

3411 
__Ë32
 
¥¬e_2
;

3412 
__Ë32
 
¥¬e_3
;

3413 
u8
 
dr
[0];

3414 } 
__·cked
 
mlme_¥¬e_sigÇl_3_cfm
;

3416 
__Ë16
 
vif
;

3417 
__Ë32
 
¥¬e_1
;

3418 
__Ë32
 
¥¬e_2
;

3419 
__Ë32
 
¥¬e_3
;

3420 
u8
 
dr
[0];

3421 } 
__·cked
 
mlme_cÚÃù_»s
;

3423 
__Ë16
 
vif
;

3424 
__Ë16
 
æow_id
;

3425 
__Ë32
 
¥¬e_1
;

3426 
__Ë32
 
¥¬e_2
;

3427 
__Ë32
 
¥¬e_3
;

3428 
u8
 
dr
[0];

3429 } 
__·cked
 
mlme_cÚÃùed_»s
;

3431 
__Ë16
 
vif
;

3432 
__Ë32
 
¥¬e_1
;

3433 
__Ë32
 
¥¬e_2
;

3434 
__Ë32
 
¥¬e_3
;

3435 
u8
 
dr
[0];

3436 } 
__·cked
 
mlme_»assocŸ‹_»s
;

3438 
__Ë16
 
vif
;

3439 
__Ë32
 
¥¬e_1
;

3440 
__Ë32
 
¥¬e_2
;

3441 
__Ë32
 
¥¬e_3
;

3442 
u8
 
dr
[0];

3443 } 
__·cked
 
mlme_rßmed_»s
;

3445 
__Ë16
 
vif
;

3446 
__Ë16
 
»suÉ_code
;

3447 
u8
 
bssid
[
ETH_ALEN
];

3448 
__Ë32
 
¥¬e_1
;

3449 
__Ë32
 
¥¬e_2
;

3450 
__Ë32
 
¥¬e_3
;

3451 
u8
 
dr
[0];

3452 } 
__·cked
 
mlme_synchrÚi£d_»s
;

3454 
__Ë16
 
vif
;

3455 
__Ë32
 
¥¬e_1
;

3456 
__Ë32
 
¥¬e_2
;

3457 
__Ë32
 
¥¬e_3
;

3458 
u8
 
dr
[0];

3459 } 
__·cked
 
mlme_¥¬e_2_»s
;

3461 
__Ë16
 
vif
;

3462 
__Ë32
 
¥¬e_1
;

3463 
__Ë32
 
¥¬e_2
;

3464 
__Ë32
 
¥¬e_3
;

3465 
u8
 
dr
[0];

3466 } 
__·cked
 
mlme_¥¬e_3_»s
;

3468 
__Ë16
 
vif
;

3469 
__Ë32
 
¥¬e_1
;

3470 
__Ë32
 
¥¬e_2
;

3471 
__Ë32
 
¥¬e_3
;

3472 
u8
 
dr
[0];

3473 } 
__·cked
 
mlme_¥¬e_4_»s
;

3475 
__Ë16
 
vif
;

3476 
__Ë32
 
¥¬e_1
;

3477 
__Ë32
 
¥¬e_2
;

3478 
__Ë32
 
¥¬e_3
;

3479 
u8
 
dr
[0];

3480 } 
__·cked
 
mlme_¥¬e_5_»s
;

3482 
__Ë16
 
vif
;

3483 
__Ë32
 
¥¬e_1
;

3484 
__Ë32
 
¥¬e_2
;

3485 
__Ë32
 
¥¬e_3
;

3486 
u8
 
dr
[0];

3487 } 
__·cked
 
mlme_¥¬e_sigÇl_1_»s
;

3489 
__Ë16
 
vif
;

3490 
__Ë32
 
¥¬e_1
;

3491 
__Ë32
 
¥¬e_2
;

3492 
__Ë32
 
¥¬e_3
;

3493 
u8
 
dr
[0];

3494 } 
__·cked
 
mlme_¥¬e_sigÇl_2_»s
;

3496 
__Ë16
 
vif
;

3497 
__Ë32
 
¥¬e_1
;

3498 
__Ë32
 
¥¬e_2
;

3499 
__Ë32
 
¥¬e_3
;

3500 
u8
 
dr
[0];

3501 } 
__·cked
 
mlme_¥¬e_sigÇl_3_»s
;

3503 
__Ë16
 
vif
;

3504 
__Ë16
 
chªÃl_äequ’cy
;

3505 
__Ë16
 
rssi
;

3506 
__Ë16
 
sÿn_id
;

3507 
__Ë16
 
¢r
;

3508 
__Ë32
 
time¡amp
;

3509 
__Ë16
 
¥¬e_1
;

3510 
__Ë32
 
¥¬e_2
;

3511 
__Ë32
 
¥¬e_3
;

3512 
u8
 
dr
[0];

3513 } 
__·cked
 
mlme_sÿn_šd
;

3515 
__Ë16
 
vif
;

3516 
__Ë16
 
sÿn_id
;

3517 
__Ë32
 
time¡amp
;

3518 
__Ë32
 
¥¬e_1
;

3519 
__Ë32
 
¥¬e_2
;

3520 
__Ë32
 
¥¬e_3
;

3521 
u8
 
dr
[0];

3522 } 
__·cked
 
mlme_sÿn_dÚe_šd
;

3524 
__Ë16
 
vif
;

3525 
__Ë32
 
time¡amp
;

3526 
__Ë32
 
¥¬e_1
;

3527 
__Ë32
 
¥¬e_2
;

3528 
__Ë32
 
¥¬e_3
;

3529 
u8
 
dr
[0];

3530 } 
__·cked
 
mlme_li¡’_’d_šd
;

3532 
__Ë16
 
vif
;

3533 
__Ë16
 
»suÉ_code
;

3534 
__Ë16
 
æow_id
;

3535 
__Ë32
 
time¡amp
;

3536 
__Ë32
 
¥¬e_1
;

3537 
__Ë32
 
¥¬e_2
;

3538 
__Ë32
 
¥¬e_3
;

3539 
u8
 
dr
[0];

3540 } 
__·cked
 
mlme_cÚÃù_šd
;

3542 
__Ë16
 
vif
;

3543 
__Ë16
 
æow_id
;

3544 
__Ë32
 
time¡amp
;

3545 
__Ë32
 
¥¬e_1
;

3546 
__Ë32
 
¥¬e_2
;

3547 
__Ë32
 
¥¬e_3
;

3548 
u8
 
dr
[0];

3549 } 
__·cked
 
mlme_cÚÃùed_šd
;

3551 
__Ë16
 
vif
;

3552 
__Ë16
 
»suÉ_code
;

3553 
__Ë32
 
time¡amp
;

3554 
__Ë32
 
¥¬e_1
;

3555 
__Ë32
 
¥¬e_2
;

3556 
__Ë32
 
¥¬e_3
;

3557 
u8
 
dr
[0];

3558 } 
__·cked
 
mlme_»assocŸ‹_šd
;

3560 
__Ë16
 
vif
;

3561 
__Ë16
 
»suÉ_code
;

3562 
__Ë16
 
æow_id
;

3563 
__Ë32
 
time¡amp
;

3564 
__Ë32
 
¥¬e_1
;

3565 
__Ë32
 
¥¬e_2
;

3566 
__Ë32
 
¥¬e_3
;

3567 
u8
 
dr
[0];

3568 } 
__·cked
 
mlme_rßm_šd
;

3570 
__Ë16
 
vif
;

3571 
__Ë16
 
‹mpÜ®_keys_»quœed
;

3572 
__Ë16
 
æow_id
;

3573 
__Ë32
 
time¡amp
;

3574 
__Ë32
 
¥¬e_1
;

3575 
__Ë32
 
¥¬e_2
;

3576 
__Ë32
 
¥¬e_3
;

3577 
u8
 
dr
[0];

3578 } 
__·cked
 
mlme_rßmed_šd
;

3580 
__Ë16
 
vif
;

3581 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3582 
__Ë16
 
»asÚ_code
;

3583 
__Ë32
 
time¡amp
;

3584 
__Ë32
 
¥¬e_1
;

3585 
__Ë32
 
¥¬e_2
;

3586 
__Ë32
 
¥¬e_3
;

3587 
u8
 
dr
[0];

3588 } 
__·cked
 
mlme_discÚÃùed_šd
;

3590 
__Ë16
 
vif
;

3591 
__Ë16
 
´oûdu»_ty³
;

3592 
__Ë16
 
æow_id
;

3593 
__Ë32
 
time¡amp
;

3594 
__Ë32
 
¥¬e_1
;

3595 
__Ë32
 
¥¬e_2
;

3596 
__Ë32
 
¥¬e_3
;

3597 
u8
 
dr
[0];

3598 } 
__·cked
 
mlme_´oûdu»_¡¬‹d_šd
;

3600 
__Ë16
 
vif
;

3601 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3602 
__Ë16
 
key_ty³
;

3603 
__Ë16
 
key_id
;

3604 
__Ë16
 
£qu’û_numb”
[8];

3605 
__Ë32
 
time¡amp
;

3606 
__Ë32
 
¥¬e_1
;

3607 
__Ë32
 
¥¬e_2
;

3608 
__Ë32
 
¥¬e_3
;

3609 
u8
 
dr
[0];

3610 } 
__·cked
 
mlme_mic_çu»_šd
;

3612 
__Ë16
 
vif
;

3613 
__Ë16
 
ho¡_g
;

3614 
__Ë16
 
ŒªsmissiÚ_¡©us
;

3615 
__Ë32
 
time¡amp
;

3616 
__Ë32
 
¥¬e_1
;

3617 
__Ë32
 
¥¬e_2
;

3618 
__Ë32
 
¥¬e_3
;

3619 
u8
 
dr
[0];

3620 } 
__·cked
 
mlme_äame_ŒªsmissiÚ_šd
;

3622 
__Ë16
 
vif
;

3623 
__Ë16
 
d©a_un™_desütÜ
;

3624 
__Ë16
 
chªÃl_äequ’cy
;

3625 
__Ë16
 
£qu’û_numb”
;

3626 
__Ë16
 
u£r_´iÜ™y
;

3627 
__Ë32
 
time¡amp
;

3628 
__Ë32
 
¥¬e_1
;

3629 
__Ë32
 
¥¬e_2
;

3630 
__Ë32
 
¥¬e_3
;

3631 
u8
 
dr
[0];

3632 } 
__·cked
 
mlme_»ûived_äame_šd
;

3634 
__Ë16
 
vif
;

3635 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3636 
__Ë16
 
æow_id
;

3637 
__Ë16
 
tdls_ev’t
;

3638 
__Ë16
 
»asÚ_code
;

3639 
__Ë32
 
time¡amp
;

3640 
__Ë32
 
¥¬e_1
;

3641 
__Ë32
 
¥¬e_2
;

3642 
__Ë32
 
¥¬e_3
;

3643 
u8
 
dr
[0];

3644 } 
__·cked
 
mlme_tdls_³”_šd
;

3646 
__Ë16
 
vif
;

3647 
u8
 
bssid
[
ETH_ALEN
];

3648 
__Ë16
 
rssi
;

3649 
__Ë32
 
time¡amp
;

3650 
__Ë32
 
¥¬e_1
;

3651 
__Ë32
 
¥¬e_2
;

3652 
__Ë32
 
¥¬e_3
;

3653 
u8
 
dr
[0];

3654 } 
__·cked
 
mlme_rssi_»pÜt_šd
;

3656 
__Ë16
 
vif
;

3657 
__Ë16
 
ac_´iÜ™y
;

3658 
__Ë32
 
time¡amp
;

3659 
__Ë32
 
¥¬e_1
;

3660 
__Ë32
 
¥¬e_2
;

3661 
__Ë32
 
¥¬e_3
;

3662 
u8
 
dr
[0];

3663 } 
__·cked
 
mlme_ac_´iÜ™y_upd©e_šd
;

3665 
__Ë16
 
vif
;

3666 
__Ë16
 
¹t_id
;

3667 
__Ë16
 
’Œ›s
;

3668 
__Ë32
 
time¡amp
;

3669 
__Ë32
 
¥¬e_1
;

3670 
__Ë32
 
¥¬e_2
;

3671 
__Ë32
 
¥¬e_3
;

3672 
u8
 
dr
[0];

3673 } 
__·cked
 
mlme_¿nge_šd
;

3675 
__Ë16
 
vif
;

3676 
__Ë16
 
¹t_id
;

3677 
__Ë32
 
time¡amp
;

3678 
__Ë32
 
¥¬e_1
;

3679 
__Ë32
 
¥¬e_2
;

3680 
__Ë32
 
¥¬e_3
;

3681 
u8
 
dr
[0];

3682 } 
__·cked
 
mlme_¿nge_dÚe_šd
;

3684 
__Ë16
 
vif
;

3685 
__Ë16
 
ev’t
;

3686 
u8
 
fw_tsf
[8];

3687 
__Ë32
 
time¡amp
;

3688 
__Ë32
 
¥¬e_1
;

3689 
__Ë32
 
¥¬e_2
;

3690 
__Ë32
 
¥¬e_3
;

3691 
u8
 
dr
[0];

3692 } 
__·cked
 
mlme_ev’t_log_šd
;

3694 
__Ë16
 
vif
;

3695 
__Ë16
 
ev’t
;

3696 
__Ë16
 
id’tif›r
;

3697 
u8
 
add»ss_Ü_id’tif›r
[
ETH_ALEN
];

3698 
__Ë16
 
»asÚ_code
;

3699 
__Ë32
 
time¡amp
;

3700 
__Ë32
 
¥¬e_1
;

3701 
__Ë32
 
¥¬e_2
;

3702 
__Ë32
 
¥¬e_3
;

3703 
u8
 
dr
[0];

3704 } 
__·cked
 
mlme_Çn_ev’t_šd
;

3706 
__Ë16
 
vif
;

3707 
__Ë16
 
£ssiÚ_id
;

3708 
__Ë16
 
m©ch_id
;

3709 
__Ë32
 
time¡amp
;

3710 
__Ë32
 
¥¬e_1
;

3711 
__Ë32
 
¥¬e_2
;

3712 
__Ë32
 
¥¬e_3
;

3713 
u8
 
dr
[0];

3714 } 
__·cked
 
mlme_Çn_£rviû_šd
;

3716 
__Ë16
 
vif
;

3717 
__Ë16
 
£ssiÚ_id
;

3718 
__Ë16
 
m©ch_id
;

3719 
u8
 
³”_Çn_mªagem’t_š‹rçû_add»ss
[
ETH_ALEN
];

3720 
__Ë32
 
time¡amp
;

3721 
__Ë32
 
¥¬e_1
;

3722 
__Ë32
 
¥¬e_2
;

3723 
__Ë32
 
¥¬e_3
;

3724 
u8
 
dr
[0];

3725 } 
__·cked
 
mlme_Çn_fŞlowup_šd
;

3727 
__Ë16
 
vif
;

3728 
__Ë16
 
chªÃl_äequ’cy
;

3729 
__Ë16
 
chªÃl_šfÜm©iÚ
;

3730 
__Ë32
 
time¡amp
;

3731 
__Ë32
 
¥¬e_1
;

3732 
__Ë32
 
¥¬e_2
;

3733 
__Ë32
 
¥¬e_3
;

3734 
u8
 
dr
[0];

3735 } 
__·cked
 
mlme_chªÃl_sw™ched_šd
;

3737 
__Ë16
 
vif
;

3738 
__Ë16
 
rssi
;

3739 
u8
 
bssid
[
ETH_ALEN
];

3740 
__Ë32
 
time¡amp
;

3741 
__Ë32
 
¥¬e_1
;

3742 
__Ë32
 
¥¬e_2
;

3743 
__Ë32
 
¥¬e_3
;

3744 
u8
 
dr
[0];

3745 } 
__·cked
 
mlme_synchrÚi£d_šd
;

3747 
__Ë16
 
vif
;

3748 
__Ë16
 
abÜt_»asÚ
;

3749 
__Ë32
 
time¡amp
;

3750 
__Ë32
 
¥¬e_1
;

3751 
__Ë32
 
¥¬e_2
;

3752 
__Ë32
 
¥¬e_3
;

3753 
u8
 
dr
[0];

3754 } 
__·cked
 
mlme_b—cÚ_»pÜtšg_ev’t_šd
;

3756 
__Ë16
 
vif
;

3757 
__Ë32
 
time¡amp
;

3758 
__Ë32
 
¥¬e_1
;

3759 
__Ë32
 
¥¬e_2
;

3760 
__Ë32
 
¥¬e_3
;

3761 
u8
 
dr
[0];

3762 } 
__·cked
 
mlme_rßmšg_chªÃl_li¡_šd
;

3764 
__Ë16
 
vif
;

3765 
u8
 
bssid
[
ETH_ALEN
];

3766 
__Ë32
 
»assocŸtiÚ_»Œy_d–ay
;

3767 
__Ë32
 
time¡amp
;

3768 
__Ë32
 
¥¬e_1
;

3769 
__Ë32
 
¥¬e_2
;

3770 
__Ë32
 
¥¬e_3
;

3771 
u8
 
dr
[0];

3772 } 
__·cked
 
mlme_bÏckli¡ed_šd
;

3774 
__Ë16
 
vif
;

3775 
u8
 
³”_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

3776 
__Ë16
 
»suÉ_code
;

3777 
__Ë16
 
ndp_š¡ªû_id
;

3778 
__Ë16
 
æow_id
;

3779 
__Ë32
 
time¡amp
;

3780 
__Ë32
 
¥¬e_1
;

3781 
__Ë32
 
¥¬e_2
;

3782 
__Ë32
 
¥¬e_3
;

3783 
u8
 
dr
[0];

3784 } 
__·cked
 
mlme_ndp_»que¡_šd
;

3786 
__Ë16
 
vif
;

3787 
__Ë16
 
£ssiÚ_id
;

3788 
__Ë16
 
»que¡_id
;

3789 
u8
 
³”_Çn_mªagem’t_š‹rçû_add»ss
[
ETH_ALEN
];

3790 
__Ë16
 
£cur™y_»quœed
;

3791 
__Ë32
 
time¡amp
;

3792 
__Ë32
 
¥¬e_1
;

3793 
__Ë32
 
¥¬e_2
;

3794 
__Ë32
 
¥¬e_3
;

3795 
u8
 
dr
[0];

3796 } 
__·cked
 
mlme_ndp_»que¡ed_šd
;

3798 
__Ë16
 
vif
;

3799 
u8
 
³”_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

3800 
__Ë16
 
»suÉ_code
;

3801 
__Ë16
 
ndp_š¡ªû_id
;

3802 
__Ë16
 
æow_id
;

3803 
__Ë32
 
time¡amp
;

3804 
__Ë32
 
¥¬e_1
;

3805 
__Ë32
 
¥¬e_2
;

3806 
__Ë32
 
¥¬e_3
;

3807 
u8
 
dr
[0];

3808 } 
__·cked
 
mlme_ndp_»¥Ú£_šd
;

3810 
__Ë16
 
vif
;

3811 
__Ë16
 
ndp_š¡ªû_id
;

3812 
__Ë16
 
»asÚ_code
;

3813 
__Ë32
 
time¡amp
;

3814 
__Ë32
 
¥¬e_1
;

3815 
__Ë32
 
¥¬e_2
;

3816 
__Ë32
 
¥¬e_3
;

3817 
u8
 
dr
[0];

3818 } 
__·cked
 
mlme_ndp_‹rmš©ed_šd
;

3820 
__Ë16
 
vif
;

3821 
__Ë32
 
time¡amp
;

3822 
__Ë32
 
¥¬e_1
;

3823 
__Ë32
 
¥¬e_2
;

3824 
__Ë32
 
¥¬e_3
;

3825 
u8
 
dr
[0];

3826 } 
__·cked
 
mlme_Çn_¿nge_ÿnûÎed_šd
;

3828 
__Ë16
 
vif
;

3829 
__Ë32
 
time¡amp
;

3830 
__Ë32
 
¥¬e_1
;

3831 
__Ë32
 
¥¬e_2
;

3832 
__Ë32
 
¥¬e_3
;

3833 
u8
 
dr
[0];

3834 } 
__·cked
 
mlme_¥¬e_6_šd
;

3836 
__Ë16
 
vif
;

3837 
__Ë32
 
time¡amp
;

3838 
__Ë32
 
¥¬e_1
;

3839 
__Ë32
 
¥¬e_2
;

3840 
__Ë32
 
¥¬e_3
;

3841 
u8
 
dr
[0];

3842 } 
__·cked
 
mlme_Çn_¿nge_šd
;

3844 
__Ë16
 
vif
;

3845 
__Ë32
 
time¡amp
;

3846 
__Ë32
 
¥¬e_1
;

3847 
__Ë32
 
¥¬e_2
;

3848 
__Ë32
 
¥¬e_3
;

3849 
u8
 
dr
[0];

3850 } 
__·cked
 
mlme_¥¬e_7_šd
;

3852 
__Ë16
 
vif
;

3853 
__Ë16
 
»suÉ
;

3854 
__Ë32
 
time¡amp
;

3855 
__Ë32
 
¥¬e_1
;

3856 
__Ë32
 
¥¬e_2
;

3857 
__Ë32
 
¥¬e_3
;

3858 
u8
 
dr
[0];

3859 } 
__·cked
 
mlme_¡¬t_d‘eù_šd
;

3861 
__Ë16
 
vif
;

3862 
__Ë32
 
time¡amp
;

3863 
__Ë32
 
¥¬e_1
;

3864 
__Ë32
 
¥¬e_2
;

3865 
__Ë32
 
¥¬e_3
;

3866 
u8
 
dr
[0];

3867 } 
__·cked
 
mlme_¥¬e_8_šd
;

3869 
__Ë16
 
vif
;

3870 
__Ë16
 
twt_£tup_id
;

3871 
__Ë16
 
»suÉ_code
;

3872 
__Ë16
 
twt_ÃgÙŸtiÚ_ty³
;

3873 
__Ë16
 
twt_æow_ty³
;

3874 
__Ë16
 
twt_Œigg”_ty³
;

3875 
__Ë32
 
twt_wake_time
;

3876 
__Ë32
 
twt_wake_du¿tiÚ
;

3877 
__Ë32
 
twt_wake_š‹rv®
;

3878 
__Ë32
 
time¡amp
;

3879 
__Ë32
 
¥¬e_1
;

3880 
__Ë32
 
¥¬e_2
;

3881 
__Ë32
 
¥¬e_3
;

3882 
u8
 
dr
[0];

3883 } 
__·cked
 
mlme_twt_£tup_šd
;

3885 
__Ë16
 
vif
;

3886 
__Ë16
 
twt_£tup_id
;

3887 
__Ë16
 
»asÚ_code
;

3888 
__Ë32
 
time¡amp
;

3889 
__Ë32
 
¥¬e_1
;

3890 
__Ë32
 
¥¬e_2
;

3891 
__Ë32
 
¥¬e_3
;

3892 
u8
 
dr
[0];

3893 } 
__·cked
 
mlme_twt_‹¬down_šd
;

3895 
__Ë16
 
vif
;

3896 
__Ë32
 
time¡amp
;

3897 
__Ë32
 
¥¬e_1
;

3898 
__Ë32
 
¥¬e_2
;

3899 
__Ë32
 
¥¬e_3
;

3900 
u8
 
dr
[0];

3901 } 
__·cked
 
mlme_twt_nÙify_šd
;

3903 
__Ë16
 
vif
;

3904 
__Ë32
 
time¡amp
;

3905 
__Ë32
 
¥¬e_1
;

3906 
__Ë32
 
¥¬e_2
;

3907 
__Ë32
 
¥¬e_3
;

3908 
u8
 
dr
[0];

3909 } 
__·cked
 
mlme_¥¬e_9_šd
;

3911 
__Ë16
 
vif
;

3912 
__Ë32
 
time¡amp
;

3913 
__Ë32
 
¥¬e_1
;

3914 
__Ë32
 
¥¬e_2
;

3915 
__Ë32
 
¥¬e_3
;

3916 
u8
 
dr
[0];

3917 } 
__·cked
 
mlme_¥¬e_10_šd
;

3919 
__Ë16
 
vif
;

3920 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3921 
__Ë16
 
tid
;

3922 
__Ë32
 
time¡amp
;

3923 
__Ë32
 
¥¬e_1
;

3924 
__Ë32
 
¥¬e_2
;

3925 
__Ë32
 
¥¬e_3
;

3926 
u8
 
dr
[0];

3927 } 
__·cked
 
mlme_blockack_aùiÚ_šd
;

3929 
__Ë16
 
vif
;

3930 
__Ë32
 
¥¬e_1
;

3931 
__Ë32
 
¥¬e_2
;

3932 
__Ë32
 
¥¬e_3
;

3933 
u8
 
dr
[0];

3934 } 
__·cked
 
mlme_¥¬e_sigÇl_1_šd
;

3936 
__Ë16
 
vif
;

3937 
__Ë32
 
¥¬e_1
;

3938 
__Ë32
 
¥¬e_2
;

3939 
__Ë32
 
¥¬e_3
;

3940 
u8
 
dr
[0];

3941 } 
__·cked
 
mlme_¥¬e_sigÇl_2_šd
;

3943 
__Ë16
 
vif
;

3944 
__Ë32
 
¥¬e_1
;

3945 
__Ë32
 
¥¬e_2
;

3946 
__Ë32
 
¥¬e_3
;

3947 
u8
 
dr
[0];

3948 } 
__·cked
 
mlme_¥¬e_sigÇl_3_šd
;

3950 
__Ë16
 
vif
;

3951 
__Ë32
 
¥¬e_1
;

3952 
__Ë32
 
¥¬e_2
;

3953 
__Ë32
 
¥¬e_3
;

3954 
u8
 
dr
[0];

3955 } 
__·cked
 
debug_¥¬e_1_»q
;

3957 
__Ë16
 
vif
;

3958 
__Ë32
 
¥¬e_1
;

3959 
__Ë32
 
¥¬e_2
;

3960 
__Ë32
 
¥¬e_3
;

3961 
u8
 
dr
[0];

3962 } 
__·cked
 
debug_¥¬e_2_»q
;

3964 
__Ë16
 
vif
;

3965 
__Ë32
 
¥¬e_1
;

3966 
__Ë32
 
¥¬e_2
;

3967 
__Ë32
 
¥¬e_3
;

3968 
u8
 
dr
[0];

3969 } 
__·cked
 
debug_¥¬e_3_»q
;

3971 
__Ë16
 
vif
;

3972 
__Ë32
 
¥¬e_1
;

3973 
__Ë32
 
¥¬e_2
;

3974 
__Ë32
 
¥¬e_3
;

3975 
u8
 
dr
[0];

3976 } 
__·cked
 
debug_¥¬e_sigÇl_1_»q
;

3978 
__Ë16
 
vif
;

3979 
__Ë32
 
¥¬e_1
;

3980 
__Ë32
 
¥¬e_2
;

3981 
__Ë32
 
¥¬e_3
;

3982 
u8
 
dr
[0];

3983 } 
__·cked
 
debug_¥¬e_sigÇl_2_»q
;

3985 
__Ë16
 
vif
;

3986 
__Ë32
 
¥¬e_1
;

3987 
__Ë32
 
¥¬e_2
;

3988 
__Ë32
 
¥¬e_3
;

3989 
u8
 
dr
[0];

3990 } 
__·cked
 
debug_¥¬e_sigÇl_3_»q
;

3992 
__Ë16
 
vif
;

3993 
__Ë16
 
»suÉ_code
;

3994 
__Ë32
 
¥¬e_1
;

3995 
__Ë32
 
¥¬e_2
;

3996 
__Ë32
 
¥¬e_3
;

3997 
u8
 
dr
[0];

3998 } 
__·cked
 
debug_¥¬e_1_cfm
;

4000 
__Ë16
 
vif
;

4001 
__Ë16
 
»suÉ_code
;

4002 
__Ë32
 
¥¬e_1
;

4003 
__Ë32
 
¥¬e_2
;

4004 
__Ë32
 
¥¬e_3
;

4005 
u8
 
dr
[0];

4006 } 
__·cked
 
debug_¥¬e_2_cfm
;

4008 
__Ë16
 
vif
;

4009 
__Ë16
 
»suÉ_code
;

4010 
__Ë32
 
¥¬e_1
;

4011 
__Ë32
 
¥¬e_2
;

4012 
__Ë32
 
¥¬e_3
;

4013 
u8
 
dr
[0];

4014 } 
__·cked
 
debug_¥¬e_3_cfm
;

4016 
__Ë16
 
vif
;

4017 
__Ë16
 
»suÉ_code
;

4018 
__Ë32
 
¥¬e_1
;

4019 
__Ë32
 
¥¬e_2
;

4020 
__Ë32
 
¥¬e_3
;

4021 
u8
 
dr
[0];

4022 } 
__·cked
 
debug_¥¬e_sigÇl_1_cfm
;

4024 
__Ë16
 
vif
;

4025 
__Ë16
 
»suÉ_code
;

4026 
__Ë32
 
¥¬e_1
;

4027 
__Ë32
 
¥¬e_2
;

4028 
__Ë32
 
¥¬e_3
;

4029 
u8
 
dr
[0];

4030 } 
__·cked
 
debug_¥¬e_sigÇl_2_cfm
;

4032 
__Ë16
 
vif
;

4033 
__Ë16
 
»suÉ_code
;

4034 
__Ë32
 
¥¬e_1
;

4035 
__Ë32
 
¥¬e_2
;

4036 
__Ë32
 
¥¬e_3
;

4037 
u8
 
dr
[0];

4038 } 
__·cked
 
debug_¥¬e_sigÇl_3_cfm
;

4040 
__Ë16
 
vif
;

4041 
__Ë32
 
¥¬e_1
;

4042 
__Ë32
 
¥¬e_2
;

4043 
__Ë32
 
¥¬e_3
;

4044 
u8
 
dr
[0];

4045 } 
__·cked
 
debug_¥¬e_1_»s
;

4047 
__Ë16
 
vif
;

4048 
__Ë32
 
¥¬e_1
;

4049 
__Ë32
 
¥¬e_2
;

4050 
__Ë32
 
¥¬e_3
;

4051 
u8
 
dr
[0];

4052 } 
__·cked
 
debug_¥¬e_2_»s
;

4054 
__Ë16
 
vif
;

4055 
__Ë32
 
¥¬e_1
;

4056 
__Ë32
 
¥¬e_2
;

4057 
__Ë32
 
¥¬e_3
;

4058 
u8
 
dr
[0];

4059 } 
__·cked
 
debug_¥¬e_3_»s
;

4061 
__Ë16
 
vif
;

4062 
__Ë32
 
¥¬e_1
;

4063 
__Ë32
 
¥¬e_2
;

4064 
__Ë32
 
¥¬e_3
;

4065 
u8
 
dr
[0];

4066 } 
__·cked
 
debug_¥¬e_sigÇl_1_»s
;

4068 
__Ë16
 
vif
;

4069 
__Ë32
 
¥¬e_1
;

4070 
__Ë32
 
¥¬e_2
;

4071 
__Ë32
 
¥¬e_3
;

4072 
u8
 
dr
[0];

4073 } 
__·cked
 
debug_¥¬e_sigÇl_2_»s
;

4075 
__Ë16
 
vif
;

4076 
__Ë32
 
¥¬e_1
;

4077 
__Ë32
 
¥¬e_2
;

4078 
__Ë32
 
¥¬e_3
;

4079 
u8
 
dr
[0];

4080 } 
__·cked
 
debug_¥¬e_sigÇl_3_»s
;

4082 
__Ë16
 
vif
;

4083 
__Ë16
 
moduË_id
;

4084 
__Ë16
 
moduË_sub_id
;

4085 
__Ë32
 
time¡amp
;

4086 
__Ë16
 
debug_wÜds
[12];

4087 
__Ë16
 
£qu’û_numb”
;

4088 
__Ë32
 
¥¬e_1
;

4089 
__Ë32
 
¥¬e_2
;

4090 
__Ë32
 
¥¬e_3
;

4091 
u8
 
dr
[0];

4092 } 
__·cked
 
debug_wÜd12_šd
;

4094 
__Ë16
 
vif
;

4095 
__Ë16
 
çuÉid
;

4096 
__Ë16
 
couÁ
;

4097 
__Ë32
 
time¡amp
;

4098 
__Ë32
 
¬g
;

4099 
__Ë16
 
ıu
;

4100 
__Ë16
 
£qu’û_numb”
;

4101 
__Ë32
 
¥¬e_1
;

4102 
__Ë32
 
¥¬e_2
;

4103 
__Ë32
 
¥¬e_3
;

4104 
u8
 
dr
[0];

4105 } 
__·cked
 
debug_çuÉ_šd
;

4107 
__Ë16
 
vif
;

4108 
__Ë16
 
moduË_id
;

4109 
__Ë16
 
moduË_sub_id
;

4110 
__Ë32
 
time¡amp
;

4111 
__Ë16
 
£qu’û_numb”
;

4112 
__Ë32
 
¥¬e_1
;

4113 
__Ë32
 
¥¬e_2
;

4114 
__Ë32
 
¥¬e_3
;

4115 
u8
 
dr
[0];

4116 } 
__·cked
 
debug_wÜds_šd
;

4118 
__Ë16
 
vif
;

4119 
__Ë32
 
¥¬e_1
;

4120 
__Ë32
 
¥¬e_2
;

4121 
__Ë32
 
¥¬e_3
;

4122 
u8
 
dr
[0];

4123 } 
__·cked
 
debug_¥¬e_2_šd
;

4125 
__Ë16
 
vif
;

4126 
__Ë32
 
¥¬e_1
;

4127 
__Ë32
 
¥¬e_2
;

4128 
__Ë32
 
¥¬e_3
;

4129 
u8
 
dr
[0];

4130 } 
__·cked
 
debug_¥¬e_3_šd
;

4132 
__Ë16
 
vif
;

4133 
__Ë32
 
¥¬e_1
;

4134 
__Ë32
 
¥¬e_2
;

4135 
__Ë32
 
¥¬e_3
;

4136 
u8
 
dr
[0];

4137 } 
__·cked
 
debug_¥¬e_4_šd
;

4139 
__Ë16
 
vif
;

4140 
__Ë32
 
¥¬e_1
;

4141 
__Ë32
 
¥¬e_2
;

4142 
__Ë32
 
¥¬e_3
;

4143 
u8
 
dr
[0];

4144 } 
__·cked
 
debug_¥¬e_sigÇl_1_šd
;

4146 
__Ë16
 
vif
;

4147 
__Ë32
 
¥¬e_1
;

4148 
__Ë32
 
¥¬e_2
;

4149 
__Ë32
 
¥¬e_3
;

4150 
u8
 
dr
[0];

4151 } 
__·cked
 
debug_¥¬e_sigÇl_2_šd
;

4153 
__Ë16
 
vif
;

4154 
__Ë32
 
¥¬e_1
;

4155 
__Ë32
 
¥¬e_2
;

4156 
__Ë32
 
¥¬e_3
;

4157 
u8
 
dr
[0];

4158 } 
__·cked
 
debug_¥¬e_sigÇl_3_šd
;

4160 
__Ë16
 
vif
;

4161 
__Ë32
 
¥¬e_1
;

4162 
__Ë32
 
¥¬e_2
;

4163 
__Ë32
 
¥¬e_3
;

4164 
u8
 
dr
[0];

4165 } 
__·cked
 
‹¡_block_»que¡s_»q
;

4167 
__Ë16
 
vif
;

4168 
__Ë32
 
¥¬e_1
;

4169 
__Ë32
 
¥¬e_2
;

4170 
__Ë32
 
¥¬e_3
;

4171 
u8
 
dr
[0];

4172 } 
__·cked
 
‹¡_·nic_»q
;

4174 
__Ë16
 
vif
;

4175 
__Ë32
 
¥¬e_1
;

4176 
__Ë32
 
¥¬e_2
;

4177 
__Ë32
 
¥¬e_3
;

4178 
u8
 
dr
[0];

4179 } 
__·cked
 
‹¡_su¥’d_»q
;

4181 
__Ë16
 
vif
;

4182 
__Ë32
 
¥¬e_1
;

4183 
__Ë32
 
¥¬e_2
;

4184 
__Ë32
 
¥¬e_3
;

4185 
u8
 
dr
[0];

4186 } 
__·cked
 
‹¡_»sume_»q
;

4188 
__Ë32
 
ÿ±u»_sourû
;

4189 
__Ë32
 
ÿ±u»_¡»am
;

4190 
__Ë32
 
ÿ±u»_fÜm©
;

4191 
__Ë32
 
¡¬t_Œigg”
;

4192 
__Ë32
 
¡İ_Œigg”
;

4193 
__Ë32
 
¡¬t_d–ay
;

4194 
__Ë32
 
¡İ_d–ay
;

4195 
__Ë32
 
ÿ±u»_š‹rv®
;

4196 
__Ë16
 
phy_id
;

4197 
__Ë32
 
¥¬e_1
;

4198 
__Ë32
 
¥¬e_2
;

4199 
__Ë32
 
¥¬e_3
;

4200 
u8
 
dr
[0];

4201 } 
__·cked
 
¿dio_loggšg_»q
;

4203 
__Ë16
 
äeq
;

4204 
__Ë16
 
pow”
;

4205 
__Ë16
 
æags
;

4206 
__Ë16
 
ty³
;

4207 
__Ë16
 
am¶™ude
;

4208 
__Ë32
 
äeq1
;

4209 
__Ë32
 
äeq2
;

4210 
__Ë16
 
pha£
;

4211 
u8
 
chªÃl_width
;

4212 
u8
 
¥¬e_0
;

4213 
__Ë16
 
¥¬e_1
;

4214 
__Ë32
 
¥¬e_2
;

4215 
__Ë32
 
¥¬e_3
;

4216 
u8
 
dr
[0];

4217 } 
__·cked
 
wÏÆ™e_cw_¡¬t_»q
;

4219 
__Ë32
 
¥¬e_1
;

4220 
__Ë32
 
¥¬e_2
;

4221 
__Ë32
 
¥¬e_3
;

4222 
u8
 
dr
[0];

4223 } 
__·cked
 
wÏÆ™e_cw_¡İ_»q
;

4225 
__Ë16
 
äeq
;

4226 
__Ë16
 
¿‹
;

4227 
__Ë16
 
chªÃl_šfÜm©iÚ
;

4228 
__Ë16
 
pow”
;

4229 
__Ë16
 
Ëngth
;

4230 
__Ë32
 
š‹rv®
;

4231 
__Ë16
 
æags
;

4232 
__Ë16
 
aid
;

4233 
__Ë16
 
¥¬e_0
;

4234 
__Ë16
 
»guÏtÜy_domaš
;

4235 
__Ë16
 
æags2
;

4236 
__Ë16
 
he_mode
;

4237 
__Ë16
 
he_ru_®loÿtiÚ
;

4238 
__Ë16
 
he_Éf
;

4239 
__Ë16
 
timeout_¿dio_»maš_Ú
;

4240 
__Ë16
 
mac_id
;

4241 
__Ë32
 
¥¬e_1
;

4242 
__Ë32
 
¥¬e_2
;

4243 
__Ë32
 
¥¬e_3
;

4244 
u8
 
dr
[0];

4245 } 
__·cked
 
wÏÆ™e_tx_£t_·¿ms_»q
;

4247 
__Ë32
 
num_äames_to_£nd
;

4248 
__Ë16
 
d©a_ty³
;

4249 
__Ë16
 
d©a_·¿m
;

4250 
u8
 
de¡_addr
[
ETH_ALEN
];

4251 
u8
 
¤c_addr
[
ETH_ALEN
];

4252 
u8
 
bssid
[
ETH_ALEN
];

4253 
__Ë16
 
num_mpdus_³r_ampdu
;

4254 
__Ë16
 
ty³_subty³_f‹r
;

4255 
__Ë32
 
¥¬e_1
;

4256 
__Ë32
 
¥¬e_2
;

4257 
__Ë32
 
¥¬e_3
;

4258 
u8
 
dr
[0];

4259 } 
__·cked
 
wÏÆ™e_tx_¡¬t_»q
;

4261 
__Ë32
 
¥¬e_1
;

4262 
__Ë32
 
¥¬e_2
;

4263 
__Ë32
 
¥¬e_3
;

4264 
u8
 
dr
[0];

4265 } 
__·cked
 
wÏÆ™e_tx_»ad_»q
;

4267 
__Ë32
 
¥¬e_1
;

4268 
__Ë32
 
¥¬e_2
;

4269 
__Ë32
 
¥¬e_3
;

4270 
u8
 
dr
[0];

4271 } 
__·cked
 
wÏÆ™e_tx_¡İ_»q
;

4273 
__Ë16
 
äeq
;

4274 
__Ë16
 
chªÃl_šfÜm©iÚ
;

4275 
__Ë16
 
æags
;

4276 
u8
 
mac_addr
[
ETH_ALEN
];

4277 
u8
 
bssid
[
ETH_ALEN
];

4278 
__Ë16
 
aid
;

4279 
__Ë16
 
num_mpdus_³r_ampdu
;

4280 
__Ë16
 
»guÏtÜy_domaš
;

4281 
__Ë16
 
ty³_subty³_f‹r
;

4282 
__Ë16
 
mac_id
;

4283 
__Ë32
 
¥¬e_1
;

4284 
__Ë32
 
¥¬e_2
;

4285 
__Ë32
 
¥¬e_3
;

4286 
u8
 
dr
[0];

4287 } 
__·cked
 
wÏÆ™e_rx_¡¬t_»q
;

4289 
__Ë32
 
¥¬e_1
;

4290 
__Ë32
 
¥¬e_2
;

4291 
__Ë32
 
¥¬e_3
;

4292 
u8
 
dr
[0];

4293 } 
__·cked
 
wÏÆ™e_rx_»ad_»q
;

4295 
__Ë32
 
¥¬e_1
;

4296 
__Ë32
 
¥¬e_2
;

4297 
__Ë32
 
¥¬e_3
;

4298 
u8
 
dr
[0];

4299 } 
__·cked
 
wÏÆ™e_rx_¡İ_»q
;

4301 
__Ë32
 
¥¬e_1
;

4302 
__Ë32
 
¥¬e_2
;

4303 
__Ë32
 
¥¬e_3
;

4304 
u8
 
dr
[0];

4305 } 
__·cked
 
wÏÆ™e_¡©us_»q
;

4307 
__Ë16
 
®loc_¬—
;

4308 
__Ë32
 
¥¬e_1
;

4309 
__Ë32
 
¥¬e_2
;

4310 
__Ë32
 
¥¬e_3
;

4311 
u8
 
dr
[0];

4312 } 
__·cked
 
‹¡_pm®loc_»q
;

4314 
__Ë16
 
vif
;

4315 
__Ë32
 
¥¬e_1
;

4316 
__Ë32
 
¥¬e_2
;

4317 
__Ë32
 
¥¬e_3
;

4318 
u8
 
dr
[0];

4319 } 
__·cked
 
‹¡_cÚfigu»_mÚ™Ü_mode_»q
;

4321 
__Ë32
 
¥¬e_1
;

4322 
__Ë32
 
¥¬e_2
;

4323 
__Ë32
 
¥¬e_3
;

4324 
u8
 
dr
[0];

4325 } 
__·cked
 
‹¡_check_fw_®ive_»q
;

4327 
__Ë16
 
vif
;

4328 
__Ë16
 
debug_wÜds
[8];

4329 
__Ë32
 
¥¬e_1
;

4330 
__Ë32
 
¥¬e_2
;

4331 
__Ë32
 
¥¬e_3
;

4332 
u8
 
dr
[0];

4333 } 
__·cked
 
debug_g’”ic_»q
;

4335 
__Ë16
 
vif
;

4336 
__Ë16
 
’d_pošt
;

4337 
__Ë16
 
dœeùiÚ
;

4338 
__Ë32
 
š‹rv®
;

4339 
__Ë16
 
·ck‘s_³r_š‹rv®
;

4340 
__Ë32
 
¥¬e_1
;

4341 
__Ë32
 
¥¬e_2
;

4342 
__Ë32
 
¥¬e_3
;

4343 
u8
 
dr
[0];

4344 } 
__·cked
 
debug_pkt_sšk_¡¬t_»q
;

4346 
__Ë16
 
vif
;

4347 
__Ë16
 
’d_pošt
;

4348 
__Ë16
 
dœeùiÚ
;

4349 
__Ë32
 
¥¬e_1
;

4350 
__Ë32
 
¥¬e_2
;

4351 
__Ë32
 
¥¬e_3
;

4352 
u8
 
dr
[0];

4353 } 
__·cked
 
debug_pkt_sšk_¡İ_»q
;

4355 
__Ë16
 
vif
;

4356 
__Ë16
 
’d_pošt
;

4357 
__Ë16
 
dœeùiÚ
;

4358 
__Ë32
 
»pÜt_š‹rv®
;

4359 
__Ë32
 
¥¬e_1
;

4360 
__Ë32
 
¥¬e_2
;

4361 
__Ë32
 
¥¬e_3
;

4362 
u8
 
dr
[0];

4363 } 
__·cked
 
debug_pkt_sšk_»pÜt_»q
;

4365 
__Ë16
 
vif
;

4366 
__Ë16
 
’d_pošt
;

4367 
__Ë16
 
dœeùiÚ
;

4368 
__Ë32
 
š‹rv®
;

4369 
__Ë16
 
size
;

4370 
__Ë16
 
·ck‘s_³r_š‹rv®
;

4371 
__Ë32
 
v4de¡š©iÚ_add»ss
;

4372 
__Ë16
 
·ck‘s_³r_š‹¼u±
;

4373 
__Ë16
 
u£_¡»amšg
;

4374 
__Ë32
 
¥¬e_1
;

4375 
__Ë32
 
¥¬e_2
;

4376 
__Ë32
 
¥¬e_3
;

4377 
u8
 
dr
[0];

4378 } 
__·cked
 
debug_pkt_g’_¡¬t_»q
;

4380 
__Ë16
 
vif
;

4381 
__Ë16
 
’d_pošt
;

4382 
__Ë16
 
dœeùiÚ
;

4383 
__Ë32
 
¥¬e_1
;

4384 
__Ë32
 
¥¬e_2
;

4385 
__Ë32
 
¥¬e_3
;

4386 
u8
 
dr
[0];

4387 } 
__·cked
 
debug_pkt_g’_¡İ_»q
;

4389 
__Ë16
 
vif
;

4390 
__Ë16
 
’d_pošt
;

4391 
__Ë16
 
dœeùiÚ
;

4392 
__Ë32
 
»pÜt_š‹rv®
;

4393 
__Ë32
 
¥¬e_1
;

4394 
__Ë32
 
¥¬e_2
;

4395 
__Ë32
 
¥¬e_3
;

4396 
u8
 
dr
[0];

4397 } 
__·cked
 
debug_pkt_g’_»pÜt_»q
;

4399 
__Ë16
 
¿dio_b™m­
;

4400 
__Ë16
 
bªd
;

4401 
__Ë32
 
¥¬e_1
;

4402 
__Ë32
 
¥¬e_2
;

4403 
__Ë32
 
¥¬e_3
;

4404 
u8
 
dr
[0];

4405 } 
__·cked
 
wÏÆ™e_¿dio_£Ëù_»q
;

4407 
__Ë16
 
vif
;

4408 
__Ë16
 
mode
;

4409 
__Ë16
 
’d_pošt
;

4410 
__Ë16
 
´ÙocŞ
;

4411 
__Ë32
 
š‹rv®
;

4412 
__Ë16
 
·ck‘s_³r_š‹rv®
;

4413 
__Ë16
 
·ck‘s_size
;

4414 
__Ë32
 
¥¬e_1
;

4415 
__Ë32
 
¥¬e_2
;

4416 
__Ë32
 
¥¬e_3
;

4417 
u8
 
dr
[0];

4418 } 
__·cked
 
‹¡_h_‹¡”_¡¬t_»q
;

4420 
__Ë16
 
vif
;

4421 
__Ë16
 
¡»am_id
;

4422 
__Ë32
 
¥¬e_1
;

4423 
__Ë32
 
¥¬e_2
;

4424 
__Ë32
 
¥¬e_3
;

4425 
u8
 
dr
[0];

4426 } 
__·cked
 
‹¡_h_‹¡”_¡İ_»q
;

4428 
__Ë16
 
vif
;

4429 
__Ë16
 
¡»am_id
;

4430 
__Ë32
 
¥¬e_1
;

4431 
__Ë32
 
¥¬e_2
;

4432 
__Ë32
 
¥¬e_3
;

4433 
u8
 
dr
[0];

4434 } 
__·cked
 
‹¡_h_‹¡”_£t_·¿ms_»q
;

4436 
__Ë16
 
vif
;

4437 
__Ë16
 
¡»am_id
;

4438 
__Ë32
 
»pÜt_š‹rv®
;

4439 
__Ë32
 
¥¬e_1
;

4440 
__Ë32
 
¥¬e_2
;

4441 
__Ë32
 
¥¬e_3
;

4442 
u8
 
dr
[0];

4443 } 
__·cked
 
‹¡_h_‹¡”_»pÜt_»q
;

4445 
__Ë16
 
äeq
;

4446 
__Ë16
 
tx_gaš
;

4447 
__Ë16
 
rx_gaš
;

4448 
__Ë32
 
¥¬e_1
;

4449 
__Ë32
 
¥¬e_2
;

4450 
__Ë32
 
¥¬e_3
;

4451 
u8
 
dr
[0];

4452 } 
__·cked
 
‹¡_bi¡_g‘_tx_gaš_»q
;

4454 
__Ë32
 
¥¬e_1
;

4455 
__Ë32
 
¥¬e_2
;

4456 
__Ë32
 
¥¬e_3
;

4457 
u8
 
dr
[0];

4458 } 
__·cked
 
‹¡_¡¬t_wÏÆ™e_»q
;

4460 
__Ë16
 
vif
;

4461 
__Ë32
 
¥¬e_1
;

4462 
__Ë32
 
¥¬e_2
;

4463 
__Ë32
 
¥¬e_3
;

4464 
u8
 
dr
[0];

4465 } 
__·cked
 
‹¡_¥¬e_2_»q
;

4467 
__Ë16
 
vif
;

4468 
__Ë32
 
¥¬e_1
;

4469 
__Ë32
 
¥¬e_2
;

4470 
__Ë32
 
¥¬e_3
;

4471 
u8
 
dr
[0];

4472 } 
__·cked
 
‹¡_¥¬e_3_»q
;

4474 
__Ë32
 
commªd_ty³
;

4475 
__Ë16
 
ev’t_mask_wÜd0
;

4476 
__Ë16
 
ev’t_mask_wÜd1
;

4477 
__Ë16
 
ev’t_mask_wÜd2
;

4478 
__Ë16
 
ev’t_mask_wÜd3
;

4479 
__Ë16
 
İtiÚs
;

4480 
__Ë32
 
ev’t_couÁ_ù¾_Œigg”03
;

4481 
__Ë32
 
ev’t_couÁ_ù¾_Œigg”47
;

4482 
__Ë16
 
ev’t_m©ch0
;

4483 
__Ë16
 
ev’t_m©ch1
;

4484 
__Ë16
 
ev’t_m©ch2
;

4485 
__Ë16
 
ev’t_m©ch3
;

4486 
__Ë32
 
¥¬e_1
;

4487 
__Ë32
 
¥¬e_2
;

4488 
__Ë32
 
¥¬e_3
;

4489 
u8
 
dr
[0];

4490 } 
__·cked
 
phy_ev’t_loggšg_»q
;

4492 
__Ë16
 
vif
;

4493 
__Ë32
 
¥¬e_1
;

4494 
__Ë32
 
¥¬e_2
;

4495 
__Ë32
 
¥¬e_3
;

4496 
u8
 
dr
[0];

4497 } 
__·cked
 
‹¡_¥¬e_4_»q
;

4499 
__Ë16
 
vif
;

4500 
__Ë32
 
¥¬e_1
;

4501 
__Ë32
 
¥¬e_2
;

4502 
__Ë32
 
¥¬e_3
;

4503 
u8
 
dr
[0];

4504 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_»q
;

4506 
__Ë16
 
vif
;

4507 
__Ë32
 
¥¬e_1
;

4508 
__Ë32
 
¥¬e_2
;

4509 
__Ë32
 
¥¬e_3
;

4510 
u8
 
dr
[0];

4511 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_»q
;

4513 
__Ë16
 
vif
;

4514 
__Ë32
 
¥¬e_1
;

4515 
__Ë32
 
¥¬e_2
;

4516 
__Ë32
 
¥¬e_3
;

4517 
u8
 
dr
[0];

4518 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_»q
;

4520 
__Ë16
 
»suÉ_code
;

4521 
__Ë32
 
¥¬e_1
;

4522 
__Ë32
 
¥¬e_2
;

4523 
__Ë32
 
¥¬e_3
;

4524 
u8
 
dr
[0];

4525 } 
__·cked
 
¿dio_loggšg_cfm
;

4527 
__Ë16
 
»suÉ_code
;

4528 
__Ë32
 
¥¬e_1
;

4529 
__Ë32
 
¥¬e_2
;

4530 
__Ë32
 
¥¬e_3
;

4531 
u8
 
dr
[0];

4532 } 
__·cked
 
wÏÆ™e_cw_¡¬t_cfm
;

4534 
__Ë16
 
»suÉ_code
;

4535 
__Ë32
 
¥¬e_1
;

4536 
__Ë32
 
¥¬e_2
;

4537 
__Ë32
 
¥¬e_3
;

4538 
u8
 
dr
[0];

4539 } 
__·cked
 
wÏÆ™e_tx_£t_·¿ms_cfm
;

4541 
__Ë16
 
»suÉ_code
;

4542 
__Ë32
 
¥¬e_1
;

4543 
__Ë32
 
¥¬e_2
;

4544 
__Ë32
 
¥¬e_3
;

4545 
u8
 
dr
[0];

4546 } 
__·cked
 
wÏÆ™e_cw_¡İ_cfm
;

4548 
__Ë16
 
»suÉ_code
;

4549 
__Ë32
 
¥¬e_1
;

4550 
__Ë32
 
¥¬e_2
;

4551 
__Ë32
 
¥¬e_3
;

4552 
u8
 
dr
[0];

4553 } 
__·cked
 
wÏÆ™e_tx_¡¬t_cfm
;

4555 
__Ë16
 
»suÉ_code
;

4556 
__Ë16
 
æags
;

4557 
__Ë32
 
ùr_äames_Ëá_to_£nd
;

4558 
__Ë32
 
ŒªsmissiÚ_back_off
;

4559 
__Ë16
 
wª‹d_pow”_rg‘
;

4560 
__Ë16
 
fš®_pow”_rg‘
;

4561 
__Ë16
 
oob_cÚ¡¿št
;

4562 
__Ë16
 
Ï¡_Œim_·_‹m³¿tu»
;

4563 
__Ë16
 
cu¼’t_·_‹m³¿tu»
;

4564 
__Ë16
 
Ï¡_Œim_amb›Á_‹m³¿tu»
;

4565 
__Ë16
 
cu¼’t_amb›Á_‹m³¿tu»
;

4566 
__Ë16
 
‹mp_pow”_adju¡
;

4567 
__Ë32
 
ùr_äames_sucûss
;

4568 
__Ë32
 
ùr_äames_sucûss_cÿ_dyÇmic_bw
;

4569 
__Ë32
 
¥¬e_2
;

4570 
__Ë32
 
¥¬e_3
;

4571 
u8
 
dr
[0];

4572 } 
__·cked
 
wÏÆ™e_tx_»ad_cfm
;

4574 
__Ë16
 
»suÉ_code
;

4575 
__Ë32
 
¥¬e_1
;

4576 
__Ë32
 
¥¬e_2
;

4577 
__Ë32
 
¥¬e_3
;

4578 
u8
 
dr
[0];

4579 } 
__·cked
 
wÏÆ™e_tx_¡İ_cfm
;

4581 
__Ë16
 
»suÉ_code
;

4582 
__Ë32
 
¥¬e_1
;

4583 
__Ë32
 
¥¬e_2
;

4584 
__Ë32
 
¥¬e_3
;

4585 
u8
 
dr
[0];

4586 } 
__·cked
 
wÏÆ™e_rx_¡¬t_cfm
;

4588 
__Ë16
 
»suÉ_code
;

4589 
__Ë32
 
äeq_off£t_cur
;

4590 
__Ë32
 
äeq_off£t_avg
;

4591 
__Ë16
 
rssi_cur
;

4592 
__Ë16
 
rssi_avg
;

4593 
__Ë16
 
rssi_mš
;

4594 
__Ë16
 
rssi_max
;

4595 
__Ë16
 
¢r_cur
;

4596 
__Ë16
 
¢r_avg
;

4597 
__Ë16
 
¢r_mš
;

4598 
__Ë16
 
¢r_max
;

4599 
__Ë32
 
š‹rv®
;

4600 
__Ë32
 
¥¬e_1
;

4601 
__Ë32
 
¥¬e_2
;

4602 
__Ë32
 
¥¬e_3
;

4603 
u8
 
dr
[0];

4604 } 
__·cked
 
wÏÆ™e_rx_»ad_cfm
;

4606 
__Ë16
 
»suÉ_code
;

4607 
__Ë32
 
¥¬e_1
;

4608 
__Ë32
 
¥¬e_2
;

4609 
__Ë32
 
¥¬e_3
;

4610 
u8
 
dr
[0];

4611 } 
__·cked
 
wÏÆ™e_rx_¡İ_cfm
;

4613 
__Ë16
 
»suÉ_code
;

4614 
__Ë16
 
deviû_¡©e
;

4615 
__Ë16
 
¿dio_b™m­
;

4616 
__Ë16
 
bªd
;

4617 
__Ë16
 
mac_id
;

4618 
__Ë32
 
¥¬e_1
;

4619 
__Ë32
 
¥¬e_2
;

4620 
__Ë32
 
¥¬e_3
;

4621 
u8
 
dr
[0];

4622 } 
__·cked
 
wÏÆ™e_¡©us_cfm
;

4624 
__Ë32
 
¥¬e_1
;

4625 
__Ë32
 
¥¬e_2
;

4626 
__Ë32
 
¥¬e_3
;

4627 
u8
 
dr
[0];

4628 } 
__·cked
 
‹¡_pm®loc_cfm
;

4630 
__Ë16
 
vif
;

4631 
__Ë16
 
»suÉ_code
;

4632 
__Ë32
 
¥¬e_1
;

4633 
__Ë32
 
¥¬e_2
;

4634 
__Ë32
 
¥¬e_3
;

4635 
u8
 
dr
[0];

4636 } 
__·cked
 
‹¡_cÚfigu»_mÚ™Ü_mode_cfm
;

4638 
__Ë32
 
¥¬e_1
;

4639 
__Ë32
 
¥¬e_2
;

4640 
__Ë32
 
¥¬e_3
;

4641 
u8
 
dr
[0];

4642 } 
__·cked
 
‹¡_check_fw_®ive_cfm
;

4644 
__Ë32
 
¥¬e_1
;

4645 
__Ë32
 
¥¬e_2
;

4646 
__Ë32
 
¥¬e_3
;

4647 
u8
 
dr
[0];

4648 } 
__·cked
 
‹¡_su¥’d_cfm
;

4650 
__Ë32
 
¥¬e_1
;

4651 
__Ë32
 
¥¬e_2
;

4652 
__Ë32
 
¥¬e_3
;

4653 
u8
 
dr
[0];

4654 } 
__·cked
 
‹¡_»sume_cfm
;

4656 
__Ë16
 
vif
;

4657 
__Ë16
 
debug_wÜds
[8];

4658 
__Ë32
 
¥¬e_1
;

4659 
__Ë32
 
¥¬e_2
;

4660 
__Ë32
 
¥¬e_3
;

4661 
u8
 
dr
[0];

4662 } 
__·cked
 
debug_g’”ic_cfm
;

4664 
__Ë16
 
»suÉ_code
;

4665 
__Ë32
 
¥¬e_1
;

4666 
__Ë32
 
¥¬e_2
;

4667 
__Ë32
 
¥¬e_3
;

4668 
u8
 
dr
[0];

4669 } 
__·cked
 
wÏÆ™e_¿dio_£Ëù_cfm
;

4671 
__Ë16
 
vif
;

4672 
__Ë16
 
»suÉ_code
;

4673 
__Ë16
 
¡»am_id
;

4674 
__Ë32
 
¥¬e_1
;

4675 
__Ë32
 
¥¬e_2
;

4676 
__Ë32
 
¥¬e_3
;

4677 
u8
 
dr
[0];

4678 } 
__·cked
 
‹¡_h_‹¡”_¡¬t_cfm
;

4680 
__Ë16
 
vif
;

4681 
__Ë16
 
»suÉ_code
;

4682 
__Ë16
 
¡»am_id
;

4683 
__Ë32
 
du¿tiÚ
;

4684 
__Ë32
 
couÁ
;

4685 
__Ë32
 
çed_couÁ
;

4686 
__Ë32
 
où‘s
;

4687 
__Ë32
 
mbps
;

4688 
__Ë16
 
idË_¿tio
;

4689 
__Ë16
 
št_Ï‹ncy
;

4690 
__Ë32
 
‹¡”_»£rved1
;

4691 
__Ë32
 
‹¡”_»£rved2
;

4692 
__Ë32
 
¥¬e_1
;

4693 
__Ë32
 
¥¬e_2
;

4694 
__Ë32
 
¥¬e_3
;

4695 
u8
 
dr
[0];

4696 } 
__·cked
 
‹¡_h_‹¡”_¡İ_cfm
;

4698 
__Ë16
 
vif
;

4699 
__Ë16
 
»suÉ_code
;

4700 
__Ë16
 
¡»am_id
;

4701 
__Ë32
 
¥¬e_1
;

4702 
__Ë32
 
¥¬e_2
;

4703 
__Ë32
 
¥¬e_3
;

4704 
u8
 
dr
[0];

4705 } 
__·cked
 
‹¡_h_‹¡”_£t_·¿ms_cfm
;

4707 
__Ë16
 
»suÉ_code
;

4708 
__Ë32
 
gaš
;

4709 
__Ë32
 
¥¬e_1
;

4710 
__Ë32
 
¥¬e_2
;

4711 
__Ë32
 
¥¬e_3
;

4712 
u8
 
dr
[0];

4713 } 
__·cked
 
‹¡_bi¡_g‘_tx_gaš_cfm
;

4715 
__Ë16
 
»suÉ_code
;

4716 
__Ë32
 
¥¬e_1
;

4717 
__Ë32
 
¥¬e_2
;

4718 
__Ë32
 
¥¬e_3
;

4719 
u8
 
dr
[0];

4720 } 
__·cked
 
‹¡_¡¬t_wÏÆ™e_cfm
;

4722 
__Ë16
 
vif
;

4723 
__Ë16
 
»suÉ_code
;

4724 
__Ë32
 
¥¬e_1
;

4725 
__Ë32
 
¥¬e_2
;

4726 
__Ë32
 
¥¬e_3
;

4727 
u8
 
dr
[0];

4728 } 
__·cked
 
‹¡_¥¬e_2_cfm
;

4730 
__Ë16
 
vif
;

4731 
__Ë16
 
»suÉ_code
;

4732 
__Ë32
 
¥¬e_1
;

4733 
__Ë32
 
¥¬e_2
;

4734 
__Ë32
 
¥¬e_3
;

4735 
u8
 
dr
[0];

4736 } 
__·cked
 
‹¡_¥¬e_3_cfm
;

4738 
__Ë16
 
»suÉ_code
;

4739 
__Ë32
 
¥¬e_1
;

4740 
__Ë32
 
¥¬e_2
;

4741 
__Ë32
 
¥¬e_3
;

4742 
u8
 
dr
[0];

4743 } 
__·cked
 
phy_ev’t_loggšg_cfm
;

4745 
__Ë16
 
vif
;

4746 
__Ë16
 
»suÉ_code
;

4747 
__Ë32
 
¥¬e_1
;

4748 
__Ë32
 
¥¬e_2
;

4749 
__Ë32
 
¥¬e_3
;

4750 
u8
 
dr
[0];

4751 } 
__·cked
 
‹¡_¥¬e_4_cfm
;

4753 
__Ë16
 
vif
;

4754 
__Ë16
 
»suÉ_code
;

4755 
__Ë32
 
¥¬e_1
;

4756 
__Ë32
 
¥¬e_2
;

4757 
__Ë32
 
¥¬e_3
;

4758 
u8
 
dr
[0];

4759 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_cfm
;

4761 
__Ë16
 
vif
;

4762 
__Ë16
 
»suÉ_code
;

4763 
__Ë32
 
¥¬e_1
;

4764 
__Ë32
 
¥¬e_2
;

4765 
__Ë32
 
¥¬e_3
;

4766 
u8
 
dr
[0];

4767 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_cfm
;

4769 
__Ë16
 
vif
;

4770 
__Ë16
 
»suÉ_code
;

4771 
__Ë32
 
¥¬e_1
;

4772 
__Ë32
 
¥¬e_2
;

4773 
__Ë32
 
¥¬e_3
;

4774 
u8
 
dr
[0];

4775 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_cfm
;

4777 
__Ë16
 
vif
;

4778 
__Ë32
 
¥¬e_1
;

4779 
__Ë32
 
¥¬e_2
;

4780 
__Ë32
 
¥¬e_3
;

4781 
u8
 
dr
[0];

4782 } 
__·cked
 
‹¡_¥¬e_1_»s
;

4784 
__Ë16
 
vif
;

4785 
__Ë32
 
¥¬e_1
;

4786 
__Ë32
 
¥¬e_2
;

4787 
__Ë32
 
¥¬e_3
;

4788 
u8
 
dr
[0];

4789 } 
__·cked
 
‹¡_¥¬e_2_»s
;

4791 
__Ë16
 
vif
;

4792 
__Ë32
 
¥¬e_1
;

4793 
__Ë32
 
¥¬e_2
;

4794 
__Ë32
 
¥¬e_3
;

4795 
u8
 
dr
[0];

4796 } 
__·cked
 
‹¡_¥¬e_3_»s
;

4798 
__Ë16
 
vif
;

4799 
__Ë32
 
¥¬e_1
;

4800 
__Ë32
 
¥¬e_2
;

4801 
__Ë32
 
¥¬e_3
;

4802 
u8
 
dr
[0];

4803 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_»s
;

4805 
__Ë16
 
vif
;

4806 
__Ë32
 
¥¬e_1
;

4807 
__Ë32
 
¥¬e_2
;

4808 
__Ë32
 
¥¬e_3
;

4809 
u8
 
dr
[0];

4810 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_»s
;

4812 
__Ë16
 
vif
;

4813 
__Ë32
 
¥¬e_1
;

4814 
__Ë32
 
¥¬e_2
;

4815 
__Ë32
 
¥¬e_3
;

4816 
u8
 
dr
[0];

4817 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_»s
;

4819 
__Ë32
 
£qu’û_numb”
;

4820 
__Ë16
 
phy_id
;

4821 
__Ë16
 
m‘ad©a
;

4822 
__Ë32
 
mÜe_d©a
;

4823 
__Ë32
 
¥¬e_1
;

4824 
__Ë32
 
¥¬e_2
;

4825 
__Ë32
 
¥¬e_3
;

4826 
u8
 
dr
[0];

4827 } 
__·cked
 
¿dio_loggšg_šd
;

4829 
__Ë16
 
vif
;

4830 
__Ë16
 
debug_wÜds
[8];

4831 
__Ë32
 
¥¬e_1
;

4832 
__Ë32
 
¥¬e_2
;

4833 
__Ë32
 
¥¬e_3
;

4834 
u8
 
dr
[0];

4835 } 
__·cked
 
debug_g’”ic_šd
;

4837 
__Ë16
 
vif
;

4838 
__Ë16
 
’d_pošt
;

4839 
__Ë16
 
dœeùiÚ
;

4840 
__Ë32
 
du¿tiÚ
;

4841 
__Ë32
 
»ûived_·ck‘s
;

4842 
__Ë32
 
»ûived_où‘s
;

4843 
__Ë32
 
kbps
;

4844 
__Ë16
 
idË_¿tio
;

4845 
__Ë16
 
št_Ï‹ncy
;

4846 
__Ë16
 
ä“_kby‹s
;

4847 
__Ë32
 
¥¬e_1
;

4848 
__Ë32
 
¥¬e_2
;

4849 
__Ë32
 
¥¬e_3
;

4850 
u8
 
dr
[0];

4851 } 
__·cked
 
debug_pkt_sšk_»pÜt_šd
;

4853 
__Ë16
 
vif
;

4854 
__Ë16
 
’d_pošt
;

4855 
__Ë16
 
dœeùiÚ
;

4856 
__Ë32
 
du¿tiÚ
;

4857 
__Ë32
 
»ûived_·ck‘s
;

4858 
__Ë32
 
çed_couÁ
;

4859 
__Ë32
 
»ûived_où‘s
;

4860 
__Ë32
 
kbps
;

4861 
__Ë16
 
idË_¿tio
;

4862 
__Ë16
 
št_Ï‹ncy
;

4863 
__Ë16
 
ä“_kby‹s
;

4864 
__Ë32
 
¥¬e_1
;

4865 
__Ë32
 
¥¬e_2
;

4866 
__Ë32
 
¥¬e_3
;

4867 
u8
 
dr
[0];

4868 } 
__·cked
 
debug_pkt_g’_»pÜt_šd
;

4870 
__Ë16
 
vif
;

4871 
__Ë16
 
¡»am_id
;

4872 
__Ë32
 
du¿tiÚ
;

4873 
__Ë32
 
couÁ
;

4874 
__Ë32
 
çed_couÁ
;

4875 
__Ë32
 
où‘s
;

4876 
__Ë32
 
mbps
;

4877 
__Ë16
 
idË_¿tio
;

4878 
__Ë16
 
št_Ï‹ncy
;

4879 
__Ë32
 
‹¡”_»£rved1
;

4880 
__Ë32
 
‹¡”_»£rved2
;

4881 
__Ë32
 
¥¬e_1
;

4882 
__Ë32
 
¥¬e_2
;

4883 
__Ë32
 
¥¬e_3
;

4884 
u8
 
dr
[0];

4885 } 
__·cked
 
‹¡_h_‹¡”_»pÜt_šd
;

4887 
__Ë16
 
vif
;

4888 
__Ë32
 
¥¬e_1
;

4889 
__Ë32
 
¥¬e_2
;

4890 
__Ë32
 
¥¬e_3
;

4891 
u8
 
dr
[0];

4892 } 
__·cked
 
‹¡_¥¬e_1_šd
;

4894 
__Ë16
 
vif
;

4895 
__Ë32
 
¥¬e_1
;

4896 
__Ë32
 
¥¬e_2
;

4897 
__Ë32
 
¥¬e_3
;

4898 
u8
 
dr
[0];

4899 } 
__·cked
 
‹¡_¥¬e_2_šd
;

4901 
__Ë16
 
vif
;

4902 
__Ë32
 
¥¬e_1
;

4903 
__Ë32
 
¥¬e_2
;

4904 
__Ë32
 
¥¬e_3
;

4905 
u8
 
dr
[0];

4906 } 
__·cked
 
‹¡_¥¬e_3_šd
;

4908 
__Ë32
 
commªd_ty³
;

4909 
__Ë32
 
£qu’û_numb”
;

4910 
__Ë32
 
mÜe_d©a
;

4911 
__Ë32
 
¥¬e_1
;

4912 
__Ë32
 
¥¬e_2
;

4913 
__Ë32
 
¥¬e_3
;

4914 
u8
 
dr
[0];

4915 } 
__·cked
 
phy_ev’t_loggšg_šd
;

4917 
__Ë16
 
vif
;

4918 
__Ë32
 
¥¬e_1
;

4919 
__Ë32
 
¥¬e_2
;

4920 
__Ë32
 
¥¬e_3
;

4921 
u8
 
dr
[0];

4922 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_šd
;

4924 
__Ë16
 
vif
;

4925 
__Ë32
 
¥¬e_1
;

4926 
__Ë32
 
¥¬e_2
;

4927 
__Ë32
 
¥¬e_3
;

4928 
u8
 
dr
[0];

4929 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_šd
;

4931 
__Ë16
 
vif
;

4932 
__Ë32
 
¥¬e_1
;

4933 
__Ë32
 
¥¬e_2
;

4934 
__Ë32
 
¥¬e_3
;

4935 
u8
 
dr
[0];

4936 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_šd
;

4937 } 
u
;

4938 } 
__·cked
;

4940 
	#çpi_sig_size
(
mp_Çme
è((
u16
)
	`off£tof
(
çpi_sigÇl
, 
u
.mp_Çme.
dr
))

	)

4942 
	#çpi_g‘_sigid
(
mp_skb
è
	`Ë16_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->
id
)

	)

4944 
šlše
 
boŞ
 
çpi_is_mlme
(
sk_buff
 *
skb
)

4946  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_MLME
;

4949 
šlše
 
boŞ
 
çpi_is_ma
(
sk_buff
 *
skb
)

4951  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_MA
;

4954 
šlše
 
boŞ
 
çpi_is_debug
(
sk_buff
 *
skb
)

4956  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_DEBUG
;

4959 
šlše
 
boŞ
 
çpi_is_‹¡
(
sk_buff
 *
skb
)

4961  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_TEST
;

4964 
šlše
 
boŞ
 
çpi_is_»q
(
sk_buff
 *
skb
)

4966  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_REQ
;

4969 
šlše
 
boŞ
 
çpi_is_cfm
(
sk_buff
 *
skb
)

4971  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_CFM
;

4974 
šlše
 
boŞ
 
çpi_is_»s
(
sk_buff
 *
skb
)

4976  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_RES
;

4979 
šlše
 
boŞ
 
çpi_is_šd
(
sk_buff
 *
skb
)

4981  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_IND
;

4984 
šlše
 
u16
 
çpi_g‘_ex³ùed_size_bË
(
sk_buff
 *
skb
, cÚ¡ u16 
çpi_size_bË
[], 
size_t
 
bË_size
, u16 
¡¬t_id
)

4986 
u16
 
id
 = 
çpi_g‘_sigid
(
skb
);

4988 ià(
id
 < 
¡¬t_id
)

4991 ià(
id
 - 
¡¬t_id
 >ğ(
u16
)
bË_size
)

4994  
çpi_size_bË
[
id
 - 
¡¬t_id
];

4997 
šlše
 
u16
 
çpi_g‘_ex³ùed_size
(
sk_buff
 *
skb
)

4999 cÚ¡ 
u16
 
çpi_ma_»q_size_bË
[] = {

5000 
çpi_sig_size
(
ma_un™d©a_»q
),

5002 
çpi_sig_size
(
ma_¥¬e_1_»q
),

5003 
çpi_sig_size
(
ma_¥¬e_2_»q
),

5004 
çpi_sig_size
(
ma_¥¬e_3_»q
),

5005 
çpi_sig_size
(
ma_¥¬e_sigÇl_1_»q
),

5006 
çpi_sig_size
(
ma_¥¬e_sigÇl_2_»q
),

5007 
çpi_sig_size
(
ma_¥¬e_sigÇl_3_»q
),

5010 cÚ¡ 
u16
 
çpi_mlme_»q_size_bË
[] = {

5011 
çpi_sig_size
(
mlme_g‘_»q
),

5012 
çpi_sig_size
(
mlme_£t_»q
),

5013 
çpi_sig_size
(
mlme_pow”mgt_»q
),

5014 
çpi_sig_size
(
mlme_add_šfo_–em’ts_»q
),

5015 
çpi_sig_size
(
mlme_add_sÿn_»q
),

5016 
çpi_sig_size
(
mlme_d–_sÿn_»q
),

5017 
çpi_sig_size
(
mlme_add_vif_»q
),

5018 
çpi_sig_size
(
mlme_d–_vif_»q
),

5019 
çpi_sig_size
(
mlme_¡¬t_»q
),

5020 
çpi_sig_size
(
mlme_£t_chªÃl_»q
),

5021 
çpi_sig_size
(
mlme_cÚÃù_»q
),

5022 
çpi_sig_size
(
mlme_»assocŸ‹_»q
),

5023 
çpi_sig_size
(
mlme_rßm_»q
),

5024 
çpi_sig_size
(
mlme_discÚÃù_»q
),

5025 
çpi_sig_size
(
mlme_»gi¡”_aùiÚ_äame_»q
),

5026 
çpi_sig_size
(
mlme_£nd_äame_»q
),

5027 
çpi_sig_size
(
mlme_»£t_dw–l_time_»q
),

5028 
çpi_sig_size
(
mlme_£t_Œaffic_·¿m‘”s_»q
),

5029 
çpi_sig_size
(
mlme_d–_Œaffic_·¿m‘”s_»q
),

5030 
çpi_sig_size
(
mlme_£t_·ck‘_f‹r_»q
),

5031 
çpi_sig_size
(
mlme_£t__add»ss_»q
),

5032 
çpi_sig_size
(
mlme_£t_aş_»q
),

5034 
çpi_sig_size
(
mlme_£tkeys_»q
),

5036 
çpi_sig_size
(
mlme_g‘_key_£qu’û_»q
),

5041 
çpi_sig_size
(
mlme_£t_ÿched_chªÃls_»q
),

5042 
çpi_sig_size
(
mlme_£t_wh™–i¡_ssid_»q
),

5043 
çpi_sig_size
(
mlme_tdls_aùiÚ_»q
),

5044 
çpi_sig_size
(
mlme_chªÃl_sw™ch_»q
),

5045 
çpi_sig_size
(
mlme_mÚ™Ü_rssi_»q
),

5046 
çpi_sig_size
(
mlme_¡¬t_lšk_¡©i¡ics_»q
),

5047 
çpi_sig_size
(
mlme_¡İ_lšk_¡©i¡ics_»q
),

5050 
çpi_sig_size
(
mlme_ho¡_¡©e_»q
),

5051 
çpi_sig_size
(
mlme_add_¿nge_»q
),

5052 
çpi_sig_size
(
mlme_d–_¿nge_»q
),

5053 
çpi_sig_size
(
mlme_£t_nß_»q
),

5054 
çpi_sig_size
(
mlme_£t_ùwšdow_»q
),

5055 
çpi_sig_size
(
mlme_Çn_¡¬t_»q
),

5056 
çpi_sig_size
(
mlme_Çn_cÚfig_»q
),

5057 
çpi_sig_size
(
mlme_Çn_publish_»q
),

5058 
çpi_sig_size
(
mlme_Çn_subsüibe_»q
),

5059 
çpi_sig_size
(
mlme_Çn_fŞlowup_»q
),

5060 
çpi_sig_size
(
mlme_un£t_chªÃl_»q
),

5061 
çpi_sig_size
(
mlme_£t_couÁry_»q
),

5062 
çpi_sig_size
(
mlme_fÜw¬d_b—cÚ_»q
),

5063 
çpi_sig_size
(
mlme_ndp_»que¡_»q
),

5064 
çpi_sig_size
(
mlme_ndp_»¥Ú£_»q
),

5065 
çpi_sig_size
(
mlme_ndp_‹rmš©e_»q
),

5068 
çpi_sig_size
(
mlme_rßmšg_chªÃl_li¡_»q
),

5069 
çpi_sig_size
(
mlme_£t_bss_max_chªÃl_width_»q
),

5070 
çpi_sig_size
(
mlme_£t_sÿn_mode_»q
),

5071 
çpi_sig_size
(
mlme_š¡®l_­f_»q
),

5072 
çpi_sig_size
(
mlme_»ad_­f_»q
),

5073 
çpi_sig_size
(
mlme_£t_num_ª‹Âas_»q
),

5074 
çpi_sig_size
(
mlme_¬p_d‘eù_»q
),

5075 
çpi_sig_size
(
mlme_£t_rßmšg_ty³_»q
),

5076 
çpi_sig_size
(
mlme_£t_bªd_»q
),

5077 
çpi_sig_size
(
mlme_£t_rßmšg_·¿m‘”s_»q
),

5078 
çpi_sig_size
(
mlme_wifish¬šg_³rm™‹d_chªÃls_»q
),

5079 
çpi_sig_size
(
mlme_rßmšg_¡©e_»q
),

5080 
çpi_sig_size
(
mlme_¥¬e_8_»q
),

5081 
çpi_sig_size
(
mlme_cÚfigu»_mÚ™Ü_mode_»q
),

5082 
çpi_sig_size
(
mlme_¥¬e_9_»q
),

5083 
çpi_sig_size
(
mlme_¥¬e_10_»q
),

5084 
çpi_sig_size
(
mlme_¥¬e_11_»q
),

5085 
çpi_sig_size
(
mlme_Çn_¿nge_»q
),

5086 
çpi_sig_size
(
mlme_Çn_¿nge_ÿnûl_»q
),

5087 
çpi_sig_size
(
mlme_d–ba_»q
),

5088 
çpi_sig_size
(
mlme_g‘_num_ª‹Âas_»q
),

5089 
çpi_sig_size
(
mlme_¡¬t_d‘eù_»q
),

5090 
çpi_sig_size
(
mlme_¥¬e_12_»q
),

5091 
çpi_sig_size
(
mlme_¥¬e_13_»q
),

5092 
çpi_sig_size
(
mlme_£t_wtc_mode_»q
),

5093 
çpi_sig_size
(
mlme_twt_£tup_»q
),

5094 
çpi_sig_size
(
mlme_twt_‹¬down_»q
),

5095 
çpi_sig_size
(
mlme_twt_su¥’d_»q
),

5096 
çpi_sig_size
(
mlme_twt_¡©us_qu”y_»q
),

5097 
çpi_sig_size
(
mlme_­_½s_·¿ms_»q
),

5098 
çpi_sig_size
(
mlme_­_½s_»q
),

5099 
çpi_sig_size
(
mlme_£t_­_tx_pow”_»q
),

5100 
çpi_sig_size
(
mlme_g‘_­_tx_pow”_»q
),

5101 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_»q
),

5102 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_»q
),

5103 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_»q
),

5106 cÚ¡ 
u16
 
çpi_debug_»q_size_bË
[] = {

5107 
çpi_sig_size
(
debug_¥¬e_1_»q
),

5108 
çpi_sig_size
(
debug_¥¬e_2_»q
),

5109 
çpi_sig_size
(
debug_¥¬e_3_»q
),

5110 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_»q
),

5111 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_»q
),

5112 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_»q
),

5115 cÚ¡ 
u16
 
çpi_‹¡_»q_size_bË
[] = {

5116 
çpi_sig_size
(
‹¡_block_»que¡s_»q
),

5117 
çpi_sig_size
(
‹¡_·nic_»q
),

5118 
çpi_sig_size
(
‹¡_su¥’d_»q
),

5119 
çpi_sig_size
(
‹¡_»sume_»q
),

5120 
çpi_sig_size
(
¿dio_loggšg_»q
),

5121 
çpi_sig_size
(
wÏÆ™e_cw_¡¬t_»q
),

5122 
çpi_sig_size
(
wÏÆ™e_cw_¡İ_»q
),

5123 
çpi_sig_size
(
wÏÆ™e_tx_£t_·¿ms_»q
),

5124 
çpi_sig_size
(
wÏÆ™e_tx_¡¬t_»q
),

5125 
çpi_sig_size
(
wÏÆ™e_tx_»ad_»q
),

5126 
çpi_sig_size
(
wÏÆ™e_tx_¡İ_»q
),

5127 
çpi_sig_size
(
wÏÆ™e_rx_¡¬t_»q
),

5128 
çpi_sig_size
(
wÏÆ™e_rx_»ad_»q
),

5129 
çpi_sig_size
(
wÏÆ™e_rx_¡İ_»q
),

5130 
çpi_sig_size
(
wÏÆ™e_¡©us_»q
),

5131 
çpi_sig_size
(
‹¡_pm®loc_»q
),

5132 
çpi_sig_size
(
‹¡_cÚfigu»_mÚ™Ü_mode_»q
),

5134 
çpi_sig_size
(
‹¡_check_fw_®ive_»q
),

5135 
çpi_sig_size
(
debug_g’”ic_»q
),

5136 
çpi_sig_size
(
debug_pkt_sšk_¡¬t_»q
),

5137 
çpi_sig_size
(
debug_pkt_sšk_¡İ_»q
),

5138 
çpi_sig_size
(
debug_pkt_sšk_»pÜt_»q
),

5139 
çpi_sig_size
(
debug_pkt_g’_¡¬t_»q
),

5140 
çpi_sig_size
(
debug_pkt_g’_¡İ_»q
),

5141 
çpi_sig_size
(
debug_pkt_g’_»pÜt_»q
),

5142 
çpi_sig_size
(
wÏÆ™e_¿dio_£Ëù_»q
),

5143 
çpi_sig_size
(
‹¡_h_‹¡”_¡¬t_»q
),

5144 
çpi_sig_size
(
‹¡_h_‹¡”_¡İ_»q
),

5145 
çpi_sig_size
(
‹¡_h_‹¡”_£t_·¿ms_»q
),

5146 
çpi_sig_size
(
‹¡_h_‹¡”_»pÜt_»q
),

5147 
çpi_sig_size
(
‹¡_bi¡_g‘_tx_gaš_»q
),

5148 
çpi_sig_size
(
‹¡_¡¬t_wÏÆ™e_»q
),

5149 
çpi_sig_size
(
‹¡_¥¬e_2_»q
),

5150 
çpi_sig_size
(
‹¡_¥¬e_3_»q
),

5151 
çpi_sig_size
(
phy_ev’t_loggšg_»q
),

5152 
çpi_sig_size
(
‹¡_¥¬e_4_»q
),

5153 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_»q
),

5154 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_»q
),

5155 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_»q
),

5158 cÚ¡ 
u16
 
çpi_mlme_cfm_size_bË
[] = {

5159 
çpi_sig_size
(
mlme_g‘_cfm
),

5160 
çpi_sig_size
(
mlme_£t_cfm
),

5161 
çpi_sig_size
(
mlme_pow”mgt_cfm
),

5162 
çpi_sig_size
(
mlme_add_šfo_–em’ts_cfm
),

5163 
çpi_sig_size
(
mlme_add_sÿn_cfm
),

5164 
çpi_sig_size
(
mlme_d–_sÿn_cfm
),

5165 
çpi_sig_size
(
mlme_add_vif_cfm
),

5166 
çpi_sig_size
(
mlme_d–_vif_cfm
),

5167 
çpi_sig_size
(
mlme_¡¬t_cfm
),

5168 
çpi_sig_size
(
mlme_£t_chªÃl_cfm
),

5169 
çpi_sig_size
(
mlme_cÚÃù_cfm
),

5170 
çpi_sig_size
(
mlme_»assocŸ‹_cfm
),

5171 
çpi_sig_size
(
mlme_rßm_cfm
),

5172 
çpi_sig_size
(
mlme_discÚÃù_cfm
),

5173 
çpi_sig_size
(
mlme_»gi¡”_aùiÚ_äame_cfm
),

5174 
çpi_sig_size
(
mlme_£nd_äame_cfm
),

5175 
çpi_sig_size
(
mlme_»£t_dw–l_time_cfm
),

5176 
çpi_sig_size
(
mlme_£t_Œaffic_·¿m‘”s_cfm
),

5177 
çpi_sig_size
(
mlme_d–_Œaffic_·¿m‘”s_cfm
),

5178 
çpi_sig_size
(
mlme_£t_·ck‘_f‹r_cfm
),

5179 
çpi_sig_size
(
mlme_£t__add»ss_cfm
),

5180 
çpi_sig_size
(
mlme_£t_aş_cfm
),

5182 
çpi_sig_size
(
mlme_£tkeys_cfm
),

5184 
çpi_sig_size
(
mlme_g‘_key_£qu’û_cfm
),

5189 
çpi_sig_size
(
mlme_£t_ÿched_chªÃls_cfm
),

5190 
çpi_sig_size
(
mlme_£t_wh™–i¡_ssid_cfm
),

5191 
çpi_sig_size
(
mlme_tdls_aùiÚ_cfm
),

5192 
çpi_sig_size
(
mlme_chªÃl_sw™ch_cfm
),

5193 
çpi_sig_size
(
mlme_mÚ™Ü_rssi_cfm
),

5194 
çpi_sig_size
(
mlme_¡¬t_lšk_¡©i¡ics_cfm
),

5195 
çpi_sig_size
(
mlme_¡İ_lšk_¡©i¡ics_cfm
),

5198 
çpi_sig_size
(
mlme_ho¡_¡©e_cfm
),

5199 
çpi_sig_size
(
mlme_add_¿nge_cfm
),

5200 
çpi_sig_size
(
mlme_d–_¿nge_cfm
),

5201 
çpi_sig_size
(
mlme_£t_nß_cfm
),

5202 
çpi_sig_size
(
mlme_£t_ùwšdow_cfm
),

5203 
çpi_sig_size
(
mlme_Çn_¡¬t_cfm
),

5204 
çpi_sig_size
(
mlme_Çn_cÚfig_cfm
),

5205 
çpi_sig_size
(
mlme_Çn_publish_cfm
),

5206 
çpi_sig_size
(
mlme_Çn_subsüibe_cfm
),

5207 
çpi_sig_size
(
mlme_Çn_fŞlowup_cfm
),

5208 
çpi_sig_size
(
mlme_un£t_chªÃl_cfm
),

5209 
çpi_sig_size
(
mlme_£t_couÁry_cfm
),

5210 
çpi_sig_size
(
mlme_fÜw¬d_b—cÚ_cfm
),

5211 
çpi_sig_size
(
mlme_ndp_»que¡_cfm
),

5212 
çpi_sig_size
(
mlme_ndp_»¥Ú£_cfm
),

5213 
çpi_sig_size
(
mlme_ndp_‹rmš©e_cfm
),

5216 
çpi_sig_size
(
mlme_rßmšg_chªÃl_li¡_cfm
),

5217 
çpi_sig_size
(
mlme_£t_bss_max_chªÃl_width_cfm
),

5218 
çpi_sig_size
(
mlme_£t_sÿn_mode_cfm
),

5219 
çpi_sig_size
(
mlme_š¡®l_­f_cfm
),

5220 
çpi_sig_size
(
mlme_»ad_­f_cfm
),

5221 
çpi_sig_size
(
mlme_£t_num_ª‹Âas_cfm
),

5222 
çpi_sig_size
(
mlme_¬p_d‘eù_cfm
),

5223 
çpi_sig_size
(
mlme_£t_rßmšg_ty³_cfm
),

5224 
çpi_sig_size
(
mlme_£t_bªd_cfm
),

5225 
çpi_sig_size
(
mlme_£t_rßmšg_·¿m‘”s_cfm
),

5226 
çpi_sig_size
(
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
),

5227 
çpi_sig_size
(
mlme_rßmšg_¡©e_cfm
),

5228 
çpi_sig_size
(
mlme_¥¬e_8_cfm
),

5229 
çpi_sig_size
(
mlme_cÚfigu»_mÚ™Ü_mode_cfm
),

5230 
çpi_sig_size
(
mlme_¥¬e_9_cfm
),

5231 
çpi_sig_size
(
mlme_¥¬e_10_cfm
),

5232 
çpi_sig_size
(
mlme_¥¬e_11_cfm
),

5233 
çpi_sig_size
(
mlme_Çn_¿nge_cfm
),

5234 
çpi_sig_size
(
mlme_Çn_¿nge_ÿnûl_cfm
),

5235 
çpi_sig_size
(
mlme_d–ba_cfm
),

5236 
çpi_sig_size
(
mlme_g‘_num_ª‹Âas_cfm
),

5237 
çpi_sig_size
(
mlme_¡¬t_d‘eù_cfm
),

5238 
çpi_sig_size
(
mlme_¥¬e_12_cfm
),

5239 
çpi_sig_size
(
mlme_¥¬e_13_cfm
),

5240 
çpi_sig_size
(
mlme_£t_wtc_mode_cfm
),

5241 
çpi_sig_size
(
mlme_twt_£tup_cfm
),

5242 
çpi_sig_size
(
mlme_twt_‹¬down_cfm
),

5243 
çpi_sig_size
(
mlme_twt_su¥’d_cfm
),

5244 
çpi_sig_size
(
mlme_twt_¡©us_qu”y_cfm
),

5245 
çpi_sig_size
(
mlme_­_½s_·¿ms_cfm
),

5246 
çpi_sig_size
(
mlme_­_½s_cfm
),

5247 
çpi_sig_size
(
mlme_£t_­_tx_pow”_cfm
),

5248 
çpi_sig_size
(
mlme_g‘_­_tx_pow”_cfm
),

5249 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_cfm
),

5250 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_cfm
),

5251 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_cfm
),

5254 cÚ¡ 
u16
 
çpi_debug_cfm_size_bË
[] = {

5255 
çpi_sig_size
(
debug_¥¬e_1_cfm
),

5256 
çpi_sig_size
(
debug_¥¬e_2_cfm
),

5257 
çpi_sig_size
(
debug_¥¬e_3_cfm
),

5258 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_cfm
),

5259 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_cfm
),

5260 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_cfm
),

5263 cÚ¡ 
u16
 
çpi_‹¡_cfm_size_bË
[] = {

5264 
çpi_sig_size
(
¿dio_loggšg_cfm
),

5265 
çpi_sig_size
(
wÏÆ™e_cw_¡¬t_cfm
),

5266 
çpi_sig_size
(
wÏÆ™e_tx_£t_·¿ms_cfm
),

5267 
çpi_sig_size
(
wÏÆ™e_cw_¡İ_cfm
),

5268 
çpi_sig_size
(
wÏÆ™e_tx_¡¬t_cfm
),

5269 
çpi_sig_size
(
wÏÆ™e_tx_»ad_cfm
),

5270 
çpi_sig_size
(
wÏÆ™e_tx_¡İ_cfm
),

5271 
çpi_sig_size
(
wÏÆ™e_rx_¡¬t_cfm
),

5272 
çpi_sig_size
(
wÏÆ™e_rx_»ad_cfm
),

5273 
çpi_sig_size
(
wÏÆ™e_rx_¡İ_cfm
),

5274 
çpi_sig_size
(
wÏÆ™e_¡©us_cfm
),

5275 
çpi_sig_size
(
‹¡_pm®loc_cfm
),

5276 
çpi_sig_size
(
‹¡_cÚfigu»_mÚ™Ü_mode_cfm
),

5278 
çpi_sig_size
(
‹¡_check_fw_®ive_cfm
),

5279 
çpi_sig_size
(
‹¡_su¥’d_cfm
),

5280 
çpi_sig_size
(
‹¡_»sume_cfm
),

5281 
çpi_sig_size
(
debug_g’”ic_cfm
),

5282 
çpi_sig_size
(
wÏÆ™e_¿dio_£Ëù_cfm
),

5283 
çpi_sig_size
(
‹¡_h_‹¡”_¡¬t_cfm
),

5284 
çpi_sig_size
(
‹¡_h_‹¡”_¡İ_cfm
),

5285 
çpi_sig_size
(
‹¡_h_‹¡”_£t_·¿ms_cfm
),

5286 
çpi_sig_size
(
‹¡_bi¡_g‘_tx_gaš_cfm
),

5287 
çpi_sig_size
(
‹¡_¡¬t_wÏÆ™e_cfm
),

5288 
çpi_sig_size
(
‹¡_¥¬e_2_cfm
),

5289 
çpi_sig_size
(
‹¡_¥¬e_3_cfm
),

5290 
çpi_sig_size
(
phy_ev’t_loggšg_cfm
),

5291 
çpi_sig_size
(
‹¡_¥¬e_4_cfm
),

5292 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_cfm
),

5293 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_cfm
),

5294 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_cfm
),

5297 cÚ¡ 
u16
 
çpi_ma_šd_size_bË
[] = {

5298 
çpi_sig_size
(
ma_un™d©a_šd
),

5299 
çpi_sig_size
(
ma_blockack»q_šd
),

5300 
çpi_sig_size
(
ma_¥¬e_1_šd
),

5301 
çpi_sig_size
(
ma_¥¬e_2_šd
),

5302 
çpi_sig_size
(
ma_¥¬e_3_šd
),

5303 
çpi_sig_size
(
ma_¥¬e_sigÇl_1_šd
),

5304 
çpi_sig_size
(
ma_¥¬e_sigÇl_2_šd
),

5305 
çpi_sig_size
(
ma_¥¬e_sigÇl_3_šd
),

5308 cÚ¡ 
u16
 
çpi_mlme_šd_size_bË
[] = {

5309 
çpi_sig_size
(
mlme_sÿn_šd
),

5310 
çpi_sig_size
(
mlme_sÿn_dÚe_šd
),

5311 
çpi_sig_size
(
mlme_li¡’_’d_šd
),

5312 
çpi_sig_size
(
mlme_cÚÃù_šd
),

5313 
çpi_sig_size
(
mlme_cÚÃùed_šd
),

5314 
çpi_sig_size
(
mlme_»assocŸ‹_šd
),

5315 
çpi_sig_size
(
mlme_rßm_šd
),

5316 
çpi_sig_size
(
mlme_rßmed_šd
),

5318 
çpi_sig_size
(
mlme_discÚÃùed_šd
),

5319 
çpi_sig_size
(
mlme_´oûdu»_¡¬‹d_šd
),

5320 
çpi_sig_size
(
mlme_mic_çu»_šd
),

5321 
çpi_sig_size
(
mlme_äame_ŒªsmissiÚ_šd
),

5322 
çpi_sig_size
(
mlme_»ûived_äame_šd
),

5324 
çpi_sig_size
(
mlme_tdls_³”_šd
),

5327 
çpi_sig_size
(
mlme_rssi_»pÜt_šd
),

5328 
çpi_sig_size
(
mlme_ac_´iÜ™y_upd©e_šd
),

5329 
çpi_sig_size
(
mlme_¿nge_šd
),

5330 
çpi_sig_size
(
mlme_¿nge_dÚe_šd
),

5331 
çpi_sig_size
(
mlme_ev’t_log_šd
),

5332 
çpi_sig_size
(
mlme_Çn_ev’t_šd
),

5333 
çpi_sig_size
(
mlme_Çn_£rviû_šd
),

5334 
çpi_sig_size
(
mlme_Çn_fŞlowup_šd
),

5335 
çpi_sig_size
(
mlme_chªÃl_sw™ched_šd
),

5336 
çpi_sig_size
(
mlme_synchrÚi£d_šd
),

5337 
çpi_sig_size
(
mlme_b—cÚ_»pÜtšg_ev’t_šd
),

5338 
çpi_sig_size
(
mlme_rßmšg_chªÃl_li¡_šd
),

5339 
çpi_sig_size
(
mlme_bÏckli¡ed_šd
),

5340 
çpi_sig_size
(
mlme_ndp_»que¡_šd
),

5341 
çpi_sig_size
(
mlme_ndp_»que¡ed_šd
),

5342 
çpi_sig_size
(
mlme_ndp_»¥Ú£_šd
),

5344 
çpi_sig_size
(
mlme_ndp_‹rmš©ed_šd
),

5345 
çpi_sig_size
(
mlme_Çn_¿nge_ÿnûÎed_šd
),

5346 
çpi_sig_size
(
mlme_¥¬e_6_šd
),

5347 
çpi_sig_size
(
mlme_Çn_¿nge_šd
),

5348 
çpi_sig_size
(
mlme_¥¬e_7_šd
),

5349 
çpi_sig_size
(
mlme_¡¬t_d‘eù_šd
),

5350 
çpi_sig_size
(
mlme_¥¬e_8_šd
),

5351 
çpi_sig_size
(
mlme_twt_£tup_šd
),

5352 
çpi_sig_size
(
mlme_twt_‹¬down_šd
),

5353 
çpi_sig_size
(
mlme_twt_nÙify_šd
),

5354 
çpi_sig_size
(
mlme_¥¬e_9_šd
),

5355 
çpi_sig_size
(
mlme_¥¬e_10_šd
),

5356 
çpi_sig_size
(
mlme_blockack_aùiÚ_šd
),

5357 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_šd
),

5358 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_šd
),

5359 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_šd
),

5362 cÚ¡ 
u16
 
çpi_debug_šd_size_bË
[] = {

5363 
çpi_sig_size
(
debug_wÜd12_šd
),

5364 
çpi_sig_size
(
debug_çuÉ_šd
),

5365 
çpi_sig_size
(
debug_wÜds_šd
),

5366 
çpi_sig_size
(
debug_¥¬e_2_šd
),

5367 
çpi_sig_size
(
debug_¥¬e_3_šd
),

5368 
çpi_sig_size
(
debug_¥¬e_4_šd
),

5369 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_šd
),

5370 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_šd
),

5371 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_šd
),

5374 cÚ¡ 
u16
 
çpi_‹¡_šd_size_bË
[] = {

5375 
çpi_sig_size
(
¿dio_loggšg_šd
),

5376 
çpi_sig_size
(
debug_g’”ic_šd
),

5377 
çpi_sig_size
(
debug_pkt_sšk_»pÜt_šd
),

5378 
çpi_sig_size
(
debug_pkt_g’_»pÜt_šd
),

5379 
çpi_sig_size
(
‹¡_h_‹¡”_»pÜt_šd
),

5380 
çpi_sig_size
(
‹¡_¥¬e_1_šd
),

5381 
çpi_sig_size
(
‹¡_¥¬e_2_šd
),

5382 
çpi_sig_size
(
‹¡_¥¬e_3_šd
),

5383 
çpi_sig_size
(
phy_ev’t_loggšg_šd
),

5384 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_šd
),

5385 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_šd
),

5386 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_šd
),

5389 cÚ¡ 
u16
 
çpi_mlme_»s_size_bË
[] = {

5390 
çpi_sig_size
(
mlme_cÚÃù_»s
),

5391 
çpi_sig_size
(
mlme_cÚÃùed_»s
),

5392 
çpi_sig_size
(
mlme_»assocŸ‹_»s
),

5393 
çpi_sig_size
(
mlme_rßmed_»s
),

5395 
çpi_sig_size
(
mlme_synchrÚi£d_»s
),

5396 
çpi_sig_size
(
mlme_¥¬e_2_»s
),

5397 
çpi_sig_size
(
mlme_¥¬e_3_»s
),

5398 
çpi_sig_size
(
mlme_¥¬e_4_»s
),

5399 
çpi_sig_size
(
mlme_¥¬e_5_»s
),

5400 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_»s
),

5401 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_»s
),

5402 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_»s
),

5405 cÚ¡ 
u16
 
çpi_ma_»s_size_bË
[] = {

5406 
çpi_sig_size
(
ma_¥¬e_1_»s
),

5407 
çpi_sig_size
(
ma_¥¬e_2_»s
),

5408 
çpi_sig_size
(
ma_¥¬e_3_»s
),

5409 
çpi_sig_size
(
ma_¥¬e_sigÇl_1_»s
),

5410 
çpi_sig_size
(
ma_¥¬e_sigÇl_2_»s
),

5411 
çpi_sig_size
(
ma_¥¬e_sigÇl_3_»s
),

5414 cÚ¡ 
u16
 
çpi_debug_»s_size_bË
[] = {

5415 
çpi_sig_size
(
debug_¥¬e_1_»s
),

5416 
çpi_sig_size
(
debug_¥¬e_2_»s
),

5417 
çpi_sig_size
(
debug_¥¬e_3_»s
),

5418 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_»s
),

5419 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_»s
),

5420 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_»s
),

5423 cÚ¡ 
u16
 
çpi_‹¡_»s_size_bË
[] = {

5424 
çpi_sig_size
(
‹¡_¥¬e_1_»s
),

5425 
çpi_sig_size
(
‹¡_¥¬e_2_»s
),

5426 
çpi_sig_size
(
‹¡_¥¬e_3_»s
),

5427 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_»s
),

5428 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_»s
),

5429 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_»s
),

5432 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»q
(skb))

5433  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_»q_size_bË
, 
ARRAY_SIZE
(çpi_mlme_»q_size_bË), 
MLME_GET_REQ
);

5434 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_cfm
(skb))

5435  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_cfm_size_bË
, 
ARRAY_SIZE
(çpi_mlme_cfm_size_bË), 
MLME_GET_CFM
);

5436 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

5437  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_»s_size_bË
, 
ARRAY_SIZE
(çpi_mlme_»s_size_bË), 
MLME_CONNECT_RES
);

5438 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_šd
(skb))

5439  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_šd_size_bË
, 
ARRAY_SIZE
(çpi_mlme_šd_size_bË), 
MLME_SCAN_IND
);

5440 ià(
çpi_is_ma
(
skb
è&& 
çpi_is_»q
(skb))

5441  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_ma_»q_size_bË
, 
ARRAY_SIZE
(çpi_ma_»q_size_bË), 
MA_UNITDATA_REQ
);

5442 ià(
çpi_is_ma
(
skb
è&& 
çpi_is_šd
(skb))

5443  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_ma_šd_size_bË
, 
ARRAY_SIZE
(çpi_ma_šd_size_bË), 
MA_UNITDATA_IND
);

5444 ià(
çpi_is_debug
(
skb
è&& 
çpi_is_»q
(skb))

5445  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_»q_size_bË
, 
ARRAY_SIZE
(çpi_debug_»q_size_bË), 
DEBUG_GENERIC_REQ
);

5446 ià(
çpi_is_debug
(
skb
è&& 
çpi_is_cfm
(skb))

5447  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_cfm_size_bË
, 
ARRAY_SIZE
(çpi_debug_cfm_size_bË), 
DEBUG_GENERIC_CFM
);

5448 ià(
çpi_is_debug
(
skb
è&& 
çpi_is_šd
(skb))

5449  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_šd_size_bË
, 
ARRAY_SIZE
(çpi_debug_šd_size_bË), 
DEBUG_WORD12IND
);

5450 ià(
çpi_is_‹¡
(
skb
è&& 
çpi_is_»q
(skb))

5451  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_»q_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_»q_size_bË), 
TEST_BLOCK_REQUESTS_REQ
);

5452 ià(
çpi_is_‹¡
(
skb
è&& 
çpi_is_cfm
(skb))

5453  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_cfm_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_cfm_size_bË), 
RADIO_LOGGING_CFM
);

5454 ià(
çpi_is_‹¡
(
skb
è&& 
çpi_is_šd
(skb))

5455  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_šd_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_šd_size_bË), 
RADIO_LOGGING_IND
);

5456 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

5457  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_ma_»s_size_bË
, 
ARRAY_SIZE
(çpi_ma_»s_size_bË), 
MA_SPARE_SIGNAL_1_RES
);

5458 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

5459  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_»s_size_bË
, 
ARRAY_SIZE
(çpi_debug_»s_size_bË), 
DEBUG_SPARE_SIGNAL_1_RES
);

5460 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

5461  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_»s_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_»s_size_bË), 
TEST_SPARE_SIGNAL_1_RES
);

5466 #ifdeà
__ılu¥lus


	@fw_test.c

6 
	~<Ãt/cfg80211.h
>

7 
	~<lšux/‘h”deviû.h
>

8 
	~"dev.h
"

9 
	~"çpi.h
"

10 
	~"fw_‹¡.h
"

11 
	~"debug.h
"

12 
	~"mgt.h
"

13 
	~"mlme.h
"

14 
	~"Ãtif.h
"

15 
	~"ba.h
"

16 
	~"§p_mlme.h
"

17 #ifdeà
CONFIG_SCSC_WLAN_TX_API


18 
	~"tx_­i.h
"

21 
¦si_fw_‹¡_§ve_äame
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
§ved_skbs
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1], sk_bufà*
skb
, 
boŞ
 
udi_h—d”
)

23 
u16
 
	gvif
;

25 
	gskb
 = 
skb_cİy
(
skb
, 
GFP_KERNEL
);

27 ià(
	gudi_h—d”
)

28 
skb_puÎ
(
skb
, (
udi_msg_t
));

30 
	gvif
 = 
çpi_g‘_vif
(
skb
);

32 
SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "sig:0x%.4X, vif:%d\n", 
çpi_g‘_sigid
(
skb
), 
vif
);

33 
¦si_debug_äame
(
sdev
, 
NULL
, 
skb
, "SAVE");

35 
¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

36 
kä“_skb
(
§ved_skbs
[
vif
]);

37 
	g§ved_skbs
[
vif
] = 
skb
;

38 
¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

41 
	$¦si_fw_‹¡_´oûss_äame
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
, 
boŞ
 
udi_h—d”
)

43 
u16
 
vif
;

45 
skb
 = 
	`skb_cİy
(skb, 
GFP_KERNEL
);

47 ià(
udi_h—d”
)

48 
	`skb_puÎ
(
skb
, (
udi_msg_t
));

50 
vif
 = 
	`çpi_g‘_vif
(
skb
);

52 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "sig:0x%.4X, vif:%d\n", 
	`çpi_g‘_sigid
(
skb
), 
vif
);

53 
	`¦si_debug_äame
(
sdev
, 
NULL
, 
skb
, "PROCESS");

55 
	`¦si_skb_wÜk_’queue
(&
fw‹¡
->
fw_‹¡_wÜk
, 
skb
);

56 
	}
}

58 
	$¦si_fw_‹¡_sigÇl
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

60 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

63 
fw‹¡
->
fw_‹¡_’abËd
 = 
Œue
;

64 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "0x%p: sig:0x%.4X, vif:%d\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

66 ià(
	`WARN
(
vif
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
, "vif(%d) > CONFIG_SCSC_WLAN_MAX_INTERFACES", vif))

67  -
EINVAL
;

69 
	`çpi_g‘_sigid
(
skb
)) {

70 
MLME_ADD_VIF_REQ
:

71 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_ADD_VIF_REQ(0x%.4X, vif:%d)\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

72 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_add_vif_»q
, 
skb
, 
çl£
);

73 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
çl£
);

75 
MLME_CONNECT_REQ
:

76 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_CONNECT_REQ(0x%.4X, vif:%d)\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

77 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_cÚÃù_»q
, 
skb
, 
çl£
);

79 
MLME_DEL_VIF_REQ
:

80 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_DEL_VIF_REQ(0x%.4X, vif:%d)\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

81 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
çl£
);

88 
	}
}

90 
	$¦si_fw_‹¡_sigÇl_w™h_udi_h—d”
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

92 
udi_msg_t
 *
udi_msg
 = (udi_msg_ˆ*)
skb
->
d©a
;

93 
çpi_vif_sigÇl_h—d”
 *
çpi_h—d”
 = (çpi_vif_sigÇl_h—d” *)(
skb
->
d©a
 + (
udi_msg_t
));

95 ià(!
fw‹¡
->
fw_‹¡_’abËd
)

98 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "0x%p: sig:0x%.4X, vif:%d\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

100 ià(
udi_msg
->
dœeùiÚ
 =ğ
SLSI_LOG_DIRECTION_TO_HOST
) {

101 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
)) {

102 
MLME_DISCONNECTED_IND
:

103 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_DISCONNECTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

104 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

106 
MLME_CONNECT_IND
:

107 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_CONNECT_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

108 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

110 
MLME_CONNECTED_IND
:

111 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_CONNECTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

112 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

114 
MLME_ROAMED_IND
:

115 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_ROAMED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

116 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

118 
MLME_TDLS_PEER_IND
:

119 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_TDLS_PEER_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

120 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

122 
MLME_CONNECT_CFM
:

123 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_CONNECT_CFM(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

124 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_cÚÃù_cfm
, 
skb
, 
Œue
);

126 
MLME_PROCEDURE_STARTED_IND
:

127 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_PROCEDURE_STARTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

128 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_´oûdu»_¡¬‹d_šd
, 
skb
, 
Œue
);

129 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_PROCEDURE_STARTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

130 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

132 
MLME_START_CFM
:

133 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_START_CFM(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

134 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

135 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
 = 
SLSI_DEFAULT_AP_DISCONNECT_IND_TIMEOUT
;

137 
MA_BLOCKACKREQ_IND
:

138 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MA_BLOCKACKREQ_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

139 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

147 
	}
}

149 
	$¦si_fw_‹¡_cÚÃù_¡©iÚ_rßm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

151 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

152 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

153 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

154 
sk_buff
 *
mlme_´oûdu»_¡¬‹d_šd
;

156 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

158 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ CÚÃù(vif:%dèRßm\n", 
ndev_vif
->
iâum
);

160 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

163 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

166 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not Station Vif"))

169 ià(
	`WARN
(!
³”
, "peer‚ot found"))

172 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

173 
mlme_´oûdu»_¡¬‹d_šd
 = 
fw‹¡
->mlme_´oûdu»_¡¬‹d_šd[
ndev_vif
->
iâum
];

174 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
] = 
NULL
;

175 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

177 ià(
	`WARN
(!
mlme_´oûdu»_¡¬‹d_šd
, "mlme_procedure_started_ind‚ot found"))

180 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

182 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
mgmt
->
bssid
);

183 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
mlme_´oûdu»_¡¬‹d_šd
);

184 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
	`skb_cİy
(
skb
, 
GFP_KERNEL
));

185 
	}
}

187 
	$¦si_fw_‹¡_cÚÃù_¡¬t_¡©iÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

189 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

190 
sk_buff
 *
»q
;

191 
sk_buff
 *
cfm
;

192 
sk_buff
 *
šd
;

193 
¦si_³”
 *
³”
;

194 
u8
 
bssid
[
ETH_ALEN
];

196 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

198 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ CÚÃù S¹(vif:%d)\n", 
ndev_vif
->
iâum
);

200 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

202 ià(
	`WARN
(
ndev_vif
->
aùiv©ed
, "Already Activated"))

205 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

206 
»q
 = 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
];

207 
cfm
 = 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
];

208 
šd
 = 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
];

209 ià(
»q
)

210 
	`SLSI_ETHER_COPY
(
bssid
, 
	`çpi_g‘_buff
(
»q
, 
u
.
mlme_cÚÃù_»q
.bssid));

211 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

213 ià(
	`WARN
(!
»q
, "mlme_connect_req Not found"))

215 ià(
	`WARN
(!
cfm
, "mlme_connect_cfm Not found"))

218 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

219 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

220 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_STATION
;

222 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d slsi_vif_aùiv©ed\n", 
ndev_vif
->
iâum
);

223 ià(
	`WARN
(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0, "slsi_vif_activated() Failed"))

226 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
bssid
, 
SLSI_STA_PEER_QUEUESET
 + 1);

227 ià(
	`WARN
(!
³”
, "¦si_³”_add(%pMèFaed", 
bssid
)) {

228 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

232 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
	`skb_cİy
(
skb
, 
GFP_KERNEL
));

233 
	}
}

235 
	$¦si_fw_‹¡_cÚÃù_¡©iÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

237 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

238 
sk_buff
 *
»q
;

239 
sk_buff
 *
cfm
;

240 
sk_buff
 *
šd
;

241 
¦si_³”
 *
³”
;

242 
u16
 
»suÉ
;

244 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

246 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ CÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

248 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

251 
»suÉ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃù_šd
.
»suÉ_code
);

253 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

254 
»q
 = 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
];

255 
cfm
 = 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
];

256 
šd
 = 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
];

257 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
] = 
NULL
;

258 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
] = 
NULL
;

259 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
] = 
NULL
;

260 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

262 ià(
	`WARN
(!
»q
, "mlme_connect_req Not found"))

263 
ex™
;

264 ià(
	`WARN
(!
cfm
, "mlme_connect_cfm Not found"))

265 
ex™
;

266 ià(
FAPI_RESULTCODE_SUCCESS
 =ğ
»suÉ
 &&

267 
	`WARN
(!
šd
, "mlme_procedure_started_ind Not found"))

268 
ex™
;

269 ià(
FAPI_RESULTCODE_SUCCESS
 !ğ
»suÉ
)

270 
ex™
;

272 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

275 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
»q
, 
u
.
mlme_cÚÃù_»q
.
bssid
));

276 ià(
	`WARN
(!
³”
, "¦si_g‘_³”_äom_mac(%pMèFaed", 
	`çpi_g‘_buff
(
»q
, 
u
.
mlme_cÚÃù_»q
.
bssid
)))

277 
ex™
;

279 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

280 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

282 
ex™
:

283 
	`kä“_skb
(
»q
);

284 
	`kä“_skb
(
cfm
);

285 
	`kä“_skb
(
šd
);

286 
	}
}

288 
	$¦si_fw_‹¡_¡¬‹d_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

290 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

291 
u16
 
»suÉ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¡¬t_cfm
.
»suÉ_code
);

293 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

295 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

297 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ N‘wÜk(vif:%d)\n", 
ndev_vif
->
iâum
);

299 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

301 ià(
	`WARN
(
ndev_vif
->
aùiv©ed
, "Already Activated"))

304 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_AP
;

305 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_AP
;

306 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_AP
;

308 ià(
	`WARN
(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0, "slsi_vif_activated() Failed"))

311 ià(
FAPI_RESULTCODE_SUCCESS
 =ğ
»suÉ
)

312 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

313 
	}
}

315 
	$¦si_fw_‹¡_¡İ_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

317 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

319 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

320 
	`SLSI_UNUSED_PARAMETER
(
skb
);

322 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

324 ià(!
ndev_vif
->
is_fw_‹¡
)

327 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "Stİpšg N‘wÜk(vif:%d)\n", 
ndev_vif
->
iâum
);

329 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

332 
	`Ãtif_ÿ¼›r_off
(
dev
);

333 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

334 
	}
}

336 
	$¦si_fw_‹¡_cÚÃù_¡¬t_­
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

338 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

339 
¦si_³”
 *
³”
 = 
NULL
;

340 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

341 
u16
 
³”_šdex
;

342 
u16
 
æow_id
;

344 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

346 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

348 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸CÚÃù S¹(vif:%d)\n", 
ndev_vif
->
iâum
);

349 
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test");

351 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

354 ià(
	`WARN_ON
(!
	`›“80211_is_assoc_»q
(
mgmt
->
äame_cÚŒŞ
) &&

355 !
	`›“80211_is_»assoc_»q
(
mgmt
->
äame_cÚŒŞ
)))

357 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.flow_id);

358 
³”_šdex
 = (
æow_id
 >> 8);

360 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
mgmt
->
§
, 
³”_šdex
);

361 ià(
	`WARN_ON
(!
³”
))

364 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
	`skb_cİy
(
skb
, 
GFP_KERNEL
));

365 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTING
;

366 
	}
}

368 
	$¦si_fw_‹¡_cÚÃùed_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

370 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

371 
¦si_³”
 *
³”
 = 
NULL
;

372 
u16
 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃùed_šd
.flow_id);

373 
u16
 
aid
 = (
æow_id
 >> 8);

375 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

377 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

379 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸CÚÃù(vif:%d,‡id:%d)\n", 
ndev_vif
->
iâum
, 
aid
);

380 
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test");

382 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

385 ià(
	`WARN_ON
(
aid
 > 
SLSI_PEER_INDEX_MAX
))

388 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
aid
 - 1);

389 ià(
	`WARN
(!
³”
, "P“r×id:%dèNÙ Found", 
aid
))

392 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

393 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

395 
	`¦si_rx_bufã»d_äames
(
sdev
, 
dev
, 
³”
);

396 
	}
}

399 
	$¦si_fw_‹¡_´oûdu»_¡¬‹d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

401 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

402 
sk_buff
 *
add_vif_»q
;

403 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

405 ià(!
ndev_vif
->
is_fw_‹¡
) {

406 
	`kä“_skb
(
skb
);

410 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "Proûdu»S¹ed(vif:%d)\n", 
ndev_vif
->
iâum
);

412 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
è!ğ
FAPI_PROCEDURETYPE_CONNECTION_STARTED
) {

413 
	`kä“_skb
(
skb
);

418 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

419 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

420 ià(
add_vif_»q
)

421 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

422 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

424 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ UDIe¡ N‘Deviû(vif:%d)\n", 
ndev_vif
->
iâum
);

425 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

426 
out
;

428 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

430 
viáy³
) {

431 
FAPI_VIFTYPE_STATION
:

432 
	`¦si_fw_‹¡_cÚÃù_¡¬t_¡©iÚ
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

434 
FAPI_VIFTYPE_AP
:

435 
	`¦si_fw_‹¡_cÚÃù_¡¬t_­
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

438 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

442 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

444 
out
:

445 
	`kä“_skb
(
skb
);

446 
	}
}

449 
	$¦si_fw_‹¡_cÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

451 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

452 
sk_buff
 *
add_vif_»q
;

453 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

455 ià(!
ndev_vif
->
is_fw_‹¡
) {

456 
	`kä“_skb
(
skb
);

460 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸CÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

462 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

463 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

464 ià(
add_vif_»q
)

465 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

466 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

468 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ UDIe¡ N‘Deviû(vif:%d)\n", 
ndev_vif
->
iâum
);

469 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

470 
out
;

472 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

474 
viáy³
) {

475 
FAPI_VIFTYPE_STATION
:

476 
	`¦si_fw_‹¡_cÚÃù_¡©iÚ
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

479 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

483 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

485 
out
:

486 
	`kä“_skb
(
skb
);

487 
	}
}

489 
	$¦si_fw_‹¡_cÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

491 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

492 
sk_buff
 *
add_vif_»q
;

493 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

495 ià(!
ndev_vif
->
is_fw_‹¡
) {

496 
	`kä“_skb
(
skb
);

500 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "CÚÃùed(vif:%d)\n", 
ndev_vif
->
iâum
);

502 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

503 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

504 ià(
add_vif_»q
)

505 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

506 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

508 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

509 
out
;

511 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

513 
viáy³
) {

514 
FAPI_VIFTYPE_AP
:

515 
	`¦si_fw_‹¡_cÚÃùed_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

518 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

522 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

524 
out
:

525 
	`kä“_skb
(
skb
);

526 
	}
}

528 
	$¦si_fw_‹¡_rßmed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

530 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

531 
sk_buff
 *
add_vif_»q
;

532 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

534 ià(!
ndev_vif
->
is_fw_‹¡
) {

535 
	`kä“_skb
(
skb
);

539 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "Rßmed(vif:%d)\n", 
ndev_vif
->
iâum
);

541 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

542 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

543 ià(
add_vif_»q
)

544 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

545 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

547 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

548 
out
;

550 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

552 
viáy³
) {

553 
FAPI_VIFTYPE_STATION
:

554 
	`¦si_fw_‹¡_cÚÃù_¡©iÚ_rßm
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

557 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

561 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

563 
out
:

564 
	`kä“_skb
(
skb
);

565 
	}
}

567 
	$¦si_fw_‹¡_discÚÃù_¡©iÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

569 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

570 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

572 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

573 
	`SLSI_UNUSED_PARAMETER
(
skb
);

575 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

577 ià(!
ndev_vif
->
is_fw_‹¡
)

580 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ DiscÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

582 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

585 
	`Ãtif_ÿ¼›r_off
(
dev
);

586 ià(
³”
) {

587 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

588 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

589 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

591 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

592 
	}
}

594 
	$¦si_fw_‹¡_discÚÃù_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

596 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

600 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
));

602 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

604 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

606 ià(!
ndev_vif
->
is_fw_‹¡
)

609 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸DiscÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

611 ià(
³”
) {

612 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

613 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

614 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

616 
	}
}

618 
	$¦si_fw_‹¡_discÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

620 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

621 
sk_buff
 *
add_vif_»q
;

622 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

624 ià(!
ndev_vif
->
is_fw_‹¡
) {

625 
	`kä“_skb
(
skb
);

629 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

630 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

631 ià(
add_vif_»q
)

632 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

633 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

635 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

636 
out
;

638 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

640 
viáy³
) {

641 
FAPI_VIFTYPE_STATION
:

642 
	`¦si_fw_‹¡_discÚÃù_¡©iÚ
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

644 
FAPI_VIFTYPE_AP
:

645 
	`¦si_fw_‹¡_discÚÃù_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

648 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

651 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

653 
out
:

654 
	`kä“_skb
(
skb
);

655 
	}
}

657 
	$¦si_fw_‹¡_tdls_ev’t_cÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

659 
¦si_³”
 *
³”
 = 
NULL
;

660 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

661 
u16
 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.flow_id);

662 
u16
 
³”_šdex
 = (
æow_id
 >> 8);

665 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

666 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
Œue
;

667 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "TDLS cÚÃù (vif:%d,…“r_šdex:%d, mac:%pM)\n", 
	`çpi_g‘_vif
(
skb
), 
³”_šdex
, 
	`çpi_g‘_buff
(skb, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

669 ià((
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
è+ 1 > 
SLSI_TDLS_PEER_CONNECTIONS_MAX
) {

670 
	`SLSI_NET_ERR
(
dev
, "max TDLS†im™„—ched (³”_šdex:%d)\n", 
³”_šdex
);

671 
out
;

674 ià(
³”_šdex
 < 
SLSI_TDLS_PEER_INDEX_MIN
 ||…“r_šdex > 
SLSI_TDLS_PEER_INDEX_MAX
) {

675 
	`SLSI_NET_ERR
(
dev
, "šcÜ»ù index (³”_šdex:%d)\n", 
³”_šdex
);

676 
out
;

679 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
), 
³”_šdex
);

680 ià(!
³”
) {

681 
	`SLSI_NET_ERR
(
dev
, "peer‡dd failed\n");

682 
out
;

686 
³”
->
qos_’abËd
 = 
Œue
;

687 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

689 #ifdeà
CONFIG_SCSC_WLAN_TX_API


690 
	`¦si_tx_tdls_upd©e
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
Œue
);

693 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
Œue
);

695 
out
:

696 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

697 
	}
}

699 
	$¦si_fw_‹¡_tdls_ev’t_discÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

701 
¦si_³”
 *
³”
 = 
NULL
;

702 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

704 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

705 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "TDLS dis-cÚÃù (vif:%d, mac:%pM)\n", 
ndev_vif
->
iâum
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

707 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

708 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

709 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

710 ià(!
³”
 || (³”->
aid
 == 0)) {

711 
	`WARN_ON
(!
³”
 || (³”->
aid
 == 0));

712 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "can't find…eer by MAC‡ddress\n");

713 
out
;

716 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

718 #ifdeà
CONFIG_SCSC_WLAN_TX_API


719 
	`¦si_tx_tdls_upd©e
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
çl£
);

722 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
çl£
);

724 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

725 
out
:

726 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

727 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

728 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

729 
	}
}

731 
	$¦si_fw_‹¡_tdls_³”_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

733 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

734 
sk_buff
 *
add_vif_»q
;

735 
u16
 
vif_ty³
 = 0;

736 
u16
 
tdls_ev’t
;

738 ià(!
ndev_vif
->
is_fw_‹¡
) {

739 
	`kä“_skb
(
skb
);

742 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated")) {

743 
	`kä“_skb
(
skb
);

746 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

747 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

748 ià(
add_vif_»q
)

749 
vif_ty³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

750 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

752 ià(
	`WARN
(
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not STA VIF")) {

753 
	`kä“_skb
(
skb
);

757 
tdls_ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.tdls_event);

758 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "TDLS…“r(vif:%ddls_ev’t:%d)\n", 
ndev_vif
->
iâum
, 
tdls_ev’t
);

759 
tdls_ev’t
) {

760 
FAPI_TDLSEVENT_CONNECTED
:

761 
	`¦si_fw_‹¡_tdls_ev’t_cÚÃùed
(
sdev
, 
dev
, 
skb
);

763 
FAPI_TDLSEVENT_DISCONNECTED
:

764 
	`¦si_fw_‹¡_tdls_ev’t_discÚÃùed
(
sdev
, 
dev
, 
skb
);

766 
FAPI_TDLSEVENT_DISCOVERED
:

770 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%ddls_ev’t:%d‚Ù suµÜ‹d\n", 
ndev_vif
->
iâum
, 
tdls_ev’t
);

773 
	`kä“_skb
(
skb
);

774 
	}
}

777 
	$¦si_fw_‹¡_¡¬t_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

779 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

780 
sk_buff
 *
add_vif_»q
;

781 
u16
 
viáy³
 = 
FAPI_VIFTYPE_DISCOVERY
;

783 ià(!
ndev_vif
->
is_fw_‹¡
) {

784 
	`kä“_skb
(
skb
);

788 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk S¹(vif:%d)\n", 
ndev_vif
->
iâum
);

790 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

791 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

792 ià(
add_vif_»q
)

793 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

794 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

796 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ UDIe¡ N‘Deviû(vif:%d)\n", 
ndev_vif
->
iâum
);

797 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

798 
out
;

800 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

802 
viáy³
) {

803 
FAPI_VIFTYPE_AP
:

804 
	`¦si_fw_‹¡_¡¬‹d_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

807 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

811 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

813 
out
:

814 
	`kä“_skb
(
skb
);

815 
	}
}

817 
	$¦si_fw_‹¡_add_vif_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

819 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

821 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

822 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

824 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "M¬k UDIe¡ N‘Deviû(vif:%d)\n", 
	`çpi_g‘_vif
(
skb
));

825 
ndev_vif
->
is_fw_‹¡
 = 
Œue
;

826 
	`kä“_skb
(
skb
);

827 
	}
}

829 
	$¦si_fw_‹¡_d–_vif_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

831 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

832 
sk_buff
 *
add_vif_»q
;

833 
u16
 
viáy³
 = 
FAPI_VIFTYPE_DISCOVERY
;

834 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "Unm¬k UDIe¡ N‘Deviû(vif:%d)\n", 
	`çpi_g‘_vif
(
skb
));

836 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

837 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

838 ià(
add_vif_»q
)

839 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

840 
	`kä“_skb
(
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
]);

841 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
]);

842 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
]);

843 
	`kä“_skb
(
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
]);

845 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
] = 
NULL
;

846 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
] = 
NULL
;

847 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
] = 
NULL
;

848 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
] = 
NULL
;

849 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

851 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

853 
viáy³
) {

857 
FAPI_VIFTYPE_AP
:

858 
	`¦si_fw_‹¡_¡İ_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

861 ià(
ndev_vif
->
is_fw_‹¡
 &&‚dev_vif->
aùiv©ed
) {

862 
	`Ãtif_ÿ¼›r_off
(
dev
);

863 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

867 
ndev_vif
->
is_fw_‹¡
 = 
çl£
;

869 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

871 
	`kä“_skb
(
skb
);

872 
	}
}

874 
	$¦si_fw_‹¡_ma_blockack»q_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

876 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

878 ià(!
ndev_vif
->
is_fw_‹¡
) {

879 
	`kä“_skb
(
skb
);

883 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "MA Block Ack Req IndiÿtiÚ(vif:%d)\n", 
ndev_vif
->
iâum
);

884 
	`¦si_rx_blockack_šd
(
sdev
, 
dev
, 
skb
);

885 
	}
}

887 
	$¦si_fw_‹¡_wÜk
(
wÜk_¡ruù
 *
wÜk
)

889 
¦si_fw_‹¡
 *
fw_‹¡
 = 
	`cÚš”_of
(
wÜk
, ¦si_fw_‹¡, 
fw_‹¡_wÜk
.work);

890 
¦si_dev
 *
sdev
 = 
fw_‹¡
->sdev;

891 
sk_buff
 *
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

892 
Ãt_deviû
 *
dev
;

894 
skb
) {

895 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

897 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SigÇl:0x%.4X, vif:%d\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

899 ià(
	`WARN
(!
vif
, "!vif")) {

900 
	`kä“_skb
(
skb
);

901 
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

905 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

906 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

907 ià(!
dev
) {

909 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

910 
	`kä“_skb
(
skb
);

911 
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

915 
	`çpi_g‘_sigid
(
skb
)) {

916 
MLME_PROCEDURE_STARTED_IND
:

917 
	`¦si_fw_‹¡_´oûdu»_¡¬‹d_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

919 
MLME_CONNECT_IND
:

920 
	`¦si_fw_‹¡_cÚÃù_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

922 
MLME_ROAMED_IND
:

923 
	`¦si_fw_‹¡_rßmed_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

925 
MLME_CONNECTED_IND
:

926 
	`¦si_fw_‹¡_cÚÃùed_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

928 
MLME_DISCONNECTED_IND
:

929 
	`¦si_fw_‹¡_discÚÃùed_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

931 
MLME_TDLS_PEER_IND
:

932 
	`¦si_fw_‹¡_tdls_³”_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

934 
MLME_START_CFM
:

935 
	`¦si_fw_‹¡_¡¬t_cfm
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

937 
MLME_ADD_VIF_REQ
:

938 
	`¦si_fw_‹¡_add_vif_»q
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

940 
MLME_DEL_VIF_REQ
:

941 
	`¦si_fw_‹¡_d–_vif_»q
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

943 
MA_BLOCKACKREQ_IND
:

944 
	`¦si_fw_‹¡_ma_blockack»q_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

947 
	`WARN
(1, "Unhandled Signal");

948 
	`kä“_skb
(
skb
);

951 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

953 
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

955 
	}
}

957 
	$¦si_fw_‹¡_š™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
)

959 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "\n");

960 
	`mem£t
(
fw‹¡
, 0x00, (
¦si_fw_‹¡
));

961 
fw‹¡
->
sdev
 = sdev;

962 
	`¦si_¥šlock_ü—‹
(&
fw‹¡
->
fw_‹¡_lock
);

963 
	`¦si_skb_wÜk_š™
(
sdev
, 
NULL
, &
fw‹¡
->
fw_‹¡_wÜk
, "¦si_wÏn_fw_‹¡", 
¦si_fw_‹¡_wÜk
);

964 
	}
}

966 
	$¦si_fw_‹¡_deš™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
)

968 
i
;

970 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

972 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "\n");

973 
fw‹¡
->
fw_‹¡_’abËd
 = 
çl£
;

974 
	`¦si_skb_wÜk_deš™
(&
fw‹¡
->
fw_‹¡_wÜk
);

975 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

976 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

977 
	`kä“_skb
(
fw‹¡
->
mlme_add_vif_»q
[
i
]);

978 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_»q
[
i
]);

979 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_cfm
[
i
]);

980 
	`kä“_skb
(
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
i
]);

982 
fw‹¡
->
mlme_add_vif_»q
[
i
] = 
NULL
;

983 
fw‹¡
->
mlme_cÚÃù_»q
[
i
] = 
NULL
;

984 
fw‹¡
->
mlme_cÚÃù_cfm
[
i
] = 
NULL
;

985 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
i
] = 
NULL
;

987 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

988 
	`mem£t
(
fw‹¡
, 0x00, (
¦si_fw_‹¡
));

989 
	}
}

	@fw_test.h

7 #iâdeà
__SLSI_FW_TEST_H__


8 
	#__SLSI_FW_TEST_H__


	)

10 
	~"dev.h
"

12 
	s¦si_fw_‹¡
 {

13 
¦si_dev
 *
	msdev
;

14 
boŞ
 
	mfw_‹¡_’abËd
;

15 
¦si_skb_wÜk
 
	mfw_‹¡_wÜk
;

16 
¦si_¥šlock
 
	mfw_‹¡_lock
;

17 
sk_buff
 *
	mmlme_add_vif_»q
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

18 
sk_buff
 *
	mmlme_cÚÃù_»q
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

19 
sk_buff
 *
	mmlme_cÚÃù_cfm
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

20 
sk_buff
 *
	mmlme_´oûdu»_¡¬‹d_šd
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

23 
¦si_fw_‹¡_š™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
);

24 
¦si_fw_‹¡_deš™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
);

25 
¦si_fw_‹¡_sigÇl
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
);

26 
¦si_fw_‹¡_sigÇl_w™h_udi_h—d”
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
);

	@hanged_record.h

7 #iâdeà
__HANGED_RECORD_H__


8 
	#__HANGED_RECORD_H__


	)

10 
	#HANGED_FW_VERSION_SIZE
 (70)

	)

11 
	#HANGED_HOST_VERSION_SIZE
 (64)

	)

12 
	#HANGED_VERSION_SIZE
 (4)

	)

13 
	#HANGED_FW_PANIC_SIZE
 (4)

	)

14 
	#HANGED_OFFSET_SIZE
 (4)

	)

15 
	#HANGED_RESERVED
 (3)

	)

16 
	#HANGED_PANIC_RECORD_COUNT
 (145)

	)

17 
	#HANGED_PANIC_RECORD_SIZE
 ((
HANGED_PANIC_RECORD_COUNT
è* (
scsc_fw_»cÜd_t
))

	)

20 
	#HANGED_OFFSET_DATA
 "011C"

	)

22 
	#HANGED_PANIC_VERSION
 "0000"

	)

24 
	tscsc_fw_»cÜd_t
;

27 
	sscsc_hªged_»cÜd
 {

28 
	mhªg_ty³
[5];

29 
	mv”
[8];

30 
	mcook
[16];

31 
	mhg01
[8];

32 
	mhg02
[8];

33 
	mhg03
[8];

34 
	mhg04
[8];

35 
	mhg05
[8];

36 
	mhg06
[8];

37 
	mv”siÚ
[
HANGED_VERSION_SIZE
];

38 
	mfw_v”siÚ
[
HANGED_FW_VERSION_SIZE
];

39 
	mho¡_v”siÚ
[
HANGED_HOST_VERSION_SIZE
];

41 
	mfw_·nic
[
HANGED_FW_PANIC_SIZE
];

43 
	moff£t_d©a
[
HANGED_OFFSET_SIZE
];

44 
	m»£rved
[
HANGED_RESERVED
];

45 
	m·nic_»cÜd
[
HANGED_PANIC_RECORD_SIZE
];

46 } 
	g__·cked
;

51 
	#HANGED_PANIC_RECORD_HEX_SZ
 (((
scsc_fw_»cÜd_t
è* 2))

	)

52 
	#HANGED_VERSION_FORMATTING
 "%04X"

	)

53 
	#HANGED_FW_PANIC_FORMATTING
 "%04X"

	)

54 
	#HANGED_PANIC_REC_FORMATTING
 "%08X"

	)

	@hip.c

7 
	~<scsc/scsc_logršg.h
>

9 
	~"h.h
"

10 
	~"debug.h
"

11 
	~"´ocfs.h
"

12 
	~"§p.h
"

13 
	~"h4.h
"

14 #ifdeà
CONFIG_SCSC_SMAPPER


15 
	~"h4_sm­³r.h
"

19 
	sh_§p
 {

20 
§p_­i
 *
	m§p
[
SAP_TOTAL
];

21 } 
	gh_§p_cÚt
;

24 
	$¦si_h_§p_»gi¡”
(
§p_­i
 *sap_api)

26 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

28 ià(
şass
 >ğ
SAP_TOTAL
)

29  -
ENODEV
;

31 
h_§p_cÚt
.
§p
[
şass
] = 
§p_­i
;

34 
	}
}

37 
	$¦si_h_§p_uÄegi¡”
(
§p_­i
 *sap_api)

39 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

41 ià(
şass
 >ğ
SAP_TOTAL
)

42  -
ENODEV
;

44 
h_§p_cÚt
.
§p
[
şass
] = 
NULL
;

47 
	}
}

49 
	$¦si_h_§p_£tup
(
¦si_dev
 *
sdev
)

52 
u16
 
v”siÚ
 = 0;

53 
u32
 
cÚf_h4_v”
 = 0;

55 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
š™
);

58 ià((!
h_§p_cÚt
.
§p
[
SAP_MLME
]è|| (!h_§p_cÚt.§p[
SAP_MA
]) ||

59 (!
h_§p_cÚt
.
§p
[
SAP_DBG
]è|| (!h_§p_cÚt.§p[
SAP_TST
]))

60  -
ENODEV
;

62 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
§p_v”siÚ_suµÜ‹d
) {

63 ià(
cÚf_h4_v”
 == 4)

64 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
);

65 ià(
cÚf_h4_v”
 == 5)

66 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_mlme_v”
);

67 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

68  -
ENODEV
;

70  -
ENODEV
;

73 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
§p_v”siÚ_suµÜ‹d
) {

74 ià(
cÚf_h4_v”
 == 4)

75 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
);

76 ià(
cÚf_h4_v”
 == 5)

77 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_ma_v”
);

78 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

79  -
ENODEV
;

81  -
ENODEV
;

84 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
§p_v”siÚ_suµÜ‹d
) {

85 ià(
cÚf_h4_v”
 == 4)

86 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
);

87 ià(
cÚf_h4_v”
 == 5)

88 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_debug_v”
);

89 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

90  -
ENODEV
;

92  -
ENODEV
;

95 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
§p_v”siÚ_suµÜ‹d
) {

96 ià(
cÚf_h4_v”
 == 4)

97 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
);

98 ià(
cÚf_h4_v”
 == 5)

99 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_‹¡_v”
);

100 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

101  -
ENODEV
;

103  -
ENODEV
;

108 
	}
}

110 
	$¦si_h_£rviû_nÙif›r
(
nÙif›r_block
 *
nb
, 
ev’t
, *
d©a
)

112 
¦si_dev
 *
sdev
 = (¦si_dev *)
d©a
;

113 
i
;

115 ià(!
sdev
)

116  
NOTIFY_BAD
;

119 ià((!
h_§p_cÚt
.
§p
[
SAP_MLME
]è|| (!h_§p_cÚt.§p[
SAP_MA
]) ||

120 (!
h_§p_cÚt
.
§p
[
SAP_DBG
]è|| (!h_§p_cÚt.§p[
SAP_TST
]))

121  
NOTIFY_BAD
;

124 
i
 = 0; i < 
SAP_TOTAL
; i++)

125 ià(
h_§p_cÚt
.
§p
[
i
]->
§p_nÙif›r
) {

126 ià(
h_§p_cÚt
.
§p
[
i
]->
	`§p_nÙif›r
(
sdev
, 
ev’t
))

127  
NOTIFY_BAD
;

130 
ev’t
) {

131 
SCSC_WIFI_STOP
:

132 
	`SLSI_INFO
(
sdev
, "Freeze HIP4\n");

133 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

134 
	`h4_ä“ze
(&
sdev
->
h4_š¡
);

135 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

138 
SCSC_WIFI_FAILURE_RESET
:

139 
	`SLSI_INFO
(
sdev
, "Set HIP4 up‡gain\n");

140 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

141 
	`h4_£tup
(&
sdev
->
h4_š¡
);

142 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

145 
SCSC_WIFI_SUSPEND
:

146 
	`SLSI_INFO
(
sdev
, "Suspend HIP4\n");

147 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

148 
	`h4_su¥’d
(&
sdev
->
h4_š¡
);

149 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

152 
SCSC_WIFI_RESUME
:

153 
	`SLSI_INFO
(
sdev
, "Resume HIP4\n");

154 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

155 
	`h4_»sume
(&
sdev
->
h4_š¡
);

156 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

159 
SCSC_WIFI_SUBSYSTEM_RESET
:

160 
SCSC_WIFI_CHIP_READY
:

164 
	`SLSI_INFO
(
sdev
, "UnknowÀev’ˆcod%lu\n", 
ev’t
);

168  
NOTIFY_OK
;

169 
	}
}

171 
nÙif›r_block
 
	gcm_nb
 = {

172 .
nÙif›r_ÿÎ
 = 
¦si_h_£rviû_nÙif›r
,

175 
	$¦si_h_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
dev
)

177 
	`SLSI_UNUSED_PARAMETER
(
dev
);

179 
	`mem£t
(&
sdev
->
h4_š¡
, 0, (sdev->hip4_inst));

181 
sdev
->
h
.sdev = sdev;

182 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPED
);

183 
	`mu‹x_š™
(&
sdev
->
h
.
h_mu‹x
);

188 
	`¦si_wÏn_£rviû_nÙif›r_»gi¡”
(&
cm_nb
);

191 
	}
}

193 
	$¦si_h_deš™
(
¦si_dev
 *
sdev
)

195 
	`¦si_wÏn_£rviû_nÙif›r_uÄegi¡”
(&
cm_nb
);

196 
	`mu‹x_de¡roy
(&
sdev
->
h
.
h_mu‹x
);

197 
	}
}

199 
	$¦si_h_¡¬t
(
¦si_dev
 *
sdev
)

201 ià(!
sdev
->
maxw–l_cÜe
) {

202 
	`SLSI_ERR
(
sdev
, "Maxwell core does‚otƒxist\n");

203  -
EINVAL
;

206 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "[1/3]. Update HIP state (SLSI_HIP_STATE_STARTING)\n");

207 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STARTING
);

209 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "[2/3]. Initialise HIP\n");

210 ià(
	`h4_š™
(&
sdev
->
h4_š¡
)) {

211 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPED
);

212 
	`SLSI_ERR
(
sdev
, "hip4_init failed\n");

213  -
EINVAL
;

216 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "[3/3]. Update HIP state (SLSI_HIP_STATE_STARTED)\n");

217 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STARTED
);

220 
	}
}

223 
	$¦si_h_rx
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

225 
u16
 
pid
;

228 ià((!
h_§p_cÚt
.
§p
[
SAP_MLME
]è|| (!h_§p_cÚt.§p[
SAP_MA
]) ||

229 (!
h_§p_cÚt
.
§p
[
SAP_DBG
]è|| (!h_§p_cÚt.§p[
SAP_TST
]))

230  -
ENODEV
;

239 ià(
	`çpi_is_ma
(
skb
))

240 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_DATA_RX
, 
skb
->
d©a
, skb->
Ën
);

242 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_CTRL_RX
, 
skb
->
d©a
, skb->
Ën
);

244 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_TO_HOST
);

245 
pid
 = 
	`çpi_g‘_u16
(
skb
, 
»ûiv”_pid
);

246 ià(
pid
 >ğ
SLSI_TX_PROCESS_ID_UDI_MIN
 &&…id <ğ
SLSI_TX_PROCESS_ID_UDI_MAX
) {

247 #ifdeà
CONFIG_SCSC_SMAPPER


248 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

250 
	`kä“_skb
(
skb
);

254 ià(
	`çpi_is_ma
(
skb
)) {

259 ià(
	`çpi_g‘_sigid
(
skb
è=ğ
MA_BLOCKACKREQ_IND
)

260  
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_hªdËr
(
sdev
, 
skb
);

262  
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_hªdËr
(
sdev
, 
skb
);

265 ià(
	`çpi_is_mlme
(
skb
))

266  
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_hªdËr
(
sdev
, 
skb
);

268 ià(
	`çpi_is_debug
(
skb
))

269  
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_hªdËr
(
sdev
, 
skb
);

271 ià(
	`çpi_is_‹¡
(
skb
))

272  
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_hªdËr
(
sdev
, 
skb
);

274  -
EIO
;

275 
	}
}

277 #ifdeà
CONFIG_SCSC_WLAN_TX_API


278 
	$¦si_h_tx_dÚe
(
¦si_dev
 *
sdev
, 
u32
 
cŞour
, 
boŞ
 
mÜe
)

280  
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_txdÚe
(
sdev
, 
cŞour
, 
mÜe
);

281 
	}
}

284 
	$¦si_h_tx_dÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
)

286  
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_txdÚe
(
sdev
, 
vif
, 
³”_šdex
, 
ac
);

287 
	}
}

289 
	$¦si_h_£tup
(
¦si_dev
 *
sdev
)

291 
u32
 
»t_v®
;

292 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

295 
»t_v®
 = 
	`h4_£tup
(&
sdev
->
h4_š¡
);

297 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

298  
»t_v®
;

299 
	}
}

301 #ifdeà
CONFIG_SCSC_SMAPPER


302 
	$¦si_h_cÚsume_sm­³r_’Œy
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

304  
	`h4_sm­³r_cÚsume_’Œy
(
sdev
, &sdev->
h4_š¡
, 
skb
);

305 
	}
}

307 
sk_buff
 *
	$¦si_h_g‘_skb_äom_sm­³r
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

309  
	`h4_sm­³r_g‘_skb
(
sdev
, &sdev->
h4_š¡
, 
skb
);

310 
	}
}

312 *
	$¦si_h_g‘_skb_d©a_äom_sm­³r
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

314  
	`h4_sm­³r_g‘_skb_d©a
(
sdev
, &sdev->
h4_š¡
, 
skb
);

315 
	}
}

318 
	$¦si_h_¡İ
(
¦si_dev
 *
sdev
)

320 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

322 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
) {

323 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

326 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "Update HIP state (SLSI_HIP_STATE_STOPPING)\n");

327 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPING
);

329 
	`h4_deš™
(&
sdev
->
h4_š¡
);

331 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "Update HIP state (SLSI_HIP_STATE_STOPPED)\n");

332 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPED
);

334 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

336 
	}
}

337 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


338 
	$¦si_h_£t_Çpi_ıu
(
¦si_dev
 *
sdev
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
)

340 
	`h4_£t_Çpi_ıu
(&
sdev
->
h4_š¡
, 
Çpi_ıu
, 
³rf_mode
);

341 
	}
}

343 
	$¦si_h_»´oûss_sk³d_ù¾_bh
(
¦si_dev
 *
sdev
)

345 
¦si_h4
 *
h4
 = &
sdev
->
h4_š¡
;

347 
	`h4_sched_wq_ù¾
(
h4
);

348 
	}
}

350 
	$¦si_h_»´oûss_sk³d_d©a_bh
(
¦si_dev
 *
sdev
)

352 
¦si_h4
 *
h4
 = &
sdev
->
h4_š¡
;

354 
	`h4_sched_wq
(
h4
);

355 
	}
}

	@hip.h

7 #iâdeà
__SLSI_HIP_H__


8 
	#__SLSI_HIP_H__


	)

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/deviû.h
>

12 
	~<lšux/skbuff.h
>

14 
	g¦si_dev
;

19 
	s¦si_ÿrd_šfo
 {

20 
u16
 
	mch_id
;

21 
u32
 
	mfw_bud
;

22 
u16
 
	mfw_h_v”siÚ
;

23 
u32
 
	msdio_block_size
;

34 
	e¦si_h_¡©e
 {

35 
	mSLSI_HIP_STATE_STOPPED
,

36 
	mSLSI_HIP_STATE_STARTING
,

37 
	mSLSI_HIP_STATE_STARTED
,

38 
	mSLSI_HIP_STATE_STOPPING
,

39 
	mSLSI_HIP_STATE_BLOCKED


42 
	s¦si_h
 {

43 
¦si_dev
 *
	msdev
;

44 
¦si_ÿrd_šfo
 
	mÿrd_šfo
;

46 
mu‹x
 
	mh_mu‹x
;

49 
©omic_t
 
	mh_¡©e
;

52 
	#SLSI_HIP_PARAM_SLOT_COUNT
 2

	)

54 
¦si_h_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
dev
);

55 
¦si_h_deš™
(
¦si_dev
 *
sdev
);

57 
¦si_h_¡¬t
(
¦si_dev
 *
sdev
);

58 
¦si_h_£tup
(
¦si_dev
 *
sdev
);

59 
¦si_h_cÚsume_sm­³r_’Œy
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

60 *
¦si_h_g‘_skb_d©a_äom_sm­³r
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

61 
sk_buff
 *
¦si_h_g‘_skb_äom_sm­³r
(
¦si_dev
 *
sdev
, sk_bufà*
skb
);

62 
¦si_h_¡İ
(
¦si_dev
 *
sdev
);

63 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


64 
¦si_h_£t_Çpi_ıu
(
¦si_dev
 *
sdev
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
);

65 
¦si_h_»´oûss_sk³d_ù¾_bh
(
¦si_dev
 *
sdev
);

67 
¦si_h_»´oûss_sk³d_d©a_bh
(
¦si_dev
 *
sdev
);

71 
	g§p_­i
;

72 
	gsk_buff
;

75 
¦si_h_§p_»gi¡”
(
§p_­i
 *sap_api);

77 
¦si_h_§p_uÄegi¡”
(
§p_­i
 *sap_api);

79 
¦si_h_rx
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

81 
¦si_h_§p_£tup
(
¦si_dev
 *
sdev
);

83 #ifdeà
CONFIG_SCSC_WLAN_TX_API


84 
¦si_h_tx_dÚe
(
¦si_dev
 *
sdev
, 
u32
 
cŞour
, 
boŞ
 
mÜe
);

86 
¦si_h_tx_dÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
);

	@hip4.c

7 
	~<lšux/¦ab.h
>

8 
	~<lšux/š‹¼u±.h
>

9 
	~<lšux/d–ay.h
>

10 
	~<lšux/wÜkqueue.h
>

11 
	~<scsc/scsc_mx.h
>

12 
	~<scsc/scsc_miäam.h
>

13 
	~<lšux/ktime.h
>

14 
	~<lšux/kth»ad.h
>

15 
	~<scsc/scsc_logršg.h
>

16 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


17 
	~<lšux/ıu.h
>

18 
	~<lšux/b™m­.h
>

21 
	~"mgt.h
"

22 
	~"h4.h
"

23 
	~"mbulk.h
"

24 
	~"dev.h
"

25 
	~"h4_§m¶”.h
"

27 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


28 
	~"scsc_wifogg”_ršgs.h
"

31 
	~"debug.h
"

34 
DEFINE_SPINLOCK
(
š_Çpi_cÚ‹xt
);

36 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


37 
boŞ
 
	gh4_rx_æowcÚŒŞ
;

40 
boŞ
 
	gh4_sy¡em_wq
;

41 
moduË_·¿m
(
h4_sy¡em_wq
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

42 
MODULE_PARM_DESC
(
h4_sy¡em_wq
, "Use system wq instead of‚amed workqueue. (default: N)");

44 #ià
IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

45 
boŞ
 
	gh4_dyÇmic_loggšg
 = 
Œue
;

46 
moduË_·¿m
(
h4_dyÇmic_loggšg
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

47 
MODULE_PARM_DESC
(
h4_dyÇmic_loggšg
, "Dynamic†ogging,†ogring is disabled ifput > hip4_qos_med_tput_in_mbps. (default: Y)");

49 
	gh4_dyÇmic_loggšg_ut_š_mbps
 = 150;

50 
moduË_·¿m
(
h4_dyÇmic_loggšg_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

51 
MODULE_PARM_DESC
(
h4_dyÇmic_loggšg_ut_š_mbps
, "throughput (in Mbps)o‡pply dynamic†ogring†ogging");

54 #ifdeà
CONFIG_SCSC_QOS


55 
boŞ
 
	gh4_qos_’abË
 = 
Œue
;

56 
moduË_·¿m
(
h4_qos_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

57 
MODULE_PARM_DESC
(
h4_qos_’abË
, "enable HIP4 PM QoS. (default: Y)");

59 
	gh4_qos_max_ut_š_mbps
 = 250;

60 
moduË_·¿m
(
h4_qos_max_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

61 
MODULE_PARM_DESC
(
h4_qos_max_ut_š_mbps
, "throughput (in Mbps)o‡pply Max PM QoS");

63 
	gh4_qos_med_ut_š_mbps
 = 150;

64 
moduË_·¿m
(
h4_qos_med_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

65 
MODULE_PARM_DESC
(
h4_qos_med_ut_š_mbps
, "throughput (in Mbps)o‡pply Median PM QoS");

68 #ifdeà
CONFIG_SCSC_SMAPPER


69 
boŞ
 
	gh4_sm­³r_’abË
 = 
Œue
;

70 
moduË_·¿m
(
h4_sm­³r_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

71 
MODULE_PARM_DESC
(
h4_sm­³r_’abË
, "enable HIP4 SMAPPER. (default: Y)");

72 
boŞ
 
	gh4_sm­³r_is_’abËd
;

75 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


76 
	#SLSI_HIP_NAPI_STATE_ENABLED
 (0x1)

	)

78 #ifdeà
CONFIG_SOC_EXYNOS7885


79 
	gÇpi_£Ëù_ıu
 = 7;

81 
	gÇpi_£Ëù_ıu
;

83 
moduË_·¿m
(
Çpi_£Ëù_ıu
, , 0644);

84 
MODULE_PARM_DESC
(
Çpi_£Ëù_ıu
, "select‡ specific CPUoƒxecute NAPI…oll");

86 #ià
defšed
(
CONFIG_SOC_S5E8825
)

87 
boŞ
 
	gh4_Çpi_rx_§tu¿tiÚ_d‘eùiÚ
;

89 
boŞ
 
	gh4_Çpi_rx_§tu¿tiÚ_d‘eùiÚ
 = 
Œue
;

91 
moduË_·¿m
(
h4_Çpi_rx_§tu¿tiÚ_d‘eùiÚ
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

92 
MODULE_PARM_DESC
(
h4_Çpi_rx_§tu¿tiÚ_d‘eùiÚ
, "enable Rx saturation detection");

94 
ušt
 
	gh4_Çpi_num_rx_pkts
 = 80;

95 
moduË_·¿m
(
h4_Çpi_num_rx_pkts
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

96 
MODULE_PARM_DESC
(
h4_Çpi_num_rx_pkts
, "number of…ackets in Rx queueo deem it‡s full");

98 
ušt
 
	gh4_Çpi_num_rx_fuÎ
 = 3;

99 
moduË_·¿m
(
h4_Çpi_num_rx_fuÎ
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

100 
MODULE_PARM_DESC
(
h4_Çpi_num_rx_fuÎ
, "number of iterations of Rx queue fullhat signalo moveo high…erformance");

103 
	gmax_bufã»d_äames
 = 10000;

104 
moduË_·¿m
(
max_bufã»d_äames
, , 
S_IRUGO
 | 
S_IWUSR
);

105 
MODULE_PARM_DESC
(
max_bufã»d_äames
, "Maximum‚umber of frameso buffer inhe driver");

107 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


108 
ktime_t
 
	gšŒ_»ûived_fb
;

109 
ktime_t
 
	gbh_š™_fb
;

110 
ktime_t
 
	gbh_’d_fb
;

111 
ktime_t
 
	gšŒ_»ûived_ù¾
;

112 
ktime_t
 
	gbh_š™_ù¾
;

113 
ktime_t
 
	gbh_’d_ù¾
;

114 
ktime_t
 
	gšŒ_»ûived_d©a
;

115 
ktime_t
 
	gbh_š™_d©a
;

116 
ktime_t
 
	gbh_’d_d©a
;

118 
ktime_t
 
	gšŒ_»ûived
;

119 
ktime_t
 
	gbh_š™
;

120 
ktime_t
 
	gbh_’d
;

122 
ktime_t
 
	gwdt
;

123 
ktime_t
 
	g£nd
;

124 
ktime_t
 
	gşosšg
;

126 
	erw
 {

127 
	mwidx
,

128 
	mridx
,

131 
u8
 
h4_»ad_šdex
(
¦si_h4
 *
h
, 
u32
 
q
, 
rw
 
r_w
);

135 
	#FW_OWN_OFS
 (64)

	)

155 
	gq_idx_Ïyout
[6][2] = {

156 { 0, 
FW_OWN_OFS
 + 0},

157 { 1, 
FW_OWN_OFS
 + 1},

158 { 
FW_OWN_OFS
 + 2, 2},

159 { 
FW_OWN_OFS
 + 3, 3},

160 { 
FW_OWN_OFS
 + 4, 4},

161 { 5, 
FW_OWN_OFS
 + 5}

165 
	#FW_OWN_VIF
 (96)

	)

190 
	#MAX_STORM
 5

	)

193 
	#SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
 (1000)

	)

195 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


197 
u64
 
	ghi¡og¿m_1
;

198 
u64
 
	ghi¡og¿m_2
;

199 
u64
 
	ghi¡og¿m_3
;

200 
u64
 
	ghi¡og¿m_4
;

201 
u64
 
	ghi¡og¿m_5
;

202 
u64
 
	ghi¡og¿m_6
;

203 
u64
 
	gmax_j™‹r
;

205 
	#HISTO_1
 1000

	)

206 
	#HISTO_2
 10000

	)

207 
	#HISTO_3
 100000

	)

208 
	#HISTO_4
 1000000

	)

209 
	#HISTO_5
 10000000

	)

211 
u64
 
	ghi¡og¿m_1_d©a
;

212 
u64
 
	ghi¡og¿m_2_d©a
;

213 
u64
 
	ghi¡og¿m_3_d©a
;

214 
u64
 
	ghi¡og¿m_4_d©a
;

215 
u64
 
	ghi¡og¿m_5_d©a
;

216 
u64
 
	ghi¡og¿m_6_d©a
;

217 
u64
 
	gmax_d©a
;

219 
	#HISTO_1_DATA
 50

	)

220 
	#HISTO_2_DATA
 100

	)

221 
	#HISTO_3_DATA
 150

	)

222 
	#HISTO_4_DATA
 200

	)

223 
	#HISTO_5_DATA
 250

	)

226 
	#MAX_HISTORY_RECORDS
 32

	)

228 
	#FH
 0

	)

229 
	#TH
 1

	)

231 
	sh4_hi¡Üy
 {

232 
boŞ
 
	mdœ
;

233 
u32
 
	msigÇl
;

234 
u32
 
	mút
;

235 
ktime_t
 
	mÏ¡_time
;

236 } 
	gh4_sigÇl_hi¡Üy
[
MAX_HISTORY_RECORDS
];

238 
u32
 
	ghi¡Üy_»cÜd
;

241 
	$h4_hi¡Üy_»cÜd_add
(
boŞ
 
dœ
, 
u32
 
sigÇl_id
)

243 
h4_hi¡Üy
 
»cÜd
;

245 
»cÜd
 = 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
];

247 ià(
»cÜd
.
sigÇl
 =ğ
sigÇl_id
 &&„ecÜd.
dœ
 == dir) {

249 
»cÜd
.
Ï¡_time
 = 
	`ktime_g‘
();

250 
»cÜd
.
út
 += 1;

251 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
] = 
»cÜd
;

255 
hi¡Üy_»cÜd
 = (hi¡Üy_»cÜd + 1è& (
MAX_HISTORY_RECORDS
 - 1);

257 
»cÜd
 = 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
];

258 
»cÜd
.
dœ
 = dir;

259 
»cÜd
.
sigÇl
 = 
sigÇl_id
;

260 
»cÜd
.
út
 = 1;

261 
»cÜd
.
Ï¡_time
 = 
	`ktime_g‘
();

262 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
] = 
»cÜd
;

263 
	}
}

265 
	#HIP4_HISTORY
(
š_£q_fe
, 
m
, 
fmt
, 
¬g
 ...) \

267 ià(
š_£q_fe
) \

268 
	`£q_´štf
(
m
, 
fmt
, ## 
¬g
); \

270 
	`SLSI_ERR_NODEV
(
fmt
, ## 
¬g
); \

271 } 0)

	)

273 
	$h4_hi¡Üy_»cÜd_´št
(
boŞ
 
š_£q_fe
, 
£q_fe
 *
m
)

275 
h4_hi¡Üy
 
»cÜd
;

276 
u32
 
i
, 
pos
;

277 
ktime_t
 
Şd
;

279 
Şd
 = 
	`ktime_£t
(0, 0);

282 
pos
 = (
hi¡Üy_»cÜd
 + 1è& (
MAX_HISTORY_RECORDS
 - 1);

284 
	`HIP4_HISTORY
(
š_£q_fe
, 
m
, "dir\t signal\t cnt\t†ast_time(ns) \t\t gap(ns)\n");

285 
	`HIP4_HISTORY
(
š_£q_fe
, 
m
, "-----------------------------------------------------------------------------\n");

286 
i
 = 0; i < 
MAX_HISTORY_RECORDS
; i++) {

287 
»cÜd
 = 
h4_sigÇl_hi¡Üy
[
pos
];

289 ià(
»cÜd
.
út
) {

290 
	`HIP4_HISTORY
(
š_£q_fe
, 
m
, "%s\ˆ0x%04x\ˆ%d\ˆ%Îd \t%Îd\n", 
»cÜd
.
dœ
 ? "<--TH" : "FH-->",

291 
»cÜd
.
sigÇl
,„ecÜd.
út
, 
	`ktime_to_ns
ÔecÜd.
Ï¡_time
), ktime_to_ns(
	`ktime_sub
ÔecÜd.Ï¡_time, 
Şd
)));

293 
Şd
 = 
»cÜd
.
Ï¡_time
;

294 
pos
 = (po + 1è& (
MAX_HISTORY_RECORDS
 - 1);

296 
	}
}

298 
	$h4_´oc_show_hi¡Üy
(
£q_fe
 *
m
, *
v
)

300 
	`h4_hi¡Üy_»cÜd_´št
(
Œue
, 
m
);

302 
	}
}

304 
	$h4_´oc_hi¡Üy_İ’
(
šode
 *šode, 
fe
 *file)

306  
	`sšgË_İ’
(
fe
, 
h4_´oc_show_hi¡Üy
, 
	`PDE_DATA
(
šode
));

307 
	}
}

309 cÚ¡ 
fe_İ”©iÚs
 
	gh4_´ocfs_hi¡Üy_fİs
 = {

310 .
owÃr
 = 
THIS_MODULE
,

311 .
	gİ’
 = 
h4_´oc_hi¡Üy_İ’
,

312 .
	g»ad
 = 
£q_»ad
,

313 .
	gÎ£ek
 = 
£q_l£ek
,

314 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

317 
	$h4_´oc_show
(
£q_fe
 *
m
, *
v
)

319 
¦si_h4
 *
h
 = 
m
->
´iv©e
;

320 
h4_h_cÚŒŞ
 *
h_cÚŒŞ
;

321 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

322 
u8
 
i
;

324 
u32
 
cÚf_h4_v”
 = 0;

325 *
h_±r
;

327 ià(!
h
->
h_´iv
) {

328 
	`£q_puts
(
m
, "HIP4‚ot‡ctive\n");

332 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
h
->
h_cÚŒŞ
->
š™
);

335 ià(
cÚf_h4_v”
 != 4 && conf_hip4_ver != 3) {

336 
	`SLSI_ERR_NODEV
("FW V”siÚ %d‚Ù suµÜ‹d o¸H ha nÙ b“À£ˆup\n", 
cÚf_h4_v”
);

342 
h_±r
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
sdev
->
£rviû
, 
h
->
h_»f
);

344 
h_cÚŒŞ
 = (
h4_h_cÚŒŞ
 *)(
h_±r
 +

345 
HIP4_WLAN_CONFIG_OFFSET
);

347 
	`£q_puts
(
m
, "-----------------------------------------\n");

348 
	`£q_puts
(
m
, "HIP4 CONFIG:\n");

349 
	`£q_puts
(
m
, "-----------------------------------------\n");

350 
	`£q_´štf
(
m
, "cÚfig k”ÃÈadd¸ = %p\n", 
h_cÚŒŞ
);

351 ià(
cÚf_h4_v”
 == 4) {

352 
	`£q_´štf
(
m
, "h4_v”siÚ_4‡dd¸ = 0x%p\n", &
h_cÚŒŞ
->
cÚfig_v4
);

353 
	`£q_´štf
(
m
, "magic_numb” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
magic_numb”
);

354 
	`£q_´štf
(
m
, "h_cÚfig_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
h_cÚfig_v”
);

355 
	`£q_´štf
(
m
, "cÚfig_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
cÚfig_Ën
);

356 
	`£q_´štf
(
m
, "com·t_æag = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
com·t_æag
);

357 
	`£q_´štf
(
m
, "§p_mlme_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_mlme_v”
);

358 
	`£q_´štf
(
m
, "§p_ma_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_ma_v”
);

359 
	`£q_´štf
(
m
, "§p_debug_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_debug_v”
);

360 
	`£q_´štf
(
m
, "§p_‹¡_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_‹¡_v”
);

361 
	`£q_´štf
(
m
, "fw_bud_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_bud_id
);

362 
	`£q_´štf
(
m
, "fw_·tch_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_·tch_id
);

363 
	`£q_´štf
(
m
, "unid©_»q_h—droom = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
unid©_»q_h—droom
);

364 
	`£q_´štf
(
m
, "unid©_»q_room = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
unid©_»q_room
);

365 
	`£q_´štf
(
m
, "bulk_bufãr_®igÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
bulk_bufãr_®ign
);

366 
	`£q_´štf
(
m
, "ho¡_ÿche_lš = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_ÿche_lše
);

367 
	`£q_´štf
(
m
, "ho¡_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_loc
);

368 
	`£q_´štf
(
m
, "ho¡_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_sz
);

369 
	`£q_´štf
(
m
, "fw_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_loc
);

370 
	`£q_´štf
(
m
, "fw_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_sz
);

371 
	`£q_´štf
(
m
, "mib_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
);

372 
	`£q_´štf
(
m
, "mib_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
);

373 
	`£q_´štf
(
m
, "log_cÚfig_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
log_cÚfig_loc
);

374 
	`£q_´štf
(
m
, "log_cÚfig_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
log_cÚfig_sz
);

375 
	`£q_´štf
(
m
, "mif_fh_št_À = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_fh_št_n
);

376 
	`£q_´štf
(
m
, "mif_th_št_n[FH_CTRL] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_FH_CTRL
]);

377 
	`£q_´štf
(
m
, "mif_th_št_n[FH_DAT] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_FH_DAT
]);

378 
	`£q_´štf
(
m
, "mif_th_št_n[FH_RFB] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_FH_RFB
]);

379 
	`£q_´štf
(
m
, "mif_th_št_n[TH_CTRL] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_TH_CTRL
]);

380 
	`£q_´štf
(
m
, "mif_th_št_n[TH_DAT] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_TH_DAT
]);

381 
	`£q_´štf
(
m
, "mif_th_št_n[TH_RFB] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_TH_RFB
]);

382 
	`£q_´štf
(
m
, "scbrd_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
scbrd_loc
);

383 
	`£q_´štf
(
m
, "q_num = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
q_num
);

384 
	`£q_´štf
(
m
, "q_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
q_Ën
);

385 
	`£q_´štf
(
m
, "q_idx_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
q_idx_sz
);

386 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

387 
	`£q_´štf
(
m
, "q_loc[%d] = 0x%x\n", 
i
, 
h_cÚŒŞ
->
cÚfig_v4
.
q_loc
[i]);

388 } ià(
cÚf_h4_v”
 == 5) {

389 
	`£q_´štf
(
m
, "h4_v”siÚ_5‡dd¸ğ0x%p\n", &
h_cÚŒŞ
->
cÚfig_v5
);

390 
	`£q_´štf
(
m
, "magic_numb” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
magic_numb”
);

391 
	`£q_´štf
(
m
, "h_cÚfig_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
h_cÚfig_v”
);

392 
	`£q_´štf
(
m
, "cÚfig_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
cÚfig_Ën
);

393 
	`£q_´štf
(
m
, "com·t_æag = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
com·t_æag
);

394 
	`£q_´štf
(
m
, "§p_mlme_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_mlme_v”
);

395 
	`£q_´štf
(
m
, "§p_ma_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_ma_v”
);

396 
	`£q_´štf
(
m
, "§p_debug_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_debug_v”
);

397 
	`£q_´štf
(
m
, "§p_‹¡_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_‹¡_v”
);

398 
	`£q_´štf
(
m
, "fw_bud_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_bud_id
);

399 
	`£q_´štf
(
m
, "fw_·tch_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_·tch_id
);

400 
	`£q_´štf
(
m
, "unid©_»q_h—droom = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
unid©_»q_h—droom
);

401 
	`£q_´štf
(
m
, "unid©_»q_room = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
unid©_»q_room
);

402 
	`£q_´štf
(
m
, "bulk_bufãr_®igÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
bulk_bufãr_®ign
);

403 
	`£q_´štf
(
m
, "ho¡_ÿche_lš = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_ÿche_lše
);

404 
	`£q_´štf
(
m
, "ho¡_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_loc
);

405 
	`£q_´štf
(
m
, "ho¡_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_sz
);

406 
	`£q_´štf
(
m
, "fw_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_loc
);

407 
	`£q_´štf
(
m
, "fw_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_sz
);

408 
	`£q_´štf
(
m
, "mib_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
);

409 
	`£q_´štf
(
m
, "mib_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
);

410 
	`£q_´štf
(
m
, "log_cÚfig_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
log_cÚfig_loc
);

411 
	`£q_´štf
(
m
, "log_cÚfig_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
log_cÚfig_sz
);

412 
	`£q_´štf
(
m
, "mif_fh_št_À = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mif_fh_št_n
);

413 
	`£q_´štf
(
m
, "mif_th_št_À = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mif_th_št_n
);

414 
	`£q_´štf
(
m
, "scbrd_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
scbrd_loc
);

415 
	`£q_´štf
(
m
, "q_num = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
q_num
);

416 
	`£q_´štf
(
m
, "q_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
q_Ën
);

417 
	`£q_´štf
(
m
, "q_idx_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
q_idx_sz
);

418 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

419 
	`£q_´štf
(
m
, "q_loc[%d] = 0x%x\n", 
i
, 
h_cÚŒŞ
->
cÚfig_v5
.
q_loc
[i]);

421 
	`£q_puts
(
m
, "\n-----------------------------------------\n");

422 
	`£q_puts
(
m
, "HIP4 SCOREBOARD INDEXES:\n");

423 
	`£q_puts
(
m
, "-----------------------------------------\n");

424 
	`£q_´štf
(
m
, "ktim¡¬ˆ%Îd (ns)\n", 
	`ktime_to_ns
(
h
->
h_´iv
->
¡©s
.
¡¬t
));

425 
	`£q_´štf
(
m
, "ktimnow %Îd (ns)\n\n", 
	`ktime_to_ns
(
	`ktime_g‘
()));

427 
	`£q_´štf
(
m
, "rx_šŒ_toho¡ 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡
);

428 
	`£q_´štf
(
m
, "rx_šŒ_äomho¡ 0x%x\n\n", 
h
->
h_´iv
->
šŒ_äomho¡
);

431 
	`£q_´štf
(
m
, "HIP IRQs: %u\n", 
	`©omic_»ad
(&
h
->
h_´iv
->
¡©s
.
œqs
));

432 
	`£q_´štf
(
m
, "HIP IRQ ¥urious: %u\n", 
	`©omic_»ad
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
));

433 
	`£q_´štf
(
m
, "FW debug-šds: %u\n\n", 
	`©omic_»ad
(&
sdev
->
debug_šds
));

435 
	`£q_puts
(
m
, "Queue\tIndex\tFrames\n");

436 
	`£q_puts
(
m
, "-----\t-----\t------\n");

438 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

439 
	`£q_´štf
(
m
, "Q%dW\t0x%x\t\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
widx
));

440 
	`£q_´štf
(
m
, "Q%dR\t0x%x\t%d\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
ridx
), h->
h_´iv
->
¡©s
.
q_num_äames
[i]);

442 
	`£q_puts
(
m
, "\n");

444 
	}
}

446 
	$h4_´oc_İ’
(
šode
 *šode, 
fe
 *file)

448  
	`sšgË_İ’
(
fe
, 
h4_´oc_show
, 
	`PDE_DATA
(
šode
));

449 
	}
}

451 cÚ¡ 
fe_İ”©iÚs
 
	gh4_´ocfs_¡©s_fİs
 = {

452 .
owÃr
 = 
THIS_MODULE
,

453 .
	gİ’
 = 
h4_´oc_İ’
,

454 .
	g»ad
 = 
£q_»ad
,

455 .
	gÎ£ek
 = 
£q_l£ek
,

456 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

459 
	$h4_´oc_j™‹r_show
(
£q_fe
 *
m
, *
v
)

461 
	`£q_puts
(
m
, "Values in‚s\n");

462 
	`£q_´štf
(
m
, "<%dÒs)\t\t\t\ˆ%Îd\n", 
HISTO_1
, 
hi¡og¿m_1
);

463 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\t\ˆ%Îd\n", 
HISTO_1
, 
HISTO_2
, 
hi¡og¿m_2
);

464 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\t\ˆ%Îd\n", 
HISTO_2
, 
HISTO_3
, 
hi¡og¿m_3
);

465 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\t\ˆ%Îd\n", 
HISTO_3
, 
HISTO_4
, 
hi¡og¿m_4
);

466 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\ˆ%Îd\n", 
HISTO_4
, 
HISTO_5
, 
hi¡og¿m_5
);

467 
	`£q_´štf
(
m
, ">%dÒs)\t\t\t\ˆ%Îd\n", 
HISTO_5
, 
hi¡og¿m_6
);

468 
	`£q_´štf
(
m
, "max j™‹rÒs)\t\t\t\ˆ%Îd\n", 
max_j™‹r
);

469 
	`£q_puts
(
m
, "--------------------------\n");

470 
	`£q_puts
(
m
, "Packets in TH DATA Q\n");

471 
	`£q_´štf
(
m
, "<%d\t\t%Îd\n", 
HISTO_1_DATA
, 
hi¡og¿m_1_d©a
);

472 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_1_DATA
, 
HISTO_2_DATA
, 
hi¡og¿m_2_d©a
);

473 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_2_DATA
, 
HISTO_3_DATA
, 
hi¡og¿m_3_d©a
);

474 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_3_DATA
, 
HISTO_4_DATA
, 
hi¡og¿m_4_d©a
);

475 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_4_DATA
, 
HISTO_5_DATA
, 
hi¡og¿m_5_d©a
);

476 
	`£q_´štf
(
m
, ">%d\t\t%Îd\n", 
HISTO_5_DATA
, 
hi¡og¿m_6_d©a
);

477 
	`£q_´štf
(
m
, "max d©a\t%Îd\n", 
max_d©a
);

479 
	}
}

481 
	$h4_´oc_j™‹r_İ’
(
šode
 *šode, 
fe
 *file)

483  
	`sšgË_İ’
(
fe
, 
h4_´oc_j™‹r_show
, 
	`PDE_DATA
(
šode
));

484 
	}
}

486 
ssize_t
 
	$h4_´oc_j™‹r_ş—r
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

488 
	`SLSI_INFO_NODEV
("Clear Histogram\n");

490 
hi¡og¿m_1
 = 0;

491 
hi¡og¿m_2
 = 0;

492 
hi¡og¿m_3
 = 0;

493 
hi¡og¿m_4
 = 0;

494 
hi¡og¿m_5
 = 0;

495 
hi¡og¿m_6
 = 0;

496 
max_j™‹r
 = 0;

498 
hi¡og¿m_1_d©a
 = 0;

499 
hi¡og¿m_2_d©a
 = 0;

500 
hi¡og¿m_3_d©a
 = 0;

501 
hi¡og¿m_4_d©a
 = 0;

502 
hi¡og¿m_5_d©a
 = 0;

503 
hi¡og¿m_6_d©a
 = 0;

504 
max_d©a
 = 0;

506  
couÁ
;

507 
	}
}

509 cÚ¡ 
fe_İ”©iÚs
 
	gh4_´ocfs_j™‹r_fİs
 = {

510 .
owÃr
 = 
THIS_MODULE
,

511 .
	gİ’
 = 
h4_´oc_j™‹r_İ’
,

512 .
	gwr™e
 = 
h4_´oc_j™‹r_ş—r
,

513 .
	g»ad
 = 
£q_»ad
,

514 .
	gÎ£ek
 = 
£q_l£ek
,

515 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

519 
	#FB_NO_SPC_NUM_RET
 100

	)

520 
	#FB_NO_SPC_SLEEP_MS
 10

	)

521 
	#FB_NO_SPC_DELAY_US
 1000

	)

525 
	$h4_upd©e_šdex
(
¦si_h4
 *
h
, 
u32
 
q
, 
rw
 
r_w
, 
u8
 
v®ue
)

527 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

529 
	`wr™e_lock_bh
(&
h_´iv
->
rw_scÜebßrd
);

530 ià(
h
->
h_´iv
->
v”siÚ
 == 5 || hip->hip_priv->version == 4) {

531 *((
u8
 *)(
h
->
h_´iv
->
scbrd_ba£
 + 
q_idx_Ïyout
[
q
][
r_w
])èğ
v®ue
;

533 
	`SLSI_ERR_NODEV
("Incorrect version\n");

534 
”rÜ
;

538 
	`smp_wmb
();

539 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
q
, 
r_w
, 
v®ue
, 0);

540 
”rÜ
:

541 
	`wr™e_uÆock_bh
(&
h_´iv
->
rw_scÜebßrd
);

542 
	}
}

546 
u8
 
	$h4_»ad_šdex
(
¦si_h4
 *
h
, 
u32
 
q
, 
rw
 
r_w
)

548 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

549 
u32
 
v®ue
 = 0;

551 
	`»ad_lock_bh
(&
h_´iv
->
rw_scÜebßrd
);

552 ià(
h
->
h_´iv
->
v”siÚ
 == 5 || hip->hip_priv->version == 4) {

553 
v®ue
 = *((
u8
 *)(
h
->
h_´iv
->
scbrd_ba£
 + 
q_idx_Ïyout
[
q
][
r_w
]));

555 
	`SLSI_ERR_NODEV
("Incorrect version\n");

556 
”rÜ
;

560 
	`smp_rmb
();

561 
”rÜ
:

562 
	`»ad_uÆock_bh
(&
h_´iv
->
rw_scÜebßrd
);

563  
v®ue
;

564 
	}
}

566 
	$h4_dump_dbg
(
¦si_h4
 *
h
, 
mbulk
 *
m
, 
sk_buff
 *
skb
, 
scsc_£rviû
 *
£rviû
)

568 
i
 = 0;

569 
scsc_miäam_»f
 
»f
;

570 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


571 
	`SLSI_ERR_NODEV
("šŒ_toho¡_fb 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

572 
	`SLSI_ERR_NODEV
("šŒ_toho¡_ù¾ 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

573 
	`SLSI_ERR_NODEV
("šŒ_toho¡_d© 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

575 
	`SLSI_ERR_NODEV
("šŒ_toho¡ 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡
);

577 
	`SLSI_ERR_NODEV
("šŒ_äomho¡ 0x%x\n", 
h
->
h_´iv
->
šŒ_äomho¡
);

580 
i
 = 0; i < 6; i++) {

581 
	`SLSI_ERR_NODEV
("Q%dW 0x%x\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
widx
));

582 
	`SLSI_ERR_NODEV
("Q%dR 0x%x\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
ridx
));

585 ià(
£rviû
)

586 
	`scsc_mx_£rviû_mif_dump_»gi¡”s
(
£rviû
);

588 ià(
m
 && 
£rviû
) {

589 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, 
m
, &
»f
))

591 
	`SLSI_ERR_NODEV
("m: %°0x%x\n", 
m
, 
»f
);

592 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "mbulk ", 
DUMP_PREFIX_NONE
, 16, 1, 
m
, (
mbulk
), 0);

594 ià(
m
 && 
	`mbulk_has_sigÇl
(m))

595 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "sig ", 
DUMP_PREFIX_NONE
, 16, 1, 
	`mbulk_g‘_sigÇl
(
m
),

596 
	`MBULK_SEG_SIG_BUFSIZE
(
m
), 0);

597 ià(
skb
)

598 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "skb ", 
DUMP_PREFIX_NONE
, 16, 1, 
skb
->
d©a
, skb->
Ën
 > 0xff ? 0xff : skb->len, 0);

600 
	`SLSI_ERR_NODEV
("time: wdˆ %Îd\n", 
	`ktime_to_ns
(
wdt
));

601 
	`SLSI_ERR_NODEV
("time: s’d %Îd\n", 
	`ktime_to_ns
(
£nd
));

602 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


603 
	`SLSI_ERR_NODEV
("time: iÁr_fb %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived_fb
));

604 
	`SLSI_ERR_NODEV
("time: bh_š™_fb %Îd\n", 
	`ktime_to_ns
(
bh_š™_fb
));

605 
	`SLSI_ERR_NODEV
("time: bh_’d_fb %Îd\n", 
	`ktime_to_ns
(
bh_’d_fb
));

606 
	`SLSI_ERR_NODEV
("time: iÁr_ù¾ %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived_ù¾
));

607 
	`SLSI_ERR_NODEV
("time: bh_š™_ù¾ %Îd\n", 
	`ktime_to_ns
(
bh_š™_ù¾
));

608 
	`SLSI_ERR_NODEV
("time: bh_’d_ù¾ %Îd\n", 
	`ktime_to_ns
(
bh_’d_ù¾
));

609 
	`SLSI_ERR_NODEV
("time: iÁr_d©¨ %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived_d©a
));

610 
	`SLSI_ERR_NODEV
("time: bh_š™_d©¨%Îd\n", 
	`ktime_to_ns
(
bh_š™_d©a
));

611 
	`SLSI_ERR_NODEV
("time: bh_’d_d©¨ %Îd\n", 
	`ktime_to_ns
(
bh_’d_d©a
));

613 
	`SLSI_ERR_NODEV
("time: iÁ¸ %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived
));

614 
	`SLSI_ERR_NODEV
("time: bh_š™ %Îd\n", 
	`ktime_to_ns
(
bh_š™
));

615 
	`SLSI_ERR_NODEV
("time: bh_’d %Îd\n", 
	`ktime_to_ns
(
bh_’d
));

617 
	`SLSI_ERR_NODEV
("time: closšg %Îd\n", 
	`ktime_to_ns
(
şosšg
));

618 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


620 ià(!
skb
 && !
m
)

621 
	`h4_hi¡Üy_»cÜd_´št
(
çl£
, 
NULL
);

623 
	}
}

626 
mbulk
 *
	$h4_skb_to_mbulk
(
h4_´iv
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
mbulk_cŞour
 
cŞour
)

628 
mbulk
 *
m
 = 
NULL
;

629 *
sig
 = 
NULL
, *
b_d©a
 = NULL;

630 
size_t
 
·ylßd
 = 0;

631 
u8
 
poŞ_id
 = 
ù¾_·ck‘
 ? 
MBULK_POOL_ID_CTRL
 : 
MBULK_POOL_ID_DATA
;

632 
u8
 
h—droom
 = 0, 
room
 = 0;

633 
mbulk_şass
 
şas
 = 
ù¾_·ck‘
 ? 
MBULK_CLASS_FROM_HOST_CTL
 : 
MBULK_CLASS_FROM_HOST_DAT
;

634 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb
);

635 #ifdeà
CONFIG_SCSC_WLAN_SG


636 
u32
 
lš—r_d©a
;

637 
u32
 
off£t
;

638 
u8
 
i
;

641 
·ylßd
 = 
skb
->
Ën
 - 
cb
->
sig_Ëngth
;

644 
h—droom
 = 
h
->
unid©_»q_h—droom
;

645 
room
 = 
h
->
unid©_»q_room
;

648 ià(
·ylßd
 > 0) {

650 
m
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
cŞour
, 
şas
, 
cb
->
sig_Ëngth
 + 4,

651 
·ylßd
 + 
h—droom
 + 
room
);

652 ià(!
m
)

653  
NULL
;

654 ià(!
	`mbulk_»£rve_h—d
(
m
, 
h—droom
))

655  
NULL
;

658 
m
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
cŞour
, 
şas
, 
cb
->
sig_Ëngth
 + 4, 0);

659 ià(!
m
)

660  
NULL
;

664 
sig
 = 
	`mbulk_g‘_sigÇl
(
m
);

665 ià(!
sig
) {

666 
	`SLSI_ERR_NODEV
("no sig in mbulk\n");

667 
	`mbulk_ä“_vœt_ho¡
(
m
);

668  
NULL
;

673 
	`memıy
(
sig
 + 4, 
skb
->
d©a
, 
cb
->
sig_Ëngth
);

677 ià(
·ylßd
 > 0) {

679 
b_d©a
 = 
	`mbulk_d©_rw
(
m
);

680 ià(!
b_d©a
) {

681 
	`SLSI_ERR_NODEV
("head…ointer is NULL\n");

682 
	`mbulk_ä“_vœt_ho¡
(
m
);

683  
NULL
;

686 #ifdeà
CONFIG_SCSC_WLAN_SG


690 
lš—r_d©a
 = 
	`skb_h—dËn
(
skb
è- 
cb
->
sig_Ëngth
;

692 
off£t
 = 0;

694 ià(
lš—r_d©a
 > 0) {

696 
	`memıy
(
b_d©a
, 
skb
->
d©a
 + 
cb
->
sig_Ëngth
, 
lš—r_d©a
);

697 
off£t
 = 
lš—r_d©a
;

701 
i
 = 0; i < 
	`skb_shšfo
(
skb
)->
Ä_äags
; i++) {

702 
skb_äag_t
 *
äag
 = 
NULL
;

703 *
äag_va_d©a
;

704 
äag_size
;

706 
äag
 = &
	`skb_shšfo
(
skb
)->
äags
[
i
];

707 
	`WARN_ON
(!
äag
);

708 ià(!
äag
)

710 
äag_va_d©a
 = 
	`skb_äag_add»ss_§ã
(
äag
);

711 
	`WARN_ON
(!
äag_va_d©a
);

712 ià(!
äag_va_d©a
)

714 
äag_size
 = 
	`skb_äag_size
(
äag
);

716 
	`memıy
(
b_d©a
 + 
off£t
, 
äag_va_d©a
, 
äag_size
);

717 
off£t
 +ğ
äag_size
;

721 ià(
skb
->
_summed
 =ğ
CHECKSUM_PARTIAL
) {

722 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "CHECKSUM_PARTIAL. Driver…erforming checksum\n");

723 ià(
skb
->
´ÙocŞ
 =ğ
	`htÚs
(
ETH_P_IP
)) {

724 
‘hhdr
 *
mach
 = (‘hhd¸*)
b_d©a
;

725 
hdr
 *
h
 = (hd¸*)((*)
b_d©a
 + (*
mach
));

726 
Ën
 = 
·ylßd
 - (*
mach
è- (
h
->
ihl
 << 2);

728 ià(
h
->
´ÙocŞ
 =ğ
IPPROTO_TCP
) {

729 
tıhdr
 *
th
 = (tıhd¸*)((*)
b_d©a
 + (*
mach
) +

730 (
h
->
ihl
 << 2));

731 
th
->
check
 = 0;

732 
th
->
check
 = 
	`csum_tıudp_magic
(
h
->
§ddr
, iph->
daddr
, 
Ën
,

733 
IPPROTO_TCP
,

734 
	`csum_·¹Ÿl
((*)
th
, 
Ën
, 0));

735 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "th->check 0x%x\n", 
	`Áohs
(
th
->
check
));

736 } ià(
h
->
´ÙocŞ
 =ğ
IPPROTO_UDP
) {

737 
udphdr
 *
uh
 = (udphd¸*)((*)
b_d©a
 + (*
mach
) +

738 (
h
->
ihl
 << 2));

739 
uh
->
check
 = 0;

740 
uh
->
check
 = 
	`csum_tıudp_magic
(
h
->
§ddr
, iph->
daddr
, 
Ën
,

741 
IPPROTO_UDP
,

742 
	`csum_·¹Ÿl
((*)
uh
, 
Ën
, 0));

743 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "uh->check 0x%x\n", 
	`Áohs
(
uh
->
check
));

749 
	`memıy
(
b_d©a
, 
skb
->
d©a
 + 
cb
->
sig_Ëngth
, 
·ylßd
);

751 
	`mbulk_­³nd_
(
m
, 
·ylßd
);

753 
m
->
æag
 |ğ
MBULK_F_OBOUND
;

755 #ifdeà
CONFIG_SCSC_SMAPPER


757 
cb
->
skb_addr
 = 
NULL
;

759  
m
;

760 
	}
}

763 
sk_buff
 *
	$h4_mbulk_to_skb
(
scsc_£rviû
 *
£rviû
, 
h4_´iv
 *
h_´iv
, 
mbulk
 *
m
, 
scsc_miäam_»f
 *
to_ä“
, 
boŞ
 
©omic
)

765 
¦si_skb_cb
 *
cb
;

766 
mbulk
 *
Ãxt_mbulk
[
MBULK_MAX_CHAIN
];

767 
sk_buff
 *
skb
 = 
NULL
;

768 
scsc_miäam_»f
 
»f
;

769 
scsc_miäam_»f
 
m_chaš_Ãxt
;

770 
u8
 
ä“
 = 0;

771 
u8
 
i
 = 0, 
j
 = 0;

772 
u8
 *
p
;

773 
size_t
 
by‹s_to_®loc
 = 0;

776 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, 
m
, &
»f
)) {

777 
	`SLSI_ERR_NODEV
("mbulk‡ddress conversion failed\n");

778  
NULL
;

782 
to_ä“
[
ä“
++] = 
»f
;

784 
by‹s_to_®loc
 +ğ
m
->
sig_bufsz
 - 4;

785 
by‹s_to_®loc
 +ğ
m
->
Ën
;

788 ià((
	`MBULK_SEG_IS_CHAIN_HEAD
(
m
)è&& (
	`MBULK_SEG_IS_CHAINED
(m))) {

789 
m_chaš_Ãxt
 = 
	`mbulk_chaš_Ãxt
(
m
);

790 ià(!
m_chaš_Ãxt
) {

791 
	`SLSI_ERR_NODEV
("Mbulk is set MBULK_F_CHAIN_HEAD‡nd MBULK_F_CHAIN but m_chain_next is NULL\n");

792 
cÚt
;

796 
i
++;

798 
Ãxt_mbulk
[
i
 - 1] = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
m_chaš_Ãxt
);

799 ià(!
Ãxt_mbulk
[
i
 - 1]) {

800 
	`SLSI_ERR_NODEV
("First Mbulk is set‡s MBULK_F_CHAIN but‚ext_mbulk is NULL\n");

801  
NULL
;

804 
to_ä“
[
ä“
++] = 
m_chaš_Ãxt
;

805 
by‹s_to_®loc
 +ğ
Ãxt_mbulk
[
i
 - 1]->
Ën
;

806 ià(
	`MBULK_SEG_IS_CHAINED
(
Ãxt_mbulk
[
i
 - 1])) {

808 
m_chaš_Ãxt
 = 
	`mbulk_chaš_Ãxt
(
Ãxt_mbulk
[
i
 - 1]);

809 ià(!
m_chaš_Ãxt
)

812 ià(
i
 >ğ
MBULK_MAX_CHAIN
) {

813 
	`SLSI_ERR_NODEV
("Max‚umber of chained MBULK„eached\n");

814  
NULL
;

822 
cÚt
:

823 ià(
©omic
) {

824 
skb
 = 
	`®loc_skb
(
by‹s_to_®loc
, 
GFP_ATOMIC
);

826 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

827 
skb
 = 
	`®loc_skb
(
by‹s_to_®loc
, 
GFP_KERNEL
);

828 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

830 ià(!
skb
) {

831 
	`SLSI_ERR_NODEV
("E¼Ü‡Îoÿtšg skb %d by‹s\n", 
by‹s_to_®loc
);

832  
NULL
;

835 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

836 
cb
->
sig_Ëngth
 = 
m
->
sig_bufsz
 - 4;

838 
cb
->
d©a_Ëngth
 = cb->
sig_Ëngth
;

840 
p
 = 
	`mbulk_g‘_sigÇl
(
m
);

841 ià(!
p
) {

842 
	`SLSI_ERR_NODEV
("No signal in Mbulk\n");

843 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "mbulk ", 
DUMP_PREFIX_NONE
, 16, 1, 
m
, (
mbulk
), 0);

844 #ifdeà
CONFIG_SCSC_SMAPPER


845 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

847 
	`kä“_skb
(
skb
);

848  
NULL
;

851 
p
 += 4;

854 
	`memıy
(
	`skb_put
(
skb
, 
cb
->
sig_Ëngth
), 
p
, cb->sig_length);

856 ià(
m
->
Ën
)

857 
	`çpi_­³nd_d©a
(
skb
, 
	`mbulk_d©_r
(
m
), m->
Ën
);

858 
j
 = 0; j < 
i
; j++)

859 
	`çpi_­³nd_d©a
(
skb
, 
	`mbulk_d©_r
(
Ãxt_mbulk
[
j
]),‚ext_mbulk[j]->
Ën
);

861  
skb
;

862 
	}
}

866 
	$h4_q_add_sigÇl
(
¦si_h4
 *
h
, 
h4_h_q_cÚf
 
cÚf
, 
scsc_miäam_»f
 
phy_m
, 
scsc_£rviû
 *
£rviû
)

868 
h4_h_cÚŒŞ
 *
ù¾
 = 
h
->
h_cÚŒŞ
;

869 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

870 
u8
 
idx_w
;

871 
u8
 
idx_r
;

874 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
cÚf
, 
widx
);

876 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
cÚf
, 
ridx
);

877 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
cÚf
, 
widx
, 
idx_w
, 1);

878 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
cÚf
, 
ridx
, 
idx_r
, 1);

881 ià(
idx_r
 =ğ((
idx_w
 + 1è& (
MAX_NUM
 - 1)))

882  -
ENOSPC
;

885 
ù¾
->
q
[
cÚf
].
¬¿y
[
idx_w
] = 
phy_m
;

887 
	`smp_wmb
();

888 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
phy_m
, 
cÚf
);

889 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


890 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
cÚf
] = hip->hip_priv->stats.q_num_frames[conf] + 1;

894 
idx_w
++;

895 
idx_w
 &ğ(
MAX_NUM
 - 1);

898 
	`h4_upd©e_šdex
(
h
, 
cÚf
, 
widx
, 
idx_w
);

900 
£nd
 = 
	`ktime_g‘
();

901 
	`scsc_£rviû_mifšŒb™_b™_£t
(
£rviû
, 
h_´iv
->
šŒ_äomho¡
, 
SCSC_MIFINTR_TARGET_WLAN
);

904 
	}
}

906 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


907 
	$h4_w©chdog
(
tim”_li¡
 *
t
)

909 
	$h4_w©chdog
(
d©a
)

912 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


913 
h4_´iv
 *
´iv
 = 
	`äom_tim”
Õriv, 
t
, 
w©chdog
);

914 
¦si_h4
 *
h
 = 
´iv
->hip;

916 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

918 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

919 
scsc_£rviû
 *
£rviû
;

920 
ktime_t
 
šŒ_ov
;

921 
æags
;

922 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


923 
boŞ
 
»Œigg”_w©chdog
 = 
Œue
;

924 
u8
 
i
;

927 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

930 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

931 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
))

932 
ex™
;

934 
wdt
 = 
	`ktime_g‘
();

936 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


938 ià(
	`‹¡_ªd_ş—r_b™
(
HIP4_MIF_Q_FH_RFB
, 
h
->
h_´iv
->
œq_b™m­
)) {

939 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived_fb
, 
	`jiff›s_to_m£cs
(
HZ
));

940 ià((
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0))

941 
»Œigg”_w©chdog
 = 
çl£
;

943 ià(
	`‹¡_ªd_ş—r_b™
(
HIP4_MIF_Q_TH_CTRL
, 
h
->
h_´iv
->
œq_b™m­
)) {

944 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived_ù¾
, 
	`jiff›s_to_m£cs
(
HZ
));

945 ià((
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0))

946 
»Œigg”_w©chdog
 = 
çl£
;

948 ià(
	`‹¡_ªd_ş—r_b™
(
HIP4_MIF_Q_TH_DAT
, 
h
->
h_´iv
->
œq_b™m­
)) {

949 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived_d©a
, 
	`jiff›s_to_m£cs
(
HZ
));

950 ià((
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0))

951 
»Œigg”_w©chdog
 = 
çl£
;

953 ià(
»Œigg”_w©chdog
) {

954 
wdt
 = 
	`ktime_£t
(0, 0);

956 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
 / 2);

957 
ex™
;

961 ià(
	`ktime_com·»
(
šŒ_»ûived
, 
wdt
) > 0) {

962 
wdt
 = 
	`ktime_£t
(0, 0);

963 
ex™
;

966 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived
, 
	`jiff›s_to_m£cs
(
HZ
));

969 ià(!(
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0)) {

970 
wdt
 = 
	`ktime_£t
(0, 0);

972 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
 / 2);

973 
ex™
;

978 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

979 
	`h4_dump_dbg
(
h
, 
NULL
, NULL, 
sdev
->
£rviû
);

980 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

982 
£rviû
 = 
sdev
->service;

984 
	`SLSI_INFO_NODEV
("Hip4 watchdogriggered\n");

986 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


987 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

988 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] =ğ
MIF_NO_IRQ
)

990 ià(
	`scsc_£rviû_mifšŒb™_b™_mask_¡©us_g‘
(
£rviû
è& (1 << 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
])) {

992 
	`SLSI_INFO_NODEV
("%d: IÁ”ru± Masked. UnmaskØ»¡¬ˆIÁ”ru±…roûssšg\n", 
i
);

993 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

997 ià(
	`scsc_£rviû_mifšŒb™_b™_mask_¡©us_g‘
(
£rviû
è& (1 << 
h
->
h_´iv
->
šŒ_toho¡
)) {

999 
	`SLSI_INFO_NODEV
("Interrupt Masked. Unmasko„estart Interrupt…rocessing\n");

1000 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

1003 
ex™
:

1004 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

1005 
	}
}

1007 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1008 
	$h4_£t_Çpi_ıu
(
¦si_h4
 *
h
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
)

1010 
h4_´iv
 *
h_´iv
;

1011 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1012 
æags
;

1014 ià(!
h
)

1017 
h_´iv
 = 
h
->hip_priv;

1019 ià(!
h_´iv
)

1022 ià(!
	`ıu_Úlše
(
Çpi_ıu
)) {

1023 
	`SLSI_ERR_NODEV
("CPU%d i ofæše.\n", 
Çpi_ıu
);

1024 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1028 
	`¦si_wake_lock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1029 ià(
Çpi_ıu
 !ğ
Çpi_£Ëù_ıu
) {

1030 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1031 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1032 ià(!
	`‹¡_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
)) {

1033 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1034 
	`SLSI_INFO_NODEV
("NAPI i ®»ady di§bËd oÀCPU%d\n", 
Çpi_£Ëù_ıu
);

1035 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1039 
	`SLSI_INFO_NODEV
("di§bË NAPI oÀCPU%d\n", 
Çpi_£Ëù_ıu
);

1040 
	`ş—r_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
);

1041 
Çpi_£Ëù_ıu
 = 
Çpi_ıu
;

1044 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1045 
	`Çpi_di§bË
(&
h
->
h_´iv
->
Çpi
);

1047 #ià
	`defšed
(
CONFIG_SOC_S5E9815
è&& defšed(
CONFIG_SCSC_QOS
)

1052 ià(
	`scsc_£rviû_£t_affš™y_ıu
(
sdev
->
£rviû
, 
Çpi_£Ëù_ıu
) != 0)

1053 
	`SLSI_ERR_NODEV
("çedØchªgIRQ‡ffš™y (CPU%d)\n", 
Çpi_£Ëù_ıu
);

1056 
	`loÿl_bh_di§bË
();

1057 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1059 
h_´iv
->
Çpi_³rf_mode
 = 
³rf_mode
;

1060 ià(!
	`‹¡_ªd_£t_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
)) {

1061 
	`SLSI_INFO_NODEV
("’abË NAPI oÀCPU%d\n", 
Çpi_£Ëù_ıu
);

1062 
	`Çpi_’abË
(&
h
->
h_´iv
->
Çpi
);

1064 ià(
Çpi_£Ëù_ıu
 =ğ
	`smp_´oûssÜ_id
()) {

1065 
	`Çpi_scheduË
(&
h
->
h_´iv
->
Çpi
);

1067 ià(
Çpi_£Ëù_ıu
 && 
	`ıu_Úlše
(napi_select_cpu))

1068 
	`scheduË_wÜk_Ú
(
Çpi_£Ëù_ıu
, &
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

1070 
	`Çpi_scheduË
(&
h
->
h_´iv
->
Çpi
);

1074 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1075 
	`loÿl_bh_’abË
();

1077 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1078 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1079 
	}
}

1081 
	$h4__fb
(
d©a
)

1084 
¦si_h4
 *
h
 = (*)
d©a
;

1085 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

1086 
h4_h_cÚŒŞ
 *
ù¾
;

1087 
scsc_£rviû
 *
£rviû
;

1088 
¦si_dev
 *
sdev
;

1089 
boŞ
 
no_chªge
 = 
Œue
;

1090 
u8
 
idx_r
;

1091 
u8
 
idx_w
;

1092 
scsc_miäam_»f
 
»f
;

1093 *
mem
;

1095 ià(!
h_´iv
 || !h_´iv->
h
) {

1096 
	`SLSI_ERR_NODEV
("hip_priv or hip_priv->hip is Null\n");

1100 
h
 = 
h_´iv
->hip;

1101 
ù¾
 = 
h
->
h_cÚŒŞ
;

1103 ià(!
ù¾
) {

1104 
	`SLSI_ERR_NODEV
("hip->hip_control is Null\n");

1107 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

1109 ià(!
sdev
 || !sdev->
£rviû
) {

1110 
	`SLSI_ERR_NODEV
("sdev or sdev->service is Null\n");

1114 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1115 
£rviû
 = 
sdev
->service;

1116 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h
->
h_´iv
->
mšÜ
, 2);

1117 
bh_š™_fb
 = 
	`ktime_g‘
();

1118 
	`ş—r_b™
(
HIP4_MIF_Q_FH_RFB
, 
h
->
h_´iv
->
œq_b™m­
);

1120 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
);

1121 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
widx
);

1123 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1124 ià(
idx_r
 !ğ
idx_w
) {

1125 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
, 1);

1126 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
widx
, 
idx_w
, 1);

1129 
idx_r
 !ğ
idx_w
) {

1130 
mbulk
 *
m
;

1131 
mbulk_cŞour
 
cŞour
;

1133 
no_chªge
 = 
çl£
;

1134 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_FH_RFB
].
¬¿y
[
idx_r
];

1135 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1136 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_FH_RFB
);

1138 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1139 
m
 = (
mbulk
 *)
mem
;

1141 ià(!
m
) {

1142 
	`SLSI_ERR_NODEV
("FB: Mbulk is NULL\n");

1143 
cÚsume_fb_mbulk
;

1146 ià((
m
->
pid
 & 0x1è=ğ
MBULK_POOL_ID_DATA
) {

1147 
cŞour
 = 
	`mbulk_g‘_cŞour
(
MBULK_POOL_ID_DATA
, 
m
);

1148 #ià
	`defšed
(
CONFIG_SCSC_WLAN_HIP4_PROFILING
è&& !defšed(
CONFIG_SCSC_WLAN_TX_API
)

1149 
	`SCSC_HIP4_SAMPLER_VIF_PEER
(
h
->
h_´iv
->
mšÜ
,

1151 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1152 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
));

1155 
u16
 
ho¡_g
;

1156 
u8
 *
g‘_ho¡_g
;

1161 
g‘_ho¡_g
 = (
u8
 *)
m
;

1162 
ho¡_g
 = 
g‘_ho¡_g
[37] << 8 | get_host_tag[36];

1163 
	`SCSC_HIP4_SAMPLER_PKT_TX_FB
(
h
->
h_´iv
->
mšÜ
, 
ho¡_g
);

1167 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1168 
	`¦si_h_tx_dÚe
(
sdev
, 
cŞour
, (
idx_r
 + 1 & (
MAX_NUM
 - 1)è!ğ
idx_w
);

1170 
	`¦si_h_tx_dÚe
(
sdev
,

1171 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1172 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
),

1173 
	`SLSI_MBULK_COLOUR_GET_AC
(
cŞour
));

1176 
	`mbulk_ä“_vœt_ho¡
(
m
);

1177 
cÚsume_fb_mbulk
:

1179 
idx_r
++;

1180 
idx_r
 &ğ(
MAX_NUM
 - 1);

1181 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
);

1184 ià(
no_chªge
)

1185 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
);

1187 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1188 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

1189 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

1191 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h
->
h_´iv
->
mšÜ
, 2);

1193 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

1194 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_tx
);

1195 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1196 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_tx", 
WL_REASON_RX
);

1200 
bh_’d_fb
 = 
	`ktime_g‘
();

1201 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1202 
	}
}

1204 
	$h4_œq_hªdËr_fb
(
œq
, *
d©a
)

1206 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

1207 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1209 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 2);

1210 
šŒ_»ûived_fb
 = 
	`ktime_g‘
();

1212 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

1213 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_tx
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1214 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1215 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_tx", 
WL_REASON_RX
);

1219 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

1220 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

1221 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

1223 
	`£t_b™
(
HIP4_MIF_Q_FH_RFB
, 
h
->
h_´iv
->
œq_b™m­
);

1225 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
œq
);

1226 
	`skËt_hi_scheduË
(&
h
->
h_´iv
->
šŒ__fb
);

1229 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
œq
);

1230 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 2);

1231 
	}
}

1233 
	$h4_wq_ù¾
(
wÜk_¡ruù
 *
d©a
)

1235 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
d©a
, h4_´iv, 
šŒ_wq_ù¾
);

1236 
¦si_h4
 *
h
;

1237 
h4_h_cÚŒŞ
 *
ù¾
;

1238 
scsc_£rviû
 *
£rviû
;

1239 
¦si_dev
 *
sdev
;

1240 
u8
 
»Œy
;

1241 
boŞ
 
no_chªge
 = 
Œue
;

1242 
u8
 
idx_r
;

1243 
u8
 
idx_w
;

1244 
scsc_miäam_»f
 
»f
;

1245 *
mem
;

1246 
mbulk
 *
m
;

1247 #ià
	`defšed
(
CONFIG_SCSC_WLAN_DEBUG
è|| defšed(
CONFIG_SCSC_WLAN_HIP4_PROFILING
)

1248 
id
;

1251 ià(!
h_´iv
 || !h_´iv->
h
) {

1252 
	`SLSI_ERR_NODEV
("hip_priv or hip_priv->hip is Null\n");

1256 
h
 = 
h_´iv
->hip;

1257 
ù¾
 = 
h
->
h_cÚŒŞ
;

1259 ià(!
ù¾
) {

1260 
	`SLSI_ERR_NODEV
("hip->hip_control is Null\n");

1263 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

1265 ià(!
sdev
 || !sdev->
£rviû
) {

1266 
	`SLSI_ERR_NODEV
("sdev or sdev->service is Null\n");

1270 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1271 
£rviû
 = 
sdev
->service;

1272 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h
->
h_´iv
->
mšÜ
, 1);

1273 
bh_š™_ù¾
 = 
	`ktime_g‘
();

1274 
	`ş—r_b™
(
HIP4_MIF_Q_TH_CTRL
, 
h
->
h_´iv
->
œq_b™m­
);

1276 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
);

1277 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
);

1279 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1280 ià(
idx_r
 !ğ
idx_w
) {

1281 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
, 1);

1282 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
, 
idx_w
, 1);

1285 
idx_r
 !ğ
idx_w
) {

1286 
sk_buff
 *
skb
;

1291 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

1292 
u8
 
i
 = 0;

1294 
no_chªge
 = 
çl£
;

1296 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_CTRL
].
¬¿y
[
idx_r
];

1297 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1298 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_CTRL
);

1300 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1301 
m
 = (
mbulk
 *)(
mem
);

1303 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
çl£
);

1304 ià(!
skb
) {

1305 
	`SLSI_ERR_NODEV
("Ctrl: Error…arsing or‡llocating skb\n");

1306 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1307 
cÚsume_ùl_mbulk
;

1310 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

1311 
	`SLSI_INFO
(
sdev
, "WIFI wakeu°by MLME f¿m0x%x:\n", 
	`çpi_g‘_sigid
(
skb
));

1312 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

1313 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

1316 #ià
	`defšed
(
CONFIG_SCSC_WLAN_DEBUG
è|| defšed(
CONFIG_SCSC_WLAN_HIP4_PROFILING
)

1317 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1319 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1321 ià(
	`çpi_is_mlme
(
skb
))

1322 
	`SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
h_´iv
->
mšÜ
, (
id
 & 0xff00) >> 8, id & 0xff);

1324 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1325 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

1327 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

1328 
	`SLSI_ERR_NODEV
("Ctrl: Error detected slsi_hip_rx\n");

1329 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1330 #ifdeà
CONFIG_SCSC_SMAPPER


1331 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

1333 
	`kä“_skb
(
skb
);

1335 
cÚsume_ùl_mbulk
:

1337 
idx_r
++;

1338 
idx_r
 &ğ(
MAX_NUM
 - 1);

1341 (
»f
 = 
to_ä“
[
i
++])) {

1343 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

1345 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& (
»Œy
 > 0)) {

1346 
	`SLSI_WARN_NODEV
("CŒl: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

1347 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1348 
	`m¦“p
(
FB_NO_SPC_SLEEP_MS
);

1349 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1350 
»Œy
--;

1351 ià(
»Œy
 == 0)

1352 
	`SLSI_ERR_NODEV
("CŒl: FB ha nÙ b“Àä“d fÜ %d ms\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_SLEEP_MS
);

1353 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

1356 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
);

1359 ià(
no_chªge
)

1360 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
);

1362 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1363 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

1364 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

1366 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h
->
h_´iv
->
mšÜ
, 1);

1368 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
)) {

1369 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
);

1370 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1371 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_ù¾", 
WL_REASON_RX
);

1375 
bh_’d_ù¾
 = 
	`ktime_g‘
();

1376 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1377 
	}
}

1379 
	$h4_œq_hªdËr_ù¾
(
œq
, *
d©a
)

1381 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

1382 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1384 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 1);

1385 
šŒ_»ûived_ù¾
 = 
	`ktime_g‘
();

1387 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
)) {

1388 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1389 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1390 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_ù¾", 
WL_REASON_RX
);

1394 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

1395 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

1396 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

1398 
	`£t_b™
(
HIP4_MIF_Q_TH_CTRL
, 
h
->
h_´iv
->
œq_b™m­
);

1400 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
œq
);

1402 ià(
h4_sy¡em_wq
)

1403 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

1405 
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq_ù¾
);

1408 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
œq
);

1409 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 1);

1410 
	}
}

1412 
	$h4_sched_wq_ù¾
(
¦si_h4
 *
h
)

1414 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1416 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

1419 ià(
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
))

1422 
	`h4_dump_dbg
(
h
, 
NULL
, NULL, 
sdev
->
£rviû
);

1424 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
)) {

1425 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1426 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1427 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_ù¾", 
WL_REASON_RX
);

1431 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "Trigger wq for skipped ctrl BH\n");

1433 ià(
h4_sy¡em_wq
)

1434 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

1436 if(!
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq_ù¾
))

1437 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "hip4_wq_ctrl is‡lready scheduled\n");

1438 
	}
}

1440 
	$h4_Çpi_pŞl
(
Çpi_¡ruù
 *
Çpi
, 
budg‘
)

1442 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
Çpi
, hip4_priv,‚api);

1443 
¦si_h4
 *
h
;

1444 
h4_h_cÚŒŞ
 *
ù¾
;

1445 
scsc_£rviû
 *
£rviû
;

1446 
¦si_dev
 *
sdev
;

1448 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1449 
id
;

1451 
u8
 
idx_r
;

1452 
u8
 
idx_w
;

1453 
scsc_miäam_»f
 
»f
;

1454 *
mem
;

1455 
mbulk
 *
m
;

1456 
u8
 
»Œy
;

1457 
u8
 
todo
 = 0;

1458 
wÜk_dÚe
 = 0;

1460 
	`¥š_lock_bh
(&
š_Çpi_cÚ‹xt
);

1461 ià(!
h_´iv
 || !h_´iv->
h
) {

1462 
	`SLSI_ERR_NODEV
("hip_priv or hip_priv->hip is Null\n");

1463 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1467 
h
 = 
h_´iv
->hip;

1468 ià(!
h
 || !h->
h_´iv
) {

1469 
	`SLSI_ERR_NODEV
("either hip or hip->hip_priv is Null\n");

1470 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1474 
ù¾
 = 
h
->
h_cÚŒŞ
;

1476 ià(!
ù¾
) {

1477 
	`SLSI_ERR_NODEV
("hip->hip_control is Null\n");

1478 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1481 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

1483 ià(!
sdev
 || !sdev->
£rviû
) {

1484 
	`SLSI_ERR_NODEV
("sdev or sdev->service is Null\n");

1485 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1489 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
) {

1490 
	`Çpi_com¶‘e
(
Çpi
);

1491 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1495 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1496 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h
->
h_´iv
->
mšÜ
, 0);

1497 ià(
	`ktime_com·»
(
bh_š™_d©a
, 
bh_’d_d©a
) <= 0) {

1498 
bh_š™_d©a
 = 
	`ktime_g‘
();

1499 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
))

1500 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

1502 
	`ş—r_b™
(
HIP4_MIF_Q_TH_DAT
, 
h
->
h_´iv
->
œq_b™m­
);

1504 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
);

1505 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
widx
);

1507 
£rviû
 = 
sdev
->service;

1509 ià(
idx_r
 =ğ
idx_w
) {

1510 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "nothingo do, NAPI Complete\n");

1511 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

1512 
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

1513 
bh_’d_d©a
 = 
	`ktime_g‘
();

1514 
	`Çpi_com¶‘e
(
Çpi
);

1515 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1517 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1520 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_d©a
)) {

1521 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1522 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1523 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_d©a", 
WL_REASON_RX
);

1527 
’d
;

1530 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1531 ià(
idx_r
 !ğ
idx_w
) {

1532 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
, 1);

1533 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
widx
, 
idx_w
, 1);

1537 
todo
 = ((
idx_w
 - 
idx_r
) & 0xff);

1538 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "todo:%hhu\n", 
todo
);

1541 ià(
h4_Çpi_rx_§tu¿tiÚ_d‘eùiÚ
 && !
Çpi_£Ëù_ıu
 && !
h_´iv
->
Çpi_³rf_mode
 && !h_´iv->
Çpi_rx_§tu¿‹d
) {

1542 ià(
todo
 > 
h4_Çpi_num_rx_pkts
)

1544 ià(++
h_´iv
->
Çpi_rx_fuÎ_út
 >ğ
h4_Çpi_num_rx_fuÎ
) {

1545 
	`SLSI_INFO
(
sdev
, "Rx queue saturating.. moveo…erformance mode\n");

1546 
h_´iv
->
Çpi_rx_§tu¿‹d
 = 1;

1549 
	`¦si_Œaffic_mÚ_ov”ride
(
sdev
);

1552 
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

1556 
idx_r
 !ğ
idx_w
) {

1557 
sk_buff
 *
skb
;

1562 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

1563 
u8
 
i
 = 0;

1566 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_DAT
].
¬¿y
[
idx_r
];

1567 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1568 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_DAT
);

1570 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1571 
m
 = (
mbulk
 *)(
mem
);

1572 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
Œue
);

1573 ià(!
skb
) {

1574 
	`SLSI_ERR_NODEV
("Dat: Error…arsing or‡llocating skb\n");

1575 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1576 
cÚsume_d©_mbulk
;

1579 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

1580 
	`SLSI_INFO
(
sdev
, "WIFI wakeup by DATA frame vif:%d,…id:%d, sigid:0x%x\n",

1581 
	`çpi_g‘_vif
(
skb
), 
	`çpi_g‘_u16
(skb, 
»ûiv”_pid
), 
	`çpi_g‘_sigid
(skb));

1582 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

1583 
	`¦si_dump_‘h_·ck‘
(
sdev
, 
skb
);

1586 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1587 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1588 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

1590 #ifdeà
CONFIG_SCSC_SMAPPER


1592 ià(
m
->
æag
 & 
MBULK_F_SMAPPER
) {

1593 
	`¦si_skb_cb_g‘
(
skb
)->
sm­³r_lšked
 = 
Œue
;

1596 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

1597 
	`SLSI_ERR_NODEV
("Dat: Error detected slsi_hip_rx\n");

1598 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1599 #ifdeà
CONFIG_SCSC_SMAPPER


1600 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

1602 
	`kä“_skb
(
skb
);

1604 
cÚsume_d©_mbulk
:

1606 
idx_r
++;

1607 
idx_r
 &ğ(
MAX_NUM
 - 1);

1609 (
»f
 = 
to_ä“
[
i
++])) {

1611 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

1612 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& (
»Œy
 > 0)) {

1613 
	`SLSI_WARN_NODEV
("D©: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

1614 
	`ud–ay
(
FB_NO_SPC_DELAY_US
);

1615 
»Œy
--;

1617 ià(
»Œy
 == 0)

1618 
	`SLSI_ERR_NODEV
("D©: FB ha nÙ b“Àä“d fÜ %d us\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_DELAY_US
);

1619 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1620 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

1625 
wÜk_dÚe
++;

1626 ià(
budg‘
 =ğ
wÜk_dÚe
) {

1632 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
);

1634 ià(
wÜk_dÚe
 < 
budg‘
) {

1635 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "NAPI com¶‘(wÜk_dÚe:%d)\n", 
wÜk_dÚe
);

1636 
bh_’d_d©a
 = 
	`ktime_g‘
();

1637 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

1638 
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

1639 
	`Çpi_com¶‘e
(
Çpi
);

1640 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1642 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1644 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_d©a
)) {

1645 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1646 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1647 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_d©a", 
WL_REASON_RX
);

1651 
’d
:

1652 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "wÜk dÚe:%d\n", 
wÜk_dÚe
);

1653 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h
->
h_´iv
->
mšÜ
, 0);

1654 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1655 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1656  
wÜk_dÚe
;

1657 
	}
}

1659 
	$h4_œq_d©a_Çpi_sw™ch_wÜk
(
wÜk_¡ruù
 *
wÜk
)

1661 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
wÜk
, h4_´iv, 
šŒ_wq_Çpi_ıu_sw™ch
);

1662 
	`loÿl_bh_di§bË
();

1663 
	`Çpi_scheduË
(&
h_´iv
->
Çpi
);

1664 
	`loÿl_bh_’abË
();

1665 
	}
}

1667 
	$h4_œq_hªdËr_d©
(
œq
, *
d©a
)

1669 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

1670 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1671 
æags
;

1673 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

1676 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 0);

1677 
šŒ_»ûived_d©a
 = 
	`ktime_g‘
();

1679 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_d©a
)) {

1680 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_d©a
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1681 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1682 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_d©a", 
WL_REASON_RX
);

1686 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

1687 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

1688 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

1690 
	`£t_b™
(
HIP4_MIF_Q_TH_DAT
, 
h
->
h_´iv
->
œq_b™m­
);

1693 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1695 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1696 ià(
	`‹¡_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
)) {

1697 ià(
Çpi_£Ëù_ıu
 && (Çpi_£Ëù_ıu !ğ
	`smp_´oûssÜ_id
()è&& 
	`ıu_Úlše
(napi_select_cpu))

1704 
	`scheduË_wÜk_Ú
(
Çpi_£Ëù_ıu
, &
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

1706 
	`Çpi_scheduË
(&
h
->
h_´iv
->
Çpi
);

1708 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1710 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1711 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 0);

1712 
	}
}

1716 
boŞ
 
	$¦si_check_rx_æowcÚŒŞ
(
¦si_dev
 *
sdev
)

1718 
Ãtdev_vif
 *
ndev_vif
;

1719 
qËn
 = 0;

1721 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1722 ià(
ndev_vif
)

1723 
qËn
 = 
	`skb_queue_Ën
(&
ndev_vif
->
rx_d©a
.
queue
);

1725 ià(!
	`mu‹x_Œylock
(&
sdev
->
Ãtdev_»move_mu‹x
))

1726 
ev®u©e
;

1728 #ià
	`defšed
(
SLSI_NET_INDEX_P2PX_SWLAN
)

1729 ià(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]) {

1730 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

1731 ià(
ndev_vif
)

1732 
qËn
 +ğ
	`skb_queue_Ën
(&
ndev_vif
->
rx_d©a
.
queue
);

1734 #–ià
	`defšed
(
SLSI_NET_INDEX_P2PX
)

1735 ià(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX
]) {

1736 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX
]);

1737 ià(
ndev_vif
)

1738 
qËn
 +ğ
	`skb_queue_Ën
(&
ndev_vif
->
rx_d©a
.
queue
);

1741 
	`mu‹x_uÆock
(&
sdev
->
Ãtdev_»move_mu‹x
);

1743 
ev®u©e
:

1744 ià(
qËn
 > 
max_bufã»d_äames
) {

1745 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "max qËÀ»ached: %d\n", 
qËn
);

1746  
Œue
;

1748 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "qËÀ%d\n", 
qËn
);

1750  
çl£
;

1751 
	}
}

1756 
	$h4_wq
(
wÜk_¡ruù
 *
d©a
)

1758 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
d©a
, h4_´iv, 
šŒ_wq
);

1759 
¦si_h4
 *
h
 = 
h_´iv
->hip;

1760 
h4_h_cÚŒŞ
 *
ù¾
 = 
h
->
h_cÚŒŞ
;

1761 
scsc_miäam_»f
 
»f
;

1762 *
mem
;

1763 
mbulk
 *
m
;

1764 
u8
 
idx_r
;

1765 
u8
 
idx_w
;

1766 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1767 
scsc_£rviû
 *
£rviû
;

1768 
boŞ
 
no_chªge
 = 
Œue
;

1769 
u8
 
»Œy
;

1770 
u32
 
·ck‘s_tÙ®
;

1772 #ià
	`defšed
(
CONFIG_SCSC_WLAN_HIP4_PROFILING
è|| defšed(
CONFIG_SCSC_WLAN_DEBUG
)

1773 
id
;

1776 ià(!
sdev
 || !sdev->
£rviû
) {

1777 
	`WARN_ON
(1);

1781 
£rviû
 = 
sdev
->service;

1783 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 1);

1784 
h4_rx_æowcÚŒŞ
 = 
	`¦si_check_rx_æowcÚŒŞ
(
sdev
);

1786 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 2);

1787 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1788 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 3);

1790 
bh_š™
 = 
	`ktime_g‘
();

1792 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1795 
u64
 
j™‹r
;

1797 
j™‹r
 = 
	`ktime_to_ns
(
	`ktime_sub
(
bh_š™
, 
šŒ_»ûived
));

1799 ià(
j™‹r
 <ğ
HISTO_1
)

1800 
hi¡og¿m_1
++;

1801 ià(
j™‹r
 > 
HISTO_1
 && j™‹¸<ğ
HISTO_2
)

1802 
hi¡og¿m_2
++;

1803 ià(
j™‹r
 > 
HISTO_2
 && j™‹¸<ğ
HISTO_3
)

1804 
hi¡og¿m_3
++;

1805 ià(
j™‹r
 > 
HISTO_3
 && j™‹¸<ğ
HISTO_4
)

1806 
hi¡og¿m_4
++;

1807 ià(
j™‹r
 > 
HISTO_4
 && j™‹¸<ğ
HISTO_5
)

1808 
hi¡og¿m_5
++;

1810 
hi¡og¿m_6
++;

1812 ià(
j™‹r
 > 
max_j™‹r
)

1813 
max_j™‹r
 = 
j™‹r
;

1816 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
);

1817 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
widx
);

1819 ià(
idx_r
 !ğ
idx_w
) {

1820 
no_chªge
 = 
çl£
;

1821 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
, 1);

1822 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
widx
, 
idx_w
, 1);

1825 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h_´iv
->
mšÜ
, 2);

1826 
idx_r
 !ğ
idx_w
) {

1827 
mbulk
 *
m
;

1828 
mbulk_cŞour
 
cŞour
;

1830 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_FH_RFB
].
¬¿y
[
idx_r
];

1831 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_FH_RFB
);

1832 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1833 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
HIP4_MIF_Q_FH_RFB
] = hip->hip_priv->stats.q_num_frames[HIP4_MIF_Q_FH_RFB] + 1;

1835 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1836 
m
 = (
mbulk
 *)
mem
;

1837 ià(!
m
) {

1838 
	`SLSI_ERR_NODEV
("FB: Mbulk i NULL 0x%x\n", 
»f
);

1839 
cÚsume_fb_mbulk
;

1843 ià((
m
->
pid
 & 0x1è=ğ
MBULK_POOL_ID_DATA
) {

1844 
cŞour
 = 
	`mbulk_g‘_cŞour
(
MBULK_POOL_ID_DATA
, 
m
);

1845 #ià
	`defšed
(
CONFIG_SCSC_WLAN_HIP4_PROFILING
è&& !defšed(
CONFIG_SCSC_WLAN_TX_API
)

1846 
	`SCSC_HIP4_SAMPLER_VIF_PEER
(
h
->
h_´iv
->
mšÜ
,

1848 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1849 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
));

1852 
u16
 
ho¡_g
;

1853 
u8
 *
g‘_ho¡_g
;

1858 
g‘_ho¡_g
 = (
u8
 *)
m
;

1859 
ho¡_g
 = 
g‘_ho¡_g
[37] << 8 | get_host_tag[36];

1860 
	`SCSC_HIP4_SAMPLER_PKT_TX_FB
(
h
->
h_´iv
->
mšÜ
, 
ho¡_g
);

1864 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1865 
	`¦si_h_tx_dÚe
(
sdev
, 
cŞour
, (
idx_r
 + 1 & (
MAX_NUM
 - 1)è!ğ
idx_w
);

1867 
	`¦si_h_tx_dÚe
(
sdev
,

1868 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1869 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
),

1870 
	`SLSI_MBULK_COLOUR_GET_AC
(
cŞour
));

1873 
	`mbulk_ä“_vœt_ho¡
(
m
);

1874 
cÚsume_fb_mbulk
:

1876 
idx_r
++;

1877 
idx_r
 &ğ(
MAX_NUM
 - 1);

1878 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
);

1880 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h_´iv
->
mšÜ
, 2);

1882 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 4);

1884 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
);

1885 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
);

1887 ià(
idx_r
 !ğ
idx_w
) {

1888 
no_chªge
 = 
çl£
;

1889 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
, 1);

1890 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
, 
idx_w
, 1);

1893 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h_´iv
->
mšÜ
, 1);

1894 
idx_r
 !ğ
idx_w
) {

1895 
sk_buff
 *
skb
;

1900 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

1901 
u8
 
i
 = 0;

1904 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_CTRL
].
¬¿y
[
idx_r
];

1905 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_CTRL
);

1906 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1907 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
HIP4_MIF_Q_TH_CTRL
] = hip->hip_priv->stats.q_num_frames[HIP4_MIF_Q_TH_CTRL] + 1;

1909 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1910 
m
 = (
mbulk
 *)(
mem
);

1911 ià(!
m
) {

1912 
	`SLSI_ERR_NODEV
("CŒl: Mbulk i NULL 0x%x\n", 
»f
);

1913 
cÚsume_ùl_mbulk
;

1916 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
çl£
);

1917 ià(!
skb
) {

1918 
	`SLSI_ERR_NODEV
("Ctrl: Error…arsing or‡llocating skb\n");

1919 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1920 
cÚsume_ùl_mbulk
;

1923 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

1924 
	`SLSI_INFO
(
sdev
, "WIFI wakeu°by MLME f¿m0x%x:\n", 
	`çpi_g‘_sigid
(
skb
));

1925 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

1926 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

1929 #ià
	`defšed
(
CONFIG_SCSC_WLAN_HIP4_PROFILING
è|| defšed(
CONFIG_SCSC_WLAN_DEBUG
)

1930 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1932 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1934 ià(
	`çpi_is_mlme
(
skb
))

1935 
	`SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
h_´iv
->
mšÜ
, (
id
 & 0xff00) >> 8, id & 0xff);

1937 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1938 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

1940 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

1941 
	`SLSI_ERR_NODEV
("Ctrl: Error detected slsi_hip_rx\n");

1942 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1943 #ifdeà
CONFIG_SCSC_SMAPPER


1944 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

1946 
	`kä“_skb
(
skb
);

1948 
cÚsume_ùl_mbulk
:

1950 
idx_r
++;

1951 
idx_r
 &ğ(
MAX_NUM
 - 1);

1954 (
»f
 = 
to_ä“
[
i
++])) {

1956 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

1958 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& 
»Œy
 > 0) {

1959 
	`SLSI_WARN_NODEV
("CŒl: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

1960 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1961 
	`m¦“p
(
FB_NO_SPC_SLEEP_MS
);

1962 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1963 
»Œy
--;

1964 ià(
»Œy
 == 0)

1965 
	`SLSI_ERR_NODEV
("CŒl: FB ha nÙ b“Àä“d fÜ %d ms\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_SLEEP_MS
);

1966 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

1969 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
);

1972 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h_´iv
->
mšÜ
, 1);

1974 ià(
h4_rx_æowcÚŒŞ
)

1975 
sk_d©a_q
;

1977 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 5);

1979 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
);

1980 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
widx
);

1982 ià(
idx_r
 !ğ
idx_w
) {

1983 
·ck‘s_tÙ®
 = 0;

1984 
no_chªge
 = 
çl£
;

1985 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
, 1);

1986 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
widx
, 
idx_w
, 1);

1987 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1990 
u8
 
num_·ck‘s
 = (
idx_w
 - 
idx_r
) % 256;

1992 ià(
num_·ck‘s
 <ğ
HISTO_1_DATA
)

1993 
hi¡og¿m_1_d©a
++;

1994 ià(
num_·ck‘s
 > 
HISTO_1_DATA
 &&‚um_·ck‘ <ğ
HISTO_2_DATA
)

1995 
hi¡og¿m_2_d©a
++;

1996 ià(
num_·ck‘s
 > 
HISTO_2_DATA
 &&‚um_·ck‘ <ğ
HISTO_3_DATA
)

1997 
hi¡og¿m_3_d©a
++;

1998 ià(
num_·ck‘s
 > 
HISTO_3_DATA
 &&‚um_·ck‘ <ğ
HISTO_4_DATA
)

1999 
hi¡og¿m_4_d©a
++;

2000 ià(
num_·ck‘s
 > 
HISTO_4_DATA
 &&‚um_·ck‘ <ğ
HISTO_5_DATA
)

2001 
hi¡og¿m_5_d©a
++;

2003 
hi¡og¿m_6_d©a
++;

2004 ià(
num_·ck‘s
 > 
max_d©a
)

2005 
max_d©a
 = 
num_·ck‘s
;

2010 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h_´iv
->
mšÜ
, 0);

2011 
idx_r
 !ğ
idx_w
) {

2012 
sk_buff
 *
skb
;

2017 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

2018 
u8
 
i
 = 0;

2020 
·ck‘s_tÙ®
++;

2022 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_DAT
].
¬¿y
[
idx_r
];

2023 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_DAT
);

2024 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2025 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
HIP4_MIF_Q_TH_DAT
] = hip->hip_priv->stats.q_num_frames[HIP4_MIF_Q_TH_DAT] + 1;

2027 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

2028 
m
 = (
mbulk
 *)(
mem
);

2029 ià(!
m
) {

2030 
	`SLSI_ERR_NODEV
("D©: Mbulk i NULL 0x%x\n", 
»f
);

2031 
cÚsume_d©_mbulk
;

2034 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
çl£
);

2035 ià(!
skb
) {

2036 
	`SLSI_ERR_NODEV
("Dat: Error…arsing or‡llocating skb\n");

2037 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

2038 
cÚsume_d©_mbulk
;

2041 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

2042 
	`SLSI_INFO
(
sdev
, "WIFI wakeup by DATA frame:\n");

2043 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

2046 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2047 
id
 = 
	`çpi_g‘_sigid
(
skb
);

2048 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

2050 #ifdeà
CONFIG_SCSC_SMAPPER


2052 ià(
m
->
æag
 & 
MBULK_F_SMAPPER
) {

2053 
	`¦si_skb_cb_g‘
(
skb
)->
sm­³r_lšked
 = 
Œue
;

2056 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

2057 
	`SLSI_ERR_NODEV
("Dat: Error detected slsi_hip_rx\n");

2058 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

2059 #ifdeà
CONFIG_SCSC_SMAPPER


2060 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

2062 
	`kä“_skb
(
skb
);

2064 
cÚsume_d©_mbulk
:

2066 
idx_r
++;

2067 
idx_r
 &ğ(
MAX_NUM
 - 1);

2070 (
»f
 = 
to_ä“
[
i
++])) {

2072 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

2074 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& 
»Œy
 > 0) {

2075 
	`SLSI_WARN_NODEV
("D©: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

2076 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

2077 
	`m¦“p
(
FB_NO_SPC_SLEEP_MS
);

2078 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

2079 
»Œy
--;

2080 ià(
»Œy
 == 0)

2081 
	`SLSI_ERR_NODEV
("D©: FB ha nÙ b“Àä“d fÜ %d ms\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_SLEEP_MS
);

2082 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

2086 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
);

2089 ià((
idx_r
 =ğ
idx_w
è&& (
·ck‘s_tÙ®
 < 
HIP4_POLLING_MAX_PACKETS
)) {

2090 
u8
 
Şd_idx
 = 
idx_w
;

2092 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
widx
);

2093 ià(
idx_w
 !ğ
Şd_idx
) {

2094 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
, 1);

2095 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
widx
, 
idx_w
, 1);

2099 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h_´iv
->
mšÜ
, 0);

2101 ià(
no_chªge
)

2102 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
);

2104 
sk_d©a_q
:

2105 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

2107 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

2108 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2111 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2112 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock
);

2113 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2114 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock", 
WL_REASON_RX
);

2118 
bh_’d
 = 
	`ktime_g‘
();

2119 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 0);

2120 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

2121 
	}
}

2126 
	$h4_œq_hªdËr
(
œq
, *
d©a
)

2128 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

2129 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2131 ()
œq
;

2133 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

2136 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 0);

2137 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 1);

2138 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 2);

2139 
šŒ_»ûived
 = 
	`ktime_g‘
();

2141 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2142 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2143 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2144 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock", 
WL_REASON_RX
);

2151 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

2152 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

2153 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

2155 
	`SLSI_ERR_NODEV
("INTriggered while WDT is‡ctive\n");

2156 
	`SLSI_ERR_NODEV
("bh_š™ %Îd\n", 
	`ktime_to_ns
(
bh_š™
));

2157 
	`SLSI_ERR_NODEV
("bh_’d %Îd\n", 
	`ktime_to_ns
(
bh_’d
));

2158 
	`SLSI_ERR_NODEV
("h4_wq wÜk_busy %d\n", 
	`wÜk_busy
(&
h
->
h_´iv
->
šŒ_wq
));

2159 
	`SLSI_ERR_NODEV
("h4_´iv->š_rx %d\n", 
	`©omic_»ad
(&
h
->
h_´iv
->
š_rx
));

2162 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
š_su¥’d
)) {

2163 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2164 
h
->
h_´iv
->
¡Üm_couÁ
 = 0;

2165 } ià(++
h
->
h_´iv
->
¡Üm_couÁ
 >ğ
MAX_STORM
) {

2171 
h
->
h_´iv
->
¡Üm_couÁ
 = 0;

2172 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2175 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
œqs
);

2177 ià(
h4_sy¡em_wq
)

2178 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq
);

2180 
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq
);

2183 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2184 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 0);

2185 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 1);

2186 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 2);

2187 
	}
}

2189 
	$h4_sched_wq
(
¦si_h4
 *
h
)

2191 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2193 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

2196 ià(
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
è|| !
h4_rx_æowcÚŒŞ
)

2199 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2200 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2201 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2202 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock", 
WL_REASON_RX
);

2206 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "Trigger wq for skipped data BH\n");

2208 ià(
h4_sy¡em_wq
)

2209 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq
);

2211 
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq
);

2212 
	}
}

2214 #ifdeà
CONFIG_SCSC_QOS


2215 
	$h4_pm_qos_wÜk
(
wÜk_¡ruù
 *
d©a
)

2217 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
d©a
, h4_´iv, 
pm_qos_wÜk
);

2218 
¦si_h4
 *
h
 = 
h_´iv
->hip;

2219 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2220 
u8
 
¡©e
;

2222 ià(!
sdev
 || !sdev->
£rviû
) {

2223 
	`WARN_ON
(1);

2227 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "upd©tØ¡©%d\n", 
h_´iv
->
pm_qos_¡©e
);

2228 
	`¥š_lock_bh
(&
h_´iv
->
pm_qos_lock
);

2229 
¡©e
 = 
h_´iv
->
pm_qos_¡©e
;

2230 
	`¥š_uÆock_bh
(&
h_´iv
->
pm_qos_lock
);

2231 
	`scsc_£rviû_pm_qos_upd©e_»que¡
(
sdev
->
£rviû
, 
¡©e
);

2232 
	}
}

2234 
	$h4_Œaffic_mÚ™Ü_cb
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

2236 
¦si_h4
 *
h
 = (¦si_h4 *)
ş›Á_ùx
;

2237 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2238 
u8
 
¡©e_befÜe
;

2240 ià(!
sdev
)

2243 
	`¥š_lock_bh
(&
h
->
h_´iv
->
pm_qos_lock
);

2244 
¡©e_befÜe
 = 
h
->
h_´iv
->
pm_qos_¡©e
;

2246 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "¡©e:%u -->ƒv’ˆ(¡©e:%u,put_tx:%u bps,put_rx:%u bps)\n", 
¡©e_befÜe
, 
¡©e
, 
ut_tx
, 
ut_rx
);

2248 ià(
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 || s‹ =ğ
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
)

2249 
h
->
h_´iv
->
pm_qos_¡©e
 = 
SCSC_QOS_MAX
;

2250 ià(
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_MID
)

2251 
h
->
h_´iv
->
pm_qos_¡©e
 = 
SCSC_QOS_MED
;

2253 
h
->
h_´iv
->
pm_qos_¡©e
 = 
SCSC_QOS_DISABLED
;

2255 
	`¥š_uÆock_bh
(&
h
->
h_´iv
->
pm_qos_lock
);

2257 ià(
¡©e_befÜe
 !ğ
h
->
h_´iv
->
pm_qos_¡©e
)

2258 
	`scheduË_wÜk
(&
h
->
h_´iv
->
pm_qos_wÜk
);

2259 
	}
}

2262 #ià
IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

2263 
	$h4_Œaffic_mÚ™Ü_logršg_cb
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

2265 
h4_´iv
 *
h_´iv
 = (h4_´iv *)
ş›Á_ùx
;

2266 
¦si_h4
 *
h
 = 
h_´iv
->hip;

2267 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2269 ià(!
sdev
)

2272 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "ev’ˆ(¡©e:%u,put_tx:%u bps,put_rx:%u bps)\n", 
¡©e
, 
ut_tx
, 
ut_rx
);

2273 ià(
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 || s‹ =ğ
TRAFFIC_MON_CLIENT_STATE_MID
 || s‹ =ğ
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
) {

2274 ià(
h4_dyÇmic_loggšg
)

2275 
	`scsc_logršg_’abË
(
çl£
);

2277 
	`scsc_logršg_’abË
(
Œue
);

2279 
	}
}

2282 
	$h4_š™
(
¦si_h4
 *
h
)

2284 *
h_±r
;

2285 
h4_h_cÚŒŞ
 *
h_cÚŒŞ
;

2286 
scsc_£rviû
 *
£rviû
;

2287 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2288 
scsc_miäam_»f
 
»f
, 
»f_scÜebßrd
;

2289 
i
;

2290 
»t
;

2291 
u32
 
tÙ®_mib_Ën
;

2292 
u32
 
mib_fe_off£t
;

2293 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2294 
Ãt_deviû
 *
dev
;

2297 ià(!
sdev
 || !sdev->
£rviû
)

2298  -
EINVAL
;

2300 
h
->
h_´iv
 = 
	`kz®loc
((*h->h_´iv), 
GFP_ATOMIC
);

2301 ià(!
h
->
h_´iv
)

2302  -
ENOMEM
;

2304 
	`SLSI_INFO_NODEV
("HIP4_WLAN_CONFIG_SIZE (%d)\n", 
HIP4_WLAN_CONFIG_SIZE
);

2305 
	`SLSI_INFO_NODEV
("HIP4_WLAN_MIB_SIZE (%d)\n", 
HIP4_WLAN_MIB_SIZE
);

2306 
	`SLSI_INFO_NODEV
("HIP4_WLAN_TX_DAT_SIZE (%d)\n", 
HIP4_WLAN_TX_DAT_SIZE
);

2307 
	`SLSI_INFO_NODEV
("HIP4_WLAN_TX_CTL_SIZE (%d)\n", 
HIP4_WLAN_TX_CTL_SIZE
);

2308 
	`SLSI_INFO_NODEV
("HIP4_WLAN_RX_SIZE (%d)\n", 
HIP4_WLAN_RX_SIZE
);

2309 
	`SLSI_INFO_NODEV
("HIP4_WLAN_TOTAL_MEM (%d)\n", 
HIP4_WLAN_TOTAL_MEM
);

2310 
	`SLSI_INFO_NODEV
("HIP4_DAT_SLOTS (%d)\n", 
HIP4_DAT_SLOTS
);

2311 
	`SLSI_INFO_NODEV
("HIP4_CTL_SLOTS (%d)\n", 
HIP4_CTL_SLOTS
);

2312 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2313 
	`mem£t
(&
h
->
h_´iv
->
¡©s
, 0, (hip->hip_priv->stats));

2314 
h
->
h_´iv
->
¡©s
.
¡¬t
 = 
	`ktime_g‘
();

2315 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
 = 
	`´oc_mkdœ
("driv”/h4", 
NULL
);

2316 ià(
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
) {

2317 
	`´oc_ü—‹_d©a
("šfo", 
S_IRUSR
 | 
S_IRGRP
,

2318 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
, &
h4_´ocfs_¡©s_fİs
, hip);

2319 
	`´oc_ü—‹_d©a
("hi¡Üy", 
S_IRUSR
 | 
S_IRGRP
,

2320 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
, &
h4_´ocfs_hi¡Üy_fİs
, hip);

2321 
	`´oc_ü—‹_d©a
("j™‹r", 
S_IRUSR
 | 
S_IRGRP
,

2322 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
, &
h4_´ocfs_j™‹r_fİs
, hip);

2325 
h
->
h_´iv
->
mšÜ
 = 
	`h4_§m¶”_»gi¡”_h
(
sdev
->
maxw–l_cÜe
);

2326 ià(
h
->
h_´iv
->
mšÜ
 < 
SCSC_HIP4_INTERFACES
) {

2327 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "»gi¡”ed w™h mšÜ %d\n", 
h
->
h_´iv
->
mšÜ
);

2328 
sdev
->
mšÜ_´of
 = 
h
->
h_´iv
->
mšÜ
;

2330 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "hip4_sampler is‚otƒnabled\n");

2335 
h
->
h_´iv
->hip = hip;

2337 
£rviû
 = 
sdev
->service;

2339 
h
->
h_´iv
->
ho¡_poŞ_id_d©
 = 
MBULK_POOL_ID_DATA
;

2340 
h
->
h_´iv
->
ho¡_poŞ_id_ùl
 = 
MBULK_POOL_ID_CTRL
;

2344 
h_±r
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
h
->
h_»f
);

2346 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2348 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_DATA
, 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
,

2349 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
 + 
HIP4_WLAN_TX_DAT_SIZE
,

2350 (
HIP4_WLAN_TX_DAT_SIZE
 / 
HIP4_DAT_SLOTS
è- (
mbulk
), 5,

2351 
h
->
h_´iv
->
mšÜ
);

2352 ià(
»t
)

2353  
»t
;

2356 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_CTRL
, 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
,

2357 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
 + 
HIP4_WLAN_TX_CTL_SIZE
,

2358 (
HIP4_WLAN_TX_CTL_SIZE
 / 
HIP4_CTL_SLOTS
è- (
mbulk
), 0,

2359 
h
->
h_´iv
->
mšÜ
);

2360 ià(
»t
)

2361  
»t
;

2364 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_DATA
, 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
,

2365 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
 + 
HIP4_WLAN_TX_DAT_SIZE
,

2366 (
HIP4_WLAN_TX_DAT_SIZE
 / 
HIP4_DAT_SLOTS
è- (
mbulk
), 5);

2367 ià(
»t
)

2368  
»t
;

2371 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_CTRL
, 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
,

2372 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
 + 
HIP4_WLAN_TX_CTL_SIZE
,

2373 (
HIP4_WLAN_TX_CTL_SIZE
 / 
HIP4_CTL_SLOTS
è- (
mbulk
), 0);

2374 ià(
»t
)

2375  
»t
;

2379 
	`mem£t
(
h_±r
, 0, (
h4_h_cÚŒŞ
));

2382 
	`SCSC_HIP4_SAMPLER_RESET
(
h
->
h_´iv
->
mšÜ
);

2386 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2388 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_CTRL
] = 
MIF_NO_IRQ
;

2390 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_DAT
] = 
MIF_NO_IRQ
;

2392 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_RFB
] = 
MIF_NO_IRQ
;

2394 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
] =

2395 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr_fb
, 
h
, 
SCSC_MIFINTR_TARGET_WLAN
);

2396 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

2398 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
] =

2399 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr_ù¾
, 
h
, 
SCSC_MIFINTR_TARGET_WLAN
);

2400 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

2402 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
] =

2403 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr_d©
, 
h
, 
SCSC_MIFINTR_TARGET_WLAN
);

2404 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

2406 
	`rcu_»ad_lock
();

2408 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2409 ià(!
dev
) {

2410 
	`SLSI_ERR
(
sdev
, "netdev No†ongerƒxists\n");

2411 
	`rcu_»ad_uÆock
();

2412  -
EINVAL
;

2414 
	`Ãtif_Çpi_add
(
dev
, &
h
->
h_´iv
->
Çpi
, 
h4_Çpi_pŞl
, 
NAPI_POLL_WEIGHT
);

2415 
	`rcu_»ad_uÆock
();

2418 
h
->
h_´iv
->
šŒ_toho¡
 =

2419 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr
, 
h
, 
SCSC_MIFINTR_TARGET_WLAN
);

2422 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2426 
h
->
h_´iv
->
šŒ_äomho¡
 =

2427 
	`scsc_£rviû_mifšŒb™_®loc_äomho¡
(
£rviû
, 
SCSC_MIFINTR_TARGET_WLAN
);

2430 
h_cÚŒŞ
 = (
h4_h_cÚŒŞ
 *)(
h_±r
 +

2431 
HIP4_WLAN_CONFIG_OFFSET
);

2434 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
scÜebßrd
, &
»f_scÜebßrd
))

2435  -
EFAULT
;

2438 
i
 = 0, 
tÙ®_mib_Ën
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

2439 
tÙ®_mib_Ën
 +ğ
sdev
->
mib
[
i
].
mib_Ën
;

2443 
	`mem£t
(
h_±r
 + 
HIP4_WLAN_MIB_OFFSET
, 0, 
HIP4_WLAN_MIB_SIZE
);

2445 ià(
tÙ®_mib_Ën
 > 
HIP4_WLAN_MIB_SIZE
) {

2446 
	`SLSI_ERR_NODEV
("MIB siz(%d), i bigg”hªhMIB AREA (%d). AbÜtšg memıy\n", 
tÙ®_mib_Ën
, 
HIP4_WLAN_MIB_SIZE
);

2447 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
 = 0;

2448 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
 = 0;

2449 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
 = 0;

2450 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
 = 0;

2451 
tÙ®_mib_Ën
 = 0;

2452 } ià(
tÙ®_mib_Ën
) {

2453 
	`SLSI_INFO_NODEV
("Lßdšg MIB iÁØsh¬ed memÜy, siz(%d)\n", 
tÙ®_mib_Ën
);

2455 
i
 = 0, 
mib_fe_off£t
 = 0;

2456 
i
 < 
SLSI_WLAN_MAX_MIB_FILE
 && 
sdev
->
mib
[i].
mib_fe_Çme
;

2457 
i
++) {

2458 
	`SLSI_INFO_NODEV
("Lßdšg MIB %d iÁØsh¬ed memÜy, off£ˆ(%d), siz(%d),Ù® (%d)\n", 
i
, 
mib_fe_off£t
, 
sdev
->
mib
[i].
mib_Ën
, 
tÙ®_mib_Ën
);

2459 ià(
sdev
->
mib
[
i
].
mib_Ën
) {

2460 
	`memıy
((
u8
 *)
h_±r
 + 
HIP4_WLAN_MIB_OFFSET
 + 
mib_fe_off£t
, 
sdev
->
mib
[
i
].
mib_d©a
, sdev->mib[i].
mib_Ën
);

2461 
mib_fe_off£t
 +ğ
sdev
->
mib
[
i
].
mib_Ën
;

2464 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_MIB_OFFSET
;

2465 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
 = 
tÙ®_mib_Ën
;

2466 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_MIB_OFFSET
;

2467 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
 = 
tÙ®_mib_Ën
;

2469 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
 = 0;

2470 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
 = 0;

2471 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
 = 0;

2472 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
 = 0;

2477 
h_cÚŒŞ
->
cÚfig_v4
.
magic_numb”
 = 0xcaba0401;

2478 
h_cÚŒŞ
->
cÚfig_v4
.
h_cÚfig_v”
 = 4;

2479 
h_cÚŒŞ
->
cÚfig_v4
.
cÚfig_Ën
 = (
h4_h_cÚfig_v”siÚ_4
);

2480 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_ÿche_lše
 = 64;

2481 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_TX_OFFSET
;

2482 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_sz
 = 
HIP4_WLAN_TX_SIZE
;

2483 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_RX_OFFSET
;

2484 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_sz
 = 
HIP4_WLAN_RX_SIZE
;

2485 
h_cÚŒŞ
->
cÚfig_v4
.
log_cÚfig_loc
 = 0;

2487 
h_cÚŒŞ
->
cÚfig_v4
.
mif_fh_št_n
 = 
h
->
h_´iv
->
šŒ_äomho¡
;

2488 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

2489 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2490 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
i
] = 
h
->
h_´iv
->
šŒ_toho¡_mul
[i];

2492 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
i
] = 
h
->
h_´iv
->
šŒ_toho¡
;

2496 
h_cÚŒŞ
->
cÚfig_v4
.
scbrd_loc
 = (
u32
)
»f_scÜebßrd
;

2497 
h_cÚŒŞ
->
cÚfig_v4
.
q_num
 = 6;

2498 
h_cÚŒŞ
->
cÚfig_v4
.
q_Ën
 = 256;

2499 
h_cÚŒŞ
->
cÚfig_v4
.
q_idx_sz
 = 1;

2501 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

2502 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
q
[
i
].
¬¿y
, &
»f
))

2503  -
EFAULT
;

2504 
h_cÚŒŞ
->
cÚfig_v4
.
q_loc
[
i
] = (
u32
)
»f
;

2510 
h_cÚŒŞ
->
cÚfig_v5
.
magic_numb”
 = 0xcaba0401;

2511 
h_cÚŒŞ
->
cÚfig_v5
.
h_cÚfig_v”
 = 5;

2512 
h_cÚŒŞ
->
cÚfig_v5
.
cÚfig_Ën
 = (
h4_h_cÚfig_v”siÚ_5
);

2513 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_ÿche_lše
 = 64;

2514 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_TX_OFFSET
;

2515 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_sz
 = 
HIP4_WLAN_TX_SIZE
;

2516 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_RX_OFFSET
;

2517 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_sz
 = 
HIP4_WLAN_RX_SIZE
;

2518 
h_cÚŒŞ
->
cÚfig_v5
.
log_cÚfig_loc
 = 0;

2519 
h_cÚŒŞ
->
cÚfig_v5
.
mif_fh_št_n
 = 
h
->
h_´iv
->
šŒ_äomho¡
;

2520 
h_cÚŒŞ
->
cÚfig_v5
.
mif_th_št_n
 = 
h
->
h_´iv
->
šŒ_toho¡
;

2521 
h_cÚŒŞ
->
cÚfig_v5
.
q_num
 = 6;

2522 
h_cÚŒŞ
->
cÚfig_v5
.
q_Ën
 = 256;

2523 
h_cÚŒŞ
->
cÚfig_v5
.
q_idx_sz
 = 1;

2524 
h_cÚŒŞ
->
cÚfig_v5
.
scbrd_loc
 = (
u32
)
»f_scÜebßrd
;

2527 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

2528 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
q
[
i
].
¬¿y
, &
»f
))

2529  -
EFAULT
;

2530 
h_cÚŒŞ
->
cÚfig_v5
.
q_loc
[
i
] = (
u32
)
»f
;

2535 
h_cÚŒŞ
->
š™
.
magic_numb”
 = 0xcaaa0400;

2536 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
cÚfig_v4
, &
»f
))

2537  -
EFAULT
;

2538 
h_cÚŒŞ
->
š™
.
v”siÚ_a_»f
 = 
»f
;

2540 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
cÚfig_v5
, &
»f
))

2541  -
EFAULT
;

2542 
h_cÚŒŞ
->
š™
.
v”siÚ_b_»f
 = 
»f
;

2545 
h
->
h_cÚŒŞ
 = hip_control;

2546 
h
->
h_´iv
->
scbrd_ba£
 = &
h_cÚŒŞ
->
scÜebßrd
;

2548 
	`¥š_lock_š™
(&
h
->
h_´iv
->
rx_lock
);

2549 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 0);

2550 
	`¥š_lock_š™
(&
h
->
h_´iv
->
tx_lock
);

2551 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 0);

2553 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2554 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

2555 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock_tx
.
ws
, "hip4_wake_lock_tx");

2556 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock_ù¾
.
ws
, "hip4_wake_lock_ctrl");

2557 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock_d©a
.
ws
, "hip4_wake_lock_data");

2559 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock_tx
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock_tx");

2560 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock_ctrl");

2561 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock_d©a
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock_data");

2564 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

2565 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock
.
ws
, "hip4_wake_lock");

2567 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock");

2571 
h
->
h_´iv
->
h4_wÜkq
 = 
	`ü—‹_sšgËth»ad_wÜkqueue
("hip4_work");

2572 ià(!
h
->
h_´iv
->
h4_wÜkq
) {

2573 
	`SLSI_ERR_NODEV
("Error creating singlethread_workqueue\n");

2574  -
ENOMEM
;

2576 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2577 
	`¥š_lock_š™
(&
h
->
h_´iv
->
Çpi_ıu_lock
);

2578 
	`INIT_WORK
(&
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
, 
h4_œq_d©a_Çpi_sw™ch_wÜk
);

2579 
	`INIT_WORK
(&
h
->
h_´iv
->
šŒ_wq_ù¾
, 
h4_wq_ù¾
);

2580 
	`skËt_š™
(&
h
->
h_´iv
->
šŒ__fb
, 
h4__fb
, ()hip);

2582 
	`INIT_WORK
(&
h
->
h_´iv
->
šŒ_wq
, 
h4_wq
);

2584 
	`rwlock_š™
(&
h
->
h_´iv
->
rw_scÜebßrd
);

2587 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

2588 
	`¥š_lock_š™
(&
h
->
h_´iv
->
w©chdog_lock
);

2589 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2590 
	`tim”_£tup
(&
h
->
h_´iv
->
w©chdog
, 
h4_w©chdog
, 0);

2592 
	`£tup_tim”
(&
h
->
h_´iv
->
w©chdog
, 
h4_w©chdog
, ()hip);

2595 
	`©omic_£t
(&
h
->
h_´iv
->
gmod
, 
HIP4_DAT_SLOTS
);

2596 
	`©omic_£t
(&
h
->
h_´iv
->
gaùive
, 1);

2597 
	`¥š_lock_š™
(&
h
->
h_´iv
->
gbÙ_lock
);

2598 
h
->
h_´iv
->
§tu¿‹d
 = 0;

2600 #ifdeà
CONFIG_SCSC_SMAPPER


2602 ià(
h4_sm­³r_’abË
) {

2603 ià(
	`h4_sm­³r_š™
(
sdev
, 
h
)) {

2604 
	`SLSI_ERR_NODEV
("Error on hip4_smapper init\n");

2605 
h4_sm­³r_is_’abËd
 = 
çl£
;

2607 
h4_sm­³r_is_’abËd
 = 
Œue
;

2611 #ifdeà
CONFIG_SCSC_QOS


2613 
	`¥š_lock_š™
(&
h
->
h_´iv
->
pm_qos_lock
);

2615 ià(
h4_qos_’abË
) {

2616 ià(!
	`scsc_£rviû_pm_qos_add_»que¡
(
£rviû
, 
SCSC_QOS_DISABLED
)) {

2618 ià(
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, 
h
, 
TRAFFIC_MON_CLIENT_MODE_EVENTS
, (
h4_qos_med_ut_š_mbps
 * 1000 * 1000), (
h4_qos_max_ut_š_mbps
 * 1000 * 1000), 
h4_Œaffic_mÚ™Ü_cb
))

2619 
	`SLSI_WARN
(
sdev
, "failedo‡dd PM QoS clientoraffic monitor\n");

2621 
	`INIT_WORK
(&
h
->
h_´iv
->
pm_qos_wÜk
, 
h4_pm_qos_wÜk
);

2623 
	`SLSI_WARN
(
sdev
, "failedo‡dd PM QoS„equest\n");

2627 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

2629 ià(
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, 
h
->
h_´iv
, 
TRAFFIC_MON_CLIENT_MODE_EVENTS
, 0, (
h4_dyÇmic_loggšg_ut_š_mbps
 * 1000 * 1000), 
h4_Œaffic_mÚ™Ü_logršg_cb
))

2630 
	`SLSI_WARN
(
sdev
, "failedo‡dd Logring clientoraffic monitor\n");

2633 
	}
}

2639 
	$h4_ä“_ù¾_¦Ùs_couÁ
(
¦si_h4
 *
h
)

2641  
	`mbulk_poŞ_g‘_ä“_couÁ
(
MBULK_POOL_ID_CTRL
);

2642 
	}
}

2644 
boŞ
 
	$¦si_h_v®id©esize
(
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
u8
 
h—d__room
)

2646 
size_t
 
·ylßd
, 
tÙ®_size
;

2648 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb
);

2650 
·ylßd
 = 
skb
->
Ën
 - 
cb
->
sig_Ëngth
;

2653 ià(
·ylßd
)

2654 
tÙ®_size
 = 
cb
->
sig_Ëngth
 + 
h—d__room
;

2657 
tÙ®_size
 = 
cb
->
sig_Ëngth
;

2658 ià(
	`mbulk_poŞ_£g_size
(
ù¾_·ck‘
 ? 
MBULK_POOL_ID_CTRL
 : 
MBULK_POOL_ID_DATA
è< 
tÙ®_size
)

2659  
çl£
;

2660  
Œue
;

2661 
	}
}

2673 
	$scsc_wifi_Œªsm™_äame
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
u8
 
vif_šdex
, u8 
³”_šdex
, u8 
´iÜ™y
)

2675 
scsc_£rviû
 *
£rviû
;

2676 
scsc_miäam_»f
 
off£t
;

2677 
mbulk
 *
m
;

2678 
mbulk_cŞour
 
cŞour
 = 0;

2679 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2680 
çpi_sigÇl_h—d”
 *
çpi_h—d”
;

2681 
»t
 = 0;

2683 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !
skb
 || !h->
h_´iv
)

2684  -
EINVAL
;

2686 
	`¥š_lock_bh
(&
h
->
h_´iv
->
tx_lock
);

2687 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 1);

2689 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2690 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

2691 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_tx
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2692 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2693 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_tx", 
WL_REASON_TX
);

2697 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2698 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2699 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2700 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock", 
WL_REASON_TX
);

2705 
£rviû
 = 
sdev
->service;

2706 
çpi_h—d”
 = (
çpi_sigÇl_h—d”
 *)
skb
->
d©a
;

2708 ià(
	`çpi_is_ma
(
skb
))

2709 
	`SLSI_MBULK_COLOUR_SET
(
cŞour
, 
vif_šdex
, 
³”_šdex
, 
´iÜ™y
);

2710 
m
 = 
	`h4_skb_to_mbulk
(
h
->
h_´iv
, 
skb
, 
ù¾_·ck‘
, 
cŞour
);

2711 ià(!
m
) {

2712 
	`SCSC_HIP4_SAMPLER_MFULL
(
h
->
h_´iv
->
mšÜ
);

2713 ià(!
	`¦si_h_v®id©esize
(
skb
, 
ù¾_·ck‘
,

2714 
h
->
h_´iv
->
unid©_»q_h—droom
 + h->h_´iv->
unid©_»q_room
)) {

2715 
»t
 = -
ENOSPC
;

2716 
	`SLSI_ERR_NODEV
("mbulk is NULL\n");

2718 
»t
 = -
EINVAL
;

2719 
	`SLSI_ERR_NODEV
("High…ayload†ength\n");

2721 
”rÜ
;

2724 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, 
m
, &
off£t
) < 0) {

2725 
	`mbulk_ä“_vœt_ho¡
(
m
);

2726 
»t
 = -
EFAULT
;

2727 
	`SLSI_ERR_NODEV
("Incorrect„eference memory\n");

2728 
”rÜ
;

2731 ià(
	`h4_q_add_sigÇl
(
h
, 
ù¾_·ck‘
 ? 
HIP4_MIF_Q_FH_CTRL
 : 
HIP4_MIF_Q_FH_DAT
, 
off£t
, 
£rviû
)) {

2732 
	`SCSC_HIP4_SAMPLER_QFULL
(
h
->
h_´iv
->
mšÜ
, 
ù¾_·ck‘
 ? 
HIP4_MIF_Q_FH_CTRL
 : 
HIP4_MIF_Q_FH_DAT
);

2733 
	`mbulk_ä“_vœt_ho¡
(
m
);

2734 
»t
 = -
ENOSPC
;

2735 
	`SLSI_ERR_NODEV
("No space\n");

2736 
”rÜ
;

2739 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2740 ià(
ù¾_·ck‘
) {

2742 
	`SCSC_HIP4_SAMPLER_SIGNAL_CTRLTX
(
h
->
h_´iv
->
mšÜ
, (
çpi_h—d”
->
id
 & 0xff00) >> 8, fapi_header->id & 0xff);

2745 
	`SCSC_HIP4_SAMPLER_PKT_TX_HIP4
(
h
->
h_´iv
->
mšÜ
, 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
ho¡_g
));

2747 
	`SCSC_HIP4_SAMPLER_VIF_PEER
(
h
->
h_´iv
->
mšÜ
, 1, 
vif_šdex
, 
³”_šdex
);

2750 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2751 
	`h4_hi¡Üy_»cÜd_add
(
FH
, 
çpi_h—d”
->
id
);

2761 ià(
ù¾_·ck‘
)

2762 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_CTRL_TX
, 
skb
->
d©a
, 
	`skb_h—dËn
(skb));

2764 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_DATA_TX
, 
skb
->
d©a
, 
	`skb_h—dËn
(skb));

2766 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_FROM_HOST
);

2767 
	`cÚsume_skb
(
skb
);

2768 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 0);

2769 
	`¥š_uÆock_bh
(&
h
->
h_´iv
->
tx_lock
);

2772 
”rÜ
:

2773 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2774 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

2775 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_tx
);

2776 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2777 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_tx", 
WL_REASON_TX
);

2781 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2782 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock
);

2783 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2784 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock", 
WL_REASON_TX
);

2788 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 0);

2789 
	`¥š_uÆock_bh
(&
h
->
h_´iv
->
tx_lock
);

2790  
»t
;

2791 
	}
}

2796 
	$h4_£tup
(
¦si_h4
 *
h
)

2798 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2799 
scsc_£rviû
 *
£rviû
;

2800 
u32
 
cÚf_h4_v”
 = 0;

2802 ià(!
sdev
 || !sdev->
£rviû
)

2803  -
EIO
;

2805 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2806  -
EIO
;

2808 
£rviû
 = 
sdev
->service;

2811 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
h
->
h_cÚŒŞ
->
š™
);

2814 ià(
cÚf_h4_v”
 != 4 && conf_hip4_ver != 5) {

2815 
	`SLSI_ERR_NODEV
("FW HIP cÚfig v”siÚ %d‚Ù suµÜ‹d\n", 
cÚf_h4_v”
);

2816  -
EIO
;

2819 ià(
cÚf_h4_v”
 == 4) {

2820 
h
->
h_´iv
->
unid©_»q_h—droom
 =

2821 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_h—droom
, 4);

2822 
h
->
h_´iv
->
unid©_»q_room
 =

2823 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_room
, 4);

2824 
h
->
h_´iv
->
v”siÚ
 = 4;

2826 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2827 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

2828 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

2829 ià(!
	`‹¡_ªd_£t_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
))

2830 
	`Çpi_’abË
(&
h
->
h_´iv
->
Çpi
);

2834 
h
->
h_´iv
->
unid©_»q_h—droom
 =

2835 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_h—droom
, 5);

2836 
h
->
h_´iv
->
unid©_»q_room
 =

2837 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_room
, 5);

2838 
h
->
h_´iv
->
v”siÚ
 = 5;

2841 
	`©omic_£t
(&
h
->
h_´iv
->
¡©s
.
œqs
, 0);

2842 
	`©omic_£t
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
, 0);

2843 
	`©omic_£t
(&
sdev
->
debug_šds
, 0);

2845 
	`©omic_£t
(&
h
->
h_´iv
->
şosšg
, 0);

2847 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2848 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

2849 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

2850 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

2852 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2855 
	}
}

2858 
	$h4_su¥’d
(
¦si_h4
 *
h
)

2860 
¦si_dev
 *
sdev
;

2861 
scsc_£rviû
 *
£rviû
;

2862 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2863 
u8
 
i
;

2866 ià(!
h
 || !h->
h_´iv
)

2869 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2870 ià(!
sdev
 || !sdev->
£rviû
)

2873 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2876 
£rviû
 = 
sdev
->service;

2878 
	`¦si_log_ş›Á_msg
(
sdev
, 
UDI_DRV_SUSPEND_IND
, 0, 
NULL
);

2879 
	`SCSC_HIP4_SAMPLER_SUSPEND
(
h
->
h_´iv
->
mšÜ
);

2881 
	`©omic_£t
(&
h
->
h_´iv
->
š_su¥’d
, 1);

2883 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2884 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2885 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2886 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2888 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2890 
	}
}

2892 
	$h4_»sume
(
¦si_h4
 *
h
)

2894 
¦si_dev
 *
sdev
;

2895 
scsc_£rviû
 *
£rviû
;

2896 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2897 
u8
 
i
;

2900 ià(!
h
 || !h->
h_´iv
)

2903 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2904 ià(!
sdev
 || !sdev->
£rviû
)

2907 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2910 
£rviû
 = 
sdev
->service;

2912 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2913 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2914 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2915 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2917 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2919 
	`¦si_log_ş›Á_msg
(
sdev
, 
UDI_DRV_RESUME_IND
, 0, 
NULL
);

2920 
	`SCSC_HIP4_SAMPLER_RESUME
(
h
->
h_´iv
->
mšÜ
);

2921 
	`©omic_£t
(&
h
->
h_´iv
->
š_su¥’d
, 0);

2922 
	}
}

2924 
	$h4_ä“ze
(
¦si_h4
 *
h
)

2926 
¦si_dev
 *
sdev
;

2927 
scsc_£rviû
 *
£rviû
;

2928 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2929 
u8
 
i
;

2932 ià(!
h
 || !h->
h_´iv
)

2935 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2936 ià(!
sdev
 || !sdev->
£rviû
)

2939 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2942 
£rviû
 = 
sdev
->service;

2944 
şosšg
 = 
	`ktime_g‘
();

2945 
	`©omic_£t
(&
h
->
h_´iv
->
şosšg
, 1);

2947 
	`h4_dump_dbg
(
h
, 
NULL
, NULL, 
£rviû
);

2948 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2949 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2950 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2951 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2953 ià(
	`‹¡_ªd_ş—r_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
))

2954 
	`Çpi_di§bË
(&
h
->
h_´iv
->
Çpi
);

2955 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

2956 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

2957 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

2958 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

2959 
	`skËt_kl
(&
h
->
h_´iv
->
šŒ__fb
);

2961 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2962 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq
);

2964 #ifdeà
CONFIG_SCSC_QOS


2965 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
pm_qos_wÜk
);

2967 
	`æush_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

2968 
	`de¡roy_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

2969 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

2972 
	`d–_tim”_sync
(&
h
->
h_´iv
->
w©chdog
);

2973 
	}
}

2975 
	$h4_deš™
(
¦si_h4
 *
h
)

2977 
¦si_dev
 *
sdev
;

2978 
scsc_£rviû
 *
£rviû
;

2979 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2980 
u8
 
i
;

2983 ià(!
h
 || !h->
h_´iv
)

2986 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2987 ià(!
sdev
 || !sdev->
£rviû
)

2990 
£rviû
 = 
sdev
->service;

2992 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

2993 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
h
->
h_´iv
);

2995 
	`scsc_logršg_’abË
(
Œue
);

2997 #ifdeà
CONFIG_SCSC_QOS


2999 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
h
);

3000 
	`scsc_£rviû_pm_qos_»move_»que¡
(
£rviû
);

3003 #ifdeà
CONFIG_SCSC_SMAPPER


3005 ià(
h4_sm­³r_is_’abËd
) {

3006 
h4_sm­³r_is_’abËd
 = 
çl£
;

3007 
	`h4_sm­³r_deš™
(
sdev
, 
h
);

3011 
şosšg
 = 
	`ktime_g‘
();

3012 
	`©omic_£t
(&
h
->
h_´iv
->
şosšg
, 1);

3014 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


3015 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

3016 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

3017 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

3019 ià(
	`‹¡_ªd_ş—r_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
))

3020 
	`Çpi_di§bË
(&
h
->
h_´iv
->
Çpi
);

3021 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

3022 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

3023 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

3024 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

3025 
	`skËt_kl
(&
h
->
h_´iv
->
šŒ__fb
);

3027 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

3028 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

3029 
	`scsc_£rviû_mifšŒb™_uÄegi¡”_toho¡
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
], 
SCSC_MIFINTR_TARGET_WLAN
);

3031 
	`Ãtif_Çpi_d–
(&
h
->
h_´iv
->
Çpi
);

3033 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

3034 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq
);

3035 
	`scsc_£rviû_mifšŒb™_uÄegi¡”_toho¡
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
, 
SCSC_MIFINTR_TARGET_WLAN
);

3037 #ifdeà
CONFIG_SCSC_QOS


3038 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
pm_qos_wÜk
);

3040 
	`æush_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

3041 
	`de¡roy_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

3043 
	`scsc_£rviû_mifšŒb™_ä“_äomho¡
(
£rviû
, 
h
->
h_´iv
->
šŒ_äomho¡
, 
SCSC_MIFINTR_TARGET_WLAN
);

3045 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


3046 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock_tx
);

3047 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
);

3048 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

3050 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock
);

3053 
	`WARN_ON
(
	`©omic_»ad
(&
h
->
h_´iv
->
š_tx
));

3054 
	`WARN_ON
(
	`©omic_»ad
(&
h
->
h_´iv
->
š_rx
));

3056 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

3058 
	`d–_tim”_sync
(&
h
->
h_´iv
->
w©chdog
);

3060 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3061 ià(
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
) {

3062 
	`»move_´oc_’Œy
("driv”/h4/j™‹r", 
NULL
);

3063 
	`»move_´oc_’Œy
("driv”/h4/šfo", 
NULL
);

3064 
	`»move_´oc_’Œy
("driv”/h4/hi¡Üy", 
NULL
);

3065 
	`»move_´oc_’Œy
("driv”/h4", 
NULL
);

3069 
	`¥š_lock_bh
(&
š_Çpi_cÚ‹xt
);

3070 
	`kä“
(
h
->
h_´iv
);

3072 
h
->
h_´iv
 = 
NULL
;

3073 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

3076 
	`mbulk_poŞ_»move
(
MBULK_POOL_ID_DATA
);

3077 
	`mbulk_poŞ_»move
(
MBULK_POOL_ID_CTRL
);

3078 
	}
}

	@hip4.h

7 #iâdeà
__HIP4_H__


8 
	#__HIP4_H__


	)

18 
	~<lšux/š‹¼u±.h
>

19 
	~<lšux/ty³s.h
>

20 
	~<lšux/deviû.h
>

21 
	~<lšux/skbuff.h
>

22 
	~<scsc/scsc_miäam.h
>

23 
	~<scsc/scsc_mx.h
>

24 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


25 
	~<lšux/Ãtdeviû.h
>

27 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


28 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

29 
	~<scsc/scsc_wak–ock.h
>

31 
	~<lšux/wak–ock.h
>

34 
	~"mbulk.h
"

35 #ifdeà
CONFIG_SCSC_SMAPPER


36 
	~"h4_sm­³r.h
"

56 
	#HIP4_WLAN_CONFIG_OFFSET
 0x00000

	)

57 
	#HIP4_WLAN_CONFIG_SIZE
 0x02000

	)

59 
	#HIP4_WLAN_MIB_OFFSET
 (
HIP4_WLAN_CONFIG_OFFSET
 + 
HIP4_WLAN_CONFIG_SIZE
)

	)

60 
	#HIP4_WLAN_MIB_SIZE
 0x08000

	)

62 
	#HIP4_WLAN_TX_OFFSET
 (
HIP4_WLAN_MIB_OFFSET
 + 
HIP4_WLAN_MIB_SIZE
)

	)

64 
	#HIP4_WLAN_TX_DAT_OFFSET
 
HIP4_WLAN_TX_OFFSET


	)

65 
	#HIP4_WLAN_TX_DAT_SIZE
 0x100000

	)

67 
	#HIP4_WLAN_TX_CTL_OFFSET
 (
HIP4_WLAN_TX_DAT_OFFSET
 + 
HIP4_WLAN_TX_DAT_SIZE
)

	)

68 
	#HIP4_WLAN_TX_CTL_SIZE
 0x10000

	)

69 
	#HIP4_WLAN_TX_SIZE
 (
HIP4_WLAN_TX_DAT_SIZE
 + 
HIP4_WLAN_TX_CTL_SIZE
)

	)

71 
	#HIP4_WLAN_RX_OFFSET
 (
HIP4_WLAN_TX_CTL_OFFSET
 + 
HIP4_WLAN_TX_CTL_SIZE
)

	)

72 #ifdeà
CONFIG_SCSC_PCIE


73 
	#HIP4_WLAN_RX_SIZE
 0x80000

	)

75 
	#HIP4_WLAN_RX_SIZE
 0x100000

	)

78 
	#HIP4_WLAN_TOTAL_MEM
 (
HIP4_WLAN_CONFIG_SIZE
 + 
HIP4_WLAN_MIB_SIZE
 + \

79 
HIP4_WLAN_TX_SIZE
 + 
HIP4_WLAN_RX_SIZE
è

	)

81 
	#HIP4_POLLING_MAX_PACKETS
 512

	)

83 
	#HIP4_DAT_MBULK_SIZE
 (2 * 1024)

	)

84 
	#HIP4_DAT_SLOTS
 (
HIP4_WLAN_TX_DAT_SIZE
 / 
HIP4_DAT_MBULK_SIZE
)

	)

85 
	#HIP4_CTL_MBULK_SIZE
 (2 * 1024)

	)

86 
	#HIP4_CTL_SLOTS
 (
HIP4_WLAN_TX_CTL_SIZE
 / 
HIP4_CTL_MBULK_SIZE
)

	)

88 
	#MIF_HIP_CFG_Q_NUM
 6

	)

90 
	#MIF_NO_IRQ
 0xff

	)

93 
	#HIP4_SUPPORTED_V1
 3

	)

94 
	#HIP4_SUPPORTED_V2
 4

	)

96 
	eh4_h_q_cÚf
 {

97 
	mHIP4_MIF_Q_FH_CTRL
,

98 
	mHIP4_MIF_Q_FH_DAT
,

99 
	mHIP4_MIF_Q_FH_RFB
,

100 
	mHIP4_MIF_Q_TH_CTRL
,

101 
	mHIP4_MIF_Q_TH_DAT
,

102 
	mHIP4_MIF_Q_TH_RFB


105 
	sh4_h_cÚfig_v”siÚ_4
 {

107 
u32
 
	mmagic_numb”
;

108 
u16
 
	mh_cÚfig_v”
;

109 
u16
 
	mcÚfig_Ën
;

112 
u32
 
	mcom·t_æag
;

114 
u16
 
	m§p_mlme_v”
;

115 
u16
 
	m§p_ma_v”
;

116 
u16
 
	m§p_debug_v”
;

117 
u16
 
	m§p_‹¡_v”
;

119 
u32
 
	mfw_bud_id
;

120 
u32
 
	mfw_·tch_id
;

122 
u8
 
	munid©_»q_h—droom
;

123 
u8
 
	munid©_»q_room
;

124 
u8
 
	mbulk_bufãr_®ign
;

127 
u8
 
	mho¡_ÿche_lše
;

129 
u32
 
	mho¡_buf_loc
;

130 
u32
 
	mho¡_buf_sz
;

131 
u32
 
	mfw_buf_loc
;

132 
u32
 
	mfw_buf_sz
;

133 
u32
 
	mmib_loc
;

134 
u32
 
	mmib_sz
;

135 
u32
 
	mlog_cÚfig_loc
;

136 
u32
 
	mlog_cÚfig_sz
;

138 
u8
 
	mmif_fh_št_n
;

139 
u8
 
	m»£rved1
[3];

141 
u8
 
	mmif_th_št_n
[6];

142 
u8
 
	m»£rved2
[2];

144 
u32
 
	mscbrd_loc
;

146 
u16
 
	mq_num
;

147 
u16
 
	mq_Ën
;

148 
u16
 
	mq_idx_sz
;

149 
u8
 
	m»£rved3
[2];

151 
u32
 
	mq_loc
[
MIF_HIP_CFG_Q_NUM
];

153 #ifdeà
CONFIG_SCSC_SMAPPER


154 
u8
 
	msm­³r_th_»q
;

155 
u8
 
	msm­³r_fh_šd
;

156 
u8
 
	msm­³r_mbox_scb
;

157 
u8
 
	msm­³r_’Œ›s_bªks
[16];

158 
u8
 
	msm­³r_pow_sz
[16];

159 
u32
 
	msm­³r_bªk_addr
[16];

161 
u8
 
	m»£rved_nosm­³r
[99];

163 
u8
 
	m»£rved4
[16];

164 } 
	g__·cked
;

166 
	sh4_h_cÚfig_v”siÚ_5
 {

168 
u32
 
	mmagic_numb”
;

169 
u16
 
	mh_cÚfig_v”
;

170 
u16
 
	mcÚfig_Ën
;

173 
u32
 
	mcom·t_æag
;

175 
u16
 
	m§p_mlme_v”
;

176 
u16
 
	m§p_ma_v”
;

177 
u16
 
	m§p_debug_v”
;

178 
u16
 
	m§p_‹¡_v”
;

180 
u32
 
	mfw_bud_id
;

181 
u32
 
	mfw_·tch_id
;

183 
u8
 
	munid©_»q_h—droom
;

184 
u8
 
	munid©_»q_room
;

185 
u8
 
	mbulk_bufãr_®ign
;

188 
u8
 
	mho¡_ÿche_lše
;

190 
u32
 
	mho¡_buf_loc
;

191 
u32
 
	mho¡_buf_sz
;

192 
u32
 
	mfw_buf_loc
;

193 
u32
 
	mfw_buf_sz
;

194 
u32
 
	mmib_loc
;

195 
u32
 
	mmib_sz
;

196 
u32
 
	mlog_cÚfig_loc
;

197 
u32
 
	mlog_cÚfig_sz
;

199 
u8
 
	mmif_fh_št_n
;

200 
u8
 
	mmif_th_št_n
;

201 
u8
 
	m»£rved
[2];

203 
u32
 
	mscbrd_loc
;

205 
u16
 
	mq_num
;

206 
u16
 
	mq_Ën
;

207 
u16
 
	mq_idx_sz
;

208 
u8
 
	m»£rved2
[2];

210 
u32
 
	mq_loc
[
MIF_HIP_CFG_Q_NUM
];

212 
u8
 
	m»£rved3
[16];

213 } 
	g__·cked
;

215 
	sh4_h_š™
 {

217 
u32
 
	mmagic_numb”
;

219 
u32
 
	mcÚf_h4_v”
;

221 
u32
 
	mv”siÚ_a_»f
;

222 
u32
 
	mv”siÚ_b_»f
;

223 } 
	g__·cked
;

225 
	#MAX_NUM
 256

	)

226 
	sh4_h_q
 {

227 
u32
 
	m¬¿y
[
MAX_NUM
];

228 
u8
 
	midx_»ad
;

229 
u8
 
	midx_wr™e
;

230 
u8
 
	mtÙ®
;

231 } 
__®igÃd
(64);

233 
	sh4_h_cÚŒŞ
 {

234 
h4_h_š™
 
	mš™
;

235 
h4_h_cÚfig_v”siÚ_5
 
cÚfig_v5
 
__®igÃd
(32);

236 
h4_h_cÚfig_v”siÚ_4
 
cÚfig_v4
 
__®igÃd
(32);

237 
u32
 
	mscÜebßrd
[256] 
__®igÃd
(64);

238 
h4_h_q
 
	mq
[
MIF_HIP_CFG_Q_NUM
] 
__®igÃd
(64);

239 } 
__®igÃd
(4096);

241 
	g¦si_h4
;

244 
	sh4_´iv
 {

245 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


247 
¥šlock_t
 
	mÇpi_ıu_lock
;

248 
wÜk_¡ruù
 
	mšŒ_wq_Çpi_ıu_sw™ch
;

249 
wÜk_¡ruù
 
	mšŒ_wq_ù¾
;

250 
skËt_¡ruù
 
	mšŒ__fb
;

251 
Çpi_¡ruù
 
	mÇpi
;

252 
	mÇpi_¡©e
;

253 
boŞ
 
	mÇpi_³rf_mode
;

254 
u8
 
	mÇpi_rx_fuÎ_út
;

255 
u8
 
	mÇpi_rx_§tu¿‹d
;

257 
wÜk_¡ruù
 
	mšŒ_wq
;

261 
u32
 
	mšŒ_toho¡
;

264 
u32
 
	mšŒ_toho¡_mul
[
MIF_HIP_CFG_Q_NUM
];

266 
u32
 
	mšŒ_äomho¡
;

269 
¦si_h4
 *
	mh
;

272 
u8
 
	mho¡_poŞ_id_d©
;

274 
u8
 
	mho¡_poŞ_id_ùl
;

277 
¥šlock_t
 
	mrx_lock
;

279 
¥šlock_t
 
	mtx_lock
;

282 
rwlock_t
 
	mrw_scÜebßrd
;

285 
tim”_li¡
 
	mw©chdog
;

287 
¥šlock_t
 
	mw©chdog_lock
;

289 
©omic_t
 
	mw©chdog_tim”_aùive
;

290 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


291 
DECLARE_BITMAP
(
œq_b™m­
, 
MIF_HIP_CFG_Q_NUM
);

294 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


295 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


296 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

297 
scsc_wake_lock
 
	mh4_wake_lock_tx
;

298 
scsc_wake_lock
 
	mh4_wake_lock_ù¾
;

299 
scsc_wake_lock
 
	mh4_wake_lock_d©a
;

302 
wake_lock
 
	mh4_wake_lock_tx
;

303 
wake_lock
 
	mh4_wake_lock_ù¾
;

304 
wake_lock
 
	mh4_wake_lock_d©a
;

308 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

309 
scsc_wake_lock
 
	mh4_wake_lock
;

311 
wake_lock
 
	mh4_wake_lock
;

316 
©omic_t
 
	mşosšg
;

317 
©omic_t
 
	mš_tx
;

318 
©omic_t
 
	mš_rx
;

319 
©omic_t
 
	mš_su¥’d
;

320 
u32
 
	m¡Üm_couÁ
;

323 
©omic_t
 
	mœqs
;

324 
©omic_t
 
	m¥urious_œqs
;

325 
u32
 
	mq_num_äames
[
MIF_HIP_CFG_Q_NUM
];

326 
ktime_t
 
	m¡¬t
;

327 
´oc_dœ_’Œy
 *
	m´ocfs_dœ
;

328 } 
	m¡©s
;

330 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


332 
u32
 
	mmšÜ
;

334 
u8
 
	munid©_»q_h—droom
;

335 
u8
 
	munid©_»q_room
;

336 
u32
 
	mv”siÚ
;

337 *
	mscbrd_ba£
;

340 
©omic_t
 
	mgaùive
;

341 
©omic_t
 
	mgmod
;

342 
©omic_t
 
	mgcod
;

343 
	m§tu¿‹d
;

344 
	mgu¬d
;

346 
¥šlock_t
 
	mgbÙ_lock
;

348 #ifdeà
CONFIG_SCSC_SMAPPER


355 
h4_sm­³r_bªk
 
	msm­³r_bªks
[
HIP4_SMAPPER_TOTAL_BANKS
];

356 
h4_sm­³r_cÚŒŞ
 
	msm­³r_cÚŒŞ
;

358 #ifdeà
CONFIG_SCSC_QOS


360 
wÜk_¡ruù
 
	mpm_qos_wÜk
;

362 
¥šlock_t
 
	mpm_qos_lock
;

363 
u8
 
	mpm_qos_¡©e
;

366 *
	mmib_cŞËù
;

367 
u16
 
	mmib_sz
;

369 
mu‹x
 
	mš_cŞËùiÚ
;

371 
wÜkqueue_¡ruù
 *
	mh4_wÜkq
;

374 
	gscsc_£rviû
;

376 
	s¦si_h4
 {

377 
h4_´iv
 *
	mh_´iv
;

378 
h4_h_cÚŒŞ
 *
	mh_cÚŒŞ
;

379 
scsc_miäam_»f
 
	mh_»f
;

383 
h4_š™
(
¦si_h4
 *
h
);

384 
h4_£tup
(
¦si_h4
 *
h
);

385 
h4_su¥’d
(
¦si_h4
 *
h
);

386 
h4_»sume
(
¦si_h4
 *
h
);

387 
h4_ä“ze
(
¦si_h4
 *
h
);

388 
h4_deš™
(
¦si_h4
 *
h
);

389 
h4_ä“_ù¾_¦Ùs_couÁ
(
¦si_h4
 *
h
);

390 
h4_£t_Çpi_ıu
(
¦si_h4
 *
h
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
);

391 
scsc_wifi_Œªsm™_äame
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
u8
 
vif_šdex
, u8 
³”_šdex
, u8 
´iÜ™y
);

392 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


393 
h4_sched_wq_ù¾
(
¦si_h4
 *
h
);

395 
h4_sched_wq
(
¦si_h4
 *
h
);

399 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u8
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_4
 *)(buff_±r))->memb”))

	)

400 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_4
 *)(buff_±r))->memb”))

	)

401 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u32
(
buff_±r
, 
memb”
è
	`Ë32_to_ıu
((((
h4_h_cÚfig_v”siÚ_4
 *)(buff_±r))->memb”))

	)

402 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u8
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_5
 *)(buff_±r))->memb”))

	)

403 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_5
 *)(buff_±r))->memb”))

	)

404 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u32
(
buff_±r
, 
memb”
è
	`Ë32_to_ıu
((((
h4_h_cÚfig_v”siÚ_5
 *)(buff_±r))->memb”))

	)

405 
	#scsc_wifi_g‘_h_cÚfig_u8
(
buff_±r
, 
memb”
, 
v”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_
##v” *)(buff_±r->
cÚfig_v
##v”))->memb”))

	)

406 
	#scsc_wifi_g‘_h_cÚfig_u16
(
buff_±r
, 
memb”
, 
v”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_
##v” *)(buff_±r->
cÚfig_v
##v”))->memb”))

	)

407 
	#scsc_wifi_g‘_h_cÚfig_u32
(
buff_±r
, 
memb”
, 
v”
è
	`Ë32_to_ıu
((((
h4_h_cÚfig_v”siÚ_
##v” *)(buff_±r->
cÚfig_v
##v”))->memb”))

	)

408 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ
(
buff_±r
è
	`Ë32_to_ıu
((((
h4_h_š™
 *)(buff_±r))->
cÚf_h4_v”
))

	)

	@hip4_sampler.c

6 
	~<lšux/moduË.h
>

7 
	~<lšux/moduË·¿m.h
>

8 
	~<lšux/š™.h
>

9 
	~<lšux/kfifo.h
>

10 
	~<lšux/pŞl.h
>

11 
	~<lšux/wa™.h
>

12 
	~<lšux/sched.h
>

13 
	~<lšux/k”Ãl.h
>

14 
	~<lšux/¦ab.h
>

15 
	~<lšux/fs.h
>

16 
	~<lšux/”ºo.h
>

17 
	~<lšux/ty³s.h
>

18 
	~<lšux/mm.h
>

19 
	~<lšux/v”siÚ.h
>

20 
	~<lšux/h¬dœq.h
>

21 
	~<lšux/ıuäeq.h
>

23 
	~<lšux/ktime.h
>

24 
	~<lšux/h¹im”.h
>

25 
	~<asm/·ge.h
>

26 
	~<lšux/cdev.h
>

27 
	~<lšux/deviû.h
>

28 
	~<scsc/scsc_mx.h
>

29 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

30 
	~<scsc/scsc_log_cŞËùÜ.h
>

32 
	~<lšux/d–ay.h
>

33 
	~<lšux/mu‹x.h
>

34 
	~"h4_§m¶”.h
"

36 
	~"debug.h
"

38 
	sh4_»cÜd
 {

39 
u32
 
	m»cÜd_num
;

40 
ktime_t
 
	mts
;

41 
u32
 
	m»cÜd
;

42 
u32
 
	m»cÜd2
;

43 } 
	g__·cked
;

45 
©omic_t
 
	gš_»ad
;

49 
DEFINE_SPINLOCK
(
g_¥šlock
);

51 
boŞ
 
	gh4_§m¶”_’abË
 = 
Œue
;

52 
moduË_·¿m
(
h4_§m¶”_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

53 
MODULE_PARM_DESC
(
h4_§m¶”_’abË
, "Enable hip4_sampler_enable. Run-time option - (default: Y)");

55 
boŞ
 
	gh4_§m¶”_dyÇmic
 = 
Œue
;

56 
moduË_·¿m
(
h4_§m¶”_dyÇmic
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

57 
MODULE_PARM_DESC
(
h4_§m¶”_dyÇmic
, "Enable hip4_sampler dynamic‡daptation based on TPUT. Run-time option - (default: Y)");

59 
	gh4_§m¶”_kfifo_Ën
 = 128 * 1024;

60 
moduË_·¿m
(
h4_§m¶”_kfifo_Ën
, , 
S_IRUGO
 | 
S_IWUSR
);

61 
MODULE_PARM_DESC
(
h4_§m¶”_kfifo_Ën
, "Streaming fifo buffer†ength in‚um of„ecords- default: 262144 Max: 262144. Loaded‡t /dev open");

63 
	gh4_§m¶”_¡©ic_kfifo_Ën
 = 128 * 1024;

64 
moduË_·¿m
(
h4_§m¶”_¡©ic_kfifo_Ën
, , 
S_IRUGO
 | 
S_IWUSR
);

65 
MODULE_PARM_DESC
(
h4_§m¶”_¡©ic_kfifo_Ën
, "Offline fifo buffer†ength in‚um of„ecords- default: 262144 Max: 262144. Loaded‡t /dev open");

67 
boŞ
 
	gh4_§m¶”_§m¶e_q
 = 
Œue
;

68 
moduË_·¿m
(
h4_§m¶”_§m¶e_q
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

69 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_q
, "Sample Queues. Default: Y. Runime option");

71 
boŞ
 
	gh4_§m¶”_§m¶e_q»f
 = 
Œue
;

72 
moduË_·¿m
(
h4_§m¶”_§m¶e_q»f
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

73 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_q»f
, "Sample Queue References. Default: Y. Runime option");

75 
boŞ
 
	gh4_§m¶”_§m¶e_št
 = 
Œue
;

76 
moduË_·¿m
(
h4_§m¶”_§m¶e_št
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

77 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_št
, "Sample WQ/Tasklet Intr BH in/out. Default: Y. Runime option");

79 
boŞ
 
	gh4_§m¶”_§m¶e_çpi
 = 
Œue
;

80 
moduË_·¿m
(
h4_§m¶”_§m¶e_çpi
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

81 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_çpi
, "Sample FAPI ctrl signals. Default: Y. Runime option");

83 
boŞ
 
	gh4_§m¶”_§m¶e_through
 = 
Œue
;

84 
moduË_·¿m
(
h4_§m¶”_§m¶e_through
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

85 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_through
, "Samplehroughput. Default: Y. Runime option");

87 
boŞ
 
	gh4_§m¶”_§m¶e_tı
 = 
Œue
;

88 
moduË_·¿m
(
h4_§m¶”_§m¶e_tı
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

89 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_tı
, "Sample TCP streams. Default: Y. Runime option");

91 
boŞ
 
	gh4_§m¶”_§m¶e_¡¬t_¡İ_q
 = 
Œue
;

92 
moduË_·¿m
(
h4_§m¶”_§m¶e_¡¬t_¡İ_q
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

93 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_¡¬t_¡İ_q
, "Sample Stop/Start queues. Default: Y. Runime option");

95 
boŞ
 
	gh4_§m¶”_§m¶e_mbulk
 = 
Œue
;

96 
moduË_·¿m
(
h4_§m¶”_§m¶e_mbulk
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

97 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_mbulk
, "Sample Mbulk counter. Default: Y. Runime option");

99 
boŞ
 
	gh4_§m¶”_§m¶e_qfuÎ
;

100 
moduË_·¿m
(
h4_§m¶”_§m¶e_qfuÎ
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

101 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_qfuÎ
, "Sample Q fullƒvent. Default: N. Runime option");

103 
boŞ
 
	gh4_§m¶”_§m¶e_mfuÎ
 = 
Œue
;

104 
moduË_·¿m
(
h4_§m¶”_§m¶e_mfuÎ
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

105 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_mfuÎ
, "Sample Mbulk fullƒvent. Default: Y. Runime option");

107 
boŞ
 
	gh4_§m¶”_vif
 = 
Œue
;

108 
moduË_·¿m
(
h4_§m¶”_vif
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

109 
MODULE_PARM_DESC
(
h4_§m¶”_vif
, "Sample VIF. Default: Y. Runime option");

111 
boŞ
 
	gh4_§m¶”_bÙ
 = 
Œue
;

112 
moduË_·¿m
(
h4_§m¶”_bÙ
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

113 
MODULE_PARM_DESC
(
h4_§m¶”_bÙ
, "Sample BOT. Default: Y. Runime option");

115 
boŞ
 
	gh4_§m¶”_pkt_tx
 = 
Œue
;

116 
moduË_·¿m
(
h4_§m¶”_pkt_tx
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

117 
MODULE_PARM_DESC
(
h4_§m¶”_pkt_tx
, "Track TX Data…acket TX->HIP4->FB. Default: Y. Runime option");

119 
boŞ
 
	gh4_§m¶”_su¥’d_»sume
 = 
Œue
;

120 
moduË_·¿m
(
h4_§m¶”_su¥’d_»sume
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

121 
MODULE_PARM_DESC
(
h4_§m¶”_su¥’d_»sume
, "Sample Suspend/Resumeƒvents. Default: Y. Runime option");

123 
	#HIP4_TPUT_HLIMIT
 400000000

	)

124 
	#HIP4_TPUT_LLIMIT
 350000000

	)

125 
	#HIP4_TPUT_HSECONDS
 1

	)

126 
	#HIP4_TPUT_LSECONDS
 5

	)

128 
boŞ
 
	gh4_§m¶”_§m¶e_q_hput
;

129 
boŞ
 
	gh4_§m¶”_§m¶e_q»f_hput
;

130 
boŞ
 
	gh4_§m¶”_§m¶e_št_hput
;

131 
boŞ
 
	gh4_§m¶”_§m¶e_çpi_hput
;

137 
boŞ
 
	gh4_§m¶”_vif_hput
;

138 
boŞ
 
	gh4_§m¶”_bÙ_hput
;

139 
boŞ
 
	gh4_§m¶”_pkt_tx_hput
;

140 
boŞ
 
	gh4_§m¶”_su¥’d_»sume_hput
;

142 
boŞ
 
	gh4_§m¶”_š_hut
;

143 
u16
 
	gh4_§m¶”_š_hut_£cÚds
;

145 
	#DRV_NAME
 "h4_§m¶”"

	)

146 
	#DEVICE_NAME
 "h4_§m¶”"

	)

148 #iâdeà
VM_RESERVED


149 
	#VM_RESERVED
 (
VM_DONTEXPAND
 | 
VM_DONTDUMP
)

	)

152 
	#VER_MAJOR
 0

	)

153 
	#VER_MINOR
 0

	)

155 
DECLARE_BITMAP
(
b™m­_h4_§m¶”_mšÜ
, 
SCSC_HIP4_DEBUG_INTERFACES
);

157 
	eh4_dg_”rÜs
 {

158 
	mNO_ERROR
 = 0,

159 
	mBUFFER_OVERFLOW
,

160 
	mKFIFO_ERROR
,

161 
	mKFIFO_FULL
,

164 
	eh4_ty³
 {

165 
	mSTREAMING
 = 0,

166 
	mOFFLINE
,

169 
	sh4_§m¶”_dev
 {

171 
fe
 *
	mfp
;

173 
cdev
 
	mcdev
;

175 
deviû
 *
	mdev
;

177 
scsc_mx
 *
	mmx
;

179 
DECLARE_KFIFO_PTR
(
fifo
, 
h4_»cÜd
);

181 
wa™_queue_h—d_t
 
	m»ad_wa™
;

183 
h4_dg_”rÜs
 
	m”rÜ
;

185 
mu‹x
 
	mmu‹x
;

187 
u32
 
	m»cÜd_num
;

189 
u32
 
	mkfifo_max
;

191 
h4_ty³
 
	mty³
;

193 
u32
 
	mmšÜ
;

200 
boŞ
 
	mš™
;

201 
dev_t
 
	mdeviû
;

202 
şass
 *
	mşass_h4_§m¶”
;

203 
h4_§m¶”_dev
 
	mdevs
[
SCSC_HIP4_DEBUG_INTERFACES
];

204 } 
	gh4_§m¶”
;

206 
	$__h4_§m¶”_upd©e_»cÜd
(
h4_§m¶”_dev
 *
h4_dev
, 
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
, u32 
·¿m5
)

208 
h4_»cÜd
 
ev
;

209 
u32
 
»t
;

210 
u32
 
ıu
;

211 
u32
 
äeq
 = 0;

214 ià(
h4_dev
->
fp
) {

216 ià(
	`kfifo_ava
(&
h4_dev
->
fifo
)) {

218 
ıu
 = 
	`smp_´oûssÜ_id
();

219 ià(
h4_dev
->
»cÜd_num
 % 64 == 0)

220 
äeq
 = (
	`ıuäeq_quick_g‘
(
ıu
) / 1000) & 0xfff;

221 
ev
.
»cÜd_num
 = (0x0000fffà& 
h4_dev
->»cÜd_num++è| (
ıu
 << 28è| (
äeq
 << 16);

222 
ev
.
ts
 = 
	`ktime_g‘
();

223 
ev
.
»cÜd
 = ((
·¿m1
 & 0xffè<< 24è| ((
·¿m2
 & 0xffè<< 16è| ((
·¿m3
 & 0xffè<< 8è| (
·¿m4
 & 0xff);

224 
ev
.
»cÜd2
 = 
·¿m5
;

225 
	`kfifo_put
(&
h4_dev
->
fifo
, 
ev
);

226 
»t
 = 
	`kfifo_Ën
(&
h4_dev
->
fifo
);

227 ià(
»t
 > 
h4_dev
->
kfifo_max
)

228 
h4_dev
->
kfifo_max
 = 
»t
;

230 
h4_dev
->
”rÜ
 = 
KFIFO_FULL
;

233 
	`wake_up_š‹¼u±ibË
(&
h4_dev
->
»ad_wa™
);

237 
h4_dev
 = &
h4_§m¶”
.
devs
[
mšÜ
 + 1];

240 ià(
	`kfifo_is_fuÎ
(&
h4_dev
->
fifo
))

241 
»t
 = 
	`kfifo_g‘
(&
h4_dev
->
fifo
, &
ev
);

242 
ıu
 = 
	`smp_´oûssÜ_id
();

243 ià(
h4_dev
->
»cÜd_num
 % 64 == 0)

244 
äeq
 = (
	`ıuäeq_quick_g‘
(
ıu
) / 1000) & 0xfff;

246 
ev
.
»cÜd_num
 = (0x0000fffà& 
h4_dev
->»cÜd_num++è| (
ıu
 << 28è| (
äeq
 << 16);

247 
ev
.
ts
 = 
	`ktime_g‘
();

248 
ev
.
»cÜd
 = ((
·¿m1
 & 0xffè<< 24è| ((
·¿m2
 & 0xffè<< 16è| ((
·¿m3
 & 0xffè<< 8è| (
·¿m4
 & 0xff);

249 
ev
.
»cÜd2
 = 
·¿m5
;

250 
	`kfifo_put
(&
h4_dev
->
fifo
, 
ev
);

252 
	}
}

254 
boŞ
 
	$h4_§m¶”_upd©e_»cÜd_f‹r
(
u8
 
·¿m1
)

256 
·¿m1
) {

257 
HIP4_MIF_Q_FH_CTRL
:

258 
HIP4_MIF_Q_FH_DAT
:

259 
HIP4_MIF_Q_FH_RFB
:

260 
HIP4_MIF_Q_TH_CTRL
:

261 
HIP4_MIF_Q_TH_DAT
:

262 
HIP4_MIF_Q_TH_RFB
:

263  
h4_§m¶”_§m¶e_q
;

264 
HIP4_SAMPLER_QREF
:

265  
h4_§m¶”_§m¶e_q»f
;

266 
HIP4_SAMPLER_SIGNAL_CTRLTX
:

267 
HIP4_SAMPLER_SIGNAL_CTRLRX
:

268  
h4_§m¶”_§m¶e_çpi
;

269 
HIP4_SAMPLER_THROUG
:

270 
HIP4_SAMPLER_THROUG_K
:

271 
HIP4_SAMPLER_THROUG_M
:

272  
h4_§m¶”_§m¶e_through
;

273 
HIP4_SAMPLER_STOP_Q
:

274 
HIP4_SAMPLER_START_Q
:

275  
h4_§m¶”_§m¶e_¡¬t_¡İ_q
;

276 
HIP4_SAMPLER_MBULK
:

277  
h4_§m¶”_§m¶e_mbulk
;

278 
HIP4_SAMPLER_QFULL
:

279  
h4_§m¶”_§m¶e_qfuÎ
;

280 
HIP4_SAMPLER_MFULL
:

281  
h4_§m¶”_§m¶e_mfuÎ
;

282 
HIP4_SAMPLER_INT
:

283 
HIP4_SAMPLER_INT_OUT
:

284 
HIP4_SAMPLER_INT_BH
:

285 
HIP4_SAMPLER_INT_OUT_BH
:

286  
h4_§m¶”_§m¶e_št
;

287 
HIP4_SAMPLER_RESET
:

288  
Œue
;

289 
HIP4_SAMPLER_PEER
:

290  
h4_§m¶”_vif
;

291 
HIP4_SAMPLER_BOT_RX
:

292 
HIP4_SAMPLER_BOT_TX
:

293 
HIP4_SAMPLER_BOT_ADD
:

294 
HIP4_SAMPLER_BOT_REMOVE
:

295 
HIP4_SAMPLER_BOT_START_Q
:

296 
HIP4_SAMPLER_BOT_STOP_Q
:

297 
HIP4_SAMPLER_BOT_QMOD_RX
:

298 
HIP4_SAMPLER_BOT_QMOD_TX
:

299  
h4_§m¶”_bÙ
;

300 
HIP4_SAMPLER_BOT_QMOD_START
:

301 
HIP4_SAMPLER_BOT_QMOD_STOP
:

302  
h4_§m¶”_§m¶e_¡¬t_¡İ_q
 || 
h4_§m¶”_bÙ
;

303 
HIP4_SAMPLER_PKT_TX
:

304 
HIP4_SAMPLER_PKT_TX_HIP4
:

305 
HIP4_SAMPLER_PKT_TX_FB
:

306  
h4_§m¶”_pkt_tx
;

307 
HIP4_SAMPLER_SUSPEND
:

308 
HIP4_SAMPLER_RESUME
:

309  
h4_§m¶”_su¥’d_»sume
;

310 
HIP4_SAMPLER_TCP_SYN
:

311 
HIP4_SAMPLER_TCP_FIN
:

312 
HIP4_SAMPLER_TCP_DATA
:

313 
HIP4_SAMPLER_TCP_ACK
:

314 
HIP4_SAMPLER_TCP_DATA_IN
:

315 
HIP4_SAMPLER_TCP_ACK_IN
:

316 
HIP4_SAMPLER_TCP_RWND
:

317 
HIP4_SAMPLER_TCP_CWND
:

318 
HIP4_SAMPLER_TCP_SEND_BUF
:

319  
h4_§m¶”_§m¶e_tı
;

321  
çl£
;

322 
	}
}

324 
	$h4_§m¶”_upd©e_»cÜd
(
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
, u32 
·¿m5
)

326 
h4_§m¶”_dev
 *
h4_dev
;

327 
æags
;

329 ià(!
	`h4_§m¶”_upd©e_»cÜd_f‹r
(
·¿m1
))

332 ià(!
h4_§m¶”_’abË
 || !
h4_§m¶”
.
š™
)

335 ià(
	`©omic_»ad
(&
š_»ad
))

338 ià(
mšÜ
 >ğ
SCSC_HIP4_INTERFACES
)

341 
	`¥š_lock_œq§ve
(&
g_¥šlock
, 
æags
);

342 
h4_dev
 = &
h4_§m¶”
.
devs
[
mšÜ
];

343 
	`__h4_§m¶”_upd©e_»cÜd
(
h4_dev
, 
mšÜ
, 
·¿m1
, 
·¿m2
, 
·¿m3
, 
·¿m4
, 
·¿m5
);

344 
	`¥š_uÆock_œq»¡Üe
(&
g_¥šlock
, 
æags
);

345 
	}
}

347 
	$h4_§m¶”_¡Üe_·¿m
()

349 
h4_§m¶”_§m¶e_q_hput
 = 
h4_§m¶”_§m¶e_q
;

350 
h4_§m¶”_§m¶e_q»f_hput
 = 
h4_§m¶”_§m¶e_q»f
;

351 
h4_§m¶”_§m¶e_št_hput
 = 
h4_§m¶”_§m¶e_št
;

352 
h4_§m¶”_§m¶e_çpi_hput
 = 
h4_§m¶”_§m¶e_çpi
;

358 
h4_§m¶”_vif_hput
 = 
h4_§m¶”_vif
;

359 
h4_§m¶”_bÙ_hput
 = 
h4_§m¶”_bÙ
;

360 
h4_§m¶”_pkt_tx_hput
 = 
h4_§m¶”_pkt_tx
;

361 
h4_§m¶”_su¥’d_»sume_hput
 = 
h4_§m¶”_su¥’d_»sume
;

364 
h4_§m¶”_§m¶e_q
 = 
çl£
;

365 
h4_§m¶”_§m¶e_q»f
 = 
çl£
;

366 
h4_§m¶”_§m¶e_št
 = 
çl£
;

367 
h4_§m¶”_§m¶e_çpi
 = 
çl£
;

373 
h4_§m¶”_vif
 = 
çl£
;

374 
h4_§m¶”_bÙ
 = 
çl£
;

375 
h4_§m¶”_pkt_tx
 = 
çl£
;

376 
h4_§m¶”_su¥’d_»sume
 = 
çl£
;

377 
	}
}

379 
	$h4_§m¶”_»¡Üe_·¿m
()

381 
h4_§m¶”_§m¶e_q
 = 
h4_§m¶”_§m¶e_q_hput
;

382 
h4_§m¶”_§m¶e_q»f
 = 
h4_§m¶”_§m¶e_q»f_hput
;

383 
h4_§m¶”_§m¶e_št
 = 
h4_§m¶”_§m¶e_št_hput
;

384 
h4_§m¶”_§m¶e_çpi
 = 
h4_§m¶”_§m¶e_çpi_hput
;

390 
h4_§m¶”_vif
 = 
h4_§m¶”_vif_hput
;

391 
h4_§m¶”_bÙ
 = 
h4_§m¶”_bÙ_hput
;

392 
h4_§m¶”_pkt_tx
 = 
h4_§m¶”_pkt_tx_hput
;

393 
h4_§m¶”_su¥’d_»sume
 = 
h4_§m¶”_su¥’d_»sume_hput
;

394 
	}
}

396 
	$h4_§m¶”_dyÇmic_sw™ch”
(
u32
 
bps
)

399 ià(
h4_§m¶”_š_hut
) {

400 ià(
bps
 < 
HIP4_TPUT_LLIMIT
) {

402 
h4_§m¶”_š_hut_£cÚds
++;

403 ià(
h4_§m¶”_š_hut_£cÚds
 >ğ
HIP4_TPUT_LSECONDS
) {

405 
h4_§m¶”_š_hut
 = 
çl£
;

406 
h4_§m¶”_š_hut_£cÚds
 = 0;

407 
	`h4_§m¶”_»¡Üe_·¿m
();

410 
h4_§m¶”_š_hut_£cÚds
 = 0;

413 ià(
bps
 > 
HIP4_TPUT_HLIMIT
) {

415 
h4_§m¶”_š_hut_£cÚds
++;

416 ià(
h4_§m¶”_š_hut_£cÚds
 >ğ
HIP4_TPUT_HSECONDS
) {

418 
h4_§m¶”_š_hut
 = 
Œue
;

419 
h4_§m¶”_š_hut_£cÚds
 = 0;

420 
	`h4_§m¶”_¡Üe_·¿m
();

423 
h4_§m¶”_š_hut_£cÚds
 = 0;

426 
	}
}

428 
u32
 
	gg_ut_rx
;

429 
u32
 
	gg_ut_tx
;

431 
	$h4_§m¶”_ut_mÚ™Ü
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

433 
h4_§m¶”_dev
 *h4_§m¶”_dev = (h4_§m¶”_dev *)
ş›Á_ùx
;

435 ià(!
h4_§m¶”_’abË
)

438 ià((
g_ut_tx
 =ğ
ut_tx
è&& (
g_ut_rx
 =ğ
ut_rx
))

441 
g_ut_tx
 = 
ut_tx
;

442 
g_ut_rx
 = 
ut_rx
;

444 ià(
h4_§m¶”_dyÇmic
) {

449 ià(
ut_rx
 > 
ut_tx
)

450 
	`h4_§m¶”_dyÇmic_sw™ch”
(
ut_rx
);

452 
	`h4_§m¶”_dyÇmic_sw™ch”
(
ut_tx
);

456 ià(
ut_tx
 < 1000) {

457 
	`SCSC_HIP4_SAMPLER_THROUG
(
h4_§m¶”_dev
->
mšÜ
, 1, (
ut_tx
 & 0xff00) >> 8,put_tx & 0xff);

458 } ià((
ut_tx
 >= 1000) && (tput_tx < (1000 * 1000))) {

459 
ut_tx
 =put_tx / 1000;

460 
	`SCSC_HIP4_SAMPLER_THROUG_K
(
h4_§m¶”_dev
->
mšÜ
, 1, (
ut_tx
 & 0xff00) >> 8,put_tx & 0xff);

462 
ut_tx
 =put_tx / (1000 * 1000);

463 
	`SCSC_HIP4_SAMPLER_THROUG_M
(
h4_§m¶”_dev
->
mšÜ
, 1, (
ut_tx
 & 0xff00) >> 8,put_tx & 0xff);

467 ià(
ut_rx
 < 1000) {

468 
	`SCSC_HIP4_SAMPLER_THROUG
(
h4_§m¶”_dev
->
mšÜ
, 0, (
ut_rx
 & 0xff00) >> 8,put_rx & 0xff);

469 } ià((
ut_rx
 >= 1000) && (tput_rx < (1000 * 1000))) {

470 
ut_rx
 =put_rx / 1000;

471 
	`SCSC_HIP4_SAMPLER_THROUG_K
(
h4_§m¶”_dev
->
mšÜ
, 0, (
ut_rx
 & 0xff00) >> 8,put_rx & 0xff);

473 
ut_rx
 =put_rx / (1000 * 1000);

474 
	`SCSC_HIP4_SAMPLER_THROUG_M
(
h4_§m¶”_dev
->
mšÜ
, 0, (
ut_rx
 & 0xff00) >> 8,put_rx & 0xff);

476 
	}
}

478 
	$h4_§m¶”_tı_decode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
äame
, 
boŞ
 
äom_ba
)

480 
tıhdr
 *
tı_hdr
;

481 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
äame
);

482 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

483 
u8
 *
_äame
;

484 
u16
 
_d©a_off£t
;

485 
u8
 
hËn
;

486 
u16
 
Ën
;

487 
u8
 
´Ùo
;

488 
u8
 
idx
;

490 ià(!
h4_§m¶”_§m¶e_tı
)

493 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è!ğ
ETH_P_IP
)

496 
_äame
 = 
äame
 + 
ETH_HLEN
;

497 
´Ùo
 = 
_äame
[9];

499 ià(
´Ùo
 !ğ
IPPROTO_TCP
)

502 
_d©a_off£t
 = 20;

503 
hËn
 = 
_äame
[0] & 0x0F;

504 
Ën
 = 
_äame
[2] << 8 | ip_frame[3];

506 ià(
hËn
 > 5)

507 
_d©a_off£t
 +ğ(
hËn
 - 5) * 4;

509 
tı_hdr
 = (
tıhdr
 *)(
_äame
 + 
_d©a_off£t
);

511 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

513 
idx
 = 0; idx < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; idx++) {

514 
¦si_tı_ack_s
 *
tı_ack
;

515 
u32
 
rwnd
 = 0;

517 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
idx
];

518 ià((
tı_ack
->
dpÜt
 =ğ
tı_hdr
->
sourû
è&& (tı_ack->
¥Üt
 =ğtı_hdr->
de¡
)) {

519 ià(
äom_ba
 && 
tı_hdr
->
syn
 &&ı_hdr->
ack
) {

520 *
İtiÚs
;

521 
u32
 
İ’
 = 0, 
Ën
 = 0;

523 ià(
tı_hdr
->
doff
 > 5)

524 
İ’
 = (
tı_hdr
->
doff
 - 5) * 4;

526 
İtiÚs
 = (
u8
 *)
tı_hdr
 + 
TCP_ACK_SUPPRESSION_OPTIONS_OFFSET
;

528 
İ’
 > 0) {

529 
İtiÚs
[0]) {

530 
TCP_ACK_SUPPRESSION_OPTION_EOL
:

531 
Ën
 = 1;

533 
TCP_ACK_SUPPRESSION_OPTION_NOP
:

534 
Ën
 = 1;

536 
TCP_ACK_SUPPRESSION_OPTION_WINDOW
:

537 
tı_ack
->
rx_wšdow_sÿË
 = 
İtiÚs
[2];

538 
Ën
 = 
İtiÚs
[1];

541 
Ën
 = 
İtiÚs
[1];

547 ià((
Ën
 =ğ0è|| (ËÀ>ğ
İ’
))

550 ià(
İ’
 >ğ
Ën
)

551 
İ’
 -ğ
Ën
;

553 
İ’
 = 0;

554 
İtiÚs
 +ğ
Ën
;

557 ià(
Ën
 > ((
hËn
 * 4è+ (
tı_hdr
->
doff
 * 4))) {

558 ià(
äom_ba
)

559 
	`SCSC_HIP4_SAMPLER_TCP_DATA
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
tı_hdr
->
£q
);

561 
	`SCSC_HIP4_SAMPLER_TCP_DATA_IN
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
tı_hdr
->
£q
);

563 ià(
tı_ack
->
rx_wšdow_sÿË
)

564 
rwnd
 = 
	`be16_to_ıu
(
tı_hdr
->
wšdow
è* (2 << 
tı_ack
->
rx_wšdow_sÿË
);

566 
rwnd
 = 
	`be16_to_ıu
(
tı_hdr
->
wšdow
);

567 ià(
äom_ba
) {

568 
	`SCSC_HIP4_SAMPLER_TCP_ACK
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
	`be32_to_ıu
(
tı_hdr
->
ack_£q
));

569 
	`SCSC_HIP4_SAMPLER_TCP_RWND
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
rwnd
);

571 
	`SCSC_HIP4_SAMPLER_TCP_ACK_IN
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
	`be32_to_ıu
(
tı_hdr
->
ack_£q
));

577 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

578 
	}
}

580 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

581 
	$h4_cŞËù_š™
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
)

584 
	`©omic_£t
(&
š_»ad
, 1);

586 
	}
}

588 
	$h4_cŞËù
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
, 
size_t
 
size
)

590 
i
 = 
SCSC_HIP4_DEBUG_INTERFACES
;

591 
»t
 = 0;

592 
æags
;

593 
u32
 
num_§m¶es
;

594 
h4_§m¶”_dev
 *
h4_dev
;

595 *
buf
;

596 
scsc_h4_§m¶”_h—d”
 
h—d”
;

599 
	`SLSI_INFO_NODEV
("Triggered†og collection in hip4_sampler\n");

601 ià(!
h4_§m¶”_’abË
)

604 
i
--)

605 ià(
h4_§m¶”
.
devs
[
i
].
mx
 =ğ
cŞËù_ş›Á
->
´v
 && h4_§m¶”.devs[i].
ty³
 =ğ
OFFLINE
) {

606 
h4_dev
 = &
h4_§m¶”
.
devs
[
i
];

607 
num_§m¶es
 = 
	`kfifo_Ën
(&
h4_dev
->
fifo
);

608 ià(!
num_§m¶es
)

610 
buf
 = 
	`vm®loc
(
num_§m¶es
 * (
h4_»cÜd
));

611 ià(!
buf
)

614 
	`mem£t
(&
h—d”
, 0, (header));

615 
	`memıy
(
h—d”
.
magic
, 
SCSC_HIP4_SAMPLER_MAGIC
, 4);

616 
h—d”
.
off£t_d©a
 = (header);

617 
h—d”
.
v”siÚ_majÜ
 = 
SCSC_HIP4_SAMPLER_HEADER_VERSION_MAJOR
;

618 
h—d”
.
v”siÚ_mšÜ
 = 
SCSC_HIP4_SAMPLER_HEADER_VERSION_MINOR
;

619 #ifdeà
CONFIG_SOC_EXYNOS9630


620 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_EXYNOS9630
;

621 #–ià
	`defšed
(
CONFIG_SOC_EXYNOS9610
)

622 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_EXYNOS9610
;

623 #–ià
	`defšed
(
CONFIG_SOC_EXYNOS7885
)

624 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_EXYNOS7885
;

625 #–ià
	`defšed
(
CONFIG_SOC_S5E8825
)

626 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_EXYNOS8825
;

628 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_UNDEF
;

631 
h—d”
.
§m¶e_ty³
 = 
SCSC_HIP4_SAMPLER_TYPE_TCP
;

632 ià(
h4_§m¶”_š_hut
)

633 
h—d”
.
h4_¡©us
 |ğ
	`BIT
(0);

634 #ifdeà
CONFIG_DEBUG_SPINLOCK


635 
h—d”
.
h4_¡©us
 |ğ
	`BIT
(1);

637 
h—d”
.
num_§m¶es
 =‚um_samples;

639 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)&
h—d”
, (header), 1);

640 ià(
»t
)

641 
”rÜ
;

643 
	`¥š_lock_œq§ve
(&
g_¥šlock
, 
æags
);

644 
»t
 = 
	`kfifo_out
(&
h4_dev
->
fifo
, 
buf
, 
num_§m¶es
);

645 
	`¥š_uÆock_œq»¡Üe
(&
g_¥šlock
, 
æags
);

646 ià(!
»t
)

647 
”rÜ
;

648 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "num_§m¶e %d„‘ %d sizoàh4_»cÜd %zu\n", 
num_§m¶es
, 
»t
, (
h4_»cÜd
));

649 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
(
buf
,„‘ * (
h4_»cÜd
), 1);

650 ià(
»t
)

651 
”rÜ
;

652 
	`vä“
(
buf
);

655 
”rÜ
:

656 
	`vä“
(
buf
);

657  
»t
;

658 
	}
}

660 
	$h4_cŞËù_’d
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
)

663 
	`©omic_£t
(&
š_»ad
, 0);

665 
	}
}

668 
scsc_log_cŞËùÜ_ş›Á
 
	gh4_cŞËù_ş›Á
 = {

669 .
Çme
 = "HIP4 Sampler",

670 .
	gty³
 = 
SCSC_LOG_CHUNK_HIP4_SAMPLER
,

671 .
	gcŞËù_š™
 = 
h4_cŞËù_š™
,

672 .
	gcŞËù
 = 
h4_cŞËù
,

673 .
	gcŞËù_’d
 = 
h4_cŞËù_’d
,

674 .
	g´v
 = 
NULL
,

678 
	$h4_§m¶”_İ’
(
šode
 *šode, 
fe
 *
fp
)

680 
h4_§m¶”_dev
 *
h4_dev
;

681 
»t
 = 0;

683 
h4_dev
 = 
	`cÚš”_of
(
šode
->
i_cdev
, 
h4_§m¶”_dev
, 
cdev
);

685 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
) {

687 
fp
->
´iv©e_d©a
 = 
h4_dev
;

690 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

691  -
ERESTARTSYS
;

693 ià(
fp
->
´iv©e_d©a
) {

694 
	`SLSI_INFO_NODEV
("Service‡lready started\n");

695 
»t
 = 0;

696 
’d
;

699 ià(
h4_§m¶”_kfifo_Ën
 > 256 * 1024) {

700 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "h4_§m¶”_kfifo_ËÀ%d > 2262144. S‘ØMAX", 
h4_§m¶”_kfifo_Ën
);

701 
h4_§m¶”_kfifo_Ën
 = 256 * 1024;

704 
»t
 = 
	`kfifo_®loc
(&
h4_dev
->
fifo
, 
h4_§m¶”_kfifo_Ën
, 
GFP_KERNEL
);

705 ià(
»t
) {

706 
	`SLSI_ERR_NODEV
("kfifo_alloc failed");

707 
»t
 = -
ENOMEM
;

708 
’d
;

711 
fp
->
´iv©e_d©a
 = 
h4_dev
;

714 
h4_dev
->
”rÜ
 = 
NO_ERROR
;

716 
h4_dev
->
»cÜd_num
 = 0;

717 
h4_dev
->
kfifo_max
 = 0;

718 
h4_dev
->
fp
 = filp;

720 
	`SLSI_INFO_NODEV
("%s: Sam¶šg....\n", 
DRV_NAME
);

721 
’d
:

722 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

723  
»t
;

724 
	}
}

726 
ssize_t
 
	$h4_§m¶”_»ad
(
fe
 *
fp
, 
__u£r
 *
buf
, 
size_t
 
Ën
, 
loff_t
 *
off£t
)

728 
cİ›d
;

729 
»t
 = 0;

730 
h4_§m¶”_dev
 *
h4_dev
;

732 
h4_dev
 = 
fp
->
´iv©e_d©a
;

734 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
) {

736 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

737  -
EINTR
;

738 
	`©omic_£t
(&
š_»ad
, 1);

739 
»t
 = 
	`kfifo_to_u£r
(&
h4_dev
->
fifo
, 
buf
, 
Ën
, &
cİ›d
);

740 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

741  
»t
 ?„‘ : 
cİ›d
;

744 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

745  -
EINTR
;

748 ià(
h4_dev
->
”rÜ
 !ğ
NO_ERROR
) {

749 
	`SLSI_ERR_NODEV
("Device inƒrror\n");

750 
»t
 = -
EIO
;

751 
’d
;

754 
Ën
) {

755 ià(
	`kfifo_Ën
(&
h4_dev
->
fifo
)) {

756 
»t
 = 
	`kfifo_to_u£r
(&
h4_dev
->
fifo
, 
buf
, 
Ën
, &
cİ›d
);

757 ià(!
»t
)

758 
»t
 = 
cİ›d
;

762 ià(
fp
->
f_æags
 & 
O_NONBLOCK
) {

763 
»t
 = -
EAGAIN
;

767 
»t
 = 
	`wa™_ev’t_š‹¼u±ibË
(
h4_dev
->
»ad_wa™
,

768 !
	`kfifo_is_em±y
(&
h4_dev
->
fifo
));

769 ià(
»t
 < 0)

772 
’d
:

773 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

774  
»t
;

775 
	}
}

777 
	$h4_§m¶”_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

779 
h4_§m¶”_dev
 *
h4_dev
;

780 
»t
;

782 
h4_dev
 = 
fp
->
´iv©e_d©a
;

784 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
)

788 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

789  -
EINTR
;

791 ià(
h4_dev
->
”rÜ
 !ğ
NO_ERROR
) {

792 
»t
 = 
POLLERR
;

793 
’d
;

796 
	`pŞl_wa™
(
fp
, &
h4_dev
->
»ad_wa™
, 
wa™
);

798 ià(!
	`kfifo_is_em±y
(&
h4_dev
->
fifo
)) {

799 
»t
 = 
POLLIN
 | 
POLLRDNORM
;

800 
’d
;

803 
»t
 = 
POLLOUT
 | 
POLLWRNORM
;

805 
’d
:

806 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

807  
»t
;

808 
	}
}

810 
	$h4_§m¶”_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

812 
h4_§m¶”_dev
 *
h4_dev
;

814 
h4_dev
 = 
	`cÚš”_of
(
šode
->
i_cdev
, 
h4_§m¶”_dev
, 
cdev
);

816 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
) {

817 
	`©omic_£t
(&
š_»ad
, 0);

822 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

823  -
EINTR
;

825 ià(!
h4_dev
->
fp
) {

826 
	`SLSI_ERR_NODEV
("Device‡lready closed\n");

827 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

828  -
EIO
;

831 ià(
h4_dev
 !ğ
fp
->
´iv©e_d©a
) {

832 
	`SLSI_ERR_NODEV
("Data mismatch\n");

833 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

834  -
EIO
;

837 
fp
->
´iv©e_d©a
 = 
NULL
;

838 
h4_dev
->
fp
 = 
NULL
;

839 
	`kfifo_ä“
(&
h4_dev
->
fifo
);

841 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

842 
	`SLSI_INFO_NODEV
("%s: Sam¶šg...ƒnd. Kfifo_max = %d\n", 
DRV_NAME
, 
h4_dev
->
kfifo_max
);

844 
	}
}

846 cÚ¡ 
fe_İ”©iÚs
 
	gh4_§m¶”_fİs
 = {

847 .
owÃr
 = 
THIS_MODULE
,

848 .
	gİ’
 = 
h4_§m¶”_İ’
,

849 .
	g»ad
 = 
h4_§m¶”_»ad
,

850 .
	g»Ëa£
 = 
h4_§m¶”_»Ëa£
,

851 .
	gpŞl
 = 
h4_§m¶”_pŞl
,

855 
	$h4_§m¶”_»gi¡”_h
(
scsc_mx
 *
mx
)

857 
i
 = 
SCSC_HIP4_DEBUG_INTERFACES
;

859 
i
--)

860 ià(
h4_§m¶”
.
devs
[
i
].
mx
 == mx &&

861 
h4_§m¶”
.
devs
[
i
].
ty³
 =ğ
STREAMING
)

862  
i
;

863  -
ENODEV
;

864 
	}
}

866 
	$h4_§m¶”_ü—‹
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

868 
dev_t
 
devn
;

869 
»t
;

870 
dev_Çme
[20];

871 
mšÜ
;

872 
i
;

874 
	`SLSI_INFO_NODEV
("h4_§m¶” v”siÚ: %d.%d\n", 
VER_MAJOR
, 
VER_MINOR
);

876 
	`mem£t
(&
h4_§m¶”
, 0, (hip4_sampler));

878 ià(!
h4_§m¶”
.
š™
) {

879 
»t
 = 
	`®loc_chrdev_»giÚ
(&
h4_§m¶”
.
deviû
, 0, 
SCSC_HIP4_DEBUG_INTERFACES
, "hip4_sampler_char");

880 ià(
»t
)

881 
”rÜ
;

883 
h4_§m¶”
.
şass_h4_§m¶”
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
DEVICE_NAME
);

884 ià(
	`IS_ERR
(
h4_§m¶”
.
şass_h4_§m¶”
)) {

885 
	`SLSI_ERR_NODEV
("hip4_sampler class creation failed\n");

886 
»t
 = 
	`PTR_ERR
(
h4_§m¶”
.
şass_h4_§m¶”
);

887 
”rÜ_şass
;

892 
mšÜ
 = 
	`fšd_fœ¡_z”o_b™
(
b™m­_h4_§m¶”_mšÜ
, 
SCSC_HIP4_DEBUG_INTERFACES
);

893 ià(
mšÜ
 =ğ
SCSC_HIP4_DEBUG_INTERFACES
) {

894 
	`SLSI_INFO_NODEV
("mšÜ %d > SCSC_TTY_MINORS\n", 
mšÜ
);

900 
i
 = 0; i < 
SCSC_HIP4_STREAM_CH
; i++) {

901 
mšÜ
 +ğ
i
;

902 
devn
 = 
	`MKDEV
(
	`MAJOR
(
h4_§m¶”
.
deviû
), 
	`MINOR
(
mšÜ
));

904 
	`¢´štf
(
dev_Çme
, (dev_Çme), "%s_%d_%s", "h4", 
i
, "sam_str");

906 
	`cdev_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, &
h4_§m¶”_fİs
);

907 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
owÃr
 = 
THIS_MODULE
;

908 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
İs
 = &
h4_§m¶”_fİs
;

910 
»t
 = 
	`cdev_add
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, 
devn
, 1);

911 ià(
»t
) {

912 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

916 
h4_§m¶”
.
devs
[
mšÜ
].
dev
 =

917 
	`deviû_ü—‹
(
h4_§m¶”
.
şass_h4_§m¶”
, 
NULL
, h4_§m¶”.
devs
[
mšÜ
].
cdev
.
dev
, NULL, 
dev_Çme
);

919 ià(!
h4_§m¶”
.
devs
[
mšÜ
].
dev
) {

920 
	`SLSI_ERR_NODEV
("dev is NULL\n");

921 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

922 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
);

926 
h4_§m¶”
.
devs
[
mšÜ
].
mx
 = mx;

928 
	`mu‹x_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
mu‹x
);

929 
h4_§m¶”
.
devs
[
mšÜ
].
kfifo_max
 = 0;

930 
h4_§m¶”
.
devs
[
mšÜ
].
ty³
 = 
STREAMING
;

931 
h4_§m¶”
.
devs
[
mšÜ
].minor = minor;

933 
	`š™_wa™queue_h—d
(&
h4_§m¶”
.
devs
[
mšÜ
].
»ad_wa™
);

935 
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(

936 
sdev
,

937 &
h4_§m¶”
.
devs
[
mšÜ
],

938 
TRAFFIC_MON_CLIENT_MODE_PERIODIC
,

941 
h4_§m¶”_ut_mÚ™Ü
);

944 
	`£t_b™
(
mšÜ
, 
b™m­_h4_§m¶”_mšÜ
);

946 
mšÜ
++;

949 
devn
 = 
	`MKDEV
(
	`MAJOR
(
h4_§m¶”
.
deviû
), 
	`MINOR
(
mšÜ
));

951 
	`¢´štf
(
dev_Çme
, (dev_Çme), "%s_%d_%s", "h4", 
i
, "sam_off");

953 
	`cdev_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, &
h4_§m¶”_fİs
);

954 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
owÃr
 = 
THIS_MODULE
;

955 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
İs
 = &
h4_§m¶”_fİs
;

957 
»t
 = 
	`cdev_add
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, 
devn
, 1);

958 ià(
»t
) {

959 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

963 
h4_§m¶”
.
devs
[
mšÜ
].
dev
 =

964 
	`deviû_ü—‹
(
h4_§m¶”
.
şass_h4_§m¶”
, 
NULL
, h4_§m¶”.
devs
[
mšÜ
].
cdev
.
dev
, NULL, 
dev_Çme
);

966 ià(!
h4_§m¶”
.
devs
[
mšÜ
].
dev
) {

967 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

968 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
);

972 ià(
h4_§m¶”_¡©ic_kfifo_Ën
 > 256 * 1024) {

973 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "h4_§m¶”_¡©ic_kfifo_ËÀ%d > 2262144. S‘ØMAX", 
h4_§m¶”_¡©ic_kfifo_Ën
);

974 
h4_§m¶”_¡©ic_kfifo_Ën
 = 256 * 1024;

976 
»t
 = 
	`kfifo_®loc
(&
h4_§m¶”
.
devs
[
mšÜ
].
fifo
, 
h4_§m¶”_¡©ic_kfifo_Ën
, 
GFP_KERNEL
);

977 ià(
»t
) {

978 
	`SLSI_ERR_NODEV
("kfifo_alloc failed");

979 
h4_§m¶”
.
devs
[
mšÜ
].
dev
 = 
NULL
;

980 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

981 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
);

985 
h4_§m¶”
.
devs
[
mšÜ
].
mx
 = mx;

987 
	`mu‹x_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
mu‹x
);

988 
h4_§m¶”
.
devs
[
mšÜ
].
kfifo_max
 = 0;

989 
h4_§m¶”
.
devs
[
mšÜ
].
ty³
 = 
OFFLINE
;

992 
	`£t_b™
(
mšÜ
, 
b™m­_h4_§m¶”_mšÜ
);

995 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

996 
h4_cŞËù_ş›Á
.
´v
 = 
mx
;

997 
	`scsc_log_cŞËùÜ_»gi¡”_ş›Á
(&
h4_cŞËù_ş›Á
);

999 
h4_§m¶”
.
š™
 = 
Œue
;

1001 
	`SLSI_INFO_NODEV
("%s: R—dyØ¡¬ˆ§m¶šg....\n", 
DRV_NAME
);

1005 
”rÜ_şass
:

1006 
	`uÄegi¡”_chrdev_»giÚ
(
h4_§m¶”
.
deviû
, 
SCSC_HIP4_DEBUG_INTERFACES
);

1007 
h4_§m¶”
.
š™
 = 
çl£
;

1008 
”rÜ
:

1010 
	}
}

1012 
	$h4_§m¶”_de¡roy
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

1014 
i
 = 
SCSC_HIP4_DEBUG_INTERFACES
;

1015 
h4_§m¶”_dev
 *
h4_dev
;

1017 
i
--)

1018 ià(
h4_§m¶”
.
devs
[
i
].
cdev
.
dev
 && h4_§m¶”.devs[i].
mx
) {

1019 
h4_dev
 = &
h4_§m¶”
.
devs
[
i
];

1023 ià(
h4_§m¶”
.
devs
[
i
].
fp
) {

1024 
h4_§m¶”
.
devs
[
i
].
fp
 = 
NULL
;

1025 
	`kfifo_ä“
(&
h4_§m¶”
.
devs
[
i
].
fifo
);

1027 ià(
h4_§m¶”
.
devs
[
i
].
ty³
 =ğ
OFFLINE
)

1028 
	`kfifo_ä“
(&
h4_§m¶”
.
devs
[
i
].
fifo
);

1030 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
h4_dev
);

1031 
	`deviû_de¡roy
(
h4_§m¶”
.
şass_h4_§m¶”
, h4_§m¶”.
devs
[
i
].
cdev
.
dev
);

1032 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
i
].
cdev
);

1033 
	`mem£t
(&
h4_§m¶”
.
devs
[
i
].
cdev
, 0, (cdev));

1034 
h4_§m¶”
.
devs
[
i
].
mx
 = 
NULL
;

1035 
	`ş—r_b™
(
i
, 
b™m­_h4_§m¶”_mšÜ
);

1037 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1038 
	`scsc_log_cŞËùÜ_uÄegi¡”_ş›Á
(&
h4_cŞËù_ş›Á
);

1040 
	`şass_de¡roy
(
h4_§m¶”
.
şass_h4_§m¶”
);

1041 
	`uÄegi¡”_chrdev_»giÚ
(
h4_§m¶”
.
deviû
, 
SCSC_HIP4_DEBUG_INTERFACES
);

1042 
h4_§m¶”
.
š™
 = 
çl£
;

1043 
	}
}

	@hip4_sampler.h

7 #iâdeà
__HIP4_SAMPLER_H__


8 
	#__HIP4_SAMPLER_H__


	)

10 
	~<lšux/´oc_fs.h
>

11 
	~<lšux/v”siÚ.h
>

12 
	~<lšux/£q_fe.h
>

13 
	~<Ãt/tı.h
>

15 
	~"dev.h
"

17 
	#HIP4_SAMPLER_SIGNAL_CTRLTX
 0x20

	)

18 
	#HIP4_SAMPLER_SIGNAL_CTRLRX
 0x21

	)

19 
	#HIP4_SAMPLER_THROUG
 0x22

	)

20 
	#HIP4_SAMPLER_THROUG_K
 0x23

	)

21 
	#HIP4_SAMPLER_THROUG_M
 0x24

	)

22 
	#HIP4_SAMPLER_STOP_Q
 0x25

	)

23 
	#HIP4_SAMPLER_START_Q
 0x26

	)

24 
	#HIP4_SAMPLER_QREF
 0x27

	)

25 
	#HIP4_SAMPLER_PEER
 0x29

	)

26 
	#HIP4_SAMPLER_BOT_RX
 0x2a

	)

27 
	#HIP4_SAMPLER_BOT_TX
 0x2b

	)

28 
	#HIP4_SAMPLER_BOT_ADD
 0x2c

	)

29 
	#HIP4_SAMPLER_BOT_REMOVE
 0x2d

	)

30 
	#HIP4_SAMPLER_BOT_STOP_Q
 0x2e

	)

31 
	#HIP4_SAMPLER_BOT_START_Q
 0x2f

	)

32 
	#HIP4_SAMPLER_BOT_QMOD_RX
 0x30

	)

33 
	#HIP4_SAMPLER_BOT_QMOD_TX
 0x31

	)

34 
	#HIP4_SAMPLER_BOT_QMOD_STOP
 0x32

	)

35 
	#HIP4_SAMPLER_BOT_QMOD_START
 0x33

	)

36 
	#HIP4_SAMPLER_PKT_TX
 0x40

	)

37 
	#HIP4_SAMPLER_PKT_TX_HIP4
 0x41

	)

38 
	#HIP4_SAMPLER_PKT_TX_FB
 0x42

	)

39 
	#HIP4_SAMPLER_SUSPEND
 0x50

	)

40 
	#HIP4_SAMPLER_RESUME
 0x51

	)

42 
	#HIP4_SAMPLER_TCP_SYN
 0x60

	)

43 
	#HIP4_SAMPLER_TCP_FIN
 0x61

	)

44 
	#HIP4_SAMPLER_TCP_DATA
 0x62

	)

45 
	#HIP4_SAMPLER_TCP_ACK
 0x63

	)

46 
	#HIP4_SAMPLER_TCP_RWND
 0x64

	)

47 
	#HIP4_SAMPLER_TCP_CWND
 0x65

	)

48 
	#HIP4_SAMPLER_TCP_SEND_BUF
 0x66

	)

49 
	#HIP4_SAMPLER_TCP_DATA_IN
 0x67

	)

50 
	#HIP4_SAMPLER_TCP_ACK_IN
 0x68

	)

52 
	#HIP4_SAMPLER_MBULK
 0x¯

	)

53 
	#HIP4_SAMPLER_QFULL
 0xbb

	)

54 
	#HIP4_SAMPLER_MFULL
 0xcc

	)

55 
	#HIP4_SAMPLER_INT
 0xdd

	)

56 
	#HIP4_SAMPLER_INT_OUT
 0x“

	)

57 
	#HIP4_SAMPLER_INT_BH
 0xde

	)

58 
	#HIP4_SAMPLER_INT_OUT_BH
 0xef

	)

59 
	#HIP4_SAMPLER_RESET
 0xff

	)

61 
	#SCSC_HIP4_INTERFACES
 1

	)

63 
	#SCSC_HIP4_STREAM_CH
 1

	)

64 
	#SCSC_HIP4_OFFLINE_CH
 
SCSC_HIP4_STREAM_CH


	)

66 #ià(
SCSC_HIP4_OFFLINE_CH
 !ğ
SCSC_HIP4_STREAM_CH
)

70 
	#SCSC_HIP4_DEBUG_INTERFACES
 ((
SCSC_HIP4_INTERFACES
è* (
SCSC_HIP4_STREAM_CH
 + 
SCSC_HIP4_OFFLINE_CH
))

	)

72 
	gscsc_mx
;

74 
h4_§m¶”_ü—‹
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
);

75 
h4_§m¶”_de¡roy
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
);

79 
h4_§m¶”_»gi¡”_h
(
scsc_mx
 *
mx
);

81 
h4_§m¶”_upd©e_»cÜd
(
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
, u32 
·¿m5
);

82 
h4_§m¶”_tı_decode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
äame
, 
boŞ
 
äom_ba
);

84 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


85 
	#SCSC_HIP4_SAMPLER_Q
(
mšÜ
, 
q
, 
idx_rw
, 
v®ue
, 
rw
) \

86 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
q
, 
idx_rw
, 
v®ue
, 
rw
, 0)

	)

88 
	#SCSC_HIP4_SAMPLER_QREF
(
mšÜ
, 
»f
, 
q
) \

89 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_QREF
, (
»f
 & 0xff0000è>> 16, (»à& 0xff00è>> 8, (»à& 0xf0è| 
q
, 0)

	)

91 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLTX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
) \

92 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_SIGNAL_CTRLTX
, 0, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

94 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
) \

95 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_SIGNAL_CTRLRX
, 0, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

97 
	#SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
äame
, 
äom_ba
) \

98 
	`h4_§m¶”_tı_decode
(
sdev
, 
dev
, 
äame
, 
äom_ba
)

	)

100 
	#SCSC_HIP4_SAMPLER_THROUG
(
mšÜ
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
) \

101 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_THROUG
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

103 
	#SCSC_HIP4_SAMPLER_THROUG_K
(
mšÜ
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
) \

104 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_THROUG_K
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

106 
	#SCSC_HIP4_SAMPLER_THROUG_M
(
mšÜ
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
) \

107 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_THROUG_M
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

109 
	#SCSC_HIP4_SAMPLER_STOP_Q
(
mšÜ
, 
vif_id
) \

110 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_STOP_Q
, 0, 0, 
vif_id
, 0)

	)

112 
	#SCSC_HIP4_SAMPLER_START_Q
(
mšÜ
, 
vif_id
) \

113 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_START_Q
, 0, 0, 
vif_id
, 0)

	)

115 
	#SCSC_HIP4_SAMPLER_MBULK
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
, 
şas
) \

116 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_MBULK
, 
şas
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

118 
	#SCSC_HIP4_SAMPLER_QFULL
(
mšÜ
, 
q
) \

119 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_QFULL
, 0, 0, 
q
, 0)

	)

121 
	#SCSC_HIP4_SAMPLER_MFULL
(
mšÜ
) \

122 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_MFULL
, 0, 0, 0, 0)

	)

124 
	#SCSC_HIP4_SAMPLER_INT
(
mšÜ
, 
id
) \

125 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT
, 0, 0, 
id
, 0)

	)

127 
	#SCSC_HIP4_SAMPLER_INT_OUT
(
mšÜ
, 
id
) \

128 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT_OUT
, 0, 0, 
id
, 0)

	)

130 
	#SCSC_HIP4_SAMPLER_INT_BH
(
mšÜ
, 
id
) \

131 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT_BH
, 0, 0, 
id
, 0)

	)

133 
	#SCSC_HIP4_SAMPLER_INT_OUT_BH
(
mšÜ
, 
id
) \

134 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT_OUT_BH
, 0, 0, 
id
, 0)

	)

136 
	#SCSC_HIP4_SAMPLER_RESET
(
mšÜ
) \

137 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_RESET
, 0, 0, 0, 0)

	)

139 
	#SCSC_HIP4_SAMPLER_VIF_PEER
(
mšÜ
, 
tx
, 
vif
, 
³”_šdex
) \

140 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PEER
, 
tx
, 
vif
, 
³”_šdex
, 0)

	)

142 
	#SCSC_HIP4_SAMPLER_BOT_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
) \

143 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_RX
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

145 
	#SCSC_HIP4_SAMPLER_BOT_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
) \

146 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_TX
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

148 
	#SCSC_HIP4_SAMPLER_BOT_ADD
(
mšÜ
, 
vif
, 
³”_šdex
, 
addr_0_to_3
) \

149 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_ADD
, 
vif
, 
³”_šdex
, 0, 
addr_0_to_3
)

	)

151 
	#SCSC_HIP4_SAMPLER_BOT_REMOVE
(
mšÜ
, 
vif
, 
³”_šdex
) \

152 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_REMOVE
, 
vif
, 
³”_šdex
, 0, 0)

	)

154 
	#SCSC_HIP4_SAMPLER_BOT_START_Q
(
mšÜ
, 
vif
, 
³”_šdex
) \

155 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_START_Q
, 
vif
, 
³”_šdex
, 0, 0)

	)

157 
	#SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
mšÜ
, 
vif
, 
³”_šdex
) \

158 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_STOP_Q
, 
vif
, 
³”_šdex
, 0, 0)

	)

160 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
) \

161 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_RX
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

163 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
) \

164 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_TX
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

166 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_START
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
) \

167 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_START
, 
vif
, 
³”_šdex
, 
´iÜ™y
, 0)

	)

169 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_STOP
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
) \

170 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_STOP
, 
vif
, 
³”_šdex
, 
´iÜ™y
, 0)

	)

172 
	#SCSC_HIP4_SAMPLER_PKT_TX
(
mšÜ
, 
ho¡_g
) \

173 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PKT_TX
, 0, (
ho¡_g
 >> 8è& 0xff, ho¡_g & 0xff, 0)

	)

175 
	#SCSC_HIP4_SAMPLER_PKT_TX_HIP4
(
mšÜ
, 
ho¡_g
) \

176 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PKT_TX_HIP4
, 0, (
ho¡_g
 >> 8è& 0xff, ho¡_g & 0xff, 0)

	)

178 
	#SCSC_HIP4_SAMPLER_PKT_TX_FB
(
mšÜ
, 
ho¡_g
) \

179 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PKT_TX_FB
, 0, (
ho¡_g
 >> 8è& 0xff, ho¡_g & 0xff, 0)

	)

181 
	#SCSC_HIP4_SAMPLER_SUSPEND
(
mšÜ
) \

182 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_SUSPEND
, 0, 0, 0, 0)

	)

184 
	#SCSC_HIP4_SAMPLER_RESUME
(
mšÜ
) \

185 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_RESUME
, 0, 0, 0, 0)

	)

187 
	#SCSC_HIP4_SAMPLER_TCP_SYN
(
mšÜ
, 
id
, 
mss
) \

188 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_SYN
, 
id
, 0, 0, 
mss
)

	)

190 
	#SCSC_HIP4_SAMPLER_TCP_FIN
(
mšÜ
, 
id
) \

191 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_FIN
, 
id
, 0, 0, 0)

	)

193 
	#SCSC_HIP4_SAMPLER_TCP_DATA
(
mšÜ
, 
id
, 
£q_num
) \

194 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_DATA
, 
id
, 0, 0, 
£q_num
)

	)

196 
	#SCSC_HIP4_SAMPLER_TCP_ACK
(
mšÜ
, 
id
, 
ack_num
) \

197 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_ACK
, 
id
, 0, 0, 
ack_num
)

	)

199 
	#SCSC_HIP4_SAMPLER_TCP_DATA_IN
(
mšÜ
, 
id
, 
£q_num
) \

200 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_DATA_IN
, 
id
, 0, 0, 
£q_num
)

	)

202 
	#SCSC_HIP4_SAMPLER_TCP_ACK_IN
(
mšÜ
, 
id
, 
ack_num
) \

203 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_ACK_IN
, 
id
, 0, 0, 
ack_num
)

	)

205 
	#SCSC_HIP4_SAMPLER_TCP_RWND
(
mšÜ
, 
id
, 
rwnd
) \

206 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_RWND
, 
id
, 0, 0, 
rwnd
)

	)

208 
	#SCSC_HIP4_SAMPLER_TCP_CWND
(
mšÜ
, 
id
, 
cwnd
) \

209 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_CWND
, 
id
, 0, 0, 
cwnd
)

	)

211 
	#SCSC_HIP4_SAMPLER_TCP_SEND_BUF
(
mšÜ
, 
id
, 
£nd_buff_size
) \

212 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_SEND_BUF
, 
id
, 0, 0, 
£nd_buff_size
)

	)

215 
	#SCSC_HIP4_SAMPLER_Q
(
mšÜ
, 
q
, 
idx_rw
, 
v®ue
, 
rw
)

	)

216 
	#SCSC_HIP4_SAMPLER_QREF
(
mšÜ
, 
»f
, 
q
)

	)

217 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLTX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

218 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

219 
	#SCSC_HIP4_SAMPLER_TPUT
(
mšÜ
, 
rx_tx
, 
·ylßd
)

	)

220 
	#SCSC_HIP4_SAMPLER_THROUG
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

221 
	#SCSC_HIP4_SAMPLER_THROUG_K
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

222 
	#SCSC_HIP4_SAMPLER_THROUG_M
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

223 
	#SCSC_HIP4_SAMPLER_MBULK
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
, 
şas
)

	)

224 
	#SCSC_HIP4_SAMPLER_QFULL
(
mšÜ
, 
q
)

	)

225 
	#SCSC_HIP4_SAMPLER_MFULL
(
mšÜ
)

	)

226 
	#SCSC_HIP4_SAMPLER_INT
(
mšÜ
, 
id
)

	)

227 
	#SCSC_HIP4_SAMPLER_INT_BH
(
mšÜ
, 
id
)

	)

228 
	#SCSC_HIP4_SAMPLER_INT_OUT
(
mšÜ
, 
id
)

	)

229 
	#SCSC_HIP4_SAMPLER_INT_OUT_BH
(
mšÜ
, 
id
)

	)

230 
	#SCSC_HIP4_SAMPLER_RESET
(
mšÜ
)

	)

231 
	#SCSC_HIP4_SAMPLER_VIF_PEER
(
mšÜ
, 
tx
, 
vif
, 
³”_šdex
)

	)

232 
	#SCSC_HIP4_SAMPLER_BOT_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

233 
	#SCSC_HIP4_SAMPLER_BOT_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

234 
	#SCSC_HIP4_SAMPLER_BOT_ADD
(
mšÜ
, 
vif
, 
³”_šdex
, 
addr_0_to_3
)

	)

235 
	#SCSC_HIP4_SAMPLER_BOT_REMOVE
(
mšÜ
, 
vif
, 
³”_šdex
)

	)

236 
	#SCSC_HIP4_SAMPLER_BOT_START_Q
(
mšÜ
, 
vif
, 
³”_šdex
)

	)

237 
	#SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
mšÜ
, 
vif
, 
³”_šdex
)

	)

238 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

239 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

240 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_START
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
)

	)

241 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_STOP
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
)

	)

242 
	#SCSC_HIP4_SAMPLER_PKT_TX
(
mšÜ
, 
ho¡_g
)

	)

243 
	#SCSC_HIP4_SAMPLER_PKT_TX_HIP4
(
mšÜ
, 
ho¡_g
)

	)

244 
	#SCSC_HIP4_SAMPLER_PKT_TX_FB
(
mšÜ
, 
ho¡_g
)

	)

245 
	#SCSC_HIP4_SAMPLER_SUSPEND
(
mšÜ
)

	)

246 
	#SCSC_HIP4_SAMPLER_RESUME
(
mšÜ
)

	)

247 
	#SCSC_HIP4_SAMPLER_TCP_SYN
(
mšÜ
, 
id
, 
mss
)

	)

248 
	#SCSC_HIP4_SAMPLER_TCP_FIN
(
mšÜ
, 
id
)

	)

249 
	#SCSC_HIP4_SAMPLER_TCP_DATA
(
mšÜ
, 
id
, 
£q_num
)

	)

250 
	#SCSC_HIP4_SAMPLER_TCP_ACK
(
mšÜ
, 
id
, 
ack_num
)

	)

251 
	#SCSC_HIP4_SAMPLER_TCP_DATA_IN
(
mšÜ
, 
id
, 
£q_num
)

	)

252 
	#SCSC_HIP4_SAMPLER_TCP_ACK_IN
(
mšÜ
, 
id
, 
ack_num
)

	)

253 
	#SCSC_HIP4_SAMPLER_TCP_RWND
(
mšÜ
, 
id
, 
rwnd
)

	)

254 
	#SCSC_HIP4_SAMPLER_TCP_CWND
(
mšÜ
, 
id
, 
cwnd
)

	)

255 
	#SCSC_HIP4_SAMPLER_TCP_SEND_BUF
(
mšÜ
, 
id
, 
£nd_buff_size
)

	)

256 
	#SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
äame
, 
äom_ba
)

	)

260 
	#SCSC_HIP4_SAMPLER_HEADER_VERSION_MAJOR
 0x01

	)

261 
	#SCSC_HIP4_SAMPLER_HEADER_VERSION_MINOR
 0x01

	)

263 
	#SCSC_HIP4_SAMPLER_RESERVED
 (1)

	)

264 
	#SCSC_HIP4_SAMPLER_RESERVED_2
 (10)

	)

266 
	#SCSC_HIP4_SAMPLER_MAGIC
 "HIP4"

	)

268 
	escsc_h4_§m¶”_ty³
 {

269 
	mSCSC_HIP4_SAMPLER_TYPE_PRE_TCP
 = 0,

270 
	mSCSC_HIP4_SAMPLER_TYPE_TCP
,

274 
	escsc_h4_§m¶”_¶©fÜm
 {

275 
	mSCSC_HIP4_SAMPLER_EXYNOS9610
 = 1,

276 
	mSCSC_HIP4_SAMPLER_EXYNOS9630
,

277 
	mSCSC_HIP4_SAMPLER_EXYNOS7885
,

278 
	mSCSC_HIP4_SAMPLER_EXYNOS8825
,

280 
	mSCSC_HIP4_SAMPLER_UNDEF
 = 0xffff

284 
	sscsc_h4_§m¶”_h—d”
 {

285 
	mmagic
[4];

286 
u16
 
	moff£t_d©a
;

287 
u8
 
	mv”siÚ_majÜ
;

288 
u8
 
	mv”siÚ_mšÜ
;

289 
u16
 
	m¶©fÜm
;

290 
u8
 
	m§m¶e_ty³
;

291 
u8
 
	m»£rved
[
SCSC_HIP4_SAMPLER_RESERVED
];

292 
u16
 
	mh4_¡©us
;

293 
u64
 
	mnum_§m¶es
;

294 
u8
 
	m»£rved_2
[
SCSC_HIP4_SAMPLER_RESERVED_2
];

295 } 
	g__·cked
;

	@hip4_smapper.c

7 
	~<scsc/scsc_mx.h
>

8 
	~<scsc/scsc_miäam.h
>

9 
	~<scsc/scsc_logršg.h
>

10 
	~<lšux/¿‹lim™.h
>

12 
	~"debug.h
"

13 
	~"dev.h
"

14 
	~"h4.h
"

15 
	~"h4_sm­³r.h
"

17 
	#SMAPPER_GRANULARITY
 (4 * 1024)

	)

19 
h4_sm­³r_»fl_i¤
(
œq
, *
d©a
);

21 
	$h4_sm­³r_®loc_bªk
(
¦si_dev
 *
sdev
, 
h4_´iv
 *
´iv
, 
sm­³r_bªks
 
bªk_Çme
, 
u32
 
’Œy_size
, 
boŞ
 
is_Ïrge
)

23 
u16
 
i
;

24 
h4_sm­³r_bªk
 *
bªk
 = &(
´iv
)->
sm­³r_bªks
[
bªk_Çme
];

25 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
 = &(
´iv
)->
sm­³r_cÚŒŞ
;

26 
”r
;

28 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "In™ bªk %dƒÁry_siz%d is_Ïrg%d\n", 
bªk_Çme
, 
’Œy_size
, 
is_Ïrge
);

29 
bªk
->
’Œy_size
 =ƒntry_size;

32 
”r
 = 
	`scsc_£rviû_mifsm­³r_®loc_bªk
(
sdev
->
£rviû
, 
is_Ïrge
, 
bªk
->
’Œy_size
, &bªk->
’Œ›s
);

33 ià(
”r
 < 0) {

34 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "E¼Ü‡Îoÿtšg bªk %d\n", 
”r
);

35  -
ENOMEM
;

38 
bªk
->bªk = (
u32
)
”r
;

39 ià(
bªk
->bªk >ğ
HIP4_SMAPPER_TOTAL_BANKS
) {

40 
	`scsc_£rviû_mifsm­³r_ä“_bªk
(
sdev
->
£rviû
, 
bªk
->bank);

41 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "IncÜ»ù bªk_num %d\n", 
bªk
->bank);

42  -
ENOMEM
;

45 
bªk
->
skbuff
 = 
	`km®loc_¬¿y
(bªk->
’Œ›s
, (
sk_buff
 *),

46 
GFP_KERNEL
);

47 
bªk
->
skbuff_dma
 = 
	`km®loc_¬¿y
(bªk->
’Œ›s
, (
dma_addr_t
),

48 
GFP_KERNEL
);

49 ià(!
bªk
->
skbuff
 || !bªk->
skbuff_dma
) {

50 
	`kä“
(
bªk
->
skbuff_dma
);

51 
	`kä“
(
bªk
->
skbuff
);

52  -
ENOMEM
;

55 
i
 = 0; i < 
bªk
->
’Œ›s
; i++)

56 
bªk
->
skbuff
[
i
] = 
NULL
;

58 
bªk
->
®ign
 = 
	`scsc_£rviû_g‘_®ignm’t
(
sdev
->
£rviû
);

59 
bªk
->
š_u£
 = 
Œue
;

62 
cÚŒŞ
->
looku±abË
[
bªk
->bªk] = 
bªk_Çme
;

65 
	}
}

67 
	$h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
, 
idx
)

69 
sk_buff
 *
skb
;

70 
”r
;

72 
skb
 = 
	`®loc_skb
(
bªk
->
’Œy_size
, 
GFP_ATOMIC
);

73 ià(!
skb
) {

74 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Notƒnough memory\n");

75  -
ENOMEM
;

78 
	`¦si_skb_cb_š™
(
skb
);

79 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SKB‡Îoÿ‹d: 0x%°© bªk %dƒÁry %d\n", 
skb
, 
bªk
->bªk, 
idx
);

80 
bªk
->
skbuff_dma
[
idx
] = 
	`dma_m­_sšgË
(
sdev
->
dev
, 
skb
->
d©a
,

81 
bªk
->
’Œy_size
, 
DMA_FROM_DEVICE
);

82 
”r
 = 
	`dma_m­pšg_”rÜ
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
idx
]);

83 ià(
”r
) {

84 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "E¼Ü m­pšg SKB: 0x%°© bªk %dƒÁry %d\n", 
skb
, 
bªk
->bªk, 
idx
);

85 
	`kä“_skb
(
skb
);

86  
”r
;

90 ià(!
	`IS_ALIGNED
(
bªk
->
skbuff_dma
[
idx
], bªk->
®ign
)) {

91 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Phys‡ddress: 0x%x‚ot %d‡ligned. Unmap memory‡nd„eturnƒrror\n",

92 
bªk
->
skbuff_dma
[
idx
], bªk->
®ign
);

93 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
idx
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

94 
	`kä“_skb
(
skb
);

95 
bªk
->
skbuff_dma
[
idx
] = 0;

96  -
ENOMEM
;

98 
bªk
->
skbuff
[
idx
] = 
skb
;

100 
	}
}

103 
	$h4_sm­³r_®loÿ‹_skb_bufãrs
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
)

105 
i
;

106 
n
;

107 
»s
;

109 ià(!
bªk
)

110  -
EINVAL
;

112 
n
 = 
bªk
->
’Œ›s
;

113 
i
 = 0; i < 
n
; i++) {

114 ià(!
bªk
->
skbuff
[
i
]) {

115 
»s
 = 
	`h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
sdev
, 
bªk
, 
i
);

116 ià(
»s
 != 0)

117  
»s
;

122 
	}
}

124 
	$h4_sm­³r_ä“_skb_bufãrs
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
)

126 
i
;

127 
n
;

129 ià(!
bªk
)

130  -
EINVAL
;

132 
n
 = 
bªk
->
’Œ›s
;

133 
i
 = 0; i < 
n
; i++) {

134 ià(
bªk
->
skbuff
[
i
]) {

135 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SKB f»e: 0x%°© bªk %dƒÁry %d\n", 
bªk
->
skbuff
[
i
], bank->bank, i);

136 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
i
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

137 
bªk
->
skbuff_dma
[
i
] = 0;

138 
	`kä“_skb
(
bªk
->
skbuff
[
i
]);

139 
bªk
->
skbuff
[
i
] = 
NULL
;

144 
	}
}

146 
	$h4_sm­³r_´og¿m
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
)

148 
n
;

150 ià(!
bªk
)

151  -
EINVAL
;

153 
n
 = 
bªk
->
’Œ›s
;

155 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Prog¿mmšg Bªk %d\n", 
bªk
->bank);

157  
	`scsc_£rviû_mifsm­³r_wr™e_¤am
(
sdev
->
£rviû
, 
bªk
->bªk, 
n
, 0, bªk->
skbuff_dma
);

158 
	}
}

162 
	$h4_sm­³r_»fl_i¤
(
œq
, *
d©a
)

164 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

165 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

166 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

167 
h4_sm­³r_bªk
 *
bªk
;

168 
sm­³r_bªks
 
i
;

169 
æags
;

174 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

175 #ifdeà
CONFIG_SCSC_QOS


177 ià(
h
->
h_´iv
->
pm_qos_¡©e
 =ğ
SCSC_QOS_DISABLED
 ||

178 
	`©omic_»ad
(&
h
->
h_´iv
->
š_su¥’d
) ||

179 *
cÚŒŞ
->
mbox_±r
 == 0x0) {

182 ià(
	`©omic_»ad
(&
h
->
h_´iv
->
š_su¥’d
) ||

183 *
cÚŒŞ
->
mbox_±r
 == 0x0) {

191 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
cÚŒŞ
->
th_»q
);

195 
	`¥š_lock_œq§ve
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

197 ià(
	`HIP4_SMAPPER_BANKS_CHECK_CONFIGURE
(*
cÚŒŞ
->
mbox_±r
)) {

201 
	`scsc_£rviû_mifsm­³r_cÚfigu»
(
sdev
->
£rviû
, 
SMAPPER_GRANULARITY
);

202 
	`HIP4_SMAPPER_BANKS_CONFIGURE_DONE
(*
cÚŒŞ
->
mbox_±r
);

205 
i
 = 
RX_0
; i < 
END_RX_BANKS
; i++) {

206 
bªk
 = &
h
->
h_´iv
->
sm­³r_bªks
[
i
];

208 ià(!
bªk
->
š_u£
)

211 ià(
	`HIP4_SMAPPER_GET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
è=ğ
HIP_SMAPPER_OWNER_HOST
) {

215 ià(
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, 
bªk
)) {

219 
	`HIP4_SMAPPER_SET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_OWNER_FW
);

222 ià(
	`h4_sm­³r_´og¿m
(
sdev
, 
bªk
)) {

226 
	`HIP4_SMAPPER_SET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_OWNER_FW
);

229 
	`HIP4_SMAPPER_SET_BANK_STATE
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_STATUS_MAPPED
);

230 
	`HIP4_SMAPPER_SET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_OWNER_FW
);

234 
	`scsc_£rviû_mifšŒb™_b™_£t
(
sdev
->
£rviû
, 
cÚŒŞ
->
fh_šd
, 
SCSC_MIFINTR_TARGET_WLAN
);

237 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
cÚŒŞ
->
th_»q
);

239 
	`¥š_uÆock_œq»¡Üe
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

240 
	}
}

242 
	$h4_sm­³r_cÚsume_’Œy
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
)

244 
sk_buff
 *
skb
;

245 
sk_buff
 *
skb_big
 = 
NULL
;

246 
h4_sm­³r_bªk
 *
bªk
;

247 
u8
 
i
;

248 
u8
 
bªk_num
;

249 
u8
 
’Œy
;

250 
u8
 
num_’Œ›s
;

251 
u16
 
Ën
;

252 
u16
 
h—droom
;

253 
h4_sm­³r_desütÜ
 *
desc
;

254 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

255 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb_çpi
);

257 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

259 
desc
 = (
h4_sm­³r_desütÜ
 *)
skb_çpi
->
d©a
;

261 
bªk_num
 = 
desc
->bank_num;

262 
’Œy
 = 
desc
->
’Œy_num
;

263 
Ën
 = 
desc
->
’Œy_size
;

264 
h—droom
 = 
desc
->headroom;

267 ià(
bªk_num
 >ğ
HIP4_SMAPPER_TOTAL_BANKS
) {

268 
	`SLSI_WARN_NODEV
("IncÜ»ù bªk_num %d\n", 
bªk_num
);

269 
”rÜ
;

273 
bªk_num
 = 
cÚŒŞ
->
looku±abË
[bank_num];

275 
bªk
 = &
h
->
h_´iv
->
sm­³r_bªks
[
bªk_num
];

277 ià(
’Œy
 > 
bªk
->
’Œ›s
) {

278 
	`SLSI_WARN_NODEV
("IncÜ»ùƒÁry‚umb” %d\n", 
’Œy
);

279 
”rÜ
;

282 ià(
Ën
 > 
bªk
->
’Œy_size
) {

285 
num_’Œ›s
 = 
	`DIV_ROUND_UP
(
Ën
, 
bªk
->
’Œy_size
);

287 ià((
’Œy
 + 
num_’Œ›s
è> 
bªk
->
’Œ›s
) {

288 
	`SLSI_WARN_NODEV
("IncÜ»ùƒÁry‚umb” %d‚um_’Œ› %d\n", 
’Œy
, 
num_’Œ›s
);

289 
”rÜ
;

293 
skb_big
 = 
	`®loc_skb
(
Ën
, 
GFP_ATOMIC
);

294 ià(!
skb_big
) {

295 
	`SLSI_WARN_NODEV
("big SKB‡ÎoÿtiÚ faed†’:%d\n", 
Ën
);

296 
”rÜ
;

298 
muÉi
;

301 
skb
 = 
bªk
->
skbuff
[
’Œy
];

302 ià(!
skb
) {

303 
	`SLSI_WARN_NODEV
("SKB i NULL‡ˆbªk %dƒÁry %d\n", 
bªk_num
, 
’Œy
);

304 
”rÜ
;

307 
bªk
->
skbuff
[
’Œy
] = 
NULL
;

308 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
’Œy
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

309 
bªk
->
skbuff_dma
[
’Œy
] = 0;

311 
	`h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
sdev
, 
bªk
, 
’Œy
);

313 
	`skb_»£rve
(
skb
, 
h—droom
);

314 
	`skb_put
(
skb
, 
Ën
);

315 
cb
->
skb_addr
 = 
skb
;

316 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "CÚsumed Bªk %d EÁry %d L’ %d SKB sm­³r: 0x%p, SKB f­˜%p\n", 
bªk_num
, 
’Œy
, 
Ën
, 
skb
, 
skb_çpi
);

318 
muÉi
:

319 
i
 = 0; i < 
num_’Œ›s
; i++, 
’Œy
++) {

320 
u16
 
by‹s
;

322 
skb
 = 
bªk
->
skbuff
[
’Œy
];

323 ià(!
skb
) {

324 
	`SLSI_WARN_NODEV
("SKB IS NULL‡ˆbªk %dƒÁry %d\n", 
bªk_num
, 
’Œy
);

325 
”rÜ
;

328 
bªk
->
skbuff
[
’Œy
] = 
NULL
;

329 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
’Œy
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

330 
bªk
->
skbuff_dma
[
’Œy
] = 0;

332 
	`h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
sdev
, 
bªk
, 
’Œy
);

334 ià(
Ën
 > 
bªk
->
’Œy_size
)

335 
by‹s
 = 
bªk
->
’Œy_size
 - 
h—droom
;

337 
by‹s
 = 
Ën
;

340 ià(
i
 == 0)

341 
	`skb_»£rve
(
skb
, 
h—droom
);

344 
	`memıy
(
	`skb_put
(
skb_big
, 
by‹s
), 
skb
->
d©a
, bytes);

347 
	`kä“_skb
(
skb
);

348 
Ën
 -ğ
by‹s
;

350 
cb
->
skb_addr
 = 
skb_big
;

351 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "CÚsumed Bªk %d EÁry %d L’ %d SKB sm­³r: 0x%p, SKB f­˜%p\n", 
bªk_num
, 
’Œy
, 
Ën
, 
skb
, 
skb_çpi
);

353 
”rÜ
:

355 ià(
skb_big
)

356 
	`kä“_skb
(
skb_big
);

357  -
EIO
;

358 
	}
}

360 *
	$h4_sm­³r_g‘_skb_d©a
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
)

362 
sk_buff
 *
skb
;

363 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb_çpi
);

364 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

366 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

368 
skb
 = (
sk_buff
 *)
cb
->
skb_addr
;

370 ià(!
skb
) {

371 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "NULL SKB smapper\n");

372  
NULL
;

375 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "G‘ SKB sm­³r: 0x%p, SKB f­˜0x%p\n", 
skb
, 
skb_çpi
);

376  
skb
->
d©a
;

377 
	}
}

379 
sk_buff
 *
	$h4_sm­³r_g‘_skb
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
)

381 
sk_buff
 *
skb
;

382 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb_çpi
);

383 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

385 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

387 
skb
 = (
sk_buff
 *)
cb
->
skb_addr
;

389 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "G‘ SKB sm­³r: 0x%p, SKB f­˜0x%p\n", 
skb
, 
skb_çpi
);

390 
cb
->
ä“_ma_un™d©
 = 
Œue
;

391 
	`kä“_skb
(
skb_çpi
);

393  
skb
;

394 
	}
}

396 
	$h4_sm­³r_ä“_m­³d_skb
(
sk_buff
 *
skb
)

398 
¦si_skb_cb
 *
cb
;

400 ià(!
skb
)

403 
cb
 = (
¦si_skb_cb
 *)
skb
->cb;

405 ià(
cb
 && !cb->
ä“_ma_un™d©
 && cb->
skb_addr
) {

406 
	`kä“_skb
(
cb
->
skb_addr
);

407 
cb
->
skb_addr
 = 
NULL
;

409 
	}
}

411 
	$h4_sm­³r_š™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
)

413 
u8
 
i
;

414 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

416 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SMAPPER init\n");

418 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

420 
	`¥š_lock_š™
(&
cÚŒŞ
->
sm­³r_lock
);

422 ià(
	`dma_£t_mask_ªd_coh”’t
(
sdev
->
dev
, 
	`DMA_BIT_MASK
(64)) != 0)

423  -
EIO
;

425 ià(!
	`scsc_mx_£rviû_®loc_mboxes
(
sdev
->
£rviû
, 1, &
cÚŒŞ
->
mbox_scb
)) {

426 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Unableo‡llocate mbox\n");

427  -
ENODEV
;

431 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_0
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

432 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_1
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

433 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_2
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

434 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_3
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

436 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_0
]);

437 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_1
]);

438 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_2
]);

439 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_3
]);

442 
cÚŒŞ
->
th_»q
 =

443 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
sdev
->
£rviû
, 
h4_sm­³r_»fl_i¤
, 
h
, 
SCSC_MIFINTR_TARGET_WLAN
);

444 
cÚŒŞ
->
fh_šd
 =

445 
	`scsc_£rviû_mifšŒb™_®loc_äomho¡
(
sdev
->
£rviû
, 
SCSC_MIFINTR_TARGET_WLAN
);

447 
cÚŒŞ
->
mbox_±r
 =

448 
	`scsc_mx_£rviû_g‘_mbox_±r
(
sdev
->
£rviû
, 
cÚŒŞ
->
mbox_scb
);

451 *
cÚŒŞ
->
mbox_±r
 = 0x0;

454 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_th_»q
 =

455 
cÚŒŞ
->
th_»q
;

456 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_fh_šd
 =

457 
cÚŒŞ
->
fh_šd
;

458 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_mbox_scb
 =

459 (
u8
)
cÚŒŞ
->
mbox_scb
;

461 
i
 = 
RX_0
; i < 
END_RX_BANKS
; i++) {

462 
u8
 
has_’Œ›s
;

463 
u8
 
bªk
;

465 
has_’Œ›s
 = 
h
->
h_´iv
->
sm­³r_bªks
[
i
].
’Œ›s
;

466 ià(
has_’Œ›s
) {

468 
bªk
 = 
h
->
h_´iv
->
sm­³r_bªks
[
i
].bank;

469 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_bªk_addr
[
bªk
] = 
	`scsc_£rviû_mifsm­³r_g‘_bªk_ba£_add»ss
(
sdev
->
£rviû
, bank);

470 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_’Œ›s_bªks
[
bªk
] = 
has_’Œ›s
;

471 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_pow_sz
[
bªk
] = 12;

475 
	}
}

477 
	$h4_sm­³r_deš™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
)

479 
h4_sm­³r_bªk
 *
bªk
;

480 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

481 
æags
;

482 
u8
 
i
;

484 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SMAPPER deinit\n");

485 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

487 
	`¥š_lock_œq§ve
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

488 
i
 = 
RX_0
; i < 
END_RX_BANKS
; i++) {

489 
bªk
 = &
h
->
h_´iv
->
sm­³r_bªks
[
i
];

490 
bªk
->
š_u£
 = 
çl£
;

491 
	`h4_sm­³r_ä“_skb_bufãrs
(
sdev
, 
bªk
);

492 
	`kä“
(
bªk
->
skbuff_dma
);

493 
	`kä“
(
bªk
->
skbuff
);

494 
	`scsc_£rviû_mifsm­³r_ä“_bªk
(
sdev
->
£rviû
, 
bªk
->bank);

496 
	`¥š_uÆock_œq»¡Üe
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

498 
	`scsc_£rviû_mifšŒb™_uÄegi¡”_toho¡
(
sdev
->
£rviû
, 
cÚŒŞ
->
th_»q
, 
SCSC_MIFINTR_TARGET_WLAN
);

499 
	`scsc_£rviû_mifšŒb™_ä“_äomho¡
(
sdev
->
£rviû
, 
cÚŒŞ
->
fh_šd
, 
SCSC_MIFINTR_TARGET_WLAN
);

500 
	`scsc_£rviû_ä“_mboxes
(
sdev
->
£rviû
, 1, 
cÚŒŞ
->
mbox_scb
);

502 
	}
}

	@hip4_smapper.h

7 #iâdeà
__HIP4_SMAPPER_H__


8 
	#__HIP4_SMAPPER_H__


	)

10 
	g¦si_dev
;

11 
	g¦si_h4
;

13 
	esm­³r_ty³
 {

14 
	mTX_5G
,

15 
	mTX_2G
,

16 
	mRX


19 
	#HIP4_SMAPPER_TOTAL_BANKS
 10

	)

21 
	#HIP4_SMAPPER_BANK_SMALL
 
çl£


	)

22 
	#HIP4_SMAPPER_BANK_LARGE
 
Œue


	)

24 
	#HIP_SMAPPER_OWNER_FW
 0

	)

25 
	#HIP_SMAPPER_OWNER_HOST
 1

	)

27 
	#HIP_SMAPPER_STATUS_REFILL
 0

	)

28 
	#HIP_SMAPPER_STATUS_MAPPED
 1

	)

30 
	#HIP4_SMAPPER_OTHER_CPU
 0

	)

31 
	#HIP4_SMAPPER_OWN_CPU
 1

	)

33 
	#HIP4_SMAPPER_STATE_OUT
 0

	)

34 
	#HIP4_SMAPPER_STATE_WANT
 1

	)

35 
	#HIP4_SMAPPER_STATE_CLAIM
 2

	)

37 
	#HIP4_SMAPPER_BANKS_CHECK_CONFIGURE
(
»g
è((Ôegè>> 30è=ğ0 ? 1 : 0)

	)

38 
	#HIP4_SMAPPER_BANKS_CONFIGURE_DONE
(
»g
è(ÔegèğÔegè| 0xc0000000)

	)

40 
	#HIP4_SMAPPER_GET_BANK_STATE
(
b
, 
»g
è(((0x1 << ((bè* 2)è& (»g)è> 0 ? 1 : 0)

	)

41 
	#HIP4_SMAPPER_GET_BANK_OWNER
(
b
, 
»g
è(((0x2 << ((bè* 2)è& (»g)è> 0 ? 1 : 0)

	)

43 
	#HIP4_SMAPPER_SET_BANK_STATE
(
b
, 
»g
, 
v®
) ((reg) = ((reg) & ~(0x1 << ((b) * 2))) | \

44 ((
v®
è<< ((
b
è* 2)))

	)

45 
	#HIP4_SMAPPER_SET_BANK_OWNER
(
b
, 
»g
, 
v®
) ((reg) = (reg & ~(0x2 << ((b) * 2))) | \

46 (((
v®
è<< 1è<< ((
b
è* 2)))

	)

49 
	sh4_sm­³r_desütÜ
 {

50 
u8
 
	mbªk_num
;

51 
u8
 
	m’Œy_num
;

52 
u16
 
	m’Œy_size
;

53 
u16
 
	mh—droom
;

58 
	esm­³r_bªks
 {

59 
	mRX_0
,

60 
	mRX_1
,

61 
	mRX_2
,

62 
	mRX_3
,

63 
	mEND_RX_BANKS


66 
	sh4_sm­³r_cÚŒŞ
 {

67 
u32
 
	memul_loc
;

68 
u32
 
	memul_sz
;

69 
u8
 
	mth_»q
;

70 
u8
 
	mfh_šd
;

71 
u32
 
	mmbox_scb
;

72 
u32
 *
	mmbox_±r
;

73 
¥šlock_t
 
	msm­³r_lock
;

76 
u8
 
	mlooku±abË
[
HIP4_SMAPPER_TOTAL_BANKS
];

79 
	sh4_sm­³r_bªk
 {

80 
sm­³r_ty³
 
	mty³
;

81 
u16
 
	m’Œ›s
;

82 
boŞ
 
	mš_u£
;

83 
u8
 
	mbªk
;

84 
u8
 
	mcur
;

85 
u32
 
	m’Œy_size
;

86 
sk_buff
 **
	mskbuff
;

87 
dma_addr_t
 *
	mskbuff_dma
;

88 
h4_sm­³r_cÚŒŞ_’Œy
 *
	m’Œy
;

89 
u16
 
	m®ign
;

92 
h4_sm­³r_š™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
);

93 
h4_sm­³r_deš™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
);

95 
mbulk
 *
h4_sm­³r_£nd
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, *
v®
);

96 
h4_sm­³r_cÚsume_’Œy
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
);

97 *
h4_sm­³r_g‘_skb_d©a
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
);

98 
sk_buff
 *
h4_sm­³r_g‘_skb
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, sk_bufà*
skb_çpi
);

99 
h4_sm­³r_ä“_m­³d_skb
(
sk_buff
 *
skb
);

	@hip_bh.h

7 #iâdeà
__SLSI_HIP_BH_H__


8 
	#__SLSI_HIP_BH_H__


	)

10 
	~"wl_»suÉ.h
"

12 
C¤ResuÉ
 
¦si_sdio_func_drv_»gi¡”
();

13 
¦si_sdio_func_drv_uÄegi¡”
();

	@ini_config.c

6 
	~<lšux/fœmw¬e.h
>

8 
	~"dev.h
"

9 
	~"uts.h
"

10 
	~"debug.h
"

11 
	~"mib.h
"

12 
	~"mlme.h
"

14 
	#SLSI_INI_CONFIG_BUFF_SIZE
 1024

	)

15 
	#SET_HIGHEST_BYTE
 -1

	)

16 
	#SLSI_INI_KEY_LEN_MAX
 1000

	)

17 
	#SLSI_INI_TRY_FALLBACK
 1

	)

19 #ià(
KERNEL_VERSION
(5, 4, 0è> 
LINUX_VERSION_CODE
)

20 
	#INI_CONFIG_FILE_PATH
 "/v’dÜ/fœmw¬e/wÏn-cÚÃùiÚ-rßmšg.ši"

	)

21 
	#INI_CONFIG_FILE_BACKUP_PATH
 "/v’dÜ/fœmw¬e/wÏn-cÚÃùiÚ-rßmšg-backup.ši"

	)

23 
	#INI_CONFIG_FILE_PATH
 "../fœmw¬e/wÏn-cÚÃùiÚ-rßmšg.ši"

	)

24 
	#INI_CONFIG_FILE_BACKUP_PATH
 "../fœmw¬e/wÏn-cÚÃùiÚ-rßmšg-backup.ši"

	)

27 
	sši_lookup
 {

28 cÚ¡ *
	mkey
;

29 (*
	mfunc_p
)(
¦si_dev
 *
	msdev
, 
u8
 *
	mbuf
, 
u16
 *
	mpos
, u8 *
	mv®ue
, 
ši_lookup
 *
	mlookup_’Œy
);

30 
u16
 
	mpsid
;

31 
s8
 
	mšdex
;

32 
	mun™_cÚ_çùÜ
;

33 
	mmš_v®ue
;

34 
	mmax_v®ue
;

37 
	$log_çed_psids
(
¦si_dev
 *
sdev
, 
u8
 *
mib_bufãr
, 
mib_bufãr_Ën
)

39 
size_t
 
mib_decode_»suÉ
 = 0;

40 
size_t
 
off£t
 = 0;

41 
¦si_mib_’Œy
 
decoded_mib_v®ue
 = {0};

42 
¦si_mib_d©a
 
mibd©a
 = {0};

44 
	`FUNC_ENTER
(
sdev
);

45 
	`SLSI_ERR
(
sdev
, "MIB bufã¸Ëngth: %u. MIB E¼Ü (decoded)\n", 
mib_bufãr_Ën
);

47 ià(!
mib_bufãr
) {

48 
	`SLSI_ERR
(
sdev
, "MIB buffer…ointer is NULL - can‚ot decode MIB keys\n");

52 
	`SLSI_ERR
(
sdev
, "failed mibs:\n");

54 
off£t
 < 
mib_bufãr_Ën
) {

55 
mibd©a
.
d©a
 = &
mib_bufãr
[
off£t
];

56 
mibd©a
.
d©aL’gth
 = 
mib_bufãr_Ën
 - 
off£t
;

58 
mib_decode_»suÉ
 = 
	`¦si_mib_decode
(&
mibd©a
, &
decoded_mib_v®ue
);

59 ià(!
mib_decode_»suÉ
) {

60 
	`SLSI_ERR_HEX
(
sdev
, 
mibd©a
.
d©a
, mibd©a.
d©aL’gth
, "slsi_mib_decode() Failedo Decode:\n");

64 
off£t
 +ğ
mib_decode_»suÉ
;

65 
	`SLSI_ERR
(
sdev
, "%d\n", ()(
decoded_mib_v®ue
.
psid
));

68 
	`SLSI_ERR
(
sdev
, "\n");

69 
	`FUNC_EXIT
(
sdev
);

70 
	}
}

72 
	$£t_mibs
(
¦si_dev
 *
sdev
)

74 
sk_buff
 *
cfm
 = 
NULL
;

76 ià(
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff_pos
 == 0)

79 
cfm
 = 
	`¦si_mlme_£t_w™h_cfm
(
sdev
, 
NULL
, sdev->
ši_cÚf_¡ruù
.
ši_cÚf_buff
,

80 
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff_pos
 + 1);

82 ià(
	`çpi_g‘_d©®’
(
cfm
)) {

83 
	`SLSI_ERR
(
sdev
, "Err Setting MIB failed.\n");

84 
	`log_çed_psids
(
sdev
, 
	`çpi_g‘_d©a
(
cfm
), 
	`çpi_g‘_d©®’
(cfm));

86 
	`SLSI_INFO
(
sdev
, "setting MIB successfully\n");

89 
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff_pos
 = 0;

90 
	`kä“_skb
(
cfm
);

91 
	}
}

93 
	$­³nd_mibd©a_to_bufãr
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
mib
, 
mib_Ën
)

95 ià(((*
pos
 + 
mib_Ën
è> (
SLSI_INI_CONFIG_BUFF_SIZE
 - 1)) && *pos > 0)

96 
	`£t_mibs
(
sdev
);

98 
	`memıy
(
buf
 + (*
pos
), 
mib
, 
mib_Ën
);

99 *
pos
 +ğ
mib_Ën
;

100 
	}
}

102 
	$’code_št_mib
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

103 
ši_lookup
 *
lookup_’Œy
, 
boŞ
 
is_sigÃd
)

105 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

106 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

107 
u32
 
v®ue_ušt
 = 0;

108 
s32
 
v®ue_sšt
 = 0;

109 
»s
 = 0;

110 
šdex
 = 0;

112 
»s
 = 
	`¦si_¡r_to_št
(
v®ue
, 
is_sigÃd
 ? &
v®ue_sšt
 : (*)&
v®ue_ušt
);

113 ià(!
»s
) {

114 
	`SLSI_ERR_NODEV
("key_v® i šv®id fÜ key %s\n", 
lookup_’Œy
->
key
);

115  -
EINVAL
;

118 ià(
lookup_’Œy
->
šdex
 > 0)

119 
šdex
 = 
lookup_’Œy
->index;

121 ià(
is_sigÃd
) {

122 
v®ue_sšt
 *ğ
lookup_’Œy
->
un™_cÚ_çùÜ
;

123 ià(
	`¦si_mib_’code_št
(&
mib_d©a
, 
lookup_’Œy
->
psid
,

124 
v®ue_sšt
, 
šdex
è!ğ
SLSI_MIB_STATUS_SUCCESS
) {

125 
	`SLSI_ERR_NODEV
("Failedoƒncode mib with key = %s‡nd…sid = %d\n",

126 
lookup_’Œy
->
key
,†ookup_’Œy->
psid
);

127  
”rÜ
;

130 
v®ue_ušt
 *ğ
lookup_’Œy
->
un™_cÚ_çùÜ
;

131 ià(
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
lookup_’Œy
->
psid
,

132 
v®ue_ušt
, 
šdex
è!ğ
SLSI_MIB_STATUS_SUCCESS
) {

133 
	`SLSI_ERR_NODEV
("Failedoƒncode mib with key = %s‡nd…sid = %d\n",

134 
lookup_’Œy
->
key
,†ookup_’Œy->
psid
);

135  
”rÜ
;

139 ià(!
mib_d©a
.
d©aL’gth
) {

140 
	`SLSI_ERR_NODEV
("Failedoƒncode mib with key = %s‡nd…sid = %d\n",

141 
lookup_’Œy
->
key
,†ookup_’Œy->
psid
);

142  
”rÜ
;

145 
	`­³nd_mibd©a_to_bufãr
(
sdev
, 
buf
, 
pos
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

147 
	`kä“
(
mib_d©a
.
d©a
);

150 
	}
}

152 
	$’code_ušt_mib
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

153 
ši_lookup
 *
lookup_’Œy
)

155  
	`’code_št_mib
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
, 
çl£
);

156 
	}
}

158 
	$’code_sšt_mib
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

159 
ši_lookup
 *
lookup_’Œy
)

161  
	`’code_št_mib
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
, 
Œue
);

162 
	}
}

164 
	$’code_mib_g’_w™h_two_psids
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, 
s8
 
šdex1
, s8 
šdex2
,

165 
u16
 
psid1
, u16 
psid2
, 
u32
 
v®ue_št
)

167 
¦si_mib_d©a
 
mib_d©a1
 = { 0, 
NULL
 };

168 
¦si_mib_d©a
 
mib_d©a2
 = { 0, 
NULL
 };

169 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

171 ià(
	`¦si_mib_’code_ušt
(&
mib_d©a1
, 
psid1
, 
v®ue_št
, 
šdex1
è!ğ
SLSI_MIB_STATUS_SUCCESS
) {

172 
	`SLSI_ERR_NODEV
("FaedØ’codmib w™h…sid = %d\n", 
psid1
);

173  
”rÜ
;

176 ià(!
mib_d©a1
.
d©aL’gth
) {

177 
	`SLSI_ERR_NODEV
("FaedØ’codmib w™h…sid = %d\n", 
psid1
);

178  
”rÜ
;

181 ià(
	`¦si_mib_’code_ušt
(&
mib_d©a2
, 
psid2
, 
v®ue_št
, 
šdex2
è!ğ
SLSI_MIB_STATUS_SUCCESS
) {

182 
	`SLSI_ERR_NODEV
("FaedØ’codmib w™h…sid = %d\n", 
psid2
);

183 
ex™_w™h_”r1
;

186 ià(!
mib_d©a2
.
d©aL’gth
) {

187 
	`SLSI_ERR_NODEV
("FaedØ’codmib w™h…sid = %d\n", 
psid2
);

188 
ex™_w™h_”r1
;

191 
	`­³nd_mibd©a_to_bufãr
(
sdev
, 
buf
, 
pos
, 
mib_d©a2
.
d©a
, mib_d©a2.
d©aL’gth
);

193 
	`­³nd_mibd©a_to_bufãr
(
sdev
, 
buf
, 
pos
, 
mib_d©a1
.
d©a
, mib_d©a1.
d©aL’gth
);

195 
	`kä“
(
mib_d©a2
.
d©a
);

197 
ex™_w™h_”r1
:

198 
	`kä“
(
mib_d©a1
.
d©a
);

200 
	}
}

202 
	$’code_mib_cÚ_dtim_skpšg_numb”
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

203 
ši_lookup
 *
lookup_’Œy
)

205 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

206 
u32
 
v®ue_št
 = 0;

207 
»s
 = 0;

208 
šdex
 = 0;

210 
»s
 = 
	`¦si_¡r_to_št
(
v®ue
, &
v®ue_št
);

211 ià(!
»s
) {

212 
	`SLSI_ERR_NODEV
("key_v® i šv®id fÜ key %s\n", 
lookup_’Œy
->
key
);

213  -
EINVAL
;

216 ià(
lookup_’Œy
->
šdex
 > 0)

217 
šdex
 = 
lookup_’Œy
->index;

219 
v®ue_št
 *ğ
lookup_’Œy
->
un™_cÚ_çùÜ
;

221 
”rÜ
 = 
	`’code_mib_g’_w™h_two_psids
(
sdev
, 
buf
, 
pos
, 
šdex
, index, 
lookup_’Œy
->
psid
,

222 
SLSI_PSID_UNIFI_IDLEMODE_LISTEN_INTERVAL_SKIPPING_DTIM
,

223 
v®ue_št
);

225  
”rÜ
;

226 
	}
}

228 
	$’code_mib_rßmcu_Œig
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

229 
ši_lookup
 *
lookup_’Œy
)

231 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

232 
u32
 
v®ue_št
 = 0;

233 
»s
 = 0;

235 
»s
 = 
	`¦si_¡r_to_št
(
v®ue
, &
v®ue_št
);

236 ià(!
»s
) {

237 
	`SLSI_ERR_NODEV
("key_v® i šv®id fÜ key %s\n", 
lookup_’Œy
->
key
);

238  -
EINVAL
;

241 
v®ue_št
 *ğ
lookup_’Œy
->
un™_cÚ_çùÜ
;

243 
”rÜ
 = 
	`’code_mib_g’_w™h_two_psids
(
sdev
, 
buf
, 
pos
, 1, 2, 
lookup_’Œy
->
psid
,

244 
lookup_’Œy
->
psid
, 
v®ue_št
);

246  
”rÜ
;

247 
	}
}

249 
	$’code_mib_où‘_w™h_2šdiûs
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
, 
s8
 
šdex1
, s8 
šdex2
,

250 
s8
 
où‘_šdex
, 
u16
 
psid
, 
un™_cÚ_çùÜ
)

252 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

253 
¦si_mib_d©a
 
mib_v®_£t
 = { 0, 
NULL
 };

254 
¦si_mib_d©a
 
mib_v®_loÿl
 = {0, 
NULL
};

255 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

256 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
psid
, { 
šdex1
, 
šdex2
 }}};

257 
u32
 
v®ue_št
 = 0;

258 
»s
 = 0;

259 
¦si_mib_’Œy
 
v
 = {0};

261 ià(!
v®ue
) {

262 
	`SLSI_ERR_NODEV
("value…ointso‚ull\n");

265 
»s
 = 
	`¦si_¡r_to_št
(
v®ue
, &
v®ue_št
);

266 ià(!
»s
) {

267 
	`SLSI_ERR_NODEV
("key_v® i šv®id fÜ…sid:%d\n", 
psid
);

268  -
EINVAL
;

271 
v®ue_št
 *ğ
un™_cÚ_çùÜ
;

273 
mibr¥
.
d©aL’gth
 = 15;

274 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

275 ià(!
mibr¥
.
d©a
) {

276 
	`SLSI_ERR_NODEV
("CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

277  -
ENOMEM
;

280 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, 1, &
mibr¥
);

282 ià(!
v®ues
) {

283 
	`SLSI_ERR_NODEV
("values in„eturn from„ead_mibs is‚ull\n");

284 
ex™_w™h_mibr¥
;

287 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
) {

288 
	`SLSI_ERR_NODEV
("šv®id miby³ fÜ…sid:%d\n", 
psid
);

289 
ex™_w™h_v®ue
;

292 ià(!(
v®ues
[0].
u
.
où‘V®ue
.
d©a
)) {

293 
	`SLSI_ERR_NODEV
("values[0].u.octetValue.data in„ead_mibs is‚ull\n");

294 
ex™_w™h_v®ue
;

298 
mib_v®_loÿl
.
d©aL’gth
 = 
v®ues
[0].
u
.
où‘V®ue
.dataLength;

299 
mib_v®_loÿl
.
d©a
 = 
v®ues
[0].
u
.
où‘V®ue
.data;

301 ià(
où‘_šdex
 < 0)

302 
où‘_šdex
 = 
mib_v®_loÿl
.
d©aL’gth
 - 1;

304 ià(
où‘_šdex
 > 
mib_v®_loÿl
.
d©aL’gth
 - 1)

305 
ex™_w™h_v®ue
;

307 
mib_v®_loÿl
.
d©a
[
où‘_šdex
] &ğ
v®ue_št
 & 0xFF;

309 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

310 
v
.
psid
 =…sid;

311 
v
.
šdex
[0] = 
šdex1
;

312 
v
.
šdex
[1] = 
šdex2
;

313 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_OCTET
;

314 
v
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
 = (
u32
)
mib_v®_loÿl
.dataLength;

315 
v
.
v®ue
.
u
.
où‘V®ue
.
d©a
 = (
u8
 *)
mib_v®_loÿl
.data;

317 ià(
	`¦si_mib_’code
(&
mib_v®_£t
, &
v
è!ğ
SLSI_MIB_STATUS_SUCCESS
) {

318 
	`SLSI_ERR_NODEV
("FaedØ’codmib w™h…sid = %d\n", 
psid
);

319 
ex™_w™h_v®ue
;

322 ià(!
mib_v®_£t
.
d©aL’gth
) {

323 
	`SLSI_ERR_NODEV
("FaedØ’codmib w™h…sid = %d\n", 
psid
);

324 
ex™_w™h_v®ue
;

327 
	`­³nd_mibd©a_to_bufãr
(
sdev
, 
buf
, 
pos
, 
mib_v®_£t
.
d©a
, mib_v®_£t.
d©aL’gth
);

329 
	`kä“
(
mib_v®_£t
.
d©a
);

331 
ex™_w™h_v®ue
:

332 
	`kä“
(
v®ues
);

333 
ex™_w™h_mibr¥
:

334 
	`kä“
(
mibr¥
.
d©a
);

336 
	}
}

338 
	$’code_mib_bªd1_rssi_çùÜ_v®ue1
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

339 
ši_lookup
 *
lookup_’Œy
)

341 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

343 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 1, 
SET_HIGHEST_BYTE
,

344 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

345 ià(
”rÜ
)

346 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

348  
”rÜ
;

349 
	}
}

351 
	$’code_mib_bªd1_rssi_çùÜ_v®ue2
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

352 
ši_lookup
 *
lookup_’Œy
)

354 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

356 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 2, 
SET_HIGHEST_BYTE
,

357 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

358 ià(
”rÜ
)

359 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

361  
”rÜ
;

362 
	}
}

364 
	$’code_mib_bªd1_rssi_çùÜ_v®ue3
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

365 
ši_lookup
 *
lookup_’Œy
)

367 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

369 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 3, 
SET_HIGHEST_BYTE
,

370 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

371 ià(
”rÜ
)

372 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

374  
”rÜ
;

375 
	}
}

377 
	$’code_mib_bªd1_rssi_çùÜ_v®ue4
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

378 
ši_lookup
 *
lookup_’Œy
)

380 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

382 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 4, 
SET_HIGHEST_BYTE
,

383 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

384 ià(
”rÜ
)

385 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

387  
”rÜ
;

388 
	}
}

390 
	$’code_mib_bªd1_rssi_çùÜ_v®ue5
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

391 
ši_lookup
 *
lookup_’Œy
)

393 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

395 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 5, 
SET_HIGHEST_BYTE
,

396 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

397 ià(
”rÜ
)

398 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

400  
”rÜ
;

401 
	}
}

403 
	$’code_mib_bªd1_rssi_çùÜ_scÜe1
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

404 
ši_lookup
 *
lookup_’Œy
)

406 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

408 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 1, 0,

409 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

410 ià(
”rÜ
)

411 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

413  
”rÜ
;

414 
	}
}

416 
	$’code_mib_bªd1_rssi_çùÜ_scÜe2
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

417 
ši_lookup
 *
lookup_’Œy
)

419 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

421 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 2, 0,

422 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

423 ià(
”rÜ
)

424 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

426  
”rÜ
;

427 
	}
}

429 
	$’code_mib_bªd1_rssi_çùÜ_scÜe3
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

430 
ši_lookup
 *
lookup_’Œy
)

432 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

434 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 3, 0,

435 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

436 ià(
”rÜ
)

437 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

439  
”rÜ
;

440 
	}
}

442 
	$’code_mib_bªd1_rssi_çùÜ_scÜe4
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

443 
ši_lookup
 *
lookup_’Œy
)

445 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

447 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 4, 0,

448 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

449 ià(
”rÜ
)

450 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

452  
”rÜ
;

453 
	}
}

455 
	$’code_mib_bªd1_rssi_çùÜ_scÜe5
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

456 
ši_lookup
 *
lookup_’Œy
)

458 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

460 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 5, 0,

461 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

462 ià(
”rÜ
)

463 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

465  
”rÜ
;

466 
	}
}

468 
	$’code_mib_bªd2_rssi_çùÜ_v®ue1
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

469 
ši_lookup
 *
lookup_’Œy
)

471 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

473 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 1, 
SET_HIGHEST_BYTE
,

474 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

475 ià(
”rÜ
)

476 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

478  
”rÜ
;

479 
	}
}

481 
	$’code_mib_bªd2_rssi_çùÜ_v®ue2
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

482 
ši_lookup
 *
lookup_’Œy
)

484 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

486 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 2, 
SET_HIGHEST_BYTE
,

487 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

488 ià(
”rÜ
)

489 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

491  
”rÜ
;

492 
	}
}

494 
	$’code_mib_bªd2_rssi_çùÜ_v®ue3
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

495 
ši_lookup
 *
lookup_’Œy
)

497 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

499 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 3, 
SET_HIGHEST_BYTE
,

500 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

501 ià(
”rÜ
)

502 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

504  
”rÜ
;

505 
	}
}

507 
	$’code_mib_bªd2_rssi_çùÜ_v®ue4
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

508 
ši_lookup
 *
lookup_’Œy
)

510 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

512 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 4, 
SET_HIGHEST_BYTE
,

513 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

514 ià(
”rÜ
)

515 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

517  
”rÜ
;

518 
	}
}

520 
	$’code_mib_bªd2_rssi_çùÜ_v®ue5
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

521 
ši_lookup
 *
lookup_’Œy
)

523 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

525 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 5, 
SET_HIGHEST_BYTE
,

526 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

527 ià(
”rÜ
)

528 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

530  
”rÜ
;

531 
	}
}

533 
	$’code_mib_bªd2_rssi_çùÜ_scÜe1
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

534 
ši_lookup
 *
lookup_’Œy
)

536 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

538 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 1, 0,

539 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

540 ià(
”rÜ
)

541 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

543  
”rÜ
;

544 
	}
}

546 
	$’code_mib_bªd2_rssi_çùÜ_scÜe2
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

547 
ši_lookup
 *
lookup_’Œy
)

549 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

551 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 2, 0,

552 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

553 ià(
”rÜ
)

554 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

556  
”rÜ
;

557 
	}
}

559 
	$’code_mib_bªd2_rssi_çùÜ_scÜe3
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

560 
ši_lookup
 *
lookup_’Œy
)

562 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

564 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 3, 0,

565 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

566 ià(
”rÜ
)

567 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

569  
”rÜ
;

570 
	}
}

572 
	$’code_mib_bªd2_rssi_çùÜ_scÜe4
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

573 
ši_lookup
 *
lookup_’Œy
)

575 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

577 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 4, 0,

578 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

579 ià(
”rÜ
)

580 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

582  
”rÜ
;

583 
	}
}

585 
	$’code_mib_bªd2_rssi_çùÜ_scÜe5
(
¦si_dev
 *
sdev
, 
u8
 *
buf
, 
u16
 *
pos
, u8 *
v®ue
,

586 
ši_lookup
 *
lookup_’Œy
)

588 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

590 
”rÜ
 = 
	`’code_mib_où‘_w™h_2šdiûs
(
sdev
, 
buf
, 
pos
, 
v®ue
, 
lookup_’Œy
->
šdex
, 5, 0,

591 
lookup_’Œy
->
psid
,†ookup_’Œy->
un™_cÚ_çùÜ
);

592 ià(
”rÜ
)

593 
	`SLSI_ERR_NODEV
("E¼ S‘tšg MIB % çed.ƒ¼Ü = %d\n", 
lookup_’Œy
->
key
, 
”rÜ
);

595  
”rÜ
;

596 
	}
}

598 
ši_lookup
 
	g¦si_ši_cÚfig_lookup_bË
[] = {

599 {.
key
 = "RßmCommÚ_MšRßmD‘Ï", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2322, .
	gšdex
 = -1,

600 .
	gun™_cÚ_çùÜ
 = 100, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

601 {.
	gkey
 = "RßmCommÚ_D–", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2302, .
	gšdex
 = -1,

602 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 30},

603 {.
	gkey
 = "RßmSÿn_Fœ¡Tim”", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2058, .
	gšdex
 = -1,

604 .
	gun™_cÚ_çùÜ
 = 1000000, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

605 {.
	gkey
 = "RßmSÿn_SecÚdTim”", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2052, .
	gšdex
 = -1,

606 .
	gun™_cÚ_çùÜ
 = 1000000, .
	gmš_v®ue
 = 60, .
	gmax_v®ue
 = 100},

607 {.
	gkey
 = "RßmSÿn_IÇùiveTim”", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2059, .
	gšdex
 = -1,

608 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

609 {.
	gkey
 = "RßmSÿn_IÇùiveCouÁ", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2319, .
	gšdex
 = -1,

610 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

611 {.
	gkey
 = "RßmSÿn_S‹pRSSI", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2062, .
	gšdex
 = -1,

612 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

613 {.
	gkey
 = "RßmRSSI_Trigg”", .
	gfunc_p
 = 
’code_sšt_mib
, .
	gpsid
 = 2050, .
	gšdex
 = -1,

614 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

615 {.
	gkey
 = "RßmCU_Trigg”", .
	gfunc_p
 = 
’code_mib_rßmcu_Œig
, .
	gpsid
 = 2308, .
	gšdex
 = 1,

616 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 60, .
	gmax_v®ue
 = 90},

617 {.
	gkey
 = "RßmCU_MÚ™ÜTime", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2311, .
	gšdex
 = -1,

618 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

619 {.
	gkey
 = "RßmCU_24GRSSIRªge", .
	gfunc_p
 = 
’code_sšt_mib
, .
	gpsid
 = 2307, .
	gšdex
 = 1,

620 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -70, .
	gmax_v®ue
 = -50},

621 {.
	gkey
 = "RßmCU_5GRSSIRªge", .
	gfunc_p
 = 
’code_sšt_mib
, .
	gpsid
 = 2307, .
	gšdex
 = 2,

622 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -70, .
	gmax_v®ue
 = -50},

623 {.
	gkey
 = "RßmIdË_Trigg”Bªd", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2073, .
	gšdex
 = -1,

624 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 3},

625 {.
	gkey
 = "RßmIdË_IÇùiveTime", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2066, .
	gšdex
 = -1,

626 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

627 {.
	gkey
 = "RßmIdË_MšRSSI", .
	gfunc_p
 = 
’code_sšt_mib
, .
	gpsid
 = 2064, .
	gšdex
 = -1,

628 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -70, .
	gmax_v®ue
 = -50},

629 {.
	gkey
 = "RßmIdË_RSSIV¬ŸtiÚ", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2063, .
	gšdex
 = -1,

630 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 10},

631 {.
	gkey
 = "RßmIdË_IÇùivePack‘CouÁ", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2071, .
	gšdex
 = -1,

632 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

633 {.
	gkey
 = "RßmIdË_D–", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2074, .
	gšdex
 = -1,

634 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

635 {.
	gkey
 = "RßmB—cÚLoss_T¬g‘MšRSSI", .
	gfunc_p
 = 
’code_sšt_mib
, .
	gpsid
 = 2299, .
	gšdex
 = -1,

636 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -127, .
	gmax_v®ue
 = -70},

637 {.
	gkey
 = "RßmEm”g’cy_T¬g‘MšRSSI", .
	gfunc_p
 = 
’code_sšt_mib
, .
	gpsid
 = 2301, .
	gšdex
 = -1,

638 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -127, .
	gmax_v®ue
 = -70},

639 {.
	gkey
 = "RßmBTM_D–", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2304, .
	gšdex
 = -1,

640 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

641 {.
	gkey
 = "RßmAPScÜe_RSSIWeight", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2305, .
	gšdex
 = -1,

642 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

643 {.
	gkey
 = "RßmAPScÜe_CUWeight", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2303, .
	gšdex
 = -1,

644 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

645 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜV®ue1", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_v®ue1
, .
	gpsid
 = 2306,

646 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

647 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜV®ue2", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_v®ue2
, .
	gpsid
 = 2306,

648 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

649 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜV®ue3", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_v®ue3
, .
	gpsid
 = 2306,

650 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

651 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜV®ue4", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_v®ue4
, .
	gpsid
 = 2306,

652 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

653 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜV®ue5", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_v®ue5
, .
	gpsid
 = 2306,

654 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

655 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜScÜe1", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_scÜe1
, .
	gpsid
 = 2306,

656 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

657 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜScÜe2", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_scÜe2
, .
	gpsid
 = 2306,

658 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

659 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜScÜe3", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_scÜe3
, .
	gpsid
 = 2306,

660 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

661 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜScÜe4", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_scÜe4
, .
	gpsid
 = 2306,

662 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

663 {.
	gkey
 = "RßmAPScÜe_Bªd1_RSSIFaùÜScÜe5", .
	gfunc_p
 = 
’code_mib_bªd1_rssi_çùÜ_scÜe5
, .
	gpsid
 = 2306,

664 .
	gšdex
 = 1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

665 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜV®ue1", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_v®ue1
, .
	gpsid
 = 2306,

666 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

667 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜV®ue2", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_v®ue2
, .
	gpsid
 = 2306,

668 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

669 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜV®ue3", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_v®ue3
, .
	gpsid
 = 2306,

670 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

671 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜV®ue4", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_v®ue4
, .
	gpsid
 = 2306,

672 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

673 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜV®ue5", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_v®ue5
, .
	gpsid
 = 2306,

674 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

675 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜScÜe1", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_scÜe1
, .
	gpsid
 = 2306,

676 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

677 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜScÜe2", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_scÜe2
, .
	gpsid
 = 2306,

678 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

679 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜScÜe3", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_scÜe3
, .
	gpsid
 = 2306,

680 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

681 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜScÜe4", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_scÜe4
, .
	gpsid
 = 2306,

682 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

683 {.
	gkey
 = "RßmAPScÜe_Bªd2_RSSIFaùÜScÜe5", .
	gfunc_p
 = 
’code_mib_bªd2_rssi_çùÜ_scÜe5
, .
	gpsid
 = 2306,

684 .
	gšdex
 = 2, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

685 {.
	gkey
 = "RßmNCHO_Trigg”", .
	gfunc_p
 = 
’code_sšt_mib
, .
	gpsid
 = 2092, .
	gšdex
 = -1,

686 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

687 {.
	gkey
 = "RßmNCHO_D–", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2075, .
	gšdex
 = -1,

688 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 30},

689 {.
	gkey
 = "RßmNCHO_FuÎSÿnP”iod", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2053,

690 .
	gšdex
 = -1, .
	gun™_cÚ_çùÜ
 = 1000000, .
	gmš_v®ue
 = 60, .
	gmax_v®ue
 = 300},

691 {.
	gkey
 = "RßmNCHO_P¬tŸlSÿnP”iod", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2292,

692 .
	gšdex
 = -1, .
	gun™_cÚ_çùÜ
 = 1000000, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

693 {.
	gkey
 = "RßmNCHO_AùiveCH_Dw–lTime", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2057,

694 .
	gšdex
 = -1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 200},

695 {.
	gkey
 = "RßmNCHO_PassiveCH_Dw–lTime", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2644,

696 .
	gšdex
 = -1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 200},

697 {.
	gkey
 = "RßmNCHO_HomeTime", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2069, .
	gšdex
 = -1,

698 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 200},

699 {.
	gkey
 = "RßmNCHO_AwayTime", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2070, .
	gšdex
 = -1,

700 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 200},

701 {.
	gkey
 = "CÚB—cÚLoss_TimeoutOnWakeUp", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2098,

702 .
	gšdex
 = -1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

703 {.
	gkey
 = "CÚDTIMSkpšg_Numb”", .
	gfunc_p
 = 
’code_mib_cÚ_dtim_skpšg_numb”
, .
	gpsid
 = 2518,

704 .
	gšdex
 = -1, .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 10},

705 {.
	gkey
 = "CÚK“pAlive_IÁ”v®", .
	gfunc_p
 = 
’code_ušt_mib
, .
	gpsid
 = 2502, .
	gšdex
 = -1,

706 .
	gun™_cÚ_çùÜ
 = 1, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 120},

707 {.
	gkey
 = "RßmWTC_SÿnMode", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

708 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 2},

709 {.
	gkey
 = "RßmWTC_HªdlšgRSSITh»shŞd", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

710 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -90, .
	gmax_v®ue
 = -60},

711 {.
	gkey
 = "RßmWTC_24GCªdiRSSITh»shŞd", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

712 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -90, .
	gmax_v®ue
 = -60},

713 {.
	gkey
 = "RßmWTC_5GCªdiRSSITh»shŞd", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

714 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -90, .
	gmax_v®ue
 = -60},

715 {.
	gkey
 = "RßmWTC_6GCªdiRSSITh»shŞd", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

716 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -90, .
	gmax_v®ue
 = -60},

717 {.
	gkey
 = "RßmBTCÛx_ScÜeWeight", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

718 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

719 {.
	gkey
 = "RßmBTCÛx_ETPWeight", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

720 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

721 {.
	gkey
 = "RßmBTCÛx_T¬g‘MšRSSI", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

722 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -90, .
	gmax_v®ue
 = -60},

723 {.
	gkey
 = "RßmBTCÛx_D–", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

724 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

725 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜV®ue1", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

726 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

727 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜV®ue2", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

728 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

729 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜV®ue3", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

730 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

731 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜV®ue4", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

732 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = -100, .
	gmax_v®ue
 = -50},

733 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜScÜe1", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

734 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

735 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜScÜe2", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

736 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

737 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜScÜe3", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

738 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

739 {.
	gkey
 = "RßmAPScÜe_Bªd3_RSSIFaùÜScÜe4", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

740 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 100},

741 {.
	gkey
 = "RßmSÿn_6G_PSC_Dw–lTime", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

742 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 200},

743 {.
	gkey
 = "RßmSÿn_6G_NÚPSC_Dw–lTime", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

744 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 200},

745 {.
	gkey
 = "CÚB—cÚLoss_TimeoutOnSË•", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

746 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 20},

747 {.
	gkey
 = "CÚDTIMSkpšg_MaxTime", .
	gfunc_p
 = 
NULL
, .
	gpsid
 = -100, .
	gšdex
 = -1,

748 .
	gun™_cÚ_çùÜ
 = 0, .
	gmš_v®ue
 = 0, .
	gmax_v®ue
 = 2}

751 
	$¦si_ši_v®id©e_·¿m‘”_¿nge
(
¦si_dev
 *
sdev
, 
key_v®
,

752 
lookup_bË_šdex
)

754 ià(
key_v®
 < 
¦si_ši_cÚfig_lookup_bË
[
lookup_bË_šdex
].
mš_v®ue
 ||

755 
key_v®
 > 
¦si_ši_cÚfig_lookup_bË
[
lookup_bË_šdex
].
max_v®ue
) {

756 
	`SLSI_ERR_NODEV
("Parameter value %d is out of„ange forhe key %s\n",

757 
key_v®
, 
¦si_ši_cÚfig_lookup_bË
[
lookup_bË_šdex
].
key
);

758  -
EINVAL
;

761 
	}
}

763 
	$¦si_ši_cÚfig_â_lookup
(
u8
 *
key
, 
Ën
)

765 
i
 = 0;

766 
ši_lookup
 *
p
 = 
NULL
;

768 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_ši_cÚfig_lookup_bË
); i++) {

769 
p
 = &
¦si_ši_cÚfig_lookup_bË
[
i
];

770 ià(
p
->
key
 && !
	`¡ºÿ£cmp
(key,…->key, 
Ën
))

771  
i
;

774 
	}
}

776 
u8
 *
	$¦si_ši_Œim_wh™e_¥aû
(
u8
 *
tmp
, u8 *
lše
, 
Ën
)

778 (
tmp
 - 
lše
è< 
Ën
) {

779 ià(!(*
tmp
 == ' ' || *tmp == '\t'))

781 
tmp
++;

783  
tmp
;

784 
	}
}

786 
	$¦si_·r£_ši_cÚfig
(
¦si_dev
 *
sdev
, 
u8
 *
lše
, 
Ën
, 
boŞ
 
»ad_İ”©iÚ
)

788 
»t
 = 0;

789 
šdex
 = -1;

790 
key_Ën
 = 0;

791 
u8
 *
key
 = 
NULL
;

792 
u8
 *
key_v®
 = 
NULL
;

793 
u8
 *
tmp
 = 
NULL
;

794 
key_v®ue_št
 = 0;

795 
u8
 
fš®_key
[
SLSI_INI_KEY_LEN_MAX
];

797 ià(*
lše
 == '[' || *line == '#')

800 
tmp
 = 
lše
;

801 
tmp
 = 
	`¦si_ši_Œim_wh™e_¥aû
Ñmp, 
lše
, 
Ën
);

802 ià((
tmp
 - 
lše
è>ğ
Ën
) {

803 
	`SLSI_ERR_NODEV
("parsingƒrror/syntaxƒrror in ini conf file before findinghe start ofhe key\n");

804  -
EINVAL
;

807 
key
 = 
tmp
;

809 (
tmp
 - 
lše
è< 
Ën
) {

810 ià(*
tmp
 == ' ' || *tmp == '\t' || *tmp == '=')

812 
tmp
++;

815 ià((
tmp
 - 
lše
è>ğ
Ën
) {

816 
	`SLSI_ERR_NODEV
("parsingƒrror/syntaxƒrror in ini conf file before findingheƒnd ofhe key\n");

817  -
EINVAL
;

820 
key_Ën
 = (
tmp
 - 
key
);

821 ià(
key_Ën
 < 
SLSI_INI_KEY_LEN_MAX
) {

822 
	`¡ºıy
(
fš®_key
, 
key
, 
key_Ën
);

823 
fš®_key
[
key_Ën
] = '\0';

825 
	`SLSI_ERR_NODEV
("Key†engthƒrror in ini configuration file\n");

826  -
EINVAL
;

828 
šdex
 = 
	`¦si_ši_cÚfig_â_lookup
(
fš®_key
, 
key_Ën
);

829 ià(
šdex
 < 0) {

830 
	`SLSI_ERR_NODEV
("P¬£d key : %.* i nÙ suµÜ‹d\n", 
key_Ën
, 
key
);

831  -
EINVAL
;

834 ià(!
¦si_ši_cÚfig_lookup_bË
[
šdex
].
func_p
) {

835 
	`SLSI_ERR_NODEV
("hªdË¸i nÙ…»£Á fÜ key:%s\n", 
¦si_ši_cÚfig_lookup_bË
[
šdex
].
key
);

836  -
ENOTSUPP
;

839 
tmp
 = 
	`¦si_ši_Œim_wh™e_¥aû
Ñmp, 
lše
, 
Ën
);

840 ià((
tmp
 - 
lše
è>ğ
Ën
) {

841 
	`SLSI_ERR_NODEV
("parsingƒrror/syntaxƒrror in ini conf file‡fterhe key found successfully\n");

842  -
EINVAL
;

845 ià(*
tmp
 != '=') {

846 
	`SLSI_ERR_NODEV
("Error: Delimiter is missing\n");

847  -
EINVAL
;

850 
tmp
++;

851 
tmp
 = 
	`¦si_ši_Œim_wh™e_¥aû
Ñmp, 
lše
, 
Ën
);

852 ià((
tmp
 - 
lše
è>ğ
Ën
) {

853 
	`SLSI_ERR_NODEV
("parsingƒrror/syntaxƒrror in ini conf file before findinghe key_val\n");

854  -
ENOTSUPP
;

857 
key_v®
 = 
tmp
;

858 ià(
»ad_İ”©iÚ
) {

859 
»t
 = 
	`¦si_¡r_to_št
(
key_v®
, &
key_v®ue_št
);

860 ià(!
»t
) {

861 
	`SLSI_ERR_NODEV
("Key value is invalid for key:%s\n",

862 
¦si_ši_cÚfig_lookup_bË
[
šdex
].
key
);

863  -
EINVAL
;

865 
»t
 = 
	`¦si_ši_v®id©e_·¿m‘”_¿nge
(
sdev
, 
key_v®ue_št
, 
šdex
);

866  
»t
;

869 
»t
 = 
¦si_ši_cÚfig_lookup_bË
[
šdex
].
	`func_p
(
sdev
, sdev->
ši_cÚf_¡ruù
.
ši_cÚf_buff
,

870 &
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff_pos
,

871 
key_v®
, &
¦si_ši_cÚfig_lookup_bË
[
šdex
]);

872 ià(
»t
) {

873 
	`SLSI_ERR_NODEV
("E¼ occu¼ed iÀhªdË¸fÜ key: %s\n", 
¦si_ši_cÚfig_lookup_bË
[
šdex
].
key
);

874 ià(
»t
 =ğ-
EINVAL
)

875  
»t
;

878 
	}
}

880 
	$¦si_»ad_ši_cÚfig_fe
(
¦si_dev
 *
sdev
, cÚ¡ 
fœmw¬e
 *
e
,

881 
boŞ
 
»ad_İ”©iÚ
)

883 
u8
 *
lše
 = 
NULL
;

884 
u8
 *
tmp
 = 
NULL
;

885 
lše_Ën
 = 0;

886 
r
 = 0;

888 ià(!
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff
)

889 
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff
 = 
	`km®loc
(
SLSI_INI_CONFIG_BUFF_SIZE
, 
GFP_KERNEL
);

891 ià(!
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff
) {

892 
	`SLSI_ERR
(
sdev
, "Couldn't‡llocate static buffer for ini configuration\n");

893  -
ENOMEM
;

896 
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff_pos
 = 0;

898 
tmp
 = (
u8
 *)
e
->
d©a
;

899 (
tmp
 - 
e
->
d©a
è<ƒ->
size
) {

900 ((
tmp
 - 
e
->
d©a
è<ƒ->
size
) &&

901 ((*
tmp
 == '\n') || (*tmp == '\r') || (*tmp == ' ') || (*tmp == '\t')))

902 
tmp
++;

904 
lše
 = 
tmp
;

905 ((
tmp
 - 
e
->
d©a
è<ƒ->
size
) && (*tmp != '\n') && (*tmp != '\r'))

906 
tmp
++;

908 
lše_Ën
 = 
tmp
 - 
lše
;

909 ià(
lše_Ën
 > 0) {

910 
r
 = 
	`¦si_·r£_ši_cÚfig
(
sdev
, 
lše
, 
lše_Ën
, 
»ad_İ”©iÚ
);

911 ià(
r
 =ğ-
EINVAL
 && 
»ad_İ”©iÚ
) {

912 
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff_pos
 = 0;

913  
SLSI_INI_TRY_FALLBACK
;

916 
tmp
++;

919 ià(
»ad_İ”©iÚ
)

920 
r
 = 
	`¦si_»ad_ši_cÚfig_fe
(
sdev
, 
e
, 
çl£
);

922 
	`£t_mibs
(
sdev
);

923 
sdev
->
ši_cÚf_¡ruù
.
ši_cÚf_buff_pos
 = 0;

924  
r
;

925 
	}
}

927 
	$¦si_lßd_ši_cÚfig_fe
(
¦si_dev
 *
sdev
, *
·th
, cÚ¡ 
fœmw¬e
 **
e
)

929 
r
 = 0;

931 
r
 = 
	`mx140_»que¡_fe
(
sdev
->
maxw–l_cÜe
, 
·th
, 
e
);

932 ià(
r
 != 0) {

933 
	`SLSI_ERR
(
sdev
, "Couldn'ˆİ’ % f¸ğ%d\n", 
·th
, 
r
);

934  
SLSI_INI_TRY_FALLBACK
;

937 
	`SLSI_INFO
(
sdev
, "In˜cÚàfİ’ed sucûssfuÎy : P©h = %s\n", 
·th
);

938 ià(!
e
) {

939 
	`SLSI_ERR
(
sdev
, "mx140_request_file()„eturned success, but firmware was‚ull\n");

940  
SLSI_INI_TRY_FALLBACK
;

942  
r
;

943 
	}
}

945 
	$¦si_´oûss_ši_cÚfig_fe
(
¦si_dev
 *
sdev
)

947 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

948 
r
 = 0;

950 
r
 = 
	`¦si_lßd_ši_cÚfig_fe
(
sdev
, 
INI_CONFIG_FILE_PATH
, &
e
);

951 ià(!
r
) {

952 
r
 = 
	`¦si_»ad_ši_cÚfig_fe
(
sdev
, 
e
, 
Œue
);

953 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
e
);

956 ià(
r
 !ğ
SLSI_INI_TRY_FALLBACK
)

959 
r
 = 
	`¦si_lßd_ši_cÚfig_fe
(
sdev
, 
INI_CONFIG_FILE_BACKUP_PATH
, &
e
);

960 ià(!
r
) {

961 
r
 = 
	`¦si_»ad_ši_cÚfig_fe
(
sdev
, 
e
, 
Œue
);

962 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
e
);

964 
	}
}

	@ioctl.c

7 
	~"ioùl.h
"

8 
	~"debug.h
"

9 
	~"mlme.h
"

10 
	~"mgt.h
"

11 
	~"ÿc.h
"

12 
	~"h.h
"

13 
	~"Ãtif.h
"

14 
	~"cfg80211_İs.h
"

15 
	~<Ãt/Ãšk.h
>

16 
	~<lšux/Ãtdeviû.h
>

17 
	~<lšux/›“80211.h
>

18 
	~<lšux/igmp.h
>

19 
	~"mib.h
"

20 
	~<scsc/scsc_mx.h
>

21 
	~<scsc/scsc_log_cŞËùÜ.h
>

22 
	~"dev.h
"

23 
	~"çpi.h
"

25 
	#CMD_RXFILTERADD
 "RXFILTER-ADD"

	)

26 
	#CMD_RXFILTERREMOVE
 "RXFILTER-REMOVE"

	)

27 
	#CMD_RXFILTERSTART
 "RXFILTER-START"

	)

28 
	#CMD_RXFILTERSTOP
 "RXFILTER-STOP"

	)

29 
	#CMD_SETCOUNTRYREV
 "SETCOUNTRYREV"

	)

30 
	#CMD_GETCOUNTRYREV
 "GETCOUNTRYREV"

	)

31 
	#CMD_SETROAMTRIGGER_LEGACY
 "SETROAMTRIGGER_LEGACY"

	)

32 
	#CMD_GETROAMTRIGGER_LEGACY
 "GETROAMTRIGGER_LEGACY"

	)

33 
	#CMD_REASSOC_LEGACY
 "REASSOC_LEGACY"

	)

34 
	#CMD_REASSOC_FREQUENCY_LEGACY
 "REASSOC_FREQUENCY_LEGACY"

	)

35 
	#CMD_SETROAMTRIGGER
 "SETROAMTRIGGER"

	)

36 
	#CMD_GETROAMTRIGGER
 "GETROAMTRIGGER"

	)

37 
	#CMD_ADDROAMSCANCHANNELS_LEGACY
 "ADDROAMSCANCHANNELS_LEGACY"

	)

38 
	#CMD_ADDROAMSCANFREQUENCIES_LEGACY
 "ADDROAMSCANFREQUENCIES_LEGACY"

	)

39 
	#CMD_SETSUSPENDMODE
 "SETSUSPENDMODE"

	)

40 
	#CMD_SETROAMDELTA
 "SETROAMDELTA"

	)

41 
	#CMD_GETROAMDELTA
 "GETROAMDELTA"

	)

42 
	#CMD_SETROAMSCANPERIOD
 "SETROAMSCANPERIOD"

	)

43 
	#CMD_GETROAMSCANPERIOD
 "GETROAMSCANPERIOD"

	)

44 
	#CMD_SETFULLROAMSCANPERIOD
 "SETFULLROAMSCANPERIOD"

	)

45 
	#CMD_GETFULLROAMSCANPERIOD
 "GETFULLROAMSCANPERIOD"

	)

46 
	#CMD_SETSCANCHANNELTIME
 "SETSCANCHANNELTIME"

	)

47 
	#CMD_GETSCANCHANNELTIME
 "GETSCANCHANNELTIME"

	)

48 
	#CMD_SETSCANNPROBES
 "SETSCANNPROBES"

	)

49 
	#CMD_GETSCANNPROBES
 "GETSCANNPROBES"

	)

50 
	#CMD_SETROAMMODE
 "SETROAMMODE"

	)

51 
	#CMD_GETROAMMODE
 "GETROAMMODE"

	)

52 
	#CMD_SETROAMINTRABAND
 "SETROAMINTRABAND"

	)

53 
	#CMD_GETROAMINTRABAND
 "GETROAMINTRABAND"

	)

54 
	#CMD_SETROAMBAND
 "SETROAMBAND"

	)

55 
	#CMD_GETROAMBAND
 "GETROAMBAND"

	)

56 
	#CMD_SETROAMSCANCONTROL
 "SETROAMSCANCONTROL"

	)

57 
	#CMD_GETROAMSCANCONTROL
 "GETROAMSCANCONTROL"

	)

58 
	#CMD_SETSCANHOMETIME
 "SETSCANHOMETIME"

	)

59 
	#CMD_GETSCANHOMETIME
 "GETSCANHOMETIME"

	)

60 
	#CMD_SETSCANHOMEAWAYTIME
 "SETSCANHOMEAWAYTIME"

	)

61 
	#CMD_GETSCANHOMEAWAYTIME
 "GETSCANHOMEAWAYTIME"

	)

62 
	#CMD_SETSCANHOMEAWAYTIME_LEGACY
 "SETSCANHOMEAWAYTIME_LEGACY"

	)

63 
	#CMD_SETSCANHOMETIME_LEGACY
 "SETSCANHOMETIME_LEGACY"

	)

64 
	#CMD_SETSCANCHANNELTIME_LEGACY
 "SETSCANCHANNELTIME_LEGACY"

	)

65 
	#CMD_SETSCANPASSIVETIME_LEGACY
 "SETSCANPASSIVETIME_LEGACY"

	)

66 
	#CMD_SET_TID
 "SET_TID"

	)

67 
	#CMD_SETOKCMODE
 "SETOKCMODE"

	)

68 
	#CMD_GETOKCMODE
 "GETOKCMODE"

	)

69 
	#CMD_SETWESMODE
 "SETWESMODE"

	)

70 
	#CMD_GETWESMODE
 "GETWESMODE"

	)

71 
	#CMD_SET_PMK
 "SET_PMK"

	)

72 
	#CMD_HAPD_GET_CHANNEL
 "HAPD_GET_CHANNEL"

	)

73 
	#CMD_SET_SAP_CHANNEL_LIST
 "SET_SAP_CHANNEL_LIST"

	)

74 
	#CMD_REASSOC
 "REASSOC"

	)

75 
	#CMD_REASSOC_FREQUENCY
 "REASSOC_FREQUENCY"

	)

76 
	#CMD_SETROAMSCANCHANNELS
 "SETROAMSCANCHANNELS"

	)

77 
	#CMD_SETROAMSCANFREQUENCIES
 "SETROAMSCANFREQUENCIES"

	)

78 
	#CMD_GETROAMSCANCHANNELS
 "GETROAMSCANCHANNELS"

	)

79 
	#CMD_GETROAMSCANFREQUENCIES
 "GETROAMSCANFREQUENCIES"

	)

80 
	#CMD_GETROAMSCANCHANNELS_LEGACY
 "GETROAMSCANCHANNELS_LEGACY"

	)

81 
	#CMD_GETROAMSCANFREQUENCIES_LEGACY
 "GETROAMSCANFREQUENCIES_LEGACY"

	)

82 
	#CMD_ADDROAMSCANCHANNELS
 "ADDROAMSCANCHANNELS"

	)

83 
	#CMD_ADDROAMSCANFREQUENCIES
 "ADDROAMSCANFREQUENCIES"

	)

84 
	#CMD_SENDACTIONFRAME
 "SENDACTIONFRAME"

	)

85 
	#CMD_CERTSENDACTIONFRAME
 "CERTSENDACTIONFRAME"

	)

86 #ifdeà
SLSI_TEST_DEV


87 
	#CMD_GASSENDACTIONFRAME
 "GASSENDACTIONFRAME"

	)

89 
	#CMD_GETNCHOMODE
 "GETNCHOMODE"

	)

90 
	#CMD_SETNCHOMODE
 "SETNCHOMODE"

	)

91 
	#CMD_GETDFSSCANMODE
 "GETDFSSCANMODE"

	)

92 
	#CMD_SETDFSSCANMODE
 "SETDFSSCANMODE"

	)

93 
	#CMD_HAPD_MAX_NUM_STA
 "HAPD_MAX_NUM_STA"

	)

94 
	#CMD_COUNTRY
 "COUNTRY"

	)

95 
	#CMD_SEND_GK
 "SEND_GK"

	)

96 
	#CMD_SETAPP2PWPSIE
 "SET_AP_P2P_WPS_IE"

	)

97 
	#CMD_P2PSETPS
 "P2P_SET_PS"

	)

98 
	#CMD_P2PSETNOA
 "P2P_SET_NOA"

	)

99 
	#CMD_P2PECSA
 "P2P_ECSA"

	)

100 
	#CMD_P2PLOSTART
 "P2P_LO_START"

	)

101 
	#CMD_P2PLOSTOP
 "P2P_LO_STOP"

	)

102 
	#CMD_TDLSCHANNELSWITCH
 "TDLS_CHANNEL_SWITCH"

	)

103 
	#CMD_SETROAMOFFLOAD
 "SETROAMOFFLOAD"

	)

104 
	#CMD_SETROAMOFFLAPLIST
 "SETROAMOFFLAPLIST"

	)

105 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


106 
	#CMD_SET_LATENCY_MODE
 "SET_LATENCY_MODE"

	)

107 
	#CMD_SET_POWER_MGMT
 "SET_POWER_MGMT"

	)

109 
	#CMD_SET_LATENCY_CRT_DATA
 "SET_LATENCY_CRT_DATA"

	)

110 
	#CMD_SET_DISCONNECT_IES
 "SET_DISCONNECT_IES"

	)

111 
	#CMD_SETBANDWIDTH
 "SETBANDWIDTH"

	)

112 
	#CMD_SET_BSS_CHANNEL_WIDTH
 "SET_BSS_CHANNEL_WIDTH"

	)

114 
	#CMD_SETBAND
 "SETBAND"

	)

115 
	#CMD_GETBAND
 "GETBAND"

	)

116 
	#CMD_FACTORY_SETBAND
 "FACTORY_SETBAND"

	)

117 
	#CMD_SET_FCC_CHANNEL
 "SET_FCC_CHANNEL"

	)

119 
	#CMD_FAKEMAC
 "FAKEMAC"

	)

121 
	#CMD_GETBSSRSSI
 "GET_BSS_RSSI"

	)

122 
	#CMD_GETBSSINFO
 "GETBSSINFO"

	)

123 
	#CMD_GETSTAINFO
 "GETSTAINFO"

	)

124 
	#CMD_GETASSOCREJECTINFO
 "GETASSOCREJECTINFO"

	)

125 
	#CMD_SET_DWELL_TIME
 "SET_DWELL_TIME"

	)

127 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

128 
	#CMD_BEACON_RECV
 "BEACON_RECV"

	)

130 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


131 
	#CMD_SET_ENHANCED_ARP_TARGET
 "SET_ENHANCED_ARP_TARGET"

	)

132 
	#CMD_GET_ENHANCED_ARP_COUNTS
 "GET_ENHANCED_ARP_COUNTS"

	)

136 
	#CMD_AMPDU_MPDU
 "AMPDU_MPDU"

	)

137 
	#CMD_BTCOEXMODE
 "BTCOEXMODE"

	)

138 
	#CMD_BTCOEXSCAN_START
 "BTCOEXSCAN-START"

	)

139 
	#CMD_BTCOEXSCAN_STOP
 "BTCOEXSCAN-STOP"

	)

140 
	#CMD_CHANGE_RL
 "CHANGE_RL"

	)

141 
	#CMD_INTERFACE_CREATE
 "INTERFACE_CREATE"

	)

142 
	#CMD_INTERFACE_DELETE
 "INTERFACE_DELETE"

	)

143 
	#CMD_SET_INDOOR_CHANNELS
 "SET_INDOOR_CHANNELS"

	)

144 
	#CMD_GET_INDOOR_CHANNELS
 "GET_INDOOR_CHANNELS"

	)

145 
	#CMD_LTECOEX
 "LTECOEX"

	)

146 
	#CMD_MIRACAST
 "MIRACAST"

	)

147 
	#CMD_RESTORE_RL
 "RESTORE_RL"

	)

148 
	#CMD_RPSMODE
 "RPSMODE"

	)

149 
	#CMD_SETCCXMODE
 "SETCCXMODE"

	)

150 
	#CMD_SETDFSSCANMODE
 "SETDFSSCANMODE"

	)

151 
	#CMD_SETJOINPREFER
 "SETJOINPREFER"

	)

152 
	#CMD_SETSINGLEANT
 "SETSINGLEANT"

	)

153 
	#CMD_SET_TX_POWER_CALLING
 "SET_TX_POWER_CALLING"

	)

154 
	#CMD_GET_CU
 "GET_CU"

	)

156 
	#CMD_DRIVERDEBUGDUMP
 "DEBUG_DUMP"

	)

157 
	#CMD_DRIVERDEBUGCOMMAND
 "DEBUG_COMMAND"

	)

158 
	#CMD_TESTFORCEHANG
 "SLSI_TEST_FORCE_HANG"

	)

159 
	#CMD_GETREGULATORY
 "GETREGULATORY"

	)

161 
	#CMD_SET_TX_POWER_SAR
 "SET_TX_POWER_SAR"

	)

162 
	#CMD_GET_TX_POWER_SAR
 "GET_TX_POWER_SAR"

	)

163 
	#CMD_SET_TX_POWER_SUB6_BAND
 "SET_TX_POWER_SUB6_BAND"

	)

165 
	#CMD_POWER_MEASUREMENT_START
 "POWER_MEASUREMENT_START"

	)

167 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


168 
	#CMD_ENHANCED_PKT_FILTER
 "ENHANCED_PKT_FILTER"

	)

171 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


172 
	#CMD_GET_MAX_LINK_SPEED
 "GET_MAX_LINK_SPEED"

	)

175 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


176 
	#CMD_SET_NUM_ANTENNAS
 "SET_NUM_ANTENNAS"

	)

177 
	#CMD_GET_NUM_ANTENNAS
 "GET_NUM_ANTENNAS"

	)

180 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


181 
	#CMD_SET_ITO
 "SET_ITO"

	)

182 
	#CMD_ENABLE_ITO
 "ENABLE_ITO"

	)

185 
	#CMD_ELNA_BYPASS
 "ELNA_BYPASS"

	)

186 
	#CMD_ELNA_BYPASS_INT
 "ELNA_BYPASS_INT"

	)

187 
	#CMD_MAX_DTIM_IN_SUSPEND
 "MAX_DTIM_IN_SUSPEND"

	)

188 
	#CMD_SET_DTIM_IN_SUSPEND
 "SET_DTIM_IN_SUSPEND"

	)

189 
	#CMD_FORCE_ROAMING_BSSID
 "FORCE_ROAMING_BSSID"

	)

190 
	#CMD_ROAMING_BLACKLIST_ADD
 "ROAMING_BLACKLIST_ADD"

	)

191 
	#CMD_ROAMING_BLACKLIST_REMOVE
 "ROAMING_BLACKLIST_REMOVE"

	)

193 
	#ROAMOFFLAPLIST_MIN
 1

	)

194 
	#ROAMOFFLAPLIST_MAX
 100

	)

196 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


197 
	#SLSI_MAX_BAND_VALUE
 
SLSI_FREQ_BAND_2_4GHZ_6GHZ


	)

198 
	#SLSI_MAX_ROAMBAND_VALUE
 
FAPI_BAND_2_4GHZ_5GHZ_6GHZ


	)

200 
	#SLSI_MAX_BAND_VALUE
 
SLSI_FREQ_BAND_2GHZ


	)

201 
	#SLSI_MAX_ROAMBAND_VALUE
 
FAPI_BAND_2_4GHZ_5GHZ


	)

205 
¦si_ioùl_¬gs
 *
	$¦si_g‘_´iv©e_commªd_¬gs
(*
bufãr
, 
buf_Ën
, 
max_¬g_couÁ
)

207 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

208 *
pos
 = 
bufãr
;

210 
ioùl_¬gs
 = 
	`km®loc
((*ioùl_¬gsè+ (
u8
 *è* 
max_¬g_couÁ
, 
GFP_KERNEL
);

211 ià(!
ioùl_¬gs
)

212  
NULL
;

213 
	`mem£t
(
ioùl_¬gs
->
¬gs
, '\0', (
u8
 *è* 
max_¬g_couÁ
);

215 
ioùl_¬gs
->
¬g_couÁ
 = 0;

216 
buf_Ën
 > 0 && 
ioùl_¬gs
->
¬g_couÁ
 < 
max_¬g_couÁ
) {

217 
pos
 = 
	`¡rchr
(pos, ' ');

218 ià(!
pos
)

220 
buf_Ën
 = buf_ËÀ- (
pos
 - 
bufãr
 + 1);

221 ià(
buf_Ën
 <= 0)

223 *
pos
 = '\0';

224 
pos
++;

225 *
pos
 == ' ')

226 
pos
++;

227 
bufãr
 = 
pos
;

228 
ioùl_¬gs
->
¬gs
[ioùl_¬gs->
¬g_couÁ
++] = 
pos
;

230  
ioùl_¬gs
;

231 
	}
}

233 
	$¦si_·r£_hex
(
c
)

235 ià(
c
 >= '0' && c <= '9')

236  
c
 - '0';

237 ià(
c
 >= 'a' && c <= 'f')

238  
c
 - 'a' + 10;

239 ià(
c
 >= 'A' && c <= 'F')

240  
c
 - 'A' + 10;

242 
	}
}

244 
	$¦si_cÚv”t_¥aû_£³¿tiÚ
(*
buf
, 
buf_Ën
)

246 
i
 = 0;

248 
buf
[
i
] !ğ'\0' && i < 
buf_Ën
) {

249 ià(
buf
[
i
] == ',' || buf[i] == '=')

250 
buf
[
i
] = ' ';

251 
i
++;

253 
	}
}

255 
	$¦si_is_bw_v®id
(*
¡r
)

257 ià((
	`¦si_¡r_cmp
(
¡r
, "20") == 0) || (slsi_str_cmp(str, "40") == 0) ||

258 (
	`¦si_¡r_cmp
(
¡r
, "80") == 0))

262 
	}
}

264 
	$¦si_machex¡ršg_to_maÿ¼ay
(*
mac_¡r
, 
u8
 *
mac_¬r
)

266 
mac_¬r
[0] = 
	`¦si_·r£_hex
(
mac_¡r
[0]) << 4 | slsi_parse_hex(mac_str[1]);

267 
mac_¬r
[1] = 
	`¦si_·r£_hex
(
mac_¡r
[3]) << 4 | slsi_parse_hex(mac_str[4]);

268 
mac_¬r
[2] = 
	`¦si_·r£_hex
(
mac_¡r
[6]) << 4 | slsi_parse_hex(mac_str[7]);

269 
mac_¬r
[3] = 
	`¦si_·r£_hex
(
mac_¡r
[9]) << 4 | slsi_parse_hex(mac_str[10]);

270 
mac_¬r
[4] = 
	`¦si_·r£_hex
(
mac_¡r
[12]) << 4 | slsi_parse_hex(mac_str[13]);

271 
mac_¬r
[5] = 
	`¦si_·r£_hex
(
mac_¡r
[15]) << 4 | slsi_parse_hex(mac_str[16]);

272 
	}
}

274 
	$¦si_g‘_rş_äeq_li¡
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, *
äeq_li¡
)

276 
i
 = 7;

277 
›_Ën
 = 0;

278 
u8
 *
±r
;

279 
u16
 
äeq_v®
 = 0;

280 
__Ë16
 *
Ë16_±r
 = 
NULL
;

281 
u32
 
äeq_couÁ
 = 0;

283 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "RCL Channel List Indication„eceived\n");

284 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

285 
›_Ën
 = 
±r
[1];

286 
i
 < 
›_Ën
) {

287 
Ë16_±r
 = (
__Ë16
 *)&
±r
[
i
];

288 
äeq_v®
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

289 
äeq_li¡
[
äeq_couÁ
] = 
äeq_v®
 / 2;

291 ià(
äeq_li¡
[
äeq_couÁ
] < 2412 || freq_list[freq_count] > 5885) {

292 
	`SLSI_ERR
(
sdev
, "ERR: Inv®id f»q„eûived %d\n", 
äeq_li¡
[
äeq_couÁ
]);

293 
	`kä“_skb
(
skb
);

297 
i
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

298 
äeq_couÁ
 += 1;

299 ià(
äeq_couÁ
 >ğ
MAX_FREQUENCY_COUNT
) {

300 
	`SLSI_ERR
(
sdev
, "ERR: F»qu’cy†i¡„eûived >ğ%d\n", 
MAX_FREQUENCY_COUNT
);

301 
	`kä“_skb
(
skb
);

305 
	`kä“_skb
(
skb
);

306  
äeq_couÁ
;

307 
	}
}

309 
	$¦si_g‘_rş_chªÃl_li¡
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 *
chªÃl_li¡
)

311 
u32
 
chªÃl_couÁ
 = 0;

312 
i
 = 7;

313 
›_Ën
 = 0;

314 
u8
 *
±r
;

315 
u16
 
chªÃl_v®
 = 0;

316 
__Ë16
 *
Ë16_±r
 = 
NULL
;

318 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "RCL Channel List Indication„eceived\n");

319 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

320 
›_Ën
 = 
±r
[1];

321 
i
 < 
›_Ën
) {

322 
Ë16_±r
 = (
__Ë16
 *)&
±r
[
i
];

323 
chªÃl_v®
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

324 
chªÃl_li¡
[
chªÃl_couÁ
] = 
	`›“80211_äequ’cy_to_chªÃl
(
chªÃl_v®
 / 2);

325 ià(
chªÃl_li¡
[
chªÃl_couÁ
] < 1 || channel_list[channel_count] > 196) {

326 
	`SLSI_ERR
(
sdev
, "ERR: Inv®id chªÃÈ»ûived %d\n", 
chªÃl_li¡
[
chªÃl_couÁ
]);

327 
	`kä“_skb
(
skb
);

330 
i
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

331 
chªÃl_couÁ
 += 1;

332 ià(
chªÃl_couÁ
 >ğ
MAX_CHANNEL_COUNT
) {

333 
	`SLSI_ERR
(
sdev
, "ERR: ChªÃÈli¡„eûived >ğ%d\n", 
MAX_CHANNEL_COUNT
);

334 
	`kä“_skb
(
skb
);

338 
	`kä“_skb
(
skb
);

339  
chªÃl_couÁ
;

340 
	}
}

342 
	$¦si_upd©e_muÉiÿ¡_addr
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

344 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

345 
š_deviû
 *
š_dev
 = 
NULL
;

346 
_mc_li¡
 *
im
 = 
NULL
;

347 
__be32
 
muÉiÿ¡__li¡
[65] = {0};

348 
size
 = 0, 
i
 = 0, 
_found
 = 0;

350 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

351 
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
);

352 
š_dev
 = 
	`__š_dev_g‘_¹Æ
(
dev
);

353 ià(!
š_dev
)

356 
im
 = 
	`¹Æ_d”eã»nû
(
š_dev
->
mc_li¡
); im !ğ
NULL
; im =„Šl_d”eã»nû(im->
Ãxt_rcu
)) {

357 
_found
 = 0;

358 
i
 = 0; i < 
size
; i++) {

359 ià(!
	`memcmp
(&
im
->
muÉŸddr
, &
muÉiÿ¡__li¡
[
i
], (
__be32
))) {

360 
_found
 = 1;

364 ià(!
_found
) {

365 
	`memıy
(&
muÉiÿ¡__li¡
[
size
], &
im
->
muÉŸddr
, (
__be32
));

366 
size
++;

368 ià(
size
 >= 65)

371 
	`¦si_mlme_£t_muÉiÿ¡_
(
sdev
, 
dev
, 
muÉiÿ¡__li¡
, 
size
);

372 
	}
}

374 
	$¦si_£t_su¥’d_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

376 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

377 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

378 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

379 
u£r_su¥’d_mode
;

380 
´evious_su¥’d_mode
;

381 
u16
 
ho¡_¡©e
;

382 
»t
 = 0;

383 
vif
;

385 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

386 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

388 
u£r_su¥’d_mode
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

389 ià(
u£r_su¥’d_mode
 != 0 && user_suspend_mode != 1) {

390 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàu£r_su¥’d_mod%d\n", 
u£r_su¥’d_mode
);

391 
	`kä“
(
ioùl_¬gs
);

392  -
EINVAL
;

395 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

396 
´evious_su¥’d_mode
 = 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
;

397 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

398 ià(
u£r_su¥’d_mode
 !ğ
´evious_su¥’d_mode
) {

399 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

400 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

401 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

402 
Ãtdev_vif
 *
ndev_vif
;

404 ià(!
dev
)

407 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

408 ià(!
u£r_su¥’d_mode
)

409 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

411 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

412 ià(
ndev_vif
->
aùiv©ed
 &&

413 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

414 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

415 ià(
u£r_su¥’d_mode
) {

416 
»t
 = 
	`¦si_upd©e_·ck‘_f‹rs
(
sdev
, 
dev
);

417 ià(
sdev
->
igmp_ofæßd_aùiv©ed
)

418 
	`¦si_upd©e_muÉiÿ¡_addr
(
sdev
, 
dev
);

420 
»t
 = 
	`¦si_ş—r_·ck‘_f‹rs
(
sdev
, 
dev
);

422 ià(
»t
 != 0)

423 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀupd©šg /ş—ršgh·ck‘ f‹rs,»t=%d", 
»t
);

426 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

428 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

430 
	`SLSI_NET_INFO
(
dev
, "Cu¼’ˆsu¥’d mod(%dèªd„eque¡ed mode(%dè¬§me\n", 
´evious_su¥’d_mode
, 
u£r_su¥’d_mode
);

433 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

434 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 = user_suspend_mode;

435 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

437 ià(!
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
)

438 
ho¡_¡©e
 = ho¡_¡©| 
SLSI_HOSTSTATE_LCD_ACTIVE
;

440 
ho¡_¡©e
 = ho¡_¡©& ~
SLSI_HOSTSTATE_LCD_ACTIVE
;

441 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

443 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

444 ià(
»t
 != 0)

445 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d", 
»t
);

447 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

448 
	`kä“
(
ioùl_¬gs
);

449  
»t
;

450 
	}
}

452 
	$¦si_£t_p2p_İµs
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

454 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

455 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

456 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

457 
ù_·¿m
;

458 
Ëgacy_ps
;

459 
İp_ps
;

460 
»suÉ
 = 0;

462 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 3);

463 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

465 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

467 ià(
ioùl_¬gs
->
¬g_couÁ
 < 3) {

468 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

469 
»suÉ
 = -
EINVAL
;

470 
ex™
;

474 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
) {

475 
	`SLSI_ERR_NODEV
("P2P GO vif‚ot‡ctivated\n");

476 
»suÉ
 = -
EINVAL
;

477 
ex™
;

480 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ëgacy_ps
)) {

481 
	`SLSI_ERR
(
sdev
, "Ëgacy_ps: faedØ»ad from sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

482 
»suÉ
 = -
EINVAL
;

483 
ex™
;

486 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
İp_ps
)) {

487 
	`SLSI_ERR
(
sdev
, "İp_ps: faedØ»ad from sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

488 
»suÉ
 = -
EINVAL
;

489 
ex™
;

492 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
ù_·¿m
)) {

493 
	`SLSI_ERR
(
sdev
, "ù_·¿m: faedØ»ad from sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

494 
»suÉ
 = -
EINVAL
;

495 
ex™
;

498 ià(
İp_ps
 == 0)

499 
»suÉ
 = 
	`¦si_mlme_£t_ùwšdow
(
sdev
, 
dev
, 
İp_ps
);

500 ià(
ù_·¿m
 < ()
ndev_vif
->
­
.
b—cÚ_š‹rv®
)

501 
»suÉ
 = 
	`¦si_mlme_£t_ùwšdow
(
sdev
, 
dev
, 
ù_·¿m
);

503 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "p2°ù wšdow = %d i ouˆoà¿ngfÜ b—cÚ iÁ”v®(%d)\n", 
ù_·¿m
, 
ndev_vif
->
­
.
b—cÚ_š‹rv®
);

504 
ex™
:

505 
	`kä“
(
ioùl_¬gs
);

506 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

508  
»suÉ
;

509 
	}
}

511 
	$¦si_p2p_£t_nß_·¿ms
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

513 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

514 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

515 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

516 
»suÉ
 = 0;

517 
nß_couÁ
;

518 
du¿tiÚ
;

519 
š‹rv®
;

521 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 3);

522 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

524 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

526 ià(
ioùl_¬gs
->
¬g_couÁ
 < 3) {

527 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

528 
»suÉ
 = -
EINVAL
;

529 
ex™
;

533 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
) {

534 
	`SLSI_ERR_NODEV
("P2P GO vif‚ot‡ctivated\n");

535 
»suÉ
 = -
EINVAL
;

536 
ex™
;

539 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
nß_couÁ
)) {

540 
	`SLSI_ERR
(
sdev
, "nß_couÁ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

541 
»suÉ
 = -
EINVAL
;

542 
ex™
;

545 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
š‹rv®
)) {

546 
	`SLSI_ERR
(
sdev
, "š‹rv®: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

547 
»suÉ
 = -
EINVAL
;

548 
ex™
;

551 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
du¿tiÚ
)) {

552 
	`SLSI_ERR
(
sdev
, "du¿tiÚ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

553 
»suÉ
 = -
EINVAL
;

554 
ex™
;

558 
»suÉ
 = 
	`¦si_mlme_£t_p2p_nß
(
sdev
, 
dev
, 
nß_couÁ
, 
š‹rv®
, 
du¿tiÚ
);

560 
ex™
:

561 
	`kä“
(
ioùl_¬gs
);

562 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

563  
»suÉ
;

564 
	}
}

566 
	$¦si_p2p_ec§
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

568 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

569 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

570 
Ãtdev_vif
 *
group_dev_vif
;

571 
Ãt_deviû
 *
group_dev
 = 
NULL
;

572 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

573 
»suÉ
 = 0;

574 
chªÃl
;

575 
bªdwidth
;

576 
u16
 
ûÁ”_äeq
 = 0;

577 
u16
 
chª_šfo
 = 0;

578 
cfg80211_chª_def
 
chªdef
;

579 
Æ80211_bªd
 
bªd
;

580 
Æ80211_chªÃl_ty³
 
chª_ty³
 = 
NL80211_CHAN_NO_HT
;

582 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

583 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

585 ià(
ioùl_¬gs
->
¬g_couÁ
 < 2) {

586 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

587 
	`kä“
(
ioùl_¬gs
);

588  -
EINVAL
;

591 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

593 
group_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

594 ià(!
group_dev
) {

595 
	`SLSI_INFO
(
sdev
, "No Group‚et_dev found\n");

596 
»suÉ
 = -
EINVAL
;

597 
ex™
;

600 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
chªÃl
)) {

601 
	`SLSI_ERR
(
sdev
, "chªÃl: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

602 
»suÉ
 = -
EINVAL
;

603 
ex™
;

606 ià(
chªÃl
 < 1 || channel > 165) {

607 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

608 
»suÉ
 = -
EINVAL
;

609 
ex™
;

612 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
bªdwidth
)) {

613 
	`SLSI_ERR
(
sdev
, "bªdwidth: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

614 
»suÉ
 = -
EINVAL
;

615 
ex™
;

618 
bªd
 = (
chªÃl
 <ğ14è? 
NL80211_BAND_2GHZ
 : 
NL80211_BAND_5GHZ
;

619 
ûÁ”_äeq
 = 
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

620 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "p2°ec§_·¿m (ûÁ”_äeq)ğ(%d)\n", 
ûÁ”_äeq
);

621 
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
ûÁ”_äeq
);

622 
chªdef
.
width
 = (
bªd
 =ğ
NL80211_BAND_2GHZ
è? 
NL80211_CHAN_WIDTH_20_NOHT
 : 
NL80211_CHAN_WIDTH_80
;

624 #iâdeà
SSB_4963_FIXED


626 ià(
sdev
->
bªd_5g_suµÜ‹d
) {

627 ià(
bªdwidth
 == 80) {

628 
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_40
;

629 
bªdwidth
 = 40;

630 ià(
chªÃl
 == 36 || channel == 44 || channel == 149 || channel == 157)

631 
chª_ty³
 = 
NL80211_CHAN_HT40PLUS
;

633 
chª_ty³
 = 
NL80211_CHAN_HT40MINUS
;

637 ià(
chªÃl
 =ğ165 && 
bªdwidth
 != 20) {

638 
bªdwidth
 = 20;

639 
chª_ty³
 = 
NL80211_CHAN_HT20
;

641 
	`cfg80211_chªdef_ü—‹
(&
chªdef
, chªdef.
chª
, 
chª_ty³
);

642 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, &
chªdef
);

643 ià(
bªdwidth
 != 20)

644 
ûÁ”_äeq
 = 
	`¦si_g‘_ûÁ”_äeq1
(
sdev
, 
chª_šfo
, center_freq);

645 
group_dev_vif
 = 
	`Ãtdev_´iv
(
group_dev
);

646 
	`SLSI_MUTEX_LOCK
(
group_dev_vif
->
vif_mu‹x
);

647 
»suÉ
 = 
	`¦si_mlme_chªÃl_sw™ch
(
sdev
, 
group_dev
, 
ûÁ”_äeq
, 
chª_šfo
);

648 
	`SLSI_MUTEX_UNLOCK
(
group_dev_vif
->
vif_mu‹x
);

650 
ex™
:

651 
	`kä“
(
ioùl_¬gs
);

652 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

653  
»suÉ
;

654 
	}
}

656 
ssize_t
 
	$¦si_­_v’dÜ_›s_wr™e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
›
,

657 
size_t
 
›_Ën
, 
u16
 
pu½o£
)

659 
u8
 *
v’dÜ_›
 = 
NULL
;

660 
»suÉ
 = 0;

661 
Ãtdev_vif
 *
ndev_vif
;

663 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

664 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

669 ià(!
ndev_vif
->
aùiv©ed
) {

670 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "vif‚ot‡ctivated\n");

671 
»suÉ
 = 0;

672 
ex™
;

674 ià(!(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
 ||‚dev_vif->iáy³ =ğ
NL80211_IFTYPE_AP
)) {

675 
	`SLSI_ERR
(
sdev
, "NÙ AP o¸P2P iÁ”çû. iÁ”çûTy³:%d\n", 
ndev_vif
->
iáy³
);

676 
»suÉ
 = -
EINVAL
;

677 
ex™
;

680 
v’dÜ_›
 = 
	`km®loc
(
›_Ën
, 
GFP_KERNEL
);

681 ià(!
v’dÜ_›
) {

682 
	`SLSI_ERR
(
sdev
, "kmalloc failed\n");

683 
»suÉ
 = -
ENOMEM
;

684 
ex™
;

686 
	`memıy
(
v’dÜ_›
, 
›
, 
›_Ën
);

688 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

689 
»suÉ
 = 
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
v’dÜ_›
, 
›_Ën
);

691 ià(
»suÉ
 == 0)

692 
»suÉ
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
pu½o£
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
);

694 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

695 
	`kä“
(
v’dÜ_›
);

697 
ex™
:

698 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

699  
»suÉ
;

700 
	}
}

702 
	$¦si_£t_­_p2p_wps_›
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

704 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

705 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

706 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

707 
»suÉ
 = 0;

708 
u8
 *
·¿ms
;

709 
off£t
 = 0;

710 
	eif_ty³
 {

711 
IF_TYPE_NONE
,

712 
IF_TYPE_P2P_DEVICE
,

713 
IF_TYPE_AP_P2P


714 } 
iáy³
 = 
IF_TYPE_NONE
;

715 
	eäame_ty³
 {

716 
FRAME_TYPE_NONE
,

717 
FRAME_TYPE_BEACON
,

718 
FRAME_TYPE_PROBE_RESPONSE
,

719 
FRAME_TYPE_ASSOC_RESPONSE


720 } 
äam‘y³
 = 
FRAME_TYPE_NONE
;

721 
·¿ms_Ën
 = 
buf_Ën
 - 
	`¡¾’
(
CMD_SETAPP2PWPSIE
) - 1;

723 
·¿ms
 = 
commªd
 + 
	`¡¾’
(
CMD_SETAPP2PWPSIE
) + 1;

724 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

725 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

727 ià(
ioùl_¬gs
->
¬g_couÁ
 < 2) {

728 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

729 
»suÉ
 = -
EINVAL
;

730 
ex™
;

733 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], (*)&
äam‘y³
)) {

734 
	`SLSI_ERR
(
sdev
, "FaedØ»ad f¿mty³ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

735 
»suÉ
 = -
EINVAL
;

736 
ex™
;

738 
off£t
 = off£ˆ+ 
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) + 1;

740 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], (*)&
iáy³
)) {

741 
	`SLSI_ERR
(
sdev
, "FaedØ»ad iáy³ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

742 
»suÉ
 = -
EINVAL
;

743 
ex™
;

745 
off£t
 = off£ˆ+ 
	`¡¾’
(
ioùl_¬gs
->
¬gs
[1]) + 1;

746 
·¿ms_Ën
 =…¬ams_ËÀ- 
off£t
;

748 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_NETDEV
,

750 
commªd
, 
äam‘y³
, 
iáy³
, 
buf_Ën
, 
·¿ms_Ën
);

753 ià(
iáy³
 =ğ
IF_TYPE_P2P_DEVICE
) {

754 
u8
 *
´obe_»¥_›
 = 
NULL
;

756 ià(
äam‘y³
 !ğ
FRAME_TYPE_PROBE_RESPONSE
) {

757 
	`SLSI_NET_ERR
(
dev
, "Wrong frameype„eceived\n");

758 
»suÉ
 = -
EINVAL
;

759 
ex™
;

761 
´obe_»¥_›
 = 
	`km®loc
(
·¿ms_Ën
, 
GFP_KERNEL
);

762 ià(!
´obe_»¥_›
) {

763 
	`SLSI_ERR
(
sdev
, "Malloc for IEs failed\n");

764 
	`kä“
(
ioùl_¬gs
);

765  -
ENOMEM
;

768 
	`memıy
(
´obe_»¥_›
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
);

770 
»suÉ
 = 
	`¦si_p2p_dev_´obe_r¥_›
(
sdev
, 
dev
, 
´obe_»¥_›
, 
·¿ms_Ën
);

771 } ià(
iáy³
 =ğ
IF_TYPE_AP_P2P
) {

772 ià(
äam‘y³
 =ğ
FRAME_TYPE_BEACON
)

773 
»suÉ
 = 
	`¦si_­_v’dÜ_›s_wr™e
(
sdev
, 
dev
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
, 
FAPI_PURPOSE_BEACON
);

774 ià(
äam‘y³
 =ğ
FRAME_TYPE_PROBE_RESPONSE
)

775 
»suÉ
 = 
	`¦si_­_v’dÜ_›s_wr™e
(
sdev
, 
dev
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
, 
FAPI_PURPOSE_PROBE_RESPONSE
);

776 ià(
äam‘y³
 =ğ
FRAME_TYPE_ASSOC_RESPONSE
)

777 
»suÉ
 = 
	`¦si_­_v’dÜ_›s_wr™e
(
sdev
, 
dev
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
, 
FAPI_PURPOSE_ASSOCIATION_RESPONSE
);

779 
ex™
:

780 
	`kä“
(
ioùl_¬gs
);

781  
»suÉ
;

782 
	}
}

789 
	$¦si_p2p_lo_¡¬t
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

791 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

792 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

793 
›“80211_chªÃl
 *
chª
 = 
NULL
;

794 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

795 
chªÃl
, 
du¿tiÚ
, 
š‹rv®
, 
couÁ
;

796 
»t
 = 0;

797 
äeq
;

798 
Æ80211_bªd
 
bªd
;

800 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 4);

801 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

803 ià(
ioùl_¬gs
->
¬g_couÁ
 < 4) {

804 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

805 
	`kä“
(
ioùl_¬gs
);

806  -
EINVAL
;

809 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

815 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_SCANNING
 || sdev->p2p_¡©> 
P2P_LISTENING
 ||

816 (
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
 && !
ndev_vif
->
unsync
.
li¡’_ofæßd
)) {

817 
	`SLSI_NET_ERR
(
dev
, "Rejeù LO dutØÚgošg P2P o³¿tiÚ (¡©e: %s)\n", 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
));

818 
»t
 = -
EINVAL
;

819 
ex™
;

822 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
chªÃl
)) {

823 
	`SLSI_ERR
(
sdev
, "chªÃl: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

824 
»t
 = -
EINVAL
;

825 
ex™
;

828 ià(
chªÃl
 < 1 || channel > 165) {

829 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

830 
»t
 = -
EINVAL
;

831 
ex™
;

834 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
du¿tiÚ
)) {

835 
	`SLSI_ERR
(
sdev
, "du¿tiÚ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

836 
»t
 = -
EINVAL
;

837 
ex™
;

840 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
š‹rv®
)) {

841 
	`SLSI_ERR
(
sdev
, "š‹rv®: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

842 
»t
 = -
EINVAL
;

843 
ex™
;

846 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
couÁ
)) {

847 
	`SLSI_ERR
(
sdev
, "couÁ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

848 
»t
 = -
EINVAL
;

849 
ex™
;

852 ià(!
ndev_vif
->
aùiv©ed
) {

853 
»t
 = 
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, dev->dev_addr);

854 ià(
»t
 != 0) {

855 
	`SLSI_NET_ERR
(
dev
, "Unsync vif‡ddition failed\n");

856 
ex™
;

859 
ndev_vif
->
aùiv©ed
 = 
Œue
;

860 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

861 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

863 
»t
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
SLSI_ACTION_FRAME_PUBLIC
, SLSI_ACTION_FRAME_PUBLIC);

864 ià(
»t
 != 0) {

865 
	`SLSI_NET_ERR
(
dev
, "Action frame„egistration for unsync vif failed\n");

866 
ex™_w™h_vif_d—ùiv©e
;

873 
bªd
 = (
chªÃl
 <ğ14è? 
NL80211_BAND_2GHZ
 : 
NL80211_BAND_5GHZ
;

874 
äeq
 = 
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

875 
chª
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

876 ià(!
chª
) {

877 
	`SLSI_NET_ERR
(
dev
, "IncÜ»ù chªÃl: %u - Li¡’ Ofæßd faed\n", 
chªÃl
);

878 
»t
 = -
EINVAL
;

879 
ex™_w™h_vif_d—ùiv©e
;

882 
»t
 = 
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
du¿tiÚ
, 
š‹rv®
, 
couÁ
);

883 ià(
»t
 != 0) {

884 
	`SLSI_NET_ERR
(
dev
, "Set channel for unsync vif failed\n");

885 
ex™_w™h_vif_d—ùiv©e
;

887 
ndev_vif
->
chª
 = chan;

888 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

896 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
š‹rv®
 * 
couÁ
 + 1000);

897 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
Œue
;

898 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_LISTENING
);

899 
ex™
;

901 
ex™_w™h_vif_d—ùiv©e
:

902 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

903 
ex™
:

904 
	`kä“
(
ioùl_¬gs
);

905 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

906  
»t
;

907 
	}
}

914 
	$¦si_p2p_lo_¡İ
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

916 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

918 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

920 
	`WARN_ON
((!
ndev_vif
->
unsync
.
li¡’_ofæßd
è|| (ndev_vif->
sdev
->
p2p_¡©e
 !ğ
P2P_LISTENING
));

922 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

925 ià(
ndev_vif
->
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
)

926 
	`¦si_p2p_vif_d—ùiv©e
(
ndev_vif
->
sdev
,‚dev_vif->
wdev
.
Ãtdev
, 
Œue
);

928 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

931 
	}
}

933 
	$¦si_rx_f‹r_add
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

935 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

936 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

937 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

938 
»t
 = 0;

939 
f‹r_num
 = 0;

941 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

942 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

944 
f‹r_num
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

945 ià(
f‹r_num
 < 0 || filter_num > 3) {

946 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàf‹r_num %d\n", 
f‹r_num
);

947 
	`kä“
(
ioùl_¬gs
);

948  -
EINVAL
;

950 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

951 
sdev
->
deviû_cÚfig
.
rx_f‹r_num
 = 
f‹r_num
;

952 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

954 
	`kä“
(
ioùl_¬gs
);

955  
»t
;

956 
	}
}

958 
	$¦si_rx_f‹r_»move
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

960 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

961 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

963 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

964 
sdev
->
deviû_cÚfig
.
rx_f‹r_num
 = 0;

965 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

968 
	}
}

970 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


971 #ià!
defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 9)

972 
	$¦si_ü—‹_š‹rçû
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

974 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

975 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

976 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

977 
Ãt_deviû
 *
­_dev
;

978 *
štf_Çme
 = 
NULL
;

980 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

981 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

983 
štf_Çme
 = 
ioùl_¬gs
->
¬gs
[0];

984 ià(
	`¡rcmp
(
CONFIG_SCSC_AP_INTERFACE_NAME
, 
štf_Çme
) != 0) {

985 
	`SLSI_NET_ERR
(
dev
, "C»©iÚ oà% nÙ‡Îowed!\n", 
štf_Çme
);

986 
	`kä“
(
ioùl_¬gs
);

987  -
EINVAL
;

989 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

990 ià(
­_dev
 && (
	`¡rcmp
×p_dev->
Çme
, 
štf_Çme
) == 0)) {

991 
	`SLSI_NET_ERR
(
dev
, "% ®»ady c»©ed\n", 
štf_Çme
);

992 
	`kä“
(
ioùl_¬gs
);

993  -
EINVAL
;

996 
­_dev
 = 
	`¦si_dyÇmic_š‹rçû_ü—‹
(
sdev
->
why
, 
štf_Çme
, 
NL80211_IFTYPE_AP
, 
NULL
);

997 ià(
­_dev
) {

998 
sdev
->
Ãtdev_­
 = 
­_dev
;

999 
	`kä“
(
ioùl_¬gs
);

1003 
	`SLSI_NET_ERR
(
dev
, "FaedØü—‹ AP iÁ”çû %s\n", 
štf_Çme
);

1004 
	`kä“
(
ioùl_¬gs
);

1005  -
EINVAL
;

1006 
	}
}

1008 
	$¦si_d–‘e_š‹rçû
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

1010 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1011 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1012 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1013 *
štf_Çme
 = 
NULL
;

1015 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

1016 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1018 
štf_Çme
 = 
ioùl_¬gs
->
¬gs
[0];

1019 ià(
	`¡rcmp
(
CONFIG_SCSC_AP_INTERFACE_NAME
, 
štf_Çme
) != 0) {

1020 
	`SLSI_NET_ERR
(
dev
, "D–‘iÚ oà% nÙ‡Îowed!\n", 
štf_Çme
);

1021 
	`kä“
(
ioùl_¬gs
);

1022  -
EINVAL
;

1024 ià(
	`¡rcmp
(
štf_Çme
, 
CONFIG_SCSC_AP_INTERFACE_NAME
) == 0)

1025 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

1027 ià(!
dev
) {

1028 
	`SLSI_WARN
(
sdev
, "AP dev is NULL");

1029 
	`kä“
(
ioùl_¬gs
);

1030  -
EINVAL
;

1032 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1034 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1035 ià(
ndev_vif
->
aùiv©ed
)

1036 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

1037 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1038 
	`¦si_Ãtif_»move_¹Êl_locked
(
sdev
, 
dev
);

1040 
sdev
->
Ãtdev_­
 = 
NULL
;

1041 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "SucûssfuÎy d–‘ed AP iÁ”çû % ", 
štf_Çme
);

1043 
	`kä“
(
ioùl_¬gs
);

1045 
	}
}

1048 
	$¦si_g‘_šdoÜ_chªÃls
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1050 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1051 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1052 
İ
[150] = "";

1053 
št_¡ršg
[30] = "";

1054 
i
;

1055 
Ën
 = 0;

1057 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "GET_INDOOR_CHANNELS : %d\n", 
sdev
->
num_5g_»¡riùed_chªÃls
);

1059 
i
 = 0; i < 
sdev
->
num_5g_»¡riùed_chªÃls
; i++) {

1060 
	`¥rštf
(
št_¡ršg
, "%d", 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
]);

1061 
	`¡rÿt
(
İ
, 
št_¡ršg
);

1062 
	`¡rÿt
(
İ
, " ");

1065 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d %s", 
sdev
->
num_5g_»¡riùed_chªÃls
, 
İ
);

1067  
Ën
;

1068 
	}
}

1071 
	$¦si_Ëgacy_rßm_Œigg”_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1073 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1074 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1075 
Œigg”_v®ue
 = 0;

1076 
»t
 = 0;

1077 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1079 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1080 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1082 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Œigg”_v®ue
)) {

1083 
	`SLSI_ERR
(
sdev
, "Inv®idrigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1084 
	`kä“
(
ioùl_¬gs
);

1085  -
EINVAL
;

1088 ià(
Œigg”_v®ue
 > -50 ||rigger_value < -100) {

1089 
	`SLSI_ERR
(
sdev
, "Inv®idrigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1090 
	`kä“
(
ioùl_¬gs
);

1091  -
EINVAL
;

1094 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1095 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1096 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1097 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1098 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1099 
	`kä“
(
ioùl_¬gs
);

1100  -
EINVAL
;

1102 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1105 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1106 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1107 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

1108 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1109 
	`kä“
(
ioùl_¬gs
);

1110  -
EPERM
;

1112 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER
, 
Œigg”_v®ue
, 1);

1113 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1115 
	`kä“
(
ioùl_¬gs
);

1116  
»t
;

1117 
	}
}

1119 
	$¦si_Ëgacy_rßm_sÿn_Œigg”_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1121 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1122 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1123 
mib_v®ue
 = 0;

1124 
»s
 = 0;

1126 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1127 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1128 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1129 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1130 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1131  -
EINVAL
;

1133 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1136 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER
, &
mib_v®ue
);

1137 ià(
»s
)

1138  
»s
;

1139 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMTRIGGER
, 
mib_v®ue
);

1140  
»s
;

1141 
	}
}

1143 
	$¦si_rßm_add_sÿn_äequ’c›s_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1145 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1146 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1147 
»suÉ
 = 0;

1148 
i
, 
j
;

1149 
Ãw_chªÃls
[
SLSI_MAX_CHANNEL_LIST
];

1150 
cu¼_chªÃl_couÁ
 = 0;

1151 
found
 = 0;

1152 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1153 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

1154 
u32
 
ÃtwÜk_m­_chªÃls_couÁ
 = 0;

1155 
u8
 
ÃtwÜk_m­_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

1156 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

1157 
u32
 
m”ge_chª_couÁ
 = 0;

1158 
Ãw_äeq_couÁ
 = 0;

1159 
Ãw_äeqs
[
SLSI_MAX_FREQUENCY_LIST
] = {0};

1161 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

1162 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1164 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1165 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

1166 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1167 
	`SLSI_NET_ERR
(
dev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

1168 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1169 
	`kä“
(
ioùl_¬gs
);

1170  -
EPERM
;

1172 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1173 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1174 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1175 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1176 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1177 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1178 
	`kä“
(
ioùl_¬gs
);

1179  -
EINVAL
;

1183 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 =ğ
SLSI_MAX_CHANNEL_LIST
) {

1184 
	`SLSI_ERR
(
sdev
, "Roam scan†ist is‡lready full\n");

1185 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1186 
	`kä“
(
ioùl_¬gs
);

1187  -
EINVAL
;

1191 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1192 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 == 0) {

1193 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 = 1;

1194 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[0] = 
ndev_vif
->
chª
->
hw_v®ue
;

1196 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1198 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ãw_äeq_couÁ
)) {

1199 
	`SLSI_ERR
(
sdev
, "Inv®id f»q_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1200 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1201 
	`kä“
(
ioùl_¬gs
);

1202  -
EINVAL
;

1205 ià(
Ãw_äeq_couÁ
 < 1 ||‚ew_äeq_couÁ > 
SLSI_MAX_FREQUENCY_LIST
 ||

1206 (
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
Ãw_äeq_couÁ
) {

1207 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàäeq_couÁ %d\n", 
Ãw_äeq_couÁ
);

1208 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1209 
	`kä“
(
ioùl_¬gs
);

1210  -
EINVAL
;

1212 
cu¼_chªÃl_couÁ
 = 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
;

1213 
i
 = 0; i < 
Ãw_äeq_couÁ
; i++) {

1214 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
Ãw_äeqs
[i])) {

1215 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1216 
	`kä“
(
ioùl_¬gs
);

1217  -
EINVAL
;

1220 
Ãw_chªÃls
[
i
] = 
	`›“80211_äequ’cy_to_chªÃl
(
Ãw_äeqs
[i]);

1222 ià(
Ãw_chªÃls
[
i
] < 1 ||‚ew_channels[i] > 165) {

1223 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
Ãw_chªÃls
[
i
]);

1224 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1225 
	`kä“
(
ioùl_¬gs
);

1226  -
EINVAL
;

1228 
j
 = 0; j < 
cu¼_chªÃl_couÁ
; j++) {

1229 
found
 = 0;

1230 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[
j
] =ğ
Ãw_chªÃls
[
i
]) {

1231 
found
 = 1;

1235 ià(!
found
) {

1236 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[
cu¼_chªÃl_couÁ
] = 
Ãw_chªÃls
[
i
];

1237 
cu¼_chªÃl_couÁ
++;

1239 ià(
cu¼_chªÃl_couÁ
 >ğ
SLSI_MAX_CHANNEL_LIST
) {

1240 
cu¼_chªÃl_couÁ
 = 
SLSI_MAX_CHANNEL_LIST
;

1245 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 = 
cu¼_chªÃl_couÁ
;

1247 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1248 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

1249 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

1251 
ÃtwÜk_m­_chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
cÚÃùed_ssid
, 
ÃtwÜk_m­_chªÃls
);

1252 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
ÃtwÜk_m­_chªÃls
, 
ÃtwÜk_m­_chªÃls_couÁ
,

1253 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
,

1254 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
,

1255 
m”ged_chªÃls
);

1257 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
);

1258 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1259 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1261 
	`kä“
(
ioùl_¬gs
);

1262  
»suÉ
;

1263 
	}
}

1265 
	$¦si_rßm_add_sÿn_chªÃls_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1267 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1268 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1269 
»suÉ
 = 0;

1270 
i
, 
j
, 
Ãw_chªÃl_couÁ
 = 0;

1271 
Ãw_chªÃls
[
SLSI_MAX_CHANNEL_LIST
];

1272 
cu¼_chªÃl_couÁ
 = 0;

1273 
found
 = 0;

1274 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1275 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

1276 
u32
 
ÃtwÜk_m­_chªÃls_couÁ
 = 0;

1277 
u8
 
ÃtwÜk_m­_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

1278 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

1279 
u32
 
m”ge_chª_couÁ
 = 0;

1281 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

1282 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1284 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1285 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

1286 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1287 
	`SLSI_NET_ERR
(
dev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

1288 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1289 
	`kä“
(
ioùl_¬gs
);

1290  -
EPERM
;

1292 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1293 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1294 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1295 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1296 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled.\n");

1297 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1298 
	`kä“
(
ioùl_¬gs
);

1299  -
EINVAL
;

1303 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 =ğ
SLSI_MAX_CHANNEL_LIST
) {

1304 
	`SLSI_ERR
(
sdev
, "Roam scan†ist is‡lready full\n");

1305 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1306 
	`kä“
(
ioùl_¬gs
);

1307  -
EINVAL
;

1311 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1312 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 =ğ0 && 
ndev_vif
->
chª
) {

1313 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 = 1;

1314 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[0] = 
ndev_vif
->
chª
->
hw_v®ue
;

1316 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1317 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ãw_chªÃl_couÁ
)) {

1318 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1319 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1320 
	`kä“
(
ioùl_¬gs
);

1321  -
EINVAL
;

1324 ià(
Ãw_chªÃl_couÁ
 < 1 ||‚ew_chªÃl_couÁ > 
SLSI_MAX_CHANNEL_LIST
 || (
ioùl_¬gs
->
¬g_couÁ
 - 1) <‚ew_channel_count) {

1325 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàchªÃl_couÁ %d\n", 
Ãw_chªÃl_couÁ
);

1326 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1327 
	`kä“
(
ioùl_¬gs
);

1328  -
EINVAL
;

1330 
cu¼_chªÃl_couÁ
 = 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
;

1332 
i
 = 0; i < 
Ãw_chªÃl_couÁ
; i++) {

1333 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
Ãw_chªÃls
[i])) {

1334 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1335 
	`kä“
(
ioùl_¬gs
);

1336  -
EINVAL
;

1338 ià(
Ãw_chªÃls
[
i
] < 1 ||‚ew_channels[i] > 165) {

1339 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
Ãw_chªÃls
[
i
]);

1340 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1341 
	`kä“
(
ioùl_¬gs
);

1342  -
EINVAL
;

1344 
j
 = 0; j < 
cu¼_chªÃl_couÁ
; j++) {

1345 
found
 = 0;

1346 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[
j
] =ğ
Ãw_chªÃls
[
i
]) {

1347 
found
 = 1;

1351 ià(!
found
) {

1352 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[
cu¼_chªÃl_couÁ
] = 
Ãw_chªÃls
[
i
];

1353 
cu¼_chªÃl_couÁ
++;

1355 ià(
cu¼_chªÃl_couÁ
 >ğ
SLSI_MAX_CHANNEL_LIST
) {

1356 
cu¼_chªÃl_couÁ
 = 
SLSI_MAX_CHANNEL_LIST
;

1361 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 = 
cu¼_chªÃl_couÁ
;

1363 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1364 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

1365 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

1367 
ÃtwÜk_m­_chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
cÚÃùed_ssid
, 
ÃtwÜk_m­_chªÃls
);

1368 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
ÃtwÜk_m­_chªÃls
, 
ÃtwÜk_m­_chªÃls_couÁ
,

1369 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
,

1370 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
,

1371 
m”ged_chªÃls
);

1373 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
);

1374 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1375 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1377 
	`kä“
(
ioùl_¬gs
);

1378  
»suÉ
;

1379 
	}
}

1381 
	$¦si_rßm_sÿn_äequ’c›s_»ad_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1383 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1384 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1385 
äeq_li¡
[
MAX_FREQUENCY_COUNT
] = {0};

1386 
sk_buff
 *
šd
 = 
NULL
;

1387 
pos
 = 0;

1388 
i
;

1389 
äeq_couÁ
 = 0;

1391 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1392 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1393 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1394 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1395 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1396  -
EINVAL
;

1398 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1400 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1401 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1402 
	`SLSI_NET_ERR
(
dev
, "STA is‚ot in connected state\n");

1403 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1404 
äeq_couÁ
 = 0;

1405 
ouut
;

1408 
šd
 = 
	`¦si_mlme_rßmšg_chªÃl_li¡_»q
(
sdev
, 
dev
);

1409 ià(!
šd
) {

1410 
	`SLSI_ERR
(
sdev
, "RCL ind is NULL!\n");

1411 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1412  -
EINVAL
;

1415 
äeq_couÁ
 = 
	`¦si_g‘_rş_äeq_li¡
(
sdev
, 
šd
, 
äeq_li¡
);

1417 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1419 ià(!
äeq_couÁ
) {

1420 
	`SLSI_ERR
(
sdev
, "Frequency count is 0!\n");

1421  -
EINVAL
;

1424 
ouut
:

1425 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANFREQUENCIES_LEGACY
, 
äeq_couÁ
);

1426 
i
 = 0; i < 
äeq_couÁ
; i++)

1427 
pos
 +ğ
	`sú´štf
(
commªd
 +…os, 
buf_Ën
 -…os, " %d", 
äeq_li¡
[
i
]);

1429  
pos
;

1430 
	}
}

1432 
	$¦si_rßm_sÿn_chªÃls_»ad_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1434 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1435 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1436 
u16
 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

1437 
sk_buff
 *
šd
 = 
NULL
;

1438 
pos
 = 0;

1439 
i
;

1440 
chªÃl_couÁ
 = 0;

1442 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1443 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1444 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1445 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1446 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1447  -
EINVAL
;

1449 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1451 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1452 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1453 
	`SLSI_NET_ERR
(
dev
, "STA is‚ot in connected state\n");

1454 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1455 
chªÃl_couÁ
 = 0;

1456 
ouut
;

1459 
šd
 = 
	`¦si_mlme_rßmšg_chªÃl_li¡_»q
(
sdev
, 
dev
);

1460 ià(!
šd
) {

1461 
	`SLSI_ERR
(
sdev
, "RCL ind is NULL!\n");

1462 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1463  -
EINVAL
;

1466 
chªÃl_couÁ
 = 
	`¦si_g‘_rş_chªÃl_li¡
(
sdev
, 
šd
, 
chªÃl_li¡
);

1467 ià(!
chªÃl_couÁ
) {

1468 
	`SLSI_ERR
(
sdev
, "Channel count is 0!");

1469 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1470  -
EINVAL
;

1472 
ouut
:

1473 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANCHANNELS
, 
chªÃl_couÁ
);

1474 
i
 = 0; i < 
chªÃl_couÁ
; i++)

1475 
pos
 +ğ
	`sú´štf
(
commªd
 +…os, 
buf_Ën
 -…os, " %d", 
chªÃl_li¡
[
i
]);

1477 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1478  
pos
;

1479 
	}
}

1481 
	$¦si_»assoc_äequ’cy_wr™e_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1483 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1484 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1485 
u8
 
bssid
[6] = { 0 };

1486 
äeq
;

1487 
r
 = 0;

1488 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1490 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

1491 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1493 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1494 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1495 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1496 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled.\n");

1497 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1498 
	`kä“
(
ioùl_¬gs
);

1499  -
EINVAL
;

1501 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1503 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

1504 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

1505 
	`kä“
(
ioùl_¬gs
);

1506  -
EINVAL
;

1509 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

1511 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
äeq
)) {

1512 
	`SLSI_ERR
(
sdev
, "Inv®id f»qu’cy sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

1513 
	`kä“
(
ioùl_¬gs
);

1514  -
EINVAL
;

1517 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1519 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

1521 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1522 
	`kä“
(
ioùl_¬gs
);

1523  
r
;

1524 
	}
}

1526 
	$¦si_»assoc_wr™e_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1528 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1529 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1530 
u8
 
bssid
[6] = { 0 };

1531 
chªÃl
;

1532 
äeq
;

1533 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

1534 
r
 = 0;

1535 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1537 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

1538 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1540 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1541 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1542 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1543 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1544 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1545 
	`kä“
(
ioùl_¬gs
);

1546  -
EINVAL
;

1548 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1550 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

1551 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

1552 
	`kä“
(
ioùl_¬gs
);

1553  -
EINVAL
;

1556 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

1557 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

1558 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

1559 
	`kä“
(
ioùl_¬gs
);

1560  -
EINVAL
;

1563 ià(
chªÃl
 < 1 || channel > 165) {

1564 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

1565 
	`kä“
(
ioùl_¬gs
);

1566  -
EINVAL
;

1569 ià(
chªÃl
 > 14)

1570 
bªd
 = 
NL80211_BAND_5GHZ
;

1571 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

1573 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1574 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1576 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

1578 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1579 
	`kä“
(
ioùl_¬gs
);

1580  
r
;

1581 
	}
}

1583 
	$¦si_£t_couÁry_»v
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

1585 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1586 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1587 
®pha2_»v
[] = {0, 0, 0, 0};

1588 
¡©us
 = 0;

1589 *
couÁry_code
 = 
NULL
;

1590 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1592 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

1593 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1595 
couÁry_code
 = 
ioùl_¬gs
->
¬gs
[0];

1596 
	`memıy
(
®pha2_»v
, 
couÁry_code
, 
	`¡¾’
(country_code) < 4 ? strlen(country_code) : 4);

1598 
¡©us
 = 
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
®pha2_»v
, 
	`¡¾’
(
couÁry_code
) < 4 ? strlen(country_code) : 4);

1600 
	`kä“
(
ioùl_¬gs
);

1601  
¡©us
;

1602 
	}
}

1604 
	$¦si_g‘_couÁry_»v
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1606 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1607 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1608 
u8
 
buf
[5];

1609 
Ën
 = 0;

1611 
	`mem£t
(
buf
, 0, (buf));

1613 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %c%ø%d", 
CMD_GETCOUNTRYREV
,

1614 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[0],

1615 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[1],

1616 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
dfs_»giÚ
);

1618  
Ën
;

1619 
	}
}

1621 
	$¦si_ioùl_£t_rßm_bªd
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

1623 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1624 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1625 
ušt
 
rßm_bªd
 = 0;

1626 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1627 
»t
 = 0;

1629 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1631 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

1632 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1634 
rßm_bªd
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

1635 ià(
rßm_bªd
 > 
SLSI_MAX_ROAMBAND_VALUE
) {

1636 
	`SLSI_ERR
(
sdev
, "Inv®id v®ufÜ Rßm Bªd %d\n", 
rßm_bªd
);

1637 
	`kä“
(
ioùl_¬gs
);

1638  -
EINVAL
;

1643 ià(
rßm_bªd
 =ğ
FAPI_BAND_AUTO
) {

1644 
rßm_bªd
 = 
FAPI_BAND_2_4GHZ
;

1645 ià(
sdev
->
bªd_5g_suµÜ‹d
)

1646 
rßm_bªd
 |ğ
FAPI_BAND_5GHZ
;

1647 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


1648 ià(
sdev
->
bªd_6g_suµÜ‹d
)

1649 
rßm_bªd
 |ğ
FAPI_BAND_6GHZ
;

1653 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1654 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1655 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1656 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1657 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1658 
	`kä“
(
ioùl_¬gs
);

1659  -
EINVAL
;

1662 ià(
sdev
->
deviû_cÚfig
.
suµÜ‹d_rßm_bªd
 =ğ
rßm_bªd
) {

1663 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "rßm bªd i ®»ady %d\n", 
rßm_bªd
);

1664 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1665 
	`kä“
(
ioùl_¬gs
);

1666  
»t
;

1669 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1670 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1671 
»t
 = 
	`¦si_mlme_£t_bªd_»q
(
sdev
, 
dev
, 
rßm_bªd
, 1);

1672 ià(
»t
 =ğ-
EIO
) {

1673 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1674 
	`kä“
(
ioùl_¬gs
);

1675  
»t
;

1677 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1679 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1680 
sdev
->
deviû_cÚfig
.
suµÜ‹d_rßm_bªd
 = 
rßm_bªd
;

1681 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1682 
	`kä“
(
ioùl_¬gs
);

1683  
»t
;

1685 
	`SLSI_ERR
(
sdev
, "NCHO is‚ot supported\n");

1687 
	`kä“
(
ioùl_¬gs
);

1688  -
EINVAL
;

1690 
	}
}

1692 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1693 
ušt
 
	$¦si_bªd_to_fw_bªd_m­šg
(
ušt
 
bªd
)

1695 
bªd
) {

1696 
SLSI_FREQ_BAND_AUTO
:

1697  
FAPI_BAND_2_4GHZ_5GHZ
;

1698 
SLSI_FREQ_BAND_5GHZ
:

1699  
FAPI_BAND_5GHZ
;

1700 
SLSI_FREQ_BAND_2GHZ
:

1701  
FAPI_BAND_2_4GHZ
;

1702 
SLSI_FREQ_BAND_2_4GHZ_5GHZ_6GHZ
:

1703  
FAPI_BAND_2_4GHZ_5GHZ_6GHZ
;

1704 
SLSI_FREQ_BAND_6GHZ
:

1705  
FAPI_BAND_6GHZ
;

1706 
SLSI_FREQ_BAND_5GHZ_6GHZ
:

1707  
FAPI_BAND_5GHZ_6GHZ
;

1708 
SLSI_FREQ_BAND_2_4GHZ_6GHZ
:

1709  
FAPI_BAND_2_4GHZ_6GHZ
;

1713 
	}
}

1716 
	$¦si_ioùl_£t_bªd
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

1718 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1719 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1720 
ušt
 
bªd
 = 0;

1721 
ušt
 
š‹º®_bªd
 = 0;

1722 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1723 
»t
 = 0;

1725 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1727 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

1728 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1730 
bªd
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

1731 ià(
bªd
 > 
SLSI_MAX_BAND_VALUE
) {

1732 
	`SLSI_ERR
(
sdev
, "Inv®id v®ufÜ Bªd %d\n", 
bªd
);

1733 
	`kä“
(
ioùl_¬gs
);

1734  -
EINVAL
;

1737 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1738 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1739 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1740 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1741 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1742 
	`kä“
(
ioùl_¬gs
);

1743  -
EINVAL
;

1746 ià(
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 =ğ
bªd
) {

1747 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "bªd i ®»ady %d\n", 
bªd
);

1748 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1749 
	`kä“
(
ioùl_¬gs
);

1750  
»t
;

1752 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1754 
š‹º®_bªd
 = 
	`¦si_bªd_to_fw_bªd_m­šg
(
bªd
);

1755 ià(
š‹º®_bªd
 < 0) {

1756 
	`SLSI_ERR
(
sdev
, "Inv®id v®ufÜ Bªd = %d\n", 
bªd
);

1757 
	`kä“
(
ioùl_¬gs
);

1758  -
EINVAL
;

1760 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1761 
»t
 = 
	`¦si_mlme_£t_bªd_»q
(
sdev
, 
dev
, 
š‹º®_bªd
, 0);

1762 ià(
»t
 =ğ-
EIO
) {

1763 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1764 
	`kä“
(
ioùl_¬gs
);

1765  
»t
;

1767 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1769 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1770 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
bªd
;

1771 
	`¦si_bªd_cfg_upd©e
(
sdev
, 
bªd
);

1772 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1774 
	`kä“
(
ioùl_¬gs
);

1775  
»t
;

1777 
	`SLSI_ERR
(
sdev
, "NCHO is‚ot supported\n");

1779 
	`kä“
(
ioùl_¬gs
);

1780  -
EINVAL
;

1782 
	}
}

1783 
	$¦si_ioùl_g‘_rßm_bªd
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1785 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1786 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1787 
pos
 = 0;

1789 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1791 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1792 ià(
	`¦si_is_‹¡_mode_’abËd
(è|| 
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1794 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1796 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMBAND
, 
sdev
->
deviû_cÚfig
.
suµÜ‹d_rßm_bªd
);

1798 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1799 
pos
 = -
EINVAL
;

1802 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1803  
pos
;

1804 
	}
}

1806 
	$¦si_ioùl_g‘_bªd
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1808 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1809 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1810 
pos
 = 0;

1812 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1814 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1815 ià(
	`¦si_is_‹¡_mode_’abËd
(è|| 
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1817 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1819 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETBAND
, 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
);

1821 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1822 
pos
 = -
EINVAL
;

1825 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1826  
pos
;

1827 
	}
}

1829 
	$¦si_çùÜy_äeq_bªd_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

1831 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1832 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1833 
ušt
 
bªd
 = 0;

1834 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1836 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

1837 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1839 
bªd
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

1840 ià(
bªd
 > 2) {

1841 
	`SLSI_ERR
(
sdev
, "Inv®id v®u: Bªd Mu¡ b0/1/2 bªd %d\n", 
bªd
);

1842 
	`kä“
(
ioùl_¬gs
);

1843  -
EINVAL
;

1846 
	`¦si_bªd_upd©e
(
sdev
, 
bªd
);

1848 
	`kä“
(
ioùl_¬gs
);

1849  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_SCAN_BAND
, (
bªd
 =ğ
SLSI_FREQ_BAND_AUTO
) ? 2 : 1);

1850 
	}
}

1852 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1853 
	$¦si_rßm_sÿn_Œigg”_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1855 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1856 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1857 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1858 
mib_v®ue
 = 0;

1859 
»t
 = 0;

1861 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1862 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1864 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1865 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1866 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1867 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1868 
	`kä“
(
ioùl_¬gs
);

1869  -
EINVAL
;

1871 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1873 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1874 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1875 
	`kä“
(
ioùl_¬gs
);

1876  -
EINVAL
;

1879 ià(
mib_v®ue
 > -50 || mib_value < -100) {

1880 
	`SLSI_ERR
(
sdev
, "Inv®idrigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1881 
	`kä“
(
ioùl_¬gs
);

1882  -
EINVAL
;

1885 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1886 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER
, 
mib_v®ue
, 1);

1887 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1888 
	`kä“
(
ioùl_¬gs
);

1889  
»t
;

1890 
	}
}

1892 
	$¦si_rßm_sÿn_Œigg”_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1894 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1895 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1896 
mib_v®ue
 = 0;

1897 
»s
;

1899 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1900 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1901 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1902 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1903  -
EINVAL
;

1905 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1907 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER
, &
mib_v®ue
);

1908 ià(
»s
)

1909  
»s
;

1910 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMTRIGGER
, 
mib_v®ue
);

1911  
»s
;

1912 
	}
}

1914 
	$¦si_rßm_d–_Œigg”_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1916 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1917 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1918 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1919 
mib_v®ue
 = 0;

1920 
»t
 = 0;

1922 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1923 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1925 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1926 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1927 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1928 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1929 
	`kä“
(
ioùl_¬gs
);

1930  -
EINVAL
;

1932 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1934 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1935 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1936 
	`kä“
(
ioùl_¬gs
);

1937  -
EINVAL
;

1940 ià(
mib_v®ue
 > 100 || mib_value < 0) {

1941 
	`SLSI_ERR
(
sdev
, "Inv®id d–rigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1942 
	`kä“
(
ioùl_¬gs
);

1943  -
EINVAL
;

1946 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1947 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_DELTA
, 
mib_v®ue
, 1);

1948 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1949 
	`kä“
(
ioùl_¬gs
);

1950  
»t
;

1951 
	}
}

1953 
	$¦si_rßm_d–_Œigg”_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1955 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1956 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1957 
mib_v®ue
 = 0;

1958 
»s
;

1960 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1961 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1962 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1963 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1964  -
EINVAL
;

1966 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1968 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_DELTA
, &
mib_v®ue
);

1969 ià(
»s
)

1970  
»s
;

1972 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMDELTA
, 
mib_v®ue
);

1973  
»s
;

1974 
	}
}

1976 
	$¦si_»assoc_äequ’cy_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1978 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1979 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1980 
u8
 
bssid
[6] = { 0 };

1981 
äeq
 = 0;

1982 
r
 = 0;

1983 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1985 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

1986 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1988 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1989 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1990 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1991 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1992 
	`kä“
(
ioùl_¬gs
);

1993  -
EINVAL
;

1995 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1996 ià(
ioùl_¬gs
->
¬g_couÁ
 != 2) {

1997 
	`SLSI_ERR
(
sdev
, "Notƒnough‡rguments\n");

1998 
	`kä“
(
ioùl_¬gs
);

1999  -
EINVAL
;

2002 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

2003 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

2004 
	`kä“
(
ioùl_¬gs
);

2005  -
EINVAL
;

2008 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

2010 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
äeq
)) {

2011 
	`SLSI_ERR
(
sdev
, "Inv®id f»q sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

2012 
	`kä“
(
ioùl_¬gs
);

2013  -
EINVAL
;

2016 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2018 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

2020 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2022 
	`kä“
(
ioùl_¬gs
);

2023  
r
;

2024 
	}
}

2026 
	$¦si_»assoc_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2028 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2029 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2030 
u8
 
bssid
[6] = { 0 };

2031 
chªÃl
 = 0;

2032 
äeq
 = 0;

2033 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

2034 
r
 = 0;

2035 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2037 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

2038 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2040 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2041 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2042 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2043 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2044 
	`kä“
(
ioùl_¬gs
);

2045  -
EINVAL
;

2047 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2048 ià(
ioùl_¬gs
->
¬g_couÁ
 != 2) {

2049 
	`SLSI_ERR
(
sdev
, "Notƒnough‡rguments\n");

2050 
	`kä“
(
ioùl_¬gs
);

2051  -
EINVAL
;

2054 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

2055 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

2056 
	`kä“
(
ioùl_¬gs
);

2057  -
EINVAL
;

2060 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

2062 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

2063 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

2064 
	`kä“
(
ioùl_¬gs
);

2065  -
EINVAL
;

2068 ià(
chªÃl
 < 1 || channel > 165) {

2069 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

2070 
	`kä“
(
ioùl_¬gs
);

2071  -
EINVAL
;

2074 ià(
chªÃl
 > 14)

2075 
bªd
 = 
NL80211_BAND_5GHZ
;

2076 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

2078 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2079 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2081 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

2083 
	`kä“
(
ioùl_¬gs
);

2084 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2085  
r
;

2086 
	}
}

2088 
	$¦si_ÿched_chªÃl_sÿn_³riod_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2090 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2091 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2092 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2093 
mib_v®ue
 = 0;

2094 
»t
 = 0;

2096 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2097 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2099 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2100 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2101 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2102 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2103 
	`kä“
(
ioùl_¬gs
);

2104  -
EINVAL
;

2106 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2108 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2109 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2110 
	`kä“
(
ioùl_¬gs
);

2111  -
EINVAL
;

2114 ià(
mib_v®ue
 > 60 || mib_value < 0) {

2115 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm sÿÀ³riod: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2116 
	`kä“
(
ioùl_¬gs
);

2117  -
EINVAL
;

2119 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2120 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_CACHED_SCAN_PERIOD
, 
mib_v®ue
 * 1000000, 4);

2121 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2122 
	`kä“
(
ioùl_¬gs
);

2123  
»t
;

2124 
	}
}

2126 
	$¦si_ÿched_chªÃl_sÿn_³riod_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2128 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2129 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2130 
mib_v®ue
 = 0;

2131 
»s
;

2133 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2134 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2135 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2136 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2137  -
EINVAL
;

2139 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2141 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_CACHED_SCAN_PERIOD
, &
mib_v®ue
);

2142 ià(
»s
)

2143  
»s
;

2145 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANPERIOD
, 
mib_v®ue
 / 1000000);

2147  
»s
;

2148 
	}
}

2150 
	$¦si_fuÎ_rßm_sÿn_³riod_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2152 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2153 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2154 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2155 
mib_v®ue
 = 0;

2156 
»t
 = 0;

2158 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2159 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2161 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2162 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2163 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2164 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2165 
	`kä“
(
ioùl_¬gs
);

2166  -
EINVAL
;

2168 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2170 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2171 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2172 
	`kä“
(
ioùl_¬gs
);

2173  -
EINVAL
;

2175 ià(
mib_v®ue
 > 600 || mib_value < 0) {

2176 
	`SLSI_ERR
(
sdev
, "Inv®id fuÎ„ßm sÿÀ³riod: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2177 
	`kä“
(
ioùl_¬gs
);

2178  -
EINVAL
;

2180 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2181 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_FULL_SCAN_PERIOD
, 
mib_v®ue
 * 1000000, 4);

2182 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2183 
	`kä“
(
ioùl_¬gs
);

2184  
»t
;

2185 
	}
}

2187 
	$¦si_fuÎ_rßm_sÿn_³riod_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2189 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2190 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2191 
mib_v®ue
 = 0;

2192 
»s
;

2194 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2195 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2196 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2197 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2198  -
EINVAL
;

2200 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2202 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_FULL_SCAN_PERIOD
, &
mib_v®ue
);

2203 ià(
»s
)

2204  
»s
;

2206 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETFULLROAMSCANPERIOD
, 
mib_v®ue
 / 1000000);

2208  
»s
;

2209 
	}
}

2211 
	$¦si_rßm_sÿn_max_aùive_chªÃl_time_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2213 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2214 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2215 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2216 
mib_v®ue
 = 0;

2218 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2219 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2221 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2222 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2223 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2224 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2225 
	`kä“
(
ioùl_¬gs
);

2226  -
EINVAL
;

2228 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2230 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2231 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2232 
	`kä“
(
ioùl_¬gs
);

2233  -
EINVAL
;

2235 ià(
mib_v®ue
 > 300 || mib_value < 3) {

2236 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀchªÃÈtime: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2237 
	`kä“
(
ioùl_¬gs
);

2238  -
EINVAL
;

2241 
	`kä“
(
ioùl_¬gs
);

2242  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_MAX_ACTIVE_CHANNEL_TIME
, 
mib_v®ue
);

2243 
	}
}

2245 
	$¦si_rßm_sÿn_max_aùive_chªÃl_time_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2247 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2248 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2249 
mib_v®ue
 = 0;

2250 
»s
;

2252 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2253 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2254 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2255 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2256  -
EINVAL
;

2258 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2260 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_MAX_ACTIVE_CHANNEL_TIME
, &
mib_v®ue
);

2261 ià(
»s
)

2262  
»s
;

2264 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANCHANNELTIME
, 
mib_v®ue
);

2266  
»s
;

2267 
	}
}

2269 
	$¦si_rßm_sÿn_´obe_š‹rv®_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2271 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2272 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2273 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2274 
mib_v®ue
 = 0;

2276 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2277 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2279 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2280 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2281 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2282 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2283 
	`kä“
(
ioùl_¬gs
);

2284  -
EINVAL
;

2286 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2288 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2289 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2290 
	`kä“
(
ioùl_¬gs
);

2291  -
EINVAL
;

2293 ià(
mib_v®ue
 > 10 || mib_value < 1) {

2294 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀ´obes: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2295 
	`kä“
(
ioùl_¬gs
);

2296  -
EINVAL
;

2299 
	`kä“
(
ioùl_¬gs
);

2300  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_NPROBE
, 
mib_v®ue
);

2301 
	}
}

2303 
	$¦si_rßm_sÿn_´obe_š‹rv®_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2305 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2306 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2307 
mib_v®ue
 = 0;

2308 
»s
;

2310 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2311 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2312 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2313 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2314  -
EINVAL
;

2316 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2318 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_NPROBE
, &
mib_v®ue
);

2319 ià(
»s
)

2320  
»s
;

2322 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANNPROBES
, 
mib_v®ue
);

2324  
»s
;

2325 
	}
}

2327 
	$¦si_rßm_mode_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2329 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2330 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2331 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2332 
mib_v®ue
 = 0;

2334 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2335 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2337 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2338 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2339 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2340 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2341 
	`kä“
(
ioùl_¬gs
);

2342  -
EINVAL
;

2344 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2346 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

2347 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "SLSI_PSID_UNIFI_ROAM_MODE is‚ot supported because of„fest mode.\n");

2348 
	`kä“
(
ioùl_¬gs
);

2349  -
ENOTSUPP
;

2352 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2353 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2354 
	`kä“
(
ioùl_¬gs
);

2355  -
EINVAL
;

2357 ià(
mib_v®ue
 < 0 || mib_value > 2) {

2358 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm modv®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2359 
	`kä“
(
ioùl_¬gs
);

2360  -
EINVAL
;

2363 
	`kä“
(
ioùl_¬gs
);

2364  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_MODE
, 
mib_v®ue
);

2365 
	}
}

2367 
	$¦si_rßm_mode_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2369 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2370 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2371 
mib_v®ue
 = 0;

2372 
»s
;

2374 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2375 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2376 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2377 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2378  -
EINVAL
;

2380 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2382 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_MODE
, &
mib_v®ue
);

2383 ià(
»s
)

2384  
»s
;

2386 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMMODE
, 
mib_v®ue
);

2388  
»s
;

2389 
	}
}

2391 
	$¦si_rßm_ofæßd_­_li¡
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2393 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2394 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2395 
cfg80211_aş_d©a
 *
mac_aş
;

2396 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2397 
­_couÁ
 = 0;

2398 
i
, 
r
;

2399 
m®loc_Ën
;

2401 
	`¦si_cÚv”t_¥aû_£³¿tiÚ
(
commªd
, 
buf_Ën
);

2402 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 101);

2403 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2410 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
­_couÁ
)) {

2411 
	`SLSI_ERR
(
sdev
, "Inv®id‡p_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2412 
	`kä“
(
ioùl_¬gs
);

2413  -
EINVAL
;

2415 ià(
­_couÁ
 < 
ROAMOFFLAPLIST_MIN
 ||‡p_couÁ > 
ROAMOFFLAPLIST_MAX
) {

2416 
	`SLSI_ERR
(
sdev
, "Inv®id‡p_couÁ: %d\n", 
­_couÁ
);

2417 
	`kä“
(
ioùl_¬gs
);

2418  -
EINVAL
;

2423 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
­_couÁ
) {

2424 
	`SLSI_ERR
(
sdev
, "Bufã¸dÛ¢'ˆhav’ough f›ld ­_couÁ: %d\n", 
­_couÁ
);

2425 
	`kä“
(
ioùl_¬gs
);

2426  -
EINVAL
;

2428 
m®loc_Ën
 = (
cfg80211_aş_d©a
è+ (
mac_add»ss
è* 
­_couÁ
;

2429 
mac_aş
 = 
	`km®loc
(
m®loc_Ën
, 
GFP_KERNEL
);

2430 ià(!
mac_aş
) {

2431 
	`SLSI_ERR
(
sdev
, "MEM fa fÜ size:%ld\n", (
cfg80211_aş_d©a
è+ (
mac_add»ss
è* 
­_couÁ
);

2432 
	`kä“
(
ioùl_¬gs
);

2433  -
ENOMEM
;

2436 
i
 = 1; i <ğ
­_couÁ
; i++) {

2437 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[
i
]) != 17) {

2438 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[
i
]));

2439 
	`kä“
(
ioùl_¬gs
);

2440 
	`kä“
(
mac_aş
);

2441  -
EINVAL
;

2443 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[
i
], 
mac_aş
->
mac_addrs
[i].
addr
);

2444 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "[%pM]", 
mac_aş
->
mac_addrs
[
i
].
addr
);

2446 
mac_aş
->
aş_pŞicy
 = 
NL80211_ACL_POLICY_DENY_UNLESS_LISTED
;

2447 
mac_aş
->
n_aş_’Œ›s
 = 
­_couÁ
;

2449 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2450 
r
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 
ndev_vif
->
iâum
, 
mac_aş
->
aş_pŞicy
, mac_aş->
n_aş_’Œ›s
, mac_aş->
mac_addrs
);

2451 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2452 
	`kä“
(
mac_aş
);

2453 
	`kä“
(
ioùl_¬gs
);

2454  
r
;

2455 
	}
}

2457 
	$¦si_rßm_sÿn_bªd_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2459 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2460 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2461 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2462 
mib_v®ue
 = 0;

2464 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2465 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2467 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2468 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2469 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2470 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2471 
	`kä“
(
ioùl_¬gs
);

2472  -
EINVAL
;

2474 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2476 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2477 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2478 
	`kä“
(
ioùl_¬gs
);

2479  -
EINVAL
;

2481 ià(
mib_v®ue
 != 1 && mib_value != 2) {

2482 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm sÿÀbªd v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2483 
	`kä“
(
ioùl_¬gs
);

2484  -
EINVAL
;

2487 
	`kä“
(
ioùl_¬gs
);

2488  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_SCAN_BAND
, 
mib_v®ue
);

2489 
	}
}

2491 
	$¦si_rßm_sÿn_bªd_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2493 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2494 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2495 
mib_v®ue
 = 0;

2496 
»s
;

2498 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2499 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2500 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2501 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2502  -
EINVAL
;

2504 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2506 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_SCAN_BAND
, &
mib_v®ue
);

2507 ià(
»s
)

2508  
»s
;

2510 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMINTRABAND
, 
mib_v®ue
);

2512  
»s
;

2513 
	}
}

2515 
	$¦si_rßm_sÿn_cÚŒŞ_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2517 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2518 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2519 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2520 
mode
 = 0;

2521 
»s
 = 0;

2523 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2524 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2526 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2527 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2528 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2529 
»s
 = -
EINVAL
;

2530 
ex™
;

2533 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2534 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2535 
»s
 = -
EINVAL
;

2536 
ex™
;

2539 ià(
mode
 == 0 || mode == 1) {

2540 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 
mode
;

2542 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm Mode: Mu¡ b0 or, 1 NÙ '%d'\n", 
mode
);

2543 
»s
 = -
EINVAL
;

2544 
ex™
;

2547 
»s
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
, sdev->
deviû_cÚfig
.
rßm_sÿn_mode
);

2548 ià(
»s
)

2549 
ex™
;

2552 ià(!
mode
) {

2553 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
, 0, (
¦si_rßm_sÿn_chªÃls
));

2554 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2555 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2556 
»s
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 0, 
NULL
);

2557 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2558 
	`kä“
(
ioùl_¬gs
);

2559  
»s
;

2562 
ex™
:

2563 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2564 
	`kä“
(
ioùl_¬gs
);

2565  
»s
;

2566 
	}
}

2568 
	$¦si_rßm_sÿn_cÚŒŞ_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2570 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2571 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2572 
mib_v®ue
 = 0;

2573 
»s
;

2575 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2576 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2577 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2578 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2579  -
EINVAL
;

2581 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2583 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
, &
mib_v®ue
);

2584 ià(
»s
)

2585  
»s
;

2587 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANCONTROL
, 
mib_v®ue
);

2589  
»s
;

2590 
	}
}

2592 
	$¦si_rßm_sÿn_home_time_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2594 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2595 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2596 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2597 
mib_v®ue
 = 0;

2599 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2600 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2602 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2603 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2604 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2605 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2606 
	`kä“
(
ioùl_¬gs
);

2607  -
EINVAL
;

2609 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2611 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2612 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2613 
	`kä“
(
ioùl_¬gs
);

2614  -
EINVAL
;

2616 ià(
mib_v®ue
 > 300 || mib_value < 3) {

2617 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀhomtime: '%d'\n", 
mib_v®ue
);

2618 
	`kä“
(
ioùl_¬gs
);

2619  -
EINVAL
;

2622 
	`kä“
(
ioùl_¬gs
);

2623  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_TIME
, 
mib_v®ue
);

2624 
	}
}

2626 
	$¦si_rßm_sÿn_home_time_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2628 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2629 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2630 
mib_v®ue
 = 0;

2631 
»s
;

2633 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2634 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2635 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2636 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2637  -
EINVAL
;

2639 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2641 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_TIME
, &
mib_v®ue
);

2642 ià(
»s
)

2643  
»s
;

2645 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANHOMETIME
, 
mib_v®ue
);

2647  
»s
;

2648 
	}
}

2650 
	$¦si_rßm_sÿn_home_away_time_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2652 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2653 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2654 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2655 
mib_v®ue
 = 0;

2657 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2658 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2660 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2661 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2662 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2663 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2664 
	`kä“
(
ioùl_¬gs
);

2665  -
EINVAL
;

2667 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2669 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2670 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2671 
	`kä“
(
ioùl_¬gs
);

2672  -
EINVAL
;

2674 ià(
mib_v®ue
 > 300 || mib_value < 3) {

2675 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀhomawayime: '%d'\n", 
mib_v®ue
);

2676 
	`kä“
(
ioùl_¬gs
);

2677  -
EINVAL
;

2680 
	`kä“
(
ioùl_¬gs
);

2681  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_AWAY_TIME
, 
mib_v®ue
);

2682 
	}
}

2684 
	$¦si_rßm_sÿn_home_away_time_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2686 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2687 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2688 
mib_v®ue
 = 0;

2689 
»s
;

2691 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2692 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2693 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2694 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2695  -
EINVAL
;

2697 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2699 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_AWAY_TIME
, &
mib_v®ue
);

2700 ià(
»s
)

2701  
»s
;

2703 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANHOMEAWAYTIME
, 
mib_v®ue
);

2705  
»s
;

2706 
	}
}

2708 
ssize_t
 
	$¦si_v®id©e_low_Ï‹ncy_·¿ms
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
, *
Ï‹ncy_·¿m
)

2710 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2711 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2712 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2713 
»t
 = 0;

2715 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2716 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2718 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], 
Ï‹ncy_·¿m
)) {

2719 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg†©’cy_·¿m: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2720 
»t
 = -
EINVAL
;

2721 } ià(*
Ï‹ncy_·¿m
 < 0 || *latency_param > 0xFFFF) {

2722 
	`SLSI_ERR
(
sdev
, "Inv®id†©’cy_·¿m v®ue: '%d'\n", *
Ï‹ncy_·¿m
);

2723 
»t
 = -
EINVAL
;

2726 
	`kä“
(
ioùl_¬gs
);

2727  
»t
;

2728 
	}
}

2730 
ssize_t
 
	$¦si_£t_low_Ï‹ncy_·¿ms
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_·¿m
)

2732 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2733 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2734 
»t
 = 0;

2736 ià((
sdev
->
Ï‹ncy_·¿m_mask
 & 
LATENCY_ALL_SET_MASK
) == LATENCY_ALL_SET_MASK) {

2737 
	`SLSI_INFO
(
sdev
, "Home Away Time = %d, Homeime = %d, Max Channel Time = %d Passive Time = %d\n",

2738 
sdev
->
home_away_time
, sdev->
home_time
, sdev->
max_chªÃl_time
,

2739 
sdev
->
max_chªÃl_·ssive_time
);

2740 
»t
 = 
	`¦si_mlme_£t_sÿn_mode_»q
(
sdev
, 
dev
, 
FAPI_SCANMODE_LOW_LATENCY
, sdev->
max_chªÃl_time
,

2741 
sdev
->
home_away_time
, sdev->
home_time
, sdev->
max_chªÃl_·ssive_time
);

2742 
sdev
->
Ï‹ncy_·¿m_mask
 = 0;

2743 } ià(
Ï‹ncy_·¿m
 == 0) {

2744 
»t
 = 
	`¦si_mlme_£t_sÿn_mode_»q
(
sdev
, 
dev
, 
FAPI_SCANMODE_LEGACY
, 0, 0, 0, 0);

2745 
sdev
->
Ï‹ncy_·¿m_mask
 = 0;

2748  
»t
;

2749 
	}
}

2751 
	$¦si_£t_home_away_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2753 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2754 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2755 
home_away_time
 = 0;

2756 
»t
 = 0;

2758 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
home_away_time
);

2759 ià(
»t
 != 0)

2760  
»t
;

2762 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2763 
sdev
->
home_away_time
 = home_away_time;

2764 ià(
home_away_time
 != 0)

2765 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
HOME_AWAY_TIME_BIT
;

2766 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
home_away_time
);

2767 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2769  
»t
;

2770 
	}
}

2772 
	$¦si_£t_home_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2774 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2775 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2776 
home_time
 = 0;

2777 
»t
 = 0;

2779 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
home_time
);

2780 ià(
»t
 != 0)

2781  
»t
;

2783 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2784 
sdev
->
home_time
 = home_time;

2785 ià(
home_time
 != 0)

2786 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
HOME_TIME_BIT
;

2787 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
home_time
);

2788 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2789  
»t
;

2790 
	}
}

2792 
	$¦si_£t_chªÃl_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2794 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2795 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2796 
max_chªÃl_time
 = 0;

2797 
»t
 = 0;

2799 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
max_chªÃl_time
);

2800 ià(
»t
 != 0)

2801  
»t
;

2803 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2804 
sdev
->
max_chªÃl_time
 = max_channel_time;

2805 ià(
max_chªÃl_time
 != 0)

2806 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
MAX_CHANNEL_TIME_BIT
;

2807 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
max_chªÃl_time
);

2808 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2810  
»t
;

2811 
	}
}

2813 
	$¦si_£t_·ssive_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2815 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2816 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2817 
max_chªÃl_·ssive_time
 = 0;

2818 
»t
 = 0;

2820 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
max_chªÃl_·ssive_time
);

2821 ià(
»t
 != 0)

2822  
»t
;

2824 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2825 
sdev
->
max_chªÃl_·ssive_time
 = max_channel_passive_time;

2826 ià(
max_chªÃl_·ssive_time
 != 0)

2827 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
MAX_CHANNEL_PASSIVE_TIME_BIT
;

2828 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
max_chªÃl_·ssive_time
);

2829 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2831  
»t
;

2832 
	}
}

2834 
	$¦si_£t_tid
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2836 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2837 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2838 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2839 
mode
 = 0, 
uid
 = 0, 
tid
 = 0;

2841 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 3);

2842 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2844 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2845 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg mod: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2846 
	`kä“
(
ioùl_¬gs
);

2847  -
EINVAL
;

2849 ià(
mode
 < 0 || mode > 3) {

2850 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%d'\n", 
mode
);

2851 
	`kä“
(
ioùl_¬gs
);

2852  -
EINVAL
;

2854 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
uid
)) {

2855 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg uid: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

2856 
	`kä“
(
ioùl_¬gs
);

2857  -
EINVAL
;

2859 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
tid
)) {

2860 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšgid: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

2861 
	`kä“
(
ioùl_¬gs
);

2862  -
EINVAL
;

2865 
	`kä“
(
ioùl_¬gs
);

2866  
	`¦si_Ãtif_£t_tid_cÚfig
(
sdev
, 
dev
, 
mode
, 
uid
, 
tid
);

2867 
	}
}

2869 
	$¦si_rßm_sÿn_äequ’c›s_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2871 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2872 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2873 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2874 
»suÉ
 = 0;

2875 
i
 = 0;

2876 
chªÃls
[
SLSI_NCHO_MAX_CHANNEL_LIST
] = { 0 };

2877 
»t
 = 0;

2878 
äeq_couÁ
 = 0;

2879 
äeqs
[
SLSI_NCHO_MAX_FREQUENCY_LIST
] = { 0 };

2880 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

2881 
u32
 
ÃtwÜk_m­_chªÃls_couÁ
 = 0;

2882 
u8
 
ÃtwÜk_m­_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

2883 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

2884 
u32
 
m”ge_chª_couÁ
 = 0;

2886 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

2887 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2889 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2891 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2892 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2893 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2894 
	`kä“
(
ioùl_¬gs
);

2895  -
EINVAL
;

2898 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
äeq_couÁ
)) {

2899 
	`SLSI_ERR
(
sdev
, "Inv®id f»q_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2900 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2901 
	`kä“
(
ioùl_¬gs
);

2902  -
EINVAL
;

2904 ià(
äeq_couÁ
 < 0) {

2905 
	`SLSI_ERR
(
sdev
, "Inv®id f»qu’cy couÁ : %d\n", 
äeq_couÁ
);

2906 
	`kä“
(
ioùl_¬gs
);

2907 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2908  -
EINVAL
;

2910 ià(
äeq_couÁ
 > 
SLSI_NCHO_MAX_FREQUENCY_LIST
)

2911 
äeq_couÁ
 = 
SLSI_NCHO_MAX_FREQUENCY_LIST
;

2913 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
äeq_couÁ
) {

2914 
	`SLSI_ERR
(
sdev
, "Bufã¸dÛ¢'ˆhav’ough f›ld äeq_couÁ: %d\n", 
äeq_couÁ
);

2915 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2916 
	`kä“
(
ioùl_¬gs
);

2917  -
EINVAL
;

2920 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 
äeq_couÁ
;

2922 
i
 = 0; i < 
äeq_couÁ
; i++) {

2923 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
äeqs
[i])) {

2924 
	`SLSI_ERR
(
sdev
, "failedo„ead‡‚umeric value\n");

2925 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2926 
	`kä“
(
ioùl_¬gs
);

2927  -
EINVAL
;

2930 
chªÃls
[
i
] = 
	`›“80211_äequ’cy_to_chªÃl
(
äeqs
[i]);

2932 ià(
chªÃls
[
i
] < 1 || channels[i] > 165) {

2933 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃls
[
i
]);

2934 
	`kä“
(
ioùl_¬gs
);

2935 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2936  -
EINVAL
;

2938 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
i
] = channels[i];

2941 ià(!
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
) {

2942 
»t
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
, 1);

2943 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

2944 
	`kä“
(
ioùl_¬gs
);

2945 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2946  -
EINVAL
;

2948 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 1;

2951 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2952 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

2953 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

2955 
ÃtwÜk_m­_chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
cÚÃùed_ssid
,

2956 
ÃtwÜk_m­_chªÃls
);

2957 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
ÃtwÜk_m­_chªÃls
, 
ÃtwÜk_m­_chªÃls_couÁ
,

2958 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
,

2959 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
,

2960 
m”ged_chªÃls
);

2962 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
);

2963 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2964 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2966 
	`kä“
(
ioùl_¬gs
);

2967  
»suÉ
;

2968 
	}
}

2970 
	$¦si_rßm_sÿn_chªÃls_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2972 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2973 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2974 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2975 
»suÉ
 = 0;

2976 
i
, 
chªÃl_couÁ
 = 0;

2977 
chªÃls
[
SLSI_NCHO_MAX_CHANNEL_LIST
];

2978 
»t
 = 0;

2979 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

2980 
u32
 
ÃtwÜk_m­_chªÃls_couÁ
 = 0;

2981 
u8
 
ÃtwÜk_m­_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

2982 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

2983 
u32
 
m”ge_chª_couÁ
 = 0;

2985 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

2986 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2988 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2990 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2991 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2992 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2993 
	`kä“
(
ioùl_¬gs
);

2994  -
EINVAL
;

2997 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
chªÃl_couÁ
)) {

2998 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2999 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3000 
	`kä“
(
ioùl_¬gs
);

3001  -
EINVAL
;

3003 ià(
chªÃl_couÁ
 < 0) {

3004 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ : %d\n", 
chªÃl_couÁ
);

3005 
	`kä“
(
ioùl_¬gs
);

3006 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3007  -
EINVAL
;

3009 ià(
chªÃl_couÁ
 > 
SLSI_NCHO_MAX_CHANNEL_LIST
)

3010 
chªÃl_couÁ
 = 
SLSI_NCHO_MAX_CHANNEL_LIST
;

3012 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
chªÃl_couÁ
) {

3013 
	`SLSI_ERR
(
sdev
, "Bufã¸dÛ¢'ˆhav’ough f›ld chªÃl_couÁ: %d\n", 
chªÃl_couÁ
);

3014 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3015 
	`kä“
(
ioùl_¬gs
);

3016  -
EINVAL
;

3019 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 
chªÃl_couÁ
;

3021 
i
 = 0; i < 
chªÃl_couÁ
; i++) {

3022 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
chªÃls
[i])) {

3023 
	`SLSI_ERR
(
sdev
, "failedo„ead‡‚umeric value\n");

3024 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3025 
	`kä“
(
ioùl_¬gs
);

3026  -
EINVAL
;

3028 ià(
chªÃls
[
i
] < 1 || channels[i] > 165) {

3029 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃls
[
i
]);

3030 
	`kä“
(
ioùl_¬gs
);

3031 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3032  -
EINVAL
;

3034 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
i
] = channels[i];

3037 ià(!
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
) {

3038 
»t
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
, 1);

3039 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

3040 
	`kä“
(
ioùl_¬gs
);

3041 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3042  -
EINVAL
;

3044 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 1;

3047 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3048 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3049 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3051 
ÃtwÜk_m­_chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
cÚÃùed_ssid
,

3052 
ÃtwÜk_m­_chªÃls
);

3053 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
ÃtwÜk_m­_chªÃls
, 
ÃtwÜk_m­_chªÃls_couÁ
,

3054 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
,

3055 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
,

3056 
m”ged_chªÃls
);

3058 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
);

3059 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3060 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3062 
	`kä“
(
ioùl_¬gs
);

3063  
»suÉ
;

3064 
	}
}

3066 
	$¦si_rßm_sÿn_äequ’c›s_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3068 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3069 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3070 
sk_buff
 *
šd
 = 
NULL
;

3071 
äeq_li¡
[
MAX_FREQUENCY_COUNT
] = {0};

3072 
pos
 = 0;

3073 
i
;

3074 
äeq_couÁ
 = 0;

3076 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3077 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3078 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3079 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3080  -
EINVAL
;

3082 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3084 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3086 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3087 
	`SLSI_NET_ERR
(
dev
, "STA is‚ot in connected state\n");

3088 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3089 
äeq_couÁ
 = 0;

3090 
ouut
;

3093 
šd
 = 
	`¦si_mlme_rßmšg_chªÃl_li¡_»q
(
sdev
, 
dev
);

3094 ià(!
šd
) {

3095 
	`SLSI_ERR
(
sdev
, "RCL ind is NULL!\n");

3096 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3097  -
EINVAL
;

3100 
äeq_couÁ
 = 
	`¦si_g‘_rş_äeq_li¡
(
sdev
, 
šd
, 
äeq_li¡
);

3102 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3104 ià(!
äeq_couÁ
) {

3105 
	`SLSI_ERR
(
sdev
, "Frequency count is 0!\n");

3106  -
EINVAL
;

3109 
ouut
:

3110 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANFREQUENCIES
, 
äeq_couÁ
);

3111 
i
 = 0; i < 
äeq_couÁ
; i++)

3112 
pos
 +ğ
	`sú´štf
(
commªd
 +…os, 
buf_Ën
 -…os, " %d", 
äeq_li¡
[
i
]);

3114  
pos
;

3115 
	}
}

3117 
	$¦si_rßm_sÿn_chªÃls_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3119 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3120 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3121 
sk_buff
 *
šd
 = 
NULL
;

3122 
u16
 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

3123 
pos
 = 0;

3124 
i
;

3125 
chªÃl_couÁ
 = 0;

3127 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3128 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3129 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3130 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3131  -
EINVAL
;

3133 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3135 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3136 
šd
 = 
	`¦si_mlme_rßmšg_chªÃl_li¡_»q
(
sdev
, 
dev
);

3137 ià(!
šd
) {

3138 
	`SLSI_ERR
(
sdev
, "RCL ind is NULL!\n");

3139 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3140  -
EINVAL
;

3143 
chªÃl_couÁ
 = 
	`¦si_g‘_rş_chªÃl_li¡
(
sdev
, 
šd
, 
chªÃl_li¡
);

3144 ià(!
chªÃl_couÁ
) {

3145 
	`SLSI_ERR
(
sdev
, "Channel count is 0!\n");

3146 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3147  -
EINVAL
;

3149 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANCHANNELS
, 
chªÃl_couÁ
);

3150 
i
 = 0; i < 
chªÃl_couÁ
; i++)

3151 
pos
 +ğ
	`sú´štf
(
commªd
 +…os, 
buf_Ën
 -…os, " %d", 
chªÃl_li¡
[
i
]);

3153 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3154  
pos
;

3155 
	}
}

3157 
	$¦si_rßm_add_sÿn_äequ’c›s
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3159 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3160 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3161 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3162 
»suÉ
 = 0;

3163 
i
, 
j
;

3164 
Ãw_chªÃls
[
SLSI_NCHO_MAX_CHANNEL_LIST
] = { 0 };

3165 
cu¼_chªÃl_couÁ
 = 0;

3166 
found
 = 0;

3167 
Ãw_äeq_couÁ
 = 0;

3168 
Ãw_äeqs
[
SLSI_NCHO_MAX_FREQUENCY_LIST
] = { 0 };

3169 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

3170 
u32
 
ÃtwÜk_m­_chªÃls_couÁ
 = 0;

3171 
u8
 
ÃtwÜk_m­_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

3172 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

3173 
u32
 
m”ge_chª_couÁ
 = 0;

3175 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

3176 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3178 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3180 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3181 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3182 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3183 
	`kä“
(
ioùl_¬gs
);

3184  -
EINVAL
;

3187 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 =ğ
SLSI_NCHO_MAX_CHANNEL_LIST
) {

3188 
	`SLSI_ERR
(
sdev
, "Roam scan†ist is‡lready full\n");

3189 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3190 
	`kä“
(
ioùl_¬gs
);

3191  -
EINVAL
;

3194 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3195 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 ==

3196 
SLSI_VIF_STATUS_CONNECTED
 && 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 == 0) {

3197 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 1;

3198 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[0] = 
ndev_vif
->
chª
->
hw_v®ue
;

3200 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3202 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ãw_äeq_couÁ
)) {

3203 
	`SLSI_ERR
(
sdev
, "Inv®id f»q_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3204 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3205 
	`kä“
(
ioùl_¬gs
);

3206  -
EINVAL
;

3208 ià(
Ãw_äeq_couÁ
 < 0 ||‚ew_äeq_couÁ > 20 || ((
ioùl_¬gs
->
¬g_couÁ
 - 1) <‚ew_freq_count)) {

3209 
	`SLSI_ERR
(
sdev
, "Inv®id f»qu’cy couÁ : %d Rªge: [0,20]\n", 
Ãw_äeq_couÁ
);

3210 
	`kä“
(
ioùl_¬gs
);

3211 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3212  -
EINVAL
;

3215 
cu¼_chªÃl_couÁ
 = 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
;

3217 
i
 = 0; i < 
Ãw_äeq_couÁ
; i++) {

3218 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
Ãw_äeqs
[i])) {

3219 
	`SLSI_ERR
(
sdev
, "failedo„ead‡‚umeric value\n");

3220 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3221 
	`kä“
(
ioùl_¬gs
);

3222  -
EINVAL
;

3225 
Ãw_chªÃls
[
i
] = 
	`›“80211_äequ’cy_to_chªÃl
(
Ãw_äeqs
[i]);

3227 ià(
Ãw_chªÃls
[
i
] < 1 ||‚ew_channels[i] > 165) {

3228 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
Ãw_chªÃls
[
i
]);

3229 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3230 
	`kä“
(
ioùl_¬gs
);

3231  -
EINVAL
;

3233 
j
 = 0; j < 
cu¼_chªÃl_couÁ
; j++) {

3234 
found
 = 0;

3235 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
j
] =ğ
Ãw_chªÃls
[
i
]) {

3236 
found
 = 1;

3240 ià(!
found
) {

3241 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
cu¼_chªÃl_couÁ
] = 
Ãw_chªÃls
[
i
];

3242 
cu¼_chªÃl_couÁ
++;

3244 ià(
cu¼_chªÃl_couÁ
 >ğ
SLSI_NCHO_MAX_CHANNEL_LIST
) {

3245 
cu¼_chªÃl_couÁ
 = 
SLSI_NCHO_MAX_CHANNEL_LIST
;

3250 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 
cu¼_chªÃl_couÁ
;

3252 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3253 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3254 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3256 
ÃtwÜk_m­_chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
cÚÃùed_ssid
,

3257 
ÃtwÜk_m­_chªÃls
);

3258 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
ÃtwÜk_m­_chªÃls
, 
ÃtwÜk_m­_chªÃls_couÁ
,

3259 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
,

3260 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
,

3261 
m”ged_chªÃls
);

3263 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
);

3264 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3265 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3267 
	`kä“
(
ioùl_¬gs
);

3268  
»suÉ
;

3269 
	}
}

3271 
	$¦si_rßm_add_sÿn_chªÃls
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3273 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3274 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3275 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3276 
»suÉ
 = 0;

3277 
i
, 
j
, 
Ãw_chªÃl_couÁ
 = 0;

3278 
Ãw_chªÃls
[
SLSI_NCHO_MAX_CHANNEL_LIST
];

3279 
cu¼_chªÃl_couÁ
 = 0;

3280 
found
 = 0;

3281 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

3282 
u32
 
ÃtwÜk_m­_chªÃls_couÁ
 = 0;

3283 
u8
 
ÃtwÜk_m­_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

3284 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

3285 
u32
 
m”ge_chª_couÁ
 = 0;

3287 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

3288 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3290 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3292 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3293 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3294 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3295 
	`kä“
(
ioùl_¬gs
);

3296  -
EINVAL
;

3299 ià(
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
) {

3300 
	`SLSI_ERR
(
sdev
, "ROAM SÿÀCÚŒŞ mu¡ b0,„ßm modğ%d\n", sdev->
deviû_cÚfig
.
rßm_sÿn_mode
);

3301 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3302 
	`kä“
(
ioùl_¬gs
);

3303  -
EINVAL
;

3306 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 =ğ
SLSI_NCHO_MAX_CHANNEL_LIST
) {

3307 
	`SLSI_ERR
(
sdev
, "Roam scan†ist is‡lready full\n");

3308 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3309 
	`kä“
(
ioùl_¬gs
);

3310  -
EINVAL
;

3314 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3315 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
 &&

3316 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 =ğ0 && 
ndev_vif
->
chª
) {

3317 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 1;

3318 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[0] = 
ndev_vif
->
chª
->
hw_v®ue
;

3320 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3321 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ãw_chªÃl_couÁ
)) {

3322 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3323 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3324 
	`kä“
(
ioùl_¬gs
);

3325  -
EINVAL
;

3327 ià(
Ãw_chªÃl_couÁ
 < 0 ||‚ew_channel_count > 20) {

3328 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ : %d Rªge: [0,20]\n", 
Ãw_chªÃl_couÁ
);

3329 
	`kä“
(
ioùl_¬gs
);

3330 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3331  -
EINVAL
;

3334 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
Ãw_chªÃl_couÁ
) {

3335 
	`SLSI_ERR
(
sdev
, "Bufã¸dÛ¢'ˆhav’ough f›ld chªÃl_couÁ: %d\n", 
Ãw_chªÃl_couÁ
);

3336 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3337 
	`kä“
(
ioùl_¬gs
);

3338  -
EINVAL
;

3340 
cu¼_chªÃl_couÁ
 = 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
;

3342 
i
 = 0; i < 
Ãw_chªÃl_couÁ
; i++) {

3343 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
Ãw_chªÃls
[i])) {

3344 
	`SLSI_ERR
(
sdev
, "failedo„ead‡‚umeric value\n");

3345 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3346 
	`kä“
(
ioùl_¬gs
);

3347  -
EINVAL
;

3349 ià(
Ãw_chªÃls
[
i
] < 1 ||‚ew_channels[i] > 165) {

3350 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
Ãw_chªÃls
[
i
]);

3351 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3352 
	`kä“
(
ioùl_¬gs
);

3353  -
EINVAL
;

3355 
j
 = 0; j < 
cu¼_chªÃl_couÁ
; j++) {

3356 
found
 = 0;

3357 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
j
] =ğ
Ãw_chªÃls
[
i
]) {

3358 
found
 = 1;

3362 ià(!
found
) {

3363 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
cu¼_chªÃl_couÁ
] = 
Ãw_chªÃls
[
i
];

3364 
cu¼_chªÃl_couÁ
++;

3366 ià(
cu¼_chªÃl_couÁ
 >ğ
SLSI_NCHO_MAX_CHANNEL_LIST
) {

3367 
cu¼_chªÃl_couÁ
 = 
SLSI_NCHO_MAX_CHANNEL_LIST
;

3372 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 
cu¼_chªÃl_couÁ
;

3374 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3375 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3376 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3378 
ÃtwÜk_m­_chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
cÚÃùed_ssid
,

3379 
ÃtwÜk_m­_chªÃls
);

3380 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
ÃtwÜk_m­_chªÃls
, 
ÃtwÜk_m­_chªÃls_couÁ
,

3381 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
,

3382 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
,

3383 
m”ged_chªÃls
);

3385 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
);

3386 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3387 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3389 
	`kä“
(
ioùl_¬gs
);

3390  
»suÉ
;

3391 
	}
}

3393 
	$¦si_okc_mode_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3395 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3396 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3397 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3398 
mode
 = 0;

3400 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3401 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3403 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3404 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3405 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3406 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3407 
	`kä“
(
ioùl_¬gs
);

3408  -
EINVAL
;

3411 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3412 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3413 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3414 
	`kä“
(
ioùl_¬gs
);

3415  -
EINVAL
;

3418 ià(
mode
 == 0 || mode == 1) {

3419 
sdev
->
deviû_cÚfig
.
okc_mode
 = 
mode
;

3421 
	`SLSI_ERR
(
sdev
, "Inv®id OKC Mode: Mu¡ b0 or, 1 NÙ '%d'\n", 
mode
);

3422 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3423 
	`kä“
(
ioùl_¬gs
);

3424  -
EINVAL
;

3427 
	`kä“
(
ioùl_¬gs
);

3428 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3430 
	}
}

3432 
	$¦si_okc_mode_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3434 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3435 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3436 
okc_mode
;

3437 
»s
;

3439 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3440 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3441 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3442 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3443  -
EINVAL
;

3446 
okc_mode
 = 
sdev
->
deviû_cÚfig
.okc_mode;

3447 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3449 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETOKCMODE
, 
okc_mode
);

3451  
»s
;

3452 
	}
}

3454 
	$¦si_wes_mode_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3456 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3457 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3458 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3459 
»suÉ
 = -
EINVAL
;

3460 
u32
 
aùiÚ_äame_bm­
 = 
SLSI_STA_ACTION_FRAME_BITMAP
;

3461 
mode
 = 0;

3463 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3464 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3466 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3467 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3469 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3470 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3471 
ex™
;

3474 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3475 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3476 
ex™
;

3479 ià(
mode
 == 0 || mode == 1) {

3480 
sdev
->
deviû_cÚfig
.
wes_mode
 = 
mode
;

3482 
	`SLSI_ERR
(
sdev
, "Inv®id WES Mode: Mu¡ b0 o¸1 NÙ '%d'\n", 
mode
);

3483 
ex™
;

3486 
»suÉ
 = 0;

3487 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

3488 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

3489 ià(
sdev
->
deviû_cÚfig
.
wes_mode
)

3490 
aùiÚ_äame_bm­
 |ğ
SLSI_ACTION_FRAME_VENDOR_SPEC
;

3492 
»suÉ
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
aùiÚ_äame_bm­
,‡ction_frame_bmap);

3494 
ex™
:

3495 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3496 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3497 
	`kä“
(
ioùl_¬gs
);

3498  
»suÉ
;

3499 
	}
}

3501 
	$¦si_wes_mode_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3503 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3504 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3505 
wes_mode
;

3506 
»s
;

3508 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3509 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3510 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3511 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3512  -
EINVAL
;

3515 
wes_mode
 = 
sdev
->
deviû_cÚfig
.wes_mode;

3516 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3518 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETWESMODE
, 
wes_mode
);

3520  
»s
;

3521 
	}
}

3523 
	$¦si_£t_ncho_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3525 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3526 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3527 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3528 
sk_buff
 *
»q
;

3529 
sk_buff
 *
cfm
;

3530 
»t
 = 0;

3531 
mode
 = 0;

3533 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3534 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3536 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3537 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3538 
	`kä“
(
ioùl_¬gs
);

3539  -
EINVAL
;

3542 ià(
mode
 != 0 && mode != 1) {

3543 
	`SLSI_ERR
(
sdev
, "Inv®id NCHO Mode: Mu¡ b0 o¸1, modğ%d\n", 
mode
);

3544 
	`kä“
(
ioùl_¬gs
);

3545  -
EINVAL
;

3548 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3550 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
 =ğ
mode
) {

3551 
	`SLSI_INFO
(
sdev
, "ncho_modi ®»ady %d\n", 
mode
);

3552 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3553 
	`kä“
(
ioùl_¬gs
);

3554  
»t
;

3556 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3558 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3560 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3561 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

3562 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3563 
	`kä“
(
ioùl_¬gs
);

3564  -
EPERM
;

3567 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "mlme_£t_rßmšg_ty³_»q(vif:%u mode:%u)\n", 
ndev_vif
->
iâum
, 
mode
);

3569 
»q
 = 
	`çpi_®loc
(
mlme_£t_rßmšg_ty³_»q
, 
MLME_SET_ROAMING_TYPE_REQ
, 
ndev_vif
->
iâum
, 0);

3570 ià(!
»q
) {

3571 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3572 
	`kä“
(
ioùl_¬gs
);

3573  -
EIO
;

3575 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_rßmšg_ty³_»q
.
vif
, 
ndev_vif
->
iâum
);

3576 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_rßmšg_ty³_»q
.
rßmšg_ty³
, 
mode
);

3577 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_ROAMING_TYPE_CFM
);

3578 ià(!
cfm
) {

3579 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3580 
	`kä“
(
ioùl_¬gs
);

3581  -
EIO
;

3584 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_ty³_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3585 
	`SLSI_NET_ERR
(
dev
, "mlme_set_roaming_type_cfm(result:0x%04x) ERROR\n",

3586 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_ty³_cfm
.
»suÉ_code
));

3587 
»t
 = -
EINVAL
;

3590 
	`kä“_skb
(
cfm
);

3592 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3593 
	`¦si_cÚn_log2us_ncho_mode
(
sdev
, 
dev
, 
mode
);

3594 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3595 
sdev
->
deviû_cÚfig
.
ncho_mode
 = 
mode
;

3596 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3598 
	`kä“
(
ioùl_¬gs
);

3599  
»t
;

3600 
	}
}

3602 
	$¦si_g‘_ncho_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3604 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3605 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3606 
»t
;

3608 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3609 
»t
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETNCHOMODE
, 
sdev
->
deviû_cÚfig
.
ncho_mode
);

3610 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3612  
»t
;

3613 
	}
}

3615 
	$¦si_£t_dfs_sÿn_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3617 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3618 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3619 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3620 
mode
 = 0;

3621 
»s
;

3623 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3624 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3626 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3627 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3628 
	`kä“
(
ioùl_¬gs
);

3629  -
EINVAL
;

3632 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3634 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3635 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3636 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3637 
	`kä“
(
ioùl_¬gs
);

3638  -
EINVAL
;

3641 ià(
mode
 >= 0 && mode <= 2) {

3642 
sdev
->
deviû_cÚfig
.
dfs_sÿn_mode
 = 
mode
;

3644 
	`SLSI_ERR
(
sdev
, "Inv®id df sÿÀmode: Mu¡ b0/1 o¸2, NÙ '%d'\n", 
mode
);

3645 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3646 
	`kä“
(
ioùl_¬gs
);

3647  -
EINVAL
;

3650 
	`kä“
(
ioùl_¬gs
);

3651 
»s
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_DFS_SCAN_MODE
, sdev->
deviû_cÚfig
.
dfs_sÿn_mode
);

3652 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3653  
»s
;

3654 
	}
}

3656 
	$¦si_g‘_dfs_sÿn_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3658 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3659 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3660 
mib_v®ue
 = 0;

3661 
»s
;

3663 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3664 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

3665 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

3666 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3667  -
EINVAL
;

3669 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3671 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_DFS_SCAN_MODE
, &
mib_v®ue
);

3672 ià(
»s
)

3673  
»s
;

3675 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETDFSSCANMODE
, 
mib_v®ue
);

3677  
»s
;

3678 
	}
}

3682 
	$¦si_£t_pmk
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3684 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3685 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3686 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3687 
u8
 
pmk
[33] = {0};

3688 
»suÉ
 = 0;

3689 
key_·¿ms
 
·¿ms
;

3690 
u8
 
mac_addr
[
ETH_ALEN
] = {0};

3692 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3693 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3695 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) < 32) {

3696 
	`kä“
(
ioùl_¬gs
);

3697  -
EINVAL
;

3700 
	`memıy
((
u8
 *)
pmk
, 
ioùl_¬gs
->
¬gs
[0], 32);

3701 
	`mem£t
(
mac_addr
, 0x00, 
ETH_ALEN
);

3702 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3703 
	`mem£t
(&
·¿ms
, 0, (params));

3704 
·¿ms
.
key
 = 
pmk
;

3705 
·¿ms
.
key_Ën
 = 32;

3706 
·¿ms
.
ch”
 = 
WLAN_CIPHER_SUITE_PMK
;

3707 
»suÉ
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 0, 
FAPI_KEYTYPE_PMK
, 
mac_addr
, &
·¿ms
);

3708 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3709 
	`kä“
(
ioùl_¬gs
);

3710  
»suÉ
;

3711 
	}
}

3713 
	$¦si_auto_chª_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3715 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3716 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3717 
­_auto_chª
;

3718 
»suÉ
 = 0;

3720 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3721 
­_auto_chª
 = 
sdev
->
deviû_cÚfig
.ap_auto_chan;

3722 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3724 
»suÉ
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d\n", 
­_auto_chª
);

3725  
»suÉ
;

3726 
	}
}

3728 
ssize_t
 
	$¦si_auto_chª_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3730 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3731 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3732 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3733 
n_chªÃls
 = 0;

3734 
›“80211_chªÃl
 *
chªÃls
[
SLSI_NO_OF_SCAN_CHANLS_FOR_AUTO_CHAN_MAX
] = { 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL };

3735 
couÁ_chªÃls
;

3736 
chª
;

3737 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


3738 
Ãt_deviû
 *
¡a_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

3739 
Ãtdev_vif
 *
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
¡a_dev
);

3740 
¡a_äequ’cy
;

3743 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3744 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3746 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
n_chªÃls
)) {

3747 
	`SLSI_ERR
(
sdev
, "channel count: failedo„ead‡‚umeric value");

3748 
	`kä“
(
ioùl_¬gs
);

3749  -
EINVAL
;

3752 ià(
n_chªÃls
 < 1 ||‚_chªÃl > 
SLSI_NO_OF_SCAN_CHANLS_FOR_AUTO_CHAN_MAX
) {

3753 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ:%d", 
n_chªÃls
);

3754 
	`kä“
(
ioùl_¬gs
);

3755  -
EINVAL
;

3759 ià(
n_chªÃls
 == 3)

3760 
n_chªÃls
 = 14;

3761 ià(
n_chªÃls
 == 2)

3762 
n_chªÃls
 = 9;

3763 
couÁ_chªÃls
 = 0;

3764 
chª
 = 1; chª <ğ
n_chªÃls
; chan++) {

3765 
ûÁ”_äeq
;

3767 
ûÁ”_äeq
 = 
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
NL80211_BAND_2GHZ
);

3768 
chªÃls
[
couÁ_chªÃls
] = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
ûÁ”_äeq
);

3769 ià(!
chªÃls
[
couÁ_chªÃls
])

3770 
	`SLSI_WARN
(
sdev
, "chªÃÈnumb”:%d inv®id\n", 
chª
);

3772 
couÁ_chªÃls
++;

3775 
	`SLSI_DBG3
(
sdev
, 
SLSI_INIT_DEINIT
, "Numb” oàchªÃl fÜ‡utochªÃÈ£ËùiÚğ%d\n", 
couÁ_chªÃls
);

3777 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3778 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 0;

3779 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3781 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


3782 ià(
ndev_¡a_vif
->
aùiv©ed
 &&‚dev_¡a_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

3783 (
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

3784 
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

3785 
¡a_äequ’cy
 = 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
;

3786 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3787 ià((
¡a_äequ’cy
 / 1000) == 2)

3788 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 
	`›“80211_äequ’cy_to_chªÃl
(
¡a_äequ’cy
);

3790 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 1;

3791 
	`SLSI_INFO
(
sdev
, "ChªÃÈ£Ëùed = %d", sdev->
deviû_cÚfig
.
­_auto_chª
);

3792 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3793 
	`kä“
(
ioùl_¬gs
);

3797 
	`kä“
(
ioùl_¬gs
);

3798  
	`¦si_auto_chª_£Ëù_sÿn
(
sdev
, 
couÁ_chªÃls
, 
chªÃls
);

3799 
	}
}

3801 
	$¦si_£nd_aùiÚ_äame
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3803 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3804 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3805 *
‹mp
;

3806 
u8
 
bssid
[6] = { 0 };

3807 
chªÃl
 = 0;

3808 
äeq
 = 0;

3809 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

3810 
r
 = 0;

3811 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3812 
u32
 
dw–l_time
;

3813 
›“80211_hdr
 *
hdr
;

3814 
u8
 *
buf
 = 
NULL
;

3815 
u8
 *
fš®_buf
 = 
NULL
;

3816 
u8
 
‹mp_by‹
;

3817 
Ën
 = 0;

3818 
fš®_Ëngth
 = 0;

3819 
i
 = 0, 
j
 = 0;

3820 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3822 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3823 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

3824 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3825 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

3826 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3827  -
EINVAL
;

3829 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3831 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 5);

3832 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3834 ià(
ioùl_¬gs
->
¬g_couÁ
 < 5) {

3835 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

3836 
	`kä“
(
ioùl_¬gs
);

3837  -
EINVAL
;

3840 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

3841 
	`SLSI_ERR
(
sdev
, "Inv®id maøadd»ss: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3842 
	`kä“
(
ioùl_¬gs
);

3843  -
EINVAL
;

3846 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

3847 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3848 ià(!
	`SLSI_ETHER_EQUAL
(
bssid
, 
ndev_vif
->
¡a
.bssid)) {

3849 
	`SLSI_ERR
(
sdev
, "WrÚg Bssid = " 
MACSTR
 " CÚÃùed Bssid = " MACSTR "\n", 
	`MAC2STR
(
bssid
), MAC2STR(
ndev_vif
->
¡a
.bssid));

3850 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3851 
	`kä“
(
ioùl_¬gs
);

3852  -
EINVAL
;

3854 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3856 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

3857 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

3858 
	`kä“
(
ioùl_¬gs
);

3859  -
EINVAL
;

3862 ià(
chªÃl
 < 1 || channel > 165) {

3863 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

3864 
	`kä“
(
ioùl_¬gs
);

3865  -
EINVAL
;

3868 ià(
chªÃl
 > 14)

3869 
bªd
 = 
NL80211_BAND_5GHZ
;

3870 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

3871 ià(!
äeq
) {

3872 
	`kä“
(
ioùl_¬gs
);

3873  -
EINVAL
;

3876 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
dw–l_time
)) {

3877 
	`SLSI_ERR
(
sdev
, "Inv®id dw–Ètim¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

3878 
	`kä“
(
ioùl_¬gs
);

3879  -
EINVAL
;

3882 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
Ën
)) {

3883 
	`SLSI_ERR
(
sdev
, "Inv®id†’gth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

3884 
	`kä“
(
ioùl_¬gs
);

3885  -
EINVAL
;

3889 ià(
Ën
 < 512 ||†en > 1024) {

3890 ià(
Ën
 < 0 ||†en > 1024) {

3891 
	`SLSI_ERR
(
sdev
, "Inv®id bufã¸Ëngth:%d\n", 
Ën
);

3892 
	`kä“
(
ioùl_¬gs
);

3893  -
EINVAL
;

3895 
	`SLSI_INFO
(
sdev
, "F¿mBody oàV’dÜ S³cifiøbufã¸Ëngth = %d sØignÜšghcommªd\n", 
Ën
);

3896 
	`kä“
(
ioùl_¬gs
);

3900 
buf
 = 
	`km®loc
((
Ën
 + 1è/ 2, 
GFP_KERNEL
);

3902 ià(!
buf
) {

3903 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3904 
	`kä“
(
ioùl_¬gs
);

3905  -
ENOMEM
;

3909 
‹mp
 = 
ioùl_¬gs
->
¬gs
[4];

3910 
i
 = 0, 
j
 = 0; j < 
Ën
; j += 2) {

3911 ià(
j
 + 1 =ğ
Ën
)

3912 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]);

3914 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]) << 4 | slsi_parse_hex(temp[j + 1]);

3915 
buf
[
i
++] = 
‹mp_by‹
;

3917 
Ën
 = 
i
;

3919 
fš®_Ëngth
 = 
Ën
 + 
IEEE80211_HEADER_SIZE
;

3920 
fš®_buf
 = 
	`km®loc
(
fš®_Ëngth
, 
GFP_KERNEL
);

3921 ià(!
fš®_buf
) {

3922 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3923 
	`kä“
(
ioùl_¬gs
);

3924 
	`kä“
(
buf
);

3925  -
ENOMEM
;

3928 
hdr
 = (
›“80211_hdr
 *)
fš®_buf
;

3929 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

3930 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
bssid
);

3931 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
dev
->
dev_addr
);

3932 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
bssid
);

3933 
	`memıy
(
fš®_buf
 + 
IEEE80211_HEADER_SIZE
, 
buf
, 
Ën
);

3935 
	`kä“
(
buf
);

3937 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3939 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
fš®_buf
, 
fš®_Ëngth
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 
	`SLSI_FREQ_HOST_TO_FW
(
äeq
), 
dw–l_time
 * 1000, 0);

3941 
	`kä“
(
fš®_buf
);

3942 
	`kä“
(
ioùl_¬gs
);

3943 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3944  
r
;

3945 
	}
}

3947 
	$¦si_£nd_aùiÚ_äame_û¹
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3949 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3950 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3951 *
‹mp
;

3952 
r
 = 0;

3953 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3954 
›“80211_hdr
 *
hdr
;

3955 
u8
 *
buf
 = 
NULL
;

3956 
u8
 *
fš®_buf
 = 
NULL
;

3957 
u8
 
‹mp_by‹
;

3958 
Ën
 = 0;

3959 
fš®_Ëngth
 = 0;

3960 
i
 = 0, 
j
 = 0;

3961 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3963 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3964 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

3965 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3966 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

3967 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3968  -
EINVAL
;

3970 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3972 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

3973 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3975 ià(
ioùl_¬gs
->
¬g_couÁ
 < 2) {

3976 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

3977 
	`kä“
(
ioùl_¬gs
);

3978  -
EINVAL
;

3981 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ën
)) {

3982 
	`SLSI_ERR
(
sdev
, "Inv®id†’gth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3983 
	`kä“
(
ioùl_¬gs
);

3984  -
EINVAL
;

3987 
buf
 = 
	`km®loc
((
Ën
 + 1è/ 2, 
GFP_KERNEL
);

3989 ià(!
buf
) {

3990 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3991 
	`kä“
(
ioùl_¬gs
);

3992  -
ENOMEM
;

3996 
‹mp
 = 
ioùl_¬gs
->
¬gs
[1];

3997 
i
 = 0, 
j
 = 0; j < 
Ën
; j += 2) {

3998 ià(
j
 + 1 =ğ
Ën
)

3999 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]);

4001 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]) << 4 | slsi_parse_hex(temp[j + 1]);

4002 
buf
[
i
++] = 
‹mp_by‹
;

4004 
Ën
 = 
i
;

4006 
fš®_Ëngth
 = 
Ën
 + 
IEEE80211_HEADER_SIZE
;

4007 
fš®_buf
 = 
	`km®loc
(
fš®_Ëngth
, 
GFP_KERNEL
);

4008 ià(!
fš®_buf
) {

4009 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

4010 
	`kä“
(
ioùl_¬gs
);

4011 
	`kä“
(
buf
);

4012  -
ENOMEM
;

4015 
hdr
 = (
›“80211_hdr
 *)
fš®_buf
;

4016 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

4017 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4018 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
ndev_vif
->
¡a
.
bssid
);

4019 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
ndev_vif
->
¡a
.
bssid
);

4020 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4021 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
sdev
->
hw_addr
);

4022 
	`memıy
(
fš®_buf
 + 
IEEE80211_HEADER_SIZE
, 
buf
, 
Ën
);

4024 
	`kä“
(
buf
);

4026 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
fš®_buf
, 
fš®_Ëngth
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0);

4028 
	`kä“
(
fš®_buf
);

4029 
	`kä“
(
ioùl_¬gs
);

4030  
r
;

4031 
	}
}

4033 #ifdeà
SLSI_TEST_DEV


4034 
	$¦si_£nd_aùiÚ_äame_ut
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4036 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4037 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4038 *
hex_¡r
;

4039 
u8
 
bssid
[6] = { 0 };

4040 
u8
 
Œªsm™‹¿ddr
[6] = { 0 };

4041 
chªÃl
 = 0;

4042 
r
 = 0;

4043 
u32
 
dw–l_time
;

4044 
›“80211_mgmt
 *
hdr
;

4045 
u8
 *
buf
 = 
NULL
;

4046 
u8
 
‹mp_by‹
;

4047 
Ën
 = 0;

4048 
i
 = 0, 
j
 = 0;

4049 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4050 
›“80211_chªÃl
 
chª
;

4051 
u64
 
cook›
 = 1;

4053 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 6);

4054 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4056 ià(
ioùl_¬gs
->
¬g_couÁ
 < 6) {

4057 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

4058 
	`kä“
(
ioùl_¬gs
);

4059  -
EINVAL
;

4062 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

4063 
	`SLSI_ERR
(
sdev
, "Inv®id maøadd»ss: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4064 
	`kä“
(
ioùl_¬gs
);

4065  -
EINVAL
;

4068 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
Œªsm™‹¿ddr
);

4070 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[1]) != 17) {

4071 
	`SLSI_ERR
(
sdev
, "Inv®id maøadd»ss: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

4072 
	`kä“
(
ioùl_¬gs
);

4073  -
EINVAL
;

4076 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[1], 
bssid
);

4078 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
chªÃl
)) {

4079 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

4080 
	`kä“
(
ioùl_¬gs
);

4081  -
EINVAL
;

4084 ià(
chªÃl
 < 1 || channel > 165) {

4085 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

4086 
	`kä“
(
ioùl_¬gs
);

4087  -
EINVAL
;

4089 
	`SLSI_INFO
(
sdev
, "chªÃl: '%d'\n", 
chªÃl
);

4091 ià(
chªÃl
 > 14)

4092 
chª
.
bªd
 = 
NL80211_BAND_5GHZ
;

4094 
chª
.
bªd
 = 
NL80211_BAND_2GHZ
;

4096 
	`SLSI_ERR
(
sdev
, "chªÃl: '%d'\n", 
chª
.
bªd
);

4098 
chª
.
ûÁ”_äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, chª.
bªd
);

4099 ià(!
chª
.
ûÁ”_äeq
) {

4100 
	`kä“
(
ioùl_¬gs
);

4101  -
EINVAL
;

4104 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
dw–l_time
)) {

4105 
	`SLSI_ERR
(
sdev
, "Inv®id dw–Ètim¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

4106 
	`kä“
(
ioùl_¬gs
);

4107  -
EINVAL
;

4110 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[4], &
Ën
)) {

4111 
	`SLSI_ERR
(
sdev
, "Inv®id†’gth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[4]);

4112 
	`kä“
(
ioùl_¬gs
);

4113  -
EINVAL
;

4117 ià(
Ën
 < 0 ||†en > 1024) {

4118 
	`SLSI_ERR
(
sdev
, "Inv®id bufã¸Ëngth:%d\n", 
Ën
);

4119 
	`kä“
(
ioùl_¬gs
);

4120  -
EINVAL
;

4123 
buf
 = 
	`km®loc
((
IEEE80211_HEADER_SIZE
 + ((
Ën
 + 1è/ 2)), 
GFP_KERNEL
);

4125 ià(!
buf
) {

4126 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

4127 
	`kä“
(
ioùl_¬gs
);

4128  -
ENOMEM
;

4130 
hdr
 = (
›“80211_mgmt
 *)
buf
;

4131 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

4132 
	`SLSI_ETHER_COPY
(
hdr
->
da
, 
bssid
);

4133 
	`SLSI_ETHER_COPY
(
hdr
->
§
, 
Œªsm™‹¿ddr
);

4134 
	`SLSI_ETHER_COPY
(
hdr
->
bssid
, bssid);

4137 
hex_¡r
 = 
ioùl_¬gs
->
¬gs
[5];

4138 
i
 = 
IEEE80211_HEADER_SIZE
, 
j
 = 0; j < 
Ën
; j += 2) {

4139 ià(
j
 + 1 =ğ
Ën
)

4140 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
hex_¡r
[
j
]);

4142 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
hex_¡r
[
j
]) << 4 | slsi_parse_hex(hex_str[j + 1]);

4143 
buf
[
i
++] = 
‹mp_by‹
;

4145 
Ën
 = 
i
;

4146 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4147 
r
 = 
	`¦si_wÏn_mgmt_tx
(
sdev
, 
dev
, &
chª
, 
dw–l_time
, 
buf
, 
Ën
, 1, &
cook›
);

4149 
	`kä“
(
buf
);

4150 
	`kä“
(
ioùl_¬gs
);

4151 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4152  
r
;

4153 
	}
}

4156 
	$¦si_£‰šg_max_¡a_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4158 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4159 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4160 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4161 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4162 
¡a_numb”
 = 0;

4163 
»suÉ
 = 0;

4165 
	`¦si_cÚv”t_¥aû_£³¿tiÚ
(
commªd
, 
cmd_Ën
);

4166 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

4167 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4169 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
¡a_numb”
)) {

4170 
	`SLSI_ERR
(
sdev
, "Inv®id max‚um s stšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4171 
	`kä“
(
ioùl_¬gs
);

4172  -
EINVAL
;

4175 ià(
¡a_numb”
 > 10 || sta_number < 1) {

4176 
	`kä“
(
ioùl_¬gs
);

4177  -
EINVAL
;

4180 
»suÉ
 = 
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
SLSI_PSID_UNIFI_MAX_CLIENT
, 
¡a_numb”
, 0);

4181 ià(
»suÉ
 !ğ
SLSI_MIB_STATUS_SUCCESS
 || 
mib_d©a
.
d©aL’gth
 == 0) {

4182 
	`kä“
(
ioùl_¬gs
);

4183  -
ENOMEM
;

4185 
»suÉ
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

4186 ià(
»suÉ
 != 0)

4187 
	`SLSI_ERR
(
sdev
, "max_¡a: mlme_£t_»q faed: ResuÉ code: %d\n", 
»suÉ
);

4188 
	`kä“
(
ioùl_¬gs
);

4189 
	`kä“
(
mib_d©a
.
d©a
);

4191  
»suÉ
;

4192 
	}
}

4194 
	$¦si_couÁry_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4196 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

4197 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

4198 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4199 
®pha2_code
[
SLSI_COUNTRY_CODE_LEN
];

4200 
¡©us
;

4202 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4203 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4205 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) < 2) {

4206 
	`kä“
(
ioùl_¬gs
);

4207  -
EINVAL
;

4210 
	`memıy
(
®pha2_code
, 
ioùl_¬gs
->
¬gs
[0], 2);

4211 
®pha2_code
[2] = ' ';

4213 
¡©us
 = 
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
®pha2_code
, 
SLSI_COUNTRY_CODE_LEN
);

4215 
	`kä“
(
ioùl_¬gs
);

4216  
¡©us
;

4217 
	}
}

4219 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

4220 
	$¦si_fÜw¬d_b—cÚ
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4222 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

4223 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

4224 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4225 
š‹nded_aùiÚ
 = 0;

4226 
»t
 = 0;

4228 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4229 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4231 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ4 && 
	`¡ºÿ£cmp
(ioctl_args->args[0], "stop", 4) == 0) {

4232 
š‹nded_aùiÚ
 = 
FAPI_ACTION_STOP
;

4233 } ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ5 && 
	`¡ºÿ£cmp
(ioctl_args->args[0], "start", 5) == 0) {

4234 
š‹nded_aùiÚ
 = 
FAPI_ACTION_START
;

4236 
	`SLSI_NET_ERR
(
dev
, "BEACON_RECV should be used with start or stop\n");

4237 
	`kä“
(
ioùl_¬gs
);

4238  -
EINVAL
;

4241 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "BEACON_RECV %s!!\n", 
š‹nded_aùiÚ
 ? "START" : "STOP");

4242 
	`SLSI_MUTEX_LOCK
(
Ãtdev_vif
->
vif_mu‹x
);

4244 ià(!
Ãtdev_vif
->
aùiv©ed
 ||‚‘dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

4245 
Ãtdev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

4246 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

4247 
»t
 = -
EINVAL
;

4248 
ex™_vif_mu‹x
;

4251 ià((
š‹nded_aùiÚ
 =ğ
FAPI_ACTION_START
 && 
Ãtdev_vif
->
is_ws_ruÂšg
) ||

4252 (
š‹nded_aùiÚ
 =ğ
FAPI_ACTION_STOP
 && !
Ãtdev_vif
->
is_ws_ruÂšg
)) {

4253 
	`SLSI_NET_INFO
(
dev
, "Forwarding beacon is‡lready %s!!\n",

4254 
Ãtdev_vif
->
is_ws_ruÂšg
 ? "running" : "stopped");

4255 
»t
 = 0;

4256 
ex™_vif_mu‹x
;

4259 
	`SLSI_MUTEX_LOCK
(
Ãtdev_vif
->
sÿn_mu‹x
);

4260 ià(
š‹nded_aùiÚ
 =ğ
FAPI_ACTION_START
 &&

4261 (
Ãtdev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 ||‚‘dev_vif->
¡a
.
rßm_š_´og»ss
)) {

4262 
	`SLSI_NET_ERR
(
dev
, "Rejecting BEACON_RECV start‡s scan/roam is„unning\n");

4263 
»t
 = -
EBUSY
;

4264 
ex™_sÿn_mu‹x
;

4267 
»t
 = 
	`¦si_mlme_£t_fÜw¬d_b—cÚ
(
sdev
, 
dev
, 
š‹nded_aùiÚ
);

4268 
ex™_sÿn_mu‹x
:

4269 
	`SLSI_MUTEX_UNLOCK
(
Ãtdev_vif
->
sÿn_mu‹x
);

4270 
ex™_vif_mu‹x
:

4271 
	`kä“
(
ioùl_¬gs
);

4272 
	`SLSI_MUTEX_UNLOCK
(
Ãtdev_vif
->
vif_mu‹x
);

4273  
»t
;

4274 
	}
}

4277 
	$¦si_upd©e_rssi_boo¡
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

4279 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

4280 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

4281 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4282 
dig™1
, 
dig™2
, 
bªd
, 
Ëndig™1
, 
Ëndig™2
;

4283 
boo¡
 = 0, 
Ëngth
 = 0, 
i
 = 0;

4284 *
rssi_boo¡_¡ršg
 = 
NULL
;

4286 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

4287 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4289 
rssi_boo¡_¡ršg
 = 
ioùl_¬gs
->
¬gs
[0];

4290 ià(
	`¡¾’
(
rssi_boo¡_¡ršg
) < 8) {

4291 
	`kä“
(
ioùl_¬gs
);

4292  -
EINVAL
;

4294 
i
 = 0; i < (
	`¡¾’
(
rssi_boo¡_¡ršg
) - 4);) {

4295 ià(
rssi_boo¡_¡ršg
[
i
] == '0' &&

4296 
rssi_boo¡_¡ršg
[
i
 + 1] == '4') {

4297 ià(
rssi_boo¡_¡ršg
[
i
 + 2] == '0' &&

4298 
rssi_boo¡_¡ršg
[
i
 + 3] == '2' &&

4299 ((
i
 + 7è< 
	`¡¾’
(
rssi_boo¡_¡ršg
))) {

4300 
i
 = i + 4;

4302 
	`kä“
(
ioùl_¬gs
);

4303  -
EINVAL
;

4305 
dig™1
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
]);

4306 
dig™2
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
 + 1]);

4307 
boo¡
 = (
dig™1
 * 16è+ 
dig™2
;

4308 
bªd
 = 
rssi_boo¡_¡ršg
[
i
 + 3] - '0';

4309 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4310 ià(
bªd
 == 0) {

4311 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 0;

4312 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 0;

4313 } ià(
bªd
 == 1) {

4314 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 0;

4315 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 
boo¡
;

4316 } ià(
bªd
 == 2) {

4317 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 
boo¡
;

4318 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 0;

4320 
	`SLSI_ERR
(
sdev
, "Inv®id bªd v®u%d\n", 
bªd
);

4321 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4322 
	`kä“
(
ioùl_¬gs
);

4323  -
EINVAL
;

4325 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4326 ià(
Ãtdev_vif
->
aùiv©ed
 &&

4327 
Ãtdev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

4328 
	`kä“
(
ioùl_¬gs
);

4329  
	`¦si_£t_boo¡
(
sdev
, 
dev
);

4331 
	`kä“
(
ioùl_¬gs
);

4334 
i
 = i + 2;

4335 
Ëndig™1
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
]);

4336 
Ëndig™2
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
 + 1]);

4337 
Ëngth
 = (
Ëndig™1
 * 16è+ 
Ëndig™2
;

4338 
i
 = i + (
Ëngth
 * 2) + 2;

4340 
	`kä“
(
ioùl_¬gs
);

4341  -
EINVAL
;

4342 
	}
}

4344 
	$¦si_£t_tx_pow”_ÿÎšg
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4346 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4347 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4348 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4349 
mode
 = 0;

4350 
”rÜ
 = 0;

4351 
u16
 
ho¡_¡©e
;

4353 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4354 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4356 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

4357 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4358 
	`kä“
(
ioùl_¬gs
);

4359  -
EINVAL
;

4362 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4363 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

4365 
mode
) {

4366 
HEAD_SAR_BACKOFF_DISABLED
:

4367 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_HEAD_SAR_ACTIVE
;

4369 
HEAD_SAR_BACKOFF_ENABLED
:

4370 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_HEAD_SAR_ACTIVE
;

4372 
BODY_SAR_BACKOFF_DISABLED
:

4373 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_GRIP_SAR_ACTIVE
;

4375 
BODY_SAR_BACKOFF_ENABLED
:

4376 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_GRIP_SAR_ACTIVE
;

4378 
NR_MMWAVE_SAR_BACKOFF_DISABLED
:

4379 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_BASE_MMW
 << 
SLSI_HOSTSTATE_BASE_POS
);

4381 
NR_MMWAVE_SAR_BACKOFF_ENABLED
:

4382 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_BASE_MASK
;

4383 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_BASE_MMW
 << 
SLSI_HOSTSTATE_BASE_POS
;

4385 
NR_SUB6_SAR_BACKOFF_DISABLED
:

4386 
sdev
->
deviû_cÚfig
.
ho¡_¡©e_sub6_bªd
 = 
çl£
;

4387 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_SUB6_BAND_MASK
 | 
SLSI_HOSTSTATE_BASE_MASK
);

4389 
NR_SUB6_SAR_BACKOFF_ENABLED
:

4390 
sdev
->
deviû_cÚfig
.
ho¡_¡©e_sub6_bªd
 = 
Œue
;

4391 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4392 
	`kä“
(
ioùl_¬gs
);

4393  
”rÜ
;

4394 
SAR_BACKOFF_DISABLE_ALL
:

4395 
ho¡_¡©e
 &ğ
SLSI_HOSTSTATE_SAR_INIT_MASK
;

4397 
MHS_SAR_BACKOFF_DISABLED
:

4398 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_MHS_SAR_ACTIVE
;

4400 
MHS_SAR_BACKOFF_ENABLED
:

4401 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_MHS_SAR_ACTIVE
;

4404 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4405 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4406 
	`kä“
(
ioùl_¬gs
);

4407  -
EINVAL
;

4410 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

4411 ià(!
”rÜ
)

4412 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

4414 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4415 
	`kä“
(
ioùl_¬gs
);

4416  
”rÜ
;

4417 
	}
}

4419 
	$¦si_£t_tx_pow”_sub6_bªd
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4421 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4422 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4423 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4424 
mode
 = 0;

4425 
”rÜ
 = 0;

4426 
u16
 
ho¡_¡©e
;

4428 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4429 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4431 ià(!
sdev
->
deviû_cÚfig
.
ho¡_¡©e_sub6_bªd
) {

4432 
	`SLSI_ERR
(
sdev
, "'SET_TX_POWER_CALLING 6' must be called first.\n");

4433 
	`kä“
(
ioùl_¬gs
);

4434  -
EINVAL
;

4437 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

4438 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4439 
	`kä“
(
ioùl_¬gs
);

4440  -
EINVAL
;

4443 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4444 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

4446 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_SUB6_BAND_MASK
 | 
SLSI_HOSTSTATE_BASE_MASK
);

4447 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_BASE_SUB6
 << 
SLSI_HOSTSTATE_BASE_POS
;

4449 
mode
) {

4450 
SUB6_SAR_1_BAND
:

4451 
ho¡_¡©e
 |ğ(
SUB6_SAR_1
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

4453 
SUB6_SAR_2_BAND
:

4454 
ho¡_¡©e
 |ğ(
SUB6_SAR_2
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

4456 
SUB6_SAR_3_BAND
:

4457 
ho¡_¡©e
 |ğ(
SUB6_SAR_3
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

4459 
SUB6_SAR_4_BAND
:

4460 
ho¡_¡©e
 |ğ(
SUB6_SAR_4
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

4462 
SUB6_SAR_5_BAND
:

4463 
ho¡_¡©e
 |ğ(
SUB6_SAR_5
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

4465 
SUB6_SAR_6_BAND
:

4466 
ho¡_¡©e
 |ğ(
SUB6_SAR_6
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

4469 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4470 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4471 
	`kä“
(
ioùl_¬gs
);

4472  -
EINVAL
;

4475 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

4476 ià(!
”rÜ
)

4477 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

4479 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4481 
	`kä“
(
ioùl_¬gs
);

4482  
”rÜ
;

4483 
	}
}

4485 
	$¦si_´št_»guÏtÜy
(
¦si_802_11d_»g_domaš
 *
domaš_šfo
, *
buf
, 
buf_Ën
, 
¦si_suµÜ‹d_chªÃls
 *
suµÜ‹d_chªÃls
, 
suµ_chª_Ëngth
)

4487 
cur_pos
 = 0;

4488 
i
, 
j
, 
k
;

4489 *
dfs_»giÚ_¡r
[] = {"unknown", "FCC", "ETSI", "JAPAN", "GLOBAL", "CHINA"};

4490 
u8
 
dfs_»giÚ_šdex
;

4491 
›“80211_»g_ruË
 *
»g_ruË
;

4492 
chªÃl_¡¬t_äeq
 = 0;

4493 
chªÃl_’d_äeq
 = 0;

4494 
chªÃl_¡¬t_num
 = 0;

4495 
chªÃl_’d_num
 = 0;

4496 
chªÃl_couÁ
 = 0;

4497 
chªÃl_šüem’t
 = 0;

4498 
chªÃl_bªd
 = 0;

4499 
boŞ
 
di¥Ïy_·‰”n
 = 
çl£
;

4501 
cur_pos
 = 
	`¢´štf
(
buf
, 
buf_Ën
, "couÁry %c%c:", 
domaš_šfo
->
»gdomaš
->
®pha2
[0],

4502 
domaš_šfo
->
»gdomaš
->
®pha2
[1]);

4503 
dfs_»giÚ_šdex
 = 
domaš_šfo
->
»gdomaš
->
dfs_»giÚ
 <= 5 ? domain_info->regdomain->dfs_region : 0;

4504 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "DFS-%s\n", 
dfs_»giÚ_¡r
[
dfs_»giÚ_šdex
]);

4505 
i
 = 0; i < 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
; i++) {

4506 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
i
];

4507 ià(
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 / 1000 >= 57000)

4509 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "\t(%d-%d @ %d), (N/A, %d)",

4510 
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 / 1000,

4511 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 / 1000,

4512 
»g_ruË
->
äeq_¿nge
.
max_bªdwidth_khz
 / 1000,

4513 
	`MBM_TO_DBM
(
»g_ruË
->
pow”_ruË
.
max_eœp
));

4514 ià(
»g_ruË
->
æags
) {

4515 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_DFS
)

4516 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", DFS");

4517 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_NO_OFDM
)

4518 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_OFDM");

4519 ià(
»g_ruË
->
æags
 & (
NL80211_RRF_NO_IR
))

4520 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_IR");

4521 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_NO_INDOOR
)

4522 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_INDOOR");

4523 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_NO_OUTDOOR
)

4524 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_OUTDOOR");

4526 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "\n");

4530 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "Channels:");

4532 
i
 = 0; i < 
suµ_chª_Ëngth
; i++) {

4533 
chªÃl_¡¬t_num
 = 
suµÜ‹d_chªÃls
[
i
].
¡¬t_chª_num
;

4534 
chªÃl_couÁ
 = 
suµÜ‹d_chªÃls
[
i
].channel_count;

4535 
chªÃl_šüem’t
 = 
suµÜ‹d_chªÃls
[
i
].
šüem’t
;

4536 
chªÃl_bªd
 = 
suµÜ‹d_chªÃls
[
i
].
bªd
;

4537 
chªÃl_’d_num
 = 
chªÃl_¡¬t_num
 + ((
chªÃl_couÁ
 - 1è* 
chªÃl_šüem’t
);

4538 
j
 = 
chªÃl_¡¬t_num
; j <ğ
chªÃl_’d_num
; j +ğ
chªÃl_šüem’t
) {

4539 
chªÃl_¡¬t_äeq
 = (
	`›“80211_chªÃl_to_äequ’cy
(
j
, 
chªÃl_bªd
) * 1000) - 10000;

4540 
chªÃl_’d_äeq
 = (
	`›“80211_chªÃl_to_äequ’cy
(
j
, 
chªÃl_bªd
) * 1000) + 10000;

4541 
k
 = 0; k < 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
; k++) {

4542 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
k
];

4543 ià(
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 <ğ
chªÃl_¡¬t_äeq
 &&

4544 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 >ğ
chªÃl_’d_äeq
) {

4545 ià(
di¥Ïy_·‰”n
)

4546 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", %d", 
j
);

4548 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, " %d", 
j
);

4549 
di¥Ïy_·‰”n
 = 
Œue
;

4555 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "\n");

4556  
cur_pos
;

4557 
	}
}

4559 
	$¦si_g‘_suµÜ‹d_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_suµÜ‹d_chªÃls
 *
suµÜ‹d_chªÃls
)

4561 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

4562 
¦si_mib_d©a
 
suµÜ‹d_chª_mib
;

4563 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

4564 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{
SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
, { 0, 0 } } };

4565 
i
, 
chª_couÁ
, 
chª_¡¬t
;

4566 
suµ_chª_Ëngth
 = 0;

4569 
mibr¥
.
d©aL’gth
 = 16;

4570 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

4571 ià(!
mibr¥
.
d©a
) {

4572 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

4575 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 1, &
mibr¥
);

4576 ià(!
v®ues
)

4577 
ex™_w™h_mibr¥
;

4579 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
) {

4580 
	`SLSI_ERR
(
sdev
, "Supported_Chan invalidype.");

4581 
ex™_w™h_v®ues
;

4584 
suµÜ‹d_chª_mib
 = 
v®ues
[0].
u
.
où‘V®ue
;

4585 
i
 = 0; i < 
suµÜ‹d_chª_mib
.
d©aL’gth
 / 2; i++) {

4586 
chª_¡¬t
 = 
suµÜ‹d_chª_mib
.
d©a
[
i
 * 2];

4587 
chª_couÁ
 = 
suµÜ‹d_chª_mib
.
d©a
[
i
 * 2 + 1];

4588 ià(
chª_¡¬t
 == 1) {

4589 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
¡¬t_chª_num
 = 1;

4590 ià(!(
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 & 
SLSI_HOSTSTATE_CELLULAR_ACTIVE
) &&

4591 
chª_couÁ
 > 11 && 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
) {

4592 
chª_couÁ
 = 11;

4593 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Channels 12‡nd 13 have been disabled");

4595 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
chªÃl_couÁ
 = 
chª_couÁ
;

4596 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
šüem’t
 = 1;

4597 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
bªd
 = 
NL80211_BAND_2GHZ
;

4598 
suµ_chª_Ëngth
 = supp_chan_length + 1;

4600 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
¡¬t_chª_num
 = 
chª_¡¬t
;

4601 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
chªÃl_couÁ
 = 
chª_couÁ
;

4602 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
šüem’t
 = 4;

4603 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
bªd
 = 
NL80211_BAND_5GHZ
;

4604 
suµ_chª_Ëngth
 = supp_chan_length + 1;

4607 
ex™_w™h_v®ues
:

4608 
	`kä“
(
v®ues
);

4609 
ex™_w™h_mibr¥
:

4610 
	`kä“
(
mibr¥
.
d©a
);

4611  
suµ_chª_Ëngth
;

4612 
	}
}

4614 
	$¦si_g‘_»guÏtÜy
(
Ãt_deviû
 *
dev
, *
buf
, 
buf_Ën
)

4616 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4617 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4618 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4619 
mode
 = 0;

4620 
cur_pos
 = 0;

4621 
¡©us
;

4622 
u8
 
®pha2
[3];

4623 
¦si_suµÜ‹d_chªÃls
 
suµÜ‹d_chªÃls
[5];

4624 
suµ_chª_Ëngth
;

4626 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
buf
, 
buf_Ën
, 1);

4627 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4629 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

4630 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4631 
	`kä“
(
ioùl_¬gs
);

4632  -
EINVAL
;

4635 ià(
mode
 != 0 && mode != 1) {

4636 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4637 
	`kä“
(
ioùl_¬gs
);

4638  -
EINVAL
;

4641 ià(
mode
 == 1) {

4642 
¦si_802_11d_»g_domaš
 
domaš_šfo
;

4644 
	`mem£t
(&
domaš_šfo
, 0, (
¦si_802_11d_»g_domaš
));

4645 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4646 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 || !ndev_vif->
¡a
.
¡a_bss
) {

4647 
	`¢´štf
(
buf
, 
buf_Ën
, "Station‚ot connected");

4648 
	`SLSI_ERR
(
sdev
, "station‚ot connected. vif.activated:%d, vif.type:%d, vif.bss:%s\n",

4649 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
,‚dev_vif->
¡a
.
¡a_bss
 ? "yes" : "no");

4650 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4651 
	`kä“
(
ioùl_¬gs
);

4652  -
EINVAL
;

4655 
¡©us
 = 
	`¦si_»ad_deçuÉ_couÁry
(
sdev
, 
®pha2
, 
ndev_vif
->
iâum
 + 1);

4656 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4657 ià(
¡©us
) {

4658 
	`kä“
(
ioùl_¬gs
);

4659  
¡©us
;

4663 
domaš_šfo
.
»gdomaš
 = 
	`km®loc
((*domaš_šfo.»gdomašè+ (
›“80211_»g_ruË
è* 20, 
GFP_KERNEL
);

4664 ià(!
domaš_šfo
.
»gdomaš
) {

4665 
	`SLSI_ERR
(
sdev
, "no memory size:%lu\n",

4666 (
›“80211_»gdomaš
è+ (
›“80211_»g_ruË
) * 20);

4667 
	`kä“
(
ioùl_¬gs
);

4668  -
ENOMEM
;

4672 
domaš_šfo
.
couÁryli¡
 = 
sdev
->
deviû_cÚfig
.domain_info.countrylist;

4673 
domaš_šfo
.
couÁry_Ën
 = 
sdev
->
deviû_cÚfig
.domain_info.country_len;

4674 
¡©us
 = 
	`¦si_»ad_»guÏtÜy_ruËs
(
sdev
, &
domaš_šfo
, 
®pha2
);

4675 ià(
¡©us
) {

4676 
	`kä“
(
domaš_šfo
.
»gdomaš
);

4677 
	`kä“
(
ioùl_¬gs
);

4678  
¡©us
;

4681 
suµ_chª_Ëngth
 = 
	`¦si_g‘_suµÜ‹d_chªÃls
(
sdev
, 
dev
, &
suµÜ‹d_chªÃls
[0]);

4682 
cur_pos
 +ğ
	`¦si_´št_»guÏtÜy
(&
domaš_šfo
, 
buf
 + cur_pos, 
buf_Ën
 - cur_pos, &
suµÜ‹d_chªÃls
[0], 
suµ_chª_Ëngth
);

4683 
	`kä“
(
domaš_šfo
.
»gdomaš
);

4684 } ià(
mode
 == 0) {

4685 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4686 
suµ_chª_Ëngth
 = 
	`¦si_g‘_suµÜ‹d_chªÃls
(
sdev
, 
dev
, &
suµÜ‹d_chªÃls
[0]);

4687 
cur_pos
 +ğ
	`¦si_´št_»guÏtÜy
(&
sdev
->
deviû_cÚfig
.
domaš_šfo
, 
buf
 + cur_pos, 
buf_Ën
 - cur_pos, &
suµÜ‹d_chªÃls
[0], 
suµ_chª_Ëngth
);

4688 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4693 
	`kä“
(
ioùl_¬gs
);

4694 ià(
buf_Ën
 - 
cur_pos
)

4695  
cur_pos
;

4697  -
ENOMEM
;

4698 
	}
}

4700 
	$¦si_di§bË_ch12_13
(
¦si_dev
 *
sdev
)

4702 
why
 *why = 
sdev
->wiphy;

4703 
›“80211_chªÃl
 *
chª
;

4705 ià(
why
->
bªds
[0]) {

4706 
chª
 = &
why
->
bªds
[0]->
chªÃls
[11];

4707 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

4708 
chª
 = &
why
->
bªds
[0]->
chªÃls
[12];

4709 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

4712 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Channels 12‡nd 13 have been disabled");

4713 
	}
}

4715 
	$¦si_£t_fcc_chªÃl
(
Ãt_deviû
 *
dev
, *
cmd
, 
cmd_Ën
)

4717 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4718 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4719 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4720 
¡©us
;

4721 
fcc_chªÃl_v®ue
;

4722 
u16
 
ho¡_¡©e
;

4724 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
cmd
, 
cmd_Ën
, 1);

4725 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4727 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
fcc_chªÃl_v®ue
)) {

4728 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4729 
	`kä“
(
ioùl_¬gs
);

4730  -
EINVAL
;

4733 ià(
fcc_chªÃl_v®ue
 != 0 && fcc_channel_value != -1) {

4734 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàæight_mode_’a: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4735 
	`kä“
(
ioùl_¬gs
);

4736  -
EINVAL
;

4739 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4740 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

4744 ià(
fcc_chªÃl_v®ue
 == 0)

4745 
ho¡_¡©e
 = ho¡_¡©& ~
SLSI_HOSTSTATE_CELLULAR_ACTIVE
;

4747 
ho¡_¡©e
 = ho¡_¡©| 
SLSI_HOSTSTATE_CELLULAR_ACTIVE
;

4748 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

4750 
¡©us
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

4751 ià(
¡©us
) {

4752 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg MMaxPow”EÇ.ƒ¼Ü = %d\n", 
¡©us
);

4754 ià(
fcc_chªÃl_v®ue
 =ğ0 && 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
)

4755 
	`¦si_di§bË_ch12_13
(
sdev
);

4757 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4759 
	`kä“
(
ioùl_¬gs
);

4760  
¡©us
;

4761 
	}
}

4763 
	$¦si_çke_mac_wr™e
(
Ãt_deviû
 *
dev
, *
cmd
, 
buf_Ën
)

4765 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4766 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4767 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4768 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4769 
¡©us
;

4770 
boŞ
 
’abË
;

4772 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
cmd
, 
buf_Ën
, 1);

4773 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4775 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ2 && 
	`¡ºcmp
(ioctl_args->args[0], "ON", strlen("ON")) == 0) {

4776 
’abË
 = 1;

4777 } ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ3 && 
	`¡ºcmp
(ioctl_args->args[0], "OFF", strlen("OFF")) == 0) {

4778 
’abË
 = 0;

4780 
	`SLSI_ERR
(
sdev
, "Inv®id…¬am‘”: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4781 
	`kä“
(
ioùl_¬gs
);

4782  -
EINVAL
;

4785 
¡©us
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
, 
’abË
, 0);

4786 ià(
¡©us
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4787 
	`SLSI_ERR
(
sdev
, "FAKE MAC FAIL:‚o mem for MIB\n");

4788 
	`kä“
(
ioùl_¬gs
);

4789  -
ENOMEM
;

4792 
¡©us
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

4794 
	`kä“
(
mib_d©a
.
d©a
);

4796 ià(
¡©us
)

4797 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiMacAddrRªdomi¡aiÚ MIB.ƒ¼Ü = %d\n", 
¡©us
);

4799 
	`kä“
(
ioùl_¬gs
);

4800  
¡©us
;

4801 
	}
}

4803 *
	$¦si_g‘_assoc_¡©us
(
u16
 
fw_»suÉ_code
)

4805 *
assoc_¡©us_Ïb–
 = "unspecified_failure";

4807 
fw_»suÉ_code
) {

4808 
FAPI_RESULTCODE_SUCCESS
:

4809 
assoc_¡©us_Ïb–
 = "success";

4811 
FAPI_RESULTCODE_TRANSMISSION_FAILURE
:

4812 
assoc_¡©us_Ïb–
 = "transmission_failure";

4814 
FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
:

4815 
assoc_¡©us_Ïb–
 = "host_request_success";

4817 
FAPI_RESULTCODE_HOST_REQUEST_FAILED
:

4818 
assoc_¡©us_Ïb–
 = "host_request_failed";

4820 
FAPI_RESULTCODE_PROBE_TIMEOUT
:

4821 
assoc_¡©us_Ïb–
 = "probe_timeout";

4823 
FAPI_RESULTCODE_AUTH_TIMEOUT
:

4824 
assoc_¡©us_Ïb–
 = "auth_timeout";

4826 
FAPI_RESULTCODE_ASSOC_TIMEOUT
:

4827 
assoc_¡©us_Ïb–
 = "assoc_timeout";

4829 
FAPI_RESULTCODE_ASSOC_ABORT
:

4830 
assoc_¡©us_Ïb–
 = "assoc_abort";

4833  
assoc_¡©us_Ïb–
;

4834 
	}
}

4836 
	$¦si_g‘_¡a_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4838 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4839 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4840 
Ën
;

4841 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


4842 
Ãt_deviû
 *
­_dev
;

4843 
Ãtdev_vif
 *
ndev_­_vif
;

4845 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

4847 ià(
­_dev
) {

4848 
ndev_­_vif
 = 
	`Ãtdev_´iv
(
­_dev
);

4849 
	`SLSI_MUTEX_LOCK
(
ndev_­_vif
->
vif_mu‹x
);

4850 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_­_vif
))

4851 
ndev_vif
 = 
ndev_­_vif
;

4852 
	`SLSI_MUTEX_UNLOCK
(
ndev_­_vif
->
vif_mu‹x
);

4856 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4858 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
) {

4859 
	`SLSI_ERR
(
sdev
, "slsi_get_sta_info: AP is‚ot up.Command‚ot‡llowed vif.activated:%d, vif.type:%d\n",

4860 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
);

4861 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4862  -
EINVAL
;

4865 #ià
	`defšed
(
SCSC_SEP_VERSION
) && (SCSC_SEP_VERSION >= 9)

4866 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "GETSTAINFO %pM Rx_Retry_Pkts=%d Rx_BcMc_Pkts=%d CAP=%04x %02x:%02x:%02x ",

4867 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
,

4868 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_»Œy_·ck‘s
,

4869 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_bc_mc_·ck‘s
,

4870 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ÿ·b™›s
,

4871 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[0],

4872 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[1],

4873 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[2]);

4875 
Ën
 +ğ
	`¢´štf
(&
commªd
[Ën], (
buf_Ën
 -†en), "%d %d %d %d %d %d %d %u %d",

4876 
	`›“80211_äequ’cy_to_chªÃl
(
ndev_vif
->
­
.
chªÃl_äeq
),

4877 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
rssi
,

4878 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
suµÜt_mode
,

4879 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
,

4880 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
mimo_u£d
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
»asÚ
,

4881 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜ‹d_bªd
);

4883 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "wl_get_sta_info : %02x%02x%02x %u %d %d %d %d %d %d %u ",

4884 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[0],‚dev_vif->ap.last_disconnected_sta.address[1],

4885 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[2],‚dev_vif->­.
chªÃl_äeq
,

4886 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
rssi
,

4887 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
mode
,

4888 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
,

4889 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
mimo_u£d
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
»asÚ
);

4892 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4894  
Ën
;

4895 
	}
}

4897 
	$¦si_g‘_bss_rssi
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4899 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4900 
Ën
 = 0;

4902 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4903 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d", 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rssi
);

4904 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4906  
Ën
;

4907 
	}
}

4909 
	$¦si_g‘_bss_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4911 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4912 
Ën
 = 0;

4914 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4916 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%02x:%02x:%02x %u %u %d %u %u %u %u %u %d %d %u %u %u %u",

4917 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
add»ss
[0],‚dev_vif->sta.last_connected_bss.address[1],

4918 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
add»ss
[2],

4919 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
chªÃl_äeq
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
bªdwidth
,

4920 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rssi
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
tx_d©a_¿‹
,

4921 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mode
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
ª‹Âa_mode
,

4922 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mimo_u£d
,

4923 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
·s¥ošt_v”siÚ
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
¢r
,

4924 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
noi£_Ëv–
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
rßmšg_akm
,

4925 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rßmšg_couÁ
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
kv
,

4926 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
);

4928 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4930  
Ën
;

4931 
	}
}

4933 
	$¦si_g‘_cu
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4935 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4936 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4937 
mib_v®ue
 = 0;

4938 
»s
 = 0;

4940 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4941 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_STATION
 ||

4942 (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

4943 
	`SLSI_NET_ERR
(
dev
, "Not Activated or Not STA mode or STA is‚ot in Connected state\n");

4944 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4945 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "-1\n");

4946  
»s
;

4949 
»s
 = 
	`¦si_g‘_b—cÚ_cu
(
sdev
, 
dev
, &
mib_v®ue
);

4950 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4952 ià(
»s
)

4953  
»s
;

4955 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d\n", 
mib_v®ue
);

4956  
»s
;

4957 
	}
}

4959 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


4960 
	$¦si_g‘_lšk¥“d
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4962 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4963 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4964 
Ën
 = 0;

4966 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4967 ià(!
ndev_vif
->
aùiv©ed
) {

4968 
	`SLSI_ERR
(
sdev
, "Not Activated, Command‚ot‡llowed vif.activated:%d, vif.type:%d\n",

4969 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
);

4970 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4971  -
EINVAL
;

4974 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

4975 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

4976 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4977  -
EPERM
;

4980 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "MAX_SPEED %u CURRENT_LINK_SPEED %u",

4981 
ndev_vif
->
¡a
.
max_¿‹_mbps
,‚dev_vif->¡a.
d©a_¿‹_mbps
);

4983 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4985  
Ën
;

4986 
	}
}

4989 
	$¦si_g‘_assoc_»jeù_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4991 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4992 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4993 
Ën
 = 0;

4995 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "assoc_»jeù.¡©u : %d %s", 
sdev
->
assoc_»suÉ_code
,

4996 
	`¦si_g‘_assoc_¡©us
(
sdev
->
assoc_»suÉ_code
));

4998  
Ën
;

4999 
	}
}

5001 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


5002 
	$¦si_£t_pow”_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5004 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5005 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5006 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5007 
¡©us
;

5008 
u16
 
pow”_mode
;

5009 
mode
;

5011 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5012 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5014 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

5015 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5016 
	`kä“
(
ioùl_¬gs
);

5017  -
EINVAL
;

5020 ià(
mode
 != 0 && mode != 1) {

5021 
	`SLSI_ERR
(
sdev
, "Inv®id…ow”_mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5022 
	`kä“
(
ioùl_¬gs
);

5023  -
EINVAL
;

5026 
	`SLSI_NET_INFO
(
dev
, "PS MODE mode:%d, vif_ty³:%d, vif_šdex:%d\n", 
mode
, 
ndev_vif
->
vif_ty³
,

5027 
ndev_vif
->
iâum
);

5029 
pow”_mode
 = (
mode
 =ğ0è? 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
 : 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

5030 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5031 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

5032 !(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

5033 
	`SLSI_ERR
(
sdev
, "Command‚ot‡llowed vif.activated:%d, vif.type:%d,‚dev_vif->sta.vif_status:%d\n",

5034 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
,‚dev_vif->
¡a
.
vif_¡©us
);

5035 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5036 
	`kä“
(
ioùl_¬gs
);

5037  -
EINVAL
;

5039 
¡©us
 = 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
pow”_mode
);

5040 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5042 
	`kä“
(
ioùl_¬gs
);

5043  
¡©us
;

5044 
	}
}

5047 
	$¦si_£t_bªdwidth
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5049 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5050 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5051 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5052 
bªdwidth
 = 0;

5053 
»t
 = 0;

5055 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

5056 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5058 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
bªdwidth
)) {

5059 
	`SLSI_ERR
(
sdev
, "Inv®id bªdwidth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5060 
	`kä“
(
ioùl_¬gs
);

5061  -
EINVAL
;

5063 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Bªdwidth = %d\n", 
bªdwidth
);

5065 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5066 ià(
bªdwidth
 == 20 || bandwidth == 40 || bandwidth == 80 || bandwidth == 160) {

5067 
sdev
->
fÜûd_bªdwidth
 = 
bªdwidth
;

5069 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5070 
	`kä“
(
ioùl_¬gs
);

5071  -
EINVAL
;

5074 
»t
 = 
	`¦si_mlme_£t_couÁry
(
sdev
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
);

5075 
sdev
->
fÜûd_bªdwidth
 = 0;

5076 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5078 ià(
»t
 != 0)

5079 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghCouÁry,„‘=%d", 
»t
);

5081 
	`kä“
(
ioùl_¬gs
);

5082  
»t
;

5083 
	}
}

5085 
	$¦si_£t_bss_bªdwidth
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5087 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5088 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5089 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5090 
sk_buff
 *
»q
;

5091 
sk_buff
 *
cfm
;

5092 
bªdwidth
 = 0;

5093 
´ÙeùiÚ_scİe
 = 0;

5094 
»t
 = 0;

5096 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 2);

5097 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5099 ià(!
	`¦si_is_bw_v®id
(
ioùl_¬gs
->
¬gs
[0])) {

5100 
	`SLSI_ERR
(
sdev
, "UÃx³ùed sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5101 
	`kä“
(
ioùl_¬gs
);

5102  -
EINVAL
;

5105 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
bªdwidth
)) {

5106 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5107 
	`kä“
(
ioùl_¬gs
);

5108  -
EINVAL
;

5111 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
´ÙeùiÚ_scİe
)) {

5112 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

5113 
	`kä“
(
ioùl_¬gs
);

5114  -
EINVAL
;

5117 ià(
´ÙeùiÚ_scİe
 != 0 &&…rotection_scope != 1) {

5118 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoà´ÙeùiÚ_scİe: '%d'\n", 
´ÙeùiÚ_scİe
);

5119 
	`kä“
(
ioùl_¬gs
);

5120  -
EINVAL
;

5123 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5124 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
 ||

5125 (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

5126 
	`SLSI_NET_ERR
(
dev
, "Mu¡ bSTA iÁ”çû‡nd cÚÃùed, iáy³ = %d\n", 
ndev_vif
->
iáy³
);

5127 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5128 
	`kä“
(
ioùl_¬gs
);

5129  -
EPERM
;

5132 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_set_bss_max_channel_width_req(vif:%u, bw:%d,…rotection_scope:%x)\n",

5133 
ndev_vif
->
iâum
, 
bªdwidth
, 
´ÙeùiÚ_scİe
);

5135 
»q
 = 
	`çpi_®loc
(
mlme_£t_bss_max_chªÃl_width_»q
, 
MLME_SET_BSS_MAX_CHANNEL_WIDTH_REQ
, 
ndev_vif
->
iâum
, 0);

5136 ià(!
»q
) {

5137 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5138 
	`kä“
(
ioùl_¬gs
);

5139  -
EIO
;

5142 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bss_max_chªÃl_width_»q
.
´ÙeùiÚ_scİe
,…rotection_scope);

5143 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bss_max_chªÃl_width_»q
.
chªÃl_šfÜm©iÚ
, 
bªdwidth
);

5145 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_BSS_MAX_CHANNEL_WIDTH_CFM
);

5146 ià(!
cfm
) {

5147 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5148 
	`kä“
(
ioùl_¬gs
);

5149  -
EIO
;

5152 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bss_max_chªÃl_width_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5153 
	`SLSI_NET_ERR
(
dev
, "mlme_set_bss_max_channel_width_cfm(result:0x%04x) ERROR\n",

5154 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bss_max_chªÃl_width_cfm
.
»suÉ_code
));

5155 
»t
 = -
EINVAL
;

5158 
	`kä“_skb
(
cfm
);

5160 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5162 
	`kä“
(
ioùl_¬gs
);

5163  
»t
;

5164 
	}
}

5166 
	$¦si_£t_discÚÃù_›s
(
Ãt_deviû
 *
dev
, *
cmd
, 
cmd_Ën
)

5168 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5169 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5170 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5171 *
discÚÃù_›s
 = 
cmd
 + 
	`¡¾’
(
CMD_SET_DISCONNECT_IES
) + 1;

5172 
›_Ën
 = 0;

5173 
u8
 *
discÚÃù_›s_bš
;

5174 
u8
 
‹mp_by‹
;

5175 
i
;

5176 
j
;

5177 
Ën
;

5179 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Setting disconnect IE's\n");

5180 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
cmd
, 
cmd_Ën
, 1);

5181 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5183 
discÚÃù_›s
 = 
ioùl_¬gs
->
¬gs
[0];

5184 
›_Ën
 = 
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]);

5187 
›_Ën
 &= (~0x01);

5188 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5189 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = (
›_Ën
 / 2);

5190 
discÚÃù_›s_bš
 = 
	`km®loc
(
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
, 
GFP_KERNEL
);

5191 ià(!
discÚÃù_›s_bš
) {

5192 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

5193 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5194 
	`kä“
(
ioùl_¬gs
);

5195  -
ENOMEM
;

5198 
i
 = 0, 
j
 = 0; j < 
›_Ën
; j += 2) {

5199 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
discÚÃù_›s
[
j
]) << 4 | slsi_parse_hex(disconnect_ies[j + 1]);

5200 
discÚÃù_›s_bš
[
i
++] = 
‹mp_by‹
;

5204 
i
 = 0; i < 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
;) {

5205 ià(
discÚÃù_›s_bš
[
i
] == 0xdd) {

5206 
Ën
 = 
discÚÃù_›s_bš
[
i
 + 1];

5207 ià((
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 - (
i
 + 2)è< 
Ën
) {

5208 
	`SLSI_WARN
(
sdev
, "The†ength of disconnect IE's is‚ot…roper\n");

5209 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = 0;

5210 
	`kä“
(
discÚÃù_›s_bš
);

5211 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5212 
	`kä“
(
ioùl_¬gs
);

5213  -
EINVAL
;

5216 
i
 = i + 2 + 
Ën
;

5218 
	`SLSI_WARN
(
sdev
, "Theag of disconnect IE's is‚ot…roper\n");

5219 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = 0;

5220 
	`kä“
(
discÚÃù_›s_bš
);

5221 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5222 
	`kä“
(
ioùl_¬gs
);

5223  -
EINVAL
;

5226 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
 = 
discÚÃù_›s_bš
;

5227 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5229 
	`kä“
(
ioùl_¬gs
);

5231 
	}
}

5233 
	$¦si_¡¬t_pow”_m—su»m’t_d‘eùiÚ
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5235 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5236 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5237 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

5238 
r
 = 0;

5240 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5242 ià(
sdev
->
d‘eù_vif_aùive
) {

5243 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Detect vif‡lready‡ctive\n");

5244 
r
 = -
EINVAL
;

5245 
ex™_w™h_vif_mu‹x
;

5248 ià(
	`¦si_mlme_add_d‘eù_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

5249 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif for detect vif failed\n");

5250 
r
 = -
EINVAL
;

5251 
ex™_w™h_vif_mu‹x
;

5254 
sdev
->
d‘eù_vif_aùive
 = 
Œue
;

5255 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Starting Power Measurement Detection\n");

5256 
r
 = 
	`¦si_mlme_¡¬t_d‘eù_»que¡
(
sdev
, 
dev
);

5257 ià(
r
) {

5258 
r
 = -
EINVAL
;

5259 ià(
	`¦si_mlme_d–_d‘eù_vif
(
sdev
, 
dev
) != 0)

5260 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed for detect vif\n");

5261 
sdev
->
d‘eù_vif_aùive
 = 
çl£
;

5264 
ex™_w™h_vif_mu‹x
:

5265 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5266  
r
;

5267 
	}
}

5269 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


5270 
	$¦si_’hªûd_¬p_¡¬t_¡İ
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5272 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5273 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5274 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5275 
»suÉ
 = 0;

5276 
»adby‹
 = 0;

5277 
»adv®ue
 = 0;

5278 
i
 = 0;

5280 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5281 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5283 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
»adv®ue
)) {

5284 
	`SLSI_ERR
(
sdev
, "Inv®id s¹/¡İ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5285 
	`kä“
(
ioùl_¬gs
);

5286  -
EINVAL
;

5289 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5290 ià(!
sdev
->
deviû_cÚfig
.
fw_’hªûd_¬p_d‘eù_suµÜ‹d
) {

5291 
	`SLSI_ERR
(
sdev
, "Enhanced ARP Detect Feature is‚ot supported.\n");

5292 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5293 
	`kä“
(
ioùl_¬gs
);

5294  -
ENOTSUPP
;

5296 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5298 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5299 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

5300 
	`SLSI_ERR
(
sdev
, "Not in STA mode\n");

5301 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5302 
	`kä“
(
ioùl_¬gs
);

5303  -
EPERM
;

5306 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Enhanced ARP Start/Stop\n");

5308 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

5309 ià(
»adv®ue
 != 0) {

5310 
i
 = 0; i < 4 ; i++) {

5311 
»adby‹
 = 
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
»adv®ue
);

5312 ià(!
»adby‹
) {

5313 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5314 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

5315 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5316 
	`kä“
(
ioùl_¬gs
);

5317  -
EINVAL
;

5319 ià(
»adv®ue
 < 0 ||„eadvalue > 255) {

5320 
	`SLSI_ERR
(
sdev
, "Invalid value of IP‡ddress byte\n");

5321 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

5322 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5323 
	`kä“
(
ioùl_¬gs
);

5324  -
EINVAL
;

5326 
ndev_vif
->
rg‘__addr
[
i
] = 
»adv®ue
;

5327 ià(
i
 == 3)

5329 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è- 
»adby‹
 - 1 <= 0) {

5330 
	`SLSI_ERR
(
sdev
, "Invalid IP‡ddress\n");

5331 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

5332 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5333 
	`kä“
(
ioùl_¬gs
);

5334  -
EINVAL
;

5336 
ioùl_¬gs
->
¬gs
[0] = ioùl_¬gs->¬gs[0] + 
»adby‹
 + 1;

5340 ià(
ndev_vif
->
rg‘__addr
[0] != 0) {

5342 
	`¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ARP_DETECT_RESPONSE_COUNTER
);

5343 
	`mem£t
(&
ndev_vif
->
’hªûd_¬p_¡©s
, 0, (ndev_vif->enhanced_arp_stats));

5344 
	`mem£t
(
ndev_vif
->
’hªûd_¬p_ho¡_g
, 0, (ndev_vif->enhanced_arp_host_tag));

5345 
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 = 
Œue
;

5346 
»suÉ
 = 
	`¦si_mlme_¬p_d‘eù_»que¡
(
sdev
, 
dev
, 
FAPI_ACTION_START
, 
ndev_vif
->
rg‘__addr
);

5348 
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 = 
çl£
;

5349 
»suÉ
 = 
	`¦si_mlme_¬p_d‘eù_»que¡
(
sdev
, 
dev
, 
FAPI_ACTION_STOP
, 
ndev_vif
->
rg‘__addr
);

5352 
	`kä“
(
ioùl_¬gs
);

5353 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5354  
»suÉ
;

5355 
	}
}

5357 
	$¦si_’hªûd_¬p_g‘_¡©s
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5359 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5360 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5361 
r
 = 0;

5362 
Ën
 = 0;

5364 
r
 = 
	`¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ARP_DETECT_RESPONSE_COUNTER
);

5366 ià(
r
 == 0) {

5367 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d %d %d %d %d %d %d %d %d %d",

5368 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_äom_Ãtdev
,

5369 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_to_low”_mac
,

5370 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_rx_couÁ_by_low”_mac
,

5371 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_tx_sucûss
,

5372 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_low”_mac
,

5373 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_uµ”_mac
,

5374 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_to_Ãtdev
,

5375 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_out_of_Üd”_drİ
,

5377 
ndev_vif
->
’hªûd_¬p_¡©s
.
is_du¶iÿ‹_addr_d‘eùed
);

5378 
	`SLSI_DBG2
(
sdev
, 
SLSI_CFG80211
, "Enhªûd ARP Sts: %s\n", 
commªd
);

5382 
	`mem£t
(&
ndev_vif
->
’hªûd_¬p_¡©s
, 0, (ndev_vif->enhanced_arp_stats));

5384  
Ën
;

5385 
	}
}

5388 
	$¦si_ioùl_auto_chª_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5390 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5391 
»t
 = 0;

5393 
»t
 = 
	`¦si_auto_chª_wr™e
(
dev
, 
commªd
, 
cmd_Ën
);

5394 
ndev_vif
->
acs
 = 
Œue
;

5395  
»t
;

5396 
	}
}

5398 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


5399 
	$¦si_ioùl_‹¡_fÜû_hªg
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5401  
	`¦si_‹¡_£nd_hªged_v’dÜ_ev’t
(
dev
);

5402 
	}
}

5405 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


5406 
	$¦si_ioùl_£t_Ï‹ncy_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5408 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5409 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5410 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5411 
Ï‹ncy_mode
 = 0;

5412 
»t
 = 0;

5414 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

5415 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5417 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ï‹ncy_mode
)) {

5418 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5419 
»t
 = -
EINVAL
;

5421 ià(
Ï‹ncy_mode
 < 0 ||†atency_mode > 2) {

5422 
	`SLSI_ERR
(
sdev
, "Inv®id†©’cy_mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5423 
»t
 = -
EINVAL
;

5425 
»t
 = 
	`¦si_£t_Ï‹ncy_mode
(
dev
, 
Ï‹ncy_mode
, 
cmd_Ën
);

5428 
	`kä“
(
ioùl_¬gs
);

5429  
»t
;

5430 
	}
}

5433 
	$¦si_ioùl_£t_Ï‹ncy_üt_d©a
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5435 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5436 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5437 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5438 
Ï‹ncy_mode
 = 0;

5439 
»t
 = 0;

5441 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

5442 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5444 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ï‹ncy_mode
)) {

5445 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5446 
»t
 = -
EINVAL
;

5448 ià(
Ï‹ncy_mode
 < 0 ||†atency_mode > 3) {

5449 
	`SLSI_ERR
(
sdev
, "Inv®id†©’cy_üt_d©a: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5450 
»t
 = -
EINVAL
;

5452 
»t
 = 
	`¦si_£t_Ï‹ncy_üt_d©a
(
dev
, 
Ï‹ncy_mode
);

5455 
	`kä“
(
ioùl_¬gs
);

5456  
»t
;

5457 
	}
}

5459 #iâdeà
SLSI_TEST_DEV


5460 
	$¦si_ioùl_driv”_bug_dump
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5462 
»t
 = 0;

5464 
	`¦si_dump_¡©s
(
dev
);

5465 #ifdeà
CONFIG_SCSC_LOG_COLLECTION


5466 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_DUMPSTATE
, 
SCSC_LOG_DUMPSTATE_REASON_DRIVERDEBUGDUMP
);

5468 #iâdeà
SLSI_TEST_DEV


5469 #ià
	`IS_ENABLED
(
CONFIG_SCSC_INDEPENDENT_SUBSYSTEM
)

5470 
	`SLSI_NET_INFO
(
dev
, "SCSC_LOG_COLLECTION‚otƒnabled. Sable will‚ot beriggered\n");

5472 
»t
 = 
	`mx140_log_dump
();

5476  
»t
;

5477 
	}
}

5480 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


5481 
	$¦si_ioùl_g‘_num_ª‹Âas
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5483 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5484 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5485 
num_ª‹Âas
 = 0;

5486 
»s
 = 0;

5488 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5489 
»s
 = 
	`¦si_mlme_g‘_num_ª‹Âas
(
sdev
, 
dev
, &
num_ª‹Âas
);

5490 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5492 ià(
»s
)

5493  
»s
;

5495 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d\n", 
num_ª‹Âas
);

5496  
»s
;

5497 
	}
}

5499 
	$¦si_ioùl_£t_num_ª‹Âas
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5501 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5502 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5503 
num_of_ª‹Âas
;

5504 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5505 
»t
 = 0;

5506 
äame_ty³
 = 0;

5508 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 2);

5509 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5511 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
num_of_ª‹Âas
)) {

5512 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5513 
»t
 = -
EINVAL
;

5518 ià(
ioùl_¬gs
->
¬g_couÁ
 == 2) {

5519 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
äame_ty³
)) {

5520 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

5521 
»t
 = -
EINVAL
;

5522 
ex™
;

5524 
äame_ty³
 += 1;

5526 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5527 
»t
 = 
	`¦si_mlme_£t_num_ª‹Âas
(
dev
, 
num_of_ª‹Âas
, 
äame_ty³
);

5528 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5530 
ex™
:

5531 
	`kä“
(
ioùl_¬gs
);

5532  
»t
;

5533 
	}
}

5536 
	$¦si_–Ç_by·ss
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5538 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5539 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5540 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5541 
mib_v®ue
 = 0;

5543 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5544 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5546 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

5547 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5548 
	`kä“
(
ioùl_¬gs
);

5549  -
EINVAL
;

5551 
	`kä“
(
ioùl_¬gs
);

5552 ià(
mib_v®ue
 != 0 && mib_value != 1) {

5553 
	`SLSI_ERR
(
sdev
, "Inv®id LNA cÚŒŞ: '%d'\n", 
mib_v®ue
);

5554  -
EINVAL
;

5556 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5557 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

5558 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5559 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5560  -
EPERM
;

5562 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5564  
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_LNA_CONTROL_ENABLED
, 
mib_v®ue
);

5565 
	}
}

5567 
	$¦si_–Ç_by·ss_št
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5569 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5570 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5571 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5572 
mib_v®ue
 = 0;

5574 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5575 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5577 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

5578 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5579 
	`kä“
(
ioùl_¬gs
);

5580  -
EINVAL
;

5582 
	`kä“
(
ioùl_¬gs
);

5583 ià(
mib_v®ue
 < 0 || mib_value > 65535) {

5584 
	`SLSI_ERR
(
sdev
, "Inv®id LNA Ev® IÁ”v–: '%d'\n", 
mib_v®ue
);

5585  -
EINVAL
;

5587 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5588 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

5589 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5590 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5591  -
EPERM
;

5593 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5595  
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_LNA_CONTROL_EVALUATION_INTERVAL
, 
mib_v®ue
);

5596 
	}
}

5598 
	$¦si_£t_dw–l_time
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5600 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5601 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5602 
·ssive_time
 = 0;

5603 
home_time
 = 0;

5604 
sÿn_chªÃl_time
 = 0;

5605 
home_away_time
 = 0;

5606 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5607 
»t
 = 0;

5608 
»£t
 = 1;

5610 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 4);

5611 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5613 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
·ssive_time
)) {

5614 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg…assive_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5615 
»t
 = -
EINVAL
;

5616 } ià(
·ssive_time
 < 0 ||…assive_time > 0xFFFF) {

5617 
	`SLSI_ERR
(
sdev
, "Inv®id…assive_timv®ue: '%d'\n", 
·ssive_time
);

5618 
»t
 = -
EINVAL
;

5621 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
home_time
)) {

5622 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg home_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

5623 
»t
 = -
EINVAL
;

5624 } ià(
home_time
 < 0 || home_time > 0xFFFF) {

5625 
	`SLSI_ERR
(
sdev
, "Inv®id home_timv®ue: '%d'\n", 
home_time
);

5626 
»t
 = -
EINVAL
;

5629 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
sÿn_chªÃl_time
)) {

5630 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg sÿn_chªÃl_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

5631 
»t
 = -
EINVAL
;

5632 } ià(
sÿn_chªÃl_time
 < 0 || scan_channel_time > 0xFFFF) {

5633 
	`SLSI_ERR
(
sdev
, "Inv®id sÿn_chªÃl_timv®ue: '%d'\n", 
sÿn_chªÃl_time
);

5634 
»t
 = -
EINVAL
;

5637 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
home_away_time
)) {

5638 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg sÿn_chªÃl_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

5639 
»t
 = -
EINVAL
;

5640 } ià(
home_away_time
 < 0 || home_away_time > 0xFFFF) {

5641 
	`SLSI_ERR
(
sdev
, "Inv®id sÿn_chªÃl_timv®ue: '%d'\n", 
home_away_time
);

5642 
»t
 = -
EINVAL
;

5645 ià(
»t
 != 0)

5646 
ex™
;

5648 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5649 
sdev
->
home_away_time
 = home_away_time;

5650 
sdev
->
home_time
 = home_time;

5651 
sdev
->
max_chªÃl_time
 = 
sÿn_chªÃl_time
;

5652 
sdev
->
max_chªÃl_·ssive_time
 = 
·ssive_time
;

5654 ià(
home_away_time
 !ğ0 && 
home_time
 !ğ0 && 
sÿn_chªÃl_time
 !ğ0 && 
·ssive_time
 != 0)

5655 
sdev
->
Ï‹ncy_·¿m_mask
 = 
LATENCY_ALL_SET_MASK
;

5657 
»£t
 = 0;

5658 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
»£t
);

5659 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5660 
ex™
:

5661 
	`kä“
(
ioùl_¬gs
);

5662  
»t
;

5663 
	}
}

5665 
	$¦si_max_dtim_su¥’d
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5667 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5668 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5669 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5670 
mib_v®ue
 = 0;

5671 
»t
 = 0;

5673 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5674 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5676 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

5677 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5678 
	`kä“
(
ioùl_¬gs
);

5679  -
EINVAL
;

5681 
	`kä“
(
ioùl_¬gs
);

5682 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5683 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

5684 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5685 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5686  -
EPERM
;

5688 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5690 ià(
mib_v®ue
 < 0 || mib_value > 1) {

5691 
	`SLSI_ERR
(
sdev
, "Inv®id Max DTIM Su¥’d: '%d'\n", 
mib_v®ue
);

5692  -
EINVAL
;

5694 ià(
mib_v®ue
 == 0) {

5695 
sdev
->
max_dtim_»cv
 = 
Œue
;

5696 } ià(
mib_v®ue
 == 1) {

5697 
sdev
->
max_dtim_»cv
 = 
çl£
;

5698 
»t
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_USE_HOST_LISTEN_INTERVAL
, 0);

5701  
»t
;

5702 
	}
}

5704 
	$¦si_£t_dtim_su¥’d
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5706 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5707 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5708 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5709 
mib_v®ue
 = 0;

5710 
»t
 = 0;

5712 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5713 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5715 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

5716 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5717 
	`kä“
(
ioùl_¬gs
);

5718  -
EINVAL
;

5720 
	`kä“
(
ioùl_¬gs
);

5721 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5722 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

5723 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5724 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5725  -
EPERM
;

5727 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5729 ià(!
sdev
->
max_dtim_»cv
) {

5730 
	`SLSI_ERR
(
sdev
, "Max DTIM Suspend = 0‚ot„eceived\n");

5731  -
EPERM
;

5734 
sdev
->
max_dtim_»cv
 = 
çl£
;

5736 ià(
mib_v®ue
 < 0) {

5737 
	`SLSI_ERR
(
sdev
, "Inv®id S‘ DTIM Su¥’d v®: '%d'\n", 
mib_v®ue
);

5738  -
EINVAL
;

5741 
»t
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_USE_HOST_LISTEN_INTERVAL
, 
mib_v®ue
);

5742  
»t
;

5743 
	}
}

5745 
	$¦si_fÜû_rßmšg_bssid
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5747 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5748 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5749 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5750 
u8
 
bssid
[6] = { 0 };

5751 
chªÃl
;

5752 
äeq
;

5753 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

5754 
»t
 = 0;

5756 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

5757 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5759 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

5760 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

5761 
	`kä“
(
ioùl_¬gs
);

5762  -
EINVAL
;

5765 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

5766 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

5767 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

5768 
	`kä“
(
ioùl_¬gs
);

5769  -
EINVAL
;

5771 
	`kä“
(
ioùl_¬gs
);

5772 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "FÜû Rßm: " 
MACSTR
 " Chan: %d\n",

5773 
	`MAC2STR
(
bssid
), 
chªÃl
);

5776 ià(
	`¦si_is_bssid_š_bÏckli¡
(
sdev
, 
dev
, 
bssid
) ||

5777 
	`¦si_is_bssid_š_h®_bÏckli¡
(
dev
, 
bssid
) ||

5778 
	`¦si_is_bssid_š_ioùl_bÏckli¡
(
dev
, 
bssid
)) {

5779 
	`SLSI_ERR
(
sdev
, "Requested BSSID is in blacklist\n");

5780  -
EINVAL
;

5783 ià(
chªÃl
 < 1 || channel > 165) {

5784 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

5785  -
EINVAL
;

5788 ià(
chªÃl
 > 14)

5789 
bªd
 = 
NL80211_BAND_5GHZ
;

5790 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

5792 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5793 
»t
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

5794 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5795  
»t
;

5796 
	}
}

5798 
	$¦si_rßmšg_bÏckli¡_add
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5800 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5801 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5802 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5803 
u8
 
bssid
[6] = { 0 };

5804 
»t
 = 0;

5806 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5807 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5809 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

5810 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

5811 
	`kä“
(
ioùl_¬gs
);

5812  -
EINVAL
;

5815 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

5816 
	`kä“
(
ioùl_¬gs
);

5817 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5819 ià(
	`¦si_is_bssid_š_ioùl_bÏckli¡
(
dev
, 
bssid
)) {

5820 
	`SLSI_ERR
(
sdev
, "Requested BSSID‡lready in blacklist\n");

5821 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5822  
»t
;

5824 
»t
 = 
	`¦si_add_ioùl_bÏckli¡
(
sdev
, 
dev
, 
bssid
);

5825 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5826  
»t
;

5827 
	}
}

5829 
	$¦si_rßmšg_bÏckli¡_»move
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5831 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5832 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5833 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5834 
u8
 
bssid
[6] = { 0 };

5835 
»t
 = 0;

5837 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5838 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5840 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

5841 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

5842 
	`kä“
(
ioùl_¬gs
);

5843  -
EINVAL
;

5846 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

5847 
	`kä“
(
ioùl_¬gs
);

5848 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5849 
»t
 = 
	`¦si_»move_bssid_bÏckli¡
(
sdev
, 
dev
, 
bssid
);

5850 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5851  
»t
;

5852 
	}
}

5854 
	$¦si_ioùl_cmd_sucûss
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5857 
	}
}

5859 
	s¦si_ioùl_â
 {

5860 *
	mÇme
;

5861 (*
	mâ
)(
Ãt_deviû
 *
	mdev
, *
	mcommªd
, 
	mcmd_Ën
);

5864 cÚ¡ 
¦si_ioùl_â
 
	g¦si_ioùl_â_bË
[] = {

5865 { 
CMD_SETSUSPENDMODE
, 
¦si_£t_su¥’d_mode
 },

5866 { 
CMD_SETJOINPREFER
, 
¦si_upd©e_rssi_boo¡
 },

5867 { 
CMD_RXFILTERADD
, 
¦si_rx_f‹r_add
 },

5868 { 
CMD_RXFILTERREMOVE
, 
¦si_rx_f‹r_»move
 },

5869 { 
CMD_SETBANDWIDTH
, 
¦si_£t_bªdwidth
 },

5870 { 
CMD_SETSCANHOMEAWAYTIME_LEGACY
, 
¦si_£t_home_away_time_Ëgacy
 },

5871 { 
CMD_SETSCANHOMETIME_LEGACY
, 
¦si_£t_home_time_Ëgacy
 },

5872 { 
CMD_SETSCANCHANNELTIME_LEGACY
, 
¦si_£t_chªÃl_time_Ëgacy
 },

5873 { 
CMD_SETSCANPASSIVETIME_LEGACY
, 
¦si_£t_·ssive_time_Ëgacy
 },

5874 { 
CMD_SET_TID
, 
¦si_£t_tid
 },

5875 { 
CMD_SET_BSS_CHANNEL_WIDTH
, 
¦si_£t_bss_bªdwidth
 },

5876 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


5877 #ià!
defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 9)

5878 { 
CMD_INTERFACE_CREATE
, 
¦si_ü—‹_š‹rçû
 },

5879 { 
CMD_INTERFACE_DELETE
, 
¦si_d–‘e_š‹rçû
 },

5881 { 
CMD_SET_INDOOR_CHANNELS
, 
¦si_£t_wifish¬šg_³rm™‹d_chªÃls
 },

5882 { 
CMD_GET_INDOOR_CHANNELS
, 
¦si_g‘_šdoÜ_chªÃls
 },

5884 { 
CMD_SETCOUNTRYREV
, 
¦si_£t_couÁry_»v
 },

5885 { 
CMD_GETCOUNTRYREV
, 
¦si_g‘_couÁry_»v
 },

5886 { 
CMD_SETROAMBAND
, 
¦si_ioùl_£t_rßm_bªd
 },

5887 { 
CMD_SETBAND
, 
¦si_ioùl_£t_bªd
 },

5888 { 
CMD_GETROAMBAND
, 
¦si_ioùl_g‘_rßm_bªd
 },

5889 { 
CMD_GETBAND
, 
¦si_ioùl_g‘_bªd
 },

5890 { 
CMD_FACTORY_SETBAND
, 
¦si_çùÜy_äeq_bªd_wr™e
 },

5891 { 
CMD_SETROAMTRIGGER_LEGACY
, 
¦si_Ëgacy_rßm_Œigg”_wr™e
 },

5892 { 
CMD_GETROAMTRIGGER_LEGACY
, 
¦si_Ëgacy_rßm_sÿn_Œigg”_»ad
 },

5893 { 
CMD_REASSOC_LEGACY
, 
¦si_»assoc_wr™e_Ëgacy
 },

5894 { 
CMD_REASSOC_FREQUENCY_LEGACY
, 
¦si_»assoc_äequ’cy_wr™e_Ëgacy
 },

5895 { 
CMD_ADDROAMSCANCHANNELS_LEGACY
, 
¦si_rßm_add_sÿn_chªÃls_Ëgacy
 },

5896 { 
CMD_ADDROAMSCANFREQUENCIES_LEGACY
, 
¦si_rßm_add_sÿn_äequ’c›s_Ëgacy
 },

5897 { 
CMD_GETROAMSCANFREQUENCIES_LEGACY
, 
¦si_rßm_sÿn_äequ’c›s_»ad_Ëgacy
 },

5898 { 
CMD_GETROAMSCANCHANNELS_LEGACY
, 
¦si_rßm_sÿn_chªÃls_»ad_Ëgacy
 },

5899 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


5900 { 
CMD_SETROAMTRIGGER
, 
¦si_rßm_sÿn_Œigg”_wr™e
 },

5901 { 
CMD_GETROAMTRIGGER
, 
¦si_rßm_sÿn_Œigg”_»ad
 },

5902 { 
CMD_SETROAMDELTA
, 
¦si_rßm_d–_Œigg”_wr™e
 },

5903 { 
CMD_GETROAMDELTA
, 
¦si_rßm_d–_Œigg”_»ad
 },

5904 { 
CMD_SETROAMSCANPERIOD
, 
¦si_ÿched_chªÃl_sÿn_³riod_wr™e
 },

5905 { 
CMD_GETROAMSCANPERIOD
, 
¦si_ÿched_chªÃl_sÿn_³riod_»ad
 },

5906 { 
CMD_SETFULLROAMSCANPERIOD
, 
¦si_fuÎ_rßm_sÿn_³riod_wr™e
 },

5907 { 
CMD_GETFULLROAMSCANPERIOD
, 
¦si_fuÎ_rßm_sÿn_³riod_»ad
 },

5908 { 
CMD_SETSCANCHANNELTIME
, 
¦si_rßm_sÿn_max_aùive_chªÃl_time_wr™e
 },

5909 { 
CMD_GETSCANCHANNELTIME
, 
¦si_rßm_sÿn_max_aùive_chªÃl_time_»ad
 },

5910 { 
CMD_SETSCANNPROBES
, 
¦si_rßm_sÿn_´obe_š‹rv®_wr™e
 },

5911 { 
CMD_GETSCANNPROBES
, 
¦si_rßm_sÿn_´obe_š‹rv®_»ad
 },

5912 { 
CMD_SETROAMMODE
, 
¦si_rßm_mode_wr™e
 },

5913 { 
CMD_GETROAMMODE
, 
¦si_rßm_mode_»ad
 },

5914 { 
CMD_SETROAMINTRABAND
, 
¦si_rßm_sÿn_bªd_wr™e
 },

5915 { 
CMD_GETROAMINTRABAND
, 
¦si_rßm_sÿn_bªd_»ad
 },

5916 { 
CMD_SETROAMSCANCONTROL
, 
¦si_rßm_sÿn_cÚŒŞ_wr™e
 },

5917 { 
CMD_GETROAMSCANCONTROL
, 
¦si_rßm_sÿn_cÚŒŞ_»ad
 },

5918 { 
CMD_SETSCANHOMETIME
, 
¦si_rßm_sÿn_home_time_wr™e
 },

5919 { 
CMD_GETSCANHOMETIME
, 
¦si_rßm_sÿn_home_time_»ad
 },

5920 { 
CMD_SETSCANHOMEAWAYTIME
, 
¦si_rßm_sÿn_home_away_time_wr™e
 },

5921 { 
CMD_GETSCANHOMEAWAYTIME
, 
¦si_rßm_sÿn_home_away_time_»ad
 },

5922 { 
CMD_SETOKCMODE
, 
¦si_okc_mode_wr™e
 },

5923 { 
CMD_GETOKCMODE
, 
¦si_okc_mode_»ad
 },

5924 { 
CMD_SETWESMODE
, 
¦si_wes_mode_wr™e
 },

5925 { 
CMD_GETWESMODE
, 
¦si_wes_mode_»ad
 },

5926 { 
CMD_SETROAMSCANCHANNELS
, 
¦si_rßm_sÿn_chªÃls_wr™e
 },

5927 { 
CMD_SETROAMSCANFREQUENCIES
, 
¦si_rßm_sÿn_äequ’c›s_wr™e
 },

5928 { 
CMD_GETROAMSCANCHANNELS
, 
¦si_rßm_sÿn_chªÃls_»ad
 },

5929 { 
CMD_GETROAMSCANFREQUENCIES
, 
¦si_rßm_sÿn_äequ’c›s_»ad
 },

5930 { 
CMD_ADDROAMSCANCHANNELS
, 
¦si_rßm_add_sÿn_chªÃls
 },

5931 { 
CMD_ADDROAMSCANFREQUENCIES
, 
¦si_rßm_add_sÿn_äequ’c›s
 },

5932 { 
CMD_GETNCHOMODE
, 
¦si_g‘_ncho_mode
 },

5933 { 
CMD_SETNCHOMODE
, 
¦si_£t_ncho_mode
 },

5934 { 
CMD_SETDFSSCANMODE
, 
¦si_£t_dfs_sÿn_mode
 },

5935 { 
CMD_GETDFSSCANMODE
, 
¦si_g‘_dfs_sÿn_mode
 },

5936 { 
CMD_REASSOC_FREQUENCY
, 
¦si_»assoc_äequ’cy_wr™e
 },

5937 { 
CMD_REASSOC
, 
¦si_»assoc_wr™e
 },

5938 { 
CMD_SETROAMOFFLOAD
, 
¦si_rßm_mode_wr™e
 },

5939 { 
CMD_SETROAMOFFLAPLIST
, 
¦si_rßm_ofæßd_­_li¡
 },

5941 { 
CMD_SET_PMK
, 
¦si_£t_pmk
 },

5942 { 
CMD_HAPD_GET_CHANNEL
, 
¦si_auto_chª_»ad
 },

5943 { 
CMD_SET_SAP_CHANNEL_LIST
, 
¦si_ioùl_auto_chª_wr™e
 },

5944 { 
CMD_SENDACTIONFRAME
, 
¦si_£nd_aùiÚ_äame
 },

5945 { 
CMD_CERTSENDACTIONFRAME
, 
¦si_£nd_aùiÚ_äame_û¹
 },

5946 #ifdeà
SLSI_TEST_DEV


5947 { 
CMD_GASSENDACTIONFRAME
, 
¦si_£nd_aùiÚ_äame_ut
 },

5949 { 
CMD_HAPD_MAX_NUM_STA
, 
¦si_£‰šg_max_¡a_wr™e
 },

5950 { 
CMD_COUNTRY
, 
¦si_couÁry_wr™e
 },

5951 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

5952 { 
CMD_BEACON_RECV
, 
¦si_fÜw¬d_b—cÚ
 },

5954 { 
CMD_SETAPP2PWPSIE
, 
¦si_£t_­_p2p_wps_›
 },

5955 { 
CMD_P2PSETPS
, 
¦si_£t_p2p_İµs
 },

5956 { 
CMD_P2PSETNOA
, 
¦si_p2p_£t_nß_·¿ms
 },

5957 { 
CMD_P2PECSA
, 
¦si_p2p_ec§
 },

5958 { 
CMD_P2PLOSTART
, 
¦si_p2p_lo_¡¬t
 },

5959 { 
CMD_P2PLOSTOP
, 
¦si_p2p_lo_¡İ
 },

5960 { 
CMD_SET_TX_POWER_CALLING
, 
¦si_£t_tx_pow”_ÿÎšg
 },

5961 { 
CMD_SET_TX_POWER_SUB6_BAND
, 
¦si_£t_tx_pow”_sub6_bªd
 },

5962 { 
CMD_POWER_MEASUREMENT_START
, 
¦si_¡¬t_pow”_m—su»m’t_d‘eùiÚ
 },

5963 { 
CMD_GETREGULATORY
, 
¦si_g‘_»guÏtÜy
 },

5964 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


5965 { 
CMD_TESTFORCEHANG
, 
¦si_ioùl_‹¡_fÜû_hªg
 },

5967 { 
CMD_SET_FCC_CHANNEL
, 
¦si_£t_fcc_chªÃl
 },

5968 { 
CMD_FAKEMAC
, 
¦si_çke_mac_wr™e
 },

5969 { 
CMD_GETBSSRSSI
, 
¦si_g‘_bss_rssi
 },

5970 { 
CMD_GETBSSINFO
, 
¦si_g‘_bss_šfo
 },

5971 { 
CMD_GETSTAINFO
, 
¦si_g‘_¡a_šfo
 },

5972 { 
CMD_GETASSOCREJECTINFO
, 
¦si_g‘_assoc_»jeù_šfo
 },

5973 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


5974 { 
CMD_SET_LATENCY_MODE
, 
¦si_ioùl_£t_Ï‹ncy_mode
 },

5975 { 
CMD_SET_POWER_MGMT
, 
¦si_£t_pow”_mode
 },

5977 { 
CMD_SET_LATENCY_CRT_DATA
, 
¦si_ioùl_£t_Ï‹ncy_üt_d©a
 },

5978 { 
CMD_SET_DISCONNECT_IES
, 
¦si_£t_discÚÃù_›s
 },

5979 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


5980 { 
CMD_SET_ENHANCED_ARP_TARGET
, 
¦si_’hªûd_¬p_¡¬t_¡İ
 },

5981 { 
CMD_GET_ENHANCED_ARP_COUNTS
, 
¦si_’hªûd_¬p_g‘_¡©s
 },

5983 { 
CMD_RXFILTERSTART
, 
¦si_ioùl_cmd_sucûss
 },

5984 { 
CMD_RXFILTERSTOP
, 
¦si_ioùl_cmd_sucûss
 },

5985 { 
CMD_BTCOEXMODE
, 
¦si_ioùl_cmd_sucûss
 },

5986 { 
CMD_BTCOEXSCAN_START
, 
¦si_ioùl_cmd_sucûss
 },

5987 { 
CMD_BTCOEXSCAN_STOP
, 
¦si_ioùl_cmd_sucûss
 },

5988 { 
CMD_MIRACAST
, 
¦si_ioùl_cmd_sucûss
 },

5989 #iâdeà
SLSI_TEST_DEV


5990 { 
CMD_DRIVERDEBUGDUMP
, 
¦si_ioùl_driv”_bug_dump
 },

5991 { 
CMD_DRIVERDEBUGCOMMAND
, 
¦si_ioùl_driv”_bug_dump
 },

5993 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


5994 { 
CMD_ENHANCED_PKT_FILTER
, 
¦si_£t_’hªûd_pkt_f‹r
 },

5996 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


5997 { 
CMD_SET_NUM_ANTENNAS
, 
¦si_ioùl_£t_num_ª‹Âas
 },

5998 { 
CMD_GET_NUM_ANTENNAS
, 
¦si_ioùl_g‘_num_ª‹Âas
 },

6000 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


6001 { 
CMD_GET_MAX_LINK_SPEED
, 
¦si_g‘_lšk¥“d
 },

6004 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


6005 { 
CMD_SET_ITO
, 
¦si_£t_™o
 },

6006 { 
CMD_ENABLE_ITO
, 
¦si_’abË_™o
 },

6008 { 
CMD_GET_CU
, 
¦si_g‘_cu
 },

6009 { 
CMD_ELNA_BYPASS_INT
, 
¦si_–Ç_by·ss_št
 },

6010 { 
CMD_ELNA_BYPASS
, 
¦si_–Ç_by·ss
 },

6011 { 
CMD_SET_DWELL_TIME
, 
¦si_£t_dw–l_time
 },

6012 { 
CMD_SET_DTIM_IN_SUSPEND
, 
¦si_£t_dtim_su¥’d
 },

6013 { 
CMD_MAX_DTIM_IN_SUSPEND
, 
¦si_max_dtim_su¥’d
 },

6014 { 
CMD_FORCE_ROAMING_BSSID
, 
¦si_fÜû_rßmšg_bssid
 },

6015 { 
CMD_ROAMING_BLACKLIST_ADD
, 
¦si_rßmšg_bÏckli¡_add
 },

6016 { 
CMD_ROAMING_BLACKLIST_REMOVE
, 
¦si_rßmšg_bÏckli¡_»move
 }

6019 
	$¦si_ioùl_â_lookup
(*
commªd
, 
Ën
)

6021 
i
 = 0;

6022 cÚ¡ 
¦si_ioùl_â
 *
p
 = 
NULL
;

6024 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_ioùl_â_bË
); i++) {

6025 
p
 = &
¦si_ioùl_â_bË
[
i
];

6026 ià(
p
->
Çme
) {

6027 ià(
	`¡¾’
(
p
->
Çme
è< 
Ën
) {

6028 ià(!
	`¡ºÿ£cmp
(
commªd
, 
p
->
Çme
, 
Ën
))

6029  
i
;

6031 ià(!
	`¡ºÿ£cmp
(
commªd
, 
p
->
Çme
, 
	`¡¾’
(p->name)))

6032  
i
;

6037 
	}
}

6039 
	$¦si_do_ioùl
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

6041 
»t
 = 0;

6042 
šdex
;

6043 
Ën
 = 0;

6044 *
pos
 = 
commªd
;

6046 
pos
 = 
	`¡rchr
(pos, ' ');

6047 ià(!
pos
) {

6048 
pos
 = 
commªd
;

6049 
pos
 = 
	`¡rchr
(pos, '\0');

6050 ià(!
pos
)

6051  -
ENOTSUPP
;

6054 
Ën
 = 
pos
 - 
commªd
;

6055 
šdex
 = 
	`¦si_ioùl_â_lookup
(
commªd
, 
Ën
);

6057 ià(
šdex
 < 0)

6058  -
ENOTSUPP
;

6060 ià(
¦si_ioùl_â_bË
[
šdex
].
â
)

6061 
»t
 = 
¦si_ioùl_â_bË
[
šdex
].
	`â
(
dev
, 
commªd
, 
cmd_Ën
);

6063 
»t
 = -
ENOTSUPP
;

6065  
»t
;

6066 
	}
}

6068 
	$¦si_ioùl
(
Ãt_deviû
 *
dev
, 
iäeq
 *
rq
, 
cmd
)

6070 
	#MAX_LEN_PRIV_COMMAND
 4096

	)

6071 
ªdroid_wifi_´iv_cmd
 
´iv_cmd
;

6072 
»t
 = 0;

6073 
u8
 *
commªd
 = 
NULL
;

6075 ià(!
dev
) {

6076 
»t
 = -
ENODEV
;

6077 
ex™
;

6080 ià(!
rq
->
iä_d©a
) {

6081 
»t
 = -
EINVAL
;

6082 
ex™
;

6084 ià(
	`cİy_äom_u£r
((*)&
´iv_cmd
, (*)
rq
->
iä_d©a
, (
ªdroid_wifi_´iv_cmd
))) {

6085 
»t
 = -
EFAULT
;

6086 
	`SLSI_NET_ERR
(
dev
, "ifr data failed\n");

6087 
ex™
;

6090 ià(
´iv_cmd
.
tÙ®_Ën
 > 
MAX_LEN_PRIV_COMMAND
 ||…riv_cmd.total_len < 0) {

6091 
»t
 = -
EINVAL
;

6092 
	`SLSI_NET_ERR
(
dev
, "L’gth mism©chÙ®_ËÀğ%d\n", 
´iv_cmd
.
tÙ®_Ën
);

6093 
ex™
;

6095 
commªd
 = 
	`km®loc
((
´iv_cmd
.
tÙ®_Ën
 + 1), 
GFP_KERNEL
);

6096 ià(!
commªd
) {

6097 
»t
 = -
ENOMEM
;

6098 
	`SLSI_NET_ERR
(
dev
, "No memory\n");

6099 
ex™
;

6101 ià(
	`cİy_äom_u£r
(
commªd
, 
´iv_cmd
.
buf
,…riv_cmd.
tÙ®_Ën
)) {

6102 
»t
 = -
EFAULT
;

6103 
	`SLSI_NET_ERR
(
dev
, "Buffer copy fail\n");

6104 
ex™
;

6106 
commªd
[
´iv_cmd
.
tÙ®_Ën
] = '\0';

6108 ià(
	`¡ºÿ£cmp
(
commªd
, 
CMD_SET_PMK
, 
	`¡¾’
(CMD_SET_PMK)) == 0)

6109 
	`SLSI_INFO_NODEV
("command: SET_PMK\n");

6111 
	`SLSI_INFO_NODEV
("commªd: %.*s\n", 
´iv_cmd
.
tÙ®_Ën
, 
commªd
);

6113 
»t
 = 
	`¦si_do_ioùl
(
dev
, 
commªd
, 
´iv_cmd
.
tÙ®_Ën
);

6115 ià(
	`¡ºÿ£cmp
(
commªd
, 
CMD_SETROAMBAND
, 
	`¡¾’
(CMD_SETROAMBAND)è!ğ0 && sŒnÿ£cmp(commªd, 
CMD_FACTORY_SETBAND
, sŒËn(CMD_FACTORY_SETBAND)è!ğ0 && sŒnÿ£cmp(commªd, 
CMD_SETBAND
, sŒËn(CMD_SETBAND)è!ğ0 && 
	`cİy_to_u£r
(
´iv_cmd
.
buf
, commªd,…riv_cmd.
tÙ®_Ën
)) {

6116 
»t
 = -
EFAULT
;

6117 
	`SLSI_NET_ERR
(
dev
, "Buffer copy fail\n");

6120 
ex™
:

6121 
	`kä“
(
commªd
);

6122  
»t
;

6123 
	}
}

	@ioctl.h

7 #iâdeà
__MX_IOCTL_H__


8 
	#__MX_IOCTL_H__


	)

10 
	~<lšux/if.h
>

11 
	~<lšux/Ãtdeviû.h
>

12 
	~"log2us.h
"

14 
	sªdroid_wifi_´iv_cmd
 {

15 *
	mbuf
;

16 
	mu£d_Ën
;

17 
	mtÙ®_Ën
;

20 
¦si_ioùl
(
Ãt_deviû
 *
dev
, 
iäeq
 *
rq
, 
cmd
);

21 
¦si_g‘_¡a_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

22 
¦si_ioùl_¬gs
 *
¦si_g‘_´iv©e_commªd_¬gs
(*
bufãr
, 
buf_Ën
, 
max_¬g_couÁ
);

23 
	#SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
) \

25 ià(!
ioùl_¬gs
) { \

26 
	`SLSI_ERR
(
sdev
, "Malloc of ioctl_args failed.\n"); \

27  -
ENOMEM
; \

30 ià(!
ioùl_¬gs
->
¬g_couÁ
) { \

31 
	`kä“
(
ioùl_¬gs
); \

32  -
EINVAL
; \

34 } 0)

	)

36 
	s¦si_suµÜ‹d_chªÃls
 {

37 
	m¡¬t_chª_num
;

38 
	mchªÃl_couÁ
;

39 
	mšüem’t
;

40 
	mbªd
;

	@kic.c

7 
	~<scsc/kic/¦si_kic_wifi.h
>

8 
	~"dev.h
"

9 
	~"debug.h
"

10 
	~"mxmª.h
"

12 
	$wifi_kic_Œigg”_»cov”y
(*
´iv
, 
¦si_kic_‹¡_»cov”y_ty³
 
ty³
)

14 
¦si_dev
 *
sdev
 = (¦si_dev *)
´iv
;

15 
»asÚ
[80];

17 ià(!
sdev
)

18  -
EINVAL
;

20 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
)

21  -
EAGAIN
;

23 
ty³
) {

24 
¦si_kic_‹¡_»cov”y_ty³_subsy¡em_·nic
:

25 
	`SLSI_INFO
(
sdev
, "Trigger Wi-Fi firmware subsystem…anic\n");

26 ià(
	`scsc_£rviû_fÜû_·nic
(
sdev
->
£rviû
))

27  -
EINVAL
;

29 
¦si_kic_‹¡_»cov”y_ty³_emuÏ‹_fœmw¬e_no_»¥Ú£
:

30 
	`SLSI_INFO
(
sdev
, "Trigger Wi-Fi host…anic\n");

31 
	`¢´štf
(
»asÚ
, (reason), "slsi_kic_test_recovery_type_emulate_firmware_no_response");

32 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
çl£
);

34 
¦si_kic_‹¡_»cov”y_ty³_w©ch_dog
:

35 
¦si_kic_‹¡_»cov”y_ty³_ch_üash
:

37  -
EINVAL
;

39 
	}
}

41 
¦si_kic_wifi_İs
 
	gkic_İs
 = {

42 .
Œigg”_»cov”y
 = 
wifi_kic_Œigg”_»cov”y
,

45 
	$wifi_kic_»gi¡”
(
¦si_dev
 *
sdev
)

47  
	`¦si_kic_wifi_İs_»gi¡”
((*)
sdev
, &
kic_İs
);

48 
	}
}

50 
	$wifi_kic_uÄegi¡”
()

52  
	`¦si_kic_wifi_İs_uÄegi¡”
(&
kic_İs
);

53 
	}
}

	@kic.h

7 #iâdeà
__KIC_H


8 
	#__KIC_H


	)

10 
wifi_kic_»gi¡”
(
¦si_dev
 *
sdev
);

11 
wifi_kic_uÄegi¡”
();

	@log2us.c

7 
	~<lšux/time.h
>

8 
	~<lšux/ktime.h
>

10 
	~"log2us.h
"

11 
	~"dev.h
"

12 
	~"debug.h
"

13 
	~"mgt.h
"

14 
	~"Æ80211_v’dÜ.h
"

15 
	~"mib.h
"

16 
	~"mlme.h
"

18 
	#MACSTR_NOMASK
 "%02x:%02x:%02x:%02x:%02x:%02x"

	)

19 
	#MAC2STR_LOG
(
a
è×)[0], (a)[1], (a)[2], (a)[3], (a)[4], (a)[5]

	)

21 #ifdeà
CONFIG_SCSC_WLAN_LOG_2_USER_SP


22 
	e¦si_wÏn_v’dÜ_©Œ_cÚn_log_ev’t
 {

23 
	mSLSI_WLAN_VENDOR_ATTR_CONN_LOG_EVENT
 = 1,

24 
	mSLSI_WLAN_VENDOR_ATTR_CONN_LOG_BUFF_COUNT
,

25 
	mSLSI_WLAN_VENDOR_ATTR_CONN_LOG_EVENT_MAX


29 
	$d–‘e_node
(
¦si_dev
 *
sdev
)

31 
buff_li¡
 *
cu¼
 = 
NULL
;

33 
cu¼
 = 
sdev
->
cÚn_log2us_ùx
.
li¡
;

34 ià(
cu¼
) {

35 
sdev
->
cÚn_log2us_ùx
.
li¡
 = sdev->cÚn_log2us_ùx.li¡->
Ãxt
;

36 
	`kä“
(
cu¼
);

38 
	}
}

40 
	$¦si_£nd_cÚn_log_ev’t
(
¦si_dev
 *
sdev
)

42 
sk_buff
 *
skb
;

43 
»s
;

44 
u32
 
buf_couÁ
 = 0;

45 
buff_li¡
 *
cu¼
;

46 
Æ©Œ
 *
Æa
 = 
NULL
;

47 
u32
 *
couÁ_p
;

49 !(
	`__¿‹lim™
(&
sdev
->
cÚn_log2us_ùx
.
rs
)))

50 
	`m¦“p
(50);

52 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

53 
SLSI_NL80211_VENDOR_CONNECTIVITY_LOG_EVENT
,

54 
GFP_KERNEL
);

55 ià(!
skb
) {

56 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for vendor conn_log_eventƒvent\n");

57  -
ENOMEM
;

60 
Æa
 = 
	`Æa_»£rve
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_CONN_LOG_BUFF_COUNT
, (
buf_couÁ
));

61 ià(!
Æa
) {

62 
	`SLSI_ERR_NODEV
("failed in‚la_reserve\n");

63 
	`kä“_skb
(
skb
);

67 
couÁ_p
 = 
	`Æa_d©a
(
Æa
);

69 
	`¥š_lock
(&
sdev
->
cÚn_log2us_ùx
.
cÚn_lock
);

70 
cu¼
 = 
sdev
->
cÚn_log2us_ùx
.
li¡
;

72 
cu¼
 && (
buf_couÁ
 < 100)) {

73 
»s
 = 
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_CONN_LOG_EVENT
, 
cu¼
->
Ën
,

74 
cu¼
->
¡r
);

75 ià(
»s
) {

76 
	`SLSI_ERR_NODEV
("failed in‚la_put for buffer‚o = %d,„es = %d\n",

77 
buf_couÁ
 + 1, 
»s
);

81 
buf_couÁ
++;

82 
	`d–‘e_node
(
sdev
);

83 
cu¼
 = 
sdev
->
cÚn_log2us_ùx
.
li¡
;

86 
	`¥š_uÆock
(&
sdev
->
cÚn_log2us_ùx
.
cÚn_lock
);

87 ià(
buf_couÁ
 == 0) {

88 
	`SLSI_ERR_NODEV
("Buffer count is 0\n");

89 
	`kä“_skb
(
skb
);

93 *
couÁ_p
 = 
buf_couÁ
;

94 
	`¹Æ_lock
();

95 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

96 
	`¹Æ_uÆock
();

99 
	}
}

101 
	$’queue_log_bufãr_fÜ_rßm_ÿnd
(
buff_li¡
 *
Ãw_node
, 
cÚn_log2us
 *
ùx
)

103 
buff_li¡
 *
li¡
;

105 
li¡
 = 
ùx
->
li¡_rßm_ÿnd
;

107 ià(!
li¡
) {

108 
ùx
->
li¡_rßm_ÿnd
 = 
Ãw_node
;

111 
li¡
->
Ãxt
 !ğ
NULL
)

112 
li¡
 =†i¡->
Ãxt
;

114 
li¡
->
Ãxt
 = 
Ãw_node
;

115 
	}
}

117 
	$’queue_log_bufãr
(
buff_li¡
 *
Ãw_node
, 
cÚn_log2us
 *
ùx
)

119 
buff_li¡
 *
li¡
;

121 
	`¥š_lock
(&
ùx
->
cÚn_lock
);

122 
li¡
 = 
ùx
->list;

124 ià(!
li¡
) {

125 
ùx
->
li¡
 = 
Ãw_node
;

126 
	`¥š_uÆock
(&
ùx
->
cÚn_lock
);

129 
li¡
->
Ãxt
 !ğ
NULL
)

130 
li¡
 =†i¡->
Ãxt
;

132 
li¡
->
Ãxt
 = 
Ãw_node
;

134 
	`¥š_uÆock
(&
ùx
->
cÚn_lock
);

135 
	}
}

137 
	$cÚn_log_wÜk”
(
wÜk_¡ruù
 *
wÜk
)

139 
cÚn_log2us
 *
p
 = 
	`cÚš”_of
(
wÜk
, cÚn_log2us, 
log2us_wÜk
);

140 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
p
, ¦si_dev, 
cÚn_log2us_ùx
);

141 
¡©us
 = 0;

143 
p
->
li¡
 && (!Õ->
¡İ
))) {

144 
¡©us
 = 
	`¦si_£nd_cÚn_log_ev’t
(
sdev
);

145 ià(
¡©us
)

146 
	`SLSI_ERR_NODEV
("¦si_£nd_cÚn_log_ev’ˆçed stu ğ%d\n", 
¡©us
);

148 
	}
}

150 
	$¦si_cÚn_log2us_š™
(
¦si_dev
 *
sdev
)

152 
	`¥š_lock_š™
(&
sdev
->
cÚn_log2us_ùx
.
cÚn_lock
);

154 
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
 = 
	`ü—‹_wÜkqueue
("conn_logger");

156 
	`INIT_WORK
(&
sdev
->
cÚn_log2us_ùx
.
log2us_wÜk
, 
cÚn_log_wÜk”
);

158 
sdev
->
cÚn_log2us_ùx
.
li¡
 = 
NULL
;

159 
sdev
->
cÚn_log2us_ùx
.
li¡_rßm_ÿnd
 = 
NULL
;

160 
	`¿‹lim™_¡©e_š™
(&
sdev
->
cÚn_log2us_ùx
.
rs
, 1 * 
HZ
, 
SLSI_LOG2US_BURST
);

161 
sdev
->
cÚn_log2us_ùx
.
¡İ
 = 
çl£
;

162 
	}
}

164 
	$¦si_cÚn_log2us_deš™
(
¦si_dev
 *
sdev
)

166 
buff_li¡
 *
tmp
;

168 
sdev
->
cÚn_log2us_ùx
.
¡İ
 = 
Œue
;

169 
	`ÿnûl_wÜk_sync
(&
sdev
->
cÚn_log2us_ùx
.
log2us_wÜk
);

170 
	`de¡roy_wÜkqueue
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
);

171 
	`¥š_lock
(&
sdev
->
cÚn_log2us_ùx
.
cÚn_lock
);

172 
sdev
->
cÚn_log2us_ùx
.
li¡
) {

173 
tmp
 = 
sdev
->
cÚn_log2us_ùx
.
li¡
;

174 
sdev
->
cÚn_log2us_ùx
.
li¡
 = sdev->cÚn_log2us_ùx.li¡->
Ãxt
;

175 
	`kä“
(
tmp
);

177 
sdev
->
cÚn_log2us_ùx
.
li¡_rßm_ÿnd
) {

178 
tmp
 = 
sdev
->
cÚn_log2us_ùx
.
li¡_rßm_ÿnd
;

179 
sdev
->
cÚn_log2us_ùx
.
li¡_rßm_ÿnd
 = sdev->cÚn_log2us_ùx.li¡_rßm_ÿnd->
Ãxt
;

180 
	`kä“
(
tmp
);

182 
	`¥š_uÆock
(&
sdev
->
cÚn_log2us_ùx
.
cÚn_lock
);

183 
	}
}

185 
u8
 *
	$g‘_—p_ty³_äom_v®
(
v®
, 
u8
 *
¡r
)

187 
v®
) {

188 
SLSI_EAP_TYPE_IDENTITY
:

189 
	`memıy
(
¡r
, "IDENTITY", 
	`¡¾’
("IDENTITY") + 1);

190  
¡r
;

191 
SLSI_EAP_TYPE_NOTIFICATION
:

192 
	`memıy
(
¡r
, "NOTIFICATION", 
	`¡¾’
("NOTIFICATION") + 1);

193  
¡r
;

194 
SLSI_EAP_TYPE_NAK
:

195 
	`memıy
(
¡r
, "NAK", 
	`¡¾’
("NAK") + 1);

196  
¡r
;

197 
SLSI_EAP_TYPE_MD5
:

198 
	`memıy
(
¡r
, "MD5", 
	`¡¾’
("MD5") + 1);

199  
¡r
;

200 
SLSI_EAP_TYPE_OTP
:

201 
	`memıy
(
¡r
, "OTP", 
	`¡¾’
("OTP") + 1);

202  
¡r
;

203 
SLSI_EAP_TYPE_GTC
:

204 
	`memıy
(
¡r
, "GTC", 
	`¡¾’
("GTC") + 1);

205  
¡r
;

206 
SLSI_EAP_TYPE_TLS
:

207 
	`memıy
(
¡r
, "TLS", 
	`¡¾’
("TLS") + 1);

208  
¡r
;

209 
SLSI_EAP_TYPE_LEAP
:

210 
	`memıy
(
¡r
, "LEAP", 
	`¡¾’
("LEAP") + 1);

211  
¡r
;

212 
SLSI_EAP_TYPE_SIM
:

213 
	`memıy
(
¡r
, "SIM", 
	`¡¾’
("SIM") + 1);

214  
¡r
;

215 
SLSI_EAP_TYPE_TTLS
:

216 
	`memıy
(
¡r
, "TTLS", 
	`¡¾’
("TTLS") + 1);

217  
¡r
;

218 
SLSI_EAP_TYPE_AKA
:

219 
	`memıy
(
¡r
, "AKA", 
	`¡¾’
("AKA") + 1);

220  
¡r
;

221 
SLSI_EAP_TYPE_PEAP
:

222 
	`memıy
(
¡r
, "PEAP", 
	`¡¾’
("PEAP") + 1);

223  
¡r
;

224 
SLSI_EAP_TYPE_MSCHAPV2
:

225 
	`memıy
(
¡r
, "MSCHAPV2", 
	`¡¾’
("MSCHAPV2") + 1);

226  
¡r
;

227 
SLSI_EAP_TYPE_TLV
:

228 
	`memıy
(
¡r
, "TLV", 
	`¡¾’
("TLV") + 1);

229  
¡r
;

230 
SLSI_EAP_TYPE_TNC
:

231 
	`memıy
(
¡r
, "TNC", 
	`¡¾’
("TNC") + 1);

232  
¡r
;

233 
SLSI_EAP_TYPE_FAST
:

234 
	`memıy
(
¡r
, "FAST", 
	`¡¾’
("FAST") + 1);

235  
¡r
;

236 
SLSI_EAP_TYPE_PAX
:

237 
	`memıy
(
¡r
, "PAX", 
	`¡¾’
("PAX") + 1);

238  
¡r
;

239 
SLSI_EAP_TYPE_PSK
:

240 
	`memıy
(
¡r
, "PSK", 
	`¡¾’
("PSK") + 1);

241  
¡r
;

242 
SLSI_EAP_TYPE_SAKE
:

243 
	`memıy
(
¡r
, "SAKE", 
	`¡¾’
("SAKE") + 1);

244  
¡r
;

245 
SLSI_EAP_TYPE_IKEV2
:

246 
	`memıy
(
¡r
, "IKEV2", 
	`¡¾’
("IKEV2") + 1);

247  
¡r
;

248 
SLSI_EAP_TYPE_AKA_PRIME
:

249 
	`memıy
(
¡r
, "AKA PRIME", 
	`¡¾’
("AKA PRIME") + 1);

250  
¡r
;

251 
SLSI_EAP_TYPE_GPSK
:

252 
	`memıy
(
¡r
, "GPSK", 
	`¡¾’
("GPSK") + 1);

253  
¡r
;

254 
SLSI_EAP_TYPE_PWD
:

255 
	`memıy
(
¡r
, "PWD", 
	`¡¾’
("PWD") + 1);

256  
¡r
;

257 
SLSI_EAP_TYPE_EKE
:

258 
	`memıy
(
¡r
, "EKE", 
	`¡¾’
("EKE") + 1);

259  
¡r
;

260 
SLSI_EAP_TYPE_EXPANDED
:

261 
	`memıy
(
¡r
, "EXPANDED", 
	`¡¾’
("EXPANDED") + 1);

262  
¡r
;

264 
	`memıy
(
¡r
, "UNKNOWN", 
	`¡¾’
("UNKNOWN") + 1);

265  
¡r
;

267 
	}
}

269 
	$¦si_g‘_rßm_»asÚ_fÜ_fw_»asÚ
(
rßm_»asÚ
)

271 
rßm_»asÚ
) {

272 
SLSI_WIFI_ROAMING_SEARCH_REASON_LOW_RSSI
:

274 
SLSI_WIFI_ROAMING_SEARCH_REASON_LINK_LOSS
:

276 
SLSI_WIFI_ROAMING_SEARCH_REASON_BTM_REQ
:

278 
SLSI_WIFI_ROAMING_SEARCH_REASON_CU_TRIGGER
:

280 
SLSI_WIFI_ROAMING_SEARCH_REASON_EMERGENCY
:

282 
SLSI_WIFI_ROAMING_SEARCH_REASON_IDLE
:

284 
SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER1_EXPIRY
:

286 
SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER2_EXPIRY
:

288 
SLSI_WIFI_ROAMING_SEARCH_REASON_INACTIVE_TIMER_EXPIRY
:

293 
	}
}

295 
	$¦si_—pŞ_—p_hªdË_tx_¡©us
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

296 
u16
 
ho¡_g
, u16 
tx_¡©us
)

298 *
tx_¡©us_¡r
;

300 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

303 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
)

304 
tx_¡©us_¡r
 = "ACK";

305 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
)

306 
tx_¡©us_¡r
 = "NO_ACK";

308 
tx_¡©us_¡r
 = "TX_FAIL";

310 ià(
ho¡_g
 =ğ
sdev
->
cÚn_log2us_ùx
.
ho¡_g_—p
) {

311 
	`¦si_cÚn_log2us_—p_tx
(
sdev
, 
ndev_vif
, sdev->
cÚn_log2us_ùx
.
—p_»¥_Ën
,

312 
sdev
->
cÚn_log2us_ùx
.
—p_¡r_ty³
, 
tx_¡©us_¡r
);

313 
sdev
->
cÚn_log2us_ùx
.
ho¡_g_—p
 = 0;

315 
	}
}

317 
	$¦si_log2us_g‘_rssi
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

318 *
mib_v®ue
, 
u16
 
psid
)

320 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

321 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

322 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
psid
, { 0, 0 } } };

324 
mibr¥
.
d©aL’gth
 = 64;

325 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

326 ià(!
mibr¥
.
d©a
) {

327 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

328 
	`kä“
(
mibr¥
.
d©a
);

329  -
ENOMEM
;

332 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 1, &
mibr¥
);

333 ià(!
v®ues
) {

334 
	`kä“
(
mibr¥
.
d©a
);

335  -
EINVAL
;

338 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_INT
)

339 *
mib_v®ue
 = ()(
v®ues
->
u
.
štV®ue
);

340 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

341 *
mib_v®ue
 = ()(
v®ues
->
u
.
uštV®ue
);

343 
	`SLSI_ERR
(
sdev
, "Invalidype (%d) for SLSI_PSID_UNIFI_LAST_BSS_RSSI\n",

344 
v®ues
[0].
ty³
);

345 
	`kä“
(
v®ues
);

346 
	`kä“
(
mibr¥
.
d©a
);

348 
	}
}

350 
buff_li¡
 *
	$¦si_cÚn_log2us_®loc_Ãw_node
()

353 
buff_li¡
 *
Ãw_node
;

355 
Ãw_node
 = 
	`km®loc
((
buff_li¡
), 
GFP_KERNEL
);

356 ià(!
Ãw_node
) {

357 
	`SLSI_ERR_NODEV
("Memory is‚ot‡vailable\n");

358  
NULL
;

360 
Ãw_node
->
Ãxt
 = 
NULL
;

361  
Ãw_node
;

362 
	}
}

364 
buff_li¡
 *
	$¦si_cÚn_log2us_®loc_©omic_Ãw_node
()

366 
buff_li¡
 *
Ãw_node
;

368 
Ãw_node
 = 
	`km®loc
((*Ãw_node), 
GFP_ATOMIC
);

369 ià(!
Ãw_node
) {

370 
	`SLSI_ERR_NODEV
("Memory is‚ot‡vailable\n");

371  
NULL
;

373 
Ãw_node
->
Ãxt
 = 
NULL
;

374  
Ãw_node
;

375 
	}
}

377 
	$¦si_cÚn_log2us_cÚÃùšg
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

379 
pos
 = 0;

380 *
log_bufãr
 = 
NULL
;

381 
buf_size
 = 
BUFF_SIZE
;

382 
u32
 
time
[2] = { 0 };

383 
buff_li¡
 *
Ãw_node
 = 
NULL
;

384 
btcÛx
 = 0;

385 cÚ¡ 
u8
 *
r¢
;

386 
r¢_pos
 = 0;

387 
u8
 
pmf
 = 0;

388 
u32
 
group_mgmt
 = 0;

389 
r¢_Ën
 = 0;

390 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

391 
·œwi£
 = 0, 
group
 = 0, 
äeq
 = 0, 
äeq_hšt
 = 0, 
akm_su™e
 = 0;

393 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

396 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

397 ià(!
Ãw_node
)

400 
log_bufãr
 = 
Ãw_node
->
¡r
;

401 
	`g‘_k”Ãl_time¡amp
(
time
);

402 ià(
sdev
->
cÚn_log2us_ùx
.
btcÛx_sco
 || sdev->cÚn_log2us_ùx.
btcÛx_sÿn
 ||

403 
sdev
->
cÚn_log2us_ùx
.
btcÛx_hid
)

404 
btcÛx
 = 1;

406 
r¢
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
sme
->
›
, sme->
›_Ën
);

408 ià(
r¢
) {

411 ià((
sme
->
›_Ën
 - (
r¢
 - sme->
›
)) >= 10)

412 
r¢_pos
 = 7 + 2 + (
r¢
[8] * 4);

414 ià((
sme
->
›_Ën
 - (
r¢
 - sme->
›
)) >=„sn[1] + 2) {

415 
r¢_pos
 =„¢_po + 2 + (
r¢
[rsn_pos] * 4);

416 
r¢_Ën
 = 
r¢
[1];

419 ià((
r¢_pos
 + 2è<ğ
r¢_Ën
)

420 
pmf
 =…mà| (
r¢
[
r¢_pos
] << 7) | (rsn[rsn_pos] << 6);

422 ià(
pmf
) {

423 
r¢_pos
 =„sn_pos + 2;

424 
r¢_pos
 = 2 + (
r¢
[rsn_pos] * 16);

425 ià((
r¢_pos
 + 4è<ğ
r¢_Ën
)

426 
	`memıy
(&
group_mgmt
, (
r¢
 + 
r¢_pos
), 4);

430 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d][CONN] CONNECTING ssid=\"%.*s\"",

431 
time
[0],ime[1], ()
sme
->
ssid_Ën
, sme->
ssid
);

432 ià(
sme
->
bssid
)

433 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " bssid=" 
MACSTR_NOMASK
,

434 
	`MAC2STR_LOG
(
sme
->
bssid
));

435 ià(
sme
->
bssid_hšt
)

436 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " bssid_hšt=" 
MACSTR_NOMASK
,

437 
	`MAC2STR_LOG
(
sme
->
bssid_hšt
));

438 
äeq
 = 
sme
->
chªÃl
 ? sme->chªÃl->
ûÁ”_äeq
 : 0;

439 ià(
äeq
)

440 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " f»q=%d", 
äeq
);

441 
äeq_hšt
 = 
sme
->
chªÃl_hšt
 ? sme->chªÃl_hšt->
ûÁ”_äeq
 : 0;

442 ià(
äeq_hšt
)

443 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " f»q_hšt=%d", 
äeq_hšt
);

445 ià(
sme
->
üy±o
.
n_ch”s_·œwi£
)

446 
·œwi£
 = 
sme
->
üy±o
.
ch”s_·œwi£
[0];

447 
group
 = 
sme
->
üy±o
.
ch”_group
;

448 ià(
sme
->
üy±o
.
n_akm_su™es
)

449 
akm_su™e
 = 
sme
->
üy±o
.
akm_su™es
[0];

451 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "…airwise=0x%x group=0x%x ",

452 
·œwi£
, 
group
);

453 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "akm=0x%x‡uth_type=%d ",

454 
akm_su™e
, (
sme
->
auth_ty³
 =ğ
NL80211_AUTHTYPE_SAE
è? 
FAPI_AUTHENTICATIONTYPE_SAE
 : sme->auth_type);

456 ià(
pmf
)

457 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "group_mgmt=0x%x btcÛx=%d", 
group_mgmt
, 
btcÛx
);

459 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "btcÛx=%d", 
btcÛx
);

461 
Ãw_node
->
Ën
 = 
pos
 + 1;

462 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

463 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

464 
	}
}

466 
	$¦si_cÚn_log2us_cÚÃùšg_ç
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

467 cÚ¡ *
bssid
,

468 
äeq
, 
»asÚ
)

470 
pos
 = 0;

471 *
log_bufãr
 = 
NULL
;

472 
buf_size
 = 
BUFF_SIZE
;

473 
u32
 
time
[2] = { 0 };

474 
buff_li¡
 *
Ãw_node
 = 
NULL
;

475 *
¡r
;

476 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

478 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

481 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

482 ià(!
Ãw_node
)

484 
log_bufãr
 = 
Ãw_node
->
¡r
;

486 
	`g‘_k”Ãl_time¡amp
(
time
);

487 ià(1 =ğ
»asÚ
)

488 
¡r
 = "no…robe„esponse";

490 
¡r
 = "unknown";

492 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d][CONN] CONNECTING FAIL", 
time
[0],ime[1]);

493 ià(
bssid
)

494 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " bssid=" 
MACSTR_NOMASK
, 
	`MAC2STR_LOG
(
bssid
));

495 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " f»q=%d [»asÚ=%d %s]", 
äeq
, 
»asÚ
, 
¡r
);

496 
Ãw_node
->
Ën
 = 
pos
 + 1;

497 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

498 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

499 
	}
}

501 
	$¦si_cÚn_log2us_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

502 cÚ¡ *
bssid
,

503 
»asÚ
)

506 
pos
 = 0;

507 *
log_bufãr
 = 
NULL
;

508 
buf_size
 = 
BUFF_SIZE
;

509 
u32
 
time
[2] = { 0 };

510 
buff_li¡
 *
Ãw_node
 = 
NULL
;

511 
rssi
 = 100;

512 
¡©us
;

513 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

515 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

518 
sdev
->
cÚn_log2us_ùx
.
cÚn_æag
 = 
çl£
;

519 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

520 ià(!
Ãw_node
)

522 
log_bufãr
 = 
Ãw_node
->
¡r
;

524 
	`g‘_k”Ãl_time¡amp
(
time
);

525 
¡©us
 = 
	`¦si_log2us_g‘_rssi
(
sdev
, 
dev
, &
rssi
, 
SLSI_PSID_UNIFI_LAST_BSS_RSSI
);

526 ià(
¡©us
)

527 
	`SLSI_ERR
(
sdev
, "Could‚Ù g‘„ss˜¡©u ğ%d\n", 
¡©us
);

529 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [CONN] DISCONN bssid="

530 
MACSTR_NOMASK
 "„ssi=%d "

531 "»asÚ=%d", 
time
[0],ime[1], 
	`MAC2STR_LOG
(
bssid
), 
rssi
, 
»asÚ
);

532 
Ãw_node
->
Ën
 = 
pos
 + 1;

533 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

534 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

536 
	}
}

538 
	$¦si_cÚn_log2us_—pŞ_gtk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

539 
—pŞ_msg_ty³
)

541 
pos
 = 0;

542 *
log_bufãr
 = 
NULL
;

543 
buf_size
 = 
BUFF_SIZE
;

544 
u32
 
time
[2] = { 0 };

545 
buff_li¡
 *
Ãw_node
 = 
NULL
;

546 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

548 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

551 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

552 ià(!
Ãw_node
)

554 
log_bufãr
 = 
Ãw_node
->
¡r
;

556 
	`g‘_k”Ãl_time¡amp
(
time
);

558 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [EAPOL] GTK M%d", 
time
[0],ime[1],

559 
—pŞ_msg_ty³
);

560 
Ãw_node
->
Ën
 = 
pos
 + 1;

561 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

562 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

563 
	}
}

565 
	$¦si_cÚn_log2us_—pŞ_gtk_tx
(
¦si_dev
 *
sdev
, 
u32
 
¡©us_code
)

567 
pos
 = 0;

568 *
log_bufãr
 = 
NULL
, *
tx_¡©us_¡r
 = NULL;

569 
buf_size
 = 
BUFF_SIZE
;

570 
u32
 
time
[2] = { 0 };

571 
buff_li¡
 *
Ãw_node
 = 
NULL
;

573 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

574 ià(!
Ãw_node
)

576 
log_bufãr
 = 
Ãw_node
->
¡r
;

578 
	`g‘_k”Ãl_time¡amp
(
time
);

580 ià(
¡©us_code
 =ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
)

581 
tx_¡©us_¡r
 = "ACK";

582 ià(
¡©us_code
 =ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
)

583 
tx_¡©us_¡r
 = "NO_ACK";

585 
tx_¡©us_¡r
 = "TX_FAIL";

587 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [EAPOL] GTK M2x_status=%s",

588 
time
[0],ime[1], 
tx_¡©us_¡r
);

589 
Ãw_node
->
Ën
 = 
pos
 + 1;

590 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

591 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

592 
	}
}

594 
	$¦si_cÚn_log2us_—pŞ_±k
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

595 
—pŞ_msg_ty³
)

597 
pos
 = 0;

598 *
log_bufãr
 = 
NULL
;

599 
buf_size
 = 
BUFF_SIZE
;

600 
u32
 
time
[2] = { 0 };

601 
buff_li¡
 *
Ãw_node
 = 
NULL
;

602 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

604 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

607 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

608 ià(!
Ãw_node
)

610 
log_bufãr
 = 
Ãw_node
->
¡r
;

612 
	`g‘_k”Ãl_time¡amp
(
time
);

614 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [EAPOL] 4WAY M%d", 
time
[0],ime[1],

615 
—pŞ_msg_ty³
);

616 
Ãw_node
->
Ën
 = 
pos
 + 1;

617 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

618 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

619 
	}
}

621 
	$¦si_cÚn_log2us_—pŞ_±k_tx
(
¦si_dev
 *
sdev
, 
u32
 
¡©us_code
)

623 
pos
 = 0;

624 *
log_bufãr
 = 
NULL
, *
tx_¡©us_¡r
 = NULL;

625 
buf_size
 = 
BUFF_SIZE
;

626 
u32
 
time
[2] = { 0 };

627 
buff_li¡
 *
Ãw_node
 = 
NULL
;

629 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

630 ià(!
Ãw_node
)

632 
log_bufãr
 = 
Ãw_node
->
¡r
;

634 
	`g‘_k”Ãl_time¡amp
(
time
);

635 ià(
¡©us_code
 =ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
)

636 
tx_¡©us_¡r
 = "ACK";

637 ià(
¡©us_code
 =ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
)

638 
tx_¡©us_¡r
 = "NO_ACK";

640 
tx_¡©us_¡r
 = "TX_FAIL";

642 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [EAPOL] 4WAY M%dx_status=%s",

643 
time
[0],ime[1], 
sdev
->
cÚn_log2us_ùx
.
—pŞ_±k_msg_ty³
, 
tx_¡©us_¡r
);

644 
Ãw_node
->
Ën
 = 
pos
 + 1;

645 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

646 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

647 
	}
}

649 
	$¦si_cÚn_log2us_—pŞ_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
¡©us_code
)

651 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

653 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

656 ià(
sdev
->
cÚn_log2us_ùx
.
is_—pŞ_±k
) {

657 
	`¦si_cÚn_log2us_—pŞ_±k_tx
(
sdev
, 
¡©us_code
);

658 
sdev
->
cÚn_log2us_ùx
.
is_—pŞ_±k
 = 
çl£
;

659 } ià(
sdev
->
cÚn_log2us_ùx
.
is_—pŞ_gtk
) {

660 
	`¦si_cÚn_log2us_—pŞ_gtk_tx
(
sdev
, 
¡©us_code
);

661 
sdev
->
cÚn_log2us_ùx
.
is_—pŞ_gtk
 = 
çl£
;

663 
	}
}

664 
	$¦si_cÚn_log2us_rßm_sÿn_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

665 
»asÚ
, 
rßm_rssi_v®
,

666 
chª_uti§tiÚ
,

667 
rssi_th»sh
, 
u64
 
time¡amp
)

669 
pos
 = 0;

670 *
log_bufãr
 = 
NULL
;

671 
buf_size
 = 
BUFF_SIZE
;

672 
u32
 
time
[2] = { 0 };

673 
buff_li¡
 *
Ãw_node
 = 
NULL
;

674 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

676 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

679 
sdev
->
cÚn_log2us_ùx
.
rßm_­_couÁ
 = 0;

680 
sdev
->
cÚn_log2us_ùx
.
ÿnd_numb”
 = 0;

681 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

682 ià(!
Ãw_node
)

684 
log_bufãr
 = 
Ãw_node
->
¡r
;

686 
	`g‘_k”Ãl_time¡amp
(
time
);

687 
»asÚ
 = 
	`¦si_g‘_rßm_»asÚ_fÜ_fw_»asÚ
(reason);

689 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [ROAM] SCAN_START„eason=%d ",

690 
time
[0],ime[1], 
»asÚ
);

691 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "rssi=%d cu=%d full_scan=%d„ssi_thres=%d [fw_time=%llu]",

692 
rßm_rssi_v®
, 
chª_uti§tiÚ
, 
sdev
->
cÚn_log2us_ùx
.
fuÎ_sÿn_rßm
, 
rssi_th»sh
, 
time¡amp
);

694 
Ãw_node
->
Ën
 = 
pos
 + 1;

695 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

696 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

697 
	}
}

699 
	$¦si_cÚn_log2us_rßm_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

700 *
bssid
, 
u64
 
time¡amp
, 
boŞ
 
rßm_ÿndid©e
)

702 
pos
 = 0;

703 *
log_bufãr
 = 
NULL
;

704 
buf_size
 = 
BUFF_SIZE
;

705 
u32
 
time
[2] = { 0 };

706 
buff_li¡
 *
Ãw_node
 = 
NULL
;

707 *
»s
 = 
NULL
;

708 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

710 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

713 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

714 ià(!
Ãw_node
)

716 
log_bufãr
 = 
Ãw_node
->
¡r
;

718 
	`g‘_k”Ãl_time¡amp
(
time
);

719 ià(
rßm_ÿndid©e
)

720 
»s
 = "ROAM";

722 
»s
 = "NO_ROAM";

723 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [ROAM] RESULT %s bssid="

724 
MACSTR_NOMASK
 "[fw_time=%llu status=%d]",

725 
time
[0],ime[1], 
»s
, 
	`MAC2STR_LOG
(
bssid
), 
time¡amp
, !
rßm_ÿndid©e
);

726 
Ãw_node
->
Ën
 = 
pos
 + 1;

727 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

728 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

729 
	}
}

731 
	$¦si_cÚn_log2us_—p_w™h_Ën
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

732 
u8
 *
—p
, 
—p_Ëngth
)

734 
pos
 = 0;

735 *
log_bufãr
 = 
NULL
;

736 
u32
 
time
[2] = { 0 };

737 *
—p_ty³
 = 
NULL
;

738 
buf_size
 = 
BUFF_SIZE
;

739 
¡r_ty³
[15] = { 0 };

740 
buff_li¡
 *
Ãw_node
 = 
NULL
;

741 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

743 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

746 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

747 ià(!
Ãw_node
)

749 
log_bufãr
 = 
Ãw_node
->
¡r
;

751 
	`g‘_k”Ãl_time¡amp
(
time
);

753 
—p
[
SLSI_EAP_CODE_POS
]) {

754 
SLSI_EAP_PACKET_REQUEST
:

755 
—p_ty³
 = "REQ";

759 
sdev
->
cÚn_log2us_ùx
.
—p_¡r_ty³
 = 
—p
[
SLSI_EAP_TYPE_POS
];

760 
	`g‘_—p_ty³_äom_v®
(
—p
[
SLSI_EAP_TYPE_POS
], 
¡r_ty³
);

761 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [EAP] %sype=%s†en=%d",

762 
time
[0],ime[1], 
—p_ty³
, 
¡r_ty³
, 
—p_Ëngth
);

763 
Ãw_node
->
Ën
 = 
pos
 + 1;

764 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

765 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

766 
	}
}

768 
	$¦si_cÚn_log2us_—p_tx
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

769 
—p_Ëngth
, 
—p_ty³
,

770 *
tx_¡©us_¡r
)

772 
pos
 = 0;

773 *
log_bufãr
 = 
NULL
;

774 
u32
 
time
[2] = { 0 };

775 
buf_size
 = 
BUFF_SIZE
;

776 
buff_li¡
 *
Ãw_node
 = 
NULL
;

777 
—p_ty³_¡r
[15] = {0};

779 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

782 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

783 ià(!
Ãw_node
)

785 
log_bufãr
 = 
Ãw_node
->
¡r
;

787 
	`g‘_k”Ãl_time¡amp
(
time
);

788 
	`g‘_—p_ty³_äom_v®
(
—p_ty³
, 
—p_ty³_¡r
);

790 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [EAP] RESPype=%s†en=%d",

791 
time
[0],ime[1], 
—p_ty³_¡r
, 
—p_Ëngth
);

792 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "x_¡©us=%s", 
tx_¡©us_¡r
);

794 
Ãw_node
->
Ën
 = 
pos
 + 1;

795 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

796 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

797 
	}
}

799 
	$¦si_cÚn_log2us_—p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
—p
)

801 
pos
 = 0;

802 *
log_bufãr
 = 
NULL
;

803 *
—p_ty³
 = 
NULL
;

804 
buf_size
 = 
BUFF_SIZE
;

805 
u32
 
time
[2] = { 0 };

806 
buff_li¡
 *
Ãw_node
 = 
NULL
;

807 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

809 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

812 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

813 ià(!
Ãw_node
)

815 
log_bufãr
 = 
Ãw_node
->
¡r
;

817 
	`g‘_k”Ãl_time¡amp
(
time
);

819 
—p
[
SLSI_EAP_CODE_POS
]) {

820 
SLSI_EAP_PACKET_SUCCESS
:

821 
—p_ty³
 = "SUCC";

823 
SLSI_EAP_PACKET_FAILURE
:

824 
—p_ty³
 = "FAIL";

828 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [EAP] %s",

829 
time
[0],ime[1], 
—p_ty³
);

830 
Ãw_node
->
Ën
 = 
pos
 + 1;

831 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

832 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

833 
	}
}

835 
	$¦si_cÚn_log2us_dhı
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r
)

837 
pos
 = 0;

838 *
log_bufãr
 = 
NULL
;

839 
buf_size
 = 
BUFF_SIZE
;

840 
u32
 
time
[2] = { 0 };

841 
buff_li¡
 *
Ãw_node
 = 
NULL
;

842 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

844 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

847 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

848 ià(!
Ãw_node
)

850 
log_bufãr
 = 
Ãw_node
->
¡r
;

852 
	`g‘_k”Ãl_time¡amp
(
time
);

853 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [DHCP] %s", 
time
[0],ime[1], 
¡r
);

854 
Ãw_node
->
Ën
 = 
pos
 + 1;

855 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

856 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

857 
	}
}

859 
	$¦si_cÚn_log2us_dhı_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

860 *
¡r
, *
tx_¡©us
)

862 
pos
 = 0;

863 *
log_bufãr
 = 
NULL
;

864 
buf_size
 = 
BUFF_SIZE
;

865 
u32
 
time
[2] = { 0 };

866 
buff_li¡
 *
Ãw_node
 = 
NULL
;

867 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

869 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

872 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_©omic_Ãw_node
();

873 ià(!
Ãw_node
)

875 
log_bufãr
 = 
Ãw_node
->
¡r
;

877 
	`g‘_k”Ãl_time¡amp
(
time
);

878 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [DHCP] %sx_status=%s",

879 
time
[0],ime[1], 
¡r
, 
tx_¡©us
);

880 
Ãw_node
->
Ën
 = 
pos
 + 1;

881 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

882 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

883 
	}
}

885 
	$¦si_cÚn_log2us_auth_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ *
bssid
,

886 
auth_®go
, 
§e_ty³
, 
¢
, 
¡©us
, 
u32
 
tx_¡©us
, 
is_rßmšg
)

888 
pos
 = 0;

889 *
log_bufãr
 = 
NULL
;

890 
buf_size
 = 
BUFF_SIZE
;

891 
u32
 
time
[2] = { 0 };

892 
buff_li¡
 *
Ãw_node
 = 
NULL
;

893 *
tx_¡©us_¡r
;

894 
rssi
 = 100;

895 
»s
;

896 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

898 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

901 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

902 ià(!
Ãw_node
)

904 
log_bufãr
 = 
Ãw_node
->
¡r
;

906 ià(
tx_¡©us
 =ğ
FAPI_RESULTCODE_AUTH_TX_FAIL
)

907 
tx_¡©us_¡r
 = "TX_FAIL";

908 ià(
tx_¡©us
 =ğ
FAPI_RESULTCODE_AUTH_NO_ACK
)

909 
tx_¡©us_¡r
 = "NO_ACK";

911 
tx_¡©us_¡r
 = "ACK";

912 
	`g‘_k”Ãl_time¡amp
(
time
);

913 
»s
 = 
	`¦si_log2us_g‘_rssi
(
sdev
, 
dev
, &
rssi
, 
SLSI_PSID_UNIFI_RSSI
);

914 ià(
»s
)

915 
	`SLSI_ERR
(
sdev
, "Could‚Ù g‘„ss˜¡©u ğ%d\n", 
»s
);

917 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d][CONN] AUTH REQ bssid=" 
MACSTR_NOMASK
,

918 
time
[0],ime[1], 
	`MAC2STR_LOG
(
bssid
));

919 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "„ssi=%d‡uth_algo=%dype=%d sn=%d status=%d",

920 
rssi
, 
auth_®go
, 
§e_ty³
, 
¢
, 
¡©us
);

921 ià(
is_rßmšg
)

922 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "x_¡©us=% [ROAM]", 
tx_¡©us_¡r
);

924 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "x_¡©us=%s", 
tx_¡©us_¡r
);

926 
Ãw_node
->
Ën
 = 
pos
 + 1;

927 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

928 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

929 
	}
}

931 
	$¦si_cÚn_log2us_auth_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

932 cÚ¡ *
bssid
, 
auth_®go
,

933 
§e_ty³
,

934 
¢
, 
¡©us
, 
is_rßmšg
)

936 
pos
 = 0;

937 *
log_bufãr
 = 
NULL
;

938 
buf_size
 = 
BUFF_SIZE
;

939 
u32
 
time
[2] = { 0 };

940 
buff_li¡
 *
Ãw_node
 = 
NULL
;

941 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

943 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

946 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

947 ià(!
Ãw_node
)

949 
log_bufãr
 = 
Ãw_node
->
¡r
;

951 
	`g‘_k”Ãl_time¡amp
(
time
);

952 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d][CONN] AUTH RESP",

953 
time
[0],ime[1]);

954 ià(
is_rßmšg
)

955 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " bssid="

956 
MACSTR_NOMASK
 "‡uth_algo=%d "

957 "ty³=%d sn=%d stus=%d [ROAM]", 
	`MAC2STR_LOG
(
bssid
),

958 
auth_®go
, 
§e_ty³
, 
¢
, 
¡©us
);

960 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " bssid="

961 
MACSTR_NOMASK
 "‡uth_algo=%d "

962 "ty³=%d sn=%d stus=%d", 
	`MAC2STR_LOG
(
bssid
),

963 
auth_®go
, 
§e_ty³
, 
¢
, 
¡©us
);

964 
Ãw_node
->
Ën
 = 
pos
 + 1;

965 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

966 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

967 
	}
}

969 
	$¦si_cÚn_log2us_assoc_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

970 cÚ¡ *
bssid
, 
¢
, 
tx_¡©us
,

971 
mgmt_äame_subty³
)

973 
pos
 = 0;

974 *
log_bufãr
 = 
NULL
;

975 
buf_size
 = 
BUFF_SIZE
;

976 
u32
 
time
[2] = { 0 };

977 
buff_li¡
 *
Ãw_node
 = 
NULL
;

978 *
tx_¡©us_¡r
;

979 
rssi
 = 100;

980 
¡©us
;

981 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

983 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

986 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

987 ià(!
Ãw_node
)

989 
log_bufãr
 = 
Ãw_node
->
¡r
;

991 
	`g‘_k”Ãl_time¡amp
(
time
);

992 ià(
tx_¡©us
 =ğ
FAPI_RESULTCODE_ASSOC_TX_FAIL
)

993 
tx_¡©us_¡r
 = "TX_FAIL";

994 ià(
tx_¡©us
 =ğ
FAPI_RESULTCODE_ASSOC_NO_ACK
)

995 
tx_¡©us_¡r
 = "NO_ACK";

997 
tx_¡©us_¡r
 = "ACK";

998 
¡©us
 = 
	`¦si_log2us_g‘_rssi
(
sdev
, 
dev
, &
rssi
, 
SLSI_PSID_UNIFI_RSSI
);

999 ià(
¡©us
)

1000 
	`SLSI_ERR
(
sdev
, "Could‚Ù g‘„ss˜¡©u ğ%d\n", 
¡©us
);

1001 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_ASSOC_REQ
)

1002 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [CONN] ASSOC REQ ", 
time
[0],ime[1]);

1003 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_REASSOC_REQ
)

1004 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [CONN] REASSOC REQ ", 
time
[0],ime[1]);

1005 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "bssid="

1006 
MACSTR_NOMASK
 "„ssi=%d sn=%d "

1007 "tx_¡©us=%s", 
	`MAC2STR_LOG
(
bssid
), 
rssi
, 
¢
,

1008 
tx_¡©us_¡r
);

1009 
Ãw_node
->
Ën
 = 
pos
 + 1;

1010 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1011 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1012 
	}
}

1014 
	$¦si_cÚn_log2us_assoc_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1015 cÚ¡ *
bssid
, 
¢
, 
¡©us
,

1016 
mgmt_äame_subty³
)

1018 
pos
 = 0;

1019 *
log_bufãr
 = 
NULL
;

1020 
buf_size
 = 
BUFF_SIZE
;

1021 
u32
 
time
[2] = { 0 };

1022 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1023 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1025 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1028 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1029 ià(!
Ãw_node
)

1031 
log_bufãr
 = 
Ãw_node
->
¡r
;

1033 
	`g‘_k”Ãl_time¡amp
(
time
);

1034 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_ASSOC_RESP
)

1035 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [CONN] ASSOC RESP", 
time
[0],ime[1]);

1036 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_REASSOC_RESP
)

1037 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [CONN] REASSOC RESP", 
time
[0],ime[1]);

1038 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " bssid="

1039 
MACSTR_NOMASK
 " sn=%d "

1040 "¡©us=%d", 
	`MAC2STR_LOG
(
bssid
), 
¢
, 
¡©us
);

1041 
Ãw_node
->
Ën
 = 
pos
 + 1;

1042 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1043 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1044 
	}
}

1046 
	$¦si_cÚn_log2us_d—uth
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r_ty³
,

1047 cÚ¡ *
bssid
,

1048 
¢
, 
¡©us
)

1050 
pos
 = 0;

1051 *
log_bufãr
 = 
NULL
;

1052 
buf_size
 = 
BUFF_SIZE
;

1053 
u32
 
time
[2] = { 0 };

1054 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1055 
rssi
 = 100;

1056 
»s
;

1057 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1059 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1062 
sdev
->
cÚn_log2us_ùx
.
cÚn_æag
 = 
çl£
;

1063 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1064 ià(!
Ãw_node
)

1066 
log_bufãr
 = 
Ãw_node
->
¡r
;

1068 
	`g‘_k”Ãl_time¡amp
(
time
);

1069 
»s
 = 
	`¦si_log2us_g‘_rssi
(
sdev
, 
dev
, &
rssi
, 
SLSI_PSID_UNIFI_LAST_BSS_RSSI
);

1070 ià(
»s
)

1071 
	`SLSI_ERR
(
sdev
, "Could‚Ù g‘„ss˜¡©u ğ%d\n", 
»s
);

1072 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [CONN] DEAUTH %s bssid="

1073 
MACSTR_NOMASK
 "„ssi=%d sn=%d„—sÚ=%d", 
time
[0],ime[1],

1074 
¡r_ty³
, 
	`MAC2STR_LOG
(
bssid
), 
rssi
, 
¢
, 
¡©us
);

1075 
Ãw_node
->
Ën
 = 
pos
 + 1;

1076 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1077 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1078 
	}
}

1080 
	$¦si_cÚn_log2us_di§ssoc
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r_ty³
,

1081 cÚ¡ *
bssid
,

1082 
¢
, 
¡©us
)

1084 
pos
 = 0;

1085 *
log_bufãr
 = 
NULL
;

1086 
buf_size
 = 
BUFF_SIZE
;

1087 
u32
 
time
[2] = { 0 };

1088 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1089 
rssi
 = 100;

1090 
»s
;

1091 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1093 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1096 
sdev
->
cÚn_log2us_ùx
.
cÚn_æag
 = 
çl£
;

1097 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1098 ià(!
Ãw_node
)

1100 
log_bufãr
 = 
Ãw_node
->
¡r
;

1102 
	`g‘_k”Ãl_time¡amp
(
time
);

1103 
»s
 = 
	`¦si_log2us_g‘_rssi
(
sdev
, 
dev
, &
rssi
, 
SLSI_PSID_UNIFI_LAST_BSS_RSSI
);

1104 ià(
»s
)

1105 
	`SLSI_ERR
(
sdev
, "Could‚Ù g‘„ss˜¡©u ğ%d\n", 
»s
);

1106 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [CONN] DISASSOC %s bssid="

1107 
MACSTR_NOMASK
 "„ssi=%d sn=%d "

1108 "»asÚ=%d", 
time
[0],ime[1], 
¡r_ty³
, 
	`MAC2STR_LOG
(
bssid
),

1109 
rssi
, 
¢
, 
¡©us
);

1110 
Ãw_node
->
Ën
 = 
pos
 + 1;

1111 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1112 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1113 
	}
}

1115 
	$¦si_cÚn_log2us_rßm_sÿn_§ve
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1116 
sÿn_ty³
, 
äeq_couÁ
,

1117 *
äeq_li¡
)

1119 
i
;

1120 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1122 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1125 
sdev
->
cÚn_log2us_ùx
.
rßm_äeq_couÁ
 = 
äeq_couÁ
;

1127 
i
 = 0; i < 
äeq_couÁ
; i++)

1128 
sdev
->
cÚn_log2us_ùx
.
rßm_äeq_li¡
[
i
] = *(
äeq_li¡
 + i);

1130 ià(
sÿn_ty³
 =ğ
FAPI_SCANTYPE_SOFT_CACHED_ROAMING_SCAN
 ||

1131 
sÿn_ty³
 =ğ
FAPI_SCANTYPE_HARD_CACHED_ROAMING_SCAN
)

1132 
sdev
->
cÚn_log2us_ùx
.
fuÎ_sÿn_rßm
 = 0;

1133 ià(
sÿn_ty³
 =ğ
FAPI_SCANTYPE_SOFT_FULL_ROAMING_SCAN
 ||

1134 
sÿn_ty³
 =ğ
FAPI_SCANTYPE_HARD_FULL_ROAMING_SCAN
)

1135 
sdev
->
cÚn_log2us_ùx
.
fuÎ_sÿn_rßm
 = 1;

1136 
	}
}

1138 
	$¦si_cÚn_log2us_rßm_sÿn_dÚe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u64
 
time¡amp
)

1140 
pos
 = 0;

1141 *
log_bufãr
 = 
NULL
;

1142 
buf_size
 = 
BUFF_SIZE
;

1143 
u32
 
time
[2] = { 0 };

1144 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1145 
i
;

1146 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1148 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1151 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1152 ià(!
Ãw_node
)

1154 
log_bufãr
 = 
Ãw_node
->
¡r
;

1156 
	`g‘_k”Ãl_time¡amp
(
time
);

1157 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [ROAM] SCAN_DONE‡p_count=%d freq[%d]=",

1158 
time
[0],ime[1], 
sdev
->
cÚn_log2us_ùx
.
rßm_­_couÁ
,

1159 
sdev
->
cÚn_log2us_ùx
.
rßm_äeq_couÁ
);

1161 
i
 = 0; i < 
sdev
->
cÚn_log2us_ùx
.
rßm_äeq_couÁ
; i++)

1162 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "%d ",

1163 
sdev
->
cÚn_log2us_ùx
.
rßm_äeq_li¡
[
i
]);

1165 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[fw_time=%Îu]", 
time¡amp
);

1167 
Ãw_node
->
Ën
 = 
pos
 + 1;

1168 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1169 
	`’queue_log_bufãr
(
sdev
->
cÚn_log2us_ùx
.
li¡_rßm_ÿnd
, &sdev->conn_log2us_ctx);

1170 
sdev
->
cÚn_log2us_ùx
.
li¡_rßm_ÿnd
 = 
NULL
;

1171 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1172 
	}
}

1174 
	$¦si_cÚn_log2us_rßm_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1175 
boŞ
 
cu¼
, *
bssid
, 
äeq
,

1176 
rssi
, 
cu
,

1177 
scÜe
, 
_scÜe
, 
boŞ
 
–igibË
)

1179 
pos
 = 0;

1180 *
log_bufãr
 = 
NULL
;

1181 
buf_size
 = 
BUFF_SIZE
;

1182 
u32
 
time
[2] = { 0 };

1183 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1184 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1186 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1189 
sdev
->
cÚn_log2us_ùx
.
rßm_­_couÁ
++;

1190 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1191 ià(!
Ãw_node
)

1193 
log_bufãr
 = 
Ãw_node
->
¡r
;

1195 
	`g‘_k”Ãl_time¡amp
(
time
);

1196 ià(
cu¼
) {

1197 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [ROAM] SCORE_CUR_AP bssid="

1198 
MACSTR_NOMASK
 " f»q=%d„ssi=%d cu=%d scÜe=%d.%02d", 
time
[0],ime[1],

1199 
	`MAC2STR_LOG
(
bssid
), 
äeq
 / 2, 
rssi
, 
cu
, 
scÜe
 / 100, score % 100);

1201 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [ROAM] SCORE_CANDI[%d] bssid="

1202 
MACSTR_NOMASK
 " freq=%d„ssi=%d cu=%d score=%d.%02dp=%dkbps [eligible=%s]",

1203 
time
[0],ime[1], 
sdev
->
cÚn_log2us_ùx
.
ÿnd_numb”
,

1204 
	`MAC2STR_LOG
(
bssid
), 
äeq
 / 2, 
rssi
, 
cu
, 
scÜe
 / 100, score % 100,

1205 
_scÜe
, 
–igibË
 ? "true" : "false");

1206 
sdev
->
cÚn_log2us_ùx
.
ÿnd_numb”
++;

1208 
Ãw_node
->
Ën
 = 
pos
 + 1;

1209 
	`’queue_log_bufãr_fÜ_rßm_ÿnd
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1210 
	}
}

1212 
	$¦si_cÚn_log2us_btm_qu”y
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1213 
dŸlog
, 
»asÚ
)

1215 
pos
 = 0;

1216 *
log_bufãr
 = 
NULL
;

1217 
buf_size
 = 
BUFF_SIZE
;

1218 
u32
 
time
[2] = { 0 };

1219 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1220 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1222 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1225 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1226 ià(!
Ãw_node
)

1228 
log_bufãr
 = 
Ãw_node
->
¡r
;

1230 
	`g‘_k”Ãl_time¡amp
(
time
);

1231 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [BTM] QUERYoken=%d„eason=%d",

1232 
time
[0],ime[1], 
dŸlog
, 
»asÚ
);

1233 
Ãw_node
->
Ën
 = 
pos
 + 1;

1234 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1235 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1236 
	}
}

1238 
	$¦si_cÚn_log2us_btm_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1239 
dŸlog
, 
btm_mode
, 
di§ssoc_tim”
,

1240 
v®id™y_time
, 
ÿndid©e_couÁ
)

1242 
pos
 = 0;

1243 *
log_bufãr
 = 
NULL
;

1244 
buf_size
 = 
BUFF_SIZE
;

1245 
u32
 
time
[2] = { 0 };

1246 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1247 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1249 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1252 
sdev
->
cÚn_log2us_ùx
.
ÿnd_couÁ
 = 0;

1253 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1254 ià(!
Ãw_node
)

1256 
log_bufãr
 = 
Ãw_node
->
¡r
;

1258 
	`g‘_k”Ãl_time¡amp
(
time
);

1259 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [BTM] REQoken=%d mode=%d disassoc=%d"

1260 " v®id™y=%d cªdid©e_li¡_út=%d", 
time
[0],ime[1], 
dŸlog
, 
btm_mode
,

1261 
di§ssoc_tim”
, 
v®id™y_time
, 
ÿndid©e_couÁ
);

1262 
Ãw_node
->
Ën
 = 
pos
 + 1;

1263 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1264 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1265 
	}
}

1267 
	$¦si_cÚn_log2us_btm_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
dŸlog
,

1268 
btm_mode
, 
d–ay
, *
bssid
)

1270 
pos
 = 0;

1271 *
log_bufãr
 = 
NULL
;

1272 
buf_size
 = 
BUFF_SIZE
;

1273 
u32
 
time
[2] = { 0 };

1274 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1275 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1277 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1280 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1281 ià(!
Ãw_node
)

1283 
log_bufãr
 = 
Ãw_node
->
¡r
;

1285 
	`g‘_k”Ãl_time¡amp
(
time
);

1286 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [BTM] RESPoken=%d status=%d delay=%d",

1287 
time
[0],ime[1], 
dŸlog
, 
btm_mode
, 
d–ay
);

1288 ià(
btm_mode
 == 0)

1289 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "¬g‘=" 
MACSTR_NOMASK
, 
	`MAC2STR_LOG
(
bssid
));

1290 
Ãw_node
->
Ën
 = 
pos
 + 1;

1291 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1292 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1293 
	}
}

1295 
	$¦si_cÚn_log2us_btm_ÿnd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1296 *
bssid
, 
´eãr
)

1298 
pos
 = 0;

1299 *
log_bufãr
 = 
NULL
;

1300 
buf_size
 = 
BUFF_SIZE
;

1301 
u32
 
time
[2] = { 0 };

1302 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1303 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1305 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1308 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1309 ià(!
Ãw_node
)

1311 
log_bufãr
 = 
Ãw_node
->
¡r
;

1313 
	`g‘_k”Ãl_time¡amp
(
time
);

1314 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [BTM] REQ_CANDI[%d] bssid="

1315 
MACSTR_NOMASK
 "…»ã»nû=%d", 
time
[0],ime[1],

1316 
sdev
->
cÚn_log2us_ùx
.
ÿnd_couÁ
, 
	`MAC2STR_LOG
(
bssid
), 
´eãr
);

1317 
sdev
->
cÚn_log2us_ùx
.
ÿnd_couÁ
++;

1318 
Ãw_node
->
Ën
 = 
pos
 + 1;

1319 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1320 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1321 
	}
}

1323 
	$¦si_cÚn_log2us_Ä_äame_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1325 
pos
 = 0;

1326 *
log_bufãr
 = 
NULL
;

1327 
buf_size
 = 
BUFF_SIZE
;

1328 
u32
 
time
[2] = { 0 };

1329 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1330 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1332 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1335 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1336 ià(!
Ãw_node
)

1338 
log_bufãr
 = 
Ãw_node
->
¡r
;

1340 
	`g‘_k”Ãl_time¡amp
(
time
);

1341 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [NEIGHBOR_REPORT] REQ Sent from mobile",

1342 
time
[0],ime[1]);

1344 
Ãw_node
->
Ën
 = 
pos
 + 1;

1345 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1346 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1347 
	}
}

1349 
	$¦si_cÚn_log2us_Ä_äame_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡ršg
)

1351 
pos
 = 0;

1352 *
log_bufãr
 = 
NULL
;

1353 
buf_size
 = 
BUFF_SIZE
;

1354 
u32
 
time
[2] = { 0 };

1355 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1356 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1358 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1361 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1362 ià(!
Ãw_node
)

1364 
log_bufãr
 = 
Ãw_node
->
¡r
;

1366 
	`g‘_k”Ãl_time¡amp
(
time
);

1367 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d] [NEIGHBOR_REPORT] RESP Channel†ist=%s",

1368 
time
[0],ime[1], 
¡ršg
);

1370 
Ãw_node
->
Ën
 = 
pos
 + 1;

1371 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1372 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1373 
	}
}

1375 
	$¦si_cÚn_log2us_b—cÚ_»pÜt_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1376 
dŸlog_tok’
, 
İ”©šg_şass
, *
¡ršg
,

1377 
m—su»_du¿tiÚ
, *
m—su»_mode
,

1378 *
mac_addr
, *
ssid
)

1380 
pos
 = 0;

1381 *
log_bufãr
 = 
NULL
;

1382 
buf_size
 = 
BUFF_SIZE
;

1383 
u32
 
time
[2] = { 0 };

1384 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1385 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1387 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1390 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1391 ià(!
Ãw_node
)

1393 
log_bufãr
 = 
Ãw_node
->
¡r
;

1395 
	`g‘_k”Ãl_time¡amp
(
time
);

1396 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d][BEACON_REPORT] REQ Token=%d Operating Class=%d "

1397 "chªÃÈli¡=% M—su»m’ˆDu¿tiÚ=%d M—su»m’ˆMode=% BSSID="
MACSTR_NOMASK
" SSID=%s",

1398 
time
[0],ime[1], 
dŸlog_tok’
, 
İ”©šg_şass
, 
¡ršg
, 
m—su»_du¿tiÚ
, 
m—su»_mode
,

1399 
	`MAC2STR_LOG
(
mac_addr
), 
ssid
);

1400 
Ãw_node
->
Ën
 = 
pos
 + 1;

1401 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1402 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1403 
	}
}

1405 
	$¦si_cÚn_log2us_b—cÚ_»pÜt_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
dŸlog_tok’
,

1406 
­_couÁ
, 
»asÚ_code
)

1408 
pos
 = 0;

1409 *
log_bufãr
 = 
NULL
;

1410 
buf_size
 = 
BUFF_SIZE
;

1411 
u32
 
time
[2] = { 0 };

1412 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1413 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1415 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1418 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1419 ià(!
Ãw_node
)

1421 
log_bufãr
 = 
Ãw_node
->
¡r
;

1423 
	`g‘_k”Ãl_time¡amp
(
time
);

1424 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, "[%d.%d][BEACON_REPORT] RESP Token=%d"

1425 " SÿÂed AP Numb”=%d", 
time
[0],ime[1], 
dŸlog_tok’
, 
­_couÁ
);

1426 ià(
»asÚ_code
)

1427 
pos
 +ğ
	`sú´štf
(
log_bufãr
 +…os, 
buf_size
 -…os, " R—sÚ=%d", 
»asÚ_code
);

1429 
Ãw_node
->
Ën
 = 
pos
 + 1;

1430 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1431 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1432 
	}
}

1434 
	$¦si_cÚn_log2us_ncho_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
’abË
)

1436 
pos
 = 0;

1437 *
log_bufãr
 = 
NULL
;

1438 
buf_size
 = 
BUFF_SIZE
;

1439 
u32
 
time
[2] = { 0 };

1440 
buff_li¡
 *
Ãw_node
 = 
NULL
;

1441 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1443 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
)

1446 
Ãw_node
 = 
	`¦si_cÚn_log2us_®loc_Ãw_node
();

1447 ià(!
Ãw_node
)

1449 
log_bufãr
 = 
Ãw_node
->
¡r
;

1451 
	`g‘_k”Ãl_time¡amp
(
time
);

1452 
pos
 = 
	`sú´štf
(
log_bufãr
, 
buf_size
, "[%d.%d][NCHO] MODEƒnable=%d",

1453 
time
[0],ime[1], 
’abË
);

1455 
Ãw_node
->
Ën
 = 
pos
 + 1;

1456 
	`’queue_log_bufãr
(
Ãw_node
, &
sdev
->
cÚn_log2us_ùx
);

1457 
	`queue_wÜk
(
sdev
->
cÚn_log2us_ùx
.
log2us_wÜkq
, &sdev->cÚn_log2us_ùx.
log2us_wÜk
);

1458 
	}
}

1462 
	$¦si_cÚn_log2us_š™
(
¦si_dev
 *
sdev
)

1464 
	}
}

1466 
	$¦si_cÚn_log2us_deš™
(
¦si_dev
 *
sdev
)

1468 
	}
}

1470 
	$¦si_cÚn_log2us_cÚÃùšg
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

1472 
	}
}

1474 
	$¦si_cÚn_log2us_cÚÃùšg_ç
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1475 cÚ¡ *
bssid
,

1476 
äeq
, 
»asÚ
)

1478 
	}
}

1480 
	$¦si_cÚn_log2us_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1481 cÚ¡ *
bssid
, 
»asÚ
)

1483 
	}
}

1485 
	$¦si_cÚn_log2us_—pŞ_gtk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1486 
—pŞ_msg_ty³
)

1488 
	}
}

1490 
	$¦si_cÚn_log2us_—pŞ_±k
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1491 
—pŞ_msg_ty³
)

1493 
	}
}

1495 
	$¦si_cÚn_log2us_rßm_sÿn_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1496 
»asÚ
, 
rßm_rssi_v®
,

1497 
chª_uti§tiÚ
,

1498 
rssi_th»sh
, 
u64
 
time¡amp
)

1500 
	}
}

1502 
	$¦si_cÚn_log2us_rßm_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1503 *
bssid
, 
u64
 
time¡amp
, 
boŞ
 
rßm_ÿndid©e
)

1505 
	}
}

1507 
	$¦si_cÚn_log2us_—p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
—p_ty³
)

1509 
	}
}

1511 
	$¦si_cÚn_log2us_dhı
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r
)

1513 
	}
}

1515 
	$¦si_cÚn_log2us_dhı_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1516 *
¡r
, *
tx_¡©us
)

1518 
	}
}

1520 
	$¦si_cÚn_log2us_—p_w™h_Ën
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1521 
u8
 *
—p_ty³
, 
—p_Ëngth
)

1523 
	}
}

1525 
	$¦si_cÚn_log2us_auth_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1526 cÚ¡ *
bssid
,

1527 
auth_®go
, 
§e_ty³
, 
¢
, 
¡©us
, 
u32
 
tx_¡©us
, 
is_rßmšg
)

1529 
	}
}

1531 
	$¦si_cÚn_log2us_auth_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1532 cÚ¡ *
bssid
, 
auth_®go
,

1533 
§e_ty³
,

1534 
¢
, 
¡©us
, 
is_rßmšg
)

1536 
	}
}

1538 
	$¦si_cÚn_log2us_assoc_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1539 cÚ¡ *
bssid
, 
¢
, 
tx_¡©us
,

1540 
mgmt_äame_subty³
)

1542 
	}
}

1544 
	$¦si_cÚn_log2us_assoc_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1545 cÚ¡ *
bssid
, 
¢
, 
¡©us
,

1546 
mgmt_äame_subty³
)

1548 
	}
}

1550 
	$¦si_cÚn_log2us_d—uth
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r_ty³
,

1551 cÚ¡ *
bssid
, 
¢
, 
¡©us
)

1553 
	}
}

1555 
	$¦si_cÚn_log2us_di§ssoc
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r_ty³
,

1556 cÚ¡ *
bssid
,

1557 
¢
, 
¡©us
)

1559 
	}
}

1561 
	$¦si_cÚn_log2us_rßm_sÿn_dÚe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u64
 
time¡amp
)

1563 
	}
}

1565 
	$¦si_cÚn_log2us_rßm_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1566 
boŞ
 
cu¼
, *
bssid
, 
äeq
,

1567 
rssi
, 
cu
,

1568 
scÜe
, 
_scÜe
, 
boŞ
 
–igibË
)

1570 
	}
}

1572 
	$¦si_cÚn_log2us_btm_qu”y
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1573 
dŸlog
, 
»asÚ
)

1575 
	}
}

1577 
	$¦si_cÚn_log2us_btm_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1578 
dŸlog
, 
btm_mode
, 
di§ssoc_tim”
,

1579 
v®id™y_time
, 
ÿndid©e_couÁ
)

1581 
	}
}

1583 
	$¦si_cÚn_log2us_btm_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1584 
dŸlog
, 
btm_mode
, 
d–ay
, *
bssid
)

1586 
	}
}

1588 
u8
 *
	$g‘_—p_ty³_äom_v®
(
v®
, 
u8
 *
¡r
)

1590  
NULL
;

1591 
	}
}

1593 
	$¦si_cÚn_log2us_—pŞ_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
¡©us_code
)

1595 
	}
}

1597 
	$¦si_cÚn_log2us_—pŞ_±k_tx
(
¦si_dev
 *
sdev
, 
u32
 
¡©us_code
)

1599 
	}
}

1601 
	$¦si_cÚn_log2us_—pŞ_gtk_tx
(
¦si_dev
 *
sdev
, 
u32
 
¡©us_code
)

1603 
	}
}

1605 
	$¦si_cÚn_log2us_—p_tx
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1606 
—p_Ëngth
, 
—p_ty³
,

1607 *
tx_¡©us_¡r
)

1609 
	}
}

1611 
	$¦si_cÚn_log2us_btm_ÿnd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1612 *
bssid
, 
´eãr
)

1614 
	}
}

1616 
	$¦si_—pŞ_—p_hªdË_tx_¡©us
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1617 
u16
 
a
, u16 
b
)

1619 
	}
}

1621 
	$¦si_cÚn_log2us_rßm_sÿn_§ve
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1622 
sÿn_ty³
, 
äeq_couÁ
, *
äeq_li¡
)

1624 
	}
}

1626 
¦si_cÚn_log2us_Ä_äame_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

1630 
	$¦si_cÚn_log2us_Ä_äame_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡ršg
)

1632 
	}
}

1634 
	$¦si_cÚn_log2us_b—cÚ_»pÜt_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1635 
dŸlog_tok’
, 
İ”©šg_şass
, *
¡ršg
,

1636 
m—su»_du¿tiÚ
, *
m—su»_mode
,

1637 *
mac_addr
, *
ssid
)

1639 
	}
}

1641 
	$¦si_cÚn_log2us_b—cÚ_»pÜt_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
dŸlog_tok’
,

1642 
­_couÁ
, 
»asÚ_code
)

1644 
	}
}

1646 
	$¦si_cÚn_log2us_ncho_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
’abË
)

1648 
	}
}

	@log2us.h

6 #iâdeà
__SLSI_LOG2US_H__


7 
	#__SLSI_LOG2US_H__


	)

8 
	~<lšux/ty³s.h
>

9 
	~<lšux/¿‹lim™.h
>

10 
	~<lšux/wÜkqueue.h
>

11 
	~<lšux/Ãtdeviû.h
>

13 
	~"mib.h
"

14 
	~"dev.h
"

16 
	g¦si_dev
;

17 
	#SLSI_LOG2US_BURST
 20

	)

18 
	#BUFF_SIZE
 256

	)

20 
¦si_cÚn_log2us_š™
(
¦si_dev
 *
sdev
);

21 
¦si_cÚn_log2us_deš™
(
¦si_dev
 *
sdev
);

22 
¦si_cÚn_log2us_cÚÃùšg
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
);

24 
¦si_cÚn_log2us_cÚÃùšg_ç
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

25 cÚ¡ *
bssid
,

26 
äeq
, 
»asÚ
);

27 
¦si_cÚn_log2us_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

28 cÚ¡ *
bssid
, 
»asÚ
);

29 
¦si_cÚn_log2us_—pŞ_gtk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
—pŞ_msg_ty³
);

30 
¦si_cÚn_log2us_—pŞ_±k
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
—pŞ_msg_ty³
);

31 
¦si_cÚn_log2us_rßm_sÿn_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
»asÚ
,

32 
rßm_rssi_v®
, 
chª_uti§tiÚ
,

33 
rssi_th»sh
, 
u64
 
time¡amp
);

34 
¦si_cÚn_log2us_rßm_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

35 *
bssid
, 
u64
 
time¡amp
, 
boŞ
 
rßm_ÿndid©e
);

36 
¦si_cÚn_log2us_—p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
—p_ty³
);

37 
¦si_cÚn_log2us_dhı
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r
);

38 
¦si_cÚn_log2us_dhı_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

39 *
¡r
, *
tx_¡©us
);

40 
¦si_cÚn_log2us_—p_w™h_Ën
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

41 
u8
 *
—p_ty³
, 
—p_Ëngth
);

42 
¦si_cÚn_log2us_auth_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

43 cÚ¡ *
bssid
,

44 
auth_®go
, 
§e_ty³
, 
¢
,

45 
¡©us
, 
u32
 
tx_¡©us
, 
is_rßmšg
);

47 
¦si_cÚn_log2us_auth_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

48 cÚ¡ *
bssid
,

49 
auth_®go
,

50 
§e_ty³
,

51 
¢
, 
¡©us
, 
is_rßmšg
);

52 
¦si_cÚn_log2us_assoc_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

53 cÚ¡ *
bssid
,

54 
¢
, 
tx_¡©us
, 
mgmt_äame_subty³
);

55 
¦si_cÚn_log2us_assoc_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

56 cÚ¡ *
bssid
,

57 
¢
, 
¡©us
, 
mgmt_äame_subty³
);

59 
¦si_cÚn_log2us_d—uth
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r_ty³
,

60 cÚ¡ *
bssid
, 
¢
, 
¡©us
);

62 
¦si_cÚn_log2us_di§ssoc
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡r_ty³
,

63 cÚ¡ *
bssid
, 
¢
, 
¡©us
);

64 
¦si_cÚn_log2us_rßm_sÿn_dÚe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u64
 
time¡amp
);

65 
¦si_cÚn_log2us_rßm_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
cu¼
,

66 *
bssid
, 
äeq
,

67 
rssi
, 
cu
,

68 
scÜe
, 
_scÜe
, 
boŞ
 
–igibË
);

69 
¦si_cÚn_log2us_btm_qu”y
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

70 
dŸlog
, 
»asÚ
);

71 
¦si_cÚn_log2us_btm_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

72 
dŸlog
, 
btm_mode
,

73 
di§ssoc_tim”
,

74 
v®id™y_time
, 
ÿndid©e_couÁ
);

75 
¦si_cÚn_log2us_btm_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

76 
dŸlog
,

77 
btm_mode
, 
d–ay
, *
bssid
);

78 
u8
 *
g‘_—p_ty³_äom_v®
(
v®
, u8 *
¡r
);

79 
¦si_cÚn_log2us_—pŞ_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
¡©us_code
);

80 
¦si_cÚn_log2us_—pŞ_±k_tx
(
¦si_dev
 *
sdev
, 
u32
 
¡©us_code
);

81 
¦si_cÚn_log2us_—pŞ_gtk_tx
(
¦si_dev
 *
sdev
, 
u32
 
¡©us_code
);

82 
¦si_cÚn_log2us_—p_tx
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

83 
—p_Ëngth
, 
—p_ty³
,

84 *
¡r_ty³
);

85 
¦si_cÚn_log2us_btm_ÿnd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

86 *
bssid
, 
´eãr
);

87 
¦si_—pŞ_—p_hªdË_tx_¡©us
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

88 
u16
 
a
, u16 
b
);

89 
¦si_cÚn_log2us_rßm_sÿn_§ve
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sÿn_ty³
,

90 
äeq_couÁ
, *
äeq_li¡
);

91 
¦si_cÚn_log2us_Ä_äame_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

93 
¦si_cÚn_log2us_Ä_äame_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
¡ršg
);

94 
¦si_cÚn_log2us_b—cÚ_»pÜt_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

95 
dŸlog_tok’
, 
İ”©šg_şass
, *
¡ršg
,

96 
m—su»_du¿tiÚ
, *
m—su»_mode
,

97 *
mac_addr
, *
ssid
);

98 
¦si_cÚn_log2us_b—cÚ_»pÜt_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
dŸlog_tok’
,

99 
­_couÁ
, 
»asÚ_code
);

100 
¦si_cÚn_log2us_ncho_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
’abË
);

	@log_clients.c

7 
	~"dev.h
"

8 
	~"debug.h
"

9 
	~"udi.h
"

10 
	~"log_ş›Ás.h
"

11 
	~"unifiio.h
"

19 
	$¦si_log_ş›Ás_log_sigÇl_§ã
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u32
 
dœeùiÚ
)

21 
li¡_h—d
 *
pos
, *
n
;

22 
¦si_log_ş›Á
 *
log_ş›Á
;

23 
dœ
 = (
dœeùiÚ
 =ğ
SLSI_LOG_DIRECTION_FROM_HOST
è? 
UDI_FROM_HOST
 : 
UDI_TO_HOST
;

25 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

26 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
) {

27 
log_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_log_ş›Á
, 
q
);

28 
log_ş›Á
->
	`log_ş›Á_cb
Öog_ş›Á, 
skb
, 
dœ
);

30 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

31 
	}
}

33 
	$¦si_log_ş›Ás_š™
(
¦si_dev
 *
sdev
)

35 
	`INIT_LIST_HEAD
(&
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
);

36 
	`¥š_lock_š™
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

37 
	}
}

42 
	$¦si_log_ş›Á_»gi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
,

43 (*
log_ş›Á_cb
)(
¦si_log_ş›Á
 *, 
sk_buff
 *, ),

44 *
f‹r
, 
mš_sigÇl_id
, 
max_sigÇl_id
)

46 
¦si_log_ş›Á
 *
log_ş›Á
;

47 
fœ¡_š_li¡
 = 0;

49 
fœ¡_š_li¡
 = 
	`li¡_em±y
(&
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
);

50 
log_ş›Á
 = 
	`km®loc
((*log_ş›Á), 
GFP_KERNEL
);

51 ià(
log_ş›Á
 =ğ
NULL
)

52  -
ENOMEM
;

54 
log_ş›Á
->
mš_sigÇl_id
 = min_signal_id;

55 
log_ş›Á
->
max_sigÇl_id
 = max_signal_id;

56 
log_ş›Á
->
sigÇl_f‹r
 = 
f‹r
;

57 
log_ş›Á
->
log_ş›Á_ùx
 =†og_client_ctx;

58 
log_ş›Á
->
log_ş›Á_cb
 =†og_client_cb;

61 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

62 
	`li¡_add_
(&
log_ş›Á
->
q
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
);

63 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

66 
	}
}

68 
	$¦si_log_ş›Ás_‹rmš©e
(
¦si_dev
 *
sdev
)

73 ià(*
sdev
->
‹rm_udi_u£rs
) {

74 
num_pŞls_Ëá
 = 50;

75 
timeout_ms
 = 4;

77 
	`¦si_log_ş›Á_msg
(
sdev
, 
UDI_DRV_UNLOAD_IND
, 0, 
NULL
);

80 
	`¦si_check_cdev_»fs
(è&& 
num_pŞls_Ëá
) {

81 
	`m¦“p
(
timeout_ms
);

82 
num_pŞls_Ëá
--;

85 
	}
}

87 
	$¦si_log_ş›Á_msg
(
¦si_dev
 *
sdev
, 
u16
 
ev’t
, 
u32
 
ev’t_d©a_Ëngth
, cÚ¡ 
u8
 *
ev’t_d©a
)

89 
li¡_h—d
 *
pos
, *
n
;

90 
¦si_log_ş›Á
 *
log_ş›Á
;

92 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

93 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
) {

94 
log_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_log_ş›Á
, 
q
);

95 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

96 ià(
	`¦si_k”Ãl_to_u£r_¥aû_ev’t
(
log_ş›Á
, 
ev’t
, 
ev’t_d©a_Ëngth
, 
ev’t_d©a
))

97 
	`SLSI_WARN
(
sdev
, "FaedØ£ndƒv’t(0x%.4XètØUDI cl›Á 0x%p\n", 
ev’t
, 
log_ş›Á
);

98 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

100 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

101 
	}
}

103 
	$¦si_log_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
)

105 
li¡_h—d
 *
pos
, *
n
;

106 
¦si_log_ş›Á
 *
log_ş›Á
;

108 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

109 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
) {

110 
log_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_log_ş›Á
, 
q
);

111 ià(
log_ş›Á
->
log_ş›Á_ùx
 ==†og_client_ctx) {

112 
	`kä“
(
log_ş›Á
->
sigÇl_f‹r
);

113 
	`li¡_d–
(
pos
);

114 
	`kä“
(
log_ş›Á
);

117 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

118 
	}
}

	@log_clients.h

7 #iâdeà
__SLSI_LOG_CLIENTS_H__


8 
	#__SLSI_LOG_CLIENTS_H__


	)

10 
	~<lšux/ty³s.h
>

12 
	g¦si_dev
;

14 
	s¦si_log_ş›Á
 {

15 
li¡_h—d
 
	mq
;

16 *
	mlog_ş›Á_ùx
;

17 (*
	mlog_ş›Á_cb
)(
	m¦si_log_ş›Á
 *, 
	msk_buff
 *, );

18 
	mmš_sigÇl_id
;

19 
	mmax_sigÇl_id
;

20 *
	msigÇl_f‹r
;

23 
	s¦si_log_ş›Ás
 {

25 
¥šlock_t
 
	mlog_ş›Á_¥šlock
;

26 
li¡_h—d
 
	mlog_ş›Á_li¡
;

29 
	#SLSI_LOG_DIRECTION_FROM_HOST
 0

	)

30 
	#SLSI_LOG_DIRECTION_TO_HOST
 1

	)

32 
¦si_log_ş›Ás_š™
(
¦si_dev
 *
sdev
);

33 
¦si_log_ş›Á_»gi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
,

34 (*
log_ş›Á_cb
)(
¦si_log_ş›Á
 *, 
sk_buff
 *, ),

35 *
f‹r
, 
mš_sigÇl_id
, 
max_sigÇl_id
);

37 
	`¦si_log_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
);

38 
	`¦si_log_ş›Á_msg
(
¦si_dev
 *
sdev
, 
u16
 
ev’t
, 
u32
 
ev’t_d©a_Ëngth
, cÚ¡ 
u8
 *
ev’t_d©a
);

39 
	`¦si_log_ş›Ás_log_sigÇl_§ã
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u32
 
dœeùiÚ
);

40 
šlše
 
	$¦si_log_ş›Ás_log_sigÇl_ç¡
(
¦si_dev
 *
sdev
, 
¦si_log_ş›Ás
 *
log_ş›Ás
, 
sk_buff
 *
skb
, 
u32
 
dœeùiÚ
)

45 ià(!
	`li¡_em±y
(&
log_ş›Ás
->
log_ş›Á_li¡
))

46 
	`¦si_log_ş›Ás_log_sigÇl_§ã
(
sdev
, 
skb
, 
dœeùiÚ
);

47 
	}
}

49 
¦si_log_ş›Ás_‹rmš©e
(
¦si_dev
 *
sdev
);

	@mbulk.c

6 
	~<lšux/¡ršg.h
>

7 
	~<lšux/¥šlock.h
>

8 
	~"mbulk.h
"

9 
	~"h4_§m¶”.h
"

11 
	~"debug.h
"

16 
	#MBULK_ALIGN
 (64)

	)

17 
	#MBULK_IS_ALIGNED
(
s
è(((
ušŒ_t
)(sè& (
MBULK_ALIGN
 - 1)è=ğ0)

	)

18 
	#MBULK_SZ_ROUNDUP
(
s
è
	`round_up
(s, 
MBULK_ALIGN
)

	)

23 
	#MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
 ((
u32
)(-2))

	)

25 
DEFINE_SPINLOCK
(
mbulk_poŞ_lock
);

27 
šlše
 
	$mbulk_debug
(
mbulk
 *
m
)

29 ()
m
;

30 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->Ãxt_off£ˆ%p: %d\n", &
m
->
Ãxt_off£t
, m->next_offset);

31 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->æag %p: %d\n", &
m
->
æag
, m->flag);

32 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->şa %p: %d\n", &
m
->
şas
, m->clas);

33 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->pid %p: %d\n", &
m
->
pid
, m->pid);

34 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->»fúˆ%p: %d\n", &
m
->
»fút
, m->refcnt);

35 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->d©_bufsz %p: %d\n", &
m
->
d©_bufsz
, m->dat_bufsz);

36 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->sig_bufsz %p: %d\n", &
m
->
sig_bufsz
, m->sig_bufsz);

37 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->ËÀ%p: %d\n", &
m
->
Ën
, m->len);

38 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->h—d %p: %d\n", &
m
->
h—d
, m->head);

39 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->chaš_Ãxt_off£ˆ%p: %d\n", &
m
->
chaš_Ãxt_off£t
, m->chain_next_offset);

40 
	}
}

43 
	smbulk_Œack”
 {

44 
mbulk_cŞour
 
	mcŞour
;

48 
	smbulk_poŞ
 {

49 
boŞ
 
	mv®id
;

50 
u8
 
	mpid
;

51 
mbulk
 *
	mä“_li¡
;

52 
	mä“_út
;

53 
	mu§ge
[
MBULK_CLASS_MAX
];

54 *
	mba£_addr
;

55 *
	m’d_addr
;

56 
mbulk_Ën_t
 
	m£g_size
;

57 
u8
 
	mgu¬d
;

58 
	mtÙ_£g_num
;

59 
mbulk_Œack”
 *
	mmbulk_Œack”
;

60 
	mshiá
;

61 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


62 
	mmšÜ
;

67 
šlše
 
mbulk
 *
	$mbulk_poŞ_g‘
(
mbulk_poŞ
 *
poŞ
, 
mbulk_şass
 
şas
)

69 
mbulk
 *
m
;

70 
u8
 
gu¬d
 = 
poŞ
->guard;

72 
	`¥š_lock_bh
(&
mbulk_poŞ_lock
);

73 
m
 = 
poŞ
->
ä“_li¡
;

75 ià(
m
 =ğ
NULL
 || 
poŞ
->
ä“_út
 <ğ
gu¬d
) {

76 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

77  
NULL
;

80 
poŞ
->
ä“_út
--;

81 
poŞ
->
u§ge
[
şas
]++;

83 
	`SCSC_HIP4_SAMPLER_MBULK
(
poŞ
->
mšÜ
, (poŞ->
ä“_út
 & 0x100è>> 8, (poŞ->ä“_úˆ& 0xff),…oŞ->
pid
);

85 ià(
m
->
Ãxt_off£t
 == 0)

86 
poŞ
->
ä“_li¡
 = 
NULL
;

88 
poŞ
->
ä“_li¡
 = (
mbulk
 *)((
ušŒ_t
íoŞ->ä“_li¡ + 
m
->
Ãxt_off£t
);

90 
	`mem£t
(
m
, 0, (*m));

91 
m
->
pid
 = 
poŞ
->pid;

92 
m
->
şas
 = clas;

94 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

95  
m
;

96 
	}
}

99 
šlše
 
	$mbulk_poŞ_put
(
mbulk_poŞ
 *
poŞ
, 
mbulk
 *
m
)

101 ià(
m
->
æag
 =ğ
MBULK_F_FREE
)

104 ià(
m
->
şas
 > 
MBULK_CLASS_FROM_RADIO_FORWARDED
)

107 
	`¥š_lock_bh
(&
mbulk_poŞ_lock
);

108 
poŞ
->
u§ge
[
m
->
şas
]--;

109 
poŞ
->
ä“_út
++;

111 
	`SCSC_HIP4_SAMPLER_MBULK
(
poŞ
->
mšÜ
, (poŞ->
ä“_út
 & 0x100è>> 8, (poŞ->ä“_úˆ& 0xff),…oŞ->
pid
);

112 
m
->
æag
 = 
MBULK_F_FREE
;

113 ià(
poŞ
->
ä“_li¡
 !ğ
NULL
)

114 
m
->
Ãxt_off£t
 = (
ušŒ_t
)
poŞ
->
ä“_li¡
 - (uintptr_t)m;

116 
m
->
Ãxt_off£t
 = 0;

117 
poŞ
->
ä“_li¡
 = 
m
;

118 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

119 
	}
}

122 
	smbulk_poŞ_cÚfig
 {

123 
mbulk_Ën_t
 
	m£g_sz
;

124 
	m£g_num
;

128 
mbulk_poŞ
 
	gmbulk_poŞs
[
MBULK_POOL_ID_MAX
];

139 
mbulk
 *
	$mbulk_£g_g’”ic_®loc
(
mbulk_poŞ
 *
poŞ
,

140 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
)

142 
mbulk
 *
m
;

144 ià(
poŞ
 =ğ
NULL
)

145  
NULL
;

148 
m
 = 
	`mbulk_poŞ_g‘
(
poŞ
, 
şas
);

149 ià(
m
 =ğ
NULL
)

150  
NULL
;

153 
m
->
sig_bufsz
 = (
mbulk_Ën_t
)sig_bufsz;

154 ià(
sig_bufsz
)

155 
m
->
æag
 = 
MBULK_F_SIG
;

160 
m
->
h—d
 = m->
sig_bufsz
;

161 ià(
d©_bufsz
 == 0) {

162 
m
->
d©_bufsz
 = 0;

163 
m
->
»fút
 = 0;

164 } ià(
d©_bufsz
 =ğ
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
) {

165 
m
->
d©_bufsz
 = 
poŞ
->
£g_size
 - m->
sig_bufsz
;

166 
m
->
»fút
 = 1;

168 
m
->
d©_bufsz
 = (
mbulk_Ën_t
)dat_bufsz;

169 
m
->
»fút
 = 1;

172 
	`mbulk_debug
(
m
);

173  
m
;

174 
	}
}

176 
	$mbulk_poŞ_g‘_ä“_couÁ
(
u8
 
poŞ_id
)

178 
mbulk_poŞ
 *
poŞ
;

179 
num_ä“
;

181 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

182 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

183  -
EIO
;

186 
	`¥š_lock_bh
(&
mbulk_poŞ_lock
);

187 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

189 ià(!
poŞ
->
v®id
) {

190 
	`WARN_ON
(!
poŞ
->
v®id
);

191 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

192  -
EIO
;

195 
num_ä“
 = 
poŞ
->
ä“_út
;

196 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

198  
num_ä“
;

199 
	}
}

208 
mbulk
 *
	$mbulk_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
, 
mbulk_cŞour
 
cŞour
,

209 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz_»q
, size_ˆ
d©_bufsz
)

211 
mbulk_poŞ
 *
poŞ
;

212 
size_t
 
sig_bufsz
;

213 
size_t
 
tÙ_bufsz
;

214 
mbulk
 *
m_»t
;

215 
u32
 
šdex
;

218 
sig_bufsz
 = 
	`MBULK_SIG_BUFSZ_ROUNDUP
((
mbulk
è+ 
sig_bufsz_»q
) - (mbulk);

220 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

221 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

222  
NULL
;

225 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

227 ià(!
poŞ
->
v®id
) {

228 
	`WARN_ON
(!
poŞ
->
v®id
);

229  
NULL
;

233 
tÙ_bufsz
 = 
sig_bufsz
 + 
d©_bufsz
;

234 ià(
d©_bufsz
 !ğ
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
 &&

235 
poŞ
->
£g_size
 < 
tÙ_bufsz
) {

236 
	`SLSI_ERR_NODEV
("toØÏrge. Max:%d, sig:%d,…aylßd:%d,Ù®:%d\n", 
poŞ
->
£g_size
, 
sig_bufsz
,

237 
d©_bufsz
, 
tÙ_bufsz
);

238  
NULL
;

241 
m_»t
 = 
	`mbulk_£g_g’”ic_®loc
(
poŞ
, 
şas
, 
sig_bufsz
, 
d©_bufsz
);

243 
šdex
 = (((
ušŒ_t
)
poŞ
->
’d_addr
 - (ušŒ_t)
m_»t
è>>…oŞ->
shiá
) - 1;

244 ià(
šdex
 >ğ
poŞ
->
tÙ_£g_num
) {

245 
	`SLSI_ERR_NODEV
("NØä“ mbulk.Ù_£g_num:%d, index:%d\n", 
poŞ
->
tÙ_£g_num
, 
šdex
);

246  
NULL
;

249 
poŞ
->
mbulk_Œack”
[
šdex
].
cŞour
 = colour;

251  
m_»t
;

252 
	}
}

254 
mbulk_cŞour
 
	$mbulk_g‘_cŞour
(
u8
 
poŞ_id
, 
mbulk
 *
m
)

256 
mbulk_poŞ
 *
poŞ
;

257 
u16
 
šdex
;

259 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

261 ià(!
poŞ
->
v®id
) {

262 
	`WARN_ON
(1);

266 
šdex
 = (((
ušŒ_t
)
poŞ
->
’d_addr
 - (ušŒ_t)
m
è>>…oŞ->
shiá
) - 1;

267 ià(
šdex
 >ğ
poŞ
->
tÙ_£g_num
)

270  
poŞ
->
mbulk_Œack”
[
šdex
].
cŞour
;

271 
	}
}

273 #ifdeà
MBULK_SUPPORT_SG_CHAIN


278 
mbulk
 *
	$mbulk_chaš_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
,

279 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
)

281 
size_t
 
tÙ_Ën
;

282 
mbulk
 *
m
, *
h—d
, *
´e
;

284 
h—d
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
şas
, 
sig_bufsz
,

285 
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
);

286 ià(
h—d
 =ğ
NULL
 || 
	`MBULK_SEG_TAILROOM
(h—dè>ğ
d©_bufsz
)

287  
h—d
;

289 
h—d
->
æag
 |ğ(
MBULK_F_CHAIN_HEAD
 | 
MBULK_F_CHAIN
);

290 
tÙ_Ën
 = 
	`MBULK_SEG_TAILROOM
(
h—d
);

291 
´e
 = 
h—d
;

293 
tÙ_Ën
 < 
d©_bufsz
) {

294 
m
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
şas
, 0,

295 
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
);

296 ià(
m
 =ğ
NULL
)

299 
m
->
æag
 |ğ
MBULK_F_CHAIN
;

300 
tÙ_Ën
 +ğ
	`MBULK_SEG_TAILROOM
(
m
);

301 
´e
->
chaš_Ãxt
 = 
m
;

302 
´e
 = 
m
;

305 ià(
tÙ_Ën
 < 
d©_bufsz
) {

306 
	`mbulk_chaš_ä“
(
h—d
);

307  
NULL
;

310  
h—d
;

311 
	}
}

316 
	$mbulk_chaš_ä“
(
mbulk
 *
sg
)

318 
mbulk
 *
chaš_Ãxt
, *
m
;

321 ià(
sg
 =ğ
NULL
)

324 
m
 = 
sg
;

325 
m
 !ğ
NULL
) {

326 
chaš_Ãxt
 = 
m
->chain_next;

329 
m
->
æag
 &ğ~(
MBULK_F_CHAIN
 | 
MBULK_F_CHAIN_HEAD
);

330 
	`mbulk_£g_ä“
(
m
);

332 
m
 = 
chaš_Ãxt
;

334 
	}
}

340 
mbulk
 *
	$mbulk_chaš_
(
mbulk
 *
m
)

342 
m
->
chaš_Ãxt
 !ğ
NULL
)

343 
m
 = m->
chaš_Ãxt
;

344  
m
;

345 
	}
}

351 
size_t
 
	$mbulk_chaš_bufsz
(
mbulk
 *
m
)

353 
size_t
 
tbufsz
 = 0;

355 
m
 !ğ
NULL
) {

356 
tbufsz
 +ğ
m
->
d©_bufsz
;

357 
m
 = m->
chaš_Ãxt
;

360  
tbufsz
;

361 
	}
}

367 
size_t
 
	$mbulk_chaš_’
(
mbulk
 *
m
)

369 
size_t
 
’
 = 0;

371 
m
 !ğ
NULL
) {

372 
’
 +ğ
m
->
Ën
;

373 
m
 = m->
chaš_Ãxt
;

376  
’
;

377 
	}
}

384 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


385 
	$mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
£g_size
, u8 
gu¬d
, 
mšÜ
)

387 
	$mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
£g_size
, u8 
gu¬d
)

390 
mbulk_poŞ
 *
poŞ
;

391 
mbulk
 *
Ãxt
;

392 
size_t
 
by‹_³r_block
;

394 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

395 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

396  -
EIO
;

399 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

401 ià(!
	`MBULK_IS_ALIGNED
(
ba£
)) {

402 
	`WARN_ON
(!
	`MBULK_IS_ALIGNED
(
ba£
));

403  -
EIO
;

407 
by‹_³r_block
 = 
	`MBULK_SZ_ROUNDUP
((
mbulk
è+ 
£g_size
);

409 ià(
by‹_³r_block
 == 0)

410  -
EIO
;

413 
	`mem£t
(
poŞ
, 0, (*pool));

414 
poŞ
->
pid
 = 
poŞ_id
;

415 
poŞ
->
ba£_addr
 = 
ba£
;

416 
poŞ
->
’d_addr
 = 
’d
;

417 
poŞ
->
£g_size
 = (
mbulk_Ën_t
)(
by‹_³r_block
 - (
mbulk
));

418 
poŞ
->
gu¬d
 = guard;

419 
poŞ
->
shiá
 = 
	`ffs
(
by‹_³r_block
) - 1;

422 
Ãxt
 = (
mbulk
 *)
ba£
;

423 ((
ušŒ_t
)
Ãxt
 + 
by‹_³r_block
è<ğ(ušŒ_t)
’d
) {

424 
	`mem£t
(
Ãxt
, 0, (
mbulk
));

425 
Ãxt
->
pid
 = 
poŞ_id
;

428 ià(
poŞ
->
ä“_li¡
 =ğ
NULL
)

429 
Ãxt
->
Ãxt_off£t
 = 0;

431 
Ãxt
->
Ãxt_off£t
 = (
ušŒ_t
)
poŞ
->
ä“_li¡
 - (uintptr_t)next;

432 
Ãxt
->
æag
 = 
MBULK_F_FREE
;

433 
poŞ
->
ä“_li¡
 = 
Ãxt
;

434 
poŞ
->
tÙ_£g_num
++;

435 
poŞ
->
ä“_út
++;

436 
Ãxt
 = (
mbulk
 *)((
ušŒ_t
êexˆ+ 
by‹_³r_block
);

439 
poŞ
->
v®id
 = (poŞ->
ä“_út
è? 
Œue
 : 
çl£
;

440 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


441 
poŞ
->
mšÜ
 = minor;

444 
poŞ
->
mbulk_Œack”
 = (mbulk_Œack” *)
	`vm®loc
ÕoŞ->
tÙ_£g_num
 * (mbulk_tracker));

446 ià(
poŞ
->
mbulk_Œack”
 =ğ
NULL
)

447  -
EIO
;

450 
	}
}

452 
	$mbulk_poŞ_»move
(
u8
 
poŞ_id
)

454 
mbulk_poŞ
 *
poŞ
;

456 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

457 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

461 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

464 
	`vä“
(
poŞ
->
mbulk_Œack”
);

466 
poŞ
->
mbulk_Œack”
 = 
NULL
;

467 
	}
}

472 
	$mbulk_poŞ_dump
(
u8
 
poŞ_id
, 
max_út
)

474 
mbulk_poŞ
 *
poŞ
;

475 
mbulk
 *
m
;

476 
út
 = 
max_út
;

478 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

479 
m
 = 
poŞ
->
ä“_li¡
;

480 
m
 !ğ
NULL
 && 
út
--)

481 
m
 = (m->
Ãxt_off£t
 =ğ0è? 
NULL
 :

482 (
mbulk
 *)(
poŞ
->
ba£_addr
 + 
m
->
Ãxt_off£t
);

483 
	}
}

488 
	$mbulk_ä“_vœt_ho¡
(
mbulk
 *
m
)

490 
u8
 
poŞ_id
;

491 
mbulk_poŞ
 *
poŞ
;

493 ià(
m
 =ğ
NULL
)

496 
poŞ_id
 = 
m
->
pid
 & 0x1;

498 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

500 ià(!
poŞ
->
v®id
) {

501 
	`WARN_ON
(!
poŞ
->
v®id
);

506 
	`mbulk_poŞ_put
(
poŞ
, 
m
);

507 
	}
}

509 
mbulk_Ën_t
 
	$mbulk_poŞ_£g_size
(
u8
 
poŞ_id
)

511  
mbulk_poŞs
[
poŞ_id
].
£g_size
;

512 
	}
}

	@mbulk.h

7 #iâdeà
__MBULK_H__


8 
	#__MBULK_H__


	)

50 
	gmbulk
;

62 
u32
 
	tmbulk_cŞour
;

64 #iâdeà
CONFIG_SCSC_WLAN_TX_API


65 
	#SLSI_MBULK_COLOUR_SET
(
cŞour
, 
vif
, 
³”_šdex
, 
ac_q
è(cŞou¸ğ×c_q << 16è| (³”_šdex << 8è| (vif))

	)

67 
	#SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
è(cŞou¸& 0xFF)

	)

68 
	#SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
è((cŞou¸>> 8è& 0xFF)

	)

69 
	#SLSI_MBULK_COLOUR_GET_AC
(
cŞour
è((cŞou¸>> 16è& 0xFF)

	)

74 
	#MBULK_POOL_ID_DATA
 (0)

	)

75 
	#MBULK_POOL_ID_CTRL
 (1)

	)

76 
	#MBULK_POOL_ID_MAX
 (2)

	)

84 
	embulk_şass
 {

85 
	mMBULK_CLASS_CONTROL
 = 0,

86 
	mMBULK_CLASS_HOSTIO
 = 1,

87 
	mMBULK_CLASS_DEBUG
 = 2,

88 
	mMBULK_CLASS_DEBUG_CRIT
 = 3,

90 
	mMBULK_CLASS_FROM_HOST_DAT
 = 4,

91 
	mMBULK_CLASS_FROM_HOST_CTL
 = 5,

92 
	mMBULK_CLASS_FROM_RADIO
 = 6,

93 
	mMBULK_CLASS_DPLP
 = 7,

94 
	mMBULK_CLASS_OTHERS
 = 8,

95 
	mMBULK_CLASS_FROM_RADIO_FORWARDED
 = 9,

96 
	mMBULK_CLASS_MAX


97 } 
	g__·cked
;

107 
	~"mbulk_def.h
"

120 
šlše
 
	$mbulk_»fút
(cÚ¡ 
mbulk
 *
m
)

122  
	`MBULK_SEG_REFCNT
(
m
);

123 
	}
}

129 
šlše
 
	$mbulk_bufãr_size
(cÚ¡ 
mbulk
 *
m
)

131  
	`MBULK_SEG_DAT_BUFSIZE
(
m
);

132 
	}
}

138 
šlše
 
boŞ
 
	$mbulk_has_sigÇl
(cÚ¡ 
mbulk
 *
m
)

140  
	`MBULK_SEG_HAS_SIGNAL
(
m
);

141 
	}
}

146 
šlše
 
	$mbulk_£t_»adÚly
(
mbulk
 *
m
)

148 
	`MBULK_SEG_SET_READONLY
(
m
);

149 
	}
}

154 
šlše
 
boŞ
 
	$mbulk_is_»adÚly
(cÚ¡ 
mbulk
 *
m
)

156  
	`MBULK_SEG_IS_READONLY
(
m
);

157 
	}
}

163 
šlše
 
boŞ
 
	$mbulk_is_sg
(cÚ¡ 
mbulk
 *
m
)

165  
	`MBULK_SEG_IS_CHAIN_HEAD
(
m
);

166 
	}
}

172 
šlše
 
boŞ
 
	$mbulk_is_chašed
(cÚ¡ 
mbulk
 *
m
)

174  
	`MBULK_SEG_IS_CHAINED
(
m
);

175 
	}
}

186 
mbulk
 *
mbulk_w™h_sigÇl_®loc
(
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
,

187 
size_t
 
d©_bufsz
);

195 
mbulk
 *
mbulk_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
, 
mbulk_cŞour
 
cŞour
,

196 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
);

203 
mbulk_poŞ_g‘_ä“_couÁ
(
u8
 
poŞ_id
);

213 
šlše
 *
	$mbulk_g‘_£g
(cÚ¡ 
mbulk
 *
m
)

215  (*)
	`MBULK_SEG_B
(
m
);

216 
	}
}

225 
šlše
 *
	$mbulk_g‘_sigÇl
(cÚ¡ 
mbulk
 *
m
)

227 
boŞ
 
»t
 = 
çl£
;

229 
»t
 = 
	`mbulk_has_sigÇl
(
m
);

231  
»t
 ? 
	`mbulk_g‘_£g
(
m
è: 
NULL
;

232 
	}
}

243 
šlše
 
mbulk
 *
	$mbulk_®loc
(
mbulk_şass
 
şas
, 
size_t
 
d©_bufsz
)

245  
	`mbulk_w™h_sigÇl_®loc
(
şas
, 0, 
d©_bufsz
);

246 
	}
}

255 
šlše
 
	$mbulk_ä“
(
mbulk
 *
m
)

257 
	`mbulk_£g_ä“
(
m
);

258 
	}
}

269 
šlše
 *
	$mbulk_d©_rw
(cÚ¡ 
mbulk
 *
m
)

271 
	`WARN_ON
(
	`MBULK_SEG_IS_READONLY
(
m
));

272  
	`MBULK_SEG_DAT
(
m
);

273 
	}
}

284 
šlše
 cÚ¡ *
	$mbulk_d©_r
(cÚ¡ 
mbulk
 *
m
)

286  (cÚ¡ *)
	`MBULK_SEG_DAT
(
m
);

287 
	}
}

293 
šlše
 *
	$mbulk_d©_©_rw
(cÚ¡ 
mbulk
 *
m
, 
size_t
 
off
)

295 
	`WARN_ON
(
	`MBULK_SEG_IS_READONLY
(
m
));

296  
	`MBULK_SEG_DAT_AT
(
m
, 
off
);

297 
	}
}

303 
šlše
 *
	$mbulk_d©_©_r
(cÚ¡ 
mbulk
 *
m
, 
size_t
 
off
)

305  ( *)
	`MBULK_SEG_DAT_AT
(
m
, 
off
);

306 
	}
}

312 
šlše
 
size_t
 
	$mbulk_’
(cÚ¡ 
mbulk
 *
m
)

314  
	`MBULK_SEG_LEN
(
m
);

315 
	}
}

321 
šlše
 
size_t
 
	$mbulk_h—droom
(cÚ¡ 
mbulk
 *
m
)

323  
	`MBULK_SEG_HEADROOM
(
m
);

324 
	}
}

326 
šlše
 
size_t
 
	$mbulk_room
(cÚ¡ 
mbulk
 *
m
)

328  
	`MBULK_SEG_TAILROOM
(
m
);

329 
	}
}

338 
šlše
 
boŞ
 
	$mbulk_»£rve_h—d
(
mbulk
 *
m
, 
size_t
 
h—droom
)

340  
	`mbulk_£g_»£rve_h—d
(
m
, 
h—droom
);

341 
	}
}

350 
šlše
 
boŞ
 
	$mbulk_adju¡_¿nge
(
mbulk
 *
m
, 
size_t
 
h—droom
, size_ˆ
Ën
)

352  
	`mbulk_£g_adju¡_¿nge
(
m
, 
h—droom
, 
Ën
);

353 
	}
}

362 
šlše
 
boŞ
 
	$mbulk_´•’d_h—d
(
mbulk
 *
m
, 
size_t
 
mÜe
)

364  
	`mbulk_£g_´•’d_h—d
(
m
, 
mÜe
);

365 
	}
}

373 
šlše
 
boŞ
 
	$mbulk_­³nd_
(
mbulk
 *
m
, 
size_t
 
mÜe
)

375  
	`mbulk_£g_­³nd_
(
m
, 
mÜe
);

376 
	}
}

385 
šlše
 
boŞ
 
	$mbulk_Œim_h—d
(
mbulk
 *
m
, 
size_t
 
Ëss
)

387  
	`mbulk_£g_Œim_h—d
(
m
, 
Ëss
);

388 
	}
}

396 
šlše
 
boŞ
 
	$mbulk_Œim_
(
mbulk
 *
m
, 
size_t
 
Ëss
)

398  
	`mbulk_£g_Œim_
(
m
, 
Ëss
);

399 
	}
}

408 
šlše
 
mbulk
 *
	$mbulk_du¶iÿ‹
(
mbulk
 *
m
)

410  
	`mbulk_£g_du¶iÿ‹
(
m
);

411 
	}
}

420 
šlše
 
mbulk
 *
	$mbulk_şÚe
(cÚ¡ 
mbulk
 *
m
, 
mbulk_şass
 
şas
,

421 
boŞ
 
cİy_sig
)

423  
	`mbulk_£g_şÚe
(
m
, 
şas
, 
cİy_sig
);

424 
	}
}

430 *
msigÇl_®loc
(
size_t
 
sig_sz
);

436 
msigÇl_ä“
(*
sig
);

442 
mbulk
 *
msigÇl_to_mbulk
(*
sig
);

447 
šlše
 
scsc_miäam_»f
 
	$mbulk_chaš_Ãxt
(
mbulk
 *
m
)

449  
	`MBULK_SEG_CHAIN_NEXT
(
m
);

450 
	}
}

452 #ifdeà
MBULK_SUPPORT_SG_CHAIN


462 
mbulk
 *
mbulk_chaš_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
,

463 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
);

468 
mbulk_chaš_ä“
(
mbulk
 *
sg
);

474 
mbulk
 *
mbulk_chaš_
(mbulk *
m
);

480 
size_t
 
mbulk_chaš_bufsz
(
mbulk
 *
m
);

486 
size_t
 
mbulk_chaš_’
(
mbulk
 *
m
);

491 
šlše
 
	$mbulk_chaš_num
(cÚ¡ 
mbulk
 *
m
)

493 ià(
	`mbulk_is_sg
(
m
)) {

494 
n
 = 0;

496 
m
 !ğ
NULL
) {

497 
n
++;

498 
m
 = m->
chaš_Ãxt
;

500  
n
;

503 
	}
}

506 *
mbulk_chaš_acûss
(
mbulk
 *
m
, 
size_t
 
off
, *
loÿl_buf
, size_ˆ
loÿl_bufsz
);

507 *
mbulk_chaš_wr™eback
(
mbulk
 *
m
, 
size_t
 
off
, *
loÿl_buf
, size_ˆ
loÿl_bufsz
);

508 *
mbulk_chaš_cİy_äom
(
mbulk
 *
m
, 
size_t
 
off
, *
buf
, 
Ën
);

509 *
mbulk_chaš_cİy_to
(
mbulk
 *
m
, 
size_t
 
off
, *
buf
, 
Ën
);

516 
š™_mbulk
(*
mem
, 
size_t
 
poŞ_size
);

522 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


523 
mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
£g_size
, u8 
gu¬d
, 
mšÜ
);

525 
mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
buf_size
, u8 
gu¬d
);

528 
mbulk_poŞ_»move
(
u8
 
poŞ_id
);

532 
mbulk_poŞ_check_§n™y
(
u8
 
poŞ_id
);

537 
mbulk_£t_hªdËr_»tuº_ho¡_mbulk
((*
ä“_ho¡_buf
)(
mbulk
 *
m
));

542 
	`mbulk_ä“_vœt_ho¡
(
mbulk
 *
m
);

543 
	`mbulk_poŞ_dump
(
u8
 
poŞ_id
, 
max_út
);

545 
mbulk_cŞour
 
	`mbulk_g‘_cŞour
(
u8
 
poŞ_id
, 
mbulk
 *
m
);

547 
u16
 
	`mbulk_poŞ_£g_size
(
u8
 
poŞ_id
);

	@mbulk_def.h

7 #iâdeà
__MBULK_DEF_H__


8 
	#__MBULK_DEF_H__


	)

10 
	~<lšux/bug.h
>

11 
	~<scsc/scsc_miäam.h
>

22 
	#MBULK_SIG_BUFSZ_ROUNDUP
(
sig_bufsz
è
	`round_up
(sig_bufsz, 4)

	)

44 
u16
 
	tmbulk_Ën_t
;

45 
	smbulk
 {

46 
scsc_miäam_»f
 
	mÃxt_off£t
;

47 
u8
 
	mæag
;

48 
mbulk_şass
 
	mşas
;

49 
u8
 
	mpid
;

50 
u8
 
	m»fút
;

51 
mbulk_Ën_t
 
	md©_bufsz
;

52 
mbulk_Ën_t
 
	msig_bufsz
;

53 
mbulk_Ën_t
 
	mËn
;

54 
mbulk_Ën_t
 
	mh—d
;

55 
scsc_miäam_»f
 
	mchaš_Ãxt_off£t
;

56 } 
	g__·cked
;

59 
	#MBULK_F_SIG
 (1 << 0è

	)

60 
	#MBULK_F_READONLY
 (1 << 1è

	)

61 
	#MBULK_F_OBOUND
 (1 << 2è

	)

62 
	#MBULK_F_WAKEUP
 (1 << 3è

	)

63 
	#MBULK_F_SMAPPER
 (1 << 4è

	)

64 
	#MBULK_F_FREE
 (1 << 5è

	)

65 
	#MBULK_F_CHAIN_HEAD
 (1 << 6è

	)

66 
	#MBULK_F_CHAIN
 (1 << 7è

	)

69 
	#MBULK_MAX_CHAIN
 16

	)

71 
	#MBULK_SEG_B
(
m
è((
ušŒ_t
)(mè+ (
mbulk
))

	)

74 
	#MBULK_SEG_RAW_BUFSZ
(
m
è((
mbulk
è+ (m)->
sig_bufsz
 + (m)->
d©_bufsz
)

	)

77 
	#MBULK_SEG_NEXT
(
m
è((m)->
Ãxt_off£t
)

	)

78 
	#MBULK_SEG_REFCNT
(
m
è((m)->
»fút
)

	)

79 
	#MBULK_SEG_HAS_SIGNAL
(
m
è((m)->
æag
 & 
MBULK_F_SIG
)

	)

80 
	#MBULK_SEG_CHAIN_NEXT
(
m
è((m)->
chaš_Ãxt_off£t
)

	)

81 
	#MBULK_SEG_IS_CHAIN_HEAD
(
m
è((m)->
æag
 & 
MBULK_F_CHAIN_HEAD
)

	)

82 
	#MBULK_SEG_IS_CHAINED
(
m
è((m)->
æag
 & 
MBULK_F_CHAIN
)

	)

84 
	#MBULK_SEG_IS_READONLY
(
m
è((m)->
æag
 & 
MBULK_F_READONLY
)

	)

85 
	#MBULK_SEG_SET_READONLY
(
m
è((m)->
æag
 |ğ
MBULK_F_READONLY
)

	)

87 
	#MBULK_SEG_DAT
(
m
è((*)
	`MBULK_SEG_B
(mè+ (m)->
h—d
)

	)

88 
	#MBULK_SEG_DAT_AT
(
m
, 
off
è((*)
	`MBULK_SEG_B
(mè+ (m)->
h—d
 + (
mbulk_Ën_t
)(off))

	)

89 
	#MBULK_SEG_DAT_BUFSIZE
(
m
è((
size_t
)((m)->
d©_bufsz
))

	)

90 
	#MBULK_SEG_SIG_BUFSIZE
(
m
è((
size_t
)((m)->
sig_bufsz
))

	)

91 
	#MBULK_SEG_LEN
(
m
è((m)->
Ën
)

	)

92 
	#MBULK_SEG_HEADROOM
(
m
è((
size_t
)((m)->
h—d
 - (m)->
sig_bufsz
))

	)

93 
	#MBULK_SEG_TAILROOM
(
m
è((
size_t
)((m)->
d©_bufsz
 - (
	`MBULK_SEG_HEADROOM
(mè+ (m)->
Ën
)))

	)

95 
šlše
 
boŞ
 
	$mbulk_£g_»£rve_h—d
(
mbulk
 *
m
, 
size_t
 
h—droom
)

97 ià(
	`WARN_ON
(!(
m
->
d©_bufsz
 >ğ
h—droom
)))

98  
çl£
;

99 
m
->
h—d
 +ğ(
mbulk_Ën_t
)
h—droom
;

100  
Œue
;

101 
	}
}

103 
šlše
 
boŞ
 
	$mbulk_£g_adju¡_¿nge
(
mbulk
 *
m
, 
size_t
 
h—droom
,

104 
size_t
 
Ën
)

106 ià(
	`WARN_ON
(!(
m
->
d©_bufsz
 >ğ(
h—droom
 + 
Ën
))))

107  
çl£
;

108 
m
->
h—d
 = m->
sig_bufsz
 + (
mbulk_Ën_t
)
h—droom
;

109 
m
->
Ën
 = (
mbulk_Ën_t
)len;

110  
Œue
;

111 
	}
}

113 
šlše
 
boŞ
 
	$mbulk_£g_´•’d_h—d
(
mbulk
 *
m
, 
size_t
 
mÜe
)

115 ià(
	`WARN_ON
(!(
	`MBULK_SEG_HEADROOM
(
m
è>ğ
mÜe
)))

116  
çl£
;

117 
m
->
h—d
 -ğ(
mbulk_Ën_t
)
mÜe
;

118 
m
->
Ën
 +ğ(
mbulk_Ën_t
)
mÜe
;

119  
Œue
;

120 
	}
}

122 
šlše
 
boŞ
 
	$mbulk_£g_­³nd_
(
mbulk
 *
m
, 
size_t
 
mÜe
)

124 ià(
	`WARN_ON
(!(
	`MBULK_SEG_TAILROOM
(
m
è>ğ
mÜe
)))

125  
çl£
;

126 
m
->
Ën
 +ğ(
mbulk_Ën_t
)
mÜe
;

127  
Œue
;

128 
	}
}

130 
šlše
 
boŞ
 
	$mbulk_£g_Œim_h—d
(
mbulk
 *
m
, 
size_t
 
Ëss
)

132 
m
->
h—d
 +ğ(
mbulk_Ën_t
)
Ëss
;

133 
m
->
Ën
 = (m->ËÀ<ğ(
mbulk_Ën_t
)
Ëss
) ? 0 : (m->len - (mbulk_len_t)less);

134  
Œue
;

135 
	}
}

137 
šlše
 
boŞ
 
	$mbulk_£g_Œim_
(
mbulk
 *
m
, 
size_t
 
Ëss
)

139 ià(
	`WARN_ON
(!(
m
->
Ën
 >ğ(
mbulk_Ën_t
)
Ëss
)))

140  
çl£
;

141 
m
->
Ën
 -ğ(
mbulk_Ën_t
)
Ëss
;

142  
Œue
;

143 
	}
}

152 
mbulk_£g_ä“
(
mbulk
 *
m
);

161 
mbulk
 *
mbulk_£g_du¶iÿ‹
(mbulk *
m
);

170 
mbulk
 *
mbulk_£g_şÚe
(cÚ¡ mbulk *
m
, 
mbulk_şass
 
şas
, 
boŞ
 
cİy_sig
);

	@mgt.c

7 
	~<lšux/d–ay.h
>

8 
	~<lšux/fœmw¬e.h
>

9 
	~<scsc/kic/¦si_kic_lib.h
>

10 
	~<lšux/fs.h
>

11 #ià
defšed
(
CONFIG_ARCH_EXYNOS
è|| defšed(
CONFIG_ARCH_EXYNOS9
)

12 
	~<lšux/soc/§msung/exynos-soc.h
>

15 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


16 
	~<lšux/if_‘h”.h
>

17 
	~<lšux/š.h
>

20 
	~<scsc/scsc_mx.h
>

21 
	~<scsc/scsc_»Ëa£.h
>

22 
	~"mgt.h
"

23 
	~"ioùl.h
"

24 
	~"debug.h
"

25 
	~"mlme.h
"

26 
	~"Ãtif.h
"

27 
	~"uts.h
"

28 
	~"udi.h
"

29 
	~"log_ş›Ás.h
"

30 
	~"log2us.h
"

31 
	~"dev.h
"

32 
	~"uts.h
"

33 #ifdeà
SLSI_TEST_DEV


34 
	~"un™‹¡.h
"

36 
	~"h.h
"

37 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

38 
	~<scsc/scsc_log_cŞËùÜ.h
>

41 
	~"´ocfs.h
"

42 
	~"mib.h
"

43 
	~"unifiio.h
"

44 
	~"ba.h
"

45 #iâdeà
CONFIG_SCSC_WLAN_TX_API


46 
	~"scsc_wifi_fcq.h
"

48 
	~"ÿc.h
"

49 
	~"cfg80211_İs.h
"

50 
	~"Æ80211_v’dÜ.h
"

53 #ifdeà
CONFIG_SCSC_WLBTD


54 
	~"../../../misc/§msung/scsc/scsc_wlbtd.h
"

56 #ià
defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

58 
	~"hªged_»cÜd.h
"

61 #ifdeà
CONFIG_SCSC_WLAN_TX_API


62 
	~"tx_­i.h
"

65 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

66 
	~"scsc_wÏn_mm­.h
"

69 
	#SLSI_MODE_HE
 
	`BIT
(2)

	)

70 
	#SLSI_MODE_VHT
 
	`BIT
(1)

	)

71 
	#SLSI_MODE_LEGACY_HT
 
	`BIT
(0)

	)

72 
	#SLSI_2_4_BAND_SUPPORT
 
	`BIT
(0)

	)

73 
	#SLSI_5_BAND_SUPPORT
 
	`BIT
(1)

	)

74 
	#SLSI_6_BAND_SUPPORT
 
	`BIT
(2)

	)

76 
	~"qsfs.h
"

78 
	#CSR_WIFI_SME_MIB2_HOST_PSID_MASK
 0x8000

	)

79 
	#MX_WLAN_FILE_PATH_LEN_MAX
 (128)

	)

80 
	#SLSI_MIB_REG_RULES_MAX
 (50)

	)

81 
	#SLSI_MIB_MAX_CLIENT
 (10)

	)

82 
	#SLSI_REG_PARAM_START_INDEX
 (1)

	)

84 
	#HOST_REASONCODE_RECOVERY_REASON
 111

	)

87 
	#FAPI_SCANMODE_LOW_LATENCY_2
 0x0002

	)

88 
	#FAPI_SCANMODE_LOW_LATENCY_3
 0x0003

	)

90 
	#SLSI_ANTENNA_NOT_SET
 (0xff)

	)

92 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0)

93 
MODULE_IMPORT_NS
(
VFS_š‹º®_I_am_»®ly_a_fesy¡em_ªd_am_NOT_a_driv”
);

96 *
	gmib_fe_t
 = "wlan_t.hcf";

97 
moduË_·¿m
(
mib_fe_t
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

98 
MODULE_PARM_DESC
(
mib_fe_t
, "mib data filename");

100 *
	gmib_fe2_t
 = "wlan_t_sw.hcf";

101 
moduË_·¿m
(
mib_fe2_t
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

102 
MODULE_PARM_DESC
(
mib_fe2_t
, "mib data filename");

104 
boŞ
 
	gloÿl_mib_š_d¿m
;

105 
moduË_·¿m
(
loÿl_mib_š_d¿m
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

106 
MODULE_PARM_DESC
(
loÿl_mib_š_d¿m
, "localmib data in DRAM");

112 
	gmac_addr_ov”ride
[] = "ff:ff:ff:ff:ff:ff";

113 
moduË_·¿m_¡ršg
(
mac_addr
, 
mac_addr_ov”ride
, (mac_addr_ov”ride), 
S_IRUGO
 | 
S_IWUSR
);

114 
MODULE_PARM_DESC
(
mac_addr_ov”ride
, "WLAN MAC‡ddress override");

116 
boŞ
 
	gEÇbËRfTe¡Mode
;

117 
moduË_·¿m
(
EÇbËRfTe¡Mode
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

118 
MODULE_PARM_DESC
(
EÇbËRfTe¡Mode
, "Enable RFest mode driver.");

120 
¦si_mib_İ’_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
, cÚ¡ 
fœmw¬e
 **
fw
);

121 
¦si_mib_şo£_fe
(
¦si_dev
 *
sdev
, cÚ¡ 
fœmw¬e
 *
e
);

122 
¦si_mib_dowÆßd_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
);

123 
¦si_couÁry_to_šdex
(
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
);

124 
¦si_mib_š™Ÿl_g‘
(
¦si_dev
 *
sdev
);

125 
	g¦si_hªged_ev’t_couÁ
;

126 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


127 
	#SLSI_MAX_CHAN_5G_BAND
 25

	)

128 
	#SLSI_2G_CHANNEL_ONE
 2412

	)

132 
ssize_t
 
sysfs_show_maÿddr
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

133 *
buf
);

134 
ssize_t
 
sysfs_¡Üe_maÿddr
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

135 cÚ¡ *
buf
, 
size_t
 
couÁ
);

136 
ssize_t
 
sysfs_show_v”siÚ_šfo
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

137 *
buf
);

138 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

140 
ssize_t
 
sysfs_show_debugdump
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

141 *
buf
);

142 
ssize_t
 
sysfs_¡Üe_debugdump
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

143 cÚ¡ *
buf
, 
size_t
 
couÁ
);

146 
ssize_t
 
sysfs_show_pm
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
, *
buf
);

147 
ssize_t
 
sysfs_¡Üe_pm
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

148 cÚ¡ *
buf
, 
size_t
 
couÁ
);

149 
ssize_t
 
sysfs_show_ªt
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
, *
buf
);

150 
ssize_t
 
sysfs_¡Üe_ªt
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

151 cÚ¡ *
buf
, 
size_t
 
couÁ
);

153 
kobjeù
 *
	gwifi_kobj_»f
;

154 
	gsysfs_mac_ov”ride
[] = "ff:ff:ff:ff:ff:ff";

155 
u16
 
	gsysfs_ª‹Âa
 = 
SLSI_ANTENNA_NOT_SET
;

156 
kobj_©Œibu‹
 
	gmac_©Œ
 = 
__ATTR
(
mac_addr
, 0660, 
sysfs_show_maÿddr
, 
sysfs_¡Üe_maÿddr
);

157 
kobj_©Œibu‹
 
	gpm_©Œ
 = 
__ATTR
(
pm
, 0660, 
sysfs_show_pm
, 
sysfs_¡Üe_pm
);

158 
kobj_©Œibu‹
 
	gªt_©Œ
 = 
__ATTR
(
ªt
, 0660, 
sysfs_show_ªt
, 
sysfs_¡Üe_ªt
);

159 
kobj_©Œibu‹
 
	gv”_©Œ
 = 
__ATTR
(
wifiv”
, 0660, 
sysfs_show_v”siÚ_šfo
, 
NULL
);

160 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

161 
	gdump_š_´og»ss
;

162 
kobj_©Œibu‹
 
	gdump_©Œ
 = 
__ATTR
(
dump_š_´og»ss
, 0660, 
sysfs_show_debugdump
, 
sysfs_¡Üe_debugdump
);

166 
ssize_t
 
	$sysfs_show_maÿddr
(
kobjeù
 *
kobj
,

167 
kobj_©Œibu‹
 *
©Œ
,

168 *
buf
)

170  
	`¢´štf
(
buf
, (
sysfs_mac_ov”ride
), "%s", sysfs_mac_override);

171 
	}
}

174 
ssize_t
 
	$sysfs_¡Üe_maÿddr
(
kobjeù
 *
kobj
,

175 
kobj_©Œibu‹
 *
©Œ
,

176 cÚ¡ *
buf
,

177 
size_t
 
couÁ
)

179 
r
;

181 
	`SLSI_INFO_NODEV
("Ov”ridWLAN MAC‡dd»s %s\n", 
buf
);

184 
r
 = 
	`ssÿnf
(
buf
, "%17s", (*)&
sysfs_mac_ov”ride
);

185  (
r
 > 0è? 
couÁ
 : 0;

186 
	}
}

189 
	$¦si_ü—‹_sysfs_maÿddr
()

191 #iâdeà
SLSI_TEST_DEV


192 
r
;

194 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

195 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

197 ià(
wifi_kobj_»f
) {

199 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
mac_©Œ
.
©Œ
);

200 ià(
r
) {

202 
	`´_”r
("Can't create /sys/wifi/mac_addr\n");

206 
	`´_”r
("failedo create /sys/wifi/mac_addr\n");

209 
	}
}

212 
	$¦si_de¡roy_sysfs_maÿddr
()

214 ià(!
wifi_kobj_»f
)

218 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
mac_©Œ
.
©Œ
);

221 
	`mxmª_wifi_kobjeù_»f_put
();

222 
	}
}

225 
ssize_t
 
	$sysfs_show_v”siÚ_šfo
(
kobjeù
 *
kobj
,

226 
kobj_©Œibu‹
 *
©Œ
,

227 *
buf
)

229 
¦si_dev
 *
sdev
 = 
	`¦si_g‘_sdev
();

230 
bud_id_fw
[128] = {0};

231 
bud_id_drv
[64] = {0};

232 
buf_size
 = 512;

234 #iâdeà
SLSI_TEST_DEV


235 
	`mxmª_g‘_fw_v”siÚ
(
bud_id_fw
, 128);

236 
	`mxmª_g‘_driv”_v”siÚ
(
bud_id_drv
, 64);

239  
	`¢´štf
(
buf
, 
buf_size
,

245 
bud_id_drv
, 
bud_id_fw
, 
sdev
->
mib
[0].
¶©fÜm
, sdev->mib[1].platform,

246 (
sdev
->
»g_dom_v”siÚ
 >> 16) & 0xFF, (sdev->reg_dom_version >> 8) & 0xFF,

247 
sdev
->
»g_dom_v”siÚ
 & 0xFF);

248 
	}
}

251 
	$¦si_ü—‹_sysfs_v”siÚ_šfo
()

253 #iâdeà
SLSI_TEST_DEV


254 
r
;

256 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

257 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

259 ià(
wifi_kobj_»f
) {

261 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
v”_©Œ
.
©Œ
);

262 ià(
r
) {

264 
	`´_”r
("Can't create /sys/wifi/wifiver\n");

268 
	`´_”r
("failedo create /sys/wifi/wifiver\n");

271 
	}
}

274 
	$¦si_de¡roy_sysfs_v”siÚ_šfo
()

276 ià(!
wifi_kobj_»f
)

280 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
v”_©Œ
.
©Œ
);

283 
	`mxmª_wifi_kobjeù_»f_put
();

284 
	}
}

286 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

288 
ssize_t
 
	$sysfs_show_debugdump
(
kobjeù
 *
kobj
,

289 
kobj_©Œibu‹
 *
©Œ
,

290 *
buf
)

292  
	`¥rštf
(
buf
, "%d\n", 
dump_š_´og»ss
);

293 
	}
}

296 
ssize_t
 
	$sysfs_¡Üe_debugdump
(
kobjeù
 *
kobj
,

297 
kobj_©Œibu‹
 *
©Œ
,

298 cÚ¡ *
buf
,

299 
size_t
 
couÁ
)

301 
r
;

302 
¦si_dev
 *
sdev
 = 
	`¦si_g‘_sdev
();

304 
r
 = 
	`k¡¹ošt
(
buf
, 10, &
dump_š_´og»ss
);

305 ià(
r
 < 0)

306 
dump_š_´og»ss
 = 0;

308 
	`SLSI_INFO_NODEV
("dump_š_´og»ss: %d\n", 
dump_š_´og»ss
);

310 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
ch£t_loggšg_wÜk
);

311  (
r
 =ğ0è? 
couÁ
 : 0;

312 
	}
}

315 
	$¦si_ü—‹_sysfs_debug_dump
()

317 
r
;

319 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

320 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

322 ià(
wifi_kobj_»f
) {

324 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
dump_©Œ
.
©Œ
);

325 ià(
r
) {

327 
	`´_”r
("Can't create /sys/wifi/dump_in_progress\n");

328 
	`mxmª_wifi_kobjeù_»f_put
();

332 
	`´_”r
("failedo create /sys/wifi/dump_in_progress\n");

334 
	}
}

337 
	$¦si_de¡roy_sysfs_debug_dump
()

339 ià(!
wifi_kobj_»f
)

343 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
dump_©Œ
.
©Œ
);

346 
	`mxmª_wifi_kobjeù_»f_put
();

347 
	}
}

350 
	$¦si_purge_sÿn_»suÉs_locked
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

352 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
;

353 
¦si_sÿn_»suÉ
 *
´ev
 = 
NULL
;

355 
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

356 
sÿn_»suÉ
) {

357 
	`kä“_skb
(
sÿn_»suÉ
->
b—cÚ
);

358 
	`kä“_skb
(
sÿn_»suÉ
->
´obe_»¥
);

359 
´ev
 = 
sÿn_»suÉ
;

360 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

361 
	`kä“
(
´ev
);

363 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
 = 
NULL
;

364 
	}
}

366 
	$¦si_purge_sÿn_»suÉs
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

368 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

369 
	`¦si_purge_sÿn_»suÉs_locked
(
ndev_vif
, 
sÿn_id
);

370 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

371 
	}
}

373 
	$¦si_purge_bÏckli¡
(
Ãtdev_vif
 *
ndev_vif
)

375 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

377 
	`kä“
(
ndev_vif
->
aş_d©a_suµliÿÁ
);

378 
ndev_vif
->
aş_d©a_suµliÿÁ
 = 
NULL
;

380 
	`kä“
(
ndev_vif
->
aş_d©a_h®
);

381 
ndev_vif
->
aş_d©a_h®
 = 
NULL
;

383 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

384 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

385 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

387 
	`li¡_d–
(
bÏckli¡_pos
);

388 
	`kä“
(
bÏckli¡_šfo
);

390 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_fw_li¡
);

392 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

393 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

394 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

396 
	`li¡_d–
(
bÏckli¡_pos
);

397 
	`kä“
(
bÏckli¡_šfo
);

399 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_ioùl_li¡
);

400 
	}
}

402 
sk_buff
 *
	$¦si_dequeue_ÿched_sÿn_»suÉ
(
¦si_sÿn
 *
sÿn
, *
couÁ
)

404 
sk_buff
 *
skb
 = 
NULL
;

405 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
 = 
sÿn
->
sÿn_»suÉs
;

407 ià(
sÿn_»suÉ
) {

408 ià(
sÿn_»suÉ
->
b—cÚ
) {

409 
skb
 = 
sÿn_»suÉ
->
b—cÚ
;

410 
sÿn_»suÉ
->
b—cÚ
 = 
NULL
;

411 } ià(
sÿn_»suÉ
->
´obe_»¥
) {

412 
skb
 = 
sÿn_»suÉ
->
´obe_»¥
;

413 
sÿn_»suÉ
->
´obe_»¥
 = 
NULL
;

415 
	`SLSI_ERR_NODEV
("Scanƒntry with‚o beacon /probe„esp!!\n");

419 ià(!
sÿn_»suÉ
->
b—cÚ
 && !sÿn_»suÉ->
´obe_»¥
) {

420 
sÿn
->
sÿn_»suÉs
 = 
sÿn_»suÉ
->
Ãxt
;

421 
	`kä“
(
sÿn_»suÉ
);

422 ià(
couÁ
)

423 (*
couÁ
)++;

426  
skb
;

427 
	}
}

429 
	$¦si_g‘_hw_mac_add»ss
(
¦si_dev
 *
sdev
, 
u8
 *
addr
)

431 #iâdeà
SLSI_TEST_DEV


432 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

433 
i
;

434 
u32
 
u
[
ETH_ALEN
];

435 
·th_Çme
[
MX_WLAN_FILE_PATH_LEN_MAX
];

436 
r
;

437 
boŞ
 
v®id
 = 
çl£
;

440 
r
 = 
	`ssÿnf
(
mac_addr_ov”ride
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

441 ià(
r
 !ğ
ETH_ALEN
) {

442 
	`SLSI_ERR
(
sdev
, "mac_addr modparam set, but format is incorrect (should beƒ.g. xx:xx:xx:xx:xx:xx)\n");

443 
mac_sysfs
;

445 
i
 = 0; i < 
ETH_ALEN
; i++) {

446 ià(
u
[
i
] != 0xff)

447 
v®id
 = 
Œue
;

448 
addr
[
i
] = 
u
[i] & 0xff;

452 ià(
v®id
) {

453 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s äom mod·¿m: " 
MACSTR
 "\n", 
	`MAC2STR
(
u
));

458 
mac_sysfs
:

459 
r
 = 
	`ssÿnf
(
sysfs_mac_ov”ride
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

460 ià(
r
 !ğ
ETH_ALEN
) {

461 
	`SLSI_ERR
(
sdev
, "mac_addr in sysfs set, but format is incorrect (should beƒ.g. xx:xx:xx:xx:xx:xx)\n");

462 
mac_fe
;

464 
i
 = 0; i < 
ETH_ALEN
; i++) {

465 ià(
u
[
i
] != 0xff)

466 
v®id
 = 
Œue
;

467 
addr
[
i
] = 
u
[i] & 0xff;

471 ià(
v®id
) {

472 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s äom sysfs: " 
MACSTR
 "\n", 
	`MAC2STR
(
u
));

477 
mac_fe
:

478 ià(
sdev
->
maddr_fe_Çme
) {

479 
	`sú´štf
(
·th_Çme
, 
MX_WLAN_FILE_PATH_LEN_MAX
, "wÏn/%s", 
sdev
->
maddr_fe_Çme
);

480 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "MAC‡dd»s f: %s\n", 
·th_Çme
);

482 
r
 = 
	`mx140_fe_»que¡_deviû_cÚf
(
sdev
->
maxw–l_cÜe
, &
e
, 
·th_Çme
);

483 ià(
r
 != 0)

484 
mac_efs
;

486 ià(!
e
) {

487 
	`SLSI_ERR
(
sdev
, "mx140_file_request_device_conf()„eturned succes, but firmware was‚ull\n");

488 
mac_efs
;

490 
r
 = 
	`ssÿnf
(
e
->
d©a
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

491 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

492 ià(
r
 !ğ
ETH_ALEN
) {

493 
	`SLSI_ERR
(
sdev
, "% exi¡s, buˆfÜm© i šcÜ»ù (should be.g. xx:xx:xx:xx:xx:xx)\n", 
·th_Çme
);

494 
mac_efs
;

496 
i
 = 0; i < 
ETH_ALEN
; i++)

497 
addr
[
i
] = 
u
[i] & 0xff;

498 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s lßded from %s: " 
MACSTR
 "\n", 
·th_Çme
, 
	`MAC2STR
(
u
));

501 
mac_efs
:

502 #ifdeà
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME


503 
	`sú´štf
(
·th_Çme
, 
MX_WLAN_FILE_PATH_LEN_MAX
,

504 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

509 
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME
);

510 
r
 = 
	`mx140_»que¡_fe
(
sdev
->
maxw–l_cÜe
, 
·th_Çme
, &
e
);

511 ià(
r
 != 0)

512 
mac_deçuÉ
;

513 ià(!
e
) {

514 
	`SLSI_ERR
(
sdev
, "mx140_request_file()„eturned succes, but firmware was‚ull\n");

515 
mac_deçuÉ
;

517 
r
 = 
	`ssÿnf
(
e
->
d©a
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

518 ià(
r
 !ğ
ETH_ALEN
) {

519 
	`SLSI_ERR
(
sdev
, "%sƒxists, but format is incorrect (%d) [%20s] (should beƒ.g. xx:xx:xx:xx:xx:xx)\n",

520 
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME
, 
r
, 
e
->
d©a
);

521 
mac_deçuÉ
;

523 
i
 = 0; i < 
ETH_ALEN
; i++) {

524 ià(
u
[
i
] != 0xff)

525 
v®id
 = 
Œue
;

526 
addr
[
i
] = 
u
[i] & 0xff;

530 ià(
v®id
) {

531 #ifdeà
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME


532 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s lßded from %s: " 
MACSTR
 "\n",

533 
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME
, 
	`MAC2STR
(
u
));

536 ià(
addr
[0] & 0x01) {

537 
addr
[0] =‡ddr[0] & 0xfe;

538 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s šv®id, fixed‡dd»ss: " 
MACSTR
 "\n", 
	`MAC2STR
(
addr
));

540 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
e
);

543 
mac_deçuÉ
:

545 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

547 
	`SLSI_ETHER_COPY
(
addr
, 
SLSI_DEFAULT_HW_MAC_ADDR
);

548 #ià
	`defšed
(
CONFIG_ARCH_EXYNOS
è|| defšed(
CONFIG_ARCH_EXYNOS9
)

550 
addr
[3] = (
exynos_soc_šfo
.
unique_id
 & 0xFF0000000000) >> 40;

551 
addr
[4] = (
exynos_soc_šfo
.
unique_id
 & 0x00FF00000000) >> 32;

552 
addr
[5] = (
exynos_soc_šfo
.
unique_id
 & 0x0000FF000000) >> 24;

554 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
,

555 "MAC‡dd¸fNOT found, usšg deçuÉ MAC ADDR: %pM\n", 
addr
);

558 
¦si_‹¡_dev
 *
uáe¡dev
 = (¦si_‹¡_dev *)
sdev
->
maxw–l_cÜe
;

560 
	`SLSI_ETHER_COPY
(
addr
, 
uáe¡dev
->
hw_addr
);

561 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Te¡ Deviû Add»ss: %pM\n", 
addr
);

563 
	}
}

565 
	$wr™e_wifi_v”siÚ_šfo_fe
(
¦si_dev
 *
sdev
)

567 #ià
	`defšed
(
SCSC_SEP_VERSION
) && (SCSC_SEP_VERSION >= 9)

568 *
f•©h
 = "/data/vendor/conn/.wifiver.info";

570 *
f•©h
 = "/data/misc/conn/.wifiver.info";

572 
buf
[512];

573 
bud_id_fw
[128];

574 
bud_id_drv
[64];

577 #iâdeà
CONFIG_SCSC_WLBTD


578 
fe
 *
å
 = 
NULL
;

580 
å
 = 
	`fp_İ’
(
f•©h
, 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
, 0644);

582 ià(
	`IS_ERR
(
å
)) {

583 
	`SLSI_WARN
(
sdev
, "version file wasn't found\n");

585 } ià(!
å
) {

586 
	`SLSI_WARN
(
sdev
, "% dÛ¢'ˆexi¡.\n", 
f•©h
);

590 #iâdeà
SLSI_TEST_DEV


591 
	`mxmª_g‘_fw_v”siÚ
(
bud_id_fw
, 128);

592 
	`mxmª_g‘_driv”_v”siÚ
(
bud_id_drv
, 64);

603 #ià
	`defšed
(
SCSC_SEP_VERSION
) && (SCSC_SEP_VERSION >= 9)

605 
	`¢´štf
(
buf
, (buf),

611 
bud_id_drv
, 
bud_id_fw
, 
sdev
->
mib
[0].
¶©fÜm
, sdev->mib[1].platform,

612 (
sdev
->
»g_dom_v”siÚ
 >> 16) & 0xFF, (sdev->reg_dom_version >> 8) & 0xFF,

613 
sdev
->
»g_dom_v”siÚ
 & 0xFF);

616 
	`¢´štf
(
buf
, (buf), "% (f/w_v”: %s)\ÄegDom_v”: %d.%d.%d\n", 
bud_id_drv
, 
bud_id_fw
,

617 (
sdev
->
»g_dom_v”siÚ
 >> 16) & 0xFF, (sdev->reg_dom_version >> 8) & 0xFF,

618 
sdev
->
»g_dom_v”siÚ
 & 0xFF);

624 #ifdeà
SCSC_SEP_VERSION


625 #ifdeà
CONFIG_SCSC_WLBTD


626 
	`wlbtd_wr™e_fe
(
f•©h
, 
buf
);

628 
	`k”Ãl_wr™e
(
å
, 
buf
, 
	`¡¾’
(buf), 0);

629 ià(
å
)

630 
	`fp_şo£
(
å
, 
NULL
);

633 
	`SLSI_INFO
(
sdev
, "Succeedo write firmware/host informationo .wifiver.info\n");

635 
	`SLSI_UNUSED_PARAMETER
(
f•©h
);

637 
	}
}

639 
	$wr™e_m_‹¡_ch_v”siÚ_fe
(
¦si_dev
 *
sdev
)

641 #ifdeà
CONFIG_SCSC_WLBTD


642 *
f•©h
 = "/data/vendor/conn/.cid.info";

643 
buf
[256];

645 
	`¢´štf
(
buf
, (buf), "%s\n", 
SCSC_RELEASE_SOLUTION
);

647 
	`wlbtd_wr™e_fe
(
f•©h
, 
buf
);

649 
	`SLSI_WARN
(
sdev
, "Wrote chip informationo .cid.info\n");

651 
	}
}

653 #ifdeà
SCSC_SEP_VERSION


654 
	$wr™e_soá­_šfo_fe
(
¦si_dev
 *
sdev
)

656 
u32
 
off£t
 = 0;

657 
buf
[512];

658 #iâdeà
CONFIG_SCSC_WLBTD


659 
fe
 *
å
 = 
NULL
;

661 #ià
SCSC_SEP_VERSION
 >= 9

662 *
f•©h
 = "/data/vendor/conn/.softap.info";

664 *
f•©h
 = "/data/misc/conn/.softap.info";

666 
off£t
 = 
	`¢´štf
(
buf
 + offset, (buf), "#softap.info\n");

667 
off£t
 +ğ
	`¢´štf
(
buf
 + off£t, (buf), "Du®BªdCÚcu¼’cy=%s\n", 
sdev
->
du®bªd_cÚcu¼’cy
 ? "yes" : "no");

668 
off£t
 +ğ
	`¢´štf
(
buf
 + offset, (buf), "DualInterface=%s\n", "yes");

669 
off£t
 +ğ
	`¢´štf
(
buf
 + off£t, (buf), "5G=%s\n", 
sdev
->
bªd_5g_suµÜ‹d
 ? "yes" : "no");

670 
off£t
 +ğ
	`¢´štf
(
buf
 + off£t, (buf), "maxCl›Á=%d\n", !
sdev
->
soá­_max_ş›Á
 ? 
SLSI_MIB_MAX_CLIENT
 : sdev->softap_max_client);

673 
off£t
 +ğ
	`¢´štf
(
buf
 + offset, (buf), "HalFn_setCountryCodeHal=yes\n");

674 
off£t
 +ğ
	`¢´štf
(
buf
 + offset, (buf), "HalFn_getValidChannels=yes\n");

676 #ifdeà
CONFIG_SCSC_WLBTD


678 
	`wlbtd_wr™e_fe
(
f•©h
, 
buf
);

681 
å
 = 
	`fp_İ’
(
f•©h
, 
O_WRONLY
 | 
O_CREAT
, 0644);

683 ià(!
å
) {

684 
	`SLSI_WARN
(
sdev
, "% dÛ¢'ˆexi¡\n", 
f•©h
);

685 
buf
 = 
NULL
;

686 } ià(
	`IS_ERR
(
å
)) {

687 
	`SLSI_WARN
(
sdev
, "% İ’„‘uºedƒ¼Ü %d\n", 
f•©h
, 
	`IS_ERR
(
å
));

688 
buf
 = 
NULL
;

690 
	`k”Ãl_wr™e
(
å
, 
buf
, 
	`¡¾’
(buf), 0);

692 ià(
å
)

693 
	`fp_şo£
(
å
, 
NULL
);

695 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Succeedo write softap informationo .softap.info\n");

696 
	}
}

699 
	$¦si_¡¬t_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

701 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

702 
u8
 
deviû_add»ss
[
ETH_ALEN
] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};

704 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_MONITOR
;

706 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

707 
	`SLSI_NET_ERR
(
dev
, "add VIF for Monitor mode failed\n");

708 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

709  -
EINVAL
;

721 
dev
->
ty³
 = 
ARPHRD_IEEE80211_RADIOTAP
;

722 
ndev_vif
->
aùiv©ed
 = 
Œue
;

724 
	}
}

726 
	$¦si_¡İ_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

728 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

730 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

731 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "de-activate monitor VIF\n");

732 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

733 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

736 
dev
->
ty³
 = 
ARPHRD_ETHER
;

738 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

739 
	}
}

741 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

742 
	$¦si_hcf_cŞËù
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
, 
size_t
 
size
)

744 
¦si_dev
 *
sdev
 = (¦si_dev *)
cŞËù_ş›Á
->
´v
;

745 
»t
 = 0;

746 
u8
 
šdex
 = 
sdev
->
cŞËù_mib
.
num_fes
;

747 
u8
 
i
;

748 
u8
 *
d©a
;

750 
	`SLSI_INFO_NODEV
("Collecting WLAN HCF\n");

752 ià(!
sdev
->
cŞËù_mib
.
’abËd
)

753 
	`SLSI_INFO_NODEV
("Collection‚otƒnabled\n");

755 
	`¥š_lock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

756 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
(&
šdex
, (), 1);

757 ià(
»t
) {

758 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

759  
»t
;

762 
i
 = 0; i < 
šdex
; i++) {

763 
	`SLSI_INFO_NODEV
("CŞËùšg WLAN HCF. F%s\n", 
sdev
->
cŞËù_mib
.
fe
[
i
].
fe_Çme
);

765 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)&
sdev
->
cŞËù_mib
.
fe
[
i
].
fe_Çme
, 32, 1);

766 ià(
»t
) {

767 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

768  
»t
;

771 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)&
sdev
->
cŞËù_mib
.
fe
[
i
].
Ën
, (
u16
), 1);

772 ià(
»t
) {

773 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

774  
»t
;

777 
d©a
 = 
sdev
->
cŞËù_mib
.
fe
[
i
].data;

778 ià(!
d©a
)

780 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)
d©a
, 
sdev
->
cŞËù_mib
.
fe
[
i
].
Ën
, 1);

781 ià(
»t
) {

782 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

783  
»t
;

786 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

788  
»t
;

789 
	}
}

792 
scsc_log_cŞËùÜ_ş›Á
 
	g¦si_hcf_ş›Á
 = {

793 .
Çme
 = "wlan_hcf",

794 .
	gty³
 = 
SCSC_LOG_CHUNK_WLAN_HCF
,

795 .
	gcŞËù_š™
 = 
NULL
,

796 .
	gcŞËù
 = 
¦si_hcf_cŞËù
,

797 .
	gcŞËù_’d
 = 
NULL
,

798 .
	g´v
 = 
NULL
,

802 
	$¦si_ş—r_sys_”rÜ_bufãr
(
¦si_dev
 *
sdev
)

804 
	`SLSI_INFO
(
sdev
, "CË¬ sy¡emƒ¼Ü bufãr, by‹ wr™‹Àğ%d\n", sdev->
sys_”rÜ_log_buf
.
pos
);

805 
	`mem£t
(
sdev
->
sys_”rÜ_log_buf
.
log_buf
, 0, sdev->sys_”rÜ_log_buf.
pos
 + 1);

806 
sdev
->
sys_”rÜ_log_buf
.
pos
 = 0;

807 
	}
}

809 
	$¦si_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

811 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


812 cÚ¡ 
fœmw¬e
 *
fw
[
SLSI_WLAN_MAX_MIB_FILE
] = { 
NULL
, NULL, NULL };

814 
”r
 = 0, 
r
, 
»g_”r
 = 0, 
¡İ_”r
;

815 
i
;

816 
®pha2
[3];

817 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

819 
	`SLSI_UNUSED_PARAMETER
(
dev
);

821 ià(
	`WARN_ON
(!
sdev
))

822  -
EINVAL
;

824 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

826 
	`SLSI_INFO
(
sdev
, "recovery_status:%d, device_state:%d,„equire_service_close:%d,‚etdev_up_count:%d mac_changed:%d\n",

827 
sdev
->
»cov”y_¡©us
, sdev->
deviû_¡©e
, sdev->
»quœe_£rviû_şo£
, sdev->
Ãtdev_up_couÁ
, sdev->
mac_chªged
);

829 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STOPPED
) {

830 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Device‡lready started\n");

831 
dÚe
;

834 ià(!
sdev
->
mac_chªged
) {

835 
	`¦si_»£t_chªÃl_æags
(
sdev
);

836 
	`¦si_»gd_š™
(
sdev
);

837 
	`kä“
(
sdev
->
deçuÉ_sÿn_›s
);

838 
sdev
->
deçuÉ_sÿn_›s
 = 
NULL
;

839 
sdev
->
deçuÉ_sÿn_›s_Ën
 = 0;

842 ià(
sdev
->
»cov”y_¡©us
) {

843 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_com¶‘ed
,

844 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

845 ià(
r
 == 0) {

846 
	`SLSI_INFO
(
sdev
, "recovery_completedimeout\n");

847 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘edimedout\n", 
__func__
);

848 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

850 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘ed\n", 
__func__
);

851 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

853 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

856 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTING
;

858 
	`»š™_com¶‘iÚ
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

860 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Step [1/2]: Start WLAN service\n");

861 
	`SLSI_EC_GOTO
(
	`¦si_sm_wÏn_£rviû_İ’
(
sdev
), 
”r
, 
”r_dÚe
);

865 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Step [2/3]: Send MIB configuration\n");

867 
sdev
->
loÿl_mib
.
mib_hash
 = 0;

868 #iâdeà
SLSI_TEST_DEV


869 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

870 
	`¥š_lock_š™
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

871 
sdev
->
cŞËù_mib
.
num_fes
 = 0;

872 
sdev
->
cŞËù_mib
.
’abËd
 = 
çl£
;

874 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


876 ià(
	`¦si_is_rf_‹¡_mode_’abËd
(è|| 
	`¦si_is_‹¡_mode_’abËd
()) {

877 
sdev
->
mib
[0].
mib_fe_Çme
 = 
mib_fe_t
;

878 
sdev
->
mib
[1].
mib_fe_Çme
 = 
mib_fe2_t
;

880 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

881 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

884 ià(
loÿl_mib_š_d¿m
)

885 
sdev
->
mib
[2].
mib_fe_Çme
 = sdev->
loÿl_mib
.mib_file_name;

887 
sdev
->
mib
[2].
mib_fe_Çme
 = 
NULL
;

888 
sdev
->
mib
[2].
mib_Ën
 = 0;

892 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
 && 
sdev
->
mib
[i].
mib_fe_Çme
; i++) {

893 
”r
 = 
	`¦si_mib_İ’_fe
(
sdev
, &sdev->
mib
[
i
], &
fw
[i]);

896 ià(
i
 =ğ0 && 
”r
) {

897 
	`SLSI_ERR
(
sdev
, "mib: Mªd©Üy wÏÀhcàmissšg. WLAN wÈnÙ s¹ (”r=%d)\n", 
”r
);

898 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

899 
”r_dÚe
;

903 
”r
 = 
	`¦si_sm_wÏn_£rviû_¡¬t
(
sdev
);

904 ià(
”r
) {

905 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

906 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: slsi_sm_wlan_service_start failed:ƒrr=%d\n",

907 
__func__
, 
”r
);

908 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

910 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

911 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

912 ià(
”r
 !ğ-
EILSEQ
)

913 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

914 
”r_dÚe
;

917 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

918 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

921 
”r
 = 
	`¦si_sm_wÏn_£rviû_¡¬t
(
sdev
);

922 ià(
”r
) {

923 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

924 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: slsi_sm_wlan_service_start failed:ƒrr=%d\n",

925 
__func__
, 
”r
);

926 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

927 ià(
”r
 !ğ-
EILSEQ
)

928 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

929 
”r_dÚe
;

931 
	`SLSI_EC_GOTO
(
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
mib
), 
”r
, 
”r_h_¡¬‹d
);

934 ()
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
loÿl_mib
);

941 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

942 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 0;

943 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 0;

944 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

945 #iâdeà
SLSI_TEST_DEV


946 
	`¦si_´oûss_ši_cÚfig_fe
(
sdev
);

948 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Step [3/3]: Get MIB configuration\n");

949 
	`SLSI_EC_GOTO
(
	`¦si_mib_š™Ÿl_g‘
(
sdev
), 
”r
, 
”r_h_¡¬‹d
);

950 
	`SLSI_INFO
(
sdev
, "=== Version info fromhe [MIB] ===\n");

951 
	`SLSI_INFO
(
sdev
, "HW V”siÚ : 0x%.4X (%u)\n", sdev->
ch_šfo_mib
.
ch_v”siÚ
, sdev->chip_info_mib.chip_version);

952 
	`SLSI_INFO
(
sdev
, "PÏtfÜm : 0x%.4X (%u)\n", sdev->
¶©_šfo_mib
.
¶©_bud
, sdev->plat_info_mib.plat_build);

953 
	`¦si_cfg80211_upd©e_why
(
sdev
);

955 ià(
sdev
->
qsf_ã©u»_£t_Ën
 <ğ(
SLSI_QSF_FEATURE_VER_LEN
 + 
SLSI_QSF_SOLUTION_PROVIDER
))

956 
	`¦si_g‘_qsfs_ã©u»_£t
(
sdev
);

958 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

960 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, sdev->
deviû_cÚfig
.
ho¡_¡©e
);

962 
»g_”r
 = 
	`¦si_»ad_»guÏtÜy
(
sdev
);

963 ià(
»g_”r
) {

964 
	`SLSI_INFO
(
sdev
, "Error in„eading„egulatory!\n");

966 
”r
 = 
	`¦si_»ad_unifi_couÁryli¡
(
sdev
, 
SLSI_PSID_UNIFI_COUNTRY_LIST
);

967 ià(
”r
) {

968 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

969 
”r_h_¡¬‹d
;

972 ià(
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_SET
) {

973 
sdev
->
»g_dom_v”siÚ
 = ((sdev->
»gdb
.
db_majÜ_v”siÚ
 & 0xFF) << 8) |

974 (
sdev
->
»gdb
.
db_mšÜ_v”siÚ
 & 0xFF);

976 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

978 ià(!
	`¦si_is_‹¡_mode_’abËd
()) {

979 
”r
 = 
	`¦si_mlme_£t_couÁry
(
sdev
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
);

981 ià(
”r
 < 0)

982 
”r_h_¡¬‹d
;

985 
	`memıy
(
®pha2
, 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->alpha2, 2);

988 ià(!(
®pha2
[0] == '0' &&‡lpha2[1] == '0'))

990 ià(
	`¦si_»ad_»guÏtÜy_ruËs
(
sdev
, &sdev->
deviû_cÚfig
.
domaš_šfo
, 
®pha2
) == 0) {

991 
	`¦si_»£t_chªÃl_æags
(
sdev
);

992 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
);

995 ià(!
sdev
->
mac_chªged
) {

997 
	`wr™e_wifi_v”siÚ_šfo_fe
(
sdev
);

999 
	`wr™e_m_‹¡_ch_v”siÚ_fe
(
sdev
);

1000 #ifdeà
SCSC_SEP_VERSION


1002 
	`wr™e_soá­_šfo_fe
(
sdev
);

1005 
sdev
->
mac_chªged
 = 
çl£
;

1008 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


1009 ià(
	`¦si_is_rf_‹¡_mode_’abËd
(è&& !
	`¦si_is_‹¡_mode_’abËd
()) {

1010 ià(
sysfs_ª‹Âa
 =ğ
SLSI_ANTENNA_NOT_SET
) {

1011 
	`SLSI_INFO
(
sdev
, "antenna‚ot set. Set /sys/wifi/anto modify‡ntenna\n");

1012 } ià(
sdev
->
Îs_num_¿dio
 < 2) {

1013 
	`SLSI_ERR
(
sdev
, "Invalid:ryingo modify‡nt in SISO model\n");

1014 
sysfs_ª‹Âa
 = 
SLSI_ANTENNA_NOT_SET
;

1016 
	`¦si_£t_mib_´eã¼ed_ª‹Âa
(
sdev
, 
sysfs_ª‹Âa
);

1021 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1023 
¦si_hcf_ş›Á
.
´v
 = 
sdev
;

1024 
	`scsc_log_cŞËùÜ_»gi¡”_ş›Á
(&
¦si_hcf_ş›Á
);

1025 
sdev
->
cŞËù_mib
.
’abËd
 = 
Œue
;

1027 
	`¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
sdev
);

1028 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "---Driver started successfully---\n");

1029 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTED
;

1030 
i
 = 0; i < 
SLSI_MAX_RTT_ID
; i++)

1031 
sdev
->
¹t_id_·¿ms
[
i
] = 
NULL
;

1032 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STARTED
;

1033 
	`¦si_ş—r_sys_”rÜ_bufãr
(
sdev
);

1034 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1036 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_š™Ÿli§tiÚ
,

1037 
¦si_kic_sy¡em_ev’ts_wifi_£rviû_driv”_¡¬‹d
, 
GFP_KERNEL
);

1039  
”r
;

1041 
”r_h_¡¬‹d
:

1042 #iâdeà
SLSI_TEST_DEV


1043 
¡İ_”r
 = 
	`¦si_sm_wÏn_£rviû_¡İ
(
sdev
);

1044 
	`¦si_h_¡İ
(
sdev
);

1045 ià(
¡İ_”r
 !ğ-
EUSERS
)

1046 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

1049 
”r_dÚe
:

1050 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

1052 
	`m¦“p
(500);

1053 
dÚe
:

1054 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_š™Ÿli§tiÚ
,

1055 
¦si_kic_sy¡em_ev’ts_wifi_Ú
, 
GFP_KERNEL
);

1057 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1059  
”r
;

1060 
	}
}

1062 
Ãt_deviû
 *
	$¦si_dyÇmic_š‹rçû_ü—‹
(
why
 *wiphy,

1063 cÚ¡ *
Çme
,

1064 
Æ80211_iáy³
 
ty³
,

1065 
vif_·¿ms
 *
·¿ms
)

1067 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1068 
Ãt_deviû
 *
dev
 = 
NULL
;

1069 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1070 
”r
 = -
EINVAL
;

1071 
içû
;

1073 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Çme:%s\n", 
Çme
);

1075 
içû
 = 
	`¦si_Ãtif_dyÇmic_içû_add
(
sdev
, 
Çme
);

1076 ià(
içû
 < 0)

1077  
NULL
;

1079 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
içû
);

1080 ià(!
dev
)

1081  
NULL
;

1083 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1085 
”r
 = 
	`¦si_Ãtif_»gi¡”_¹Êl_locked
(
sdev
, 
dev
);

1086 ià(
”r
)

1087  
NULL
;

1089 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1090 
ndev_vif
->
iáy³
 = 
ty³
;

1091 
dev
->
›“80211_±r
->
iáy³
 = 
ty³
;

1092 ià(
·¿ms
)

1093 
dev
->
›“80211_±r
->
u£_4addr
 = 
·¿ms
->use_4addr;

1094 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1096  
dev
;

1097 
	}
}

1099 
	$¦si_¡İ_ch
(
¦si_dev
 *
sdev
)

1101 #iâdeà
SLSI_TEST_DEV


1102 
¡İ_”r
;

1104 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1105 
u8
 
šdex
 = 
sdev
->
cŞËù_mib
.
num_fes
;

1106 
u8
 
i
;

1108 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

1110 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
¡¬t_¡İ_mu‹x
));

1112 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Ãtdev_up_couÁ:%d deviû_¡©e:%d\n", sdev->
Ãtdev_up_couÁ
, sdev->
deviû_¡©e
);

1113 
sdev
->
mac_chªged
 = 
çl£
;

1115 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
)

1118 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s\n", 
__func__
);

1119 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

1121 ià(
sdev
->
»cov”y_ç_§ã
) {

1122 
	`SLSI_INFO
(
sdev
, "Skip‚etdev_up_count in„ecovery fail safe\n");

1125 ià(
sdev
->
Ãtdev_up_couÁ
)

1129 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

1131 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1132 
sdev
->
cŞËù_mib
.
’abËd
 = 
çl£
;

1133 
	`scsc_log_cŞËùÜ_uÄegi¡”_ş›Á
(&
¦si_hcf_ş›Á
);

1134 
i
 = 0; i < 
šdex
; i++)

1135 
	`kä“
(
sdev
->
cŞËù_mib
.
fe
[
i
].
d©a
);

1138 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPING
;

1139 #iâdeà
SLSI_TEST_DEV


1140 
¡İ_”r
 = 
	`¦si_sm_wÏn_£rviû_¡İ
(
sdev
);

1142 
	`¦si_sm_wÏn_£rviû_¡İ
(
sdev
);

1144 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

1146 
	`¦si_h_¡İ
(
sdev
);

1147 #iâdeà
SLSI_TEST_DEV


1148 ià(
¡İ_”r
 !ğ-
EUSERS
)

1149 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

1151 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_deš™Ÿli§tiÚ
,

1152 
¦si_kic_sy¡em_ev’ts_wifi_£rviû_driv”_¡İ³d
, 
GFP_KERNEL
);

1154 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1155 ià(
sdev
->
»cov”y_ç_§ã
)

1156 
	`SLSI_INFO
(
sdev
, "Skip setting mlme_blocked in„ecovery fail safe\n");

1158 
sdev
->
mlme_blocked
 = 
çl£
;

1160 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_deš™Ÿli§tiÚ
,

1161 
¦si_kic_sy¡em_ev’ts_wifi_off
, 
GFP_KERNEL
);

1163 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

1164 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
))

1165 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

1166 
	`©omic_£t
(&
sdev
->
¬p_tx_couÁ
, 0);

1168 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1169 
	}
}

1171 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1172 
	$¦si_ndl_vif_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

1174 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1175 
i
;

1176 
¦si_³”
 *
³”
;

1177 
u32
 
ndp_š¡ªû_id
;

1178 
Ãt_deviû
 *
Çn_mgmt_dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
SLSI_NET_INDEX_NAN
);

1180 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1181 
	`Ãtif_ÿ¼›r_off
(
dev
);

1182 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

1183 
i
 = 0; i < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; i++) {

1184 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

1185 
³”
 &&…“r->
v®id
) {

1186 
ndp_š¡ªû_id
 = 
	`¦si_Çn_g‘_ndp_äom_ndl_loÿl_ndi
(
Çn_mgmt_dev
, 
³”
->
ndl_vif
, 
dev
->
dev_addr
);

1187 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1188 
³”
->
ndp_couÁ
--;

1189 ià(
³”
->
ndp_couÁ
 == 0)

1190 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

1194 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

1195 
	}
}

1197 
	$¦si_vif_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
, boŞ 
is_»cov”y
)

1199 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1200 
i
;

1202 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_INIT_DEINIT
, "clean VIF\n");

1204 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1205 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1206 ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

1207 
	`¦si_ndl_vif_ş—nup
(
sdev
, 
dev
, 
hw_avaabË
);

1211 ià(
ndev_vif
->
aùiv©ed
) {

1212 
	`Ãtif_ÿ¼›r_off
(
dev
);

1213 
i
 = 0; i < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; i++) {

1214 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

1216 ià(
³”
 &&…“r->
v®id
)

1217 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1220 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

1221 
boŞ
 
®»ady_discÚÃùed
 = 
çl£
;

1223 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "StiÚ‡ùive: hw_avaabË=%d\n", 
hw_avaabË
);

1224 ià(
hw_avaabË
) {

1225 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

1226 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
Œue
);

1227 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 0, 
NULL
, 0);

1228 
®»ady_discÚÃùed
 = 
Œue
;

1230 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1231 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1234 ià(!
®»ady_discÚÃùed
) {

1235 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Calling slsi_vif_deactivated\n");

1236 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1237 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

1238 
	`cfg80211_discÚÃùed
(
dev
, 
is_»cov”y
 ? 
HOST_REASONCODE_RECOVERY_REASON
 :

1239 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
NULL
, 0, 
çl£
, 
GFP_ATOMIC
);

1241 
	`cfg80211_discÚÃùed
(
dev
, 
is_»cov”y
 ? 
HOST_REASONCODE_RECOVERY_REASON
 :

1242 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
NULL
, 0, 
GFP_ATOMIC
);

1245 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

1246 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "AP‡ctive\n");

1247 ià(
hw_avaabË
) {

1248 
¦si_³”
 *
³”
;

1249 
j
 = 0;

1251 
j
 < 
SLSI_PEER_INDEX_MAX
) {

1252 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
j
];

1253 ià(
³”
 &&…“r->
v®id
)

1254 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1255 ++
j
;

1257 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1258 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1260 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Calling slsi_vif_deactivated\n");

1261 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1263 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
)

1264 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

1265 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_DISCOVERY
 ||‚dev_vif->vif_ty³ =ğ
FAPI_VIFTYPE_PRECONNECT
) {

1266 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1267 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
hw_avaabË
);

1269 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "P2P‡ctive - Deactivate\n");

1270 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
hw_avaabË
);

1272 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1273 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_NAN
) {

1274 ià(
hw_avaabË
) {

1275 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1276 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1278 
ndev_vif
->
aùiv©ed
 = 
çl£
;

1279 
	`¦si_Çn_£nd_di§bËd_ev’t
(
sdev
, 
dev
, 
hw_avaabË
 ? 
SLSI_HAL_NAN_STATUS_SUCCESS
 :

1280 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
);

1284 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_MONITOR
)

1285 
	`¦si_¡İ_mÚ™Ü_mode
(
sdev
, 
dev
);

1287 
	}
}

1289 
	$¦si_sched_sÿn_¡İ³d
(
wÜk_¡ruù
 *
wÜk
)

1291 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
wÜk
, Ãtdev_vif, 
sched_sÿn_¡İ_wk
);

1292 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1293 
why
 *wiphy;

1294 
u64
 
»qid
 = 0;

1295 
boŞ
 
sched_sÿn_»q
 = 
çl£
;

1297 
why
 = 
sdev
->wiphy;

1298 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1299 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
) {

1300 
»qid
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
->reqid;

1301 
sched_sÿn_»q
 = 
Œue
;

1302 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
NULL
;

1304 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1305 ià(
sched_sÿn_»q
) {

1306 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

1307 
	`cfg80211_sched_sÿn_¡İ³d
(
why
, 
»qid
);

1309 
	`cfg80211_sched_sÿn_¡İ³d
(
why
);

1312 
	}
}

1314 
	$¦si_sÿn_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1316 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1317 
i
;

1318 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

1319 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
çl£
};

1322 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_INIT_DEINIT
, "clean scan_data\n");

1324 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1325 
i
 = 0; i < 
SLSI_SCAN_MAX
; i++) {

1326 ià((
ndev_vif
->
sÿn
[
i
].
sÿn_»q
 ||‚dev_vif->sÿn[i].
acs_»que¡
) &&

1327 !
sdev
->
mlme_blocked
)

1328 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, (
ndev_vif
->
iâum
 << 8 | 
i
), 
çl£
);

1329 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
i
);

1330 ià(
ndev_vif
->
sÿn
[
i
].
sÿn_»q
 && i =ğ
SLSI_SCAN_HW_ID
) {

1331 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

1332 
šfo
.
abÜ‹d
 = 
Œue
;

1333 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
i
].
sÿn_»q
, &
šfo
);

1335 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
i
].
sÿn_»q
, 
Œue
);

1339 ià(
ndev_vif
->
sÿn
[
i
].
sched_»q
 && i =ğ
SLSI_SCAN_SCHED_ID
)

1340 
	`queue_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
sched_sÿn_¡İ_wk
);

1342 
ndev_vif
->
sÿn
[
i
].
sÿn_»q
 = 
NULL
;

1343 
	`kä“
(
ndev_vif
->
sÿn
[
i
].
acs_»que¡
);

1344 
ndev_vif
->
sÿn
[
i
].
acs_»que¡
 = 
NULL
;

1346 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1347 
	}
}

1349 
	$¦si_ş—r_low_Ï‹ncy_¡©e
(
Ãt_deviû
 *
dev
)

1351 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1352 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1353 
»t
 = 0;

1354 
u16
 
ho¡_¡©e
;

1356 ià(!
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

1359 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1360 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

1361 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

1363 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

1364 ià(
»t
 != 0) {

1365 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d\n", 
»t
);

1366 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1369 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

1370 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1371 
	}
}

1373 
	$¦si_¡İ_Ãt_dev_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

1375 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1377 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "Stİpšg‚‘dev_up_couÁ=%d, hw_avaabË = %d\n", 
sdev
->
Ãtdev_up_couÁ
, 
hw_avaabË
);

1379 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
¡¬t_¡İ_mu‹x
));

1381 ià(!
ndev_vif
->
is_avaabË
) {

1382 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "Not Available\n");

1386 ià(
	`WARN_ON
(!
sdev
->
Ãtdev_up_couÁ
)) {

1387 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "sdev->Ãtdev_up_couÁ=%d\n", 
sdev
->
Ãtdev_up_couÁ
);

1391 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1392 ià(
ndev_vif
->
Œaffic_mÚ_¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_LOW
) {

1393 
Ãtdev_vif
 *
tmp_ndev_vif
;

1394 
u8
 
i
;

1395 
u8
 
³rf_š_u£
 = 0;

1397 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

1402 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

1403 ià(
sdev
->
Ãtdev
[
i
]) {

1404 
tmp_ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

1405 ià(
tmp_ndev_vif
->
is_avaabË
 && (tmp_ndev_vif->
Œaffic_mÚ_¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_LOW
)) {

1406 
³rf_š_u£
 = 1;

1411 ià(!
³rf_š_u£
)

1412 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 0, 
çl£
);

1416 
	`¦si_sÿn_ş—nup
(
sdev
, 
dev
);

1418 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

1419 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

1420 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1421 
	`¦si_vif_ş—nup
(
sdev
, 
dev
, 
hw_avaabË
, 0);

1422 
	`¦si_¥šlock_lock
(&
sdev
->
Ãtdev_lock
);

1423 
ndev_vif
->
is_avaabË
 = 
çl£
;

1424 
sdev
->
Ãtdev_up_couÁ
--;

1425 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1426 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

1427 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
è&&‡tomic_»ad(&
sdev
->
ù¾_·u£_¡©e
))

1428 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

1429 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

1431 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1433 
	`com¶‘e_®l
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

1434 
	`¦si_¡İ_ch
(
sdev
);

1435 
	}
}

1438 
	$¦si_¡İ_Ãt_dev
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1440 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1441 
	`¦si_¡İ_Ãt_dev_locked
(
sdev
, 
dev
, sdev->
»cov”y_¡©us
 ? 
çl£
 : 
Œue
);

1442 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1443 
	}
}

1446 
	$¦si_¡İ
(
¦si_dev
 *
sdev
)

1448 
Ãt_deviû
 *
dev
;

1449 
i
;

1451 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1452 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Ãtdev_up_couÁ:%d\n", sdev->
Ãtdev_up_couÁ
);

1454 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

1456 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1457 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

1458 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

1459 ià(
dev
)

1460 
	`¦si_¡İ_Ãt_dev_locked
(
sdev
, sdev->
Ãtdev
[
i
], 
çl£
);

1462 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1464 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1465 
	}
}

1468 
u8
 *
	$¦si_mib_¦iû
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
d©a
, 
u32
 
Ëngth
, u32 *
p_·r£d_Ën
,

1469 
u32
 *
p_mib_¦iû_Ën
)

1471 cÚ¡ 
u8
 *
p
 = 
d©a
;

1472 
u8
 *
mib_¦iû
;

1473 
u32
 
mib_¦iû_Ën
 = 0;

1475 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1477 ià(!
Ëngth
)

1478  
NULL
;

1480 
mib_¦iû
 = 
	`km®loc
(
Ëngth
 + 4, 
GFP_KERNEL
);

1481 ià(!
mib_¦iû
)

1482  
NULL
;

1484 
Ëngth
 >= 4) {

1485 
u16
 
psid
 = 
	`SLSI_BUFF_LE_TO_U16
(
p
);

1486 
u16
 
p¦’
 = (u16)(4 + 
	`SLSI_BUFF_LE_TO_U16
(&
p
[2]));

1488 ià(
p¦’
 & 0x1)

1489 
p¦’
++;

1491 ià(
psid
 & 
CSR_WIFI_SME_MIB2_HOST_PSID_MASK
) {

1495 
	#CSR_WIFI_HOSTIO_MIB_SET_MAX
 (1800)

	)

1496 ià((
mib_¦iû_Ën
 + 
p¦’
è> 
CSR_WIFI_HOSTIO_MIB_SET_MAX
)

1498 ià(
p¦’
 > 
Ëngth
 + 4) {

1499 
	`SLSI_ERR
(
sdev
, "Ëngth %u„—d from MIB f> s·û %u - cÜru± fe?\n", 
p¦’
, 
Ëngth
 + 4);

1500 
mib_¦iû_Ën
 = 0;

1503 
	`memıy
(&
mib_¦iû
[
mib_¦iû_Ën
], 
p
, 
p¦’
);

1504 
mib_¦iû_Ën
 +ğ
p¦’
;

1506 
p
 +ğ
p¦’
;

1507 
Ëngth
 -ğ
p¦’
;

1510 *
p_mib_¦iû_Ën
 = 
mib_¦iû_Ën
;

1511 *
p_·r£d_Ën
 = (
p
 - 
d©a
);

1513  
mib_¦iû
;

1514 
	}
}

1517 
	$¦si_mib_g‘_¶©fÜm
(
¦si_dev_mib_šfo
 *
mib_šfo
)

1519 
size_t
 
¶©_Çme_Ën
;

1520 
pos
 = 0;

1537 
mib_šfo
->
¶©fÜm
[0] = '\0';

1540 ià(
mib_šfo
->
mib_Ën
 < 12) {

1541 
	`SLSI_INFO_NODEV
("HCF fileoo short\n");

1542  -
EINVAL
;

1545 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0xFE ||

1546 
mib_šfo
->
mib_d©a
[
pos
++] != 0xFF) {

1547 
	`SLSI_INFO_NODEV
("No HCF version ID\n");

1548  -
EINVAL
;

1550 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0x01 ||

1551 
mib_šfo
->
mib_d©a
[
pos
++] != 0x00) {

1552 
	`SLSI_INFO_NODEV
("Bad†ength\n");

1553  -
EINVAL
;

1555 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0x01 ||

1556 
mib_šfo
->
mib_d©a
[
pos
++] != 0x00) {

1557 
	`SLSI_INFO_NODEV
("Bad version ID\n");

1558  -
EINVAL
;

1560 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0xFF ||

1561 
mib_šfo
->
mib_d©a
[
pos
++] != 0xFF) {

1562 
	`SLSI_INFO_NODEV
("No HCF…latform‚ame\n");

1563  -
EINVAL
;

1567 
¶©_Çme_Ën
 = 
mib_šfo
->
mib_d©a
[
pos
++];

1568 
¶©_Çme_Ën
 |ğ(
mib_šfo
->
mib_d©a
[
pos
++] << 16);

1571 ià(
¶©_Çme_Ën
 + 
pos
 > 
mib_šfo
->
mib_Ën
 ||…lat_name_len < 2) {

1572 
	`SLSI_ERR_NODEV
("Bad HCF FFFF key†ength %zu\n",

1573 
¶©_Çme_Ën
);

1574  -
EINVAL
;

1582 
	#SLSI_VLDATA_STRING
 0xA0

	)

1583 
	#SLSI_VLDATA_LEN
 0x17

	)

1585 
u8
 
vËn_hdr
 = 
mib_šfo
->
mib_d©a
[
pos
++];

1586 
u8
 
vËn_Ën
 = 
vËn_hdr
 & 
SLSI_VLDATA_LEN
;

1589 
¶©_Çme_Ën
--;

1591 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "vlhd¸0x%x,†’ %u\n", 
vËn_hdr
, 
vËn_Ën
);

1594 ià(!(
vËn_hdr
 & 
SLSI_VLDATA_STRING
)) {

1595 
	`SLSI_ERR_NODEV
("NØ¡ršg vËÀh—d” 0x%x\n", 
vËn_hdr
);

1596  -
EINVAL
;

1600 ià(
vËn_Ën
 > 2) {

1601 
	`SLSI_ERR_NODEV
("ToØlÚg où‘ sŒšg h—d” %u\n", 
vËn_Ën
);

1602  -
EINVAL
;

1608 
pos
 +ğ
vËn_Ën
;

1609 
¶©_Çme_Ën
 -ğ
vËn_Ën
;

1614 
size_t
 
Œunc_Ën
 = 
¶©_Çme_Ën
;

1616 ià(
Œunc_Ën
 >ğ(
mib_šfo
->
¶©fÜm
))

1617 
Œunc_Ën
 = (
mib_šfo
->
¶©fÜm
) - 1;

1620 
	`memıy
(
mib_šfo
->
¶©fÜm
, &mib_šfo->
mib_d©a
[
pos
], 
Œunc_Ën
);

1621 
mib_šfo
->
¶©fÜm
[
Œunc_Ën
] = '\0';

1624 
	`SLSI_INFO_NODEV
("MIB…ÏtfÜm: %.*s\n", ()
¶©_Çme_Ën
, &
mib_šfo
->
mib_d©a
[
pos
]);

1626 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "plat_name_len: %zu + %u\n",

1627 
¶©_Çme_Ën
, (plat_name_len & 1));

1631 
¶©_Çme_Ën
 += (plat_name_len & 1);

1632 
pos
 +ğ
¶©_Çme_Ën
;

1635 
mib_šfo
->
mib_d©a
 +ğ
pos
;

1636 
mib_šfo
->
mib_Ën
 -ğ
pos
;

1638 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "Sk %d où‘ HCF…aylßd\n", 
pos
);

1641 
	}
}

1643 
	#MGT_HASH_SIZE_BYTES
 2

	)

1644 
	#MGT_HASH_OFFSET
 4

	)

1645 
	#MX_WLAN_FILE_LEN_MAX
 128

	)

1646 
	$¦si_mib_İ’_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
, cÚ¡ 
fœmw¬e
 **
fw
)

1648 
r
 = -1;

1649 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

1650 cÚ¡ *
mib_fe_ext
;

1651 
·th_Çme
[
MX_WLAN_FILE_PATH_LEN_MAX
];

1652 *
mib_fe_Çme
 = 
mib_šfo
->mib_file_name;

1653 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1654 
u8
 
šdex
 = 
sdev
->
cŞËù_mib
.
num_fes
;

1655 
u8
 *
d©a
;

1657 #ià
defšed
 
SCSC_SEP_VERSION


1658 
»t
 = 0, 
v®ue
;

1659 
f’ame
[
MX_WLAN_FILE_LEN_MAX
];

1662 ià(!
mib_fe_Çme
 || !
fw
)

1663  -
EINVAL
;

1664 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1665 ià(
šdex
 > 
SLSI_WLAN_MAX_MIB_FILE
) {

1666 
	`SLSI_ERR
(
sdev
, "cŞËù mib index i šv®id:%d\n", 
šdex
);

1667  -
EINVAL
;

1670 
mib_šfo
->
mib_d©a
 = 
NULL
;

1671 
mib_šfo
->
mib_Ën
 = 0;

1672 
mib_šfo
->
mib_hash
 = 0;

1674 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "MIB f- Nam: %s\n", 
mib_fe_Çme
);

1677 
mib_fe_ext
 = 
	`¡¼chr
(
mib_fe_Çme
, '.');

1678 ià(!
mib_fe_ext
) {

1679 
	`SLSI_ERR
(
sdev
, "cÚfigu¿tiÚ fÇm'%s' inv®id\n", 
mib_fe_Çme
);

1680  -
EINVAL
;

1684 
	`sú´štf
(
·th_Çme
, 
MX_WLAN_FILE_PATH_LEN_MAX
, "wÏn/%s", 
mib_fe_Çme
);

1685 
	`SLSI_INFO
(
sdev
, "P©hØthMIB f: %s\n", 
·th_Çme
);

1687 #ià
defšed
 
SCSC_SEP_VERSION


1688 
»t
 = 
	`scsc_mx_£rviû_phªdË_´İ”ty_»ad_u32
(
sdev
->
£rviû
, "§msung,wlbt_hcf", "hcf_»v", &
v®ue
,„et);

1689 ià(
»t
 == 0) {

1690 
	`mem£t
(
f’ame
, 0, 
MX_WLAN_FILE_LEN_MAX
);

1691 
	`sú´štf
(
f’ame
, (f’ame), "%s.»v%d", 
mib_fe_Çme
, 
v®ue
);

1692 
r
 = 
	`mx140_fe_»que¡_cÚf
(
sdev
->
maxw–l_cÜe
, &
e
, "wÏn", 
f’ame
);

1693 ià(
r
 || !
e
) {

1694 
	`SLSI_INFO
(
sdev
, "Sk MIB dowÆßd‡ f% i NOT found\n", 
f’ame
);

1695 *
fw
 = 
e
;

1696  
r
;

1700 
r
 = 
	`mx140_fe_»que¡_cÚf
(
sdev
->
maxw–l_cÜe
, &
e
, "wÏn", 
mib_fe_Çme
);

1701 ià(
r
 || !
e
) {

1702 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Sk MIB dowÆßd‡ f% i NOT found\n", 
mib_fe_Çme
);

1703 *
fw
 = 
e
;

1704  
r
;

1706 #ià
defšed
 
SCSC_SEP_VERSION


1710 
mib_šfo
->
mib_d©a
 = (
u8
 *)
e
->
d©a
;

1711 
mib_šfo
->
mib_Ën
 = 
e
->
size
;

1713 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1714 
	`¥š_lock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

1715 
	`mem£t
(&
sdev
->
cŞËù_mib
.
fe
[
šdex
].
fe_Çme
, 0, 32);

1716 
	`¢´štf
(&
sdev
->
cŞËù_mib
.
fe
[
šdex
].
fe_Çme
[0], 32, "%s", 
mib_fe_Çme
);

1717 
sdev
->
cŞËù_mib
.
fe
[
šdex
].
Ën
 = 
mib_šfo
->
mib_Ën
;

1718 
d©a
 = 
	`km®loc
(
mib_šfo
->
mib_Ën
, 
GFP_ATOMIC
);

1719 ià(!
d©a
) {

1720 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

1721 
cÚt
;

1723 
	`memıy
(
d©a
, 
mib_šfo
->
mib_d©a
, mib_šfo->
mib_Ën
);

1724 
sdev
->
cŞËù_mib
.
fe
[
šdex
].
d©a
 = data;

1725 
sdev
->
cŞËù_mib
.
num_fes
 += 1;

1726 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

1727 
cÚt
:

1730 ià(
mib_šfo
->
mib_Ën
 >= 8 &&

1732 
mib_šfo
->
mib_d©a
[7] == 1) {

1733 
i
;

1735 
mib_šfo
->
mib_hash
 = 0;

1737 
i
 = 0; i < 
MGT_HASH_SIZE_BYTES
; i++)

1738 
mib_šfo
->
mib_hash
 = (mib_šfo->mib_hash << 8è| mib_šfo->
mib_d©a
[
i
 + 
MGT_HASH_OFFSET
];

1740 
	`SLSI_INFO
(
sdev
, "MIB hash: 0x%.04x\n", 
mib_šfo
->
mib_hash
);

1742 
mib_šfo
->
mib_d©a
 += 8;

1743 
mib_šfo
->
mib_Ën
 -= 8;

1746 
	`¦si_mib_g‘_¶©fÜm
(
mib_šfo
);

1749 
	`SLSI_ERR
(
sdev
, "cÚfigu¿tiÚ f'%s' ha bad h—d”\n", 
mib_šfo
->
mib_fe_Çme
);

1750 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

1751  -
EINVAL
;

1754 *
fw
 = 
e
;

1756 
	}
}

1758 
	$¦si_mib_şo£_fe
(
¦si_dev
 *
sdev
, cÚ¡ 
fœmw¬e
 *
e
)

1760 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "MIB clo£ %p\n", 
e
);

1762 ià(!
e
 || !
sdev
)

1763  -
EIO
;

1765 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

1768 
	}
}

1770 
	$¦si_mib_dowÆßd_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
)

1772 
r
 = -1;

1773 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

1774 
u8
 *
mib_¦iû
;

1775 
u32
 
mib_¦iû_Ën
, 
·r£d_Ën
;

1777 
r
 = 
	`¦si_mib_İ’_fe
(
sdev
, 
mib_šfo
, &
e
);

1778 ià(
r
)

1779  
r
;

1784 
mib_šfo
->
mib_Ën
 > 0) {

1785 
mib_¦iû
 = 
	`¦si_mib_¦iû
(
sdev
, 
mib_šfo
->
mib_d©a
, mib_šfo->
mib_Ën
, &
·r£d_Ën
, &
mib_¦iû_Ën
);

1786 ià(!
mib_¦iû
)

1788 ià(
mib_¦iû_Ën
 =ğ0 || mib_¦iû_ËÀ> 
mib_šfo
->
mib_Ën
) {

1790 
	`SLSI_ERR
(
sdev
, "¦si_mib_¦iû„‘uºed im¶ausibË %d\n", 
mib_¦iû_Ën
);

1791 
r
 = -
EINVAL
;

1792 
	`kä“
(
mib_¦iû
);

1795 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_¦iû
, 
mib_¦iû_Ën
);

1796 
	`kä“
(
mib_¦iû
);

1797 ià(
r
 != 0)

1798 
	`SLSI_ERR
(
sdev
, "mlme set failed„=0x%x during downloading:'%s'\n",

1799 
r
, 
mib_šfo
->
mib_fe_Çme
);

1801 
mib_šfo
->
mib_d©a
 +ğ
·r£d_Ën
;

1802 
mib_šfo
->
mib_Ën
 -ğ
·r£d_Ën
;

1805 
	`¦si_mib_şo£_fe
(
sdev
, 
e
);

1807  
r
;

1808 
	}
}

1810 
	$¦si_g‘_suµÜ‹d_chªÃls
(
¦si_dev
 *
sdev
, 
¦si_mib_v®ue
 *
v®ues
, 
mib_šdex
)

1812 *
bªd
 = 
sdev
->
suµÜ‹d_5g_chªÃls
;

1813 
chª_couÁ
 = 0;

1814 
chª_¡¬t
 = 0;

1815 
i
 = 0;

1816 
j
 = 0;

1817 
šdex
 = 0;

1818 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1819 
k
 = 0;

1820 
šüem’t
 = 4;

1821 
buf_Ën
 = 150;

1822 *
suµÜ‹d_chªÃls_bufãr
 = 
NULL
;

1823 
buf_pos
 = 0;

1826 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1827 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_OCTET
);

1828 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
)

1832 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1833 
suµÜ‹d_chªÃls_bufãr
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

1834 ià(!
suµÜ‹d_chªÃls_bufãr
)

1835  -
ENOMEM
;

1838 
sdev
->
bªd_5g_suµÜ‹d
 = 0;

1839 
	`mem£t
(
sdev
->
suµÜ‹d_2g_chªÃls
, 0, (sdev->supported_2g_channels));

1840 
	`mem£t
(
sdev
->
suµÜ‹d_5g_chªÃls
, 0, (sdev->supported_5g_channels));

1842 
i
 = 0; i < 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
 / 2; i++) {

1844 ià(
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
 * 2] > 14 &&

1845 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
 * 2 + 1] > 0) {

1846 
sdev
->
bªd_5g_suµÜ‹d
 = 1;

1850 
i
 = 0; i < 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
; i += 2) {

1851 
chª_¡¬t
 = 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
];

1852 
chª_couÁ
 = 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
 + 1];

1853 
bªd
 = 
sdev
->
suµÜ‹d_5g_chªÃls
;

1854 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1855 
k
 = 0;

1856 ià(
chª_¡¬t
 < 15)

1857 
šüem’t
 = 1;

1859 
šüem’t
 = 4;

1861 ià(
chª_¡¬t
 < 15) {

1862 
šdex
 = 
chª_¡¬t
 - 1;

1863 
bªd
 = 
sdev
->
suµÜ‹d_2g_chªÃls
;

1864 } ià(
chª_¡¬t
 >= 36 && chan_start <= 48) {

1865 
šdex
 = (
chª_¡¬t
 - 36) / 4;

1866 } ià(
chª_¡¬t
 >= 52 && chan_start <= 64) {

1867 
šdex
 = ((
chª_¡¬t
 - 52) / 4) + 4;

1868 } ià(
chª_¡¬t
 >= 100 && chan_start <= 140) {

1869 
šdex
 = ((
chª_¡¬t
 - 100) / 4) + 8;

1870 } ià(
chª_¡¬t
 >= 149 && chan_start <= 165) {

1871 
šdex
 = ((
chª_¡¬t
 - 149) / 4) + 20;

1875 
j
 = 0; j < 
chª_couÁ
; j++) {

1876 
bªd
[
šdex
 + 
j
] = 1;

1877 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1878 
buf_pos
 +ğ
	`¢´štf
(
suµÜ‹d_chªÃls_bufãr
 + buf_pos,

1879 
buf_Ën
 - 
buf_pos
, "%d ", (
chª_¡¬t
 + 
k
));

1880 
k
 = k + 
šüem’t
;

1883 
sdev
->
’abËd_chªÃl_couÁ
 +ğ
chª_couÁ
;

1885 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1886 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Value for Supported Channels mib: %s\n",

1887 
suµÜ‹d_chªÃls_bufãr
);

1888 
	`kä“
(
suµÜ‹d_chªÃls_bufãr
);

1891 
	}
}

1893 
	$¦si_g‘_ht_vht_ÿ·b™›s
(
¦si_dev
 *
sdev
, 
¦si_mib_v®ue
 *
v®ues
, *
mib_šdex
)

1895 ià(
v®ues
[++*
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1896 
sdev
->
fw_ht_’abËd
 = 
v®ues
[*
mib_šdex
].
u
.
boŞV®ue
;

1898 
	`SLSI_WARN
(
sdev
, "Error„eading HTƒnabled mib\n");

1899 ià(
v®ues
[++*
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1900 
sdev
->
fw_vht_’abËd
 = 
v®ues
[*
mib_šdex
].
u
.
boŞV®ue
;

1902 
	`SLSI_WARN
(
sdev
, "Error„eading VHTƒnabled mib\n");

1903 ià(
v®ues
[++*
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
) {

1904 ià(
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
 >= 4)

1905 
	`memıy
(&
sdev
->
fw_ht_ÿp
, 
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©a
, 4);

1907 
	`SLSI_WARN
(
sdev
, "Error„eading HT capabilities\n");

1909 
	`SLSI_WARN
(
sdev
, "Error„eading HT capabilities\n");

1911 ià(
v®ues
[++*
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
) {

1912 ià(
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
 >= 4)

1913 
	`memıy
(&
sdev
->
fw_vht_ÿp
, 
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©a
, 4);

1915 
	`SLSI_WARN
(
sdev
, "Error„eading VHT capabilities\n");

1917 
	`SLSI_WARN
(
sdev
, "Error„eading VHT capabilities\n");

1919 
	}
}

1921 
	$¦si_g‘_mib_’Œy_v®ue
(
¦si_dev
 *
sdev
, 
¦si_mib_v®ue
 *
v®ues
)

1923 
mib_šdex
 = 0;

1924 
u16
 
num_ª‹Âa
 = 0;

1925 
u16
 
ª‹Âa_lw_b™
 = 0;

1926 
u16
 
ª‹Âa_hg_b™
 = 0;

1927 
r
 = 0;

1929 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1930 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1931 
sdev
->
ch_šfo_mib
.
ch_v”siÚ
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1935 
r
 = 
	`¦si_g‘_suµÜ‹d_chªÃls
(
sdev
, 
v®ues
, ++
mib_šdex
);

1936 ià(
r
 < 0)

1937  
r
;

1939 
	`¦si_g‘_ht_vht_ÿ·b™›s
(
sdev
, 
v®ues
, &
mib_šdex
);

1941 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1942 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1943 
sdev
->
¶©_šfo_mib
.
¶©_bud
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1945 
	`SLSI_WARN
(
sdev
, "Error„eading Hardware…latform\n");

1948 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1949 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1950 
sdev
->
»g_dom_v”siÚ
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1952 
	`SLSI_WARN
(
sdev
, "Error„eading Reg domain version\n");

1956 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1957 
sdev
->
Çn_’abËd
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1959 
sdev
->
Çn_’abËd
 = 
çl£
;

1960 
	`SLSI_WARN
(
sdev
, "Error„eading NANƒnabled mib\n");

1963 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1964 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1965 
sdev
->
fw_dw–l_time
 = (
v®ues
[
mib_šdex
].
u
.
uštV®ue
) * 1024;

1967 
	`SLSI_WARN
(
sdev
, "Error„eading UnifiForcedScheduleDuration\n");

1969 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


1970 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 && v®ues[mib_šdex].
u
.
où‘V®ue
.
d©aL’gth
 >= 8) {

1972 
	`memıy
(&
sdev
->
wifi_sh¬šg_5ghz_chªÃl
, 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
, 8);

1973 
	`¦si_exŒaù_v®id_wifi_sh¬šg_chªÃls
(
sdev
);

1975 
	`SLSI_WARN
(
sdev
, "Error„eading 5Ghz Allowed Channels\n");

1979 #ifdeà
SCSC_SEP_VERSION


1980 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1981 
sdev
->
du®bªd_cÚcu¼’cy
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1983 
	`SLSI_WARN
(
sdev
, "Error„eading dual band concurrency\n");

1985 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

1986 
sdev
->
soá­_max_ş›Á
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1988 
	`SLSI_WARN
(
sdev
, "Error„eading SoftAP max client\n");

1990 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1991 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1992 
sdev
->
fw_mac_¿ndomiz©iÚ_’abËd
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1994 
	`SLSI_WARN
(
sdev
, "Error„eading Mac Randomization Support\n");

1996 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1997 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1998 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
,

2000 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
);

2002 
	`SLSI_WARN
(
sdev
, "Error„eading default country without ch12/13 mib\n");

2004 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


2005 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

2006 
sdev
->
deviû_cÚfig
.
fw_’hªûd_¬p_d‘eù_suµÜ‹d
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

2008 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "Enhanced Arp Detect is disabled!\n");

2010 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

2012 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2013 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2014 
sdev
->
fw_max_¬p_couÁ
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

2015 ià(
sdev
->
fw_max_¬p_couÁ
 <ğ
SLSI_ARP_UNPAUSE_THRESHOLD
) {

2016 
	`SLSI_INFO
(
sdev
,

2018 
sdev
->
fw_max_¬p_couÁ
);

2019 
sdev
->
fw_max_¬p_couÁ
 = 0;

2022 
sdev
->
fw_max_¬p_couÁ
 = 0;

2023 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
,

2027 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

2028 
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

2030 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "APF Support is disabled!\n");

2032 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

2033 
sdev
->
fw_SoáAp_2g_40mhz_’abËd
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

2035 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "40MHz for Soft AP is disabled!\n");

2038 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2039 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2040 
num_ª‹Âa
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

2041 
ª‹Âa_lw_b™
 = 
num_ª‹Âa
 & 0xff;

2042 
ª‹Âa_hg_b™
 = ((
num_ª‹Âa
 >> 8) & 0xff);

2043 
sdev
->
Îs_num_¿dio
 = (
ª‹Âa_lw_b™
 > 
ª‹Âa_hg_b™
) ?‡ntenna_lw_bit :‡ntenna_hg_bit;

2044 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "sdev->Îs_num_¿diØğ%d\n", sdev->
Îs_num_¿dio
);

2046 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "Failedo„ead‚umber of‡ntennas\n");

2049 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2050 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_OCTET
);

2051 
sdev
->
fw_ext_ÿp_›_Ën
 = 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
;

2052 
	`mem£t
(
sdev
->
fw_ext_ÿp_›
, 0, (sdev->fw_ext_cap_ie));

2053 
	`memıy
(
sdev
->
fw_ext_ÿp_›
, 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
,

2054 
sdev
->
fw_ext_ÿp_›_Ën
);

2056 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "Failedo„ead Extended capabilities\n");

2059 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2060 
sdev
->
igmp_ofæßd_aùiv©ed
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

2061 
	`SLSI_INFO
(
sdev
, "IGMP ofæßdšg i ’abËd:%d\n", sdev->
igmp_ofæßd_aùiv©ed
);

2063 
	`SLSI_INFO
(
sdev
, "IGMP offloading is disabled!\n");

2065 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


2066 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2067 
sdev
->
bªd_6g_suµÜ‹d
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

2068 
	`SLSI_INFO
(
sdev
, "6Ghz i suµÜ‹d: %d\n", sdev->
bªd_6g_suµÜ‹d
);

2070 
	`SLSI_INFO
(
sdev
, "6Ghz is‚ot supported\n");

2073 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2074 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2075 
sdev
->
§e_dw–l_time
 = (
v®ues
[
mib_šdex
].
u
.
uštV®ue
);

2077 
	`SLSI_WARN
(
sdev
, "Error„eading mib UnifiSaeDwellTime\n");

2079  
r
;

2080 
	}
}

2082 
	$¦si_mib_š™Ÿl_g‘
(
¦si_dev
 *
sdev
)

2084 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2085 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2086 
rx_Ën
 = 0;

2087 
r
;

2088 
¦si_mib_v®ue
 *
v®ues
;

2090 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_CHIP_VERSION
, { 0, 0 } },

2091 { 
SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
, { 0, 0 } },

2092 { 
SLSI_PSID_UNIFI_HT_ACTIVATED
, {0, 0} },

2093 { 
SLSI_PSID_UNIFI_VHT_ACTIVATED
, {0, 0} },

2094 { 
SLSI_PSID_UNIFI_HT_CAPABILITIES
, {0, 0} },

2095 { 
SLSI_PSID_UNIFI_VHT_CAPABILITIES
, {0, 0} },

2096 { 
SLSI_PSID_UNIFI_HARDWARE_PLATFORM
, {0, 0} },

2097 { 
SLSI_PSID_UNIFI_REG_DOM_VERSION
, {0, 0} },

2098 { 
SLSI_PSID_UNIFI_NAN_ACTIVATED
, {0, 0} },

2099 { 
SLSI_PSID_UNIFI_DEFAULT_DWELL_TIME
, {0, 0} },

2100 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2101 { 
SLSI_PSID_UNIFI_WI_FI_SHARING5_GHZ_CHANNEL
, {0, 0} },

2103 #ifdeà
SCSC_SEP_VERSION


2104 { 
SLSI_PSID_UNIFI_DUAL_BAND_CONCURRENCY
, {0, 0} },

2105 { 
SLSI_PSID_UNIFI_MAX_CLIENT
, {0, 0} },

2107 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


2108 { 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
, {0, 0} },

2110 { 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY_WITHOUT_CH12_CH13
, {0, 0} },

2111 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


2112 { 
SLSI_PSID_UNIFI_ARP_DETECT_ACTIVATED
, {0, 0} },

2114 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

2115 { 
SLSI_PSID_UNIFI_ARP_OUTSTANDING_MAX
, {0, 0} },

2117 { 
SLSI_PSID_UNIFI_APF_ACTIVATED
, {0, 0} },

2118 { 
SLSI_PSID_UNIFI_SOFT_AP40_MHZ_ON24G
, {0, 0} },

2119 { 
SLSI_PSID_UNIFI_MAX_NUM_ANTENNA_TO_USE
, {0, 0} },

2120 { 
SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES
, {0, 0} },

2121 { 
SLSI_PSID_UNIFI_IGMP_OFFLOAD_ACTIVATED
, {0, 0} },

2122 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


2123 { 
SLSI_PSID_UNIFI6_GHZ_ENABLED
, {0, 0} },

2125 { 
SLSI_PSID_UNIFI_SAE_DWELL_TIME
, {0, 0} },

2128 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2129 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2130  -
ENOMEM
;

2132 
mibr¥
.
d©aL’gth
 = 260;

2133 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2134 ià(!
mibr¥
.
d©a
) {

2135 
	`kä“
(
mib»q
.
d©a
);

2136  -
ENOMEM
;

2139 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ën
);

2140 
	`kä“
(
mib»q
.
d©a
);

2141 ià(
r
 == 0) {

2142 
mibr¥
.
d©aL’gth
 = (
u32
)
rx_Ën
;

2144 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2146 ià(!
v®ues
) {

2147 
	`kä“
(
mibr¥
.
d©a
);

2148  -
EINVAL
;

2150 
r
 = 
	`¦si_g‘_mib_’Œy_v®ue
(
sdev
, 
v®ues
);

2151 
	`kä“
(
v®ues
);

2153 
	`kä“
(
mibr¥
.
d©a
);

2155  
r
;

2156 
	}
}

2158 
	$¦si_£t_mib_rßm
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u16
 
psid
, 
v®ue
)

2160 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

2161 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

2163 ià(
	`¦si_mib_’code_št
(&
mib_d©a
, 
psid
, 
v®ue
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

2164 ià(
mib_d©a
.
d©aL’gth
) {

2165 
”rÜ
 = 
	`¦si_mlme_£t
(
dev
, 
ndev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

2166 ià(
”rÜ
)

2167 
	`SLSI_ERR
(
dev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

2168 
	`kä“
(
mib_d©a
.
d©a
);

2171  
”rÜ
;

2172 
	}
}

2174 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


2175 
	$¦si_£t_mib_´eã¼ed_ª‹Âa
(
¦si_dev
 *
dev
, 
u16
 
v®ue
)

2177 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

2178 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

2180 ià(
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
SLSI_PSID_UNIFI_PREFERRED_ANTENNA_BITMAP
,

2181 
v®ue
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

2182 ià(
mib_d©a
.
d©aL’gth
) {

2183 
”rÜ
 = 
	`¦si_mlme_£t
(
dev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

2184 ià(
”rÜ
)

2185 
	`SLSI_ERR
(
dev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

2186 
	`kä“
(
mib_d©a
.
d©a
);

2189  
”rÜ
;

2190 
	}
}

2193 
	$¦si_»£t_throughput_¡©s
(
Ãt_deviû
 *
dev
)

2195 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2196 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2197 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

2198 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

2200 ià(
	`¦si_mib_’code_št
(&
mib_d©a
, 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, 0, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

2201 ià(
mib_d©a
.
d©aL’gth
) {

2202 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

2203 ià(
”rÜ
)

2204 
	`SLSI_ERR
(
sdev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

2205 
	`kä“
(
mib_d©a
.
d©a
);

2207 
	}
}

2209 
	$¦si_g‘_mib_rßm
(
¦si_dev
 *
sdev
, 
u16
 
psid
, *
mib_v®ue
)

2211 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2212 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2213 
rx_Ën
 = 0;

2214 
r
;

2215 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
psid
, { 0, 0 } } };

2217 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2218 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2219  -
ENOMEM
;

2221 
mibr¥
.
d©aL’gth
 = 64;

2222 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2223 ià(!
mibr¥
.
d©a
) {

2224 
	`kä“
(
mib»q
.
d©a
);

2225  -
ENOMEM
;

2228 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ën
);

2229 
	`kä“
(
mib»q
.
d©a
);

2231 ià(
r
 == 0) {

2232 
¦si_mib_v®ue
 *
v®ues
;

2234 
mibr¥
.
d©aL’gth
 = (
u32
)
rx_Ën
;

2236 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2238 ià(!
v®ues
) {

2239 
	`kä“
(
mibr¥
.
d©a
);

2240  -
EINVAL
;

2243 
	`WARN_ON
(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 ||

2244 
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_NONE
);

2246 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_INT
)

2247 *
mib_v®ue
 = ()(
v®ues
->
u
.
štV®ue
);

2248 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2249 *
mib_v®ue
 = ()(
v®ues
->
u
.
uštV®ue
);

2250 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_BOOL
)

2251 *
mib_v®ue
 = ()(
v®ues
->
u
.
boŞV®ue
);

2253 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "MIB v®uğ%d\n", *
mib_v®ue
);

2254 
	`kä“
(
v®ues
);

2256 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

2259 
	`kä“
(
mibr¥
.
d©a
);

2260  
r
;

2261 
	}
}

2263 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


2264 
	$¦si_mib_g‘_gsÿn_ÿp
(
¦si_dev
 *
sdev
, 
¦si_Æ_gsÿn_ÿ·b™›s
 *
ÿp
)

2266 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2267 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2268 
rx_Ën
 = 0;

2269 
r
;

2270 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_GOOGLE_MAX_NUMBER_OF_PERIODIC_SCANS
, { 0, 0 } },

2271 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_RSSI_SAMPLE_SIZE
, { 0, 0 } },

2272 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_HOTLIST_APS
, { 0, 0 } },

2273 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_SIGNIFICANT_WIFI_CHANGE_APS
, { 0, 0 } },

2274 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_BSSID_HISTORY_ENTRIES
, { 0, 0 } },};

2276 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2277 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2278  -
ENOMEM
;

2280 
mibr¥
.
d©aL’gth
 = 64;

2281 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2282 ià(!
mibr¥
.
d©a
) {

2283 
	`kä“
(
mib»q
.
d©a
);

2284  -
ENOMEM
;

2287 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ën
);

2288 
	`kä“
(
mib»q
.
d©a
);

2290 ià(
r
 == 0) {

2291 
¦si_mib_v®ue
 *
v®ues
;

2293 
mibr¥
.
d©aL’gth
 = (
u32
)
rx_Ën
;

2295 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2297 ià(!
v®ues
) {

2298 
	`kä“
(
mibr¥
.
d©a
);

2299  -
EINVAL
;

2302 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2303 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[0].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2304 
ÿp
->
max_sÿn_buck‘s
 = 
v®ues
[0].
u
.
uštV®ue
;

2307 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2308 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[1].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2309 
ÿp
->
max_rssi_§m¶e_size
 = 
v®ues
[1].
u
.
uštV®ue
;

2312 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2313 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[2].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2314 
ÿp
->
max_hÙli¡_­s
 = 
v®ues
[2].
u
.
uštV®ue
;

2317 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2318 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[3].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2319 
ÿp
->
max_signifiÿÁ_wifi_chªge_­s
 = 
v®ues
[3].
u
.
uštV®ue
;

2322 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2323 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[4].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2324 
ÿp
->
max_bssid_hi¡Üy_’Œ›s
 = 
v®ues
[4].
u
.
uštV®ue
;

2327 
	`kä“
(
v®ues
);

2329 
	`kä“
(
mibr¥
.
d©a
);

2330  
r
;

2331 
	}
}

2334 
	$¦si_mib_g‘_­f_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2336 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2337 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2338 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2339 
d©a_Ëngth
 = 0;

2340 
r
 = 0;

2341 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {

2342 { 
SLSI_PSID_UNIFI_APF_VERSION
, { 0, 0 } },

2343 { 
SLSI_PSID_UNIFI_APF_MAX_SIZE
, { 0, 0 } }

2346 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)),

2347 
g‘_v®ues
);

2348 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2349  -
ENOMEM
;

2352 
mibr¥
.
d©aL’gth
 = 30;

2353 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2355 ià(!
mibr¥
.
d©a
) {

2356 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "failedo‡llocate memory\n");

2357 
	`kä“
(
mib»q
.
d©a
);

2358  -
ENOMEM
;

2361 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

2362 
mibr¥
.
d©aL’gth
, &
d©a_Ëngth
);

2363 
	`kä“
(
mib»q
.
d©a
);

2365 ià(
r
 == 0) {

2366 
mibr¥
.
d©aL’gth
 = (
u32
)
d©a_Ëngth
;

2367 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
,

2368 ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)), get_values);

2369 ià(!
v®ues
) {

2370 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

2371 
	`kä“
(
mibr¥
.
d©a
);

2372  -
ENOMEM
;

2375 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2376 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
v”siÚ
 = 
v®ues
[0].
u
.
uštV®ue
;

2378 
	`SLSI_ERR
(
sdev
, "invalidype. index:%d\n", 0);

2379 ià(
v®ues
[1].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2380 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
max_Ëngth
 = 
v®ues
[1].
u
.
uštV®ue
;

2382 
	`SLSI_ERR
(
sdev
, "invalidype. index:%d\n", 1);

2384 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_g‘_»q faedÔesuÉ:0x%4x)\n", 
r
);

2387 
	`kä“
(
mibr¥
.
d©a
);

2388 
	`kä“
(
v®ues
);

2389  
r
;

2390 
	}
}

2392 
	$¦si_mib_g‘_¹t_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_¹t_ÿ·b™›s
 *
ÿp
)

2394 
¦si_mib_d©a
 
suµÜ‹d_¹t_ÿ·b
 = { 0, 
NULL
 };

2395 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2396 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2397 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_RTT_CAPABILITIES
, { 0, 0 } } };

2399 
mibr¥
.
d©aL’gth
 = 64;

2400 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2401 ià(!
mibr¥
.
d©a
) {

2402 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

2403 
	`kä“
(
mibr¥
.
d©a
);

2404  -
ENOMEM
;

2407 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 1, &
mibr¥
);

2408 ià(!
v®ues
) {

2409 
	`kä“
(
mibr¥
.
d©a
);

2410  -
EINVAL
;

2413 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
) {

2414 
	`SLSI_ERR
(
sdev
, "Inv®idy³ (%dèfÜ SLSI_PSID_UNIFI_RTT_CAPABILITIES", 
v®ues
[0].
ty³
);

2415 
	`kä“
(
mibr¥
.
d©a
);

2416 
	`kä“
(
v®ues
);

2417  -
EINVAL
;

2419 
suµÜ‹d_¹t_ÿ·b
 = 
v®ues
[0].
u
.
où‘V®ue
;

2420 ià(!
suµÜ‹d_¹t_ÿ·b
.
d©a
) {

2421 
	`kä“
(
mibr¥
.
d©a
);

2422 
	`kä“
(
v®ues
);

2423  -
EINVAL
;

2425 
ÿp
->
¹t_Úe_sided_suµÜ‹d
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[0];

2426 
ÿp
->
¹t_ám_suµÜ‹d
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[1];

2427 
ÿp
->
lci_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[2];

2428 
ÿp
->
lü_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[3];

2429 
ÿp
->
»¥Úd”_suµÜ‹d
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[4];

2430 
ÿp
->
´—mbË_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[5];

2431 
ÿp
->
bw_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[6];

2432 
ÿp
->
mc_v”siÚ
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[7];

2434 
	`kä“
(
v®ues
);

2435 
	`kä“
(
mibr¥
.
d©a
);

2437 
	}
}

2439 
¦si_³”
 *
	$¦si_³”_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
aid
)

2441 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2442 
¦si_³”
 *
³”
 = 
NULL
;

2443 
u16
 
queue£t
 = 0;

2445 ià(
	`WARN_ON
(!
aid
)) {

2446 
	`SLSI_NET_ERR
(
dev
, "Invalid‡id(0)„eceived\n");

2447  
NULL
;

2449 
queue£t
 = 
	`MAP_AID_TO_QS
(
aid
);

2452 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2454 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2455  
NULL
;

2457 ià(!
³”_add»ss
) {

2458 
	`SLSI_NET_WARN
(
dev
, "Peer without‡ddress\n");

2459  
NULL
;

2462 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
³”_add»ss
);

2463 ià(
³”
) {

2464 ià(
ndev_vif
->
¡a
.
tdls_’abËd
 && (
³”
->
queue£t
 == 0)) {

2465 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "TDLSƒnabled‡nd its station queueset\n");

2467 
	`SLSI_NET_WARN
(
dev
, "P“¸(MAC:" 
MACSTR
 "è®»adyƒxi¡s\n", 
	`MAC2STR
(
³”_add»ss
));

2468  
NULL
;

2472 ià(
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
queue£t
)) {

2473 
	`SLSI_NET_WARN
(
dev
, "P“¸(queue£t:%dè®»adyƒxi¡s\n", 
queue£t
);

2474  
NULL
;

2477 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "%pM,‡id:%d\n", 
³”_add»ss
, 
aid
);

2479 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
];

2480 ià(!
³”
) {

2482 
	`SLSI_NET_ERR
(
dev
, "P“¸(queue£t:%dèi NULL\n", 
queue£t
);

2483  
NULL
;

2486 
³”
->
aid
 =‡id;

2487 
³”
->
queue£t
 = queueset;

2488 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
³”_add»ss
);

2489 
³”
->
assoc_›
 = 
NULL
;

2490 
³”
->
assoc_»¥_›
 = 
NULL
;

2491 
³”
->
is_wps
 = 
çl£
;

2492 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DISCONNECTED
;

2493 
	`¦si_ba_»¶ay_»£t_²
(
dev
, 
³”
);

2495 
	`¦si_³”_»£t_¡©s
(
sdev
, 
dev
, 
³”
);

2496 
³”
->
ndp_couÁ
 = 1;

2497 
	`¿‹lim™_¡©e_š™
(&
³”
->
sšfo_mib_g‘_rs
, 
SLSI_SINFO_MIB_ACCESS_TIMEOUT
, 0);

2499 #ifdeà
CONFIG_SCSC_WLAN_TX_API


2500 ià(
	`¦si_³”_add_po¡
(
sdev
, 
dev
, 
ndev_vif
, 
³”
) < 0) {

2501 
	`SLSI_NET_ERR
(
dev
, "slsi_peer_add_post failed\n");

2502  
NULL
;

2505 ià(
	`scsc_wifi_fcq_ù¾_q_š™
(&
³”
->
ù¾_q
) < 0) {

2506 
	`SLSI_NET_ERR
(
dev
, "scsc_wifi_fcq_ctrl_q_init failed\n");

2507  
NULL
;

2510 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2511 ià(
	`scsc_wifi_fcq_uniÿ¡_q£t_š™
(
dev
, &
³”
->
d©a_qs
,…“r->
queue£t
, 
sdev
, 
ndev_vif
->
iâum
,…eer) < 0) {

2513 ià(
	`scsc_wifi_fcq_uniÿ¡_q£t_š™
(
dev
, &
³”
->
d©a_qs
,…“r->
queue£t
, 
sdev
, 
ndev_vif
->
iâum
,…eer) < 0) {

2515 
	`SLSI_NET_ERR
(
dev
, "scsc_wifi_fcq_unicast_qset_init failed\n");

2516 
	`scsc_wifi_fcq_ù¾_q_deš™
(&
³”
->
ù¾_q
);

2517  
NULL
;

2525 ià(
ndev_vif
->
¡a
.
tdls_’abËd
)

2526 
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
++;

2528 
ndev_vif
->
³”_¡a_»cÜds
++;

2530 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
++;

2531 
	`skb_queue_h—d_š™
(&
³”
->
bufã»d_äames
);

2538 
³”
->
v®id
 = 
Œue
;

2540 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "ü—‹d stiÚ…“¸%pM AID:%d\n", 
³”
->
add»ss
, 
aid
);

2541  
³”
;

2542 
	}
}

2544 
	$¦si_³”_»£t_¡©s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

2546 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2548 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2550 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "P“r:%pM\n", 
³”
->
add»ss
);

2552 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2554 
	`mem£t
(&
³”
->
sšfo
, 0x00, (peer->sinfo));

2555 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

2556 
³”
->
sšfo
.
fËd
 = 
	`BIT
(
NL80211_STA_INFO_RX_BYTES
) |

2557 
	`BIT
(
NL80211_STA_INFO_TX_BYTES
) |

2558 
	`BIT
(
NL80211_STA_INFO_RX_PACKETS
) |

2559 
	`BIT
(
NL80211_STA_INFO_TX_PACKETS
) |

2560 
	`BIT
(
NL80211_STA_INFO_RX_DROP_MISC
) |

2561 
	`BIT
(
NL80211_STA_INFO_TX_FAILED
) |

2562 
	`BIT
(
NL80211_STA_INFO_SIGNAL
) |

2563 
	`BIT
(
NL80211_STA_INFO_BSS_PARAM
);

2565 
³”
->
sšfo
.
fËd
 = 
STATION_INFO_RX_BYTES
 |

2566 
STATION_INFO_TX_BYTES
 |

2567 
STATION_INFO_RX_PACKETS
 |

2568 
STATION_INFO_TX_PACKETS
 |

2569 
STATION_INFO_RX_DROP_MISC
 |

2570 
STATION_INFO_TX_FAILED
 |

2571 
STATION_INFO_SIGNAL
 |

2572 
STATION_INFO_BSS_PARAM
;

2574 
	}
}

2576 
	$¦si_dump_¡©s
(
Ãt_deviû
 *
dev
)

2578 
	`SLSI_UNUSED_PARAMETER
(
dev
);

2580 
	`SLSI_INFO_NODEV
("¦si_hªged_ev’t_couÁ: %d\n", 
¦si_hªged_ev’t_couÁ
);

2581 
	}
}

2583 
	e¦si_wÏn_v’dÜ_©Œ_hªged_ev’t
 {

2584 
	mSLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_PANIC_CODE
 = 1,

2585 
	mSLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_MAX


2588 
	e¦si_wÏn_v’dÜ_©Œ_pow”_m—su»m’t_ev’t
 {

2589 
	mSLSI_WLAN_VENDOR_ATTR_POWER_MEASUREMENT_RESULT
 = 0,

2590 
	mSLSI_WLAN_VENDOR_ATTR_POWER_MEASUREMENT_RESULT_MAX
,

2593 #ià
defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2597 
	$¦si_sub¡™u‹_nuÎ
(*
s
, cÚ¡ 
c
, 
size_t
 
Ëngth
)

2599 
i
;

2601 
i
 = 0; i < 
Ëngth
; i++)

2602 ià(
s
[
i
] == '\0' || s[i] == ' ')

2603 
s
[
i
] = 
c
;

2604 
	}
}

2606 
	$¦si_fl_bigd©a_»cÜd
(
¦si_dev
 *
sdev
, 
scsc_hªged_»cÜd
 *
hr
, *
»suÉ
, 
u16
 
scsc_·nic_code
, cÚ¡ 
size_t
 
»suÉsz
)

2608 
Ëngth
 = (
scsc_hªged_»cÜd
);

2609 
i
 = 0;

2610 
v”siÚ_fw
[
HANGED_FW_VERSION_SIZE
] = {0};

2611 
num_»cÜds
;

2613 
to_hex_¡ršg
[
HANGED_PANIC_RECORD_HEX_SZ
 + 1];

2614 
scsc_fw_»cÜd_t
 
·nic_»cÜd_buf
[
HANGED_PANIC_RECORD_COUNT
];

2617 
	`SLSI_INFO
(
sdev
, "G’”©šg Hªged„ecÜd infÜm©iÚ [%d] [%d]\n", 
Ëngth
, 
»suÉsz
);

2618 
	`mem£t
(
»suÉ
, '\0', 
»suÉsz
);

2619 
	`mem£t
(
hr
, ' ', 
Ëngth
);

2620 
	`memıy
(
hr
->
v”siÚ
, 
HANGED_PANIC_VERSION
, (hr->version));

2621 
	`mxmª_g‘_fw_v”siÚ
(
v”siÚ_fw
, 
HANGED_FW_VERSION_SIZE
);

2622 
	`¢´štf
(
hr
->
fw_v”siÚ
, (hr->fw_v”siÚ), "%s", 
v”siÚ_fw
);

2625 
	`¦si_sub¡™u‹_nuÎ
(
hr
->
fw_v”siÚ
, '_', (hr->fw_version));

2627 
	`¢´štf
(
hr
->
ho¡_v”siÚ
, (hr->ho¡_v”siÚ), "%u.%u.%u.%u.%u", 
SCSC_RELEASE_PRODUCT
, 
SCSC_RELEASE_ITERATION
, 
SCSC_RELEASE_CANDIDATE
, 
SCSC_RELEASE_POINT
, 
SCSC_RELEASE_CUSTOMER
);

2631 
	`memıy
(
hr
->
off£t_d©a
, 
HANGED_OFFSET_DATA
, (HANGED_OFFSET_DATA));

2632 
	`¢´štf
(
hr
->
hªg_ty³
, (hr->hªg_ty³), "%2x", 
scsc_·nic_code
);

2635 
num_»cÜds
 = 
	`scsc_£rviû_g‘_·nic_»cÜd
(
sdev
->
£rviû
, (*)&
·nic_»cÜd_buf
[0], 
HANGED_PANIC_RECORD_SIZE
);

2636 ià(
num_»cÜds
 == 0) {

2637 
	`SLSI_INFO
(
sdev
, "scsc_service_get_panic_record failed -‚um_records = 0\n");

2638 
	`mem£t
(&
hr
->
·nic_»cÜd
, '0', 
HANGED_PANIC_RECORD_SIZE
);

2640 
i
 = 0; i < 
num_»cÜds
; i++) {

2642 
	`¢´štf
(
to_hex_¡ršg
, 
HANGED_PANIC_RECORD_HEX_SZ
 + 1, 
HANGED_PANIC_REC_FORMATTING
, 
·nic_»cÜd_buf
[
i
]);

2643 
	`memıy
(&
hr
->
·nic_»cÜd
[
i
 * 
HANGED_PANIC_RECORD_HEX_SZ
], 
to_hex_¡ršg
, (to_hex_string));

2646 
	`¢´štf
(
»suÉ
, 
»suÉsz
, "% 0 0 0 0 0 0 0 0 %s|%s|%s|%s", 
hr
->
hªg_ty³
, hr->
ho¡_v”siÚ
, hr->
fw_v”siÚ
, hr->
off£t_d©a
, hr->
·nic_»cÜd
);

2648 
	`SLSI_INFO
(
sdev
, "Hªged„ecÜd infÜm©iÚ sŒšg: %s\n", 
»suÉ
);

2649 
	}
}

2652 
	$¦si_£nd_hªged_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
u16
 
scsc_·nic_code
)

2654 
sk_buff
 *
skb
;

2655 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2656 
scsc_hªged_»cÜd
 
hr
;

2657 *
»suÉ
;

2658 
Ëngth
 = (
scsc_hªged_»cÜd
);

2660 
»suÉ
 = 
	`km®loc
(
Ëngth
, 
GFP_KERNEL
);

2661 ià(!
»suÉ
) {

2662 
	`SLSI_ERR_NODEV
("Failedo‡llocate„esult for vendor hangedƒvent");

2663  -
ENOMEM
;

2665 
	`¦si_fl_bigd©a_»cÜd
(
sdev
, &
hr
, 
»suÉ
, 
scsc_·nic_code
, 
Ëngth
);

2667 
Ëngth
 = (
scsc_·nic_code
);

2670 
¦si_hªged_ev’t_couÁ
++;

2671 
	`SLSI_INFO
(
sdev
, "S’dšg SLSI_NL80211_VENDOR_HANGED_EVENT , couÁ: %d,„—sÚ =0x%2x\n", 
¦si_hªged_ev’t_couÁ
, 
scsc_·nic_code
);

2673 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2674 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
Ëngth
, 
SLSI_NL80211_VENDOR_HANGED_EVENT
, 
GFP_KERNEL
);

2676 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
Ëngth
, 
SLSI_NL80211_VENDOR_HANGED_EVENT
, 
GFP_KERNEL
);

2678 ià(!
skb
) {

2679 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for vendor hangedƒvent");

2680 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2682 
	`kä“
(
»suÉ
);

2684  -
ENOMEM
;

2687 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2688 ià(
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_PANIC_CODE
, 
Ëngth
, 
»suÉ
)) {

2689 
	`kä“
(
»suÉ
);

2691 ià(
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_PANIC_CODE
, 
Ëngth
, &
scsc_·nic_code
)) {

2693 
	`SLSI_ERR_NODEV
("Failed‚la_put for…anic code\n");

2694 
	`kä“_skb
(
skb
);

2695  -
EINVAL
;

2697 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2699 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2700 
	`kä“
(
»suÉ
);

2704 
	}
}

2706 
	$¦si_£nd_pow”_m—su»m’t_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
s16
 
pow”_š_db
)

2708 
sk_buff
 *
skb
;

2709 
u8
 
”r
 = 0;

2711 
	`SLSI_INFO
(
sdev
, "S’dšg SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT…ow” = %d dB\n", 
pow”_š_db
);

2713 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2714 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, (
pow”_š_db
),

2715 
SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT
, 
GFP_KERNEL
);

2717 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, (
pow”_š_db
),

2718 
SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT
, 
GFP_KERNEL
);

2720 ià(!
skb
) {

2721 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for…ower measurementƒvent");

2722  -
ENOMEM
;

2724 
”r
 = 
	`Æa_put_s16
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_POWER_MEASUREMENT_RESULT
, 
pow”_š_db
);

2726 ià(
”r
) {

2727 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆfÜ…ow” m—su»m’ˆ»suÉ w™hƒ¼Ü: %d\n", 
”r
);

2728 
	`kä“_skb
(
skb
);

2729  -
EINVAL
;

2731 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2733 
	}
}

2735 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2736 
	$¦si_£nd_fÜw¬d_b—cÚ_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

2737 cÚ¡ 
u8
 *
ssid
, cÚ¡ 
ssid_Ën
, cÚ¡ u8 *
bssid
, u8 
chªÃl
,

2738 cÚ¡ 
u16
 
b—cÚ_št
, cÚ¡ 
u64
 
time¡amp
, cÚ¡ u64 
sys_time
)

2740 
sk_buff
 *
skb
;

2741 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2742 
u8
 
”r
 = 0;

2744 
	`SLSI_DBG2
(
sdev
, 
SLSI_CFG80211
, "Sending SLSI_NL80211_VENDOR_FORWARD_BEACON\n");

2746 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2747 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, &
ndev_vif
->
wdev
, 
NLMSG_DEFAULT_SIZE
,

2748 
SLSI_NL80211_VENDOR_FORWARD_BEACON
, 
GFP_KERNEL
);

2750 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

2751 
SLSI_NL80211_VENDOR_FORWARD_BEACON
, 
GFP_KERNEL
);

2753 ià(!
skb
) {

2754 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for vendor forward_beaconƒvent\n");

2755  -
ENOMEM
;

2758 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SSID
, 
ssid_Ën
, 
ssid
);

2759 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BSSID
, 
ETH_ALEN
, 
bssid
);

2760 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_CHANNEL
, 
chªÃl
);

2761 
”r
 |ğ
	`Æa_put_u16
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BCN_INTERVAL
, 
b—cÚ_št
);

2762 
”r
 |ğ
	`Æa_put_u32
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP1
, (
time¡amp
 & 0x00000000FFFFFFFF));

2763 
”r
 |ğ
	`Æa_put_u32
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP2
,

2764 ((
time¡amp
 >> 32) & 0x00000000FFFFFFFF));

2765 
”r
 |ğ
	`Æa_put_u64_64b™
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SYS_TIME
, 
sys_time
, 0);

2767 ià(
”r
) {

2768 
	`SLSI_ERR_NODEV
("Failed‚la_put for forward_beacon\n");

2769 
	`kä“_skb
(
skb
);

2770  -
EINVAL
;

2772 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2774 
	}
}

2776 
	$¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
»asÚ_code
)

2778 
sk_buff
 *
skb
;

2779 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2780 
u8
 
”r
 = 0;

2782 
	`SLSI_INFO
(
sdev
, "Sending SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT\n");

2784 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2785 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, &
ndev_vif
->
wdev
, (
»asÚ_code
),

2786 
SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
, 
GFP_KERNEL
);

2788 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, (
»asÚ_code
),

2789 
SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
, 
GFP_KERNEL
);

2791 ià(!
skb
) {

2792 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for vendor forward_beacon_abortƒvent\n");

2793  -
ENOMEM
;

2796 
”r
 = 
	`Æa_put_u16
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_ABORT
, 
»asÚ_code
);

2798 ià(
”r
) {

2799 
	`SLSI_ERR_NODEV
("Failed‚la_put for beacon_recv_abort\n");

2800 
	`kä“_skb
(
skb
);

2801  -
EINVAL
;

2803 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2805 
	}
}

2808 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


2809 
	$¦si_‹¡_£nd_hªged_v’dÜ_ev’t
(
Ãt_deviû
 *
dev
)

2811 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2813 
	`SLSI_INFO
(
ndev_vif
->
sdev
, "Test FORCE HANG\n");

2814  
	`¦si_£nd_hªged_v’dÜ_ev’t
(
ndev_vif
->
sdev
, 
SCSC_PANIC_CODE_HOST
 << 15);

2815 
	}
}

2818 
	$¦si_£t_ext_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
›s
, 
›_Ën
, cÚ¡ u8 *
ext_ÿp_mask
)

2820 cÚ¡ 
u8
 *
ext_ÿ·b_›
;

2821 
r
 = 0;

2823 
ext_ÿ·b_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
›s
, 
›_Ën
);

2825 ià(
ext_ÿ·b_›
) {

2826 
u8
 
ext_ÿp_›_Ën
;

2827 
i
 = 0;

2828 
boŞ
 
£t_ext_ÿp
 = 
çl£
;

2830 ià(
›_Ën
 - (
ext_ÿ·b_›
 - 
›s
) < 2) {

2831 
	`SLSI_WARN
(
sdev
,

2832 "ERR: ibufã¸ov”æow.†’:%d, ie_pos:%d\n", 
›_Ën
, 
ext_ÿ·b_›
 - 
›s
);

2833  -
EINVAL
;

2836 
ext_ÿp_›_Ën
 = 
ext_ÿ·b_›
[1];

2837 ià(
ext_ÿ·b_›
 - 
›s
 + 
ext_ÿp_›_Ën
 > 
›_Ën
) {

2838 
	`SLSI_WARN
(
sdev
, "ERR: IeL’(%dè< bufæ’(%d)\n", 
›_Ën
, 
ext_ÿ·b_›
 - 
›s
 + 
ext_ÿp_›_Ën
);

2839  -
EINVAL
;

2841 
ext_ÿ·b_›
 += 2;

2842 
i
 = 0; i < 
ext_ÿp_›_Ën
 && i < 
	`ARRAY_SIZE
(
sdev
->
fw_ext_ÿp_›
); i++) {

2846 ià((~
ext_ÿp_mask
[
i
] & 
ext_ÿ·b_›
[i]è&& !(~ext_ÿp_mask[i] & 
sdev
->
fw_ext_ÿp_›
[i])) {

2847 
£t_ext_ÿp
 = 
Œue
;

2848 
sdev
->
fw_ext_ÿp_›
[
i
] = sdev->fw_ext_ÿp_›[i] | 
ext_ÿ·b_›
[i];

2851 ià(
£t_ext_ÿp
)

2852 
r
 = 
	`¦si_mlme_£t_ext_ÿ·b
(
sdev
, 
dev
, sdev->
fw_ext_ÿp_›
, sdev->
fw_ext_ÿp_›_Ën
);

2854  
r
;

2855 
	}
}

2857 
boŞ
 
	$¦si_£¬ch_›s_fÜ_qos_šdiÿtÜs
(
¦si_dev
 *
sdev
, 
u8
 *
›s
, 
›s_Ën
)

2859 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2861 ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
›s
, 
›s_Ën
)) {

2862 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "QOSƒnabled dueo WLAN_EID_HT_CAPABILITY\n");

2863  
Œue
;

2865 ià(
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
›s
, 
›s_Ën
)) {

2866 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "QOSƒnabled dueo WLAN_EID_VHT_CAPABILITY\n");

2867  
Œue
;

2869 ià(
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, 
›s
, 
›s_Ën
)) {

2870 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "QOSƒnabled dueo WLAN_OUI_TYPE_MICROSOFT_WMM\n");

2871  
Œue
;

2873  
çl£
;

2874 
	}
}

2876 
	$¦si_³”_upd©e_assoc_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
)

2878 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2879 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

2882 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2884 
id
) {

2885 
MLME_CONNECTED_IND
:

2886 
MLME_PROCEDURE_STARTED_IND
:

2887 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
 &&

2888 
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)) {

2889 
	`kä“_skb
(
skb
);

2894 
	`kä“_skb
(
skb
);

2895 
	`WARN_ON
(1);

2899 
	`kä“_skb
(
³”
->
assoc_›
);

2900 
³”
->
assoc_›
 = 
NULL
;

2901 
³”
->
ÿ·b™›s
 = 0;

2902 
³”
->
sšfo
.
assoc_»q_›s
 = 
NULL
;

2903 
³”
->
sšfo
.
assoc_»q_›s_Ën
 = 0;

2905 ià(
	`çpi_g‘_d©®’
(
skb
)) {

2906 
mgmt_hdr_Ën
;

2907 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2908 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2911 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

2913 ià(
	`›“80211_is_assoc_»q
(
mgmt
->
äame_cÚŒŞ
)) {

2914 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
assoc_»q
.
v¬ŸbË
 - (
u8
 *)mgmt);

2915 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

2916 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
assoc_»q
.
ÿ·b_šfo
);

2917 } ià(
	`›“80211_is_»assoc_»q
(
mgmt
->
äame_cÚŒŞ
)) {

2918 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
»assoc_»q
.
v¬ŸbË
 - (
u8
 *)mgmt);

2919 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

2920 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
»assoc_»q
.
ÿ·b_šfo
);

2922 
	`WARN_ON
(1);

2923 
	`kä“_skb
(
skb
);

2927 
	`skb_puÎ
(
skb
, 
mgmt_hdr_Ën
);

2929 
³”
->
assoc_›
 = 
skb
;

2930 
³”
->
sšfo
.
assoc_»q_›s
 = 
skb
->
d©a
;

2931 
³”
->
sšfo
.
assoc_»q_›s_Ën
 = 
skb
->
Ën
;

2932 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(4, 0, 0))

2933 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_ASSOC_REQ_IES
;

2935 
³”
->
qos_’abËd
 = 
	`¦si_£¬ch_›s_fÜ_qos_šdiÿtÜs
(
sdev
, 
skb
->
d©a
, skb->
Ën
);

2937 
	}
}

2939 
	$¦si_³”_upd©e_assoc_r¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
)

2941 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2942 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

2944 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2947 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2949 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

2950 
ex™_w™h_w¬nÚ
;

2952 ià(
id
 !ğ
MLME_CONNECT_IND
 && id !ğ
MLME_ROAMED_IND
 && id !ğ
MLME_REASSOCIATE_IND
) {

2953 
	`SLSI_NET_ERR
(
dev
, "UÃx³ùed id =0x%4x\n", 
id
);

2954 
ex™_w™h_w¬nÚ
;

2957 
	`kä“_skb
(
³”
->
assoc_»¥_›
);

2958 
³”
->
assoc_»¥_›
 = 
NULL
;

2959 
³”
->
ÿ·b™›s
 = 0;

2960 ià(
	`çpi_g‘_d©®’
(
skb
)) {

2961 
mgmt_hdr_Ën
;

2962 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2965 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

2967 ià(
	`›“80211_is_assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

2968 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

2969 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
assoc_»¥
.
ÿ·b_šfo
);

2970 } ià(
	`›“80211_is_»assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

2971 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
»assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

2972 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
»assoc_»¥
.
ÿ·b_šfo
);

2974 
ex™_w™h_w¬nÚ
;

2977 
	`skb_puÎ
(
skb
, 
mgmt_hdr_Ën
);

2978 
³”
->
assoc_»¥_›
 = 
skb
;

2982 
ex™_w™h_w¬nÚ
:

2983 
	`WARN_ON
(1);

2984 
	`kä“_skb
(
skb
);

2985 
	}
}

2987 
	$¦si_³”_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

2989 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2990 
sk_buff
 *
buff_äame
;

2992 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2995 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2997 ià(!
³”
) {

2998 
	`SLSI_NET_WARN
(
dev
, "peer=NULL");

2999  -
EINVAL
;

3002 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "%pM\n", 
³”
->
add»ss
);

3004 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

3005 
buff_äame
) {

3006 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "FLUSHING BUFFERED FRAMES\n");

3007 
	`kä“_skb
(
buff_äame
);

3008 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

3015 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

3016 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

3017 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

3022 
³”
->
v®id
 = 
çl£
;

3023 
³”
->
is_wps
 = 
çl£
;

3024 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DISCONNECTED
;

3026 ià(
	`¦si_is_tdls_³”
(
dev
, 
³”
))

3027 
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
--;

3029 
ndev_vif
->
³”_¡a_»cÜds
--;

3031 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
++;

3032 #ifdeà
CONFIG_SCSC_WLAN_TX_API


3033 
	`¦si_³”_»move_po¡
(
sdev
, 
dev
, 
ndev_vif
, 
³”
);

3035 
	`scsc_wifi_fcq_q£t_deš™
(
dev
, &
³”
->
d©a_qs
, 
sdev
, 
ndev_vif
->
iâum
,…eer);

3036 
	`scsc_wifi_fcq_ù¾_q_deš™
(&
³”
->
ù¾_q
);

3038 
	`kä“_skb
(
³”
->
assoc_›
);

3039 
	`kä“_skb
(
³”
->
assoc_»¥_›
);

3040 
	`mem£t
(
³”
, 0x00, (*peer));

3043 
	}
}

3045 
	$¦si_vif_aùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3047 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3049 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

3052 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3055 
	`WARN_ON
(
ndev_vif
->
³”_¡a_»cÜds
);

3057 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
))

3058  -
EALREADY
;

3060 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

3061 #iâdeà
CONFIG_SCSC_WLAN_TX_API


3063 ià(
	`scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
sdev
,‚dev_vif->
iâum
) < 0)

3064  -
EFAULT
;

3066 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


3067 
	`kä“
(
ndev_vif
->
­
.
aş_d©a_bÏckli¡
);

3068 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
NULL
;

3072 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3074 
	`WARN_ON
(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
);

3076 
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
 = 0;

3077 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
çl£
;

3078 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 = 
çl£
;

3079 
ndev_vif
->
¡a
.
nd_ofæßd_’abËd
 = 
Œue
;

3081 
	`mem£t
(
ndev_vif
->
¡a
.
k“·live_ho¡_g
, 0, (ndev_vif->sta.keepalive_host_tag));

3084 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
 = 0;

3085 
ndev_vif
->
³”_¡a_»cÜds
 = 0;

3086 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3087 
ndev_vif
->
£t_tid_©Œ
.
mode
 = 
SLSI_NETIF_SET_TID_OFF
;

3088 
ndev_vif
->
£t_tid_©Œ
.
uid
 = 0;

3089 
ndev_vif
->
£t_tid_©Œ
.
tid
 = 0;

3090 #ifdeà
CONFIG_SCSC_WLAN_TX_API


3091 ià(!
	`¦si_vif_aùiv©ed_po¡
(
sdev
, 
dev
, 
ndev_vif
))

3092  -
EFAULT
;

3094 
ndev_vif
->
aùiv©ed
 = 
Œue
;

3096 
	}
}

3098 
	$¦si_vif_d—ùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3100 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3101 
i
 = 0;

3104 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3107 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3108 
ndev_vif
->
¡a
.
group_key_£t
 = 
çl£
;

3109 
ndev_vif
->
¡a
.
w•_key_£t
 = 
çl£
;

3110 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_UNSPECIFIED
;

3111 
	`mem£t
(
ndev_vif
->
¡a
.
k“·live_ho¡_g
, 0, (ndev_vif->sta.keepalive_host_tag));

3114 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)

3115 
	`ÿc_d–‘e_t¥ec_li¡
(
sdev
);

3117 ià(
ndev_vif
->
¡a
.
tdls_’abËd
)

3118 
	`WARN
(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
, "vif:%d,dls_³”_¡a_»cÜds:%d",‚dev_vif->
iâum
,‚dev_vif->sta.tdls_peer_sta_records);

3120 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

3121 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

3122 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

3124 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
çl£
;

3125 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

3126 
ndev_vif
->
is_ws_ruÂšg
 = 
çl£
;

3128 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3129 ià(
ndev_vif
->
¡a
.
r¢_›
) {

3130 
	`kä“
(
ndev_vif
->
¡a
.
r¢_›
);

3131 
ndev_vif
->
¡a
.
r¢_›
 = 
NULL
;

3134 
	`¦si_ş—r_low_Ï‹ncy_¡©e
(
dev
);

3138 
ndev_vif
->
aùiv©ed
 = 
çl£
;

3139 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


3140 
	`skb_queue_purge
(&
ndev_vif
->
rx_d©a
.
queue
);

3142 
i
 = 0; i < (
SLSI_ADHOC_PEER_CONNECTIONS_MAX
); i++) {

3143 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

3145 ià(
³”
 &&…“r->
v®id
) {

3146 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
³”
->
assoc_›
)

3147 
	`cfg80211_d–_¡a
(
dev
, 
³”
->
add»ss
, 
GFP_KERNEL
);

3149 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

3150 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

3151 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

3155 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

3156 
	`mem£t
(&
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
, 0, (ndev_vif->ap.last_disconnected_sta));

3157 #iâdeà
CONFIG_SCSC_WLAN_TX_API


3158 
	`scsc_wifi_fcq_q£t_deš™
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
sdev
,‚dev_vif->
iâum
, 
NULL
);

3160 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


3161 
	`kä“
(
ndev_vif
->
­
.
aş_d©a_bÏckli¡
);

3162 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
NULL
;

3166 ià((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
è|| (ndev_vif->iáy³ =ğ
NL80211_IFTYPE_P2P_GO
)) {

3167 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

3168 
sdev
->
p2p_group_exp_äame
 = 
SLSI_PA_INVALID
;

3172 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

3173 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

3174 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

3175 
	`SLSI_NET_ERR
(
dev
, "*#rf#„fest mode set isƒnabled.\n");

3176 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

3178 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

3180 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3183 
	`WARN
(
ndev_vif
->
³”_¡a_»cÜds
, "vif:%d,…“r_¡a_»cÜds:%d",‚dev_vif->
iâum
,‚dev_vif->peer_sta_records);

3185 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3186 ià(
ndev_vif
->
¡a
.
tdls_’abËd
)

3187 
	`WARN
(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
, "vif:%d,dls_peer_sta_records:%d",

3188 
ndev_vif
->
iâum
,‚dev_vif->
¡a
.
tdls_³”_¡a_»cÜds
);

3190 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

3191 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

3192 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

3194 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
çl£
;

3196 #ifdeà
CONFIG_SCSC_WLAN_TX_API


3197 
	`¦si_vif_d—ùiv©ed_po¡
(
sdev
, 
dev
, 
ndev_vif
);

3199 
	}
}

3201 
	$¦si_¡a_›“80211_mode
(
Ãt_deviû
 *
dev
, 
u16
 
cu¼’t_bss_chªÃl_äequ’cy
)

3203 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3204 cÚ¡ 
u8
 *
›
;

3206 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_OPERATION
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3207 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3208 ià(
›
)

3209  
SLSI_80211_MODE_11AC
;

3211 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

3212 ià(
›
)

3213  
SLSI_80211_MODE_11N
;

3215 ià(
cu¼’t_bss_chªÃl_äequ’cy
 > 5000)

3216  
SLSI_80211_MODE_11A
;

3218 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

3219 ià(
›
)

3220  
	`¦si_g‘_suµÜ‹d_mode
(
›
);

3221  -
EINVAL
;

3222 
	}
}

3224 
	$¦si_g‘_¡a_mode
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
Ï¡_³”_mac
)

3226 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3227 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3228 
¦si_³”
 *
Ï¡_³”
;

3229 cÚ¡ 
u8
 *
³”_›
;

3230 
u8
 
›_Ën
 = 0;

3231 
u8
 
¡¬t_chª
 = 0;

3232 
i
 = 0, 
chª_couÁ
 = 0;

3233 cÚ¡ 
u8
 *
suµÜ‹d_chª_›
 = 
NULL
;

3235 
Ï¡_³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
Ï¡_³”_mac
);

3237 ià(!
Ï¡_³”
) {

3238 
	`SLSI_NET_ERR
(
dev
, "Peer‚ot found\n");

3239  -
EINVAL
;

3241 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 0;

3242 #ià(
	`KERNEL_VERSION
(5, 0, 0è<ğ
LINUX_VERSION_CODE
)

3243 ià(
	`cfg80211_fšd_ext_›
(
WLAN_EID_EXT_HE_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3244 
Ï¡_³”
->
assoc_›
->
Ën
))

3245 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 
SLSI_MODE_HE
;

3246 ià(
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3247 
Ï¡_³”
->
assoc_›
->
Ën
))

3248 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 
SLSI_MODE_VHT
;

3250 ià(
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3251 
Ï¡_³”
->
assoc_›
->
Ën
))

3252 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 
SLSI_MODE_VHT
;

3255 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 
SLSI_MODE_LEGACY_HT
;

3257 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜ‹d_bªd
 = 0;

3258 
suµÜ‹d_chª_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPPORTED_CHANNELS
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3259 
Ï¡_³”
->
assoc_›
->
Ën
);

3260 ià((
suµÜ‹d_chª_›
) &&

3261 ((
Ï¡_³”
->
assoc_›
->
Ën
 - (
suµÜ‹d_chª_›
 -†a¡_³”->assoc_›->
d©a
)) > 2)) {

3262 
›_Ën
 = 
suµÜ‹d_chª_›
[1];

3263 ià((
Ï¡_³”
->
assoc_›
->
Ën
 - (
suµÜ‹d_chª_›
 -†a¡_³”->assoc_›->
d©a
)è< (2 + 
›_Ën
))

3264 
sk_suµÜ‹d_bªd
;

3266 
suµÜ‹d_chª_›
 += 2;

3267 
i
 = 0; i < (
›_Ën
 / 2); i++) {

3268 
¡¬t_chª
 = 
suµÜ‹d_chª_›
[2 * 
i
];

3269 
chª_couÁ
 = 
suµÜ‹d_chª_›
[2 * 
i
 + 1];

3270 ià((
¡¬t_chª
 <ğ
MAX_24G_CHANNELS
è&& (
chª_couÁ
 < MAX_24G_CHANNELS))

3271 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜ‹d_bªd
 |ğ
SLSI_2_4_BAND_SUPPORT
;

3272 ià((
¡¬t_chª
 == 36) || (start_chan == 52) || (start_chan == 100) ||

3273 (
¡¬t_chª
 == 149) || (start_chan == 169))

3274 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜ‹d_bªd
 |ğ
SLSI_5_BAND_SUPPORT
;

3276 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜ‹d_bªd
 |ğ
SLSI_6_BAND_SUPPORT
;

3279 
	`SLSI_INFO
(
sdev
, "supported_chan_ie is‚ull\n");

3281 
sk_suµÜ‹d_bªd
:

3282 ià(
ndev_vif
->
­
.
mode
 =ğ
SLSI_80211_MODE_11AC
) {

3283 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3284 
Ï¡_³”
->
assoc_›
->
Ën
);

3285 ià(
³”_›
)

3286  
SLSI_80211_MODE_11AC
;

3288 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3289 
Ï¡_³”
->
assoc_›
->
Ën
);

3290 ià(
³”_›
)

3291  
SLSI_80211_MODE_11N
;

3292  
SLSI_80211_MODE_11A
;

3294 ià(
ndev_vif
->
­
.
mode
 =ğ
SLSI_80211_MODE_11N
) {

3295 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3296 
Ï¡_³”
->
assoc_›
->
Ën
);

3297 ià(
³”_›
)

3298  
SLSI_80211_MODE_11N
;

3299 ià(
ndev_vif
->
­
.
chªÃl_äeq
 > 5000)

3300  
SLSI_80211_MODE_11A
;

3301 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3302 
Ï¡_³”
->
assoc_›
->
Ën
);

3303 ià(
³”_›
)

3304  
	`¦si_g‘_suµÜ‹d_mode
(
³”_›
);

3307 ià(
ndev_vif
->
­
.
chªÃl_äeq
 > 5000)

3308  
SLSI_80211_MODE_11A
;

3310 ià(
ndev_vif
->
­
.
mode
 =ğ
SLSI_80211_MODE_11G
) {

3311 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3312 
Ï¡_³”
->
assoc_›
->
Ën
);

3313 ià(
³”_›
)

3314  
	`¦si_g‘_suµÜ‹d_mode
(
³”_›
);

3317  
SLSI_80211_MODE_11B
;

3318 
	}
}

3320 
	$¦si_pİuÏ‹_bss_»cÜd
(
Ãt_deviû
 *
dev
)

3322 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3323 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3324 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3325 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3326 cÚ¡ 
u8
 *
›
, *
ext_ÿ·b
, *
rm_ÿ·b
, *
ext_d©a
, *
rm_d©a
, *
bss_lßd
;

3327 
ext_ÿ·b_›_Ën
, 
rm_ÿ·b_›_Ën
;

3328 
boŞ
 
ÃighbÜ_»pÜt_b™
 = 0, 
btm
 = 0;

3329 
u16
 
fw_tx_¿‹
;

3330 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_CURRENT_BSS_CHANNEL_FREQUENCY
, { 0, 0 } },

3331 { 
SLSI_PSID_UNIFI_CURRENT_BSS_BANDWIDTH
, { 0, 0 } },

3332 { 
SLSI_PSID_UNIFI_CURRENT_BSS_NSS
, {0, 0} },

3333 { 
SLSI_PSID_UNIFI_AP_MIMO_USED
, {0, 0} },

3334 { 
SLSI_PSID_UNIFI_LAST_BSS_SNR
, {0, 0} },

3335 { 
SLSI_PSID_UNIFI_LAST_BSS_RSSI
, { 0, 0 } },

3336 { 
SLSI_PSID_UNIFI_ROAMING_COUNT
, {0, 0} },

3337 { 
SLSI_PSID_UNIFI_LAST_BSS_TX_DATA_RATE
, { 0, 0 } },

3338 { 
SLSI_PSID_UNIFI_ROAMING_AKM
, {0, 0} } };

3340 
mibr¥
.
d©aL’gth
 = 10 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

3341 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3342 ià(!
mibr¥
.
d©a
) {

3343 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹ fÜ iÁ”çû MIBs\n", 
mibr¥
.
d©aL’gth
);

3344  -
ENOMEM
;

3347 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

3349 
	`mem£t
(&
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
, 0, (ndev_vif->sta.last_connected_bss));

3351 ià(!
v®ues
) {

3352 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

3353 
	`kä“
(
v®ues
);

3354 
	`kä“
(
mibr¥
.
d©a
);

3355  -
EINVAL
;

3359 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3360 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[0].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3361 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
chªÃl_äeq
 = ((
v®ues
[0].
u
.
uštV®ue
) / 2);

3364 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3365 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[1].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3366 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
bªdwidth
 = 
v®ues
[1].
u
.
uštV®ue
;

3369 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3370 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[2].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3371 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ª‹Âa_mode
 = 
v®ues
[2].
u
.
uštV®ue
;

3374 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3375 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[3].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3376 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mimo_u£d
 = 
v®ues
[3].
u
.
uštV®ue
;

3379 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3380 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[4].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3381 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
¢r
 = 
v®ues
[4].
u
.
uštV®ue
;

3384 ià(
v®ues
[5].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3385 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[5].
ty³
, 
SLSI_MIB_TYPE_INT
);

3386 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rssi
 = 
v®ues
[5].
u
.
štV®ue
;

3389 ià(
v®ues
[6].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3390 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[6].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3391 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rßmšg_couÁ
 = 
v®ues
[6].
u
.
uštV®ue
;

3394 ià(
v®ues
[7].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3395 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[7].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3396 
fw_tx_¿‹
 = 
v®ues
[7].
u
.
uštV®ue
;

3397 
	`¦si_decode_fw_¿‹
((
u32
)
fw_tx_¿‹
, 
NULL
,

3398 (*)(&
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
tx_d©a_¿‹
));

3401 ià(
v®ues
[8].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3402 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[8].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3403 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rßmšg_akm
 = 
v®ues
[8].
u
.
uštV®ue
;

3406 
	`kä“
(
v®ues
);

3407 
	`kä“
(
mibr¥
.
d©a
);

3409 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

3410 
	`SLSI_WARN
(
sdev
, "Bss missing dueo out of order msg from firmware!! Cannot collect Big Data\n");

3411  -
EINVAL
;

3414 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
add»ss
,‚dev_vif->¡a.
¡a_bss
->
bssid
);

3416 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mode
 = 
	`¦si_¡a_›“80211_mode
(
dev
,

3417 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
chªÃl_äeq
);

3418 ià(
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mode
 =ğ-
EINVAL
) {

3419 
	`SLSI_ERR
(
sdev
, "slsi_get_bss_info : Supported Rates IE is‚ull");

3420  -
EINVAL
;

3423 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_HS20_IND
,

3424 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

3425 ià(
›
) {

3426 ià((
›
[6] >> 4) == 0)

3427 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
·s¥ošt_v”siÚ
 = 1;

3429 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
·s¥ošt_v”siÚ
 = 2;

3432 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
noi£_Ëv–
 = (ndev_vif->¡a.Ï¡_cÚÃùed_bss.
rssi
 -

3433 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
¢r
);

3435 
ext_ÿ·b
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3436 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3437 
rm_ÿ·b
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RRM_ENABLED_CAPABILITIES
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3438 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3439 
bss_lßd
 = 
	`cfg80211_fšd_›
(
WLAN_EID_QBSS_LOAD
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3440 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3442 ià(
ext_ÿ·b
) {

3443 
ext_ÿ·b_›_Ën
 = 
ext_ÿ·b
[1];

3444 
ext_d©a
 = &
ext_ÿ·b
[2];

3445 ià((
ext_ÿ·b_›_Ën
 >ğ2è&& (
ext_d©a
[1] &

3446 
SLSI_WLAN_EXT_CAPA1_PROXY_ARP_ENABLED
))

3447 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 1;

3448 ià(
ext_ÿ·b_›_Ën
 >= 3) {

3449 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_TFS_ENABLED
)

3450 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 2;

3451 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_WNM_SLEEP_ENABLED
)

3452 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 3;

3453 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_TIM_ENABLED
)

3454 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 4;

3456 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_BSS_TRANSISITION_ENABLED
) {

3457 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 5;

3458 
btm
 = 1;

3460 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_DMS_ENABLED
)

3461 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 6;

3464 ià(
bss_lßd
)

3465 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1;

3466 ià(
rm_ÿ·b
) {

3467 
rm_ÿ·b_›_Ën
 = 
rm_ÿ·b
[1];

3468 
rm_d©a
 = &
rm_ÿ·b
[2];

3469 ià(
rm_ÿ·b_›_Ën
 >= 1) {

3470 
ÃighbÜ_»pÜt_b™
 = 
SLSI_WLAN_RM_CAPA0_NEIGHBOR_REPORT_ENABLED
 & 
rm_d©a
[0];

3471 ià(
SLSI_WLAN_RM_CAPA0_LINK_MEASUREMENT_ENABLED
 & 
rm_d©a
[0])

3472 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 7;

3473 ià(
ÃighbÜ_»pÜt_b™
)

3474 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 8;

3475 ià(
SLSI_WLAN_RM_CAPA0_PASSIVE_MODE_ENABLED
 & 
rm_d©a
[0])

3476 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 9;

3477 ià(
SLSI_WLAN_RM_CAPA0_ACTIVE_MODE_ENABLED
 & 
rm_d©a
[0])

3478 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 10;

3479 ià(
SLSI_WLAN_RM_CAPA0_TABLE_MODE_ENABLED
 & 
rm_d©a
[0])

3480 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 11;

3483 ià(!
ÃighbÜ_»pÜt_b™
 && !
btm
 && !
bss_lßd
)

3484 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 0;

3485 ià(
ÃighbÜ_»pÜt_b™
 !ğ0 && (!
btm
 && !
bss_lßd
))

3486 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 1;

3487 ià(!
ÃighbÜ_»pÜt_b™
 && (
btm
 || 
bss_lßd
))

3488 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 2;

3490 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 3;

3492 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid_Ën
 =‚dev_vif->sta.ssid_len;

3493 
	`memıy
(
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
,‚dev_vif->¡a.ssid,‚dev_vif->¡a.
ssid_Ën
);

3496 
	}
}

3498 
	$¦si_fl_Ï¡_discÚÃùed_¡a_šfo
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3499 cÚ¡ 
u8
 *
Ï¡_³”_mac
, cÚ¡ 
u16
 
»asÚ_code
)

3501 
i
;

3502 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3503 
¦si_³”
 *
Ï¡_³”
;

3504 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3505 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3506 
u16
 
fw_tx_¿‹
;

3507 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_PEER_BANDWIDTH
, { 0, 0 } },

3508 { 
SLSI_PSID_UNIFI_CURRENT_PEER_NSS
, {0, 0} },

3509 { 
SLSI_PSID_UNIFI_PEER_RSSI
, { 0, 0 } },

3510 { 
SLSI_PSID_UNIFI_PEER_TX_DATA_RATE
, { 0, 0 } } };

3512 
	`SLSI_ETHER_COPY
(
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
,

3513 
Ï¡_³”_mac
);

3514 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
»asÚ
 = 
»asÚ_code
;

3515 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
mode
 = 
	`¦si_g‘_¡a_mode
(
dev
, 
Ï¡_³”_mac
);

3516 
Ï¡_³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
Ï¡_³”_mac
);

3517 ià(!
Ï¡_³”
) {

3518 
	`SLSI_NET_ERR
(
dev
, "Peer‚ot found\n");

3519  -
EINVAL
;

3521 
i
 = 0; i < 
	`ARRAY_SIZE
(
g‘_v®ues
); i++)

3522 
g‘_v®ues
[
i
].
šdex
[0] = 
Ï¡_³”
->
aid
;

3524 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_»Œy_·ck‘s
 = 
SLSI_DEFAULT_UNIFI_PEER_RX_RETRY_PACKETS
;

3525 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_bc_mc_·ck‘s
 = 
SLSI_DEFAULT_UNIFI_PEER_RX_BC_MC_PACKETS
;

3526 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ÿ·b™›s
 = 
Ï¡_³”
->capabilities;

3527 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
 = 
SLSI_DEFAULT_UNIFI_PEER_BANDWIDTH
;

3528 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
 = 
SLSI_DEFAULT_UNIFI_PEER_NSS
;

3529 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rssi
 = 
SLSI_DEFAULT_UNIFI_PEER_RSSI
;

3530 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
 = 
SLSI_DEFAULT_UNIFI_PEER_TX_DATA_RATE
;

3532 
mibr¥
.
d©aL’gth
 = 15 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

3533 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3535 ià(!
mibr¥
.
d©a
) {

3536 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹ fÜ iÁ”çû MIBs\n", 
mibr¥
.
d©aL’gth
);

3537  -
ENOMEM
;

3540 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

3542 ià(!
v®ues
) {

3543 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

3544 
	`kä“
(
v®ues
);

3545 
	`kä“
(
mibr¥
.
d©a
);

3546  -
EINVAL
;

3548 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3549 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[0].
ty³
, 
SLSI_MIB_TYPE_INT
);

3550 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
 = 
v®ues
[0].
u
.
štV®ue
;

3553 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3554 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[1].
ty³
, 
SLSI_MIB_TYPE_INT
);

3555 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
 = 
v®ues
[1].
u
.
štV®ue
;

3558 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3559 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[2].
ty³
, 
SLSI_MIB_TYPE_INT
);

3560 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rssi
 = 
v®ues
[2].
u
.
štV®ue
;

3563 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3564 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[3].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3565 
fw_tx_¿‹
 = 
v®ues
[3].
u
.
uštV®ue
;

3566 
	`¦si_decode_fw_¿‹
((
u32
)
fw_tx_¿‹
, 
NULL
,

3567 (*)&
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
);

3570 
	`kä“
(
v®ues
);

3571 
	`kä“
(
mibr¥
.
d©a
);

3574 
	}
}

3576 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3577 
	$¦si_»Œy_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3580 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3581 
¦si_³”
 *
³”
;

3582 
r
 = 0;

3583 
boŞ
 
­_found
 = 
çl£
;

3584 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

3585 cÚ¡ 
u8
 
¦si_ex‹nded_ÿp_mask
[] = { 0xFF, 0xFF, 0xFF, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

3586 
u8
 *
´obe_»q_›s
;

3587 
size_t
 
´obe_»q_›_Ën
;

3589 
­_found
 = 
	`¦si_£Ëù_­_fÜ_cÚÃùiÚ
(
sdev
, 
dev
, 
NULL
, NULL, 
Œue
);

3590 ià(!
­_found
) {

3591 
	`SLSI_NET_ERR
(
dev
, "Could‚ot find BSSID for„econnection\n");

3594 
´obe_»q_›_Ën
 = 
ndev_vif
->probe_req_ie_len;

3595 
´obe_»q_›s
 = 
	`km®loc
(
´obe_»q_›_Ën
, 
GFP_KERNEL
);

3596 ià(
´obe_»q_›s
 && 
´obe_»q_›_Ën
)

3597 
	`memıy
(
´obe_»q_›s
, 
ndev_vif
->´obe_»q_›s,‚dev_vif->
´obe_»q_›_Ën
);

3598 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0) {

3599 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

3602 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

3603 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed\n");

3606 ià(
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
aùiÚ_äame_bm­
,

3607 
ndev_vif
->
¡a
.
aùiÚ_äame_su¥’d_bm­
) != 0) {

3608 
	`SLSI_NET_ERR
(
dev
, "Action frame„eg fail bitmap 0x%x 0x%x\n",

3609 
ndev_vif
->
¡a
.
aùiÚ_äame_bm­
,‚dev_vif->sta.action_frame_bmap);

3613 
r
 = 
	`¦si_£t_boo¡
(
sdev
, 
dev
);

3614 ià(
r
 != 0)

3615 
	`SLSI_NET_ERR
(
dev
, "Rss˜Boo¡ s‘ faed: %d\n", 
r
);

3616 ià(
´obe_»q_›s
 && 
´obe_»q_›_Ën
) {

3617 ()
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_REQUEST
, 
´obe_»q_›s
,

3618 
´obe_»q_›_Ën
);

3620 
r
 = 
	`¦si_£t_ext_ÿp
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
sme
.
›
,‚dev_vif->¡a.sme.
›_Ën
, 
¦si_ex‹nded_ÿp_mask
);

3621 ià(
r
 != 0)

3622 
	`SLSI_NET_ERR
(
dev
, "FaedØ£ˆex‹nded c­ab™y MIB: %d\n", 
r
);

3623 
r
 = 
	`¦si_mlme_cÚÃù
(
sdev
, 
dev
, &
ndev_vif
->
¡a
.
sme
,‚dev_vif->¡a.sme.
chªÃl
,‚dev_vif->¡a.sme.
bssid
);

3624 ià(
r
 != 0) {

3625 
	`SLSI_NET_ERR
(
dev
, "RecÚÃù faed: %d\n", 
r
);

3628 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

3629 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3630 ià(!
³”
) {

3631 
	`SLSI_NET_ERR
(
dev
, "peer‚ot found!\n");

3634 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

3635 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
ndev_vif
->
¡a
.
sme
.
bssid
);

3636 
ndev_vif
->
chª
 =‚dev_vif->
¡a
.
sme
.
chªÃl
;

3638 
	}
}

3640 
	$¦si_ä“_cÚÃùiÚ_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3642 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3644 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
ssid
);

3645 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
NULL
;

3646 
ndev_vif
->
¡a
.
sme
.
ssid_Ën
 = 0;

3647 
	`kä“
(
ndev_vif
->
¡a
.
cÚÃùed_bssid
);

3648 
ndev_vif
->
¡a
.
cÚÃùed_bssid
 = 
NULL
;

3649 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
key
);

3650 
ndev_vif
->
¡a
.
sme
.
key
 = 
NULL
;

3651 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
›
);

3652 
ndev_vif
->
¡a
.
sme
.
›
 = 
NULL
;

3653 
ndev_vif
->
¡a
.
sme
.
›_Ën
 = 0;

3654 
	}
}

3657 
	$¦si_hªdË_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
»asÚ
,

3658 
u8
 *
di§ssoc_r¥_›
, 
u32
 
di§ssoc_r¥_›_Ën
)

3660 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3662 ià(
	`WARN_ON
(!
dev
))

3663 
ex™
;

3665 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "DiscÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

3668 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3670 ià(!
ndev_vif
->
aùiv©ed
) {

3671 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3672 
ex™
;

3675 
ndev_vif
->
vif_ty³
) {

3676 
FAPI_VIFTYPE_STATION
:

3678 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3679 ià(!(
»asÚ
 =ğ
FAPI_REASONCODE_DEAUTHENTICATED_NO_MORE_STATIONS
))

3681 
	`Ãtif_ÿ¼›r_off
(
dev
);

3687 ià(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
) {

3688 ià(!
³”_add»ss
)

3689 
	`SLSI_NET_WARN
(
dev
, "Connection failure\n");

3690 } ià(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

3691 ià(
»asÚ
 =ğ
FAPI_REASONCODE_SYNCHRONISATION_LOSS
) {

3692 
»asÚ
 = 0;

3693 
	`¦si_cÚn_log2us_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
bssid
, 
»asÚ
);

3696 ià(
»asÚ
 =ğ
FAPI_REASONCODE_KEEP_ALIVE_FAILURE
)

3697 
»asÚ
 = 
WLAN_REASON_DEAUTH_LEAVING
;

3699 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3700 ià(
»asÚ
 =ğ
FAPI_REASONCODE_DEAUTHENTICATED_NO_MORE_STATIONS
) {

3701 ià(
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
) {

3702 ià(
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 && 
	`¦si_»Œy_cÚÃùiÚ
(
sdev
, 
dev
)) {

3703 
	`SLSI_INFO
(
sdev
, "Re-connecting\n");

3704 
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 = 
Œue
;

3708 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
çl£
;

3709 
	`¦si_ä“_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
);

3710 
	`Ãtif_ÿ¼›r_off
(
dev
);

3711 
»asÚ
 =„eason & 0x00FF;

3714 ià(
»asÚ
 >= 0x8200 &&„eason <= 0x82FF)

3715 
»asÚ
 =„eason & 0x00FF;

3718 ià(
ndev_vif
->
¡a
.
is_wps
)

3719 
	`SLSI_NET_INFO
(
dev
, "Ignoring Deauth during WPS…rocedure\n");

3721 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

3722 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
,

3723 
çl£
, 
GFP_KERNEL
);

3725 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
,

3726 
GFP_KERNEL
);

3728 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Reûived discÚÃù from AP,„—sÚ = %d\n", 
»asÚ
);

3730 } ià(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_DISCONNECTING
) {

3732 ià(
»asÚ
 =ğ
FAPI_REASONCODE_KEEP_ALIVE_FAILURE
 ||

3733 
»asÚ
 =ğ
FAPI_REASONCODE_SYNCHRONISATION_LOSS
)

3734 
»asÚ
 = 
WLAN_REASON_DEAUTH_LEAVING
;

3735 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

3736 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
Œue
, 
GFP_KERNEL
);

3738 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
GFP_KERNEL
);

3740 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Completion of disconnect from AP\n");

3743 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

3744 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
çl£
, 
GFP_KERNEL
);

3746 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
GFP_KERNEL
);

3748 
	`SLSI_NET_WARN
(
dev
, "discÚÃù iÀwrÚg s‹ vif_¡©us(%d)\n", 
ndev_vif
->
¡a
.
vif_¡©us
);

3751 
ndev_vif
->
¡a
.
is_wps
 = 
çl£
;

3755 ià(!(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

3756 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_UNSPECIFIED
))

3757 
	`¦si_pİuÏ‹_bss_»cÜd
(
dev
);

3759 
	`kä“
(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
);

3760 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
 = 
NULL
;

3761 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 = 0;

3763 
	`mem£t
(
ndev_vif
->
¡a
.
ssid
, 0,‚dev_vif->¡a.
ssid_Ën
);

3764 
	`mem£t
(
ndev_vif
->
¡a
.
bssid
, 0, 
ETH_ALEN
);

3765 
ndev_vif
->
¡a
.
ssid_Ën
 = 0;

3766 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3767 
	`mem£t
(&
ndev_vif
->
’hªûd_¬p_¡©s
, 0, (ndev_vif->enhanced_arp_stats));

3768 
	`mem£t
(
ndev_vif
->
’hªûd_¬p_ho¡_g
, 0, (ndev_vif->enhanced_arp_host_tag));

3769 
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 = 
çl£
;

3772 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3773 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
) {

3774 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
, 0,

3775 (
¦si_rßm_sÿn_chªÃls
));

3777 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3778 
sdev
->
deviû_cÚfig
.
ncho_mode
 = 0;

3779 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 0;

3780 
sdev
->
deviû_cÚfig
.
dfs_sÿn_mode
 = 0;

3781 
sdev
->
deviû_cÚfig
.
dfs_sÿn_mode
 = 0;

3782 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
) {

3783 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
, 0, (
¦si_rßm_sÿn_chªÃls
));

3786 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3787 
	`¦si_rßm_chªÃl_ÿche_´uÃ
(
dev
, 0, 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
);

3789 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

3790 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

3791 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

3794 
FAPI_VIFTYPE_AP
:

3796 
¦si_³”
 *
³”
 = 
NULL
;

3798 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
³”_add»ss
);

3799 ià(!
³”
) {

3800 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "peer NOT found by MAC‡ddress\n");

3801 
ex™
;

3804 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "MAC:%pM is_wps:%d P“¸S‹ = %d\n", 
³”_add»ss
, 
³”
->
is_wps
,…“r->
cÚÃùed_¡©e
);

3805 
	`¦si_fl_Ï¡_discÚÃùed_¡a_šfo
(
sdev
, 
dev
, 
³”_add»ss
, 
»asÚ
);

3806 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

3807 ià(((
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTED
) ||

3808 (
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
)) &&

3809 !(
³”
->
is_wps
))

3810 
	`cfg80211_d–_¡a
(
dev
, 
³”
->
add»ss
, 
GFP_KERNEL
);

3812 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

3813 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

3814 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

3819 ià(
ndev_vif
->
­
.
p2p_gc_keys_£t
 && (ndev_vif->
³”_¡a_»cÜds
 == 0)) {

3820 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "P2PGO - Acquire wakelock‡fter†ast client disconnection\n");

3821 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

3826 
	`SLSI_NET_WARN
(
dev
, "mlme_discÚÃùed_šd(vif:%d, uÃx³ùed viàty³:%d)\n", 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
);

3829 
ex™
:

3831 
	}
}

3833 
	$¦si_ps_pÜt_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
¦si_¡a_cÚn_¡©e
 
s
)

3835 #ifdeà
CONFIG_SCSC_WLAN_TX_API


3836  
	`¦si_tx_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
s
);

3838 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3840 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

3842 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3844 
s
) {

3845 
SLSI_STA_CONN_STATE_DISCONNECTED
:

3846 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "STA disconnected, SET : FCQ - Disabled\n");

3847 
³”
->
authÜized
 = 
çl£
;

3848 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
)

3849 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3850  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3852 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
:

3853 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "STA doing KEY config, SET : FCQ - Disabled\n");

3854 
³”
->
authÜized
 = 
çl£
;

3855 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
)

3856 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3857  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3859 
SLSI_STA_CONN_STATE_CONNECTED
:

3860 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "STA connected, SET : FCQ - Enabled\n");

3861 
³”
->
authÜized
 = 
Œue
;

3862 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

3863 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_OPEN
);

3864  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_OPEN
);

3867 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "SET : FCQ - Disabled\n");

3868 
³”
->
authÜized
 = 
çl£
;

3869 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
)

3870 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3871  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3876 
	}
}

3878 
	$¦si_£t_ušt_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
v®ue
)

3880 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

3881 
r
 = 0;

3883 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "UINT MIB S‘ Reque¡ (PSID = 0x%04X, V®uğ%d)\n", 
psid
, 
v®ue
);

3885 
r
 = 
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
psid
, 
v®ue
, 0);

3886 ià(
r
 =ğ
SLSI_MIB_STATUS_SUCCESS
) {

3887 ià(
mib_d©a
.
d©aL’gth
) {

3888 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

3889 ià(
r
 != 0)

3890 
	`SLSI_ERR
(
sdev
, "MIB (PSID = 0x%04Xè£ˆ”rÜ = %d\n", 
psid
, 
r
);

3891 
	`kä“
(
mib_d©a
.
d©a
);

3894  
r
;

3895 
	}
}

3897 
	$¦si_£nd_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 
msdu_liãtime
)

3899 #ifdeà
CCX_MSDU_LIFETIME_MIB_NA


3900 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

3901 
”rÜ
 = 0;

3903 ià(
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
SLSI_PSID_DOT11_MAX_TRANSMIT_MSDU_LIFETIME
, 
msdu_liãtime
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

3904 ià(
mib_d©a
.
d©aL’gth
) {

3905 
”rÜ
 = 
	`¦si_mlme_£t
(
dev
, 
ndev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

3906 ià(
”rÜ
)

3907 
	`SLSI_ERR
(
dev
, "E¼ S’dšg max msdu†iãtimçed.ƒ¼Ü = %d\n", 
”rÜ
);

3908 
	`kä“
(
mib_d©a
.
d©a
);

3910  
”rÜ
;

3914 
	}
}

3916 
	$¦si_»ad_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 *
msdu_liãtime
)

3918 #ifdeà
CCX_MSDU_LIFETIME_MIB_NA


3919 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

3920 
¦si_mib_d©a
 
mib_»s
 = { 0, 
NULL
 };

3921 
¦si_mib_’Œy
 
mib_v®
;

3922 
”rÜ
 = 0;

3923 
mib_rx_Ën
 = 0;

3924 
size_t
 
Ën
;

3926 
	`SLSI_UNUSED_PARAMETER
(
ndev
);

3928 
mib_»s
.
d©aL’gth
 = 10;

3929 
mib_»s
.
d©a
 = 
	`km®loc
(mib_»s.
d©aL’gth
, 
GFP_KERNEL
);

3931 ià(!
mib_»s
.
d©a
)

3932  -
ENOMEM
;

3934 
	`¦si_mib_’code_g‘
(&
mib_d©a
, 
SLSI_PSID_DOT11_MAX_TRANSMIT_MSDU_LIFETIME
, 0);

3935 
”rÜ
 = 
	`¦si_mlme_g‘
(
dev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
,

3936 
mib_»s
.
d©a
, mib_»s.
d©aL’gth
, &
mib_rx_Ën
);

3937 
	`kä“
(
mib_d©a
.
d©a
);

3939 ià(
”rÜ
) {

3940 
	`SLSI_ERR
(
dev
, "E¼ R—dšg max msdu†iãtimçed.ƒ¼Ü = %d\n", 
”rÜ
);

3941 
	`kä“
(
mib_»s
.
d©a
);

3942  
”rÜ
;

3945 
Ën
 = 
	`¦si_mib_decode
(&
mib_»s
, &
mib_v®
);

3947 ià(
Ën
 != 8) {

3948 
	`kä“
(
mib_»s
.
d©a
);

3949  -
EINVAL
;

3951 *
msdu_liãtime
 = 
mib_v®
.
v®ue
.
u
.
uštV®ue
;

3953 
	`kä“
(
mib_»s
.
d©a
);

3955  
”rÜ
;

3959 
	}
}

3961 
	$¦si_bªd_cfg_upd©e
(
¦si_dev
 *
sdev
, 
bªd
)

3964 
bªd
) {

3965 
SLSI_FREQ_BAND_AUTO
:

3966 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = sdev->
deviû_cÚfig
.
bªd_2G
;

3967 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = sdev->
deviû_cÚfig
.
bªd_5G
;

3968 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


3969 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = 
NULL
;

3972 
SLSI_FREQ_BAND_5GHZ
:

3973 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = 
NULL
;

3974 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = sdev->
deviû_cÚfig
.
bªd_5G
;

3975 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


3976 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = 
NULL
;

3979 
SLSI_FREQ_BAND_2GHZ
:

3980 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = sdev->
deviû_cÚfig
.
bªd_2G
;

3981 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = 
NULL
;

3982 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


3983 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = 
NULL
;

3986 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


3987 
SLSI_FREQ_BAND_2_4GHZ_5GHZ_6GHZ
:

3988 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = sdev->
deviû_cÚfig
.
bªd_2G
;

3989 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = sdev->
deviû_cÚfig
.
bªd_5G
;

3990 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = sdev->
deviû_cÚfig
.
bªd_6G
;

3992 
SLSI_FREQ_BAND_6GHZ
:

3993 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = 
NULL
;

3994 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = 
NULL
;

3995 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = sdev->
deviû_cÚfig
.
bªd_6G
;

3997 
SLSI_FREQ_BAND_5GHZ_6GHZ
:

3998 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = 
NULL
;

3999 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = sdev->
deviû_cÚfig
.
bªd_5G
;

4000 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = sdev->
deviû_cÚfig
.
bªd_6G
;

4002 
SLSI_FREQ_BAND_2_4GHZ_6GHZ
:

4003 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = sdev->
deviû_cÚfig
.
bªd_2G
;

4004 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = 
NULL
;

4005 
sdev
->
why
->
bªds
[
NL80211_BAND_6GHZ
] = sdev->
deviû_cÚfig
.
bªd_6G
;

4011 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
);

4012 
	`¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
sdev
);

4013 
	}
}

4015 
	$¦si_discÚÃù_Ú_bªd_upd©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãw_bªd
)

4017 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4018 
r
;

4020 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

4023 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTING
 &&

4024 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
 &&

4025 !
ndev_vif
->
chª
)

4028 ià((
Ãw_bªd
 =ğ
SLSI_FREQ_BAND_2GHZ
 && 
ndev_vif
->
chª
->
bªd
 =ğ
NL80211_BAND_2GHZ
) ||

4029 (
Ãw_bªd
 =ğ
SLSI_FREQ_BAND_5GHZ
 && 
ndev_vif
->
chª
->
bªd
 =ğ
NL80211_BAND_5GHZ
))

4031 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


4032 ià(
Ãw_bªd
 =ğ
SLSI_FREQ_BAND_6GHZ
 && 
ndev_vif
->
chª
->
bªd
 =ğ
NL80211_BAND_6GHZ
)

4035 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

4036 
	`SLSI_ERR
(
sdev
, "slsi_mlme_disconnect failed, sta_bss is‚ot‡vailable\n");

4037  -
EINVAL
;

4041 
r
 = 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
WLAN_REASON_DEAUTH_LEAVING
, 
Œue
);

4042 ià(
r
 != 0)

4043 
	`SLSI_ERR
(
sdev
, "¦si_mlme_discÚÃù(" 
MACSTR
 ") failed with %d\n",

4044 
	`MAC2STR
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
), 
r
);

4045 
r
 = 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 0, 
NULL
, 0);

4046 ià(
r
 != 0)

4047 
	`SLSI_ERR
(
sdev
, "¦si_hªdË_discÚÃù(" 
MACSTR
 ") failed with %d\n",

4048 
	`MAC2STR
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
), 
r
);

4050 
	}
}

4052 
	$¦si_bªd_upd©e
(
¦si_dev
 *
sdev
, 
bªd
)

4054 
i
, 
r
 = 0;

4055 
Ãt_deviû
 *
dev
;

4056 
Ãtdev_vif
 *
ndev_vif
;

4058 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4060 
	`SLSI_DBG3
(
sdev
, 
SLSI_CFG80211
, "suµÜ‹d_bªd:%d\n", 
bªd
);

4062 ià(
bªd
 =ğ
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
) {

4063 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4067 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
bªd
;

4069 
	`¦si_bªd_cfg_upd©e
(
sdev
, 
bªd
);

4071 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4073 ià(
bªd
 =ğ
SLSI_FREQ_BAND_AUTO
)

4077 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

4078 
i
 = 1; i < (
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1); i++) {

4079 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

4080 ià(!
dev
)

4082 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4083 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

4084 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

4085 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4086 
r
 = 
	`¦si_discÚÃù_Ú_bªd_upd©e
(
sdev
, 
dev
, 
bªd
);

4087 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4088 ià(
r
 != 0)

4091 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

4093  
r
;

4094 
	}
}

4097 
	$¦si_£nd_g¿tu™ous_¬p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4099 
»t
 = 0;

4100 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4101 
sk_buff
 *
¬p
;

4102 
‘hhdr
 *
ehdr
;

4103 cÚ¡ 
u8
 
¬p_hdr
[] = { 0x00, 0x01, 0x08, 0x00, 0x06, 0x04, 0x00, 0x01 };

4104 
¬p_size
 = (
¬p_hdr
è+ 
ETH_ALEN
 + (
ndev_vif
->
add»ss
) + ETH_ALEN + (ndev_vif->ipaddress);

4106 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "\n");

4108 ià(!
ndev_vif
->
add»ss
)

4111 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4113 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4114  -
EINVAL
;

4115 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

4116  -
EINVAL
;

4117 ià(
	`WARN_ON
(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
))

4118  -
EINVAL
;

4120 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "IP:%pI4\n", &
ndev_vif
->
add»ss
);

4122 
¬p
 = 
	`®loc_skb
(
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
¬p_size
, 
GFP_KERNEL
);

4123 ià(!
¬p
) {

4124 
	`SLSI_WARN_NODEV
("”rÜ‡Îoÿtšg skb (Ën: %d)\n", 
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
¬p_size
);

4125  -
ENOMEM
;

4128 
	`skb_»£rve
(
¬p
, 
SLSI_NETIF_SKB_HEADROOM
 - 
	`SLSI_SKB_GET_ALIGNMENT_OFFSET
(arp));

4130 
	`skb_»£t_mac_h—d”
(
¬p
);

4133 
ehdr
 = (
‘hhdr
 *)
	`skb_put
(
¬p
, (ethhdr));

4134 
	`mem£t
(
ehdr
->
h_de¡
, 0xFF, 
ETH_ALEN
);

4135 
	`SLSI_ETHER_COPY
(
ehdr
->
h_sourû
, 
dev
->
dev_addr
);

4136 
ehdr
->
h_´Ùo
 = 
	`ıu_to_be16
(
ETH_P_ARP
);

4139 
	`memıy
(
	`skb_put
(
¬p
, (
¬p_hdr
)),‡rp_hdr, (arp_hdr));

4140 
	`SLSI_ETHER_COPY
(
	`skb_put
(
¬p
, 
ETH_ALEN
), 
dev
->
dev_addr
);

4141 
	`memıy
(
	`skb_put
(
¬p
, (
ndev_vif
->
add»ss
)), &ndev_vif->ipaddress, (ndev_vif->ipaddress));

4142 
	`mem£t
(
	`skb_put
(
¬p
, 
ETH_ALEN
), 0xFF, ETH_ALEN);

4143 
	`memıy
(
	`skb_put
(
¬p
, (
ndev_vif
->
add»ss
)), &ndev_vif->ipaddress, (ndev_vif->ipaddress));

4145 
¬p
->
dev
 = dev;

4146 
¬p
->
´ÙocŞ
 = 
ETH_P_ARP
;

4147 
¬p
->
_summed
 = 
CHECKSUM_UNNECESSARY
;

4148 
¬p
->
queue_m­pšg
 = 
	`¦si_Ãtif_g‘_³”_queue
(0, 0);

4150 
»t
 = 
	`¦si_tx_d©a
(
sdev
, 
dev
, 
¬p
);

4151 ià(
»t
)

4152 
	`kä“_skb
(
¬p
);

4154  
»t
;

4155 
	}
}

4157 cÚ¡ 
u8
 
	gaddr_mask
[6] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };

4158 cÚ¡ 
u8
 
	gsŞic™ed_node_addr_mask
[6] = { 0x33, 0x33, 0xff, 0x00, 0x00, 0x01 };

4160 
	$¦si_ü—‹_·ck‘_f‹r_–em’t
(
u8
 
f‹rid
,

4161 
u8
 
pkt_f‹r_mode
,

4162 
u8
 
num_·‰”n_desc
,

4163 
¦si_mlme_·‰”n_desc
 *
·‰”n_desc
,

4164 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–em
,

4165 *
pkt_f‹rs_Ën
)

4167 
u8
 
pkt_f‹r_hdr
[
SLSI_PKT_FILTER_ELEM_HDR_LEN
] = { 0xdd,

4171 
f‹rid
,

4172 
pkt_f‹r_mode


4174 
u8
 
i
;

4175 
·‰”n_desc_Ën
 = 0;

4177 
	`WARN_ON
(
num_·‰”n_desc
 > 
SLSI_MAX_PATTERN_DESC
);

4179 
	`memıy
(
pkt_f‹r_–em
->
h—d”
, 
pkt_f‹r_hdr
, 
SLSI_PKT_FILTER_ELEM_HDR_LEN
);

4180 
pkt_f‹r_–em
->
num_·‰”n_desc
 =‚um_pattern_desc;

4182 
i
 = 0; i < 
num_·‰”n_desc
; i++) {

4183 
	`memıy
(&
pkt_f‹r_–em
->
·‰”n_desc
[
i
], &·‰”n_desc[i], (
¦si_mlme_·‰”n_desc
));

4184 
·‰”n_desc_Ën
 +ğ
SLSI_PKT_DESC_FIXED_LEN
 + (2 * 
·‰”n_desc
[
i
].
mask_Ëngth
);

4188 
pkt_f‹r_–em
->
h—d”
[1] = 
SLSI_PKT_FILTER_ELEM_FIXED_LEN
 + 
·‰”n_desc_Ën
;

4189 *
pkt_f‹rs_Ën
 +ğ(
SLSI_PKT_FILTER_ELEM_HDR_LEN
 + 
·‰”n_desc_Ën
);

4191 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "filterid=0x%x,pkt_filter_mode=0x%x,num_pattern_desc=0x%x\n",

4192 
f‹rid
, 
pkt_f‹r_mode
, 
num_·‰”n_desc
);

4193 
	}
}

4195 
	#SLSI_SCREEN_OFF_FILTERS_COUNT
 1

	)

4197 
	$¦si_£t_commÚ_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4199 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
;

4200 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[1];

4201 
pkt_f‹rs_Ën
 = 0;

4202 
u8
 
num_f‹rs
 = 0;

4205 
·‰”n_desc
.
off£t
 = 0;

4206 
·‰”n_desc
.
mask_Ëngth
 = 1;

4207 
·‰”n_desc
.
mask
[0] = 0x01;

4208 
·‰”n_desc
.
·‰”n
[0] = 0x01;

4210 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_BC_MC_FILTER_ID
,

4211 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
 | 
FAPI_PACKETFILTERMODE_OPT_OUT
,

4212 1, &
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4213 
num_f‹rs
++;

4214  
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4215 
	}
}

4217 
	$¦si_£t_¬p_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4219 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[
SLSI_MAX_PATTERN_DESC
];

4220 
num_·‰”n_desc
 = 0;

4221 
pkt_f‹rs_Ën
 = 0;

4222 
u8
 
num_f‹rs
 = 0;

4223 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[2];

4224 
»t
;

4225 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4226 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4228 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

4229  -
EINVAL
;

4231 ià(
	`WARN_ON
(!
³”
è|| WARN_ON(!³”->
assoc_»¥_›
))

4232  -
EINVAL
;

4234 ià(
	`¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
³”
->
assoc_»¥_›
))

4237 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Set ARP filter\n");

4240 
num_·‰”n_desc
 = 0;

4241 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 
ETH_P_ARP
);

4242 
num_·‰”n_desc
++;

4245 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x14;

4246 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 2;

4247 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4248 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[1] = 0xff;

4249 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x00;

4250 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[1] = 0x01;

4251 
num_·‰”n_desc
++;

4253 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_ARP_FILTER_ID
,

4254 
FAPI_PACKETFILTERMODE_OPT_OUT
 | 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4255 
num_·‰”n_desc
, 
·‰”n_desc
,

4256 &
pkt_f‹r_–em
[
num_f‹rs
],

4257 &
pkt_f‹rs_Ën
);

4258 
num_f‹rs
++;

4261 
num_·‰”n_desc
 = 0;

4262 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 
ETH_P_ARP
);

4263 
num_·‰”n_desc
++;

4265 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x26;

4266 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 4;

4267 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
,…©‹º_desc[num_·‰”n_desc].
mask_Ëngth
);

4268 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, &
ndev_vif
->
add»ss
,…©‹º_desc[num_·‰”n_desc].
mask_Ëngth
);

4269 
num_·‰”n_desc
++;

4271 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_ARP_FILTER_ID
,

4272 
FAPI_PACKETFILTERMODE_OPT_IN
 | 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4273 
num_·‰”n_desc
, 
·‰”n_desc
,

4274 &
pkt_f‹r_–em
[
num_f‹rs
],

4275 &
pkt_f‹rs_Ën
);

4276 
num_f‹rs
++;

4278 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4279 ià(
»t
)

4280  
»t
;

4282 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4283 
pkt_f‹rs_Ën
 = 0;

4284 
num_f‹rs
 = 0;

4286 
num_·‰”n_desc
 = 0;

4287 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4288 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4289 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
);

4290 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
sŞic™ed_node_addr_mask
, 3);

4291 
	`memıy
(&
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[3], &
ndev_vif
->
v6add»ss
.
s6_addr
[13], 3);

4292 
num_·‰”n_desc
++;

4295 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 0x86DD);

4296 
num_·‰”n_desc
++;

4298 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x14;

4299 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4300 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4301 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x3a;

4302 
num_·‰”n_desc
++;

4304 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x36;

4305 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4306 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4307 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x87;

4308 
num_·‰”n_desc
++;

4310 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_NS_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_IN
,

4311 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4312 
num_f‹rs
++;

4314 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4315 ià(
»t
)

4316  
»t
;

4319  
»t
;

4320 
	}
}

4322 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4323 
	$¦si_£t_’hªûd_pkt_f‹r
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4325 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

4326 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

4327 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4328 
»t
 = 0;

4329 
is_su¥’d
 = 0;

4330 
pkt_f‹r_’abË
;

4332 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4333 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4335 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
pkt_f‹r_’abË
)) {

4336 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4337 
	`kä“
(
ioùl_¬gs
);

4338  -
EINVAL
;

4341 ià(
pkt_f‹r_’abË
 != 0 &&…kt_filter_enable != 1) {

4342 
	`SLSI_ERR
(
sdev
, "Inv®id…kt_f‹r_’abË v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4343 
	`kä“
(
ioùl_¬gs
);

4344  -
EINVAL
;

4347 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4348 
is_su¥’d
 = 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
;

4349 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4351 ià(
is_su¥’d
) {

4352 
	`SLSI_ERR
(
sdev
, "Host is inƒarly suspend state.\n");

4353 
	`kä“
(
ioùl_¬gs
);

4354  -
EPERM
;

4357 
sdev
->
’hªûd_pkt_f‹r_’abËd
 = 
pkt_f‹r_’abË
;

4358 
	`SLSI_INFO
(
sdev
, "Enhªûd…ack‘ f‹¸i %s", (
pkt_f‹r_’abË
 ? "enabled" : "disabled"));

4359 
	`kä“
(
ioùl_¬gs
);

4360  
»t
;

4361 
	}
}

4363 
	$¦si_£t_İt_out_uniÿ¡_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4365 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
;

4366 
pkt_f‹rs_Ën
 = 0;

4367 
»t
 = 0;

4368 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
;

4371 
·‰”n_desc
.
off£t
 = 0;

4372 
·‰”n_desc
.
mask_Ëngth
 = 
ETH_ALEN
;

4373 
	`mem£t
(
·‰”n_desc
.
mask
, 0xff, 
ETH_ALEN
);

4374 
	`memıy
(
·‰”n_desc
.
·‰”n
, 
dev
->
dev_addr
, 
ETH_ALEN
);

4376 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_OUT_ALL_FILTER_ID
,

4377 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4378 1, &
·‰”n_desc
,

4379 &
pkt_f‹r_–em
, &
pkt_f‹rs_Ën
);

4381 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 1, &
pkt_f‹r_–em
);

4383  
»t
;

4384 
	}
}

4386 
	$¦si_£t_İt_š_tı4_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4388 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[2];

4389 
pkt_f‹rs_Ën
 = 0;

4390 
»t
 = 0;

4391 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
;

4394 
·‰”n_desc
[0].
off£t
 = 
ETH_ALEN
 + ETH_ALEN;

4395 
·‰”n_desc
[0].
mask_Ëngth
 = 2;

4396 
·‰”n_desc
[0].
mask
[0] = 0xff;

4397 
·‰”n_desc
[0].
mask
[1] = 0xff;

4398 
·‰”n_desc
[0].
·‰”n
[0] = 0x08;

4399 
·‰”n_desc
[0].
·‰”n
[1] = 0x00;

4403 
·‰”n_desc
[1].
off£t
 = 23;

4404 
·‰”n_desc
[1].
mask_Ëngth
 = 1;

4405 
·‰”n_desc
[1].
mask
[0] = 0xff;

4406 
·‰”n_desc
[1].
·‰”n
[0] = 
IPPROTO_TCP
;

4407 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP4_FILTER_ID
,

4408 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4410 
·‰”n_desc
,

4411 &
pkt_f‹r_–em
,

4412 &
pkt_f‹rs_Ën
);

4414 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 1, &
pkt_f‹r_–em
);

4416  
»t
;

4417 
	}
}

4419 
	$¦si_£t_İt_š_tı6_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4421 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[2];

4422 
pkt_f‹rs_Ën
 = 0;

4423 
»t
 = 0;

4424 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
;

4427 
·‰”n_desc
[0].
off£t
 = 
ETH_ALEN
 + ETH_ALEN;

4428 
·‰”n_desc
[0].
mask_Ëngth
 = 2;

4429 
·‰”n_desc
[0].
mask
[0] = 0xff;

4430 
·‰”n_desc
[0].
mask
[1] = 0xff;

4431 
·‰”n_desc
[0].
·‰”n
[0] = 0x86;

4432 
·‰”n_desc
[0].
·‰”n
[1] = 0xdd;

4434 
·‰”n_desc
[1].
off£t
 = (
‘hhdr
) + 6;

4435 
·‰”n_desc
[1].
mask_Ëngth
 = 1;

4436 
·‰”n_desc
[1].
mask
[0] = 0xff;

4437 
·‰”n_desc
[1].
·‰”n
[0] = 
IPPROTO_TCP
;

4439 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP6_FILTER_ID
,

4440 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4442 
·‰”n_desc
,

4443 &
pkt_f‹r_–em
,

4444 &
pkt_f‹rs_Ën
);

4446 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 1, &
pkt_f‹r_–em
);

4448  
»t
;

4449 
	}
}

4452 
	$¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4454 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[3];

4455 
pkt_f‹rs_Ën
 = 0;

4456 
u8
 
i
, 
num_f‹rs
 = 0;

4457 
u8
 
num_·‰”n_desc
 = 0;

4458 
»t
 = 0;

4459 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–em
 = 
NULL
;

4460 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4461 
u8
 
mc_f‹r_id
, 
mc_f‹r_couÁ
;

4464 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "S‘ møf‹r ,»gd møadd¸couÁ =%d\n", 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
);

4466 
mc_f‹r_couÁ
 = 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
;

4467 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4468 
pkt_f‹r_–em
 = 
	`km®loc
(((
SLSI_MC_ADDR_ENTRY_MAX
 + 2è* (
¦si_mlme_pkt_f‹r_–em
)), 
GFP_KERNEL
);

4470 
pkt_f‹r_–em
 = 
	`km®loc
(((
SLSI_MC_ADDR_ENTRY_MAX
 + 1è* (
¦si_mlme_pkt_f‹r_–em
)), 
GFP_KERNEL
);

4472 ià(!
pkt_f‹r_–em
) {

4473 
	`SLSI_NET_ERR
(
dev
, "ERROR Memory‡llocation failure\n");

4474  -
ENOMEM
;

4478 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4479 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4480 
	`mem£t
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 0xff, 
ETH_ALEN
);

4481 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
dev
->
dev_addr
, 
ETH_ALEN
);

4482 
num_·‰”n_desc
++;

4484 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 
ETH_ALEN
 + ETH_ALEN;

4485 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 2;

4486 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4487 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[1] = 0xff;

4488 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x08;

4489 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[1] = 0x00;

4490 
num_·‰”n_desc
++;

4492 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = (
‘hhdr
è+ 
	`off£tof
(
hdr
, 
daddr
);

4493 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4494 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xf0;

4495 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0xe0;

4496 
num_·‰”n_desc
++;

4498 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPV4_ID
,

4499 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4500 
num_·‰”n_desc
, 
·‰”n_desc
,

4501 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4502 
num_f‹rs
++;

4504 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4505 
num_·‰”n_desc
 = 0;

4508 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4509 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4510 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
);

4511 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
dev
->
dev_addr
);

4512 
num_·‰”n_desc
++;

4514 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 
ETH_P_IPV6
);

4515 
num_·‰”n_desc
++;

4517 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = (
‘hhdr
è+ 
	`off£tof
(
v6hdr
, 
daddr
);

4518 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4519 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4520 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0xff;

4521 
num_·‰”n_desc
++;

4523 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPV6_ID
,

4524 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4525 
num_·‰”n_desc
, 
·‰”n_desc
,

4526 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4527 
num_f‹rs
++;

4531 
·‰”n_desc
[0].
off£t
 = 0;

4532 
·‰”n_desc
[0].
mask_Ëngth
 = 
ETH_ALEN
;

4533 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[0].
mask
, 
addr_mask
);

4535 
i
 = 0; i < 
mc_f‹r_couÁ
; i++) {

4536 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[0].
·‰”n
, 
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
]);

4537 
mc_f‹r_id
 = 
SLSI_REGD_MC_FILTER_ID
 + 
i
;

4538 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4539 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
)

4540 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
,

4541 
FAPI_PACKETFILTERMODE_OPT_IN
,

4542 1, &
·‰”n_desc
[0],

4543 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4546 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
,

4547 
FAPI_PACKETFILTERMODE_OPT_IN
 |

4548 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4549 1, &
·‰”n_desc
[0],

4550 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4551 
num_f‹rs
++;

4554 
i
 = 
mc_f‹r_couÁ
; i < 
SLSI_MC_ADDR_ENTRY_MAX
; i++) {

4555 
mc_f‹r_id
 = 
SLSI_REGD_MC_FILTER_ID
 + 
i
;

4556 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4557 
num_f‹rs
++;

4560 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4561 
	`kä“
(
pkt_f‹r_–em
);

4563  
»t
;

4564 
	}
}

4566 
	$¦si_ş—r_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4568 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4569 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4571 
u8
 
i
;

4572 
pkt_f‹rs_Ën
 = 0;

4573 
num_f‹rs
 = 0;

4574 
»t
 = 0;

4575 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–em
;

4576 
u8
 
mc_f‹r_id
;

4578 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4580 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

4581  -
EINVAL
;

4583 ià(
	`WARN_ON
(!
³”
è|| WARN_ON(!³”->
assoc_»¥_›
))

4584  -
EINVAL
;

4586 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Clear filters on Screen on");

4589 
num_f‹rs
 = 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
 + 1 + 
SLSI_SCREEN_OFF_FILTERS_COUNT
;

4590 ià((
	`¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
³”
->
assoc_»¥_›
)è=ğ
çl£
) {

4591 
num_f‹rs
++;

4592 
num_f‹rs
++;

4593 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4594 
num_f‹rs
++;

4598 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4599 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

4600 
num_f‹rs
++;

4601 
num_f‹rs
++;

4602 
num_f‹rs
++;

4605 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4606 
num_f‹rs
++;

4608 
pkt_f‹r_–em
 = 
	`km®loc
((
num_f‹rs
 * (
¦si_mlme_pkt_f‹r_–em
)), 
GFP_KERNEL
);

4609 ià(!
pkt_f‹r_–em
) {

4610 
	`SLSI_NET_ERR
(
dev
, "ERROR Memory‡llocation failure");

4611  -
ENOMEM
;

4614 
num_f‹rs
 = 0;

4615 
i
 = 0; i < 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
; i++) {

4616 
mc_f‹r_id
 = 
SLSI_REGD_MC_FILTER_ID
 + 
i
;

4617 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4618 
num_f‹rs
++;

4620 ià((
	`¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
³”
->
assoc_»¥_›
)è=ğ
çl£
) {

4621 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_ARP_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4622 
num_f‹rs
++;

4623 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_ARP_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4624 
num_f‹rs
++;

4625 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4626 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_NS_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4627 
num_f‹rs
++;

4631 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_BC_MC_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4632 
num_f‹rs
++;

4634 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4635 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

4636 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_OUT_ALL_FILTER_ID
, 0, 0, 
NULL
,

4637 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4638 
num_f‹rs
++;

4639 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP4_FILTER_ID
, 0, 0, 
NULL
,

4640 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4641 
num_f‹rs
++;

4642 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP6_FILTER_ID
, 0, 0, 
NULL
,

4643 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4644 
num_f‹rs
++;

4647 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPV4_ID
, 0, 0, 
NULL
,

4648 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4649 
num_f‹rs
++;

4650 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4651 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPV6_ID
, 0, 0, 
NULL
,

4652 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4653 
num_f‹rs
++;

4655 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4656 
	`kä“
(
pkt_f‹r_–em
);

4657  
»t
;

4658 
	}
}

4660 
	$¦si_upd©e_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4662 
»t
 = 0;

4664 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4666 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4667 
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
);

4669 
»t
 = 
	`¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
sdev
, 
dev
);

4670 ià(
»t
)

4671  
»t
;

4673 
»t
 = 
	`¦si_£t_¬p_·ck‘_f‹r
(
sdev
, 
dev
);

4674 ià(
»t
)

4675  
»t
;

4677 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4678 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

4679 
»t
 = 
	`¦si_£t_İt_out_uniÿ¡_·ck‘_f‹r
(
sdev
, 
dev
);

4680 ià(
»t
)

4681  
»t
;

4682 
»t
 = 
	`¦si_£t_İt_š_tı4_·ck‘_f‹r
(
sdev
, 
dev
);

4683 ià(
»t
)

4684  
»t
;

4685 
»t
 = 
	`¦si_£t_İt_š_tı6_·ck‘_f‹r
(
sdev
, 
dev
);

4686 ià(
»t
)

4687  
»t
;

4690  
	`¦si_£t_commÚ_·ck‘_f‹rs
(
sdev
, 
dev
);

4691 
	}
}

4693 
	#IPV6_PF_PATTERN_MASK
 0xf0

	)

4694 
	#IPV6_PF_PATTERN
 0x60

	)

4696 #ifdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


4697 
	#SLSI_ON_CONNECT_FILTERS_COUNT
 1

	)

4699 
	#SLSI_ON_CONNECT_FILTERS_COUNT
 2

	)

4702 
	$¦si_£t_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4704 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[
SLSI_MAX_PATTERN_DESC
];

4705 
num_·‰”n_desc
 = 0;

4706 
pkt_f‹rs_Ën
 = 0;

4707 
num_f‹rs
 = 0;

4709 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[
SLSI_ON_CONNECT_FILTERS_COUNT
];

4710 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4711 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4713 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4716 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

4719 ià(
	`WARN_ON
(!
³”
è|| WARN_ON(!³”->
assoc_»¥_›
))

4722 #ià!(
	`IS_ENABLED
(
CONFIG_IPV6
))

4724 
num_·‰”n_desc
 = 0;

4725 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x0E;

4726 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4727 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 
IPV6_PF_PATTERN_MASK
;

4728 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 
IPV6_PF_PATTERN
;

4729 
num_·‰”n_desc
++;

4731 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_IPV6_PKTS_FILTER_ID
,

4732 
FAPI_PACKETFILTERMODE_OPT_OUT
 | 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4733 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4734 
num_f‹rs
++;

4737 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


4739 cÚ¡ 
u8
 
Çt_ka_·‰”n
[4] = { 0x11, 0x94, 0x00, 0x09 };

4741 
num_·‰”n_desc
 = 0;

4742 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x24;

4743 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 4;

4744 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
, 4);

4745 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
Çt_ka_·‰”n
, 4);

4746 
num_·‰”n_desc
++;

4748 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_NAT_IPSEC_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4749 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4750 
num_f‹rs
++;

4754 ià(
num_f‹rs
)

4755 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4756 
	}
}

4758 
	$¦si__add»ss_chªged
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
add»ss
)

4760 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4761 
»t
 = 0;

4766 ià(
ndev_vif
->
add»ss
 != ipaddress)

4767 
ndev_vif
->
add»ss
 = ipaddress;

4769 ià(
ndev_vif
->
aùiv©ed
 && (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)) {

4770 #ià!(
	`IS_ENABLED
(
CONFIG_IPV6
))

4771 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[1];

4772 
u8
 
num_·‰”ns
 = 0;

4773 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[1];

4774 
pkt_f‹rs_Ën
 = 0;

4775 
u8
 
num_f‹rs
 = 0;

4778 
ndev_vif
->
add»ss
 = ipaddress;

4779 
»t
 = 
	`¦si_mlme_£t__add»ss
(
sdev
, 
dev
);

4780 ià(
»t
 != 0)

4781 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t__add»s ERROR.„‘=%d", 
»t
);

4783 #ià!(
	`IS_ENABLED
(
CONFIG_IPV6
))

4785 
·‰”n_desc
[
num_·‰”ns
].
off£t
 = 0x0E;

4786 
·‰”n_desc
[
num_·‰”ns
].
mask_Ëngth
 = 0x01;

4787 
·‰”n_desc
[
num_·‰”ns
].
mask
[0] = 
IPV6_PF_PATTERN_MASK
;

4788 
·‰”n_desc
[
num_·‰”ns
++].
·‰”n
[0] = 
IPV6_PF_PATTERN
;

4790 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_AP_ALL_IPV6_PKTS_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4791 
num_·‰”ns
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4792 
num_f‹rs
++;

4793 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4794 ià(
»t
 != 0)

4795 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t_·ck‘_f‹¸Ô‘uº :%dèERROR\n", 
»t
);

4797 } ià((
ndev_vif
->
aùiv©ed
) &&

4798 (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) &&

4799 (
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

4800 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4802 ià(
	`WARN_ON
(!
³”
))

4803  -
EINVAL
;

4805 
ndev_vif
->
add»ss
 = ipaddress;

4806 
»t
 = 
	`¦si_mlme_£t__add»ss
(
sdev
, 
dev
);

4807 ià(
»t
 != 0)

4808 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t__add»s ERROR.„‘=%d", 
»t
);

4810 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4811 
»t
 = 
	`¦si_mlme_£t_v6_add»ss
(
sdev
, 
dev
);

4812 ià(
»t
 != 0)

4813 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t_v6_add»s ERROR.„‘=%d", 
»t
);

4815 ià(!(
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) ||

4816 (
ndev_vif
->
¡a
.
group_key_£t
 && 
³”
->
·œwi£_key_£t
) ||

4817 
ndev_vif
->
¡a
.
w•_key_£t
)

4818 
	`¦si_£nd_g¿tu™ous_¬p
(
sdev
, 
dev
);

4820 
ndev_vif
->
¡a
.
g¿tu™ous_¬p_Ãeded
 = 
Œue
;

4822 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

4824  
»t
;

4825 
	}
}

4827 
	#SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
 3

	)

4829 
	$¦si_auto_chª_£Ëù_sÿn
(
¦si_dev
 *
sdev
, 
n_chªÃls
, 
›“80211_chªÃl
 *
chªÃls
[])

4831 
Ãt_deviû
 *
dev
;

4832 
Ãtdev_vif
 *
ndev_vif
;

4833 
sk_buff_h—d
 
unique_sÿn_»suÉs
;

4834 
sÿn_»suÉ_couÁ
[
SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
] = { 0, 0, 0 };

4835 
i
, 
j
;

4836 
r
 = 0;

4837 
£Ëùed_šdex
 = 0;

4838 
mš_šdex
 = 0;

4839 
u32
 
äeqdiff
 = 0;

4841 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4842 
	`SLSI_WARN
(
sdev
, "not supported in WlanLite mode\n");

4843  -
EOPNOTSUPP
;

4846 
	`skb_queue_h—d_š™
(&
unique_sÿn_»suÉs
);

4848 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

4849 ià(!
dev
) {

4850 
r
 = -
EINVAL
;

4851  
r
;

4854 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4855 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

4857 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

4858 
r
 = -
EBUSY
;

4859 
ex™_w™h_vif
;

4861 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
Œue
;

4862 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

4863 
dev
,

4864 
FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
,

4865 
FAPI_REPORTMODE_REAL_TIME
,

4867 
NULL
,

4868 
n_chªÃls
,

4869 
chªÃls
,

4870 
NULL
,

4871 
NULL
,

4873 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


4875 
NULL
,

4877 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

4879 ià(
r
 == 0) {

4880 
sk_buff
 *
unique_sÿn
;

4881 
sk_buff
 *
sÿn
;

4883 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

4884 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

4885 
sÿn
) {

4886 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn
);

4887 
›“80211_chªÃl
 *
chªÃl
;

4890 
	`skb_queue_w®k
(&
unique_sÿn_»suÉs
, 
unique_sÿn
) {

4891 
›“80211_mgmt
 *
unique_mgmt
 = 
	`çpi_g‘_mgmt
(
unique_sÿn
);

4893 ià(
	`com·»_‘h”_addr
(
mgmt
->
bssid
, 
unique_mgmt
->bssid) == 0) {

4894 
	`kä“_skb
(
sÿn
);

4895 
Ãxt_sÿn
;

4899 
	`skb_queue_h—d
(&
unique_sÿn_»suÉs
, 
sÿn
);

4901 
chªÃl
 = 
	`¦si_fšd_sÿn_chªÃl
(
sdev
, 
mgmt
, 
	`çpi_g‘_mgm’
(
sÿn
), 
	`çpi_g‘_u16
(sÿn, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2);

4902 ià(!
chªÃl
)

4903 
Ãxt_sÿn
;

4906 
i
 = 0, 
j
 = 0; i < 
SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
 && 
chªÃls
[j]; i++, j = j + 5) {

4907 ià(
chªÃl
->
ûÁ”_äeq
 =ğ
chªÃls
[
j
]->center_freq) {

4908 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "exaù m©ch:%d\n", 
i
);

4909 
sÿn_»suÉ_couÁ
[
i
] += 5;

4910 
Ãxt_sÿn
;

4912 
äeqdiff
 = 
	`abs
(()
chªÃl
->
ûÁ”_äeq
 - (
chªÃls
[
j
]->center_freq));

4913 ià(
äeqdiff
 <= 20) {

4914 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "ov”Ïµšg:%d, f»qdiff:%d\n", 
i
, 
äeqdiff
);

4915 
sÿn_»suÉ_couÁ
[
i
] +ğ(5 - (
äeqdiff
 / 5));

4919 
Ãxt_sÿn
:

4920 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

4922 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

4925 
i
 = 0, 
j
 = 0; i < 
SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
; i++, j = j + 5) {

4926 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "scÜe[%d]:%d\n", 
i
, 
sÿn_»suÉ_couÁ
[i]);

4927 ià(
sÿn_»suÉ_couÁ
[
i
] <ğsÿn_»suÉ_couÁ[
mš_šdex
]) {

4928 
mš_šdex
 = 
i
;

4929 
£Ëùed_šdex
 = 
j
;

4932 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "£Ëùed:%d w™h scÜe:%d\n", 
£Ëùed_šdex
, 
sÿn_»suÉ_couÁ
[
mš_šdex
]);

4934 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4935 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 
chªÃls
[
£Ëùed_šdex
]->
hw_v®ue
 & 0xFF;

4936 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4938 
	`SLSI_INFO
(
sdev
, "ChªÃÈ£Ëùed = %d", sdev->
deviû_cÚfig
.
­_auto_chª
);

4940 
	`skb_queue_purge
(&
unique_sÿn_»suÉs
);

4941 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

4943 
ex™_w™h_vif
:

4944 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

4945  
r
;

4946 
	}
}

4948 
	$¦si_£t_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4950 
”rÜ
 = 0;

4952 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4953 
”rÜ
 = 
	`¦si_£t_mib_rssi_boo¡
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_BOOST
, 1,

4954 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
);

4955 ià(
”rÜ
)

4956 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg boo¡ v®uFÜ 2g‡á”‡ddšg vif.ƒ¼Ü = %d\n", 
”rÜ
);

4957 
”rÜ
 = 
	`¦si_£t_mib_rssi_boo¡
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_BOOST
, 2,

4958 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
);

4959 ià(
”rÜ
)

4960 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg boo¡ v®ufÜ 5g‡á”‡ddšg vià.ƒ¼Ü = %d\n", 
”rÜ
);

4961 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4962  
”rÜ
;

4963 
	}
}

4969 
	$¦si_p2p_roc_du¿tiÚ_expœy_wÜk
(
wÜk_¡ruù
 *
wÜk
)

4971 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
unsync
.
roc_expœy_wÜk
);

4973 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4978 ià(
ndev_vif
->
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
) {

4979 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "P2P unsync vif is‚ot…resent\n");

4980 
ex™
;

4983 ià(!
ndev_vif
->
chª
) {

4984 
	`SLSI_NET_ERR
(
ndev_vif
->
wdev
.
Ãtdev
, "ndev_vif->chan is‚ull\n");

4985 
ex™
;

4988 
	`SLSI_NET_DBG3
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Send ROCƒxpiredƒvent\n");

4991 ià(
ndev_vif
->
sdev
->
p2p_¡©e
 !ğ
P2P_ACTION_FRAME_TX_RX
) {

4995 ià(!
ndev_vif
->
drv_š_p2p_´oûdu»
) {

4996 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

4997 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

4998 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
unsync
.
un£t_chªÃl_expœy_wÜk
,

4999 
	`m£cs_to_jiff›s
(
SLSI_P2P_UNSET_CHANNEL_EXTRA_MSEC
));

5001 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

5002 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

5005 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,‚dev_vif->
chª
, 
GFP_KERNEL
);

5006 
ex™
:

5007 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5008 
	}
}

5014 
	$¦si_p2p_unsync_vif_d–‘e_wÜk
(
wÜk_¡ruù
 *
wÜk
)

5016 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
unsync
.
d–_vif_wÜk
);

5018 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5019 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Delete vif durationƒxpired - Deactivate unsync vif\n");

5020 
	`¦si_p2p_vif_d—ùiv©e
(
ndev_vif
->
sdev
,‚dev_vif->
wdev
.
Ãtdev
, 
Œue
);

5021 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5022 
	}
}

5028 
	$¦si_p2p_un£t_chªÃl_expœy_wÜk
(
wÜk_¡ruù
 *
wÜk
)

5030 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, netdev_vif,

5031 
unsync
.
un£t_chªÃl_expœy_wÜk
);

5032 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5033 
Ãt_deviû
 *
dev
 = 
ndev_vif
->
wdev
.
Ãtdev
;

5035 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5036 ià(
ndev_vif
->
aùiv©ed
) {

5037 ià(!
ndev_vif
->
drv_š_p2p_´oûdu»
) {

5039 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
NULL
, 0) != 0)

5040 
	`SLSI_NET_ERR
(
dev
, "Clearing Probe Response IEs failed for unsync vif\n");

5041 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

5044 ià(
ndev_vif
->
driv”_chªÃl
 != 0) {

5045 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
,

5047 
	`¦si_mlme_un£t_chªÃl_»q
(
sdev
, 
dev
);

5048 
ndev_vif
->
driv”_chªÃl
 = 0;

5052 
	`SLSI_NET_ERR
(
dev
, "P2P vif is‚ot‡ctivated\n");

5054 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5055 
	}
}

5058 
	$¦si_p2p_š™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
)

5060 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Initialize P2P - Init P2P stateo P2P_IDLE_NO_VIF\n");

5061 
sdev
->
p2p_¡©e
 = 
P2P_IDLE_NO_VIF
;

5062 
sdev
->
p2p_group_exp_äame
 = 
SLSI_PA_INVALID
;

5064 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_DISCOVERY
;

5065 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

5068 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
, 
¦si_p2p_roc_du¿tiÚ_expœy_wÜk
);

5069 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
, 
¦si_p2p_unsync_vif_d–‘e_wÜk
);

5070 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
, 
¦si_p2p_un£t_chªÃl_expœy_wÜk
);

5072 
	}
}

5075 
	$¦si_p2p_deš™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
)

5077 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialize P2P\n");

5079 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

5082 ià(
	`WARN_ON
(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
)))

5083 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

5085 ià(
	`WARN_ON
(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)))

5086 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

5087 
	}
}

5093 
	$¦si_p2p_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, 
boŞ
 
£t_´obe_r¥_›s
)

5095 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5096 
u32
 
af_bm­_aùive
 = 
SLSI_ACTION_FRAME_PUBLIC
;

5097 
u32
 
af_bm­_su¥’ded
 = 
SLSI_ACTION_FRAME_PUBLIC
;

5098 
r
 = 0;

5100 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Activate P2P unsync vif\n");

5102 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5105 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, dev->dev_addr) != 0) {

5106 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed for unsync vif\n");

5107 
ex™_w™h_”rÜ
;

5110 
ndev_vif
->
aùiv©ed
 = 
Œue
;

5111 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

5113 ià(
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
af_bm­_aùive
, 
af_bm­_su¥’ded
) != 0) {

5114 
	`SLSI_NET_ERR
(
dev
, "Action frame„egistration failed for unsync vif\n");

5115 
ex™_w™h_vif
;

5118 ià(
£t_´obe_r¥_›s
) {

5119 
u16
 
pu½o£
 = 
FAPI_PURPOSE_PROBE_RESPONSE
;

5121 ià(!
ndev_vif
->
unsync
.
´obe_r¥_›s
) {

5122 
	`SLSI_NET_ERR
(
dev
, "Probe Response IEs‚ot‡vailable for ROC\n");

5123 
ex™_w™h_vif
;

5126 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
pu½o£
, 
ndev_vif
->
unsync
.
´obe_r¥_›s
,‚dev_vif->unsync.
´obe_r¥_›s_Ën
) != 0) {

5127 
	`SLSI_NET_ERR
(
dev
, "Setting Probe Response IEs for unsync vif failed\n");

5128 
ex™_w™h_vif
;

5130 
ndev_vif
->
unsync
.
›s_chªged
 = 
çl£
;

5133 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0) {

5134 
	`SLSI_NET_ERR
(
dev
, "Set channel failed for unsync vif\n");

5135 
ex™_w™h_vif
;

5137 
ndev_vif
->
chª
 = chan;

5138 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

5141 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

5142 
ex™
;

5144 
ex™_w™h_vif
:

5145 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

5146 
ex™_w™h_”rÜ
:

5147 
r
 = -
EINVAL
;

5148 
ex™
:

5149  
r
;

5150 
	}
}

5153 
	$¦si_p2p_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

5155 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5157 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "De-activate P2P unsync vif\n");

5159 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5161 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
) {

5162 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "P2P unsync vif‡lready deactivated\n");

5167 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

5168 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

5169 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
)

5170 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
çl£
, 
GFP_KERNEL
);

5171 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

5172 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
è&& 
sdev
->
»cov”y_¡©us
) {

5173 ià(
ndev_vif
->
chª
) {

5174 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,

5175 
ndev_vif
->
chª
, 
GFP_KERNEL
);

5177 
	`SLSI_NET_WARN
(
dev
, "There is…ending work for ROCƒxpire. But‚o chan. Cookie = 0x%llx\n",

5178 
ndev_vif
->
unsync
.
roc_cook›
);

5181 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

5183 ià(
hw_avaabË
)

5184 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

5185 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

5187 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

5191 
ndev_vif
->
aùiv©ed
 = 
çl£
;

5192 
ndev_vif
->
chª
 = 
NULL
;

5194 ià(
	`WARN_ON
(
ndev_vif
->
unsync
.
li¡’_ofæßd
))

5195 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

5197 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

5198 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

5200 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_INIT_DEINIT
, "P2P unsync vif deactivated\n");

5201 
	}
}

5208 
	$¦si_p2p_group_¡¬t_»move_unsync_vif
(
¦si_dev
 *
sdev
)

5210 
Ãt_deviû
 *
dev
 = 
NULL
;

5211 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

5213 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Starting P2P Group - Remove unsync vif\n");

5215 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

5216 ià(!
dev
) {

5217 
	`SLSI_ERR
(
sdev
, "Failedo deactivate…2p vif‡s dev is‚ot found\n");

5221 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5223 ià(
	`WARN_ON
(!(
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
))))

5226 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5227 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

5228 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5229 
	}
}

5236 
	$¦si_p2p_dev_´obe_r¥_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
´obe_r¥_›
, 
size_t
 
´obe_r¥_›_Ën
)

5238 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5239 
»t
 = 0;

5241 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

5243 ià(!
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
)) {

5244 
	`SLSI_NET_ERR
(
dev
, "Incorrect vifype - Not unsync vif\n");

5245 
	`kä“
(
´obe_r¥_›
);

5246  -
EINVAL
;

5249 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5251 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Reûived ProbR¥ IE†’ = %zu, Cu¼’ˆIE†’ = %zu\n", 
´obe_r¥_›_Ën
, 
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
);

5253 ià(!
ndev_vif
->
unsync
.
li¡’_ofæßd
) {

5255 ià(
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
 !ğ
´obe_r¥_›_Ën
)

5256 
ndev_vif
->
unsync
.
›s_chªged
 = 
Œue
;

5257 ià(
	`memcmp
(
ndev_vif
->
unsync
.
´obe_r¥_›s
, 
´obe_r¥_›
, 
´obe_r¥_›_Ën
) != 0)

5258 
ndev_vif
->
unsync
.
›s_chªged
 = 
Œue
;

5260 
	`kä“
(
´obe_r¥_›
);

5261 
ex™
;

5264 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
´obe_r¥_›
, 
´obe_r¥_›_Ën
);

5266 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
) {

5267 
»t
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
´obe_r¥_›
, 
´obe_r¥_›_Ën
);

5268 ià(
»t
 != 0) {

5269 
	`SLSI_NET_ERR
(
dev
, "Listen Offloading: Setting Probe Response IEs for unsync vif failed\n");

5270 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

5271 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

5274 
	`kä“
(
´obe_r¥_›
);

5277 
ex™
:

5278 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5279  
»t
;

5280 
	}
}

5288 
	$¦si_p2p_dev_nuÎ_›s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

5290 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5291 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
Œue
};

5293 ià(!
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
)) {

5294 
	`SLSI_NET_ERR
(
dev
, "Incorrect vifype - Not unsync vif\n");

5295  -
EINVAL
;

5298 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5300 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Probe Rsp NULL IEs\n");

5302 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_SCANNING
) {

5303 
sk_buff
 *
sÿn_»suÉ
;

5305 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

5307 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Stop Find - Abort ongoing P2P scan\n");

5309 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, ((
ndev_vif
->
iâum
 << 8è| 
SLSI_SCAN_HW_ID
), 
çl£
);

5311 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5312 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5313 
sÿn_»suÉ
) {

5314 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
sÿn_»suÉ
, 
Œue
);

5315 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5317 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5319 
	`WARN_ON
(!
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
);

5321 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
)

5322 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

5323 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, &
šfo
);

5325 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, 
Œue
);

5328 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
NULL
;

5330 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5332 ià(
ndev_vif
->
aùiv©ed
) {

5336 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Stop Find - Clear Probe Response IEs in firmware\n");

5337 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
NULL
, 0) != 0)

5338 
	`SLSI_NET_ERR
(
dev
, "Clearing Probe Response IEs failed for unsync vif\n");

5339 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

5341 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

5343 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

5347 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5349 
	}
}

5355 
	$¦si_g‘_public_aùiÚ_subty³
(cÚ¡ 
›“80211_mgmt
 *
mgmt
)

5357 
subty³
 = 
SLSI_PA_INVALID
;

5359 
u8
 
p2p_·_äame
[5] = { 0x09, 0x50, 0x6f, 0x9a, 0x09 };

5361 
u8
 
dµ_·_äame
[5] = {0x09, 0x50, 0x6f, 0x9a, 0x1a};

5362 
u8
 *
aùiÚ
 = (u8 *)&
mgmt
->
u
.action.u;

5364 ià(
	`memcmp
(&
aùiÚ
[0], 
p2p_·_äame
, 5) == 0) {

5365 
subty³
 = 
aùiÚ
[5];

5366 } ià(
	`memcmp
(&
aùiÚ
[0], 
dµ_·_äame
, 5) == 0) {

5368 
subty³
 = 
aùiÚ
[6] | 
SLSI_PA_DPP_DUMMY_SUBTYPE_MASK
;

5371 
aùiÚ
[0]) {

5372 
SLSI_PA_GAS_INITIAL_REQ
:

5373 
SLSI_PA_GAS_INITIAL_RSP
:

5374 
SLSI_PA_GAS_COMEBACK_REQ
:

5375 
SLSI_PA_GAS_COMEBACK_RSP
:

5376 
subty³
 = (
aùiÚ
[0] | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
);

5381  
subty³
;

5382 
	}
}

5388 
	$¦si_p2p_g‘_go_Ãg_r¥_¡©us
(
Ãt_deviû
 *
dev
, cÚ¡ 
›“80211_mgmt
 *
mgmt
)

5390 
¡©us
 = -1;

5391 
u8
 
p2p_oui_ty³
[4] = { 0x50, 0x6f, 0x9a, 0x09 };

5392 
u8
 *
aùiÚ
 = (u8 *)&
mgmt
->
u
.action.u;

5393 
u8
 *
v’dÜ_›
 = &
aùiÚ
[7];

5394 
u8
 
›_Ëngth
, 
–em_idx
;

5395 
u16
 
©Œ_Ëngth
;

5397 
v’dÜ_›
 && (*v’dÜ_› =ğ
SLSI_WLAN_EID_VENDOR_SPECIFIC
)) {

5398 
›_Ëngth
 = 
v’dÜ_›
[1];

5400 ià(
	`memcmp
(&
v’dÜ_›
[2], 
p2p_oui_ty³
, 4) == 0) {

5401 
–em_idx
 = 6;

5403 
›_Ëngth
 > 
–em_idx
) {

5404 
©Œ_Ëngth
 = ((
v’dÜ_›
[
–em_idx
 + 1]) | (vendor_ie[elem_idx + 2] << 8));

5406 ià(
v’dÜ_›
[
–em_idx
] =ğ
SLSI_P2P_STATUS_ATTR_ID
) {

5407 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Status Attribute Found,‡ttr_length = %d, value (%u %u %u %u)\n",

5408 
©Œ_Ëngth
, 
v’dÜ_›
[
–em_idx
], vendor_ie[elem_idx + 1], vendor_ie[elem_idx + 2], vendor_ie[elem_idx + 3]);

5409 
¡©us
 = 
v’dÜ_›
[
–em_idx
 + 3];

5412 
–em_idx
 +ğ3 + 
©Œ_Ëngth
;

5417 
v’dÜ_›
 +ğ2 + 
›_Ëngth
;

5420 
	`SLSI_UNUSED_PARAMETER
(
dev
);

5422  
¡©us
;

5423 
	}
}

5429 
u8
 
	$¦si_g‘_exp_³”_äame_subty³
(
u8
 
subty³
)

5431 
subty³
) {

5433 
SLSI_P2P_PA_GO_NEG_REQ
:

5434 
SLSI_P2P_PA_GO_NEG_RSP
:

5435 
SLSI_P2P_PA_INV_REQ
:

5436 
SLSI_P2P_PA_DEV_DISC_REQ
:

5437 
SLSI_P2P_PA_PROV_DISC_REQ
:

5438 
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
:

5439 
SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
:

5440 
SLSI_PA_DPP_AUTHENTICATION_REQ_SUBTYPE
:

5441  
subty³
 + 1;

5443  
SLSI_PA_INVALID
;

5445 
	}
}

5447 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

5448 
u8
 
	$¦si_bss_cÚÃù_ty³_g‘
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
›
, 
size_t
 
›_Ën
)

5450 cÚ¡ 
u8
 *
r¢
;

5451 cÚ¡ 
u8
 *
w·_›
;

5452 
u8
 
akm_ty³
 = 0;

5454 
r¢
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
›
, 
›_Ën
);

5455 
w·_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
›
, 
›_Ën
);

5456 ià(
r¢
) {

5457 
pos
 = 0;

5458 
›_Ën
 = 
r¢
[1] + 2;

5459 
akm_couÁ
 = 0;

5460 
i
 = 0;

5467 ià(
›_Ën
 < 9)

5468  
akm_ty³
;

5469 
pos
 = 7 + 2 + (
r¢
[8] * 4);

5470 
akm_couÁ
 = 
r¢
[
pos
 + 1];

5471 
pos
 += 2;

5472 ià(
›_Ën
 < (
pos
 + 1))

5473  
akm_ty³
;

5474 
i
 = 0; i < 
akm_couÁ
; i++) {

5475 ià(
›_Ën
 < (
pos
 + 1))

5476  
akm_ty³
;

5477 ià(
r¢
[
pos
 + 1] == 0x00 &&„sn[pos + 2] == 0x0f &&„sn[pos + 3] == 0xac) {

5478 ià(
r¢
[
pos
 + 4] == 0x08 ||„sn[pos + 4] == 0x09)

5479 
akm_ty³
 |ğ
SLSI_BSS_SECURED_SAE
;

5480 ià(
r¢
[
pos
 + 4] == 0x02 ||„sn[pos + 4] == 0x04 ||„sn[pos + 4] == 0x06)

5481 
akm_ty³
 |ğ
SLSI_BSS_SECURED_PSK
;

5482 ià(
r¢
[
pos
 + 4] == 0x01 ||„sn[pos + 4] == 0x03)

5483 
akm_ty³
 |ğ
SLSI_BSS_SECURED_1x
;

5485 
pos
 += 4;

5487 } ià(
w·_›
) {

5488 
pos
 = 0;

5489 
›_Ën
 = 
w·_›
[1] + 2;

5490 
akm_couÁ
 = 0;

5491 
i
 = 0;

5499 ià(
›_Ën
 < 13)

5500  
akm_ty³
;

5501 
pos
 = 13 + (
w·_›
[12] * 4);

5502 
akm_couÁ
 = 
w·_›
[
pos
 + 1];

5503 
pos
 += 2;

5504 ià(
›_Ën
 < (
pos
 + 1))

5505  
akm_ty³
;

5506 
i
 = 0; i < 
akm_couÁ
; i++) {

5507 ià(
›_Ën
 < (
pos
 + 1))

5508  
akm_ty³
;

5509 ià(
w·_›
[
pos
 + 1] == 0x00 && wpa_ie[pos + 2] == 0x50 && wpa_ie[pos + 3] == 0xf2) {

5510 ià(
w·_›
[
pos
 + 4] == 0x02)

5511 
akm_ty³
 |ğ
SLSI_BSS_SECURED_PSK
;

5512 ià(
w·_›
[
pos
 + 4] == 0x01)

5513 
akm_ty³
 |ğ
SLSI_BSS_SECURED_1x
;

5514 ià(
w·_›
[
pos
 + 4] == 0x00)

5515 
akm_ty³
 |ğ
SLSI_BSS_SECURED_NO
;

5517 
pos
 += 4;

5520 
akm_ty³
 = 
SLSI_BSS_SECURED_NO
;

5523  
akm_ty³
;

5524 
	}
}

5528 
	$¦si_wÏn_dump_public_aùiÚ_subty³
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
boŞ
 
tx
)

5530 
u8
 
aùiÚ_code
 = ((u8 *)&
mgmt
->
u
.
aùiÚ
.u)[0];

5531 
u8
 
aùiÚ_ÿ‹gÜy
 = 
mgmt
->
u
.
aùiÚ
.
ÿ‹gÜy
;

5532 *
tx_rx_¡ršg
 = "Received";

5533 
wnm_aùiÚ_f›lds
[28][35] = { "Event Request", "Event Report", "Diagnostic Request",

5546 ià(
tx
)

5547 
tx_rx_¡ršg
 = "Send";

5549 
aùiÚ_ÿ‹gÜy
) {

5550 
WLAN_CATEGORY_RADIO_MEASUREMENT
:

5551 
aùiÚ_code
) {

5552 
SLSI_RM_RADIO_MEASUREMENT_REQ
:

5553 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(RadiØM—su»m’ˆReq)\n", 
tx_rx_¡ršg
);

5555 
SLSI_RM_RADIO_MEASUREMENT_REP
:

5556 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(RadiØM—su»m’ˆR•)\n", 
tx_rx_¡ršg
);

5558 
SLSI_RM_LINK_MEASUREMENT_REQ
:

5559 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(Lšk M—su»m’ˆReq)\n", 
tx_rx_¡ršg
);

5561 
SLSI_RM_LINK_MEASUREMENT_REP
:

5562 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(Lšk M—su»m’ˆR•)\n", 
tx_rx_¡ršg
);

5564 
SLSI_RM_NEIGH_REP_REQ
:

5565 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(NeighbÜ R•ÜˆReq)\n", 
tx_rx_¡ršg
);

5567 
SLSI_RM_NEIGH_REP_RSP
:

5568 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(NeighbÜ R•ÜˆRe¥)\n", 
tx_rx_¡ršg
);

5571 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(Re£rved)\n", 
tx_rx_¡ršg
);

5574 
WLAN_CATEGORY_PUBLIC
:

5575 
aùiÚ_code
) {

5576 
SLSI_PA_GAS_INITIAL_REQ
:

5577 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS In™ŸÈReque¡\n", 
tx
 ? "TX" : "RX");

5579 
SLSI_PA_GAS_INITIAL_RSP
:

5580 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS In™ŸÈRe¥Ú£\n", 
tx
 ? "TX" : "RX");

5582 
SLSI_PA_GAS_COMEBACK_REQ
:

5583 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS Comeback Reque¡\n", 
tx
 ? "TX" : "RX");

5585 
SLSI_PA_GAS_COMEBACK_RSP
:

5586 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS Comeback Re¥Ú£\n", 
tx
 ? "TX" : "RX");

5589 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "UnknowÀPubliøAùiÚ F¿m: %d\n", 
aùiÚ_code
);

5592 
WLAN_CATEGORY_WNM
:

5593 ià(
aùiÚ_code
 <ğ
SLSI_WNM_ACTION_FIELD_MAX
)

5594 
	`SLSI_INFO
(
sdev
, "% WNM F¿m(%s)\n", 
tx_rx_¡ršg
, 
wnm_aùiÚ_f›lds
[
aùiÚ_code
]);

5596 
	`SLSI_INFO
(
sdev
, "% WNM F¿m(Re£rved)\n", 
tx_rx_¡ršg
);

5599 
	}
}

5601 
	$¦si_abÜt_¡a_sÿn
(
¦si_dev
 *
sdev
)

5603 
Ãt_deviû
 *
wÏn_Ãt_dev
 = 
NULL
;

5604 
Ãtdev_vif
 *
ndev_vif
;

5605 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
Œue
};

5607 
wÏn_Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

5609 ià(!
wÏn_Ãt_dev
) {

5610 
	`SLSI_ERR
(
sdev
, "Dev‚ot found\n");

5614 
ndev_vif
 = 
	`Ãtdev_´iv
(
wÏn_Ãt_dev
);

5615 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5616 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

5618 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

5619 
sk_buff
 *
sÿn_»suÉ
;

5621 
	`SLSI_DBG2
(
sdev
, 
SLSI_CFG80211
, "Abort ongoing WLAN scan\n");

5622 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
wÏn_Ãt_dev
, ((
ndev_vif
->
iâum
 << 8è| 
SLSI_SCAN_HW_ID
), 
çl£
);

5623 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5624 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5625 
sÿn_»suÉ
) {

5626 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
wÏn_Ãt_dev
, 
sÿn_»suÉ
, 
Œue
);

5627 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5629 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5630 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

5631 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, &
šfo
);

5633 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, 
Œue
);

5636 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
NULL
;

5637 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

5639 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5640 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5641 
	}
}

5647 
	$¦si_is_dhı_·ck‘
(
u8
 *
d©a
)

5649 
u8
 *
p
;

5650 
»t
 = 
SLSI_TX_IS_NOT_DHCP
;

5652 
p
 = 
d©a
 + 
SLSI_IP_TYPE_OFFSET
;

5654 ià(*
p
 =ğ
SLSI_IP_TYPE_UDP
) {

5655 
u16
 
sourû_pÜt
, 
de¡_pÜt
;

5657 
p
 = 
d©a
 + 
SLSI_IP_SOURCE_PORT_OFFSET
;

5658 
sourû_pÜt
 = 
p
[0] << 8 |…[1];

5659 
p
 = 
d©a
 + 
SLSI_IP_DEST_PORT_OFFSET
;

5660 
de¡_pÜt
 = 
p
[0] << 8 |…[1];

5661 ià((
sourû_pÜt
 =ğ
SLSI_DHCP_CLIENT_PORT
è&& (
de¡_pÜt
 =ğ
SLSI_DHCP_SERVER_PORT
))

5662 
»t
 = 
SLSI_TX_IS_DHCP_CLIENT
;

5663 ià((
sourû_pÜt
 =ğ
SLSI_DHCP_SERVER_PORT
è&& (
de¡_pÜt
 =ğ
SLSI_DHCP_CLIENT_PORT
))

5664 
»t
 = 
SLSI_TX_IS_DHCP_SERVER
;

5667  
»t
;

5668 
	}
}

5670 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


5671 
	$¦si_is_tı_sync_·ck‘
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

5673 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5678 ià((
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
è&& (
	`com·»_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_sourû
, 
dev
->
dev_addr
) != 0))

5680 ià(
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
è!ğ
ETH_P_IP
)

5682 ià(
	`_hdr
(
skb
)->
´ÙocŞ
 !ğ
IPPROTO_TCP
)

5684 ià(!
	`skb_Œª¥Üt_h—d”_was_£t
(
skb
))

5686 ià(
	`tı_hdr
(
skb
)->
syn
)

5690 
	}
}

5692 
	$¦si_is_dns_·ck‘
(
u8
 *
d©a
)

5694 
u8
 *
p
;

5696 
p
 = 
d©a
 + 
SLSI_IP_TYPE_OFFSET
;

5698 ià(*
p
 =ğ
SLSI_IP_TYPE_UDP
) {

5699 
u16
 
de¡_pÜt
;

5701 
p
 = 
d©a
 + 
SLSI_IP_DEST_PORT_OFFSET
;

5702 
de¡_pÜt
 = 
p
[0] << 8 |…[1];

5703 ià(
de¡_pÜt
 =ğ
SLSI_DNS_DEST_PORT
)

5708 
	}
}

5710 
	$¦si_is_mdns_·ck‘
(
u8
 *
d©a
)

5712 
u8
 *
p
;

5714 
p
 = 
d©a
 + 
SLSI_IP_TYPE_OFFSET
;

5716 ià(*
p
 =ğ
SLSI_IP_TYPE_UDP
) {

5717 
u16
 
de¡_pÜt
;

5719 
p
 = 
d©a
 + 
SLSI_IP_DEST_PORT_OFFSET
;

5720 
de¡_pÜt
 = 
p
[0] << 8 |…[1];

5721 ià(
de¡_pÜt
 =ğ
SLSI_MDNS_DEST_PORT
)

5725 
	}
}

5728 
	$¦si_­_´•¬e_add_šfo_›s
(
Ãtdev_vif
 *
ndev_vif
, cÚ¡ 
u8
 *
›s
, 
size_t
 
›s_Ën
)

5730 cÚ¡ 
u8
 *
wps_p2p_›s
 = 
NULL
;

5731 
size_t
 
wps_p2p_›_Ën
 = 0;

5734 
wps_p2p_›s
 = 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_VENDOR_SPECIFIC
, 
›s
, 
›s_Ën
);

5735 ià(
wps_p2p_›s
) {

5736 
size_t
 
‹mp_Ën
 = 
wps_p2p_›s
 - 
›s
;

5738 
wps_p2p_›_Ën
 = 
›s_Ën
 - 
‹mp_Ën
;

5741 
	`SLSI_NET_DBG2
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_MLME
, "WPA IE†en = %zu, WMM IE†en = %zu, IEs†en = %zu, WPS_P2P IEs†en = %zu\n",

5742 
ndev_vif
->
­
.
w·_›_Ën
,‚dev_vif->­.
wmm_›_Ën
, 
›s_Ën
, 
wps_p2p_›_Ën
);

5744 
ndev_vif
->
­
.
add_šfo_›s_Ën
 =‚dev_vif->­.
w·_›_Ën
 +‚dev_vif->­.
wmm_›_Ën
 + 
wps_p2p_›_Ën
;

5745 
ndev_vif
->
­
.
add_šfo_›s
 = 
	`km®loc
Òdev_vif->­.
add_šfo_›s_Ën
, 
GFP_KERNEL
);

5747 ià(!
ndev_vif
->
­
.
add_šfo_›s
) {

5748 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_MLME
, "Failedo‡llocate memory for IEs\n");

5749 
ndev_vif
->
­
.
add_šfo_›s_Ën
 = 0;

5750  -
ENOMEM
;

5753 ià(
ndev_vif
->
­
.
ÿche_w·_›
) {

5754 
	`memıy
(
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
ÿche_w·_›
,‚dev_vif->­.
w·_›_Ën
);

5755 
ndev_vif
->
­
.
add_šfo_›s
 +ğndev_vif->­.
w·_›_Ën
;

5758 ià(
ndev_vif
->
­
.
ÿche_wmm_›
) {

5759 
	`memıy
(
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
ÿche_wmm_›
,‚dev_vif->­.
wmm_›_Ën
);

5760 
ndev_vif
->
­
.
add_šfo_›s
 +ğndev_vif->­.
wmm_›_Ën
;

5763 ià(
wps_p2p_›s
) {

5764 
	`memıy
(
ndev_vif
->
­
.
add_šfo_›s
, 
wps_p2p_›s
, 
wps_p2p_›_Ën
);

5765 
ndev_vif
->
­
.
add_šfo_›s
 +ğ
wps_p2p_›_Ën
;

5768 
ndev_vif
->
­
.
add_šfo_›s
 -ğndev_vif->­.
add_šfo_›s_Ën
;

5771 
	}
}

5772 
	$¦si_šdex_fÜ_chª
(
chªÃl
)

5774 
idx
 = 0;

5775 ià(
chªÃl
 <= 14)

5776 
idx
 = 
chªÃl
;

5777 ià(
chªÃl
 >= 36 && channel <= 64)

5778 
idx
 = ((
chªÃl
 - 36) / 4);

5779 ià(
chªÃl
 >= 100 && channel <= 140)

5780 
idx
 = (8 + ((
chªÃl
 - 100) / 4));

5781 ià(
chªÃl
 >= 149 && channel <= 165)

5782 
idx
 = (19 + ((
chªÃl
 - 149) / 4));

5783 ià(
chªÃl
 <= 14)

5784  
idx
;

5786  15 + 
idx
;

5787 
	}
}

5790 
	$¦si_rßm_chªÃl_ÿche_add_chªÃl
(
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
, 
u8
 
chªÃl
)

5792 ià(
chªÃl
 <= 14)

5793 
ÃtwÜk_m­
->
chªÃls_24_ghz
 |ğ(1 << 
chªÃl
);

5794 ià(
chªÃl
 >= 36 && channel <= 64)

5795 
ÃtwÜk_m­
->
chªÃls_5_ghz
 |ğ(1 << ((
chªÃl
 - 36) / 4));

5796 ià(
chªÃl
 >= 100 && channel <= 140)

5797 
ÃtwÜk_m­
->
chªÃls_5_ghz
 |ğ(1 << (8 + ((
chªÃl
 - 100) / 4)));

5798 ià(
chªÃl
 >= 149 && channel <= 165)

5799 
ÃtwÜk_m­
->
chªÃls_5_ghz
 |ğ(1 << (24 + ((
chªÃl
 - 149) / 4)));

5800 
	}
}

5802 
	$¦si_rßm_chªÃl_ÿche_add_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, cÚ¡ u8 *
bssid
, u8 
chªÃl
)

5804 
li¡_h—d
 *
pos
;

5805 
found
 = 0;

5806 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5807 
idx
;

5809 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5810 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, ¦si_rßmšg_ÃtwÜk_m­_’Œy, 
li¡
);

5812 ià(
ÃtwÜk_m­
->
ssid
.
ssid_Ën
 == ssid[1] &&

5813 
	`memcmp
(
ÃtwÜk_m­
->
ssid
.ssid, &ssid[2], ssid[1]) == 0) {

5814 
found
 = 1;

5815 
ÃtwÜk_m­
->
Ï¡_£’_jiff›s
 = 
jiff›s
;

5816 
idx
 = 
	`¦si_šdex_fÜ_chª
(
chªÃl
);

5817 
ÃtwÜk_m­
->
chªÃl_jiff›s
[
idx
] = 
jiff›s
;

5818 ià(
ÃtwÜk_m­
->
Úly_Úe_­_£’
 && 
	`memcmp
Ò‘wÜk_m­->
š™Ÿl_bssid
, 
bssid
, 
ETH_ALEN
) != 0)

5819 
ÃtwÜk_m­
->
Úly_Úe_­_£’
 = 
çl£
;

5820 
	`¦si_rßm_chªÃl_ÿche_add_chªÃl
(
ÃtwÜk_m­
, 
chªÃl
);

5824 ià(!
found
) {

5825 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

5827 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "New EÁry : ChªÃl: %d : %.*s\n", 
chªÃl
, 
ssid
[1], &ssid[2]);

5828 
ÃtwÜk_m­
 = 
	`km®loc
((*ÃtwÜk_m­), 
GFP_ATOMIC
);

5829 ià(
ÃtwÜk_m­
) {

5830 
ÃtwÜk_m­
->
ssid
.
ssid_Ën
 = ssid[1];

5831 
	`memıy
(
ÃtwÜk_m­
->
ssid
.ssid, &ssid[2], ssid[1]);

5832 
ÃtwÜk_m­
->
chªÃls_24_ghz
 = 0;

5833 
ÃtwÜk_m­
->
chªÃls_5_ghz
 = 0;

5834 
ÃtwÜk_m­
->
Ï¡_£’_jiff›s
 = 
jiff›s
;

5835 
idx
 = 
	`¦si_šdex_fÜ_chª
(
chªÃl
);

5836 
ÃtwÜk_m­
->
chªÃl_jiff›s
[
idx
] = 
jiff›s
;

5837 
	`SLSI_ETHER_COPY
(
ÃtwÜk_m­
->
š™Ÿl_bssid
, 
bssid
);

5838 
ÃtwÜk_m­
->
Úly_Úe_­_£’
 = 
Œue
;

5839 
	`¦si_rßm_chªÃl_ÿche_add_chªÃl
(
ÃtwÜk_m­
, 
chªÃl
);

5840 
	`li¡_add
(&
ÃtwÜk_m­
->
li¡
, &
ndev_vif
->
¡a
.network_map);

5842 
	`SLSI_ERR
(
sdev
, "New EÁry : %.* km®loc(èçed\n", 
ssid
[1], &ssid[2]);

5845 
	}
}

5847 
	$¦si_rßm_chªÃl_ÿche_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

5849 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

5850 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

5851 
›Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

5852 
u32
 
äeq
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2;

5853 cÚ¡ 
u8
 *
sÿn_ds
 = 
	`cfg80211_fšd_›
(
WLAN_EID_DS_PARAMS
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

5854 cÚ¡ 
u8
 *
sÿn_ht
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

5855 cÚ¡ 
u8
 *
sÿn_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

5856 
u8
 
chª
 = 0;

5859 ià(
sÿn_ds
)

5860 
chª
 = 
sÿn_ds
[2];

5861 ià(
sÿn_ht
)

5862 
chª
 = 
sÿn_ht
[2];

5864 
chª
 = 
	`›“80211_äequ’cy_to_chªÃl
(
äeq
);

5866 ià(
chª
) {

5867 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

5869 ià(
chª
 > 14)

5870 
bªd
 = 
NL80211_BAND_5GHZ
;

5872 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


5873 ià(
äeq
 !ğ(
u32
)
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
bªd
)) {

5874 ià(
bªd
 =ğ
NL80211_BAND_5GHZ
 && 
äeq
 < 3000)

5875 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "OfàBªd ResuÉ : mlme_sÿn_šd(äeq:%dè!ğDS(äeq:%d)\n", 
äeq
, 
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
bªd
));

5877 ià(
bªd
 =ğ
NL80211_BAND_2GHZ
 && 
äeq
 > 3000)

5878 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "OfàBªd ResuÉ : mlme_sÿn_šd(äeq:%dè!ğDS(äeq:%d)\n", 
äeq
, 
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
bªd
));

5883 ià(!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[1] > 32) {

5884 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "SSID‚ot defined : Could‚ot find SSID ie or Hidden\n");

5888 
	`¦si_rßm_chªÃl_ÿche_add_’Œy
(
sdev
, 
dev
, 
sÿn_ssid
, 
mgmt
->
bssid
, 
chª
);

5889 
	}
}

5891 
	$¦si_rßm_chªÃl_ÿche_´uÃ
(
Ãt_deviû
 *
dev
, 
£cÚds
, *
ssid
)

5893 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

5894 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5895 
li¡_h—d
 *
pos
, *
q
;

5896 
now
 = 
jiff›s
;

5897 
age
;

5898 
i
 = 0;

5900 ià(
ssid
) {

5901 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5902 
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
, 
li¡
);

5903 ià(
ssid
 && (
	`memcmp
(
ÃtwÜk_m­
->ssid.ssid, ssid,‚‘wÜk_m­->ssid.
ssid_Ën
) == 0)) {

5904 
	`SLSI_ERR_NODEV
("Prunšg‚‘wÜk m­ƒÁry fÜ ssid %s\n", 
ssid
);

5905 
	`li¡_d–
(
pos
);

5906 
	`kä“
(
ÃtwÜk_m­
);

5911 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5912 
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
, 
li¡
);

5913 
age
 = (
now
 - 
ÃtwÜk_m­
->
Ï¡_£’_jiff›s
è/ 
HZ
;

5914 
i
 = 1; i <= 38; i++) {

5915 ià(
	`time_aá”_eq
(
now
, 
ÃtwÜk_m­
->
chªÃl_jiff›s
[
i
] + (
£cÚds
 * 
HZ
))) {

5916 ià(
i
 <= 14)

5917 
ÃtwÜk_m­
->
chªÃls_24_ghz
 &ğ~(1 << (
i
));

5918 ià(
i
 > 14 && i < 34)

5919 
ÃtwÜk_m­
->
chªÃls_5_ghz
 &ğ~(1 << (
i
 - 15));

5921 
ÃtwÜk_m­
->
chªÃls_5_ghz
 &ğ~(1 << (
i
 - 10));

5924 ià(!
ÃtwÜk_m­
->
chªÃls_24_ghz
 && !ÃtwÜk_m­->
chªÃls_5_ghz
) {

5925 
	`li¡_d–
(
pos
);

5926 
	`kä“
(
ÃtwÜk_m­
);

5930 
	}
}

5932 
	$¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
Ãt_deviû
 *
dev
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
, 
u8
 *
chªÃls
)

5934 
šdex
 = 0;

5935 
i
;

5937 
	`SLSI_UNUSED_PARAMETER
(
dev
);

5940 
i
 = 1; i <= 14; i++)

5941 ià(
ÃtwÜk_m­
->
chªÃls_24_ghz
 & (1 << 
i
)) {

5942 
chªÃls
[
šdex
] = 
i
;

5943 
šdex
++;

5947 
i
 = 36; i <= 64; i += 4)

5948 ià(
ÃtwÜk_m­
->
chªÃls_5_ghz
 & (1 << ((
i
 - 36) / 4))) {

5949 
chªÃls
[
šdex
] = 
i
;

5950 
šdex
++;

5954 
i
 = 100; i <= 140; i += 4)

5955 ià(
ÃtwÜk_m­
->
chªÃls_5_ghz
 & (1 << (8 + ((
i
 - 100) / 4)))) {

5956 
chªÃls
[
šdex
] = 
i
;

5957 
šdex
++;

5961 
i
 = 149; i <= 165; i += 4)

5962 ià(
ÃtwÜk_m­
->
chªÃls_5_ghz
 & (1 << (24 + ((
i
 - 149) / 4)))) {

5963 
chªÃls
[
šdex
] = 
i
;

5964 
šdex
++;

5966  
šdex
;

5967 
	}
}

5969 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
	$¦si_rßm_chªÃl_ÿche_g‘
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
)

5971 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
 = 
NULL
;

5972 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5973 
li¡_h—d
 *
pos
;

5975 ià(
	`WARN_ON
(!
ssid
))

5976  
NULL
;

5978 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5979 
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
, 
li¡
);

5980 ià(
ÃtwÜk_m­
->
ssid
.
ssid_Ën
 == ssid[1] &&

5981 
	`memcmp
(
ÃtwÜk_m­
->
ssid
.ssid, &ssid[2], ssid[1]) == 0)

5984  
ÃtwÜk_m­
;

5985 
	}
}

5987 
u32
 
	$¦si_rßm_chªÃl_ÿche_g‘_chªÃls
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, u8 *
chªÃls
)

5989 
u32
 
chªÃls_couÁ
 = 0;

5990 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

5992 
ÃtwÜk_m­
 = 
	`¦si_rßm_chªÃl_ÿche_g‘
(
dev
, 
ssid
);

5993 ià(
ÃtwÜk_m­
)

5994 
chªÃls_couÁ
 = 
	`¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
dev
, 
ÃtwÜk_m­
, 
chªÃls
);

5996  
chªÃls_couÁ
;

5997 
	}
}

5999 
	$¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, u8 *
chªÃls
)

6001 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6002 
u32
 
ÿched_chªÃls_couÁ
;

6004 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

6006 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

6007 
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
);

6008 
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
);

6010 
ÿched_chªÃls_couÁ
 = 
	`¦si_rßm_chªÃl_ÿche_g‘_chªÃls
(
dev
, 
ssid
, 
chªÃls
);

6011 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Rßmšg SÿÀChªÃls. %d cached\n", 
ÿched_chªÃls_couÁ
);

6013  
ÿched_chªÃls_couÁ
;

6014 
	}
}

6016 
	$¦si_£nd_rş_ev’t
(
¦si_dev
 *
sdev
, 
u32
 
chªÃl_couÁ
, 
u16
 *
chªÃl_li¡
, 
u8
 *
ssid
, u8 
ssid_Ën
)

6018 
sk_buff
 *
skb
 = 
NULL
;

6019 
u8
 
”r
 = 0;

6021 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

6022 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

6023 
SLSI_NL80211_VENDOR_RCL_EVENT
, 
GFP_KERNEL
);

6025 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

6026 
SLSI_NL80211_VENDOR_RCL_EVENT
, 
GFP_KERNEL
);

6028 ià(!
skb
) {

6029 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for VENDOR RCL channel†ist\n");

6030  -
ENOMEM
;

6033 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_SSID
, 
ssid_Ën
, 
ssid
);

6034 
”r
 |ğ
	`Æa_put_u32
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_COUNT
, 
chªÃl_couÁ
);

6035 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_LIST
, 
chªÃl_couÁ
 * (
u16
), 
chªÃl_li¡
);

6037 ià(
”r
) {

6038 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆ”r=%d\n", 
”r
);

6039 
	`kä“_skb
(
skb
);

6040  -
EINVAL
;

6043 
	`SLSI_INFO
(
sdev
, "Event: SLSI_NL80211_VENDOR_RCL_EVENT(%d)\n",

6044 
SLSI_NL80211_VENDOR_RCL_EVENT
);

6045 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

6047 
	}
}

6049 
	$¦si_£nd_acs_ev’t
(
¦si_dev
 *
sdev
, 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
)

6051 
sk_buff
 *
skb
 = 
NULL
;

6052 
u8
 
”r
 = 0;

6054 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

6055 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

6056 
SLSI_NL80211_VENDOR_ACS_EVENT
, 
GFP_KERNEL
);

6058 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

6059 
SLSI_NL80211_VENDOR_ACS_EVENT
, 
GFP_KERNEL
);

6061 ià(!
skb
) {

6062 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for VENDOR ACSƒvent\n");

6063  -
ENOMEM
;

6065 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_PRIMARY_CHANNEL
, 
acs_£Ëùed_chªÃls
.
´i_chªÃl
);

6066 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_SECONDARY_CHANNEL
, 
acs_£Ëùed_chªÃls
.
£c_chªÃl
);

6067 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_VHT_SEG0_CENTER_CHANNEL
, 
acs_£Ëùed_chªÃls
.
vht_£g0_ûÁ”_ch
);

6068 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_VHT_SEG1_CENTER_CHANNEL
, 
acs_£Ëùed_chªÃls
.
vht_£g1_ûÁ”_ch
);

6069 
”r
 |ğ
	`Æa_put_u16
(
skb
, 
SLSI_ACS_ATTR_CHWIDTH
, 
acs_£Ëùed_chªÃls
.
ch_width
);

6070 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_HW_MODE
, 
acs_£Ëùed_chªÃls
.
hw_mode
);

6071 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "pri_channel=%d,sec_channel=%d,vht_seg0_center_ch=%d,"

6073 
acs_£Ëùed_chªÃls
.
´i_chªÃl
,‡cs_£Ëùed_chªÃls.
£c_chªÃl
,

6074 
acs_£Ëùed_chªÃls
.
vht_£g0_ûÁ”_ch
,‡cs_£Ëùed_chªÃls.
vht_£g1_ûÁ”_ch
,

6075 
acs_£Ëùed_chªÃls
.
ch_width
,‡cs_£Ëùed_chªÃls.
hw_mode
);

6076 ià(
”r
) {

6077 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆ”r=%d\n", 
”r
);

6078 
	`kä“_skb
(
skb
);

6079  -
EINVAL
;

6081 
	`SLSI_INFO
(
sdev
, "Ev’t: SLSI_NL80211_VENDOR_ACS_EVENT(%d)\n", 
SLSI_NL80211_VENDOR_ACS_EVENT
);

6082 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

6084 
	}
}

6086 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


6087 
	$¦si_is_wes_aùiÚ_äame
(cÚ¡ 
›“80211_mgmt
 *
mgmt
)

6089 
r
 = 0;

6091 
u8
 
wes_vs_aùiÚ_äame
[4] = { 0x7f, 0x00, 0x00, 0xf0 };

6092 
u8
 *
aùiÚ
 = (u8 *)&
mgmt
->
u
.action;

6094 ià(
	`memcmp
(
aùiÚ
, 
wes_vs_aùiÚ_äame
, 4) == 0)

6095 
r
 = 1;

6097  
r
;

6098 
	}
}

6101 
u32
 
	$¦si_»m­_»g_ruË_æags
(
u8
 
æags
)

6103 
u32
 
»m­³d_æags
 = 0;

6105 ià(
æags
 & 
SLSI_REGULATORY_DFS
)

6106 
»m­³d_æags
 |ğ
NL80211_RRF_DFS
;

6107 ià(
æags
 & 
SLSI_REGULATORY_NO_OFDM
)

6108 
»m­³d_æags
 |ğ
NL80211_RRF_NO_OFDM
;

6109 ià(
æags
 & 
SLSI_REGULATORY_NO_INDOOR
)

6110 
»m­³d_æags
 |ğ
NL80211_RRF_NO_INDOOR
;

6111 ià(
æags
 & 
SLSI_REGULATORY_NO_OUTDOOR
)

6112 
»m­³d_æags
 |ğ
NL80211_RRF_NO_OUTDOOR
;

6113 ià(
æags
 & 
SLSI_REGULATORY_NO_IR
)

6114 
»m­³d_æags
 |ğ
NL80211_RRF_NO_IR
;

6116  
»m­³d_æags
;

6117 
	}
}

6119 
	$¦si_»g_mib_to_»gd
(
¦si_mib_d©a
 *
mib
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
)

6121 
i
 = 0;

6122 
num_ruËs
 = 0;

6123 
u16
 
äeq
;

6124 
u8
 
by‹_v®
;

6125 
›“80211_»g_ruË
 *
»g_ruË
;

6127 
domaš_šfo
->
»gdomaš
->
®pha2
[0] = *(
u8
 *)(&
mib
->
d©a
[
i
]);

6128 
i
++;

6130 
domaš_šfo
->
»gdomaš
->
®pha2
[1] = *(
u8
 *)(&
mib
->
d©a
[
i
]);

6131 
i
++;

6133 
domaš_šfo
->
»gdomaš
->
dfs_»giÚ
 = *(
u8
 *)(&
mib
->
d©a
[
i
]);

6134 
i
++;

6136 
i
 < 
mib
->
d©aL’gth
) {

6137 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
num_ruËs
];

6140 
äeq
 = 
	`__Ë16_to_ıu
(*(
u16
 *)(&
mib
->
d©a
[
i
]));

6141 
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 = 
	`MHZ_TO_KHZ
(
äeq
);

6144 
äeq
 = 
	`__Ë16_to_ıu
(*(
u16
 *)(&
mib
->
d©a
[
i
 + 2]));

6145 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 = 
	`MHZ_TO_KHZ
(
äeq
);

6148 
by‹_v®
 = *(
u8
 *)(&
mib
->
d©a
[
i
 + 4]);

6149 
»g_ruË
->
äeq_¿nge
.
max_bªdwidth_khz
 = 
	`MHZ_TO_KHZ
(
by‹_v®
);

6152 
»g_ruË
->
pow”_ruË
.
max_ª‹Âa_gaš
 = 0;

6155 
by‹_v®
 = *(
u8
 *)(&
mib
->
d©a
[
i
 + 5]);

6156 
»g_ruË
->
pow”_ruË
.
max_eœp
 = 
	`DBM_TO_MBM
(
by‹_v®
);

6159 
»g_ruË
->
æags
 = 
	`¦si_»m­_»g_ruË_æags
(*(
u8
 *)(&
mib
->
d©a
[
i
 + 6]));

6161 
i
 += 7;

6163 
num_ruËs
++;

6166 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
 = 
num_ruËs
;

6167 
	}
}

6169 
	$¦si_»£t_chªÃl_æags
(
¦si_dev
 *
sdev
)

6171 
Æ80211_bªd
 
bªd
;

6172 
›“80211_chªÃl
 *
chª
;

6173 
i
;

6174 
why
 *why = 
sdev
->wiphy;

6176 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

6177 
bªd
 = 0; bªd < 
NUM_NL80211_BANDS
; band++) {

6179 
bªd
 = 0; bªd < 
IEEE80211_NUM_BANDS
; band++) {

6181 ià(!
why
->
bªds
[
bªd
])

6183 
i
 = 0; i < 
why
->
bªds
[
bªd
]->
n_chªÃls
; i++) {

6184 
chª
 = &
why
->
bªds
[
bªd
]->
chªÃls
[
i
];

6185 
chª
->
æags
 = 0;

6188 
	}
}

6190 
	$¦si_»ad_»guÏtÜy_ruËs
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
)

6192 
i
 = 0;

6193 
couÁry_šdex
 = 0;

6194 
›“80211_»g_ruË
 *
»g_ruË
 = 
NULL
;

6196 ià((
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_NOT_SET
è|| (sdev->»gdb.»gdb_¡©=ğ
SLSI_REG_DB_ERROR
)) {

6197 
	`SLSI_ERR
(
sdev
, "Regulatory is‚ot set!\n");

6198  
	`¦si_»ad_»guÏtÜy_ruËs_fw
(
sdev
, 
domaš_šfo
, 
®pha2
);

6201 
i
 = 0; i < 
sdev
->
»gdb
.
num_couÁr›s
; i++) {

6202 ià((
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
[0] ==‡lpha2[0]) && (sdev->regdb.country[i].alpha2[1] ==‡lpha2[1])) {

6203 
couÁry_šdex
 = 
i
;

6208 
domaš_šfo
->
»gdomaš
->
®pha2
[0] = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].alpha2[0];

6209 
domaš_šfo
->
»gdomaš
->
®pha2
[1] = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].alpha2[1];

6210 
domaš_šfo
->
»gdomaš
->
dfs_»giÚ
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
İ”©šg_şass_£t
;

6212 
i
 = 0; i < 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
; i++) {

6213 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
i
];

6216 
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->äeq_¿nge->
¡¬t_äeq
 * 1000);

6219 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->äeq_¿nge->
’d_äeq
 * 1000);

6222 
»g_ruË
->
äeq_¿nge
.
max_bªdwidth_khz
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->äeq_¿nge->
max_bªdwidth
 * 1000);

6225 
»g_ruË
->
pow”_ruË
.
max_ª‹Âa_gaš
 = 0;

6228 
»g_ruË
->
pow”_ruË
.
max_eœp
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->max_eirp * 100);

6231 
»g_ruË
->
æags
 = 
	`¦si_»m­_»g_ruË_æags
(
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->flags);

6234 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
;

6237 
	}
}

6239 
	$¦si_»ad_»guÏtÜy_ruËs_fw
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
)

6241 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6242 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6243 
¦si_mib_’Œy
 
mib_v®
;

6244 
r
 = 0;

6245 
rx_Ën
 = 0;

6246 
Ën
 = 0;

6247 
šdex
;

6249 
šdex
 = 
	`¦si_couÁry_to_šdex
(
domaš_šfo
, 
®pha2
);

6251 ià(
šdex
 == -1) {

6252 
	`SLSI_ERR
(
sdev
, "Unsupported index\n");

6253  -
EINVAL
;

6256 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_REGULATORY_PARAMETERS
, 
šdex
);

6264 
mibr¥
.
d©aL’gth
 = 5 + 3 + (
SLSI_MIB_REG_RULES_MAX
 * 7) + 1;

6265 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6267 ià(!
mibr¥
.
d©a
) {

6268 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6269 
	`kä“
(
mib»q
.
d©a
);

6270  -
ENOMEM
;

6273 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
,

6274 
mibr¥
.
d©a
, mibr¥.
d©aL’gth
, &
rx_Ën
);

6275 
	`kä“
(
mib»q
.
d©a
);

6277 ià(
r
 == 0) {

6278 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6280 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6282 ià(
Ën
 == 0) {

6283 
	`kä“
(
mibr¥
.
d©a
);

6284 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6285  -
EINVAL
;

6287 
	`¦si_»g_mib_to_»gd
(&
mib_v®
.
v®ue
.
u
.
où‘V®ue
, 
domaš_šfo
);

6289 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6292 
	`kä“
(
mibr¥
.
d©a
);

6293  
r
;

6294 
	}
}

6296 
	$¦si_couÁry_to_šdex
(
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
)

6298 
šdex
 = 0;

6299 
boŞ
 
šdex_found
 = 
çl£
;

6301 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "\n");

6302 ià(
domaš_šfo
->
couÁryli¡
) {

6303 
šdex
 = 0; index < 
domaš_šfo
->
couÁry_Ën
; index += 2) {

6304 ià(
	`memcmp
(&
domaš_šfo
->
couÁryli¡
[
šdex
], 
®pha2
, 2) == 0) {

6305 
šdex_found
 = 
Œue
;

6313 ià(
šdex_found
)

6314  (
šdex
 / 2) + 1;

6320 
	}
}

6323 
	$¦si_£t_mib_rssi_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
šdex
, 
boo¡
)

6325 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

6326 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

6328 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "S‘„ss˜boo¡: %d\n", 
boo¡
);

6329 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
deviû_cÚfig_mu‹x
));

6330 ià(
	`¦si_mib_’code_št
(&
mib_d©a
, 
psid
, 
boo¡
, 
šdex
è=ğ
SLSI_MIB_STATUS_SUCCESS
)

6331 ià(
mib_d©a
.
d©aL’gth
) {

6332 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

6333 ià(
”rÜ
)

6334 
	`SLSI_ERR
(
sdev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

6335 
	`kä“
(
mib_d©a
.
d©a
);

6338  
”rÜ
;

6339 
	}
}

6341 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


6342 
	$¦si_£t_mib_soá_rßmšg_’abËd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
’abË
)

6344 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

6345 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

6347 ià(
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_ROAM_SOFT_ROAMING_ENABLED
,

6348 
’abË
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

6349 ià(
mib_d©a
.
d©aL’gth
) {

6350 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

6351 ià(
”rÜ
)

6352 
	`SLSI_ERR
(
sdev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

6353 
	`kä“
(
mib_d©a
.
d©a
);

6356  
”rÜ
;

6357 
	}
}

6360 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


6361 
	$¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
)

6363 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6364 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6365 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6366 
¦si_mib_’Œy
 
mib_v®
;

6367 
r
 = 0;

6368 
rx_Ën
 = 0;

6369 
Ën
 = 0;

6371 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

6373 
	`¦si_mib_’code_g‘
(&
mib»q
, 
psid
, 0);

6375 
mibr¥
.
d©aL’gth
 = 10;

6376 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6378 ià(!
mibr¥
.
d©a
) {

6379 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6380 
	`kä“
(
mib»q
.
d©a
);

6381  -
ENOMEM
;

6384 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6385 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6386 
	`kä“
(
mib»q
.
d©a
);

6388 ià(
r
 == 0) {

6389 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6390 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6392 ià(
Ën
 == 0) {

6393 
	`kä“
(
mibr¥
.
d©a
);

6394 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6395  -
EINVAL
;

6397 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_low”_mac
 = 
mib_v®
.
v®ue
.
u
.
uštV®ue
;

6399 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6402 
	`kä“
(
mibr¥
.
d©a
);

6403  
r
;

6404 
	}
}

6406 
	$¦si_fl_’hªûd_¬p_out_of_Üd”_drİ_couÁ”
(
Ãtdev_vif
 *
ndev_vif
,

6407 
sk_buff
 *
skb
)

6409 
‘hhdr
 *
‘h_hdr
;

6410 
u8
 *
äame
;

6411 
u16
 
¬p_İcode
;

6413 #ifdeà
CONFIG_SCSC_SMAPPER


6415 ià(
	`¦si_skb_cb_g‘
(
skb
)->
sm­³r_lšked
) {

6416 
äame
 = 
	`¦si_h_g‘_skb_d©a_äom_sm­³r
(
ndev_vif
->
sdev
, 
skb
);

6417 
‘h_hdr
 = (
‘hhdr
 *)
äame
;

6418 ià(!(
‘h_hdr
)) {

6419 
	`SLSI_DBG2
(
ndev_vif
->
sdev
, 
SLSI_RX
, "SKB from SMAPPER is NULL\n");

6422 
äame
 = f¿m+ (
‘hhdr
);

6424 
äame
 = 
	`çpi_g‘_d©a
(
skb
è+ (
‘hhdr
);

6425 
‘h_hdr
 = (
‘hhdr
 *)
	`çpi_g‘_d©a
(
skb
);

6428 
äame
 = 
	`çpi_g‘_d©a
(
skb
è+ (
‘hhdr
);

6429 
‘h_hdr
 = (
‘hhdr
 *)
	`çpi_g‘_d©a
(
skb
);

6432 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

6434 ià((
	`Áohs
(
‘h_hdr
->
h_´Ùo
è=ğ
ETH_P_ARP
) &&

6435 (
¬p_İcode
 =ğ
SLSI_ARP_REPLY_OPCODE
) &&

6436 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

6437 !
	`memcmp
(&
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4))

6438 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_out_of_Üd”_drİ
++;

6439 
	}
}

6442 
	$¦si_modify_›s_Ú_chªÃl_sw™ch
(
Ãt_deviû
 *
dev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
,

6443 
u8
 *
ds_·¿ms_›
, u8 *
ht_İ”©iÚ_›
, 
›“80211_mgmt
 *
mgmt
,

6444 
u16
 
b—cÚ_›_h—d_Ën
)

6446 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_DS_PARAMS
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

6447 
b—cÚ_›_h—d_Ën
, 2, 
	`›“80211_äequ’cy_to_chªÃl
(
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
));

6449 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_OPERATION
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

6450 
£‰šgs
->
b—cÚ
.
_Ën
, 2,

6451 
	`›“80211_äequ’cy_to_chªÃl
(
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
));

6452 
	}
}

6454 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


6455 
	$¦si_exŒaù_v®id_wifi_sh¬šg_chªÃls
(
¦si_dev
 *
sdev
)

6457 
i
, 
j
;

6458 
p
 = 0;

6459 
k
 = (
SLSI_MAX_CHAN_5G_BAND
 - 1);

6460 
æag
 = 0;

6462 
i
 = 4; i >= 0 ; i--) {

6463 
j
 = 0; j <= 7 ; j++) {

6464 ià((
i
 =ğ4è&& (
j
 == 0))

6465 
j
 = 1;

6466 ià(
sdev
->
wifi_sh¬šg_5ghz_chªÃl
[
i
] & (
u8
)(1 << (7 - 
j
)))

6467 
sdev
->
v®id_5g_chª
[
p
] = 
¦si_5ghz_®l_chªs
[
k
];

6469 
sdev
->
v®id_5g_chª
[
p
] = 0;

6470 
p
++;

6471 
k
--;

6472 ià(
p
 =ğ
SLSI_MAX_CHAN_5G_BAND
) {

6473 
æag
 = 1;

6477 ià(
æag
 == 1)

6480 
	}
}

6482 
boŞ
 
	$¦si_if_v®id_wifi_sh¬šg_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
)

6484 
i
;

6486 
i
 = 0; i <ğ(
SLSI_MAX_CHAN_5G_BAND
 - 1) ; i++) {

6487 ià(
sdev
->
v®id_5g_chª
[
i
] =ğ
	`›“80211_g‘_chªÃl
(sdev->
why
, 
äeq
)->
hw_v®ue
)

6491 
	}
}

6493 
	$¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
)

6495 
›“80211_chªÃl
 *
chªÃl
 = 
NULL
;

6496 
u32
 
chª_æags
 = 0;

6498 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

6499 ià(!
chªÃl
) {

6500 
	`SLSI_ERR
(
sdev
, "Inv®id f»qu’cy %d u£dØ¡¬ˆAP. ChªÃÈnÙ found\n", 
äeq
);

6504 
chª_æags
 = (
IEEE80211_CHAN_INDOOR_ONLY
 | 
IEEE80211_CHAN_RADAR
 |

6505 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_NO_IR
);

6507 ià((
chªÃl
->
æags
è& 
chª_æags
)

6511 
	}
}

6513 
	$¦si_g‘_mhs_ws_chª_vsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

6514 
cfg80211_­_£‰šgs
 *
£‰šgs
,

6515 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
)

6517 
Ãt_deviû
 *
¡a_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

6518 
Ãtdev_vif
 *
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
¡a_dev
);

6519 
¡a_äequ’cy
 = 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
;

6521 ià(!
	`¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
sdev
, 
¡a_äequ’cy
))

6524 ià((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
è!ğ(
¡a_äequ’cy
)) {

6525 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6526 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
¡a_äequ’cy
);

6527 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
¡a_äequ’cy
;

6528 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6532 
	}
}

6534 
	$¦si_g‘_mhs_ws_chª_rsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

6535 
cfg80211_­_£‰šgs
 *
£‰šgs
,

6536 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
)

6538 
Ãt_deviû
 *
¡a_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

6539 
Ãtdev_vif
 *
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
¡a_dev
);

6540 
¡a_äequ’cy
 = 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
;

6542 ià(((
¡a_äequ’cy
) / 1000) == 2) {

6543 ià((((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
) / 1000) == 5) &&

6544 !(
	`¦si_check_if_chªÃl_»¡riùed_®»ady
(
sdev
,

6545 
	`›“80211_äequ’cy_to_chªÃl
(
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
))) &&

6546 
	`¦si_if_v®id_wifi_sh¬šg_chªÃl
(
sdev
, 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
) &&

6547 
	`¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
sdev
, 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
)) {

6548 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, s‘tšgs->chªdef.chª->
ûÁ”_äeq
);

6549 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = s‘tšgs->chªdef.
chª
->
ûÁ”_äeq
;

6551 ià((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
è!ğ(
¡a_äequ’cy
)) {

6552 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6553 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
¡a_äequ’cy
);

6554 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
¡a_äequ’cy
;

6555 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6559 ià(((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
) / 1000) == 5) {

6560 ià(!(
	`¦si_check_if_chªÃl_»¡riùed_®»ady
(
sdev
,

6561 
	`›“80211_äequ’cy_to_chªÃl
(
¡a_äequ’cy
))) &&

6562 
	`¦si_if_v®id_wifi_sh¬šg_chªÃl
(
sdev
, 
¡a_äequ’cy
) &&

6563 
	`¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
sdev
, 
¡a_äequ’cy
)) {

6564 ià((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
è!ğ(
¡a_äequ’cy
)) {

6565 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6566 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
¡a_äequ’cy
);

6567 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
¡a_äequ’cy
;

6568 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6571 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6572 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
SLSI_2G_CHANNEL_ONE
);

6573 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
SLSI_2G_CHANNEL_ONE
;

6574 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6580 
	}
}

6582 
	$¦si_check_if_chªÃl_»¡riùed_®»ady
(
¦si_dev
 *
sdev
, 
chªÃl
)

6584 
i
;

6586 
i
 = 0; i < 
sdev
->
num_5g_»¡riùed_chªÃls
; i++)

6587 ià(
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] =ğ
chªÃl
)

6591 
	}
}

6593 
	$¦si_£t_wifish¬šg_³rm™‹d_chªÃls
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

6595 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6596 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

6597 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

6598 
”rÜ
 = 0;

6599 
i
 = 0;

6600 
b™
 = 0;

6601 
j
 = 0;

6602 
b™_mask
 = 0;

6603 
num_chªÃls
 = 0;

6604 
šdoÜ_chª_¬g
 = 0;

6605 
u8
 *
³rm™‹d_chªÃls
 = 
NULL
;

6607 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 26);

6608 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

6610 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
šdoÜ_chª_¬g
)) {

6611 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

6612 
	`kä“
(
ioùl_¬gs
);

6613  -
EINVAL
;

6615 
³rm™‹d_chªÃls
 = 
	`km®loc
(8, 
GFP_KERNEL
);

6617 ià(!
³rm™‹d_chªÃls
) {

6618 
”rÜ
 = -
ENOMEM
;

6619 
ex™
;

6625 ià(
šdoÜ_chª_¬g
 == 0) {

6626 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "All 5G channels…ermitted\n");

6627 
sdev
->
num_5g_»¡riùed_chªÃls
 = 0;

6628 
i
 = 0; i < 25 ; i++)

6629 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] = 0;

6630 
³rm™‹d_chªÃls
[0] = 0xFF;

6631 
³rm™‹d_chªÃls
[1] = 0xDF;

6632 
³rm™‹d_chªÃls
[2] = 0xFF;

6633 
³rm™‹d_chªÃls
[3] = 0xFF;

6634 
³rm™‹d_chªÃls
[4] = 0x7F;

6635 
³rm™‹d_chªÃls
[5] = 0x00;

6636 
³rm™‹d_chªÃls
[6] = 0x00;

6637 
³rm™‹d_chªÃls
[7] = 0x00;

6638 } ià(
šdoÜ_chª_¬g
 == -1) {

6639 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "No 5G channel…ermitted\n");

6640 
³rm™‹d_chªÃls
[0] = 0xFF;

6641 
³rm™‹d_chªÃls
[1] = 0x1F;

6642 
i
 = 2; i < 8; i++)

6643 
³rm™‹d_chªÃls
[
i
] = 0x00;

6645 
i
 = 0; i < 25; i++) {

6646 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] = 
¦si_5ghz_®l_chªs
[i];

6648 
sdev
->
num_5g_»¡riùed_chªÃls
 = 25;

6649 } ià(
šdoÜ_chª_¬g
 >= 1 && indoor_chan_arg <= 25) {

6650 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
šdoÜ_chª_¬g
) {

6651 
	`SLSI_ERR
(
sdev
, "No. oà¬g aùu®ly…»£Á‡»†es£¸thªƒx³ùed %d\n", 
šdoÜ_chª_¬g
);

6652 
”rÜ
 = -
EINVAL
;

6653 
ex™
;

6655 
sdev
->
num_5g_»¡riùed_chªÃls
 = 0;

6656 
i
 = 0; i < 25 ; i++)

6657 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] = 0;

6658 
³rm™‹d_chªÃls
[0] = 0xFF;

6659 
³rm™‹d_chªÃls
[1] = 0xDF;

6660 
³rm™‹d_chªÃls
[2] = 0xFF;

6661 
³rm™‹d_chªÃls
[3] = 0xFF;

6662 
³rm™‹d_chªÃls
[4] = 0x7F;

6663 
³rm™‹d_chªÃls
[5] = 0x00;

6664 
³rm™‹d_chªÃls
[6] = 0x00;

6665 
³rm™‹d_chªÃls
[7] = 0x00;

6666 
num_chªÃls
 = 
šdoÜ_chª_¬g
;

6668 
i
 = 0; i < 
num_chªÃls
; i++) {

6669 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
šdoÜ_chª_¬g
)) {

6670 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[
i
 + 1]);

6671 
”rÜ
 = -
EINVAL
;

6672 
ex™
;

6674 ià(
šdoÜ_chª_¬g
 < 36 || indoor_chan_arg > 165) {

6675 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d\n", 
šdoÜ_chª_¬g
);

6676 
”rÜ
 = -
EINVAL
;

6677 
ex™
;

6679 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[(sdev->
num_5g_»¡riùed_chªÃls
)++] = 
šdoÜ_chª_¬g
;

6681 
j
 = 0; j < 25; j++) {

6682 ià(
¦si_5ghz_®l_chªs
[
j
] =ğ
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
]) {

6683 
b™
 = 
j
 + 14;

6687 ià((
b™
 < 14) || (bit > 38)) {

6688 
”rÜ
 = -
EINVAL
;

6689 
	`SLSI_ERR
(
sdev
, "IncÜ»ù b™…os™iÚ = %d\n", 
b™
);

6690 
ex™
;

6693 
b™_mask
 = (
b™
 % 8);

6694 
³rm™‹d_chªÃls
[
b™
 / 8] &ğ(
u8
)(~(1 << (
b™_mask
)));

6697 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ %d\n", 
šdoÜ_chª_¬g
);

6698 
”rÜ
 = -
EINVAL
;

6699 
ex™
;

6702 
”rÜ
 = 
	`¦si_mlme_wifish¬šg_³rm™‹d_chªÃls
(
sdev
, 
dev
, 
³rm™‹d_chªÃls
);

6704 
ex™
:

6705 ià(
”rÜ
)

6706 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šg wif˜sh¬šg…”m™‹d chªÃls.ƒ¼Ü = %d\n", 
”rÜ
);

6707 
	`kä“
(
ioùl_¬gs
);

6708 
	`kä“
(
³rm™‹d_chªÃls
);

6709  
”rÜ
;

6710 
	}
}

6712 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


6713 
	$¦si_£t_mac_¿ndomi§tiÚ_mask
(
¦si_dev
 *
sdev
, 
u8
 *
mac_add»ss_mask
)

6715 
r
 = 0;

6716 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

6718 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Mask i :%pM\n", 
mac_add»ss_mask
);

6719 
r
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION_MASK
, 
ETH_ALEN
,

6720 
mac_add»ss_mask
, 0);

6721 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

6722  -
ENOMEM
;

6725 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

6726 
	`kä“
(
mib_d©a
.
d©a
);

6728 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

6729 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiMacAddrRªdomi¡aiÚMask MIB.ƒ¼Ü = %d\n", 
r
);

6730 ià(
sdev
->
sÿn_addr_£t
) {

6731 
¦si_mib_d©a
 
mib_d©a_¿ndomiz©iÚ_aùiv©ed
 = { 0, 
NULL
 };

6733 
r
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a_¿ndomiz©iÚ_aùiv©ed
,

6734 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
, 1, 0);

6735 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

6736  -
ENOMEM
;

6738 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a_¿ndomiz©iÚ_aùiv©ed
.
d©a
,

6739 
mib_d©a_¿ndomiz©iÚ_aùiv©ed
.
d©aL’gth
);

6741 
	`kä“
(
mib_d©a_¿ndomiz©iÚ_aùiv©ed
.
d©a
);

6743 ià(
r
) {

6744 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiMacAddrRªdomi¡aiÚAùiv©ed MIB.ƒ¼Ü = %d\n", 
r
);

6745  
r
;

6749  
r
;

6750 
	}
}

6753 
	$¦si_£t_couÁry_upd©e_»gd
(
¦si_dev
 *
sdev
, cÚ¡ *
®pha2_code
, 
size
)

6755 
®pha2
[4];

6756 
”rÜ
 = 0;

6758 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "S‘ couÁry code: %c%c\n", 
®pha2_code
[0],‡lpha2_code[1]);

6760 ià(
size
 == 4) {

6761 
	`memıy
(
®pha2
, 
®pha2_code
, 4);

6763 
	`memıy
(
®pha2
, 
®pha2_code
, 3);

6764 
®pha2
[3] = '\0';

6767 ià(
	`memcmp
(
®pha2
, 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->alpha2, 2) == 0) {

6768 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Country is‡lready setohe„equested country code\n");

6772 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

6773 
”rÜ
 = 
	`¦si_mlme_£t_couÁry
(
sdev
, 
®pha2
);

6775 ià(
”rÜ
) {

6776 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
”rÜ
);

6777 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

6782 ià(
	`¦si_»ad_»guÏtÜy_ruËs
(
sdev
, &sdev->
deviû_cÚfig
.
domaš_šfo
, 
®pha2
) == 0) {

6783 
	`¦si_»£t_chªÃl_æags
(
sdev
);

6784 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
);

6785 
	`¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
sdev
);

6788 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

6789  
”rÜ
;

6790 
	}
}

6793 
	$¦si_»ad_discÚÃù_šd_timeout
(
¦si_dev
 *
sdev
, 
u16
 
psid
)

6795 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6796 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6797 
¦si_mib_’Œy
 
mib_v®
;

6798 
r
 = 0;

6799 
rx_Ën
 = 0;

6800 
Ën
 = 0;

6802 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

6804 
	`¦si_mib_’code_g‘
(&
mib»q
, 
psid
, 0);

6806 
mibr¥
.
d©aL’gth
 = 10;

6807 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6809 ià(!
mibr¥
.
d©a
) {

6810 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6811 
	`kä“
(
mib»q
.
d©a
);

6812  -
ENOMEM
;

6815 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6816 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6817 
	`kä“
(
mib»q
.
d©a
);

6819 ià(
r
 == 0) {

6820 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6821 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6823 ià(
Ën
 == 0) {

6824 
	`kä“
(
mibr¥
.
d©a
);

6825 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6826  -
EINVAL
;

6828 ià(
mib_v®
.
v®ue
.
u
.
uštV®ue
 > 
SLSI_DEFAULT_AP_DISCONNECT_IND_TIMEOUT
) {

6829 
	`SLSI_INFO
(
sdev
, "Max v®uexûed [%d]\n", 
mib_v®
.
v®ue
.
u
.
uštV®ue
);

6830 
mib_v®
.
v®ue
.
u
.
uštV®ue
 = 
SLSI_DEFAULT_AP_DISCONNECT_IND_TIMEOUT
;

6833 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
 = (
mib_v®
.
v®ue
.
u
.
uštV®ue
 + 1000);

6835 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6838 
	`kä“
(
mibr¥
.
d©a
);

6839  
r
;

6840 
	}
}

6842 
	$¦si_g‘_b—cÚ_cu
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
mib_v®ue
)

6844 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6845 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6846 
¦si_mib_’Œy
 
mib_v®
;

6847 
r
 = 0;

6848 
rx_Ën
 = 0;

6849 
Ën
 = 0;

6851 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_BEACON_CU
, 0);

6853 
mibr¥
.
d©aL’gth
 = 6;

6854 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6856 ià(!
mibr¥
.
d©a
) {

6857 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6858 
	`kä“
(
mib»q
.
d©a
);

6859  -
ENOMEM
;

6862 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6863 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6864 
	`kä“
(
mib»q
.
d©a
);

6866 ià(
r
 == 0) {

6867 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6868 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6870 ià(
Ën
 == 0) {

6871 
	`kä“
(
mibr¥
.
d©a
);

6872 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6873  -
EINVAL
;

6875 *
mib_v®ue
 = 
mib_v®
.
v®ue
.
u
.
štV®ue
;

6876 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "MIB v®uğ%d\n", *
mib_v®ue
);

6878 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6881 
	`kä“
(
mibr¥
.
d©a
);

6882  
r
;

6883 
	}
}

6886 
	$¦si_»ad_deçuÉ_couÁry
(
¦si_dev
 *
sdev
, 
u8
 *
®pha2
, 
u16
 
šdex
)

6888 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6889 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6890 
¦si_mib_’Œy
 
mib_v®
;

6891 
r
 = 0;

6892 
rx_Ën
 = 0;

6893 
Ën
 = 0;

6895 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY
, 
šdex
);

6897 
mibr¥
.
d©aL’gth
 = 11;

6898 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6900 ià(!
mibr¥
.
d©a
) {

6901 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6902 
	`kä“
(
mib»q
.
d©a
);

6903  -
ENOMEM
;

6906 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6907 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6909 
	`kä“
(
mib»q
.
d©a
);

6911 ià(
r
 == 0) {

6912 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6913 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6915 ià(
Ën
 == 0) {

6916 
	`kä“
(
mibr¥
.
d©a
);

6917 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6918  -
EINVAL
;

6920 
	`memıy
(
®pha2
, 
mib_v®
.
v®ue
.
u
.
où‘V®ue
.
d©a
, 2);

6922 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6925 
	`kä“
(
mibr¥
.
d©a
);

6926  
r
;

6927 
	}
}

6929 
	$¦si_cİy_couÁry_bË
(
¦si_dev
 *
sdev
, 
¦si_mib_d©a
 *
mib
, 
Ën
)

6931 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

6933 
	`kä“
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
);

6934 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

6936 ià(!
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
) {

6937 
	`SLSI_ERR
(
sdev
, "kmalloc failed\n");

6938  -
EINVAL
;

6941 ià(!
mib
 || !mib->
d©a
) {

6942 
	`SLSI_ERR
(
sdev
, "Invalid MIB countryable\n");

6943  -
EINVAL
;

6946 
	`memıy
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
, 
mib
->
d©a
, 
Ën
);

6947 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁry_Ën
 = 
Ën
;

6950 
	}
}

6953 
	$¦si_»ad_unifi_couÁryli¡
(
¦si_dev
 *
sdev
, 
u16
 
psid
)

6955 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6956 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6957 
¦si_mib_’Œy
 
mib_v®
;

6958 
r
 = 0;

6959 
rx_Ën
 = 0;

6960 
Ën
 = 0;

6961 
»t
;

6963 
	`¦si_mib_’code_g‘
(&
mib»q
, 
psid
, 0);

6968 
mibr¥
.
d©aL’gth
 = 5 + (
NUM_COUNTRY
 * 2);

6969 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6971 ià(!
mibr¥
.
d©a
) {

6972 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6973 
	`kä“
(
mib»q
.
d©a
);

6974  -
ENOMEM
;

6977 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6978 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6980 
	`kä“
(
mib»q
.
d©a
);

6982 ià(
r
 == 0) {

6983 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6984 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6986 ià(
Ën
 == 0) {

6987 
	`kä“
(
mibr¥
.
d©a
);

6988  -
EINVAL
;

6990 
»t
 = 
	`¦si_cİy_couÁry_bË
(
sdev
, &
mib_v®
.
v®ue
.
u
.
où‘V®ue
, 
Ën
);

6991 ià(
»t
 < 0) {

6992 
	`kä“
(
mibr¥
.
d©a
);

6993  
»t
;

6996 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6999 
	`kä“
(
mibr¥
.
d©a
);

7000  
r
;

7001 
	}
}

7003 
	$¦si_ş—r_offchªÃl_d©a
(
¦si_dev
 *
sdev
, 
boŞ
 
acquœe_lock
)

7005 
Ãt_deviû
 *
dev
 = 
NULL
;

7006 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

7008 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

7009 ià(
	`WARN_ON
(!
dev
)) {

7010 
	`SLSI_ERR
(
sdev
, "No Group‚et dev found\n");

7013 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7015 ià(
acquœe_lock
)

7016 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7019 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

7021 ià(
acquœe_lock
)

7022 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7024 
sdev
->
p2p_group_exp_äame
 = 
SLSI_PA_INVALID
;

7025 
	}
}

7027 
	$¦si_hs2_unsync_vif_d–‘e_wÜk
(
wÜk_¡ruù
 *
wÜk
)

7029 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
unsync
.
hs2_d–_vif_wÜk
);

7031 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7032 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Delete HS vif durationƒxpired - Deactivate unsync vif\n");

7033 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
ndev_vif
->
sdev
,‚dev_vif->
wdev
.
Ãtdev
, 
Œue
);

7034 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7035 
	}
}

7037 
	$¦si_wÏn_unsync_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

7038 
›“80211_chªÃl
 *
chª
, 
u16
 
wa™
)

7040 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7041 
r
 = 0;

7042 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

7043 
u32
 
aùiÚ_äame_bm­
;

7045 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Activate wlan unsync vif\n");

7047 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

7049 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_PRECONNECT
;

7052 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

7054 ià(
ndev_vif
->
mgmt_tx_gas_äame
) {

7055 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, 
ndev_vif
->
gas_äame_mac_addr
, 
deviû_add»ss
) != 0) {

7056 
	`SLSI_NET_ERR
(
dev
, "add vif failed for wlan unsync vif\n");

7057 
ex™_w™h_”rÜ
;

7060 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

7061 
	`SLSI_NET_ERR
(
dev
, "add vif failed for wlan unsync vif\n");

7062 
ex™_w™h_”rÜ
;

7066 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0) {

7067 
	`SLSI_NET_ERR
(
dev
, "vif‡ctivate failed for wlan unsync vif\n");

7068 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

7069 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

7070 
ex™_w™h_”rÜ
;

7072 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

7073 
aùiÚ_äame_bm­
 = 
SLSI_ACTION_FRAME_PUBLIC
 | 
SLSI_ACTION_FRAME_RADIO_MEASUREMENT
;

7075 
r
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
aùiÚ_äame_bm­
,‡ction_frame_bmap);

7076 ià(
r
 != 0) {

7077 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_register_action_frame failed:„esultcode = %d,‡ction_frame_bmap:%d\n",

7078 
r
, 
aùiÚ_äame_bm­
);

7079 
ex™_w™h_vif
;

7082 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0) {

7083 
	`SLSI_NET_ERR
(
dev
, "Set channel failed for wlan unsync vif\n");

7084 
ex™_w™h_vif
;

7086 
ndev_vif
->
chª
 = chan;

7087 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

7088  
r
;

7090 
ex™_w™h_vif
:

7091 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

7092 
ex™_w™h_”rÜ
:

7093 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7094  -
EINVAL
;

7095 
	}
}

7097 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

7098 
boŞ
 
	$¦si_£Ëù_­_fÜ_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 **
bssid
,

7099 
›“80211_chªÃl
 **
chªÃl
, 
boŞ
 
»Œy
)

7101 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7102 
li¡_h—d
 *
pos
;

7104 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

7105 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

7106 
li¡_h—d
 *
pos_bssid
;

7108 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
ndev_vif
->
¡a
.ssid_len ||

7109 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
) != 0 ||

7110 !(
ssid_šfo
->
akm_ty³
 & 
ndev_vif
->
¡a
.akm_type))

7113 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

7114 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

7116 ià(
	`¦si_is_bssid_š_bÏckli¡
(
sdev
, 
dev
, 
bssid_šfo
->
bssid
) ||

7117 
bssid_šfo
->
cÚÃù_©‹m±ed
)

7119 ià(
»Œy
) {

7120 ià(
ndev_vif
->
¡a
.
sme
.
ssid
) {

7121 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
ssid
);

7122 
ndev_vif
->
¡a
.
sme
.
ssid_Ën
 = 0;

7124 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
	`¦si_mem_dup
((
u8
 *)
ssid_šfo
->ssid.ssid,

7125 
ssid_šfo
->
ssid
.
ssid_Ën
);

7126 
ndev_vif
->
¡a
.
sme
.
ssid_Ën
 = 
ssid_šfo
->
ssid
.ssid_len;

7128 ià(
ndev_vif
->
¡a
.
sme
.
bssid
)

7129 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
bssid
);

7130 
ndev_vif
->
¡a
.
sme
.
bssid
 = 
	`¦si_mem_dup
((
u8
 *)
bssid_šfo
->bssid,

7131 
ETH_ALEN
);

7132 
ndev_vif
->
¡a
.
sme
.
chªÃl
 =

7133 (
›“80211_chªÃl
 *)
	`¦si_mem_dup
((
u8
 *)
	`›“80211_g‘_chªÃl
(
sdev
->
why
,

7134 (
bssid_šfo
->
äeq
 / 2)),

7135 (
›“80211_chªÃl
));

7136 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

7137 
	`cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

7138 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

7141 *
bssid
 = 
bssid_šfo
->bssid;

7142 *
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, (
bssid_šfo
->
äeq
 / 2));

7144 
bssid_šfo
->
cÚÃù_©‹m±ed
 = 
Œue
;

7145 
	`SLSI_INFO
(
sdev
, "S–eùšg AP %pM fÜ cÚÃùiÚ\n", 
bssid_šfo
->
bssid
);

7146  
Œue
;

7150  
çl£
;

7151 
	}
}

7153 
	$¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
)

7155 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7156 
li¡_h—d
 *
pos
;

7158 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

7159 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

7160 
li¡_h—d
 *
pos_bssid
;

7162 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 =ğ
ndev_vif
->
¡a
.ssid_len &&

7163 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
) == 0 &&

7164 (
ssid_šfo
->
akm_ty³
 & 
ndev_vif
->
¡a
.akm_type)) {

7165 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

7166 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

7168 ià(
bssid
 && !
	`memcmp
(
ndev_vif
->
¡a
.
cÚÃùed_bssid
, 
bssid_šfo
->bssid, 
ETH_ALEN
)) {

7169 
bssid_šfo
->
cÚÃù_©‹m±ed
 = 
Œue
;

7171 } ià(!
bssid
) {

7172 
bssid_šfo
->
cÚÃù_©‹m±ed
 = 
çl£
;

7177 
	}
}

7180 
boŞ
 
	$¦si_is_bssid_š_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
)

7182 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7183 
i
, 
imax
;

7184 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7187 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

7188 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7190 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

7191 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, bssid) &&

7192 (
	`jiff›s_to_m£cs
(
jiff›s
è< 
bÏckli¡_šfo
->
’d_time
)) {

7193  
Œue
;

7197 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
)

7198 
imax
 = 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
;

7200 
imax
 = 0;

7201 
i
 = 0; i < 
imax
; i++) {

7202 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
].
addr
, 
bssid
))

7203  
Œue
;

7206  
çl£
;

7207 
	}
}

7209 
boŞ
 
	$¦si_is_bssid_š_h®_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
)

7211 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7212 
i
, 
imax
;

7214 ià(
ndev_vif
->
aş_d©a_h®
)

7215 
imax
 = 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
;

7217 
imax
 = 0;

7218 
i
 = 0; i < 
imax
; i++) {

7219 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
].
addr
, 
bssid
))

7220  
Œue
;

7222  
çl£
;

7223 
	}
}

7225 
boŞ
 
	$¦si_is_bssid_š_ioùl_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
)

7227 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7228 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7231 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

7232 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7234 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

7235 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, bssid))

7236  
Œue
;

7238  
çl£
;

7239 
	}
}

7241 
	$¦si_add_ioùl_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
)

7243 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7244 
¦si_ioùl_bÏckli¡_šfo
 *
d©a
;

7245 
»t
 = 0;

7247 
d©a
 = 
	`kz®loc
((*d©a), 
GFP_KERNEL
);

7249 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "ADD BÏckli¡ BSSID = " 
MACSTR
 "\n",

7250 
	`MAC2STR
(
addr
));

7251 ià(!
d©a
) {

7252 
	`SLSI_ERR
(
sdev
, "Blacklist: Unableo‡llocate mem\n");

7253  -
ENOMEM
;

7255 
	`‘h”_addr_cİy
(
d©a
->
bssid
, 
addr
);

7256 
	`li¡_add
(&
d©a
->
li¡
, &
ndev_vif
->
aş_d©a_ioùl_li¡
);

7259 
»t
 = 
	`¦si_£t_aş
(
sdev
, 
dev
);

7260  
»t
;

7261 
	}
}

7263 
	$¦si_»move_bssid_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
)

7265 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7266 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7267 
»t
 = 0;

7268 
i
, 
imax
;

7270 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "RemovBÏckli¡ BSSID = " 
MACSTR
 "\n",

7271 
	`MAC2STR
(
addr
));

7274 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

7275 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7277 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

7279 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, 
addr
)) {

7280 
	`li¡_d–
(
bÏckli¡_pos
);

7281 
	`kä“
(
bÏckli¡_šfo
);

7282 
»t
 = 1;

7287 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

7288 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

7289 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

7290 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, 
addr
)) {

7291 
	`li¡_d–
(
bÏckli¡_pos
);

7292 
	`kä“
(
bÏckli¡_šfo
);

7293 
»t
 = 1;

7298 ià(
ndev_vif
->
aş_d©a_h®
)

7299 
imax
 = 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
;

7301 
imax
 = 0;

7302 
i
 = 0; i < 
imax
; i++) {

7303 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
].
addr
,‡ddr)) {

7304 ià(
i
 !ğ
imax
 - 1) {

7305 
	`memıy
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
].
addr
,

7306 
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
 + 1].
addr
,

7307 (
imax
 - 
i
 - 1è* 
ETH_ALEN
);

7309 
	`mem£t
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
imax
 - 1].
addr
,

7311 (
mac_add»ss
));

7312 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
 -= 1;

7313 
»t
 = 1;

7318 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
)

7319 
imax
 = 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
;

7321 
imax
 = 0;

7322 
i
 = 0; i < 
imax
; i++) {

7323 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
].
addr
,‡ddr)) {

7324 ià(
i
 !ğ
imax
 - 1) {

7325 
	`memıy
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
].
addr
,

7326 
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
 + 1].
addr
,

7327 (
imax
 - 
i
 - 1è* 
ETH_ALEN
);

7329 
	`mem£t
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
imax
 - 1].
addr
,

7331 (
mac_add»ss
));

7332 
»t
 = 1;

7333 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
 -= 1;

7338 ià(!
»t
) {

7339 
	`SLSI_NET_INFO
(
dev
, "BÏckli¡ BSSID:" 
MACSTR
 " NÙ…»£Á\n", 
	`MAC2STR
(
addr
));

7340  
»t
;

7343 
»t
 = 
	`¦si_£t_aş
(
sdev
, 
dev
);

7344  
»t
;

7345 
	}
}

7348 
	$¦si_wÏn_unsync_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

7350 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7352 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "De-activate wlan unsync vif\n");

7354 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

7356 ià(
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_NO_VIF
) {

7357 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "wlan unsync vif‡lready deactivated\n");

7361 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
);

7363 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
è&& 
sdev
->
»cov”y_¡©us
) {

7364 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,‚dev_vif->
chª
,

7365 
GFP_KERNEL
);

7366 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

7371 ià(
hw_avaabË
)

7372 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

7373 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

7375 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7377 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_NO_VIF
;

7378 
ndev_vif
->
aùiv©ed
 = 
çl£
;

7379 
ndev_vif
->
chª
 = 
NULL
;

7381 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

7382 
	}
}

7384 
	$¦si_sÿn_šd_timeout_hªdË
(
wÜk_¡ruù
 *
wÜk
)

7386 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
sÿn_timeout_wÜk
);

7387 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev
(
ndev_vif
->
sdev
,‚dev_vif->
iâum
);

7389 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7390 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

7391 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

7392 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
) {

7393 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
sÿn_timeout_wÜk
,

7394 
	`m£cs_to_jiff›s
(
SLSI_FW_SCAN_DONE_TIMEOUT_MSEC
));

7395 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

7397 
	`SLSI_WARN
(
ndev_vif
->
sdev
, "Mlme_scan_done_ind‚ot„eceived\n");

7398 ()
	`¦si_mlme_d–_sÿn
(
ndev_vif
->
sdev
, 
dev
,‚dev_vif->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
, 
Œue
);

7399 
	`¦si_sÿn_com¶‘e
(
ndev_vif
->
sdev
, 
dev
, 
SLSI_SCAN_HW_ID
, 
çl£
, false);

7402 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

7403 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7404 
	}
}

7406 
	$¦si_bÏckli¡_d–_wÜk_hªdË
(
wÜk_¡ruù
 *
wÜk
)

7408 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
bÏckli¡_d–_wÜk
);

7409 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7410 
Ãt_deviû
 *
dev
;

7411 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7412 
u32
 
»‹ÁiÚ_time
 = 0;

7413 
d–‘ed
 = 0;

7415 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7416 
dev
 = 
	`¦si_ndev_vif_2_Ãt_deviû
(
ndev_vif
);

7417 ià(!
dev
) {

7418 
	`SLSI_WARN
(
sdev
, "Inv®id‚dev_vià:%p\n", 
ndev_vif
);

7419 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7422 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

7423 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7425 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

7426 ià(
	`jiff›s_to_m£cs
(
jiff›s
è> 
bÏckli¡_šfo
->
’d_time
) {

7427 
	`li¡_d–
(
bÏckli¡_pos
);

7428 
	`kä“
(
bÏckli¡_šfo
);

7429 
d–‘ed
 = 1;

7432 ià(!
»‹ÁiÚ_time
)

7433 
»‹ÁiÚ_time
 = 
bÏckli¡_šfo
->
’d_time
 - 
	`jiff›s_to_m£cs
(
jiff›s
);

7434 ià((
bÏckli¡_šfo
->
’d_time
 - 
	`jiff›s_to_m£cs
(
jiff›s
)è< 
»‹ÁiÚ_time
)

7435 
»‹ÁiÚ_time
 = 
bÏckli¡_šfo
->
’d_time
 - 
	`jiff›s_to_m£cs
(
jiff›s
);

7437 ià(
d–‘ed
)

7438 
	`¦si_£t_aş
(
sdev
, 
dev
);

7439 ià(
»‹ÁiÚ_time
)

7440 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
bÏckli¡_d–_wÜk
,

7441 
	`m£cs_to_jiff›s
(
»‹ÁiÚ_time
));

7442 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7443 
	}
}

7445 
	$¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
¦si_dev
 *
sdev
)

7447 
i
 = 0;

7448 
why
 *why = 
sdev
->wiphy;

7449 
›“80211_chªÃl
 *
chª
;

7454 ià(
sdev
->
’abËd_chªÃl_couÁ
 == 39)

7456 ià(
why
->
bªds
[0]) {

7457 
i
 = 0; i < 
	`ARRAY_SIZE
(
sdev
->
suµÜ‹d_2g_chªÃls
); i++) {

7458 ià(
sdev
->
suµÜ‹d_2g_chªÃls
[
i
] == 0) {

7459 
chª
 = &
why
->
bªds
[0]->
chªÃls
[
i
];

7460 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

7464 ià(
sdev
->
bªd_5g_suµÜ‹d
 && 
why
->
bªds
[1]) {

7465 
i
 = 0; i < 
	`ARRAY_SIZE
(
sdev
->
suµÜ‹d_5g_chªÃls
); i++) {

7466 ià(
sdev
->
suµÜ‹d_5g_chªÃls
[
i
] == 0) {

7467 
chª
 = &
why
->
bªds
[1]->
chªÃls
[
i
];

7468 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

7472 
	}
}

7474 
	$¦si_fšd_chª_idx
(
u16
 
chª
, 
u8
 
hw_mode
)

7476 
idx
 = -1, 
i
 = 0;

7477 
u16
 
¦si_5ghz_chªÃls_li¡
[25] = {36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124, 128, 132,

7480 ià(
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211B
 || hw_mod=ğ
SLSI_ACS_MODE_IEEE80211G
) {

7481 ià(
chª
 <ğ
MAX_24G_CHANNELS
)

7482 
idx
 = 
chª
 - 1;

7483 } ià(
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211A
) {

7484 
i
 = 0; i < 
MAX_5G_CHANNELS
; i++) {

7485 ià(
chª
 =ğ
¦si_5ghz_chªÃls_li¡
[
i
]) {

7486 
idx
 = 
i
;

7491 ià(
chª
 <ğ
MAX_24G_CHANNELS
) {

7492 
idx
 = 
chª
 - 1;

7494 
i
 = 0; i < 
MAX_5G_CHANNELS
; i++) {

7495 ià(
chª
 =ğ
¦si_5ghz_chªÃls_li¡
[
i
]) {

7496 
idx
 = 
i
 + 
MAX_24G_CHANNELS
;

7502  
idx
;

7503 
	}
}

7505 
	$¦si_£t_Ï‹ncy_mode
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
, 
cmd_Ën
)

7507 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7508 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7509 
»t
 = 0;

7510 
u16
 
ho¡_¡©e
;

7512 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Ï‹ncy_modğ%d\n", 
Ï‹ncy_mode
);

7514 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7515 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

7518 ià(
Ï‹ncy_mode
)

7519 
ho¡_¡©e
 = ho¡_¡©| 
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7521 
ho¡_¡©e
 = ho¡_¡©& ~
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7523 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

7524 ià(
»t
 != 0)

7525 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d", 
»t
);

7527 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

7529 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7531  
»t
;

7532 
	}
}

7534 
	$¦si_£t_Ï‹ncy_üt_d©a
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
)

7536 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7537 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7538 
»t
 = 0;

7539 
u16
 
ho¡_¡©e
;

7540 
·ssive_time
 = 
sdev
->
max_chªÃl_·ssive_time
;

7541 
home_time
 = 
sdev
->home_time;

7542 
sÿn_chªÃl_time
 = 
sdev
->
max_chªÃl_time
;

7543 
home_away_time
 = 
sdev
->home_away_time;

7544 
sÿn_mode
 = 0;

7546 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Ï‹ncy_üt_d©¨ğ%d\n", 
Ï‹ncy_mode
);

7548 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7549 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

7552 ià(
Ï‹ncy_mode
 == 0)

7553 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7555 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7557 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

7558 ià(
»t
 != 0) {

7559 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d\n", 
»t
);

7560 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7561  
»t
;

7563 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

7564 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7565 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7566 ià(
Ï‹ncy_mode
 != 1) {

7567 ià(
Ï‹ncy_mode
 == 2) {

7568 
sÿn_mode
 = 
FAPI_SCANMODE_LOW_LATENCY_2
;

7569 
·ssive_time
 = 60;

7570 } ià(
Ï‹ncy_mode
 == 3) {

7571 
sÿn_mode
 = 
FAPI_SCANMODE_LOW_LATENCY_3
;

7572 
home_away_time
 = 40;

7573 
home_time
 = 40;

7575 
»t
 = 
	`¦si_mlme_£t_sÿn_mode_»q
(
sdev
, 
dev
, 
sÿn_mode
, 
sÿn_chªÃl_time
,

7576 
home_away_time
, 
home_time
, 
·ssive_time
);

7578 ià(
»t
 != 0)

7579 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghSÿÀMode,„‘=%d", 
»t
);

7581 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7582  
»t
;

7583 
	}
}

7585 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


7586 
	$¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
Ãt_deviû
 *
dev
, 
mode
)

7588 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7589 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7590 
u16
 
ho¡_¡©e
;

7591 
”rÜ
 = 0;

7593 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7594 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

7597 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_SAR_ACTIVE
 | 
	`BIT
(3) | BIT(4));

7599 ià(
mode
 > 0)

7600 
ho¡_¡©e
 |ğ((
mode
 - 1è<< 3è| 
SLSI_HOSTSTATE_SAR_ACTIVE
;

7602 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

7603 ià(!
”rÜ
)

7604 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

7605 
	`SLSI_INFO_NODEV
("CÚfigu» Tx Pow” sûÇrio: %d\n", 
mode
);

7606 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7607  
”rÜ
;

7608 
	}
}

7611 
	$¦si_wÏn_»cov”y_š™
(
¦si_dev
 *
sdev
)

7613 
i
;

7614 
Ãtdev_vif
 *
ndev_vif
;

7615 
Ãt_deviû
 *
dev
;

7617 
	`¦si_mlme_£t_couÁry_fÜ_»cov”y
(
sdev
);

7618 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

7619 ià(
sdev
->
Ãtdev
[
i
]) {

7620 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
i
);

7621 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7622 ià(
ndev_vif
->
is_avaabË
) {

7623 
	`Ãtif_tx_¡¬t_®l_queues
(
dev
);

7624 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

7625 
	`¦si_¡¬t_­
(
sdev
->
why
, sdev->
Ãtdev
[
i
], &
ndev_vif
->
backup_£‰šgs
);

7629 
	}
}

7631 
	$¦si_subsy¡em_»£t
(
wÜk_¡ruù
 *
wÜk
)

7633 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
»cov”y_wÜk
);

7634 
”r
 = 0, 
i
;

7635 
Ëv–
;

7636 
Ãtdev_vif
 *
ndev_vif
;

7637 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7638 cÚ¡ 
fœmw¬e
 *
fw
[
SLSI_WLAN_MAX_MIB_FILE
] = { 
NULL
, NULL, NULL };

7641 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7642 
	`SLSI_INFO_NODEV
("Inside subsytem_reset\n");

7643 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

7644 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7645 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

7646 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7647 
	`¦si_h_¡İ
(
sdev
);

7648 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7649 ià(
”r
 !ğ0 || 
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

7651 
”r
 = 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7652 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_CLOSED
;

7653 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7654 ià(
”r
 !ğ0 || 
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 || 
sdev
->
Ãtdev_up_couÁ
 == 0) {

7655 ià(
sdev
->
Ãtdev_up_couÁ
 == 0)

7656 
sdev
->
mlme_blocked
 = 
çl£
;

7659 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7660 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTING
;

7661 #iâdeà
SLSI_TEST_DEV


7662 
”r
 = 
	`¦si_sm_»cov”y_£rviû_İ’
(
sdev
);

7664 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_OPENED
;

7665 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7666 ià(
”r
 !ğ0 || 
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

7667 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7670 
	`»š™_com¶‘iÚ
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

7671 #iâdeà
SLSI_TEST_DEV


7672 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7674 ià(
	`¦si_is_rf_‹¡_mode_’abËd
(è|| 
	`¦si_is_‹¡_mode_’abËd
()) {

7675 
sdev
->
mib
[0].
mib_fe_Çme
 = 
mib_fe_t
;

7676 
sdev
->
mib
[1].
mib_fe_Çme
 = 
mib_fe2_t
;

7678 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

7679 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

7682 ià(
loÿl_mib_š_d¿m
)

7683 
sdev
->
mib
[2].
mib_fe_Çme
 = sdev->
loÿl_mib
.mib_file_name;

7685 
sdev
->
mib
[2].
mib_fe_Çme
 = 
NULL
;

7686 
sdev
->
mib
[2].
mib_Ën
 = 0;

7688 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

7689 
sdev
->
cŞËù_mib
.
num_fes
 = 0;

7692 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
 && 
sdev
->
mib
[i].
mib_fe_Çme
; i++) {

7693 
”r
 = 
	`¦si_mib_İ’_fe
(
sdev
, &sdev->
mib
[
i
], &
fw
[i]);

7696 ià(
i
 =ğ0 && 
”r
) {

7697 
	`SLSI_ERR
(
sdev
, "mib: Mªd©Üy wÏÀhcàmissšg. WLAN wÈnÙ s¹ (”r=%d)\n", 
”r
);

7698 
”r_dÚe
;

7701 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7702 ià(
”r
) {

7703 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7704 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7705 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7706 
”r_dÚe
;

7709 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7710 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7713 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7714 ià(
”r
) {

7715 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7716 
”r_dÚe
;

7718 
	`SLSI_EC_GOTO
(
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
mib
), 
”r
, 
”r_h_¡¬‹d
);

7721 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7722 ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

7723 
	`SLSI_INFO_NODEV
("¦si_sm_»cov”y_£rviû_¡¬ˆçed subsy‹mƒ¼Ü†ev– chªged:%d\n", 
Ëv–
);

7724 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7727 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTED
;

7728 
sdev
->
mlme_blocked
 = 
çl£
;

7729 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STARTED
;

7730 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

7731 ià(
sdev
->
Ãtdev
[
i
]) {

7732 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

7733 
	`»š™_com¶‘iÚ
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

7738 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7739 
	`¦si_wÏn_»cov”y_š™
(
sdev
);

7744 #ifdeà
CONFIG_SCSC_DOWNLOAD_FILE


7745 
”r_h_¡¬‹d
:

7746 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7747 
	`¦si_h_¡İ
(
sdev
);

7748 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7749 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7752 
”r_dÚe
:

7753 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7754 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7755 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7757 
	}
}

7759 
	$¦si_Œigg”_£rviû_çu»
(
wÜk_¡ruù
 *
wÜk
)

7761 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
Œigg”_wÏn_ç_wÜk
);

7762 
»asÚ
[80];

7764 
	`¢´štf
(
»asÚ
, (reason), "Service fail -‚o MLME cfm/ind„eceived");

7765 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
Œue
);

7766 
	}
}

7768 
	$¦si_çu»_»£t
(
wÜk_¡ruù
 *
wÜk
)

7770 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
»cov”y_wÜk_Ú_¡İ
);

7771 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7772 
r
 = 0;

7773 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

7775 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_STARTED
) {

7776 
r
 = 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7777 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7778 
	`¦si_h_¡İ
(
sdev
);

7779 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

7781 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_STOPPED
) {

7782 
r
 = 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7783 ià(!
r
) {

7784 
sdev
->
»quœe_£rviû_şo£
 = 
çl£
;

7785 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_CLOSED
;

7786 ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

7787 
	`com¶‘e_®l
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

7790 ià(
sdev
->
Ãtdev_up_couÁ
 == 0) {

7791 
sdev
->
mlme_blocked
 = 
çl£
;

7792 ià(
	`wÜk_³ndšg
(&
sdev
->
»cov”y_wÜk_Ú_¡¬t
)) {

7793 
	`SLSI_INFO
(
sdev
, "Cancel work for chip„ecovery!!\n");

7794 
	`ÿnûl_wÜk_sync
(&
sdev
->
»cov”y_wÜk_Ú_¡¬t
);

7797 
	`SLSI_INFO_NODEV
("»cov”y_wÜk_Ú_¡İ com¶‘ed„:%d\n", 
r
);

7798 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecovery_work_on_stop completed„:%d\n",

7799 
__func__
, 
r
);

7800 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7801 
	}
}

7803 
	$¦si_ch_»cov”y
(
wÜk_¡ruù
 *
wÜk
)

7805 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
»cov”y_wÜk_Ú_¡¬t
);

7806 
r
 = 0, 
”r
 = 0, 
i
;

7807 
Ãtdev_vif
 *
ndev_vif
;

7808 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7809 cÚ¡ 
fœmw¬e
 *
fw
[
SLSI_WLAN_MAX_MIB_FILE
] = { 
NULL
, NULL, NULL };

7811 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

7813 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

7814 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7815 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_CLOSED
 && sdev->
Ãtdev_up_couÁ
 > 0) {

7816 ià(
sdev
->
»cov”y_¡©us
) {

7817 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_com¶‘ed
,

7818 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

7819 ià(
r
 == 0) {

7820 
	`SLSI_INFO
(
sdev
, "recovery_completedimeout\n");

7821 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘edimedout\n", 
__func__
);

7822 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7824 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

7826 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTING
;

7827 
	`»š™_com¶‘iÚ
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

7828 
	`SLSI_EC_GOTO
(
	`¦si_sm_wÏn_£rviû_İ’
(
sdev
), 
”r
, 
”r_dÚe
);

7829 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_OPENED
;

7830 } ià(
sdev
->
Ãtdev_up_couÁ
 == 0) {

7831 
sdev
->
mlme_blocked
 = 
çl£
;

7832 
”r_dÚe
;

7834 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_OPENED
 && sdev->
Ãtdev_up_couÁ
 > 0) {

7835 #iâdeà
SLSI_TEST_DEV


7836 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7838 ià(
	`¦si_is_rf_‹¡_mode_’abËd
(è|| 
	`¦si_is_‹¡_mode_’abËd
()) {

7839 
sdev
->
mib
[0].
mib_fe_Çme
 = 
mib_fe_t
;

7840 
sdev
->
mib
[1].
mib_fe_Çme
 = 
mib_fe2_t
;

7842 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

7843 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

7846 ià(
loÿl_mib_š_d¿m
)

7847 
sdev
->
mib
[2].
mib_fe_Çme
 = sdev->
loÿl_mib
.mib_file_name;

7849 
sdev
->
mib
[2].
mib_fe_Çme
 = 
NULL
;

7850 
sdev
->
mib
[2].
mib_Ën
 = 0;

7852 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

7853 
sdev
->
cŞËù_mib
.
num_fes
 = 0;

7856 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
 && 
sdev
->
mib
[i].
mib_fe_Çme
; i++) {

7857 
”r
 = 
	`¦si_mib_İ’_fe
(
sdev
, &sdev->
mib
[
i
], &
fw
[i]);

7860 ià(
i
 =ğ0 && 
”r
) {

7861 
	`SLSI_ERR
(
sdev
, "mib: Mªd©Üy wÏÀhcàmissšg. WLAN wÈnÙ s¹ (”r=%d)\n", 
”r
);

7862 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7863 
”r_dÚe
;

7866 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7867 ià(
”r
) {

7868 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7869 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: slsi_sm_wlan_service_start failed:ƒrr=%d\n",

7870 
__func__
, 
”r
);

7871 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7873 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7874 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7875 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7876 
”r_dÚe
;

7879 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7880 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7883 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7884 ià(
”r
) {

7885 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7886 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7887 
”r_dÚe
;

7889 
	`SLSI_EC_GOTO
(
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
mib
), 
”r
, 
”r_h_¡¬‹d
);

7892 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTED
;

7895 
sdev
->
mlme_blocked
 = 
çl£
;

7896 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STARTED
;

7898 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: mlme_blocked[0],„ecov”y_¡©e[0]\n", 
__func__
);

7899 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7901 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

7902 ià(
sdev
->
Ãtdev
[
i
]) {

7903 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

7904 
	`»š™_com¶‘iÚ
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

7907 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7908 
	`¦si_wÏn_»cov”y_š™
(
sdev
);

7909 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7912 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7913 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7916 #ifdeà
CONFIG_SCSC_DOWNLOAD_FILE


7917 
”r_h_¡¬‹d
:

7918 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7919 
	`¦si_h_¡İ
(
sdev
);

7920 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7921 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7922 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7925 
”r_dÚe
:

7926 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7927 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7928 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7929 
	}
}

7931 
	$¦si_sy¡em_”rÜ_»cov”y
(
wÜk_¡ruù
 *
wÜk
)

7933 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
sy¡em_”rÜ_u£r_ç_wÜk
);

7934 
Ãt_deviû
 *
dev
 = 
NULL
;

7935 
r
 = 0;

7936 
”r
 = 0;

7938 ià(
sdev
->
»cov”y_¡©us
) {

7939 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_com¶‘ed
,

7940 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

7941 ià(
r
 == 0)

7942 
	`SLSI_INFO
(
sdev
, "recovery_completedimeout\n");

7944 
sdev
->
mlme_blocked
 = 
çl£
;

7946 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

7948 
sdev
->
mlme_blocked
 = 
çl£
;

7951 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl_š™
);

7952 
	`SLSI_INFO
(
sdev
, "Calling slsi_start\n");

7953 
”r
 = 
	`¦si_¡¬t
(
sdev
, 
dev
);

7954 ià(
”r
)

7955 
	`SLSI_INFO
(
sdev
, "¦si_¡¬ˆçed,ƒ¼ = %d\n", 
”r
);

7957 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

7958 
sdev
->
»cov”y_ç_§ã
 = 
çl£
;

7959 
	`com¶‘e_®l
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

7960 
	}
}

7962 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

7964 
	#MAX_LOG_SIZE
 500*1024

	)

7966 
	$¦si_cŞËù_ch£t_logs
(
wÜk_¡ruù
 *
wÜk
)

7968 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
ch£t_loggšg_wÜk
);

7969 
scsc_£rviû
 *
£rviû
;

7970 *
bufãr
 = 
NULL
;

7971 
size_t
 
size
;

7972 
size_t
 
by‹s
 = 0;

7973 
»t
 = 0;

7974 
bud_id_fw
[128];

7975 
bud_id_drv
[64];

7976 
size_t
 
tÙ®_h—d”
;

7978 
tÙ®_h—d”
 = (
bud_id_fw
è+ (
bud_id_drv
);

7980 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7981 ià(!
sdev
 || !sdev->
£rviû
) {

7982 
	`SLSI_ERR
(
sdev
, "sdev/service is NULL\n");

7983 
dump_š_´og»ss
 = 0;

7984 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7988 
£rviû
 = 
sdev
->service;

7990 
size
 = 
	`scsc_£rviû_mxlogg”_buff_size
(
£rviû
, 
SCSC_LOG_CHUNK_UDI
, 
SCSC_MIFINTR_TARGET_WLAN
);

7992 ià(
size
 < 
tÙ®_h—d”
) {

7993 
	`SLSI_INFO
(
sdev
, "NÙƒnough s·û, siz%zu h—d” %zu\n", 
size
, 
tÙ®_h—d”
);

7994 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7998 ià(
size
 > 
MAX_LOG_SIZE
)

7999 
size
 = 
MAX_LOG_SIZE
;

8001 
	`SLSI_INFO
(
sdev
, "SCSC_LOG_CHUNK_UDI chunk siz%zu\n", 
size
);

8003 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

8004 
	`SLSI_INFO
(
sdev
, "Skip chipset_log in off state\n");

8005 
dÚe
;

8008 
bufãr
 = 
	`vm®loc
(
size
);

8009 ià(!
bufãr
) {

8010 
	`SLSI_ERR
(
sdev
, "Memory‡llocation failed\n");

8011 
dÚe
;

8014 
	`mxmª_g‘_fw_v”siÚ
(
bud_id_fw
, (build_id_fw));

8015 
	`memıy
(
bufãr
, 
bud_id_fw
, (build_id_fw));

8016 
	`mxmª_g‘_driv”_v”siÚ
(
bud_id_drv
, (build_id_drv));

8017 
	`memıy
(
bufãr
 + (
bud_id_fw
), 
bud_id_drv
, (build_id_drv));

8019 
by‹s
 = 
	`scsc_£rviû_cŞËù_bufãr
(
£rviû
, 
SCSC_LOG_CHUNK_UDI
,

8020 
bufãr
 + 
tÙ®_h—d”
, 
size
 -Ù®_h—d”, 
SCSC_MIFINTR_TARGET_WLAN
);

8021 
	`SLSI_INFO
(
sdev
, "SCSC_LOG_CHUNK_UDI by‹ cŞËùed %zu\n", 
by‹s
);

8022 ià(
by‹s
) {

8023 #ifdeà
CONFIG_SCSC_WLBTD


8025 
»t
 = 
	`scsc_wÏn_mm­_£t_bufãr
(
bufãr
, 
by‹s
 + 
tÙ®_h—d”
);

8026 ià(
»t
) {

8027 
	`SLSI_ERR
(
sdev
, "scsc_wÏn_mm­_£t_bufã¸”¸ğ%d\n", 
»t
);

8028 
dÚe
;

8031 
»t
 = 
	`wlbtd_ch£t_loggšg
(
bufãr
, 
by‹s
 + 
tÙ®_h—d”
, 
Œue
);

8032 ià(
»t
)

8033 
	`SLSI_ERR
(
sdev
, "wlbtd ch£ˆloggšg faedƒ¼ = %d\n", 
»t
);

8035 
	`scsc_wÏn_mm­_£t_bufãr
(
NULL
, 0);

8037 
	`SLSI_INFO
(
sdev
, "wlbtd support is‚otƒnabled\n");

8040 
	`SLSI_ERR
(
sdev
, "byte writteno buffer is NULL\n");

8042 
dÚe
:

8043 
dump_š_´og»ss
 = 0;

8044 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

8045 
	`vä“
(
bufãr
);

8046 
	}
}

8049 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


8050 
	$¦si_£t_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

8052 
»t
 = 0;

8053 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

8054 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

8055 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

8056 
™o
;

8058 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

8059 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

8061 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
™o
)) {

8062 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

8063 
	`kä“
(
ioùl_¬gs
);

8064  -
EINVAL
;

8067 ià(!(
™o
 >= 100)) {

8068 
	`SLSI_ERR
(
sdev
, "Inv®id ITO v®ue: %u\n", 
™o
);

8069 
	`kä“
(
ioùl_¬gs
);

8070  -
EINVAL
;

8072 
»t
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT
, 
™o
);

8073 
	`kä“
(
ioùl_¬gs
);

8074  
»t
;

8075 
	}
}

8077 
	$¦si_’abË_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

8079 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

8080 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

8081 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

8082 
™o_v®ue
 = 0;

8084 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

8085 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

8087 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
™o_v®ue
)) {

8088 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

8089 
	`kä“
(
ioùl_¬gs
);

8090  -
EINVAL
;

8093 ià(
™o_v®ue
 != 0 && ito_value != 1) {

8094 
	`SLSI_ERR
(
sdev
, "Inv®id ITO modv®ue: '%d'\n", 
™o_v®ue
);

8095 
	`kä“
(
ioùl_¬gs
);

8096  -
EINVAL
;

8098 
	`kä“
(
ioùl_¬gs
);

8099  
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_DYNAMIC_ITO_ENABLE
, 
™o_v®ue
);

8100 
	}
}

8104 
	$¦si_sÜt_¬¿y
(
u8
 
¬r
[], 
n
)

8106 
i
, 
j
;

8107 
u8
 
‹mp
;

8108 
boŞ
 
sw­³d
;

8110 
i
 = 0; i < 
n
 - 1; i++) {

8111 
sw­³d
 = 
çl£
;

8112 
j
 = 0; j < 
n
 - 
i
 - 1; j++) {

8113 ià(
¬r
[
j
] >‡rr[j + 1]) {

8114 
‹mp
 = 
¬r
[
j
];

8115 
¬r
[
j
] =‡rr[j + 1];

8116 
¬r
[
j
 + 1] = 
‹mp
;

8117 
sw­³d
 = 
Œue
;

8121 ià(
sw­³d
 =ğ
çl£
)

8124 
	}
}

8127 
	$¦si_»move_du¶iÿ‹s
(
u8
 
¬r
[], 
n
)

8129 
j
 = 0, 
i
 = 0;

8131 ià(
n
 == 0 ||‚ == 1)

8132  
n
;

8134 
i
 = 0; i < 
n
 - 1; i++)

8135 ià(
¬r
[
i
] !=‡rr[i + 1])

8136 
¬r
[
j
++] =‡¼[
i
];

8138 
¬r
[
j
++] =‡¼[
n
 - 1];

8139  
j
;

8140 
	}
}

8143 
	$¦si_m”ge_li¡s
(
u8
 
¬1
[], 
Ën1
, u8 
¬2
[], 
Ën2
, u8 
»suÉ
[])

8145 
k
 = 0, 
i
 = 0, 
Ãw_Ën
 = 0;

8147 
i
 = 0; i < 
Ën1
; i++)

8148 
»suÉ
[
k
++] = 
¬1
[
i
];

8150 
i
 = 0; i < 
Ën2
; i++)

8151 
»suÉ
[
k
++] = 
¬2
[
i
];

8153 
	`¦si_sÜt_¬¿y
(
»suÉ
, 
k
);

8154 
Ãw_Ën
 = 
	`¦si_»move_du¶iÿ‹s
(
»suÉ
, 
k
);

8155 ià(
Ãw_Ën
 > 
SLSI_ROAMING_CHANNELS_MAX
)

8156 
Ãw_Ën
 = 
SLSI_ROAMING_CHANNELS_MAX
;

8158  
Ãw_Ën
;

8159 
	}
}

8161 
	$¦si_rx_upd©e_wake_¡©s
(
¦si_dev
 *
sdev
, 
‘hhdr
 *
ehdr
, 
buff_Ën
)

8163 
¦si_wÏn_driv”_wake_»asÚ_út
 *
wake_»asÚ_couÁ
 = &
sdev
->
wake_»asÚ_¡©s
;

8165 
	`¦si_¥šlock_lock
(&
sdev
->
wake_¡©s_lock
);

8166 
wake_»asÚ_couÁ
->
tÙ®_rx_d©a_wake
++;

8167 ià(
buff_Ën
 < (
‘hhdr
))

8168 
ex™
;

8169 ià(
	`is_brßdÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

8170 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_brßdÿ¡_út
++;

8171 
	`SLSI_DBG3
(
sdev
, 
SLSI_PM
, "Wakeu°by brßdÿ¡„x d©¨·ck‘:%d\n", 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_brßdÿ¡_út
);

8172 } ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

8173 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_muÉiÿ¡_út
++;

8174 
	`SLSI_DBG3
(
sdev
, 
SLSI_PM
, "Wakeu°by muÉiÿ¡„x d©¨·ck‘:%d\n", 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_muÉiÿ¡_út
);

8175 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IP
)

8176 
wake_»asÚ_couÁ
->
rx_muÉiÿ¡_wake_pkt_šfo
.
v4_rx_muÉiÿ¡_addr_út
++;

8177 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IPV6
)

8178 
wake_»asÚ_couÁ
->
rx_muÉiÿ¡_wake_pkt_šfo
.
v6_rx_muÉiÿ¡_addr_út
++;

8180 
wake_»asÚ_couÁ
->
rx_muÉiÿ¡_wake_pkt_šfo
.
Ùh”_rx_muÉiÿ¡_addr_út
++;

8182 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_uniÿ¡_út
++;

8184 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IP
 && 
buff_Ën
 - (
‘hhdr
è>ğ(
hdr
)) {

8185 
hdr
 *

 = (hd¸*)(
ehdr
 + 1);

8187 
	`SLSI_DBG3
(
sdev
, 
SLSI_PM
, "Wakeu°by i°rx d©¨·ck‘…rÙocŞ :%d\n", 

->
´ÙocŞ
);

8188 ià(

->
´ÙocŞ
 =ğ
IPPROTO_ICMP
)

8189 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp_pkt
++;

8190 } ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IPV6
 && 
buff_Ën
 - (
‘hhdr
è>ğ(
v6hdr
)) {

8191 
v6hdr
 *

 = (v6hd¸*)(
ehdr
 + 1);

8193 
	`SLSI_DBG3
(
sdev
, 
SLSI_PM
, "Wakeu°by ipv6„x d©¨·ck‘‚exˆhdr:%d\n", 

->
Ãxthdr
);

8194 ià(

->
Ãxthdr
 =ğ
SLSI_ICMP6_PACKET
) {

8195 
icmp6hdr
 *
icmp6
 = (icmp6hd¸*)(

 + 1);

8197 
	`SLSI_DBG3
(
sdev
, 
SLSI_PM
, "Wakeu°by icmpv6„x d©¨·ck‘y³:%d\n", 
icmp6
->
icmp6_ty³
);

8198 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_pkt
++;

8199 ià(
buff_Ën
 - (
‘hhdr
è- (
v6hdr
è< (
icmp6hdr
))

8200 
ex™
;

8201 ià(
icmp6
->
icmp6_ty³
 =ğ
SLSI_ICMP6_PACKET_TYPE_RA
)

8202 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_¿
++;

8203 ià(
icmp6
->
icmp6_ty³
 =ğ
SLSI_ICMP6_PACKET_TYPE_NS
)

8204 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_ns
++;

8205 ià(
icmp6
->
icmp6_ty³
 =ğ
SLSI_ICMP6_PACKET_TYPE_NA
)

8206 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_Ç
++;

8209 
ex™
:

8210 
	`¦si_¥šlock_uÆock
(&
sdev
->
wake_¡©s_lock
);

8211 
	}
}

8213 #ià!
defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

8214 
	$¦si_¬p_q_¡uck_wÜk_hªdË
(
wÜk_¡ruù
 *
wÜk
)

8216 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, ¦si_dev, 
uÅau£_¬p_q_wÜk
);

8217 
Ãtdev_vif
 *
ndev_vif
;

8218 
i
;

8220 
	`SLSI_INFO
(
sdev
, "Re£‰šghARP couÁ”s,‡½_tx_couÁ = %d\n", sdev->
¬p_tx_couÁ
);

8221 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

8222 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
))

8223 
	`©omic_£t
(&
sdev
->
¬p_tx_couÁ
, 0);

8224 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

8227 
	`¹Æ_lock
();

8228 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

8229 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

8230 ià(
sdev
->
Ãtdev
[
i
]) {

8231 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

8232 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

8234 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

8235 
	`¹Æ_uÆock
();

8237 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

8238 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
))

8239 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

8240 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

8241 
	}
}

8244 
u8
 *
	$¦si_g‘_sÿn_exŒa_›s
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
›s
, 
tÙ®_Ën
, *
exŒa_Ën
)

8246 
u8
 *
deçuÉ_›s
 = 
sdev
->
deçuÉ_sÿn_›s
;

8247 
deçuÉ_›_Ën
 = 
sdev
->
deçuÉ_sÿn_›s_Ën
;

8248 
i
 = 0;

8249 
u8
 
id
, 
›_Ën
;

8250 
u8
 *
Ãw_›s
 = 
NULL
;

8251 
cur_Ën
 = 0;

8253 *
exŒa_Ën
 = 0;

8254 ià(
deçuÉ_›_Ën
 <ğ0 || !
deçuÉ_›s
)

8255  
NULL
;

8257 
Ãw_›s
 = 
	`km®loc
(
deçuÉ_›_Ën
, 
GFP_KERNEL
);

8258 ià(!
Ãw_›s
) {

8259 
	`SLSI_ERR
(
sdev
, "Memory‡lloc failed\n");

8260  
NULL
;

8262 
i
 < 
deçuÉ_›_Ën
 - 2) {

8263 
id
 = *(
deçuÉ_›s
 + 
i
);

8264 
›_Ën
 = *(
deçuÉ_›s
 + 
i
 + 1);

8265 ià(
cur_Ën
 + 
›_Ën
 + 2 > 
deçuÉ_›_Ën
)

8267 ià(!
	`cfg80211_fšd_›
(
id
, 
›s
, 
tÙ®_Ën
)) {

8268 
	`memıy
(
Ãw_›s
 + 
cur_Ën
, 
deçuÉ_›s
 + 
i
, 
›_Ën
 + 2);

8269 
cur_Ën
 +ğ(
›_Ën
 + 2);

8271 
i
 +ğ(
›_Ën
 + 2);

8273 *
exŒa_Ën
 = 
cur_Ën
;

8274 ià(*
exŒa_Ën
 == 0) {

8275 
	`kä“
(
Ãw_›s
);

8276  
NULL
;

8278  
Ãw_›s
;

8279 
	}
}

8281 
	$¦si_add_´obe_›s_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

8283 
u8
 *
deçuÉ_›s
, *
add_šfo_›s
;

8284 
deçuÉ_›_Ën
 = 0;

8285 
add_šfo_›_Ën
 = 0;

8286 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

8287 
r
 = 0;

8289 
deçuÉ_›s
 = 
NULL
;

8290 
add_šfo_›s
 = 
NULL
;

8291 ià(
sdev
->
deçuÉ_sÿn_›s_Ën
 > 0)

8292 
deçuÉ_›s
 = 
	`¦si_g‘_sÿn_exŒa_›s
(
sdev
, 
ndev_vif
->
´obe_»q_›s
,‚dev_vif->
´obe_»q_›_Ën
, &
deçuÉ_›_Ën
);

8294 
add_šfo_›_Ën
 = 
deçuÉ_›_Ën
 + 
ndev_vif
->
´obe_»q_›_Ën
;

8296 ià(
add_šfo_›_Ën
 > 0) {

8297 
add_šfo_›s
 = 
	`km®loc
(
add_šfo_›_Ën
, 
GFP_KERNEL
);

8298 ià(!
add_šfo_›s
) {

8299 
	`SLSI_ERR
(
sdev
, "Memory‡lloc failed\n");

8300 
	`kä“
(
deçuÉ_›s
);

8301  -
ENOMEM
;

8303 
	`memıy
(
add_šfo_›s
, 
ndev_vif
->
´obe_»q_›s
,‚dev_vif->
´obe_»q_›_Ën
);

8304 
	`memıy
(
add_šfo_›s
 + 
ndev_vif
->
´obe_»q_›_Ën
, 
deçuÉ_›s
, 
deçuÉ_›_Ën
);

8305 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_REQUEST
, 
add_šfo_›s
,

8306 
add_šfo_›_Ën
);

8308 
	`kä“
(
deçuÉ_›s
);

8309 
	`kä“
(
add_šfo_›s
);

8311  
r
;

8312 
	}
}

8314 
	$¦si_dump_‘h_·ck‘
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

8316 
›“80211_hdr
 *
hdr
;

8317 
off£t
 = 0;

8318 
·ylßd_Ën
, 
»maš_Ën
;

8319 
boŞ
 
is_ch”ed
;

8320 
u8
 *
qc
 = 
NULL
;

8322 
hdr
 = (
›“80211_hdr
 *)
	`çpi_g‘_d©a
(
skb
);

8323 
·ylßd_Ën
 = 
skb
->
Ën
 - 
	`çpi_g‘_sigËn
(skb);

8324 
is_ch”ed
 = (
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
cÚfigu¿tiÚ_İtiÚ
è& 
FAPI_OPTION_KEYRSC
) >> 3;

8326 ià(!
	`›“80211_is_d©a
(
hdr
->
äame_cÚŒŞ
)) {

8327 
	`SLSI_INFO
(
sdev
, "Ignorehis…acket. It is‚ot data\n");

8328 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
hdr
, 
·ylßd_Ën
 > 54 ? 54 :…ayload_len);

8329  -
EINVAL
;

8333 ià(
	`›“80211_has_a4
(
hdr
->
äame_cÚŒŞ
))

8334 
off£t
 +ğ(
›“80211_hdr
);

8336 
off£t
 +ğ(
›“80211_hdr_3addr
);

8338 ià(
	`›“80211_is_d©a_qos
(
hdr
->
äame_cÚŒŞ
)) {

8339 
qc
 = 
	`›“80211_g‘_qos_ùl
(
hdr
);

8340 
off£t
 +ğ
IEEE80211_QOS_CTL_LEN
;

8343 ià(
	`›“80211_has_Üd”
(
hdr
->
äame_cÚŒŞ
))

8344 
off£t
 +ğ
IEEE80211_HT_CTL_LEN
;

8347 ià(
is_ch”ed
)

8348 
off£t
 +ğ
SLSI_EAPOL_KEY_RSC_LENGTH
;

8351 ià(
qc
 && (*qø& 
IEEE80211_QOS_CTL_A_MSDU_PRESENT
)) {

8352 
	`SLSI_DBG4
(
sdev
, 
SLSI_RX
, "Pack‘ i A-MSDU off£t:%d\n", 
off£t
);

8353 
»maš_Ën
 = 
·ylßd_Ën
 - 
off£t
;

8354 ià(
»maš_Ën
 < 0) {

8355 
	`SLSI_INFO
(
sdev
, "Invalid…acket†en\n");

8356  -
EINVAL
;

8358 
	`SCSC_BIN_TAG_INFO
(
BINARY
, (
u8
 *)
hdr
 + 
off£t
, 
»maš_Ën
 > 2 * 
ETH_ALEN
 ? 2 * ETH_ALEN :„emain_len);

8360 
off£t
 +ğ2 * 
ETH_ALEN
 + 
LLC_SNAP_HDR_LEN
;

8362 
	`SLSI_DBG4
(
sdev
, 
SLSI_RX
, "Pack‘ i MSDU off£t:%d\n", 
off£t
);

8363 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
	`›“80211_g‘_DA
(
hdr
), 
ETH_ALEN
);

8364 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
	`›“80211_g‘_SA
(
hdr
), 
ETH_ALEN
);

8366 
off£t
 +ğ
LLC_SNAP_HDR_LEN
 - 2;

8369 
»maš_Ën
 = 
·ylßd_Ën
 - 
off£t
;

8370 ià(
»maš_Ën
 < 0) {

8371 
	`SLSI_INFO
(
sdev
, "Invalid…acket†en\n");

8372  -
EINVAL
;

8374 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


8375 
	`SCSC_BIN_TAG_INFO
(
BINARY
, (
u8
 *)
hdr
 + 
off£t
, 
»maš_Ën
 > 116 ? 116 :„emain_len);

8377 
	`SCSC_BIN_TAG_INFO
(
BINARY
, (
u8
 *)
hdr
 + 
off£t
, 
»maš_Ën
 > 42 ? 42 :„emain_len);

8380 
	}
}

8383 
boŞ
 
	$¦si_is_rf_‹¡_mode_’abËd
()

8385  
EÇbËRfTe¡Mode
;

8386 
	}
}

8389 
ssize_t
 
	$sysfs_show_pm
(
kobjeù
 *
kobj
,

8390 
kobj_©Œibu‹
 *
©Œ
,

8391 *
buf
)

8393  
	`¥rštf
(
buf
, "%d\n", !
EÇbËRfTe¡Mode
);

8394 
	}
}

8397 
ssize_t
 
	$sysfs_¡Üe_pm
(
kobjeù
 *
kobj
,

8398 
kobj_©Œibu‹
 *
©Œ
,

8399 cÚ¡ *
buf
,

8400 
size_t
 
couÁ
)

8402 
r
;

8403 
sysfs_pm
;

8405 
r
 = 
	`k¡¹ošt
(
buf
, 10, &
sysfs_pm
);

8406 ià(
r
 =ğ0 && (
sysfs_pm
 == 0 || sysfs_pm == 1))

8407 
EÇbËRfTe¡Mode
 = (!(
boŞ
)
sysfs_pm
);

8409 
	`´_”r
("Invalid…m value. Must be 0 or 1\n");

8411 
	`SLSI_INFO_NODEV
("pm: %d\n", !
EÇbËRfTe¡Mode
);

8413  (
r
 =ğ0è? 
couÁ
 : 0;

8414 
	}
}

8417 
	$¦si_ü—‹_sysfs_pm
()

8419 
r
;

8421 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

8422 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

8424 ià(
wifi_kobj_»f
) {

8426 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
pm_©Œ
.
©Œ
);

8427 ià(
r
) {

8429 
	`´_”r
("Can't create /sys/wifi/pm\n");

8433 
	`´_”r
("failedo create /sys/wifi/pm\n");

8435 
	}
}

8438 
	$¦si_de¡roy_sysfs_pm
()

8440 ià(!
wifi_kobj_»f
)

8444 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
pm_©Œ
.
©Œ
);

8447 
	`mxmª_wifi_kobjeù_»f_put
();

8448 
	}
}

8451 
ssize_t
 
	$sysfs_show_ªt
(
kobjeù
 *
kobj
,

8452 
kobj_©Œibu‹
 *
©Œ
,

8453 *
buf
)

8455  
	`¥rštf
(
buf
, "%d\n", 
sysfs_ª‹Âa
);

8456 
	}
}

8459 
ssize_t
 
	$sysfs_¡Üe_ªt
(
kobjeù
 *
kobj
,

8460 
kobj_©Œibu‹
 *
©Œ
,

8461 cÚ¡ *
buf
,

8462 
size_t
 
couÁ
)

8464 
r
;

8465 
ª‹Âa
;

8467 
r
 = 
	`k¡¹ošt
(
buf
, 10, &
ª‹Âa
);

8468 ià(
r
 < 0 || 
ª‹Âa
 < 0 ||‡ntenna > 3)

8469 
	`´_”r
("Invalid‡nt value. Min:0 Max:3\n");

8471 
sysfs_ª‹Âa
 = (
u16
)
ª‹Âa
;

8473 
	`SLSI_INFO_NODEV
("ª‹Âa: %d\n", 
sysfs_ª‹Âa
);

8475  (
r
 =ğ0è? 
couÁ
 : 0;

8476 
	}
}

8479 
	$¦si_ü—‹_sysfs_ªt
()

8481 
r
;

8483 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

8484 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

8486 ià(
wifi_kobj_»f
) {

8488 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
ªt_©Œ
.
©Œ
);

8489 ià(
r
) {

8491 
	`´_”r
("Can't create /sys/wifi/ant\n");

8495 
	`´_”r
("failedo create /sys/wifi/ant\n");

8497 
	}
}

8500 
	$¦si_de¡roy_sysfs_ªt
()

8502 ià(!
wifi_kobj_»f
)

8506 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
ªt_©Œ
.
©Œ
);

8509 
	`mxmª_wifi_kobjeù_»f_put
();

8510 
	}
}

	@mgt.h

7 #iâdeà
__SLSI_MGT_H__


8 
	#__SLSI_MGT_H__


	)

10 
	~<lšux/mu‹x.h
>

12 
	~"dev.h
"

13 
	~"»g_šfo.h
"

14 
	~"debug.h
"

17 #iâdeà
WLAN_OUI_MICROSOFT


18 
	#WLAN_OUI_MICROSOFT
 0x0050f2

	)

19 
	#WLAN_OUI_TYPE_MICROSOFT_WPA
 1

	)

20 
	#WLAN_OUI_TYPE_MICROSOFT_WMM
 2

	)

21 
	#WLAN_OUI_TYPE_MICROSOFT_WPS
 4

	)

24 
	#WLAN_OUI_SAMSUNG
 0x0000f0

	)

25 
	#WLAN_OUI_TYPE_SAMSUNG_KEO
 0x22

	)

27 
	#SLSI_COUNTRY_CODE_LEN
 3

	)

29 
	#SLSI_EAPOL_TYPE_RSN_KEY
 (2)

	)

30 
	#SLSI_EAPOL_TYPE_WPA_KEY
 (254)

	)

32 
	#SLSI_IEEE8021X_TYPE_EAPOL_KEY
 3

	)

33 
	#SLSI_IEEE8021X_TYPE_EAP_PACKET
 0

	)

35 
	#SLSI_EAPOL_KEY_INFO_KEY_TYPE_BIT_IN_LOWER_BYTE
 
	`BIT
(3è

	)

36 
	#SLSI_EAPOL_KEY_INFO_ACK_BIT_IN_LOWER_BYTE
 
	`BIT
(7)

	)

37 
	#SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
 
	`BIT
(0)

	)

38 
	#SLSI_EAPOL_KEY_INFO_SECURE_BIT_IN_HIGHER_BYTE
 
	`BIT
(1)

	)

39 
	#SLSI_EAPOL_KEY_INFO_REQUEST_BIT_IN_HIGHER_BYTE
 
	`BIT
(3)

	)

40 
	#SLSI_EAPOL_KEY_INFO_ENCR_DATA_BIT_IN_HIGHER_BYTE
 
	`BIT
(4)

	)

50 
	#SLSI_EAPOL_IEEE8021X_TYPE_POS
 (1)

	)

51 
	#SLSI_EAPOL_TYPE_POS
 (4)

	)

52 
	#SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
 (5)

	)

53 
	#SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
 (6)

	)

54 
	#SLSI_EAPOL_KEY_DATA_LENGTH_HIGHER_BYTE_POS
 (97)

	)

55 
	#SLSI_EAPOL_KEY_DATA_LENGTH_LOWER_BYTE_POS
 (98)

	)

56 
	#SLSI_EAPOL_KEY_RSC_LENGTH
 (8)

	)

58 
	#SLSI_EAP_CODE_POS
 (4)

	)

59 
	#SLSI_EAP_PACKET_REQUEST
 (1)

	)

60 
	#SLSI_EAP_PACKET_RESPONSE
 (2)

	)

61 
	#SLSI_EAP_PACKET_SUCCESS
 (3)

	)

62 
	#SLSI_EAP_PACKET_FAILURE
 (4)

	)

63 
	#SLSI_EAP_TYPE_POS
 (8)

	)

64 
	#SLSI_EAP_TYPE_EXPANDED
 (254)

	)

65 
	#SLSI_EAP_OPCODE_POS
 (16)

	)

66 
	#SLSI_EAP_OPCODE_WSC_MSG
 (4)

	)

67 
	#SLSI_EAP_OPCODE_WSC_START
 (1)

	)

68 
	#SLSI_EAP_MSGTYPE_POS
 (27)

	)

69 
	#SLSI_EAP_MSGTYPE_M8
 (12)

	)

70 
	#SLSI_EAP_WPS_DWELL_TIME
 (100000è

	)

71 
	#SLSI_EAP_TYPE_IDENTITY
 (1)

	)

72 
	#SLSI_EAP_TYPE_NOTIFICATION
 (2)

	)

73 
	#SLSI_EAP_TYPE_NAK
 (3)

	)

74 
	#SLSI_EAP_TYPE_MD5
 (4)

	)

75 
	#SLSI_EAP_TYPE_OTP
 (5)

	)

76 
	#SLSI_EAP_TYPE_GTC
 (6)

	)

77 
	#SLSI_EAP_TYPE_TLS
 (13)

	)

78 
	#SLSI_EAP_TYPE_LEAP
 (17)

	)

79 
	#SLSI_EAP_TYPE_SIM
 (18)

	)

80 
	#SLSI_EAP_TYPE_TTLS
 (21)

	)

81 
	#SLSI_EAP_TYPE_AKA
 (23)

	)

82 
	#SLSI_EAP_TYPE_PEAP
 (25)

	)

83 
	#SLSI_EAP_TYPE_MSCHAPV2
 (26)

	)

84 
	#SLSI_EAP_TYPE_TLV
 (33)

	)

85 
	#SLSI_EAP_TYPE_TNC
 (38)

	)

86 
	#SLSI_EAP_TYPE_FAST
 (43)

	)

87 
	#SLSI_EAP_TYPE_PAX
 (46)

	)

88 
	#SLSI_EAP_TYPE_PSK
 (47)

	)

89 
	#SLSI_EAP_TYPE_SAKE
 (48)

	)

90 
	#SLSI_EAP_TYPE_IKEV2
 (49)

	)

91 
	#SLSI_EAP_TYPE_AKA_PRIME
 (50)

	)

92 
	#SLSI_EAP_TYPE_GPSK
 (51)

	)

93 
	#SLSI_EAP_TYPE_PWD
 (52)

	)

94 
	#SLSI_EAP_TYPE_EKE
 (53)

	)

96 
	#SLSI_80211_AC_VO
 0

	)

97 
	#SLSI_80211_AC_VI
 1

	)

98 
	#SLSI_80211_AC_BE
 2

	)

99 
	#SLSI_80211_AC_BK
 3

	)

101 
	#SLSI_AES_BLOCK_SIZE
 16

	)

102 
	#SLSI_WPA_REPLAY_COUNTER_LEN
 8

	)

103 
	#SLSI_WPA_NONCE_LEN
 32

	)

104 
	#SLSI_WPA_KEY_RSC_LEN
 8

	)

106 
	s¦si_w·_—pŞ_key
 {

107 
u8
 
	mv”siÚ
;

108 
u8
 
	mty³
;

109 
u16
 
	mËngth
;

110 
u8
 
	mkey_desc_ty³
;

111 
u8
 
	mkey_šfo
[2];

112 
u8
 
	mkey_Ëngth
[2];

113 
u8
 
	m»¶ay_couÁ”
[
SLSI_WPA_REPLAY_COUNTER_LEN
];

114 
u8
 
	mkey_nÚû
[
SLSI_WPA_NONCE_LEN
];

115 
u8
 
	mkey_iv
[16];

116 
u8
 
	mkey_rsc
[
SLSI_WPA_KEY_RSC_LEN
];

117 
u8
 
	mkey_id
[8];

118 } 
	g__·cked
;

121 #ifdeà
CONFIG_SCSC_WLAN_DUAL_STATION


122 
	#SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è((Òdev_vif)->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
) ||\

123 (((
ndev_vif
)->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
è&& (Òdev_vif)->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)))

	)

125 
	#SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
èÒdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
)

	)

127 
	#SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
èÒdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2P
)

	)

128 #ià
defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

129 
	#SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) &&\

130 (
sdev
->
Ãtdev_­
 !ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]))

	)

131 
	#SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) &&\

132 (
sdev
->
Ãtdev_­
 =ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]))

	)

134 
	#SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
è(
	`SLSI_UNUSED_PARAMETER
(sdev), (ndev_vif)->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
)

	)

136 #ià
defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
)

137 
	#SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) &&\

138 (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
) &&\

139 (
sdev
->
Ãtdev_­
 =ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]))

	)

141 
	#SLSI_IS_VIF_INDEX_NAN
(
ndev_vif
è(Òdev_vif)->
iâum
 =ğ
SLSI_NET_INDEX_NAN
)

	)

144 
	#SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2P
è&& (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_DISCOVERY
))

	)

147 
	#SLSI_IS_HS2_UNSYNC_VIF
(
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
è&& (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_PRECONNECT
))

	)

150 
	#SLSI_IS_P2P_GROUP_STATE
(
sdev
è((sdev->
p2p_¡©e
 =ğ
P2P_GROUP_FORMED_GO
è|| (sdev->p2p_¡©=ğ
P2P_GROUP_FORMED_CLI
))

	)

153 
	#SLSI_STA_ROAM_REPORT_EXTRA_DELAY_MSEC
 50

	)

156 
	#SLSI_P2P_ROC_EXTRA_MSEC
 10

	)

159 
	#SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
 2000

	)

161 
	#SLSI_HS2_UNSYNC_VIF_EXTRA_MSEC
 1000

	)

166 
	#SLSI_P2P_NEG_PROC_UNSYNC_VIF_RETAIN_DURATION
 3000

	)

171 
	#SLSI_P2P_UNSET_CHANNEL_EXTRA_MSEC
 600

	)

172 
	#SLSI_P2P_DELAY_UNSET_CHANNEL_AFTER_P2P_PROCEDURE
 30

	)

174 
	#SLSI_P2P_MGMT_TX_EXTRA_MSEC
 100

	)

176 
	#SLSI_FORCE_SCHD_ACT_FRAME_MSEC
 100

	)

177 
	#SLSI_P2PGO_KEEP_ALIVE_PERIOD_SEC
 10

	)

178 
	#SLSI_P2PGC_CONN_TIMEOUT_MSEC
 10000

	)

180 #ià!
defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

181 
	#SLSI_UNPAUSE_ARP_Q_TIMEOUT_MSEC
 10000

	)

185 
	#SLSI_FW_MAX_OFFCHANNEL_DWELL_TIME
 100

	)

188 
	#SLSI_P2P_PA_GO_NEG_REQ
 0

	)

189 
	#SLSI_P2P_PA_GO_NEG_RSP
 1

	)

190 
	#SLSI_P2P_PA_GO_NEG_CFM
 2

	)

191 
	#SLSI_P2P_PA_INV_REQ
 3

	)

192 
	#SLSI_P2P_PA_INV_RSP
 4

	)

193 
	#SLSI_P2P_PA_DEV_DISC_REQ
 5

	)

194 
	#SLSI_P2P_PA_DEV_DISC_RSP
 6

	)

195 
	#SLSI_P2P_PA_PROV_DISC_REQ
 7

	)

196 
	#SLSI_P2P_PA_PROV_DISC_RSP
 8

	)

198 
	#SLSI_PA_INVALID
 0xFF

	)

201 
	#SLSI_PA_GAS_INITIAL_REQ
 (10)

	)

202 
	#SLSI_PA_GAS_INITIAL_RSP
 (11)

	)

203 
	#SLSI_PA_GAS_COMEBACK_REQ
 (12)

	)

204 
	#SLSI_PA_GAS_COMEBACK_RSP
 (13)

	)

207 
	#SLSI_PA_DPP_AUTHENTICATION_REQ
 (0)

	)

208 
	#SLSI_PA_DPP_AUTHENTICATION_RESP
 (1)

	)

209 
	#SLSI_PA_DPP_AUTHENTICATION_CONF
 (2)

	)

212 
	#SLSI_RM_RADIO_MEASUREMENT_REQ
 (0)

	)

213 
	#SLSI_RM_RADIO_MEASUREMENT_REP
 (1)

	)

214 
	#SLSI_RM_LINK_MEASUREMENT_REQ
 (2)

	)

215 
	#SLSI_RM_LINK_MEASUREMENT_REP
 (3)

	)

216 
	#SLSI_RM_NEIGH_REP_REQ
 (4)

	)

217 
	#SLSI_RM_NEIGH_REP_RSP
 (5)

	)

219 
	#SLSI_WNM_ACTION_FIELD_MIN
 (0)

	)

220 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

221 
	#SLSI_WNM_BSS_TM_REQ_PREF_CAND_LIST_INCLUDED
 
	`BIT
(0)

	)

222 
	#SLSI_WNM_BSS_TM_REQ_BSS_TERMINATION_INCLUDED
 
	`BIT
(3)

	)

223 
	#SLSI_WNM_BSS_TM_REQ_ESS_DISASSOC_IMMINENT
 
	`BIT
(4)

	)

225 
	#SLSI_WNM_ACTION_FIELD_MAX
 (27)

	)

228 
	#SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
 0x80

	)

229 
	#SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 (
SLSI_PA_GAS_INITIAL_REQ
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

230 
	#SLSI_PA_GAS_INITIAL_RSP_SUBTYPE
 (
SLSI_PA_GAS_INITIAL_RSP
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

231 
	#SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
 (
SLSI_PA_GAS_COMEBACK_REQ
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

232 
	#SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
 (
SLSI_PA_GAS_COMEBACK_RSP
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

235 
	#SLSI_PA_DPP_DUMMY_SUBTYPE_MASK
 0xC0

	)

236 
	#SLSI_PA_DPP_AUTHENTICATION_REQ_SUBTYPE
 (
SLSI_PA_DPP_AUTHENTICATION_REQ
 | 
SLSI_PA_DPP_DUMMY_SUBTYPE_MASK
)

	)

237 
	#SLSI_PA_DPP_AUTHENTICATION_RESP_SUBTYPE
 (
SLSI_PA_DPP_AUTHENTICATION_RESP
 | 
SLSI_PA_DPP_DUMMY_SUBTYPE_MASK
)

	)

238 
	#SLSI_PA_DPP_AUTHENTICATION_CONF_SUBTYPE
 (
SLSI_PA_DPP_AUTHENTICATION_CONF
 | 
SLSI_PA_DPP_DUMMY_SUBTYPE_MASK
)

	)

240 
	#SLSI_P2P_STATUS_ATTR_ID
 0

	)

241 
	#SLSI_P2P_STATUS_CODE_SUCCESS
 0

	)

243 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

244 
	#SLSI_MBO_ASSOC_DISALLOWED_ATTR_ID
 0x04

	)

245 
	#SLSI_MBO_ASSOC_RETRY_DELAY_ATTR_ID
 0x08

	)

248 
	#SLSI_ROAMING_CHANNEL_CACHE_TIMEOUT
 (5 * 60)

	)

250 
	#SET_ETHERTYPE_PATTERN_DESC
(
pd
, 
‘h”ty³
) \

251 
pd
.
off£t
 = 0x0C; \

252 
pd
.
mask_Ëngth
 = 2; \

253 
pd
.
mask
[0] = 0xff; \

254 
pd
.
mask
[1] = 0xff; \

255 
pd
.
·‰”n
[0] = 
‘h”ty³
 >> 8; \

256 
pd
.
·‰”n
[1] = 
‘h”ty³
 & 0xFF

	)

259 
	#SLSI_IP_TYPE_UDP
 0x11

	)

260 
	#SLSI_IP_TYPE_OFFSET
 23

	)

261 
	#SLSI_IP_SOURCE_PORT_OFFSET
 34

	)

262 
	#SLSI_IP_DEST_PORT_OFFSET
 36

	)

263 
	#SLSI_DHCP_SERVER_PORT
 67

	)

264 
	#SLSI_DHCP_CLIENT_PORT
 68

	)

265 
	#SLSI_DNS_DEST_PORT
 53

	)

266 
	#SLSI_MDNS_DEST_PORT
 5353

	)

268 
	#SLSI_DHCP_MSG_MAGIC_OFFSET
 278

	)

269 
	#SLSI_DHCP_OPTION
 53

	)

270 
	#SLSI_DHCP_MESSAGE_TYPE_DISCOVER
 0x01

	)

271 
	#SLSI_DHCP_MESSAGE_TYPE_OFFER
 0x02

	)

272 
	#SLSI_DHCP_MESSAGE_TYPE_REQUEST
 0x03

	)

273 
	#SLSI_DHCP_MESSAGE_TYPE_DECLINE
 0x04

	)

274 
	#SLSI_DHCP_MESSAGE_TYPE_ACK
 0x05

	)

275 
	#SLSI_DHCP_MESSAGE_TYPE_NAK
 0x06

	)

276 
	#SLSI_DHCP_MESSAGE_TYPE_RELEASE
 0x07

	)

277 
	#SLSI_DHCP_MESSAGE_TYPE_INFORM
 0x08

	)

278 
	#SLSI_DHCP_MESSAGE_TYPE_FORCERENEW
 0x09

	)

279 
	#SLSI_DHCP_MESSAGE_TYPE_INVALID
 0x0A

	)

281 
	#SLSI_ARP_SRC_IP_ADDR_OFFSET
 14

	)

282 
	#SLSI_ARP_DEST_IP_ADDR_OFFSET
 24

	)

283 
	#SLSI_IS_GRATUITOUS_ARP
(
äame
è(!
	`memcmp
(&äame[
SLSI_ARP_SRC_IP_ADDR_OFFSET
],\

284 &
äame
[
SLSI_ARP_DEST_IP_ADDR_OFFSET
], 4))

	)

285 
	#SLSI_ARP_REPLY_OPCODE
 2

	)

286 
	#SLSI_ARP_REQUEST_OPCODE
 1

	)

287 
	#SLSI_ARP_OPCODE_OFFSET
 6

	)

289 
	#SLSI_ICMP6_PACKET
 58

	)

290 
	#SLSI_ICMP6_PACKET_TYPE_RA
 134

	)

291 
	#SLSI_ICMP6_PACKET_TYPE_NS
 135

	)

292 
	#SLSI_ICMP6_PACKET_TYPE_NA
 136

	)

294 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(4, 4, 0))

295 
	#WLAN_CATEGORY_WNM
 10

	)

298 #ifdeà
SCSC_SEP_VERSION


299 
	#SLSI_CONNECT_NO_NETWORK_FOUND
 0x0401

	)

300 
	#SLSI_CONNECT_AUTH_NO_ACK
 0x0402

	)

301 
	#SLSI_CONNECT_AUTH_NO_RESP
 0x0403

	)

302 
	#SLSI_CONNECT_AUTH_TX_FAIL
 0x0404

	)

303 
	#SLSI_CONNECT_AUTH_SAE_NO_ACK
 0x0405

	)

304 
	#SLSI_CONNECT_AUTH_SAE_NO_RESP
 0x0406

	)

305 
	#SLSI_CONNECT_AUTH_SAE_TX_FAIL
 0x0407

	)

306 
	#SLSI_CONNECT_ASSOC_NO_ACK
 0x0408

	)

307 
	#SLSI_CONNECT_ASSOC_NO_RESP
 0x0409

	)

308 
	#SLSI_CONNECT_ASSOC_TX_FAIL
 0x040a

	)

311 
	#SLSI_RECOVERY_SERVICE_STARTED
 0

	)

312 
	#SLSI_RECOVERY_SERVICE_STOPPED
 1

	)

313 
	#SLSI_RECOVERY_SERVICE_CLOSED
 2

	)

314 
	#SLSI_RECOVERY_SERVICE_OPENED
 3

	)

315 
	#SLSI_DEFAULT_HW_MAC_ADDR
 "\x00\x00\x0F\x11\x22\x33"

	)

317 
	#SLSI_MGMT_FRAME_SUBTYPE_ASSOC_REQ
 0

	)

318 
	#SLSI_MGMT_FRAME_SUBTYPE_ASSOC_RESP
 1

	)

319 
	#SLSI_MGMT_FRAME_SUBTYPE_REASSOC_REQ
 2

	)

320 
	#SLSI_MGMT_FRAME_SUBTYPE_REASSOC_RESP
 3

	)

322 
	e¦si_dhı_tx
 {

323 
	mSLSI_TX_IS_NOT_DHCP
,

324 
	mSLSI_TX_IS_DHCP_SERVER
,

325 
	mSLSI_TX_IS_DHCP_CLIENT


328 
	e¦si_fw_»guÏtÜy_ruË_æags
 {

329 
	mSLSI_REGULATORY_NO_IR
 = 1 << 0,

330 
	mSLSI_REGULATORY_DFS
 = 1 << 1,

331 
	mSLSI_REGULATORY_NO_OFDM
 = 1 << 2,

332 
	mSLSI_REGULATORY_NO_INDOOR
 = 1 << 3,

333 
	mSLSI_REGULATORY_NO_OUTDOOR
 = 1 << 4

336 
	e¦si_¡a_cÚn_¡©e
 {

337 
	mSLSI_STA_CONN_STATE_DISCONNECTED
 = 0,

338 
	mSLSI_STA_CONN_STATE_CONNECTING
 = 1,

339 
	mSLSI_STA_CONN_STATE_DOING_KEY_CONFIG
 = 2,

340 
	mSLSI_STA_CONN_STATE_CONNECTED
 = 3

343 
	e¦si_wÏn_v’dÜ_©Œ_rş_chªÃl_li¡
 {

344 
	mSLSI_WLAN_VENDOR_ATTR_SSID
 = 1,

345 
	mSLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_COUNT
,

346 
	mSLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_LIST
,

347 
	mSLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_LIST_EVENT_MAX


350 
šlše
 
	$com·»_‘h”_addr
(cÚ¡ 
u8
 *
addr1
, cÚ¡ u8 *
addr2
)

352  !
	`‘h”_addr_equ®
(
addr1
, 
addr2
);

353 
	}
}

355 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


356 
	g¦si_5ghz_®l_chªs
[] = {36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124,

373 
šlše
 
¦si_³”
 *
	$¦si_g‘_³”_äom_mac
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
mac
)

375 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

377 ()
sdev
;

385 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

386 ià(
ndev_vif
->
¡a
.
tdls_’abËd
) {

387 
i
;

389 
i
 = 1; i < 
SLSI_TDLS_PEER_INDEX_MAX
; i++)

390 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
 &&

391 
	`com·»_‘h”_addr
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
mac
) == 0)

392  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

394 ià(
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
] &&‚dev_vif->³”_¡a_»cÜd[SLSI_STA_PEER_QUEUESET]->
v®id
)

395  
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

396 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

397 
i
 = 0;

399 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++)

400 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
 &&

401 
	`com·»_‘h”_addr
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
mac
) == 0)

402  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

403 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


404 } ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

405 
i
 = 0;

407 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++) {

408 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
 &&

409 
	`com·»_‘h”_addr
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
mac
) == 0)

410  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

413 ià(
	`is_muÉiÿ¡_‘h”_addr
(
mac
)) {

414 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++)

415 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
) {

416 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "muÉiÿ¡/brßdÿ¡…ack‘ oÀNAN‚‘ià(de¡:%pM, chªgtØ³”: %pM)\n", 
mac
, 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
);

417  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

424  
NULL
;

425 
	}
}

427 
šlše
 
¦si_³”
 *
	$¦si_g‘_³”_äom_qs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
queue£t
)

429 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

431 ()
sdev
;

433 ià(!
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
] || !ndev_vif->³”_¡a_»cÜd[queue£t]->
v®id
)

434  
NULL
;

436  
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
];

437 
	}
}

439 
šlše
 
boŞ
 
	$¦si_is_tdls_³”
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

441 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

443  (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
è&& (
³”
->
aid
 >ğ
SLSI_TDLS_PEER_INDEX_MIN
);

444 
	}
}

446 
šlše
 
boŞ
 
	$¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
sk_buff
 *
assoc_»¥_›
)

448 cÚ¡ 
u8
 *
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
assoc_»¥_›
->
d©a
,‡ssoc_»¥_›->
Ën
);

450 ià((
›
) && (ie[1] > 1))

451  
›
[3] & 0x10;

454 
	}
}

456 
šlše
 
	$¦si_ÿche_›s
(cÚ¡ 
u8
 *
¤c_›
, 
size_t
 
¤c_›_Ën
, u8 **
de¡_›
, size_ˆ*
de¡_›_Ën
)

458 *
de¡_›
 = 
	`km®loc
(
¤c_›_Ën
, 
GFP_KERNEL
);

459 ià(*
de¡_›
 =ğ
NULL
)

460  -
ENOMEM
;

462 
	`memıy
(*
de¡_›
, 
¤c_›
, 
¤c_›_Ën
);

463 *
de¡_›_Ën
 = 
¤c_›_Ën
;

466 
	}
}

468 
šlše
 
	$¦si_ş—r_ÿched_›s
(
u8
 **
›
, 
size_t
 *
›_Ën
)

470 ià(*
›_Ën
 != 0)

471 
	`kä“
(*
›
);

472 *
›
 = 
NULL
;

473 *
›_Ën
 = 0;

474 
	}
}

477 
šlše
 *
	$¦si_·_subty³_‹xt
(
subty³
)

479 
subty³
) {

480 
SLSI_P2P_PA_GO_NEG_REQ
:

482 
SLSI_P2P_PA_GO_NEG_RSP
:

484 
SLSI_P2P_PA_GO_NEG_CFM
:

486 
SLSI_P2P_PA_INV_REQ
:

488 
SLSI_P2P_PA_INV_RSP
:

490 
SLSI_P2P_PA_DEV_DISC_REQ
:

492 
SLSI_P2P_PA_DEV_DISC_RSP
:

494 
SLSI_P2P_PA_PROV_DISC_REQ
:

496 
SLSI_P2P_PA_PROV_DISC_RSP
:

498 
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
:

500 
SLSI_PA_GAS_INITIAL_RSP_SUBTYPE
:

502 
SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
:

504 
SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
:

506 
SLSI_PA_INVALID
:

511 
	}
}

514 
šlše
 
	$¦si_assign_cook›_id
(
u64
 *
cook›
, u64 *
couÁ”
)

516 (*
cook›
èğ++(*
couÁ”
);

517 ià((*
cook›
) == 0)

518 (*
cook›
èğ++(*
couÁ”
);

519 
	}
}

522 
šlše
 
	$¦si_unsync_vif_£t_´obe_r¥_›
(
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
›s
, 
size_t
 
›s_Ën
)

524 ià(
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
)

525 
	`kä“
(
ndev_vif
->
unsync
.
´obe_r¥_›s
);

526 
ndev_vif
->
unsync
.
´obe_r¥_›s
 = 
›s
;

527 
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
 = 
›s_Ën
;

528 
	}
}

531 
šlše
 
	$¦si_£t_mgmt_tx_d©a
(
Ãtdev_vif
 *
ndev_vif
, 
u64
 
cook›
, 
u16
 
ho¡_g
, cÚ¡ 
u8
 *
buf
, 
size_t
 
buf_Ën
)

533 
u8
 *
tx_äame
 = 
NULL
;

535 ià(
buf_Ën
 != 0) {

536 
tx_äame
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

537 ià(!
tx_äame
) {

538 
	`SLSI_NET_ERR
(
ndev_vif
->
wdev
.
Ãtdev
, "FAILEDo‡llocate memory for Tx frame\n");

539  -
ENOMEM
;

541 
	`SLSI_NET_DBG3
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Copy buffer forx_status\n");

542 
	`memıy
(
tx_äame
, 
buf
, 
buf_Ën
);

543 } ià(
ndev_vif
->
mgmt_tx_d©a
.
buf
) {

544 
	`SLSI_NET_DBG3
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Free buffer ofx_status\n");

545 
	`kä“
(
ndev_vif
->
mgmt_tx_d©a
.
buf
);

548 
ndev_vif
->
mgmt_tx_d©a
.
cook›
 = cookie;

549 
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
 = host_tag;

550 
ndev_vif
->
mgmt_tx_d©a
.
buf
 = 
tx_äame
;

551 
ndev_vif
->
mgmt_tx_d©a
.
buf_Ën
 = buf_len;

554 
	}
}

559 
šlše
 
	$¦si_p2p_queue_unsync_vif_d–_wÜk
(
Ãtdev_vif
 *
ndev_vif
, 
d–ay
)

561 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

562 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
unsync
.
d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
d–ay
));

563 
	}
}

566 
	#SLSI_P2P_STATE_CHANGE
(
sdev
, 
Ãxt_¡©e
) \

568 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "P2P s‹ chªge: % -> %s\n", 
	`¦si_p2p_¡©e_‹xt
(sdev->
p2p_¡©e
), slsi_p2p_¡©e_‹xt(
Ãxt_¡©e
)); \

569 
sdev
->
p2p_¡©e
 = 
Ãxt_¡©e
; \

570 } 0)

	)

572 
¦si_purge_sÿn_»suÉs
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
);

573 
¦si_purge_sÿn_»suÉs_locked
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
);

574 
sk_buff
 *
¦si_dequeue_ÿched_sÿn_»suÉ
(
¦si_sÿn
 *
sÿn
, *
couÁ
);

575 
¦si_g‘_hw_mac_add»ss
(
¦si_dev
 *
sdev
, 
u8
 *
addr
);

576 
¦si_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

577 
¦si_¡¬t_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

578 
¦si_¡İ_Ãt_dev
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

579 
¦si_¡İ
(
¦si_dev
 *
sdev
);

580 
¦si_¡İ_locked
(
¦si_dev
 *
sdev
);

581 
¦si_³”
 *
¦si_³”_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
aid
);

582 
¦si_³”_upd©e_assoc_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
);

583 
¦si_³”_upd©e_assoc_r¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
);

584 
¦si_³”_»£t_¡©s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

585 
¦si_³”_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

586 
¦si_ps_pÜt_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
¦si_¡a_cÚn_¡©e
 
s
);

587 
¦si_d–_¡©iÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

588 
¡©iÚ_d–_·¿m‘”s
 *
d–_·¿ms
);

589 
¦si_¡a_›“80211_mode
(
Ãt_deviû
 *
dev
, 
u16
 
cu¼’t_bss_chªÃl_äequ’cy
);

590 
¦si_vif_aùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

591 
¦si_vif_d—ùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

592 
¦si_hªdË_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
»asÚ
,

593 
u8
 *
di§ssoc_r¥_›
, 
u32
 
di§ssoc_r¥_›_Ën
);

594 
¦si_bªd_upd©e
(
¦si_dev
 *
sdev
, 
bªd
);

595 
¦si_bªd_cfg_upd©e
(
¦si_dev
 *
sdev
, 
bªd
);

596 
¦si__add»ss_chªged
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
add»ss
);

597 
¦si_£nd_g¿tu™ous_¬p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

598 
›“80211_chªÃl
 *
¦si_fšd_sÿn_chªÃl
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
size_t
 
mgmt_Ën
, 
u16
 
äeq
);

599 
¦si_auto_chª_£Ëù_sÿn
(
¦si_dev
 *
sdev
, 
chª_couÁ
, 
›“80211_chªÃl
 *
chªÃls
[]);

600 
¦si_£t_ušt_mib
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u16
 
psid
, 
v®ue
);

601 
¦si_upd©e_»gd_ruËs
(
¦si_dev
 *
sdev
, 
boŞ
 
couÁry_check
);

602 
¦si_£t_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

603 
¦si_p2p_š™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
);

604 
¦si_p2p_deš™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
);

605 
¦si_p2p_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, 
boŞ
 
£t_´obe_r¥_›s
);

606 
¦si_p2p_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
);

607 
¦si_p2p_group_¡¬t_»move_unsync_vif
(
¦si_dev
 *
sdev
);

608 
¦si_p2p_dev_´obe_r¥_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
´obe_r¥_›
, 
size_t
 
´obe_r¥_›_Ën
);

609 
¦si_p2p_dev_nuÎ_›s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

610 
¦si_g‘_public_aùiÚ_subty³
(cÚ¡ 
›“80211_mgmt
 *
mgmt
);

611 
¦si_p2p_g‘_go_Ãg_r¥_¡©us
(
Ãt_deviû
 *
dev
, cÚ¡ 
›“80211_mgmt
 *
mgmt
);

612 
u8
 
¦si_g‘_exp_³”_äame_subty³
(u8 
subty³
);

613 
¦si_£nd_txq_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
ndev
);

614 
¦si_abÜt_¡a_sÿn
(
¦si_dev
 *
sdev
);

615 
¦si_is_dhı_·ck‘
(
u8
 *
d©a
);

616 
¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

617 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

618 
¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
);

619 
boŞ
 
¦si_£Ëù_­_fÜ_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 **
bssid
,

620 
›“80211_chªÃl
 **
chªÃl
, 
boŞ
 
»Œy
);

622 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


623 
¦si_is_dns_·ck‘
(
u8
 *
d©a
);

624 
¦si_is_mdns_·ck‘
(
u8
 *
d©a
);

625 
¦si_is_tı_sync_·ck‘
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

628 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


629 
¦si_£t_’hªûd_pkt_f‹r
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

631 
¦si_£t_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

632 
¦si_upd©e_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

633 
¦si_ş—r_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

634 
¦si_­_´•¬e_add_šfo_›s
(
Ãtdev_vif
 *
ndev_vif
, cÚ¡ 
u8
 *
›s
, 
size_t
 
›s_Ën
);

635 
¦si_£t_mib_rßm
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u16
 
psid
, 
v®ue
);

636 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


637 
¦si_£t_mib_´eã¼ed_ª‹Âa
(
¦si_dev
 *
dev
, 
u16
 
v®ue
);

639 
¦si_»£t_throughput_¡©s
(
Ãt_deviû
 *
dev
);

640 
¦si_£t_mib_rssi_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
šdex
, 
boo¡
);

641 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


642 
¦si_£t_mib_soá_rßmšg_’abËd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
’abË
);

644 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


645 
¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
);

646 
¦si_fl_’hªûd_¬p_out_of_Üd”_drİ_couÁ”
(
Ãtdev_vif
 *
ndev_vif
,

647 
sk_buff
 *
skb
);

649 
¦si_modify_›s_Ú_chªÃl_sw™ch
(
Ãt_deviû
 *
dev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
,

650 
u8
 *
ds_·¿ms_›
, u8 *
ht_İ”©iÚ_›
, 
›“80211_mgmt
 *
mgmt
,

651 
u16
 
b—cÚ_›_h—d_Ën
);

652 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


653 
¦si_exŒaù_v®id_wifi_sh¬šg_chªÃls
(
¦si_dev
 *
sdev
);

654 
boŞ
 
¦si_if_v®id_wifi_sh¬šg_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
);

655 
¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
);

656 
¦si_g‘_mhs_ws_chª_vsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

657 
cfg80211_­_£‰šgs
 *
£‰šgs
,

658 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
);

659 
¦si_g‘_mhs_ws_chª_rsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

660 
cfg80211_­_£‰šgs
 *
£‰šgs
,

661 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
);

662 
¦si_£t_wifish¬šg_³rm™‹d_chªÃls
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
);

663 
¦si_check_if_chªÃl_»¡riùed_®»ady
(
¦si_dev
 *
sdev
, 
chªÃl
);

665 
Ãt_deviû
 *
¦si_dyÇmic_š‹rçû_ü—‹
(
why
 *wiphy,

666 cÚ¡ *
Çme
,

667 
Æ80211_iáy³
 
ty³
,

668 
vif_·¿ms
 *
·¿ms
);

669 
¦si_¡İ_ch
(
¦si_dev
 *
sdev
);

670 
¦si_g‘_b—cÚ_cu
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
mib_v®ue
);

671 
¦si_g‘_mib_rßm
(
¦si_dev
 *
sdev
, 
u16
 
psid
, *
mib_v®ue
);

672 
¦si_rßm_chªÃl_ÿche_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

673 
¦si_rßm_chªÃl_ÿche_´uÃ
(
Ãt_deviû
 *
dev
, 
£cÚds
, *
ssid
);

674 
¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, u8 *
chªÃls
);

675 
¦si_£nd_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 
msdu_liãtime
);

676 
¦si_»ad_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 *
msdu_liãtime
);

677 
¦si_»ad_unifi_couÁryli¡
(
¦si_dev
 *
sdev
, 
u16
 
psid
);

678 
¦si_»ad_deçuÉ_couÁry
(
¦si_dev
 *
sdev
, 
u8
 *
®pha2
, 
u16
 
šdex
);

679 
¦si_»ad_discÚÃù_šd_timeout
(
¦si_dev
 *
sdev
, 
u16
 
psid
);

680 
¦si_»ad_»guÏtÜy_ruËs
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
);

681 
¦si_»ad_»guÏtÜy_ruËs_fw
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
);

682 
¦si_£nd_acs_ev’t
(
¦si_dev
 *
sdev
, 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
);

683 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
¦si_rßm_chªÃl_ÿche_g‘
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
);

684 
¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
Ãt_deviû
 *
dev
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
, 
u8
 *
chªÃls
);

685 
¦si_£nd_rş_ev’t
(
¦si_dev
 *
sdev
, 
u32
 
chªÃl_couÁ
, 
u16
 *
chªÃl_li¡
, 
u8
 *
ssid
, u8 
ssid_Ën
);

686 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


687 
¦si_£t_mac_¿ndomi§tiÚ_mask
(
¦si_dev
 *
sdev
, 
u8
 *
mac_add»ss_mask
);

689 
¦si_£t_couÁry_upd©e_»gd
(
¦si_dev
 *
sdev
, cÚ¡ *
®pha2_code
, 
size
);

690 
¦si_ş—r_offchªÃl_d©a
(
¦si_dev
 *
sdev
, 
boŞ
 
acquœe_lock
);

691 
¦si_wÏn_unsync_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

692 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
);

693 
¦si_wÏn_unsync_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
devboŞ
, 
boŞ
 
hw_avaabË
);

694 
¦si_hs2_unsync_vif_d–‘e_wÜk
(
wÜk_¡ruù
 *
wÜk
);

695 
boŞ
 
¦si_is_bssid_š_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
);

697 
¦si_is_wes_aùiÚ_äame
(cÚ¡ 
›“80211_mgmt
 *
mgmt
);

698 
¦si_sÿn_šd_timeout_hªdË
(
wÜk_¡ruù
 *
wÜk
);

699 
¦si_bÏckli¡_d–_wÜk_hªdË
(
wÜk_¡ruù
 *
wÜk
);

700 
¦si_vif_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
, boŞ 
is_»cov”y
);

701 
¦si_sÿn_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

702 
¦si_dump_¡©s
(
Ãt_deviû
 *
dev
);

703 
¦si_£nd_hªged_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
u16
 
scsc_·nic_code
);

704 
¦si_£t_ext_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
›s
, 
›_Ën
, cÚ¡ u8 *
ext_ÿp_mask
);

705 
¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
¦si_dev
 *
sdev
);

706 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


707 
¦si_‹¡_£nd_hªged_v’dÜ_ev’t
(
Ãt_deviû
 *
dev
);

709 
¦si_£nd_pow”_m—su»m’t_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
s16
 
pow”_š_db
);

710 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

711 
¦si_£nd_fÜw¬d_b—cÚ_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

712 cÚ¡ 
u8
 *
ssid
, cÚ¡ 
ssid_Ën
, cÚ¡ u8 *
bssid
, u8 
chªÃl
,

713 cÚ¡ 
u16
 
b—cÚ_št
, cÚ¡ 
u64
 
time¡amp
, cÚ¡ u64 
sys_time
);

714 
¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
»asÚ_code
);

716 
¦si_wÏn_dump_public_aùiÚ_subty³
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
boŞ
 
tx
);

717 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

718 
u8
 
¦si_bss_cÚÃù_ty³_g‘
(
¦si_dev
 *
sdev
, cÚ¡ u8 *
›
, 
size_t
 
›_Ën
);

720 
¦si_»£t_chªÃl_æags
(
¦si_dev
 *
sdev
);

721 
¦si_m”ge_li¡s
(
u8
 
¬1
[], 
Ën1
, u8 
¬2
[], 
Ën2
, u8 
»suÉ
[]);

722 
¦si_»move_du¶iÿ‹s
(
u8
 
¬r
[], 
n
);

723 
¦si_sÜt_¬¿y
(
u8
 
¬r
[], 
n
);

724 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


725 
¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
Ãt_deviû
 *
dev
, 
mode
);

728 
¦si_ü—‹_sysfs_maÿddr
();

729 
¦si_de¡roy_sysfs_maÿddr
();

731 
¦si_ü—‹_sysfs_v”siÚ_šfo
();

732 
¦si_de¡roy_sysfs_v”siÚ_šfo
();

733 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

734 
¦si_ü—‹_sysfs_debug_dump
();

735 
¦si_de¡roy_sysfs_debug_dump
();

736 
¦si_cŞËù_ch£t_logs
(
wÜk_¡ruù
 *
wÜk
);

738 
¦si_ü—‹_sysfs_pm
();

739 
¦si_de¡roy_sysfs_pm
();

740 
¦si_ü—‹_sysfs_ªt
();

741 
¦si_de¡roy_sysfs_ªt
();

742 
¦si_fšd_chª_idx
(
u16
 
chª
, 
u8
 
hw_mode
);

743 
¦si_£t_Ï‹ncy_mode
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
, 
cmd_Ën
);

744 
¦si_Œigg”_£rviû_çu»
(
wÜk_¡ruù
 *
wÜk
);

745 
¦si_çu»_»£t
(
wÜk_¡ruù
 *
wÜk
);

746 
¦si_¡¬t_­
(
why
 *why, 
Ãt_deviû
 *
dev
,

747 
cfg80211_­_£‰šgs
 *
£‰šgs
);

748 
¦si_subsy¡em_»£t
(
wÜk_¡ruù
 *
wÜk
);

749 
¦si_ch_»cov”y
(
wÜk_¡ruù
 *
wÜk
);

750 
¦si_sy¡em_”rÜ_»cov”y
(
wÜk_¡ruù
 *
wÜk
);

751 
¦si_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

752 
¦si_purge_bÏckli¡
(
Ãtdev_vif
 *
ndev_vif
);

753 
¦si_rx_upd©e_wake_¡©s
(
¦si_dev
 *
sdev
, 
‘hhdr
 *
ehdr
, 
buff_Ën
);

754 
¦si_£t_Ï‹ncy_üt_d©a
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
);

755 
boŞ
 
¦si_is_bssid_š_h®_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
);

756 
boŞ
 
¦si_is_bssid_š_ioùl_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
);

757 
¦si_»move_bssid_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
);

758 
¦si_add_ioùl_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
);

759 
u8
 *
¦si_g‘_sÿn_exŒa_›s
(
¦si_dev
 *
sdev
, cÚ¡ u8 *
›s
,

760 
tÙ®_Ën
, *
exŒa_Ën
);

761 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


762 
¦si_£t_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

763 
¦si_’abË_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

765 #ià!
defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

766 
¦si_¬p_q_¡uck_wÜk_hªdË
(
wÜk_¡ruù
 *
wÜk
);

768 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

769 
¦si_»Œy_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

770 
¦si_ä“_cÚÃùiÚ_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

772 
¦si_add_´obe_›s_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

773 
¦si_dump_‘h_·ck‘
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

	@mib.c

8 
	~"cÚ¡.h
"

9 
	~"mib.h
"

10 
	~"debug.h
"

12 
	#SLSI_MIB_MORE_MASK
 0x80

	)

13 
	#SLSI_MIB_SIGN_MASK
 0x40

	)

14 
	#SLSI_MIB_TYPE_MASK
 0x20

	)

15 
	#SLSI_MIB_LENGTH_MASK
 0x1FU

	)

21 
	$¦si_mib_buf_­³nd
(
¦si_mib_d©a
 *
d¡
, 
size_t
 
bufãr_Ëngth
, 
u8
 *
bufãr
)

23 
u8
 *
Ãw_bufãr
 = 
	`km®loc
(
d¡
->
d©aL’gth
 + 
bufãr_Ëngth
, 
GFP_KERNEL
);

25 ià(!
Ãw_bufãr
) {

26 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", ()(
d¡
->
d©aL’gth
 + 
bufãr_Ëngth
));

30 
	`memıy
(
Ãw_bufãr
, 
d¡
->
d©a
, d¡->
d©aL’gth
);

31 
	`memıy
(&
Ãw_bufãr
[
d¡
->
d©aL’gth
], 
bufãr
, 
bufãr_Ëngth
);

33 
d¡
->
d©aL’gth
 +ğ(
u16
)
bufãr_Ëngth
;

34 
	`kä“
(
d¡
->
d©a
);

35 
d¡
->
d©a
 = 
Ãw_bufãr
;

36 
	}
}

38 
size_t
 
	$¦si_mib_’code_ušt32
(
u8
 *
bufãr
, 
u32
 
v®ue
)

40 
u8
 
i
;

41 
u8
 
wr™e_couÁ
 = 0;

43 ià(
v®ue
 < 64) {

44 
bufãr
[0] = (
u8
)
v®ue
;

54 
i
 = 0; i < 4; i++) {

55 
u8
 
by‹_v®ue
 = (
v®ue
 & 0xFF000000) >> 24;

57 ià(
by‹_v®ue
 || 
wr™e_couÁ
) {

58 
bufãr
[1 + 
wr™e_couÁ
] = 
by‹_v®ue
;

59 
wr™e_couÁ
++;

61 
v®ue
 = value << 8;

65 
bufãr
[0] = 
wr™e_couÁ
 | 
SLSI_MIB_MORE_MASK
;

67  1 + 
wr™e_couÁ
;

68 
	}
}

70 
size_t
 
	$¦si_mib_’code_št32
(
u8
 *
bufãr
, 
s32
 
sigÃd_v®ue
)

72 
u8
 
i
;

73 
u8
 
wr™e_couÁ
 = 0;

74 
u32
 
v®ue
 = (u32)
sigÃd_v®ue
;

76 ià(!(
v®ue
 & 0x10000000))

78  
	`¦si_mib_’code_ušt32
(
bufãr
, 
v®ue
);

80 ià(
sigÃd_v®ue
 >= -64) {

81 
bufãr
[0] = (
u8
)
v®ue
 & 0x7F;

86 
i
 = 0; i < 4; i++) {

87 
u8
 
by‹_v®ue
 = (
v®ue
 & 0xFF000000) >> 24;

89 ià(!((
by‹_v®ue
 =ğ0xFFè&& (
v®ue
 & 0x800000)è|| 
wr™e_couÁ
) {

90 
bufãr
[1 + 
wr™e_couÁ
] = 
by‹_v®ue
;

91 
wr™e_couÁ
++;

93 
v®ue
 = value << 8;

96 
bufãr
[0] = 
wr™e_couÁ
 | 
SLSI_MIB_MORE_MASK
 | 
SLSI_MIB_SIGN_MASK
;

98  1 + 
wr™e_couÁ
;

99 
	}
}

101 
size_t
 
	$¦si_mib_’code_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘_v®ue
)

103 
u8
 
i
;

104 
u8
 
wr™e_couÁ
 = 0;

105 
size_t
 
Ëngth
 = 
où‘_v®ue
->
d©aL’gth
;

106 
size_t
 
»t_Ëngth
 = 0;

114 
i
 = 0; i < 3; i++) {

115 
u8
 
by‹_v®ue
 = (
Ëngth
 & 0xFF000000) >> 24;

117 ià(
by‹_v®ue
 || 
wr™e_couÁ
) {

118 
bufãr
[1 + 
wr™e_couÁ
] = 
by‹_v®ue
;

119 
wr™e_couÁ
++;

121 
Ëngth
 =†ength << 8;

124 
bufãr
[0] = (1 + 
wr™e_couÁ
è| 
SLSI_MIB_MORE_MASK
 | 
SLSI_MIB_TYPE_MASK
;

125 
bufãr
[1 + 
wr™e_couÁ
] = 
où‘_v®ue
->
d©aL’gth
 & 0xFF;

126 
	`memıy
(&
bufãr
[2 + 
wr™e_couÁ
], 
où‘_v®ue
->
d©a
, où‘_v®ue->
d©aL’gth
);

128 
»t_Ëngth
 = (
size_t
)(2U + 
wr™e_couÁ
 + 
où‘_v®ue
->
d©aL’gth
);

129  
»t_Ëngth
;

130 
	}
}

132 
size_t
 
	$¦si_mib_decode_ušt32
(
u8
 *
bufãr
, 
u32
 *
v®ue
)

134 
size_t
 
i
;

135 
u32
 
v
 = 0;

136 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

138 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

139 *
v®ue
 = 
bufãr
[0] & 0x7F;

143 
i
 = 0; i < 
Ëngth
; i++) {

144 
v
 = (v << 8);

145 
v
 |ğ
bufãr
[1 + 
i
];

148 *
v®ue
 = 
v
;

150  1 + 
Ëngth
;

151 
	}
}

153 
size_t
 
	$¦si_mib_decodeUšt64
(
u8
 *
bufãr
, 
u64
 *
v®ue
)

155 
size_t
 
i
;

156 
u64
 
v
 = 0;

157 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

159 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

160 *
v®ue
 = 
bufãr
[0] & 0x7F;

164 
i
 = 0; i < 
Ëngth
; i++) {

165 
v
 = (v << 8);

166 
v
 |ğ
bufãr
[1 + 
i
];

169 *
v®ue
 = 
v
;

171  1 + 
Ëngth
;

172 
	}
}

174 
size_t
 
	$¦si_mib_decodeIÁ32
(
u8
 *
bufãr
, 
s32
 *
v®ue
)

176 
size_t
 
i
;

177 
u32
 
v
 = 0xFFFFFFFF;

178 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

180 ià(!(
bufãr
[0] & 
SLSI_MIB_SIGN_MASK
))

182  
	`¦si_mib_decode_ušt32
(
bufãr
, (
u32
 *)
v®ue
);

184 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

185 *
v®ue
 = (
s32
)(0xFFFFFF80 | 
bufãr
[0]);

189 
i
 = 0; i < 
Ëngth
; i++) {

190 
v
 = (v << 8);

191 
v
 |ğ
bufãr
[1 + 
i
];

194 *
v®ue
 = (
s32
)
v
;

196  1 + 
Ëngth
;

197 
	}
}

199 
size_t
 
	$¦si_mib_decodeIÁ64
(
u8
 *
bufãr
, 
s64
 *
v®ue
)

201 
size_t
 
i
;

202 
u64
 
v
 = 0xFFFFFFFFFFFFFFFFULL;

203 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

205 ià(!(
bufãr
[0] & 
SLSI_MIB_SIGN_MASK
))

207  
	`¦si_mib_decodeUšt64
(
bufãr
, (
u64
 *)
v®ue
);

209 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

210 *
v®ue
 = (
s64
)(0xFFFFFFFFFFFFFF80ULL | 
bufãr
[0]);

214 
i
 = 0; i < 
Ëngth
; i++) {

215 
v
 = (v << 8);

216 
v
 |ğ
bufãr
[1 + 
i
];

219 *
v®ue
 = (
s64
)
v
;

221  1 + 
Ëngth
;

222 
	}
}

225 
size_t
 
	$¦si_mib_decode_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘_v®ue
)

227 
size_t
 
i
;

228 
u32
 
oid_Ëngth_v®ue
 = 0;

229 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

231 
i
 = 0; i < 
Ëngth
; i++) {

232 
oid_Ëngth_v®ue
 = (oid_length_value << 8);

233 
oid_Ëngth_v®ue
 |ğ
bufãr
[1 + 
i
];

236 
où‘_v®ue
->
d©aL’gth
 = 
oid_Ëngth_v®ue
;

237 
où‘_v®ue
->
d©a
 = 
NULL
;

238 ià(
oid_Ëngth_v®ue
)

239 
où‘_v®ue
->
d©a
 = &
bufãr
[1 + 
Ëngth
];

241  1 + 
Ëngth
 + 
oid_Ëngth_v®ue
;

242 
	}
}

244 
u8
 
	$¦si_mib_decode_ty³_Ëngth
(
u8
 *
bufãr
, 
size_t
 *
Ëngth
)

246 *
Ëngth
 = 1;

247 ià(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)

248 *
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

250 ià(
bufãr
[0] & 
SLSI_MIB_SIGN_MASK
)

251  
SLSI_MIB_TYPE_INT
;

253 ià((
bufãr
[0] & 
SLSI_MIB_MORE_MASK
) &&

254 (
bufãr
[0] & 
SLSI_MIB_TYPE_MASK
)) {

255 
size_t
 
i
;

256 
size_t
 
oid_Ëngth_v®ue
 = 0;

258 
i
 = 0; i < *
Ëngth
; i++) {

259 
oid_Ëngth_v®ue
 = (oid_length_value << 8);

260 
oid_Ëngth_v®ue
 |ğ
bufãr
[1 + 
i
];

262 *
Ëngth
 +ğ
oid_Ëngth_v®ue
;

263  
SLSI_MIB_TYPE_OCTET
;

265  
SLSI_MIB_TYPE_UINT
;

266 
	}
}

268 
size_t
 
	$¦si_mib_’code_psid_šdexs
(
u8
 *
bufãr
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
v®ue
)

270 
size_t
 
i
;

271 
šdex
 = 0;

273 
	`SLSI_U16_TO_BUFF_LE
(
v®ue
->
psid
, &
bufãr
[0]);

274 
bufãr
[2] = 0;

275 
bufãr
[3] = 0;

276 
i
 = 0; i < 
SLSI_MIB_MAX_INDEXES
 && 
v®ue
->
šdex
[i] != 0; i++) {

278 
šdex
 = 4 + 
bufãr
[2];

279 ià(
šdex
 < 13)

280 
bufãr
[2] +ğ(
u8
)
	`¦si_mib_’code_ušt32
(&bufãr[
šdex
], 
v®ue
->šdex[
i
]);

283 ià(
bufãr
[2] % 2 == 1) {

289 
šdex
 = 4 + 
bufãr
[2];

291 ià(
šdex
 < 13) {

292 
bufãr
[
šdex
] = 0x00;

293  5 + 
bufãr
[2];

297  4 + 
bufãr
[2];

298 
	}
}

300 
u16
 
	$¦si_mib_’code
(
¦si_mib_d©a
 *
bufãr
, 
¦si_mib_’Œy
 *
v®ue
)

302 
size_t
 
i
;

303 
size_t
 
»quœed_size
 = (size_t)(5U + (5U * 
SLSI_MIB_MAX_INDEXES
) +

304 (
v®ue
->v®ue.
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 ? v®ue->v®ue.
u
.
où‘V®ue
.
d©aL’gth
 : 5U));

305 
size_t
 
’coded_Ëngth
 = 4;

307 
u8
 *
tmp_bufãr
 = 
	`km®loc
(
»quœed_size
, 
GFP_KERNEL
);

309 ià(!
tmp_bufãr
) {

310 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", ()
»quœed_size
);

311  
SLSI_MIB_STATUS_FAILURE
;

314 
	`SLSI_U16_TO_BUFF_LE
(
v®ue
->
psid
, &
tmp_bufãr
[0]);

315 
tmp_bufãr
[2] = 0;

316 
tmp_bufãr
[3] = 0;

317 
i
 = 0; i < 
SLSI_MIB_MAX_INDEXES
 && 
v®ue
->
šdex
[i] != 0; i++)

318 
tmp_bufãr
[2] +ğ(
u8
)
	`¦si_mib_’code_ušt32
(&tmp_bufãr[4 +mp_bufãr[2]], 
v®ue
->
šdex
[
i
]);

319 
’coded_Ëngth
 +ğ
tmp_bufãr
[2];

321 
v®ue
->v®ue.
ty³
) {

322 
SLSI_MIB_TYPE_UINT
:

323 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_ušt32
(&
tmp_bufãr
[’coded_Ëngth], 
v®ue
->v®ue.
u
.
uštV®ue
);

325 
SLSI_MIB_TYPE_INT
:

326 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_št32
(&
tmp_bufãr
[’coded_Ëngth], 
v®ue
->v®ue.
u
.
štV®ue
);

328 
SLSI_MIB_TYPE_OCTET
:

329 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_où‘_¡r
(&
tmp_bufãr
[’coded_Ëngth], &
v®ue
->v®ue.
u
.
où‘V®ue
);

331 
SLSI_MIB_TYPE_BOOL
:

332 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_ušt32
(&
tmp_bufãr
[’coded_Ëngth], 
v®ue
->v®ue.
u
.
boŞV®ue
 ? 
Œue
 : 
çl£
);

334 
SLSI_MIB_TYPE_NONE
:

337 
	`SLSI_WARN_NODEV
("Inv®id Ty³:%d„eque¡ed\n", 
v®ue
->v®ue.
ty³
);

338 
	`kä“
(
tmp_bufãr
);

339  
SLSI_MIB_STATUS_FAILURE
;

342 
	`SLSI_U16_TO_BUFF_LE
(
’coded_Ëngth
 - 4, &
tmp_bufãr
[2]);

344 ià(
’coded_Ëngth
 % 2 == 1) {

350 
tmp_bufãr
[
’coded_Ëngth
] = 0x00;

351 
’coded_Ëngth
++;

354 
	`¦si_mib_buf_­³nd
(
bufãr
, 
’coded_Ëngth
, 
tmp_bufãr
);

355 
	`kä“
(
tmp_bufãr
);

357  
SLSI_MIB_STATUS_SUCCESS
;

358 
	}
}

360 
size_t
 
	$¦si_mib_decode
(
¦si_mib_d©a
 *
d©a
, 
¦si_mib_’Œy
 *
v®ue
)

362 
u8
 *
bufãr
 = 
d©a
->data;

363 
u32
 
bufãr_Ëngth
 = 
d©a
->
d©aL’gth
;

364 
size_t
 
šdex_couÁ
 = 0;

365 
u32
 
Ëngth
;

366 
size_t
 
decoded_Ëngth
 = 4;

368 
	`mem£t
(
v®ue
, 0x00, (
¦si_mib_’Œy
));

370 ià(
bufãr_Ëngth
 < 4) {

371 
	`SLSI_WARN_NODEV
("Mib DecodL’gth:%d Mu¡ bg»©”hª 4\n", 
bufãr_Ëngth
);

375 ià(!
bufãr
)

378 
Ëngth
 = 
	`SLSI_BUFF_LE_TO_U16
(&
bufãr
[2]);

380 ià(
bufãr_Ëngth
 < 
decoded_Ëngth
 + 
Ëngth
) {

381 
	`SLSI_ERR_NODEV
("Mib Bufã¸L’gth:%d Mu¡ b>ğthª decoded†’gth:%d\n", 
bufãr_Ëngth
, ()(
decoded_Ëngth
 + 
Ëngth
));

385 
v®ue
->
psid
 = 
	`SLSI_BUFF_LE_TO_U16
(
bufãr
);

386 
v®ue
->v®ue.
ty³
 = 
SLSI_MIB_TYPE_NONE
;

388 
decoded_Ëngth
 < 4 + 
Ëngth
) {

389 
size_t
 
Ãxt_v®ue_Ëngth
;

390 
u8
 
ty³
 = 
	`¦si_mib_decode_ty³_Ëngth
(&
bufãr
[
decoded_Ëngth
], &
Ãxt_v®ue_Ëngth
);

392 ià(
bufãr_Ëngth
 < 
decoded_Ëngth
 + 
Ãxt_v®ue_Ëngth
) {

393 
	`SLSI_ERR_NODEV
("Mib Bufã¸L’gth:%d Mu¡ b>ğthª decoded†’gth:%d\n", 
bufãr_Ëngth
, ()(
decoded_Ëngth
 + 
Ãxt_v®ue_Ëngth
));

394 
	`mem£t
(
v®ue
, 0x00, (
¦si_mib_’Œy
));

398 
ty³
) {

399 
SLSI_MIB_TYPE_UINT
:

401 
u32
 
v
;

403 
decoded_Ëngth
 +ğ
	`¦si_mib_decode_ušt32
(&
bufãr
[decoded_Ëngth], &
v
);

407 ià((
decoded_Ëngth
 < 4 + 
Ëngth
) &&

408 (
šdex_couÁ
 !ğ
SLSI_MIB_MAX_INDEXES
)) {

409 
v®ue
->
šdex
[
šdex_couÁ
] = (
u16
)
v
;

410 
šdex_couÁ
++;

412 
v®ue
->v®ue.
ty³
 =ype;

413 
v®ue
->v®ue.
u
.
uštV®ue
 = 
v
;

414 ià(
decoded_Ëngth
 !ğ4 + 
Ëngth
)

415 
	`SLSI_WARN_NODEV
("UšˆDecodËngth:%d !ğex³ùed:%d\n", (
u32
)
decoded_Ëngth
, (u32)(4 + 
Ëngth
));

419 
SLSI_MIB_TYPE_INT
:

420 
v®ue
->v®ue.
ty³
 =ype;

421 
decoded_Ëngth
 +ğ
	`¦si_mib_decodeIÁ32
(&
bufãr
[decoded_Ëngth], &
v®ue
->v®ue.
u
.
štV®ue
);

422 ià(
decoded_Ëngth
 !ğ4 + 
Ëngth
)

423 
	`SLSI_WARN_NODEV
("IÁ DecodËngth:%d !ğex³ùed:%d\n", (
u32
)
decoded_Ëngth
, (u32)(4 + 
Ëngth
));

425 
SLSI_MIB_TYPE_OCTET
:

426 
v®ue
->v®ue.
ty³
 =ype;

427 
decoded_Ëngth
 +ğ
	`¦si_mib_decode_où‘_¡r
(&
bufãr
[decoded_Ëngth], &
v®ue
->v®ue.
u
.
où‘V®ue
);

428 ià(
decoded_Ëngth
 !ğ4 + 
Ëngth
)

429 
	`SLSI_WARN_NODEV
("Où‘ DecodËngth:%d !ğex³ùed:%d\n", (
u32
)
decoded_Ëngth
, (u32)(4 + 
Ëngth
));

432 
	`SLSI_ERR_NODEV
("Inv®id MIB d©¨ty³(%d). PossibË mbulk cÜru±iÚ\n", 
ty³
);

433 
	`mem£t
(
v®ue
, 0x00, (
¦si_mib_’Œy
));

434 
v®ue
->v®ue.
ty³
 = 
SLSI_MIB_TYPE_NONE
;

438 ià(
Ëngth
 % 2 == 1) {

444 ià(
bufãr
[
decoded_Ëngth
] != 0x00)

445 
	`SLSI_WARN_NODEV
("psid:0x%.4X Paddšg NÙ D‘eùed\n", 
v®ue
->
psid
);

446 
Ëngth
++;

448  4 + 
Ëngth
;

449 
	}
}

451 
	$¦si_mib_’code_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psids_Ëngth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
)

453 
size_t
 
i
;

455 
bufãr
->
d©aL’gth
 = 0;

457 
bufãr
->
d©a
 = 
	`km®loc
((
u32
)(
psids_Ëngth
 * 13), 
GFP_KERNEL
);

458 ià(!
bufãr
->
d©a
) {

459 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", 
psids_Ëngth
 * 13);

460  
SLSI_MIB_STATUS_OUT_OF_MEMORY
;

462 
i
 = 0; i < 
psids_Ëngth
; i++)

463 
bufãr
->
d©aL’gth
 +ğ(
u16
)
	`¦si_mib_’code_psid_šdexs
(&bufãr->
d©a
[bufãr->d©aL’gth], &
psids
[
i
]);

465  
SLSI_MIB_STATUS_SUCCESS
;

466 
	}
}

468 
	$¦si_mib_’code_g‘
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, u16 
idx
)

471 
size_t
 
size
;

472 
u8
 
tmp_bufãr
[13];

473 
¦si_mib_g‘_’Œy
 
’Œy
;

475 
	`mem£t
(&
’Œy
, 0x00, (
¦si_mib_g‘_’Œy
));

476 
’Œy
.
psid
 =…sid;

477 
’Œy
.
šdex
[0] = 
idx
;

478 
size
 = 
	`¦si_mib_’code_psid_šdexs
(
tmp_bufãr
, &
’Œy
);

479 
	`¦si_mib_buf_­³nd
(
bufãr
, 
size
, 
tmp_bufãr
);

480 
	}
}

482 
u8
 *
	$¦si_mib_fšd
(
¦si_mib_d©a
 *
bufãr
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
’Œy
)

484 
size_t
 
bufãr_Ëngth
 = 
bufãr
->
d©aL’gth
;

485 
u8
 *
buff
 = 
bufãr
->
d©a
;

487 ià(
bufãr_Ëngth
 % 2 == 1) {

488 
	`SLSI_WARN_NODEV
("bufãr_Ëngth(%dè%% 2 !ğ0 (Inv®id Mib d©¨D‘eùed)\n", ()
bufãr_Ëngth
);

489  
NULL
;

491 
bufãr_Ëngth
 >= 4) {

492 
u16
 
psid
 = 
	`SLSI_BUFF_LE_TO_U16
(
buff
);

493 
size_t
 
Ëngth
 = 4U + 
	`SLSI_BUFF_LE_TO_U16
(&
buff
[2]);

495 ià(
’Œy
->
psid
 ==…sid) {

496 
size_t
 
i
;

497 
u32
 
idx
;

498 
size_t
 
by‹s_»ad
 = 0;

500 
i
 = 0; i < 
SLSI_MIB_MAX_INDEXES
; i++) {

501 ià(!
’Œy
->
šdex
[
i
])

502  
buff
;

503 
by‹s_»ad
 = 
	`¦si_mib_decode_ušt32
(&
buff
[4 + by‹s_»ad], &
idx
);

504 ià(
’Œy
->
šdex
[
i
] !ğ
idx
)

507 ià(
i
 =ğ
SLSI_MIB_MAX_INDEXES
)

508  
buff
;

510 ià(
Ëngth
 % 2 == 1)

516 
Ëngth
++;

518 
buff
 +ğ
Ëngth
;

519 
bufãr_Ëngth
 -ğ
Ëngth
;

522  
NULL
;

523 
	}
}

525 
¦si_mib_v®ue
 *
	$¦si_mib_decode_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psids_Ëngth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
)

527 
¦si_mib_v®ue
 *
»suÉs
 = 
	`km®loc_¬¿y
((
size_t
)
psids_Ëngth
, (¦si_mib_v®ue), 
GFP_KERNEL
);

528 
size_t
 
i
, 
mib_decode_Ën
 = 0;

529 
Ën
 = 0;

530 
psids_nÙ_found
[150] = "";

532 ià(!
»suÉs
) {

533 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", ()((
¦si_mib_v®ue
è* 
psids_Ëngth
));

534  
»suÉs
;

537 
i
 = 0; i < 
psids_Ëngth
; i++) {

538 
¦si_mib_’Œy
 
v®ue
;

539 
¦si_mib_d©a
 
d©a
;

541 
d©a
.d©¨ğ
	`¦si_mib_fšd
(
bufãr
, &
psids
[
i
]);

542 ià(
d©a
.data) {

543 
d©a
.
d©aL’gth
 = 
bufãr
->dataLength - (data.data - buffer->data);

544 
v®ue
.
psid
 = 
psids
[
i
].psid;

545 
	`memıy
(
v®ue
.
šdex
, 
psids
[
i
].index, (value.index));

546 
mib_decode_Ën
 = 
	`¦si_mib_decode
(&
d©a
, &
v®ue
);

547 ià(
mib_decode_Ën
 == 0)

548 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "Mib decod”rÜ fÜ…sid %d\n", 
v®ue
.
psid
);

550 
»suÉs
[
i
] = 
v®ue
.value;

552 
Ën
 +ğ
	`¢´štf
(&
psids_nÙ_found
[0] +†’, 150 -†’, "%d ", 
psids
[
i
].
psid
);

553 
»suÉs
[
i
].
ty³
 = 
SLSI_MIB_TYPE_NONE
;

557 ià(
Ën
)

558 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "Could‚Ù fšd…sid's: %s\n", 
psids_nÙ_found
);

560  
»suÉs
;

561 
	}
}

563 
u16
 
	$¦si_mib_’code_boŞ
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
boŞ
 
v®ue
, u16 
idx
)

565 
¦si_mib_’Œy
 
v
;

567 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

568 
v
.
psid
 =…sid;

569 
v
.
šdex
[0] = 
idx
;

570 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_BOOL
;

571 
v
.
v®ue
.
u
.
boŞV®ue
 = value;

572  
	`¦si_mib_’code
(
bufãr
, &
v
);

573 
	}
}

575 
u16
 
	$¦si_mib_’code_št
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
s32
 
v®ue
, u16 
idx
)

577 
¦si_mib_’Œy
 
v
;

579 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

580 
v
.
psid
 =…sid;

581 
v
.
šdex
[0] = 
idx
;

582 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_INT
;

583 
v
.
v®ue
.
u
.
štV®ue
 = value;

584  
	`¦si_mib_’code
(
bufãr
, &
v
);

585 
	}
}

587 
u16
 
	$¦si_mib_’code_ušt
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
u32
 
v®ue
, u16 
idx
)

589 
¦si_mib_’Œy
 
v
;

591 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

592 
v
.
psid
 =…sid;

593 
v
.
šdex
[0] = 
idx
;

594 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_UINT
;

595 
v
.
v®ue
.
u
.
uštV®ue
 = value;

596  
	`¦si_mib_’code
(
bufãr
, &
v
);

597 
	}
}

599 
u16
 
	$¦si_mib_’code_où‘
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
size_t
 
d©aL’gth
, cÚ¡ 
u8
 *
d©a
, u16 
idx
)

601 
¦si_mib_’Œy
 
v
;

603 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

604 
v
.
psid
 =…sid;

605 
v
.
šdex
[0] = 
idx
;

606 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_OCTET
;

607 
v
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
 = (
u32
)dataLength;

608 
v
.
v®ue
.
u
.
où‘V®ue
.
d©a
 = (
u8
 *)data;

609  
	`¦si_mib_’code
(
bufãr
, &
v
);

610 
	}
}

	@mib.h

9 #iâdeà
SLSI_MIB_H__


10 
	#SLSI_MIB_H__


	)

12 #ifdeà
__ılu¥lus


16 
	s¦si_mib_d©a
 {

17 
u32
 
d©aL’gth
;

18 
u8
 *
d©a
;

21 
	#SLSI_MIB_MAX_INDEXES
 2U

	)

23 
	#SLSI_MIB_TYPE_BOOL
 0

	)

24 
	#SLSI_MIB_TYPE_UINT
 1

	)

25 
	#SLSI_MIB_TYPE_INT
 2

	)

26 
	#SLSI_MIB_TYPE_OCTET
 3U

	)

27 
	#SLSI_MIB_TYPE_NONE
 4

	)

29 
	s¦si_mib_v®ue
 {

30 
u8
 
ty³
;

32 
boŞ
 
boŞV®ue
;

33 
s32
 
štV®ue
;

34 
u32
 
uštV®ue
;

35 
¦si_mib_d©a
 
où‘V®ue
;

36 } 
u
;

39 
	s¦si_mib_’Œy
 {

40 
u16
 
psid
;

41 
u16
 
šdex
[
SLSI_MIB_MAX_INDEXES
];

42 
¦si_mib_v®ue
 
v®ue
;

45 
	s¦si_mib_g‘_’Œy
 {

46 
u16
 
psid
;

47 
u16
 
šdex
[
SLSI_MIB_MAX_INDEXES
];

50 
	#SLSI_MIB_STATUS_SUCCESS
 0x0000

	)

51 
	#SLSI_MIB_STATUS_UNKNOWN_PSID
 0x0001

	)

52 
	#SLSI_MIB_STATUS_INVALID_INDEX
 0x0002

	)

53 
	#SLSI_MIB_STATUS_OUT_OF_RANGE
 0x0003

	)

54 
	#SLSI_MIB_STATUS_WRITE_ONLY
 0x0004

	)

55 
	#SLSI_MIB_STATUS_READ_ONLY
 0x0005

	)

56 
	#SLSI_MIB_STATUS_UNKNOWN_INTERFACE_TAG
 0x0006

	)

57 
	#SLSI_MIB_STATUS_INVALID_NUMBER_OF_INDICES
 0x0007

	)

58 
	#SLSI_MIB_STATUS_ERROR
 0x0008

	)

59 
	#SLSI_MIB_STATUS_UNSUPPORTED_ON_INTERFACE
 0x0009

	)

60 
	#SLSI_MIB_STATUS_UNAVAILABLE
 0x000A

	)

61 
	#SLSI_MIB_STATUS_NOT_FOUND
 0x000B

	)

62 
	#SLSI_MIB_STATUS_INCOMPATIBLE
 0x000C

	)

63 
	#SLSI_MIB_STATUS_OUT_OF_MEMORY
 0x000D

	)

64 
	#SLSI_MIB_STATUS_TO_MANY_REQUESTED_VARIABLES
 0x000E

	)

65 
	#SLSI_MIB_STATUS_NOT_TRIED
 0x000F

	)

66 
	#SLSI_MIB_STATUS_FAILURE
 0xFFFF

	)

100 
¦si_mib_’code_g‘
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, u16 
šdex
);

101 
¦si_mib_’code_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psidsL’gth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
);

146 
size_t
 
¦si_mib_decode
(
¦si_mib_d©a
 *
bufãr
, 
¦si_mib_’Œy
 *
v®ue
);

147 
¦si_mib_v®ue
 *
¦si_mib_decode_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psidsL’gth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
);

185 
u16
 
¦si_mib_’code
(
¦si_mib_d©a
 *
bufãr
, 
¦si_mib_’Œy
 *
v®ue
);

186 
u16
 
¦si_mib_’code_boŞ
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
boŞ
 
v®ue
, u16 
šdex
);

187 
u16
 
¦si_mib_’code_št
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
s32
 
v®ue
, u16 
šdex
);

188 
u16
 
¦si_mib_’code_ušt
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
u32
 
v®ue
, u16 
šdex
);

189 
u16
 
¦si_mib_’code_où‘
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
size_t
 
d©aL’gth
, cÚ¡ 
u8
 *
d©a
, u16 
šdex
);

197 
size_t
 
¦si_mib_’code_ušt32
(
u8
 *
bufãr
, 
u32
 
v®ue
);

198 
size_t
 
¦si_mib_’code_št32
(
u8
 *
bufãr
, 
s32
 
sigÃdV®ue
);

199 
size_t
 
¦si_mib_’code_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘V®ue
);

201 
size_t
 
¦si_mib_decodeUšt32
(
u8
 *
bufãr
, 
u32
 *
v®ue
);

202 
size_t
 
¦si_mib_decodeIÁ32
(
u8
 *
bufãr
, 
s32
 *
v®ue
);

203 
size_t
 
¦si_mib_decodeUšt64
(
u8
 *
bufãr
, 
u64
 *
v®ue
);

204 
size_t
 
¦si_mib_decodeIÁ64
(
u8
 *
bufãr
, 
s64
 *
v®ue
);

205 
size_t
 
¦si_mib_decode_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘V®ue
);

222 
u8
 *
¦si_mib_fšd
(
¦si_mib_d©a
 *
bufãr
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
’Œy
);

225 
¦si_mib_buf_­³nd
(
¦si_mib_d©a
 *
d¡
, 
size_t
 
bufãrL’gth
, 
u8
 *
bufãr
);

246 
	#SLSI_PSID_DOT11_TDLS_PEER_UAPSD_INDICATION_WINDOW
 0x0035

	)

260 
	#SLSI_PSID_DOT11_ASSOCIATION_SA_QUERY_MAXIMUM_TIMEOUT
 0x0064

	)

273 
	#SLSI_PSID_DOT11_ASSOCIATION_SA_QUERY_RETRY_TIMEOUT
 0x0065

	)

287 
	#SLSI_PSID_DOT11_MIN_POWER_CAPABILITY_OVERRIDE
 0x0071

	)

301 
	#SLSI_PSID_DOT11_MAX_NETWORK_POWER_CAPABILITY_OVERRIDE
 0x0072

	)

325 
	#SLSI_PSID_DOT11_RTS_THRESHOLD
 0x0079

	)

340 
	#SLSI_PSID_DOT11_SHORT_RETRY_LIMIT
 0x007A

	)

355 
	#SLSI_PSID_DOT11_LONG_RETRY_LIMIT
 0x007B

	)

379 
	#SLSI_PSID_DOT11_FRAGMENTATION_THRESHOLD
 0x007C

	)

396 
	#SLSI_PSID_DOT11_TXOP_DURATION_RTS_THRESHOLD
 0x007D

	)

410 
	#SLSI_PSID_DOT11_RTS_SUCCESS_COUNT
 0x0092

	)

423 
	#SLSI_PSID_DOT11_ACK_FAILURE_COUNT
 0x0094

	)

437 
	#SLSI_PSID_DOT11_MULTICAST_RECEIVED_FRAME_COUNT
 0x0096

	)

451 
	#SLSI_PSID_DOT11_FCS_ERROR_COUNT
 0x0097

	)

465 
	#SLSI_PSID_DOT11_MANUFACTURER_PRODUCT_VERSION
 0x00B7

	)

478 
	#SLSI_PSID_UNIFI_MLME_CONNECTION_TIMEOUT
 0x07D0

	)

491 
	#SLSI_PSID_UNIFI_MLME_SCAN_CHANNEL_MAX_SCAN_TIME
 0x07D1

	)

504 
	#SLSI_PSID_UNIFI_MLME_SCAN_CHANNEL_PROBE_INTERVAL
 0x07D2

	)

517 
	#SLSI_PSID_UNIFI_MLME_SCAN_CHANNEL_RULE
 0x07D3

	)

532 
	#SLSI_PSID_UNIFI_MLME_DATA_REFERENCE_TIMEOUT
 0x07D5

	)

545 
	#SLSI_PSID_UNIFI_MLME_SCAN_PROBE_INTERVAL
 0x07D7

	)

558 
	#SLSI_PSID_UNIFI_MLME_SCAN_HIGH_RSSI_THRESHOLD
 0x07D8

	)

572 
	#SLSI_PSID_UNIFI_MLME_SCAN_DELTA_RSSI_THRESHOLD
 0x07DA

	)

585 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAXIMUM_AGE
 0x07DE

	)

600 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAXIMUM_RESULTS
 0x07DF

	)

613 
	#SLSI_PSID_UNIFI_MLME_AUTONOMOUS_SCAN_NOISY
 0x07E0

	)

627 
	#SLSI_PSID_UNIFI_CHANNEL_BUSY_THRESHOLD
 0x07E2

	)

642 
	#SLSI_PSID_UNIFI_MAC_SEQUENCE_NUMBER_RANDOMISATION_ACTIVATED
 0x07E4

	)

657 
	#SLSI_PSID_UNIFI_FIRMWARE_BUILD_ID
 0x07E5

	)

673 
	#SLSI_PSID_UNIFI_CHIP_VERSION
 0x07E6

	)

690 
	#SLSI_PSID_UNIFI_FIRMWARE_PATCH_BUILD_ID
 0x07E7

	)

705 
	#SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES_SOFT_AP
 0x07E8

	)

722 
	#SLSI_PSID_UNIFI_MAX_NUM_ANTENNA_TO_USE
 0x07E9

	)

735 
	#SLSI_PSID_UNIFI_HT_CAPABILITIES5G
 0x07EA

	)

748 
	#SLSI_PSID_UNIFI_VHT_CAPABILITIES5G
 0x07EB

	)

764 
	#SLSI_PSID_UNIFI_HT_CAPABILITIES_SOFT_AP
 0x07EC

	)

777 
	#SLSI_PSID_UNIFI_SOFT_AP40_MHZ_ON24G
 0x07ED

	)

791 
	#SLSI_PSID_UNIFI_BASIC_CAPABILITIES
 0x07EE

	)

806 
	#SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES
 0x07EF

	)

821 
	#SLSI_PSID_UNIFI_HT_CAPABILITIES
 0x07F0

	)

834 
	#SLSI_PSID_UNIFI_RSN_CAPABILITIES
 0x07F2

	)

849 
	#SLSI_PSID_UNIFI24_G40_MHZ_CHANNELS
 0x07F3

	)

864 
	#SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES_DISABLED
 0x07F4

	)

881 
	#SLSI_PSID_UNIFI_SUPPORTED_DATA_RATES
 0x07F9

	)

894 
	#SLSI_PSID_UNIFI_RADIO_MEASUREMENT_ACTIVATED
 0x07FB

	)

908 
	#SLSI_PSID_UNIFI_RADIO_MEASUREMENT_CAPABILITIES
 0x07FC

	)

921 
	#SLSI_PSID_UNIFI_VHT_ACTIVATED
 0x07FD

	)

934 
	#SLSI_PSID_UNIFI_HT_ACTIVATED
 0x07FE

	)

948 
	#SLSI_PSID_UNIFI_ENABLE_TWO_SIMULTANEOUS_PASSIVE_SCANS_SAME_BAND
 0x07FF

	)

961 
	#SLSI_PSID_UNIFI_PL_M689_WORKAROUND_TRIGGER_ARP_COUNT
 0x0800

	)

974 
	#SLSI_PSID_UNIFI_ROAMING_ACTIVATED
 0x0801

	)

988 
	#SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER
 0x0802

	)

1003 
	#SLSI_PSID_UNIFI_ROAM_CU_SCAN_TRIGGER_HYSTERESIS
 0x0803

	)

1017 
	#SLSI_PSID_UNIFI_ROAM_BACKGROUND_SCAN_PERIOD
 0x0804

	)

1032 
	#SLSI_PSID_UNIFI_ROAM_NCHO_FULL_SCAN_PERIOD
 0x0805

	)

1045 
	#SLSI_PSID_UNIFI_ROAM_SOFT_ROAMING_ENABLED
 0x0806

	)

1059 
	#SLSI_PSID_UNIFI_ROAM_SCAN_BAND
 0x0807

	)

1075 
	#SLSI_PSID_UNIFI_ROAM_CU_RSSI_SCAN_TRIGGER_HYSTERESIS
 0x0808

	)

1089 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_MAX_ACTIVE_CHANNEL_TIME
 0x0809

	)

1103 
	#SLSI_PSID_UNIFI_ROAM_RE_SCAN_PERIOD
 0x080A

	)

1117 
	#SLSI_PSID_UNIFI_ROAM_INACTIVE_SCAN_PERIOD
 0x080B

	)

1132 
	#SLSI_PSID_UNIFI_ROAM_MODE
 0x080C

	)

1148 
	#SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER_RESET
 0x080D

	)

1163 
	#SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER_STEP
 0x080E

	)

1178 
	#SLSI_PSID_UNIFI_ROAM_IDLE_VARIATION_RSSI
 0x080F

	)

1193 
	#SLSI_PSID_UNIFI_ROAM_IDLE_MIN_RSSI
 0x0810

	)

1207 
	#SLSI_PSID_UNIFI_ROAM_EAP_TIMEOUT
 0x0811

	)

1222 
	#SLSI_PSID_UNIFI_ROAM_IDLE_INACTIVE_TIME
 0x0812

	)

1236 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
 0x0813

	)

1250 
	#SLSI_PSID_UNIFI_ROAM_NCHO_DFS_SCAN_MODE
 0x0814

	)

1264 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_TIME
 0x0815

	)

1278 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_AWAY_TIME
 0x0816

	)

1292 
	#SLSI_PSID_UNIFI_ROAM_IDLE_INACTIVE_COUNT
 0x0817

	)

1305 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_NPROBE
 0x0818

	)

1319 
	#SLSI_PSID_UNIFI_ROAM_IDLE_BAND
 0x0819

	)

1334 
	#SLSI_PSID_UNIFI_ROAM_IDLE_AP_SELECT_DELTA_FACTOR
 0x081A

	)

1349 
	#SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_DELTA
 0x081B

	)

1364 
	#SLSI_PSID_UNIFI_AP_OLBC_DURATION
 0x081C

	)

1380 
	#SLSI_PSID_UNIFI_AP_OLBC_INTERVAL
 0x081D

	)

1393 
	#SLSI_PSID_UNIFI_DNS_SUPPORT_ACTIVATED
 0x081E

	)

1407 
	#SLSI_PSID_UNIFI_OFFCHANNEL_PROCEDURE_TIMEOUT
 0x081F

	)

1421 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_TIMEOUT
 0x0820

	)

1434 
	#SLSI_PSID_UNIFI_CONNECTION_FAILURE_TIMEOUT
 0x0821

	)

1448 
	#SLSI_PSID_UNIFI_CONNECTING_PROBE_TIMEOUT
 0x0822

	)

1466 
	#SLSI_PSID_UNIFI_DISCONNECT_TIMEOUT
 0x0823

	)

1479 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_CFM_TX_LIFETIME_TIMEOUT
 0x0824

	)

1493 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_CFM_FAILURE_TIMEOUT
 0x0825

	)

1507 
	#SLSI_PSID_UNIFI_FORCE_ACTIVE_DURATION
 0x0826

	)

1520 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAX_NUMBER_OF_PROBE_SETS
 0x0827

	)

1534 
	#SLSI_PSID_UNIFI_MLME_SCAN_STOP_IF_LESS_THAN_XFRAMES
 0x0828

	)

1548 
	#SLSI_PSID_UNIFI_AP_ASSOCIATION_TIMEOUT
 0x0829

	)

1561 
	#SLSI_PSID_UNIFI_ROAMING_IN_P2P_ACTIVATED
 0x082A

	)

1574 
	#SLSI_PSID_UNIFI_HOST_NUM_ANTENNA_CONTROL_ACTIVATED
 0x082B

	)

1589 
	#SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER
 0x082C

	)

1604 
	#SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER_HYSTERESIS
 0x082D

	)

1617 
	#SLSI_PSID_UNIFI_PEER_BANDWIDTH
 0x082E

	)

1631 
	#SLSI_PSID_UNIFI_CURRENT_PEER_NSS
 0x082F

	)

1644 
	#SLSI_PSID_UNIFI_PEER_TX_DATA_RATE
 0x0830

	)

1657 
	#SLSI_PSID_UNIFI_PEER_RSSI
 0x0831

	)

1674 
	#SLSI_PSID_UNIFI_MLME_STATION_INACTIVITY_TIMEOUT
 0x0832

	)

1690 
	#SLSI_PSID_UNIFI_MLME_CLI_INACTIVITY_TIMEOUT
 0x0833

	)

1705 
	#SLSI_PSID_UNIFI_MLME_STATION_INITIAL_KICK_TIMEOUT
 0x0834

	)

1719 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_LONG_TIMEOUT
 0x0835

	)

1733 
	#SLSI_PSID_UNIFI_INITIAL_CONNECTION_FAILURE_TIMEOUT
 0x0836

	)

1747 
	#SLSI_PSID_UNIF_RETRY_AUTH_FOR_SPECIAL_APS
 0x0837

	)

1760 
	#SLSI_PSID_UNIFI_ASSOC_COMEBACK_TIMEOUT
 0x0838

	)

1777 
	#SLSI_PSID_UNIFI_MLME_INACTIVITY_NEW_ALGORITHM_ACTIVATED
 0x0839

	)

1791 
	#SLSI_PSID_UNIFI_UART_CONFIGURE
 0x083E

	)

1808 
	#SLSI_PSID_UNIFI_UART_PIOS
 0x083F

	)

1826 
	#SLSI_PSID_UNIFI_CRYSTAL_FREQUENCY_TRIM
 0x085D

	)

1843 
	#SLSI_PSID_UNIFI_ENABLE_DORM
 0x085E

	)

1863 
	#SLSI_PSID_UNIFI_EXTERNAL_CLOCK_DETECT
 0x0862

	)

1884 
	#SLSI_PSID_UNIFI_EXTERNAL_FAST_CLOCK_REQUEST
 0x0865

	)

1900 
	#SLSI_PSID_UNIFI_WATCHDOG_TIMEOUT
 0x0868

	)

1926 
	#SLSI_PSID_UNIFI_SCAN_PARAMETERS_PUBLIC
 0x0869

	)

1941 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM_ACTIVATED
 0x086B

	)

1957 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM
 0x086C

	)

1979 
	#SLSI_PSID_UNIFI_SCAN_PARAMETERS_PRIVATE
 0x086D

	)

1996 
	#SLSI_PSID_UNIFI_EXTERNAL_FAST_CLOCK_REQUEST_PIO
 0x086E

	)

2010 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_ENABLED
 0x0870

	)

2027 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_OFFSET
 0x0874

	)

2043 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_CAP
 0x0875

	)

2060 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_OFFSET5G
 0x0879

	)

2076 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_CAP5G
 0x087A

	)

2093 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_OPTION
 0x087B

	)

2108 
	#SLSI_PSID_UNIFI_RSSI_THRESHOLD_FOR_BBB_SYNC
 0x087C

	)

2125 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_OFFSET6G
 0x087D

	)

2141 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_CAP6G
 0x087E

	)

2154 
	#SLSI_PSID_UNIFI_DYNAMIC_ITO_ENABLE
 0x087F

	)

2173 
	#SLSI_PSID_UNIFI_RSSI_TYPE_TO_USE
 0x0891

	)

2187 
	#SLSI_PSID_UNIFI_NUM_RSSI_AVERAGE_SAMPLE
 0x0892

	)

2200 
	#SLSI_PSID_UNIFI_RX_DATA_RATE
 0x0894

	)

2213 
	#SLSI_PSID_UNIFI_PEER_RX_RETRY_COUNT
 0x0896

	)

2226 
	#SLSI_PSID_UNIFI_PEER_RX_MULTICAST_COUNT
 0x0897

	)

2247 
	#SLSI_PSID_UNIFI_RSSI
 0x0898

	)

2260 
	#SLSI_PSID_UNIFI_LAST_BSS_RSSI
 0x0899

	)

2274 
	#SLSI_PSID_UNIFI_SNR
 0x089A

	)

2287 
	#SLSI_PSID_UNIFI_LAST_BSS_SNR
 0x089B

	)

2302 
	#SLSI_PSID_UNIFI_SW_TX_TIMEOUT
 0x089C

	)

2317 
	#SLSI_PSID_UNIFI_RATE_STATS_RX_SUCCESS_COUNT
 0x089E

	)

2332 
	#SLSI_PSID_UNIFI_RATE_STATS_TX_SUCCESS_COUNT
 0x089F

	)

2347 
	#SLSI_PSID_UNIFI_TX_DATA_RATE
 0x08A0

	)

2364 
	#SLSI_PSID_UNIFI_SNR_EXTRA_OFFSET_CCK
 0x08A1

	)

2383 
	#SLSI_PSID_UNIFI_RSSI_MAX_AVERAGING_PERIOD
 0x08A2

	)

2397 
	#SLSI_PSID_UNIFI_RSSI_MIN_RECEIVED_FRAMES
 0x08A3

	)

2416 
	#SLSI_PSID_UNIFI_RATE_STATS_RATE
 0x08A4

	)

2429 
	#SLSI_PSID_UNIFI_LAST_BSS_TX_DATA_RATE
 0x08A5

	)

2453 
	#SLSI_PSID_UNIFI_DISCARDED_FRAME_COUNT
 0x08A6

	)

2467 
	#SLSI_PSID_UNIFI_MACRAME_DEBUG_STATS
 0x08A7

	)

2484 
	#SLSI_PSID_UNIFI_CURRENT_TSF_TIME
 0x08AA

	)

2498 
	#SLSI_PSID_UNIFI_BA_RX_ENABLE_TID
 0x08AB

	)

2513 
	#SLSI_PSID_UNIFI_BA_TX_ENABLE_TID
 0x08AD

	)

2527 
	#SLSI_PSID_UNIFI_TRAFFIC_THRESHOLD_TO_SETUP_BA
 0x08AE

	)

2541 
	#SLSI_PSID_UNIFI_DPLANE_TX_AMSDU_HW_CAPABILITY
 0x08AF

	)

2555 
	#SLSI_PSID_UNIFI_DPLANE_TX_AMSDU_SUBFRAME_COUNT_MAX
 0x08B0

	)

2570 
	#SLSI_PSID_UNIFI_BA_CONFIG
 0x08B1

	)

2583 
	#SLSI_PSID_UNIFI_BA_TX_MAX_NUMBER
 0x08B2

	)

2596 
	#SLSI_PSID_UNIFI_MOVE_BKTO_BE
 0x08B3

	)

2609 
	#SLSI_PSID_UNIFI_BEACON_RECEIVED
 0x08B4

	)

2624 
	#SLSI_PSID_UNIFI_AC_RETRIES
 0x08B5

	)

2638 
	#SLSI_PSID_UNIFI_RADIO_ON_TIME
 0x08B6

	)

2652 
	#SLSI_PSID_UNIFI_RADIO_TX_TIME
 0x08B7

	)

2666 
	#SLSI_PSID_UNIFI_RADIO_RX_TIME
 0x08B8

	)

2681 
	#SLSI_PSID_UNIFI_RADIO_SCAN_TIME
 0x08B9

	)

2694 
	#SLSI_PSID_UNIFI_PS_LEAKY_AP
 0x08BA

	)

2707 
	#SLSI_PSID_UNIFI_TQAM_ACTIVATED
 0x08BB

	)

2722 
	#SLSI_PSID_UNIFI_RADIO_ON_TIME_NAN
 0x08BC

	)

2735 
	#SLSI_PSID_UNIFI_PHY_EVENT_LOG_ENABLE
 0x08BE

	)

2749 
	#SLSI_PSID_UNIFI_OUTPUT_RADIO_INFO_TO_KERNEL_LOG
 0x08BF

	)

2763 
	#SLSI_PSID_UNIFI_NO_ACK_ACTIVATION_COUNT
 0x08C0

	)

2777 
	#SLSI_PSID_UNIFI_RX_FCS_ERROR_COUNT
 0x08C1

	)

2791 
	#SLSI_PSID_UNIFI_BEACONS_RECEIVED_PERCENTAGE
 0x08C5

	)

2805 
	#SLSI_PSID_UNIFI_ARP_DETECT_ACTIVATED
 0x08C6

	)

2819 
	#SLSI_PSID_UNIFI_ARP_DETECT_RESPONSE_COUNTER
 0x08C7

	)

2833 
	#SLSI_PSID_UNIFI_READ_TX_PACKET_STATS_FROM_STA_VIF
 0x08C8

	)

2846 
	#SLSI_PSID_UNIFI_ENABLE_MGMT_TX_PACKET_STATS
 0x08C9

	)

2859 
	#SLSI_PSID_UNIFI_SW_TO_HW_QUEUE_STATS
 0x08CA

	)

2872 
	#SLSI_PSID_UNIFI_HOST_TO_SW_QUEUE_STATS
 0x08CB

	)

2886 
	#SLSI_PSID_UNIFI_QUEUE_STATS_ENABLE
 0x08CC

	)

2901 
	#SLSI_PSID_UNIFI_TX_DATA_CONFIRM
 0x08CD

	)

2919 
	#SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
 0x08CE

	)

2932 
	#SLSI_PSID_UNIFI_LOAD_DPD_LUT
 0x08CF

	)

2945 
	#SLSI_PSID_UNIFI_DPD_MASTER_SWITCH
 0x08D0

	)

2962 
	#SLSI_PSID_UNIFI_DPD_PREDISTORT_GAINS
 0x08D1

	)

2975 
	#SLSI_PSID_UNIFI_OVERRIDE_DPD_LUT
 0x08D2

	)

2988 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_NUMBER_OF_PERIODIC_SCANS
 0x08D4

	)

3001 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_RSSI_SAMPLE_SIZE
 0x08D5

	)

3014 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_HOTLIST_APS
 0x08D6

	)

3027 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_SIGNIFICANT_WIFI_CHANGE_APS
 0x08D7

	)

3040 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_BSSID_HISTORY_ENTRIES
 0x08D8

	)

3054 
	#SLSI_PSID_UNIFI_RESTRICT_SCO_TXOP_SIZE
 0x08D9

	)

3071 
	#SLSI_PSID_UNIFI_USPBO_TX_AGGREGATE_BUFFER_SIZE
 0x08DA

	)

3089 
	#SLSI_PSID_UNIFI_NON_LTE_USPBO_CONFIG
 0x08DB

	)

3111 
	#SLSI_PSID_UNIFI_SET_RESPONSE_RATE
 0x08DC

	)

3126 
	#SLSI_PSID_UNIFI_MAC_BEACON_TIMEOUT
 0x08DE

	)

3141 
	#SLSI_PSID_UNIFI_MIF_OFF_ALLOWED
 0x08DF

	)

3155 
	#SLSI_PSID_UNIFI_BLOCK_SCAN_AFTER_NUM_SCHED_VIF
 0x08E0

	)

3170 
	#SLSI_PSID_UNIFI_MIFLESS_STA_ENABLE
 0x08E1

	)

3184 
	#SLSI_PSID_UNIFI_STA_USES_ONE_ANTENNA_WHEN_IDLE
 0x08E2

	)

3198 
	#SLSI_PSID_UNIFI_STA_USES_MULTI_ANTENNAS_DURING_CONNECT
 0x08E3

	)

3212 
	#SLSI_PSID_UNIFI_AP_USES_ONE_ANTENNA_WHEN_PEERS_IDLE
 0x08E4

	)

3227 
	#SLSI_PSID_DEPRECATED_UNIFI_UPDATE_ANTENNA_CAPABILITIES_WHEN_SCANNING
 0x08E5

	)

3245 
	#SLSI_PSID_UNIFI_PREFERRED_ANTENNA_BITMAP
 0x08E6

	)

3261 
	#SLSI_PSID_UNIFI_MAX_CONCURRENT_MA_CS
 0x08E7

	)

3275 
	#SLSI_PSID_UNIFI_LOAD_DPD_LUT_PER_RADIO
 0x08E8

	)

3289 
	#SLSI_PSID_UNIFI_OVERRIDE_DPD_LUT_PER_RADIO
 0x08E9

	)

3303 
	#SLSI_PSID_UNIFI_ROAMING_LOW_LATENCY_SOFT_ROAMING_ALLOWED
 0x08EA

	)

3316 
	#SLSI_PSID_UNIFI_ROAMING_SOFT_ROAMING_ACTIVATED_WHEN_LCD_IS_OFF
 0x08EC

	)

3330 
	#SLSI_PSID_UNIFI_ROAMING_SEND_DEAUTH_WHEN_ROAMING_BACK
 0x08ED

	)

3343 
	#SLSI_PSID_UNIFI_ROAM_BTM_DISREGARD_SELECTION_FACTOR
 0x08EE

	)

3359 
	#SLSI_PSID_UNIFI_TEST_SET_MAX_BANDWIDTH
 0x08EF

	)

3372 
	#SLSI_PSID_UNIFI_LOW_LATENCY_SCAN_NPROBE
 0x08F0

	)

3386 
	#SLSI_PSID_UNIFI_ROAM_ETE_ACTIVATED
 0x08F1

	)

3399 
	#SLSI_PSID_UNIFI_ROAM_MPDUSS
 0x08F2

	)

3413 
	#SLSI_PSID_UNIFI_ROAM_BA_WIN_SIZE
 0x08F3

	)

3428 
	#SLSI_PSID_UNIFI_ROAM_NCHO_CACHED_SCAN_PERIOD
 0x08F4

	)

3444 
	#SLSI_PSID_UNIFI_ROAM_CU_FACTOR
 0x08F7

	)

3458 
	#SLSI_PSID_UNIFI_BEACON_CU
 0x08F8

	)

3471 
	#SLSI_PSID_UNIFI_ROAM_BTM_FORCE_ABRIDGED
 0x08F9

	)

3484 
	#SLSI_PSID_UNIFI_ROAM_RSSI_BOOST
 0x08FA

	)

3498 
	#SLSI_PSID_UNIFI_ROAM_TARGET_RSSI_BEACON_LOST
 0x08FB

	)

3512 
	#SLSI_PSID_UNIFI_ROAM_CU_LOCAL
 0x08FC

	)

3526 
	#SLSI_PSID_UNIFI_ROAM_TARGET_RSSI_EMERGENCY
 0x08FD

	)

3541 
	#SLSI_PSID_UNIFI_ROAM_AP_SELECT_DELTA_FACTOR
 0x08FE

	)

3554 
	#SLSI_PSID_UNIFI_ROAM_CU_WEIGHT
 0x08FF

	)

3569 
	#SLSI_PSID_UNIFI_ROAM_BTM_AP_SELECT_DELTA_FACTOR
 0x0900

	)

3582 
	#SLSI_PSID_UNIFI_ROAM_RSSIWEIGHT
 0x0901

	)

3595 
	#SLSI_PSID_UNIFI_ROAM_RSSI_FACTOR
 0x0902

	)

3610 
	#SLSI_PSID_UNIFI_ROAM_CU_RSSI_SCAN_TRIGGER
 0x0903

	)

3624 
	#SLSI_PSID_UNIFI_ROAM_CU_SCAN_TRIGGER
 0x0904

	)

3638 
	#SLSI_PSID_UNIFI_ROAM_BSS_LOAD_MONITORING_FREQUENCY
 0x0905

	)

3652 
	#SLSI_PSID_UNIFI_ROAM_BLACKLIST_SIZE
 0x0906

	)

3665 
	#SLSI_PSID_UNIFI_CU_MEASUREMENT_INTERVAL
 0x0907

	)

3679 
	#SLSI_PSID_UNIFI_CURRENT_BSS_NSS
 0x0908

	)

3692 
	#SLSI_PSID_UNIFI_AP_MIMO_USED
 0x0909

	)

3706 
	#SLSI_PSID_UNIFI_ROAM_EAPOL_TIMEOUT
 0x090A

	)

3719 
	#SLSI_PSID_UNIFI_ROAMING_COUNT
 0x090B

	)

3733 
	#SLSI_PSID_UNIFI_ROAMING_AKM
 0x090C

	)

3747 
	#SLSI_PSID_UNIFI_CURRENT_BSS_BANDWIDTH
 0x090D

	)

3760 
	#SLSI_PSID_UNIFI_CURRENT_BSS_CHANNEL_FREQUENCY
 0x090E

	)

3774 
	#SLSI_PSID_UNIFI_ROAM_INACTIVE_COUNT
 0x090F

	)

3793 
	#SLSI_PSID_UNIFI_LOGGER_ENABLED
 0x0910

	)

3808 
	#SLSI_PSID_UNIFI_ROAM_AP_SELECT_MIN_DELTA_FACTOR
 0x0912

	)

3823 
	#SLSI_PSID_UNIFI_STA_VIF_LINK_NSS
 0x0914

	)

3836 
	#SLSI_PSID_UNIFI_FRAME_RX_COUNTERS
 0x0916

	)

3849 
	#SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
 0x0917

	)

3864 
	#SLSI_PSID_UNIFI_LAA_NSS_SPECULATION_INTERVAL_SLOT_TIME
 0x091A

	)

3878 
	#SLSI_PSID_UNIFI_LAA_NSS_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x091B

	)

3892 
	#SLSI_PSID_UNIFI_LAA_BW_SPECULATION_INTERVAL_SLOT_TIME
 0x091C

	)

3906 
	#SLSI_PSID_UNIFI_LAA_BW_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x091D

	)

3921 
	#SLSI_PSID_UNIFI_LAA_MCS_SPECULATION_INTERVAL_SLOT_TIME
 0x091E

	)

3935 
	#SLSI_PSID_UNIFI_LAA_MCS_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x091F

	)

3950 
	#SLSI_PSID_UNIFI_LAA_GI_SPECULATION_INTERVAL_SLOT_TIME
 0x0920

	)

3964 
	#SLSI_PSID_UNIFI_LAA_GI_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x0921

	)

3981 
	#SLSI_PSID_UNIFI_LAA_TX_NSS_ALLOWED_MODE
 0x0922

	)

3995 
	#SLSI_PSID_UNIFI_LAA_TX_DIVERSITY_BEAMFORM_ENABLED
 0x092E

	)

4009 
	#SLSI_PSID_UNIFI_LAA_TX_DIVERSITY_BEAMFORM_MIN_MCS
 0x092F

	)

4026 
	#SLSI_PSID_UNIFI_LAA_TX_DIVERSITY_FIX_MODE
 0x0930

	)

4044 
	#SLSI_PSID_UNIFI_LAA_AMPDU_INHIBIT_TIMEOUT
 0x0931

	)

4058 
	#SLSI_PSID_UNIFI_LAA_INHIBIT_RTS_COUNT
 0x0932

	)

4075 
	#SLSI_PSID_UNIFI_LAA_RTS_INHIBIT_TIMEOUT
 0x0933

	)

4093 
	#SLSI_PSID_UNIFI_LAA_PROTECTION_CONFIG_OVERRIDE
 0x0934

	)

4109 
	#SLSI_PSID_UNIFI_LAA_SPECULATION_MAX_TIME
 0x0935

	)

4122 
	#SLSI_PSID_UNIFI_RATE_STATS_RTS_ERROR_COUNT
 0x0936

	)

4137 
	#SLSI_PSID_UNIFI_RTS_DURATION_PROTECTS_FULL_TXOP
 0x0937

	)

4150 
	#SLSI_PSID_UNIFI_LAA_AMPDU_INHIBIT_RTS_ALSO
 0x0938

	)

4164 
	#SLSI_PSID_UNIFI_LOAD_MEM_DPD_LUT
 0x0939

	)

4179 
	#SLSI_PSID_UNIFI_CSR_ONLY_EIFS_DURATION
 0x093A

	)

4192 
	#SLSI_PSID_UNIFI_OVERRIDE_MEM_DPD_LUT
 0x093B

	)

4206 
	#SLSI_PSID_UNIFI_OVERRIDE_DEFAULT_BETXOP_FOR_HT
 0x093C

	)

4221 
	#SLSI_PSID_UNIFI_OVERRIDE_DEFAULT_BETXOP
 0x093D

	)

4234 
	#SLSI_PSID_UNIFI_RXABB_TRIM_SETTINGS
 0x093E

	)

4248 
	#SLSI_PSID_UNIFI_RADIO_TRIMS_ENABLE
 0x093F

	)

4262 
	#SLSI_PSID_UNIFI_RADIO_CCA_THRESHOLDS
 0x0940

	)

4278 
	#SLSI_PSID_UNIFI_HARDWARE_PLATFORM
 0x0941

	)

4296 
	#SLSI_PSID_UNIFI_FORCE_CHANNEL_BW
 0x0942

	)

4309 
	#SLSI_PSID_UNIFI_DPD_TRAINING_DURATION
 0x0943

	)

4322 
	#SLSI_PSID_UNIFI_TX_FTRIM_SETTINGS
 0x0944

	)

4335 
	#SLSI_PSID_UNIFI_TX_POWER_TRIM_COMMON_CONFIG
 0x0946

	)

4348 
	#SLSI_PSID_UNIFI_IQ_DEBUG_ENABLED
 0x0947

	)

4361 
	#SLSI_PSID_UNIFI_FTM_ONE_CROSS_TWO_SUPPORT
 0x0948

	)

4374 
	#SLSI_PSID_UNIFI_ROAM_FT_OVER_DS_ENABLED
 0x094A

	)

4388 
	#SLSI_PSID_UNIFI_ROAM_FT_OVER_DS_MIN_RSSI
 0x094B

	)

4402 
	#SLSI_PSID_UNIFI_ALWAYS_INCLUDE_OPERATING_MODE_NOTIFICATION
 0x094C

	)

4415 
	#SLSI_PSID_UNIFI_SISO_ON_SINGLE_NSS_ACTIVATED
 0x094D

	)

4428 
	#SLSI_PSID_UNIFI_MAX_TDLS_CLIENT
 0x094E

	)

4442 
	#SLSI_PSID_UNIFI_AUTO_CONNECTION_TEST_ACTIVATED
 0x094F

	)

4456 
	#SLSI_PSID_UNIFI_ROAM_WTC_ACTIVATED
 0x0950

	)

4473 
	#SLSI_PSID_UNIFI_ENABLE_COEX_LOW_LATENCY
 0x0961

	)

4486 
	#SLSI_PSID_UNIFI_COEX_API_LOOPBACK_TEST
 0x0962

	)

4499 
	#SLSI_PSID_UNIFI_COEX_DEBUG_OVERRIDE_BT
 0x0979

	)

4514 
	#SLSI_PSID_UNIFI_LTE_MAILBOX
 0x097E

	)

4529 
	#SLSI_PSID_UNIFI_LTE_MWS_SIGNAL
 0x097F

	)

4542 
	#SLSI_PSID_UNIFI_LTE_ENABLE_CHANNEL_AVOIDANCE
 0x0980

	)

4555 
	#SLSI_PSID_UNIFI_LTE_ENABLE_POWER_BACKOFF
 0x0981

	)

4568 
	#SLSI_PSID_UNIFI_LTE_ENABLE_TIME_DOMAIN
 0x0982

	)

4581 
	#SLSI_PSID_UNIFI_LTE_ENABLE_LTE_COEX
 0x0983

	)

4595 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_CHANNELS
 0x0984

	)

4610 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_RSRP_LOW
 0x0985

	)

4625 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_RSRP_HIGH
 0x0986

	)

4642 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_RSRP_AVERAGING_ALPHA
 0x0987

	)

4655 
	#SLSI_PSID_UNIFI_LTE_SET_CHANNEL
 0x0988

	)

4668 
	#SLSI_PSID_UNIFI_LTE_SET_POWER_BACKOFF
 0x0989

	)

4681 
	#SLSI_PSID_UNIFI_LTE_SET_TDD_DEBUG_MODE
 0x098A

	)

4694 
	#SLSI_PSID_UNIFI_LTE_BAND40_AVOID_CHANNELS
 0x098B

	)

4707 
	#SLSI_PSID_UNIFI_LTE_BAND41_AVOID_CHANNELS
 0x098C

	)

4720 
	#SLSI_PSID_UNIFI_LTE_BAND7_AVOID_CHANNELS
 0x098D

	)

4733 
	#SLSI_PSID_UNIFI_LTE_BAND40_FREQ_THRESHOLD
 0x098E

	)

4746 
	#SLSI_PSID_UNIFI_LTE_BAND41_FREQ_THRESHOLD
 0x098F

	)

4759 
	#SLSI_PSID_UNIFI_LTE_BAND79_FREQ_THRESHOLD
 0x0990

	)

4773 
	#SLSI_PSID_UNIFI_LTE_BAND41_POWER_BACKOFF_CHANNELS
 0x0991

	)

4787 
	#SLSI_PSID_UNIFI_LTE_BAND4041_AVOID_CHANNELS_FALLBACK
 0x0992

	)

4800 
	#SLSI_PSID_UNIFI_LTE_BAND79_ENABLE
 0x0993

	)

4814 
	#SLSI_PSID_UNIFI_LTE_BAND79_POWER_BACKOFF_CHANNELS
 0x0994

	)

4827 
	#SLSI_PSID_UNIFI_LTE_BAND79_AVOID_CHANNELS
 0x0995

	)

4842 
	#SLSI_PSID_UNIFI_LEAKY_AP_CONFIG
 0x0996

	)

4858 
	#SLSI_PSID_UNIFI_USE_CTS_FOR_LEAKY_AP
 0x0997

	)

4875 
	#SLSI_PSID_UNIFI_USPBO_RX_AGGREGATE_BUFFER_SIZE
 0x0998

	)

4889 
	#SLSI_PSID_UNIFI_MIFLESS_AP_BITMAP
 0x099A

	)

4908 
	#SLSI_PSID_UNIFI_ANTENNA_SELECTION_OPTION
 0x099B

	)

4925 
	#SLSI_PSID_UNIFI_SUPPORT_MAX_REQUIRED_ANTENNA
 0x099C

	)

4938 
	#SLSI_PSID_UNIFI_BEACON_RX_PERIOD_UPDATE
 0x09A1

	)

4954 
	#SLSI_PSID_UNIFI_SISO_SWITCH_WAIT_TIME
 0x09A2

	)

4970 
	#SLSI_PSID_UNIFI_MIFLESS_AP_MIN_AWAKE_INTERVAL
 0x09A3

	)

4986 
	#SLSI_PSID_UNIFI_BLACKOUT_SIMULATION
 0x09A6

	)

5003 
	#SLSI_PSID_UNIFI_BLACKOUT_FORCE_TX_ONLY
 0x09A7

	)

5017 
	#SLSI_PSID_UNIFI_SAE_DWELL_TIME
 0x09A8

	)

5031 
	#SLSI_PSID_UNIFI_USE_HOST_LISTEN_INTERVAL
 0x09AC

	)

5049 
	#SLSI_PSID_UNIFI_DYNAMIC_ITO_CONTROL
 0x09AE

	)

5064 
	#SLSI_PSID_UNIFI_MAX_BEACON_LISTEN_WINDOW_TIME
 0x09AF

	)

5079 
	#SLSI_PSID_UNIFI_AP_SCAN_ABSENCE_DURATION
 0x09B0

	)

5094 
	#SLSI_PSID_UNIFI_AP_SCAN_ABSENCE_PERIOD
 0x09B1

	)

5109 
	#SLSI_PSID_UNIFI_MLMESTA_KEEP_ALIVE_TIMEOUT_CHECK
 0x09B5

	)

5124 
	#SLSI_PSID_UNIFI_MLMEAP_KEEP_ALIVE_TIMEOUT_CHECK
 0x09B6

	)

5139 
	#SLSI_PSID_UNIFI_MLMEGO_KEEP_ALIVE_TIMEOUT_CHECK
 0x09B7

	)

5154 
	#SLSI_PSID_UNIFI_BSS_MAX_IDLE_PERIOD
 0x09B8

	)

5167 
	#SLSI_PSID_UNIFI_IGMP_OFFLOAD_ACTIVATED
 0x09B9

	)

5181 
	#SLSI_PSID_UNIFI_DUAL_STA_IDLE_MODE_ENABLED
 0x09BA

	)

5195 
	#SLSI_PSID_UNIFI_STA_IDLE_MODE_CONTROL
 0x09BB

	)

5210 
	#SLSI_PSID_UNIFI_GOCT_WINDOW_DELAY
 0x09BC

	)

5224 
	#SLSI_PSID_UNIFI_STA_IDLE_MODE_ENABLED
 0x09BD

	)

5246 
	#SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT_AGGRESSIVE
 0x09BE

	)

5267 
	#SLSI_PSID_UNIFI_IDLEMODE_LISTEN_INTERVAL_SKIPPING_DTIM
 0x09BF

	)

5288 
	#SLSI_PSID_UNIFI_IDLEMODE_P2_PLISTEN_INTERVAL_SKIPPING_DTIM
 0x09C0

	)

5304 
	#SLSI_PSID_UNIFI_AP_IDLE_MODE_ENABLED
 0x09C1

	)

5322 
	#SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT
 0x09C4

	)

5343 
	#SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT_SMALL
 0x09C5

	)

5358 
	#SLSI_PSID_UNIFI_MLMESTA_KEEP_ALIVE_TIMEOUT
 0x09C6

	)

5372 
	#SLSI_PSID_UNIFI_MLMEAP_KEEP_ALIVE_TIMEOUT
 0x09C7

	)

5386 
	#SLSI_PSID_UNIFI_MLMEGO_KEEP_ALIVE_TIMEOUT
 0x09C8

	)

5400 
	#SLSI_PSID_UNIFI_STA_ROUTER_ADVERTISEMENT_MINIMUM_INTERVAL_TO_FORWARD
 0x09C9

	)

5415 
	#SLSI_PSID_UNIFI_ROAM_CONNECTION_QUALITY_CHECK_WAIT_AFTER_CONNECT
 0x09CA

	)

5437 
	#SLSI_PSID_UNIFI_AP_BEACON_MAX_DRIFT
 0x09CB

	)

5451 
	#SLSI_PSID_UNIFI_BSS_MAX_IDLE_PERIOD_ACTIVATED
 0x09CC

	)

5469 
	#SLSI_PSID_UNIFI_VIF_IDLE_MONITOR_TIME
 0x09CD

	)

5486 
	#SLSI_PSID_UNIFI_DISABLE_LEGACY_POWER_SAVE
 0x09CE

	)

5503 
	#SLSI_PSID_UNIFI_DEBUG_FORCE_ACTIVE
 0x09CF

	)

5519 
	#SLSI_PSID_UNIFI_STATION_ACTIVITY_IDLE_TIME
 0x09D0

	)

5532 
	#SLSI_PSID_UNIFI_DMS_ACTIVATED
 0x09D1

	)

5555 
	#SLSI_PSID_UNIFI_POWER_MANAGEMENT_DELAY_TIMEOUT
 0x09D2

	)

5579 
	#SLSI_PSID_UNIFI_APSD_SERVICE_PERIOD_TIMEOUT
 0x09D3

	)

5605 
	#SLSI_PSID_UNIFI_CONCURRENT_POWER_MANAGEMENT_DELAY_TIMEOUT
 0x09D4

	)

5619 
	#SLSI_PSID_UNIFI_STATION_QOS_INFO
 0x09D5

	)

5640 
	#SLSI_PSID_UNIFI_LISTEN_INTERVAL_SKIPPING_DTIM
 0x09D6

	)

5654 
	#SLSI_PSID_UNIFI_LISTEN_INTERVAL
 0x09D7

	)

5668 
	#SLSI_PSID_UNIFI_LEGACY_PS_POLL_TIMEOUT
 0x09D8

	)

5695 
	#SLSI_PSID_UNIFI_BEACON_SKIPPING_CONTROL
 0x09D9

	)

5712 
	#SLSI_PSID_UNIFI_TOGGLE_POWER_DOMAIN
 0x09DA

	)

5733 
	#SLSI_PSID_UNIFI_P2_PLISTEN_INTERVAL_SKIPPING_DTIM
 0x09DB

	)

5757 
	#SLSI_PSID_UNIFI_FRAGMENTATION_DURATION
 0x09DC

	)

5773 
	#SLSI_PSID_UNIFI_ROAM_SEND_INIT_FRAME_TO_GET_NEIGHBORS
 0x09DD

	)

5786 
	#SLSI_PSID_UNIFI_IDLE_MODE_LITE_ENABLED
 0x09DE

	)

5809 
	#SLSI_PSID_UNIFI_DTIM_WAIT_TIMEOUT
 0x09E1

	)

5827 
	#SLSI_PSID_UNIFI_LISTEN_INTERVAL_MAX_TIME
 0x09E2

	)

5842 
	#SLSI_PSID_UNIFI_SCAN_MAX_PROBE_TRANSMIT_LIFETIME
 0x09E3

	)

5861 
	#SLSI_PSID_UNIFI_POWER_SAVE_TRANSITION_PACKET_THRESHOLD
 0x09E4

	)

5874 
	#SLSI_PSID_UNIFI_PROBE_RESPONSE_LIFETIME
 0x09E5

	)

5887 
	#SLSI_PSID_UNIFI_PROBE_RESPONSE_MAX_RETRY
 0x09E6

	)

5908 
	#SLSI_PSID_UNIFI_TRAFFIC_ANALYSIS_PERIOD
 0x09E7

	)

5928 
	#SLSI_PSID_UNIFI_AGGRESSIVE_POWER_SAVE_TRANSITION_PERIOD
 0x09E8

	)

5947 
	#SLSI_PSID_UNIFI_ACTIVE_TIME_AFTER_MORE_BIT
 0x09E9

	)

5962 
	#SLSI_PSID_UNIFI_DEFAULT_DWELL_TIME
 0x09EA

	)

5976 
	#SLSI_PSID_UNIFI_VHT_CAPABILITIES
 0x09EC

	)

5992 
	#SLSI_PSID_UNIFI_MAX_VIF_SCHEDULE_DURATION
 0x09ED

	)

6008 
	#SLSI_PSID_UNIFI_VIF_LONG_INTERVAL_TIME
 0x09EE

	)

6022 
	#SLSI_PSID_UNIFI_DISALLOW_SCHED_RELINQUISH
 0x09EF

	)

6037 
	#SLSI_PSID_UNIFI_RAME_DPLANE_OPERATION_TIMEOUT
 0x09F0

	)

6053 
	#SLSI_PSID_UNIFI_DEBUG_KEEP_RADIO_ON
 0x09F1

	)

6068 
	#SLSI_PSID_UNIFI_FORCE_FIXED_DURATION_SCHEDULE
 0x09F2

	)

6081 
	#SLSI_PSID_UNIFI_RAME_UPDATE_MIBS
 0x09F3

	)

6096 
	#SLSI_PSID_UNIFI_GO_SCAN_ABSENCE_DURATION
 0x09F4

	)

6111 
	#SLSI_PSID_UNIFI_GO_SCAN_ABSENCE_PERIOD
 0x09F5

	)

6124 
	#SLSI_PSID_UNIFI_MAX_CLIENT
 0x09F6

	)

6140 
	#SLSI_PSID_UNIFI_GOCT_WINDOW_DURATION
 0x09F7

	)

6154 
	#SLSI_PSID_UNIFI_SUPPRESS_SCAN_GO_NOA_ANNOUNCE
 0x09F8

	)

6167 
	#SLSI_PSID_UNIFI_TDLS_IN_P2P_ACTIVATED
 0x09FC

	)

6181 
	#SLSI_PSID_UNIFI_TDLS_ACTIVATED
 0x09FE

	)

6195 
	#SLSI_PSID_UNIFI_TDLS_TP_THRESHOLD_PKT_SECS
 0x09FF

	)

6210 
	#SLSI_PSID_UNIFI_TDLS_RSSI_THRESHOLD
 0x0A00

	)

6223 
	#SLSI_PSID_UNIFI_TDLS_MAXIMUM_RETRY
 0x0A01

	)

6237 
	#SLSI_PSID_UNIFI_TDLS_TP_MONITOR_SECS
 0x0A02

	)

6250 
	#SLSI_PSID_UNIFI_TDLS_BASIC_HT_MCS_SET
 0x0A03

	)

6263 
	#SLSI_PSID_UNIFI_TDLS_BASIC_VHT_MCS_SET
 0x0A04

	)

6277 
	#SLSI_PSID_DOT11_TDLS_DISCOVERY_REQUEST_WINDOW
 0x0A05

	)

6292 
	#SLSI_PSID_DOT11_TDLS_RESPONSE_TIMEOUT
 0x0A06

	)

6305 
	#SLSI_PSID_DOT11_TDLS_CHANNEL_SWITCH_ACTIVATED
 0x0A07

	)

6318 
	#SLSI_PSID_UNIFI_TDLS_DESIGN_FOR_TEST_MODE
 0x0A08

	)

6331 
	#SLSI_PSID_UNIFI_TDLS_WIDER_BANDWIDTH_PROHIBITED
 0x0A09

	)

6344 
	#SLSI_PSID_UNIFI_TDLS_KEY_LIFE_TIME_INTERVAL
 0x0A11

	)

6357 
	#SLSI_PSID_UNIFI_TDLS_TEARDOWN_FRAME_TX_TIMEOUT
 0x0A12

	)

6370 
	#SLSI_PSID_UNIFI_WIFI_SHARING_ACTIVATED
 0x0A14

	)

6386 
	#SLSI_PSID_UNIFI_WI_FI_SHARING_CHANNELS
 0x0A15

	)

6402 
	#SLSI_PSID_UNIFI_WI_FI_SHARING5_GHZ_CHANNEL
 0x0A16

	)

6416 
	#SLSI_PSID_UNIFI_WIFI_SHARING_CHANNEL_SWITCH_COUNT
 0x0A17

	)

6430 
	#SLSI_PSID_UNIFI_CHANNEL_ANNOUNCEMENT_COUNT
 0x0A18

	)

6445 
	#SLSI_PSID_UNIFI_RA_TEST_STORED_SA
 0x0A19

	)

6459 
	#SLSI_PSID_UNIFI_RA_TEST_STORE_FRAME
 0x0A1A

	)

6472 
	#SLSI_PSID_DOT11_TDLS_PEER_UAPSD_BUFFER_STA_ACTIVATED
 0x0A1B

	)

6485 
	#SLSI_PSID_UNIFI_WP_A3_ACTIVATED
 0x0A1C

	)

6498 
	#SLSI_PSID_UNIFI_ARP_OUTSTANDING_MAX
 0x0A1E

	)

6512 
	#SLSI_PSID_UNIFI_P2_PLEGACY_PROBE_RESPONSE_ACTIVATED
 0x0A27

	)

6525 
	#SLSI_PSID_UNIFI_PROBE_RESPONSE_LIFETIME_P2P
 0x0A28

	)

6539 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_ACTIVATED
 0x0A29

	)

6552 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_MAX_TIME
 0x0A2C

	)

6565 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_POLL_INTERVAL
 0x0A2D

	)

6578 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_PROCEDURE_TIMEOUT_INCREMENT
 0x0A2E

	)

6592 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAX_AERIALS
 0x0A2F

	)

6605 
	#SLSI_PSID_UNIFI_INCLUDE_PMKID_FOR_PSK
 0x0A32

	)

6619 
	#SLSI_PSID_UNIFI_AMSDU_SUBFRAME_REALTEK_OVERRIDE_ACTIVATED
 0x0A37

	)

6633 
	#SLSI_PSID_UNIFI_SUPPRESS_STS_UPDATE_BASED_ON_PEER
 0x0A38

	)

6648 
	#SLSI_PSID_UNIFI_BA_RX_INTERNAL_DELETE_DISABLED
 0x0A3A

	)

6661 
	#SLSI_PSID_UNIFI_HT_AP_DOWNGRADE_BY_NSS_ACTIVATED
 0x0A3B

	)

6675 
	#SLSI_PSID_UNIFI_HE40IN5_GRALINK_OVERRIDE_ENABLE
 0x0A3C

	)

6689 
	#SLSI_PSID_UNIFI_BTM_DISASSOCIATION_SCAN_DELAY
 0x0A4F

	)

6703 
	#SLSI_PSID_UNIFI_ROAM_BTM_QUERY_TIMEOUT
 0x0A50

	)

6717 
	#SLSI_PSID_UNIFI_ROAM_BSSCU_TRIGGER_FREQUENCY
 0x0A51

	)

6731 
	#SLSI_PSID_UNIFI_ROAM_RSSI_FACTOR_FIXED_MULTIPLIER
 0x0A53

	)

6745 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_MAX_PASSIVE_CHANNEL_TIME
 0x0A54

	)

6758 
	#SLSI_PSID_UNIFI_APF_ACTIVATED
 0x0A5A

	)

6771 
	#SLSI_PSID_UNIFI_APF_VERSION
 0x0A5B

	)

6785 
	#SLSI_PSID_UNIFI_APF_MAX_SIZE
 0x0A5C

	)

6799 
	#SLSI_PSID_UNIFI_APF_ACTIVE_MODE_ENABLED
 0x0A5D

	)

6813 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_NDM_TIMEOUT
 0x0A5E

	)

6827 
	#SLSI_PSID_UNIFI_SM_POWER_SAVE_MODE
 0x0A6E

	)

6840 
	#SLSI_PSID_UNIFI_HE_ACTIVATED
 0x0A8C

	)

6855 
	#SLSI_PSID_UNIFI_HE_CAPABILITIES
 0x0A8D

	)

6868 
	#SLSI_PSID_UNIFI_RAA_TX_GI_VALUE
 0x0A8E

	)

6881 
	#SLSI_PSID_UNIFI_RAA_TX_LTF_VALUE
 0x0A8F

	)

6894 
	#SLSI_PSID_UNIFI256_MSDU_CONFIG
 0x0A90

	)

6907 
	#SLSI_PSID_UNIFI_MBSSID_ACTIVATED
 0x0A91

	)

6920 
	#SLSI_PSID_UNIFI_TX_AMSDU_SUPPORT_OVERRIDE
 0x0A92

	)

6933 
	#SLSI_PSID_UNIFI_MBSSID_ROAMING_ACTIVATED
 0x0A93

	)

6946 
	#SLSI_PSID_UNIFI_HE_DYNAMIC_SMPS_ENABLE
 0x0A94

	)

6968 
	#SLSI_PSID_UNIFI_HE1XLTF08GI_WORKAROUND
 0x0A95

	)

6995 
	#SLSI_PSID_UNIFI_OVERRIDE_MUEDCA_PARAM_AC_ENABLE
 0x0A96

	)

7014 
	#SLSI_PSID_UNIFI_OVERRIDE_MUEDCA_PARAM_AC
 0x0A97

	)

7027 
	#SLSI_PSID_UNIFI_MUEDCA_TIMER_UNIT
 0x0A98

	)

7043 
	#SLSI_PSID_UNIFI_ULMU_DISABLE_BIT_MAP
 0x0A99

	)

7056 
	#SLSI_PSID_UNIFI_HE_ER_SU_DISABLE
 0x0A9A

	)

7069 
	#SLSI_PSID_UNIFI_OM_TX_NSTS_VALUE
 0x0A9B

	)

7082 
	#SLSI_PSID_UNIFI_OM_RX_NSS_VALUE
 0x0A9C

	)

7095 
	#SLSI_PSID_UNIFI_OM_CHAN_BANDWIDTH_VALUE
 0x0A9D

	)

7108 
	#SLSI_PSID_UNIFI_OM_UL_MU_ENABLE
 0x0A9E

	)

7121 
	#SLSI_PSID_UNIFI_OP_MODE_VALUE
 0x0A9F

	)

7135 
	#SLSI_PSID_UNIFI_OFDMA_NARROW_BW_RU_DISABLE_TIME
 0x0AA0

	)

7148 
	#SLSI_PSID_UNIFI_UL_MU_MIMO_SUPPORT_OVERRIDE
 0x0AA1

	)

7161 
	#SLSI_PSID_UNIFI_DL_MUMIMO_NC_WAR
 0x0AA2

	)

7174 
	#SLSI_PSID_UNIFI_HE_UL_OFDMA_RX_DISABLED_SOFT_AP
 0x0AA3

	)

7187 
	#SLSI_PSID_UNIFI_MBSS_CONTROL_FRAME_RX_SUPPORTED
 0x0AA4

	)

7201 
	#SLSI_PSID_UNIFI_PN_CHECK
 0x0AA5

	)

7217 
	#SLSI_PSID_UNIFI_OFDMA_SOFT_AP_TX_TRIGGER_PARAMS
 0x0AA6

	)

7230 
	#SLSI_PSID_UNIFI_TWT_ACTIVATED
 0x0AAB

	)

7245 
	#SLSI_PSID_UNIFI_TWT_CONTROL_FLAGS
 0x0AAC

	)

7259 
	#SLSI_PSID_UNIFI_TWT_IND_DEF_SESS_IDX
 0x0AAD

	)

7273 
	#SLSI_PSID_UNIFI_TWT_START_SESSION
 0x0AAE

	)

7287 
	#SLSI_PSID_UNIFI_TWT_TEARDOWN_SESSION
 0x0AAF

	)

7310 
	#SLSI_PSID_UNIFI_TWT_IND_SESS_PARAM
 0x0AB0

	)

7327 
	#SLSI_PSID_UNIFI_TWT_MODE_SUPPORT_BIT_MAP
 0x0AB1

	)

7340 
	#SLSI_PSID_UNIFI_TWT_HOST_SUSP_TWT_TEARDOWN_DELAY
 0x0AB2

	)

7353 
	#SLSI_PSID_UNIFI_TWTSP_INACTIVITY_TIME
 0x0AB3

	)

7367 
	#SLSI_PSID_UNIFI_TWT_RESUME_DURATION
 0x0AB4

	)

7380 
	#SLSI_PSID_UNIFI_TWT_OPERATION
 0x0AB5

	)

7393 
	#SLSI_PSID_UNIFI_TWT_INFO_FRAME_TX
 0x0AB6

	)

7416 
	#SLSI_PSID_UNIFI_TWT_BCAST_SESS_PARAM
 0x0AB7

	)

7431 
	#SLSI_PSID_UNIFI_HE_CAPABILITIES_SOFT_AP
 0x0AB9

	)

7444 
	#SLSI_PSID_UNIFI_HE_ACTIVATED_SOFT_AP
 0x0ABA

	)

7457 
	#SLSI_PSID_UNIFI_HE_ACTIVATED_P2P
 0x0ABB

	)

7470 
	#SLSI_PSID_UNIFI_HE_ENABLE_DYNAMIC_DURATION_BASED_RTS_THRESHOLD
 0x0ABC

	)

7489 
	#SLSI_PSID_UNIFI_SOFT_AP_MUEDCA_PARAM_AC
 0x0ABD

	)

7502 
	#SLSI_PSID_UNIFI6_GHZ_ENABLED
 0x0ABF

	)

7515 
	#SLSI_PSID_UNIFI6_GRNR_MAX_CACHE_COUNT
 0x0AC0

	)

7528 
	#SLSI_PSID_UNIFI6_GSCAN_ACC_TIMEOUT_DUR
 0x0AC1

	)

7541 
	#SLSI_PSID_UNIFI6_GPRESCAN_CONCURRENT_MACS
 0x0AC2

	)

7554 
	#SLSI_PSID_UNIFI6_GENABLE_PRESCAN
 0x0AC3

	)

7577 
	#SLSI_PSID_UNIFI_USER_CONTROL_BA_SESSION
 0x0AEF

	)

7591 
	#SLSI_PSID_UNIFI_MLMESTA_KEEP_ALIVE_FAILURE
 0x0B1A

	)

7618 
	#SLSI_PSID_UNIFI_CSR_ONLY_MIB_SHIELD
 0x0FA1

	)

7634 
	#SLSI_PSID_UNIFI_PRIVATE_BBB_TX_FILTER_CONFIG
 0x0FE7

	)

7647 
	#SLSI_PSID_UNIFI_PRIVATE_SWAGC_FRONT_END_GAIN
 0x0FEB

	)

7660 
	#SLSI_PSID_UNIFI_PRIVATE_SWAGC_FRONT_END_LOSS
 0x0FEC

	)

7673 
	#SLSI_PSID_UNIFI_PRIVATE_SWAGC_EXT_THRESH
 0x0FED

	)

7688 
	#SLSI_PSID_UNIFI_CSR_ONLY_POWER_CAL_DELAY
 0x0FEE

	)

7727 
	#SLSI_PSID_UNIFI_RX_AGC_CONTROL
 0x0FEF

	)

7740 
	#SLSI_PSID_DEPRECATED_UNIFI_WAPI_QOS_MASK
 0x1022

	)

7755 
	#SLSI_PSID_UNIFI_WMM_STALL_ENABLE
 0x102B

	)

7769 
	#SLSI_PSID_UNIFI_DEACTIVATE_INESSENTIAL_DEBUG
 0x102C

	)

7783 
	#SLSI_PSID_UNIFI_RAA_TX_HOST_RATE
 0x1034

	)

7806 
	#SLSI_PSID_UNIFI_FALLBACK_SHORT_FRAME_RETRY_DISTRIBUTION
 0x1035

	)

7820 
	#SLSI_PSID_UNIFI_THROUGHPUT_LOW
 0x1036

	)

7834 
	#SLSI_PSID_UNIFI_THROUGHPUT_HIGH
 0x1037

	)

7848 
	#SLSI_PSID_UNIFI_SET_FIXED_AMPDU_AGGREGATION_SIZE
 0x1038

	)

7862 
	#SLSI_PSID_UNIFI_THROUGHPUT_DEBUG_REPORT_INTERVAL
 0x1039

	)

7875 
	#SLSI_PSID_UNIFI_DPLANE_TEST1
 0x103A

	)

7888 
	#SLSI_PSID_UNIFI_DPLANE_TEST2
 0x103B

	)

7901 
	#SLSI_PSID_UNIFI_DPLANE_TEST3
 0x103C

	)

7914 
	#SLSI_PSID_UNIFI_DPLANE_TEST4
 0x103D

	)

7927 
	#SLSI_PSID_UNIFI_ENABLE_COPY_PHY_LOG_TO_DRAM
 0x103E

	)

7942 
	#SLSI_PSID_UNIFI_LAA_FIXED_MAX_BANDWIDTH
 0x103F

	)

7959 
	#SLSI_PSID_UNIFI_DPLANE_DEAF_DETECTION
 0x1040

	)

7974 
	#SLSI_PSID_UNIFI_LAA_LOCAL_BW_CONTROL_ENABLE
 0x1041

	)

7988 
	#SLSI_PSID_UNIFI_LAA_LOCAL_BW_BUSY_WEIGH
 0x1042

	)

8002 
	#SLSI_PSID_UNIFI_LAA_LOCAL_BW_BUSY_LEVEL_THRES
 0x1043

	)

8016 
	#SLSI_PSID_UNIFI_LAA_MIN_MCS_FOR_BW_CHANGE
 0x1044

	)

8029 
	#SLSI_PSID_UNIFI_DPHP_HW_MONITOR_LOG_ENABLE
 0x1045

	)

8045 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_MIN_INTERVAL
 0x1046

	)

8058 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_MIN_BEACON_MISS_IN_ROW
 0x1047

	)

8074 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_CONFIG
 0x1048

	)

8090 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_INTERVAL
 0x1049

	)

8109 
	#SLSI_PSID_UNIFI_MONITOR_STA_ADDRESS
 0x104A

	)

8128 
	#SLSI_PSID_UNIFI_PRE_EBRT_WINDOW
 0x104B

	)

8147 
	#SLSI_PSID_UNIFI_POST_EBRT_WINDOW
 0x104D

	)

8164 
	#SLSI_PSID_UNIFI_LIVE_RESTART_RSSI_THRESHOLD
 0x104E

	)

8182 
	#SLSI_PSID_UNIFI_LIVE_RESTART_MIN_INTERVAL
 0x104F

	)

8199 
	#SLSI_PSID_UNIFI_PS_POLL_THRESHOLD
 0x1053

	)

8218 
	#SLSI_PSID_UNIFI_POST_EBRT_WINDOW_IDLE
 0x1054

	)

8237 
	#SLSI_PSID_UNIFI_PRE_EBRT_WINDOW_IDLE
 0x1055

	)

8263 
	#SLSI_PSID_UNIFI_SABLE_CONTAINER_SIZE_CONFIGURATION
 0x1388

	)

8279 
	#SLSI_PSID_UNIFI_SABLE_FRAME_LOG_MODE
 0x1389

	)

8295 
	#SLSI_PSID_UNIFI_SABLE_FRAME_LOG_CPU_THRES_PERCENT
 0x138A

	)

8308 
	#SLSI_PSID_UNIFI_SABLE_FRAME_LOG_CPU_OVERHEAD_PERCENT
 0x138B

	)

8321 
	#SLSI_PSID_UNIFI_DPLANE_SABLE_TX_DELAY_THRES_MS
 0x138C

	)

8336 
	#SLSI_PSID_UNIFI_DPLANE_SABLE_TX_DELAY_ACTION
 0x138D

	)

8349 
	#SLSI_PSID_UNIFI_DEBUG_SVC_MODE_STACK_HIGH_WATER_MARK
 0x1392

	)

8362 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM_BE
 0x139F

	)

8375 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM_BE_ENABLE
 0x13A0

	)

8397 
	#SLSI_PSID_UNIFI_PANIC_SUB_SYSTEM_CONTROL
 0x13A2

	)

8410 
	#SLSI_PSID_UNIFI_FAULT_ENABLE
 0x13A3

	)

8434 
	#SLSI_PSID_UNIFI_FAULT_SUB_SYSTEM_CONTROL
 0x13A4

	)

8458 
	#SLSI_PSID_UNIFI_DEBUG_MODULE_CONTROL
 0x13A5

	)

8474 
	#SLSI_PSID_UNIFI_TX_USING_LDPC_ACTIVATED
 0x13A6

	)

8487 
	#SLSI_PSID_UNIFI_TX_SETTINGS
 0x13A7

	)

8500 
	#SLSI_PSID_UNIFI_TX_GAIN_SETTINGS
 0x13A8

	)

8514 
	#SLSI_PSID_UNIFI_TX_ANTENNA_CONNECTION_LOSS_FREQUENCY
 0x13A9

	)

8528 
	#SLSI_PSID_UNIFI_TX_ANTENNA_CONNECTION_LOSS
 0x13AA

	)

8541 
	#SLSI_PSID_UNIFI_TX_ANTENNA_MAX_GAIN_FREQUENCY
 0x13AB

	)

8555 
	#SLSI_PSID_UNIFI_TX_ANTENNA_MAX_GAIN
 0x13AC

	)

8568 
	#SLSI_PSID_UNIFI_RX_EXTERNAL_GAIN_FREQUENCY
 0x13AD

	)

8581 
	#SLSI_PSID_UNIFI_RX_EXTERNAL_GAIN
 0x13AE

	)

8597 
	#SLSI_PSID_UNIFI_TX_SG_I20_ACTIVATED
 0x13B0

	)

8613 
	#SLSI_PSID_UNIFI_TX_SG_I40_ACTIVATED
 0x13B1

	)

8629 
	#SLSI_PSID_UNIFI_TX_SG_I80_ACTIVATED
 0x13B2

	)

8645 
	#SLSI_PSID_UNIFI_TX_SG_I160_ACTIVATED
 0x13B3

	)

8659 
	#SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
 0x13B4

	)

8674 
	#SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION_MASK
 0x13B7

	)

8687 
	#SLSI_PSID_UNIFI_WIPS_ACTIVATED
 0x13BA

	)

8701 
	#SLSI_PSID_UNIFI_RF_TEST_MODE_ACTIVATED
 0x13BE

	)

8715 
	#SLSI_PSID_UNIFI_TX_POWER_DETECTOR_RESPONSE
 0x13BF

	)

8728 
	#SLSI_PSID_UNIFI_TX_DETECTOR_TEMPERATURE_COMPENSATION
 0x13C0

	)

8741 
	#SLSI_PSID_UNIFI_TX_DETECTOR_FREQUENCY_COMPENSATION
 0x13C1

	)

8755 
	#SLSI_PSID_UNIFI_TX_OPEN_LOOP_TEMPERATURE_COMPENSATION
 0x13C2

	)

8769 
	#SLSI_PSID_UNIFI_TX_OPEN_LOOP_FREQUENCY_COMPENSATION
 0x13C3

	)

8782 
	#SLSI_PSID_UNIFI_TX_OFDM_SELECT
 0x13C4

	)

8795 
	#SLSI_PSID_UNIFI_TX_DIG_GAIN
 0x13C5

	)

8809 
	#SLSI_PSID_UNIFI_CHIP_TEMPERATURE
 0x13C6

	)

8823 
	#SLSI_PSID_UNIFI_BATTERY_VOLTAGE
 0x13C7

	)

8837 
	#SLSI_PSID_UNIFI_TX_OOB_CONSTRAINTS
 0x13C8

	)

8850 
	#SLSI_PSID_UNIFI_TX_PA_GAIN_DPD_TEMPERATURE_COMPENSATION
 0x13CA

	)

8863 
	#SLSI_PSID_UNIFI_TX_PA_GAIN_DPD_FREQUENCY_COMPENSATION
 0x13CB

	)

8876 
	#SLSI_PSID_UNIFI_TX_POWER_TRIM_CONFIG
 0x13D0

	)

8889 
	#SLSI_PSID_UNIFI_FORCE_SHORT_SLOT_TIME
 0x13D8

	)

8903 
	#SLSI_PSID_UNIFI_TX_GAIN_STEP_SETTINGS
 0x13D9

	)

8916 
	#SLSI_PSID_UNIFI_DEBUG_DISABLE_RADIO_NANNY_ACTIONS
 0x13DA

	)

8930 
	#SLSI_PSID_UNIFI_RX_CCK_MODEM_SENSITIVITY
 0x13DB

	)

8943 
	#SLSI_PSID_UNIFI_DPD_PER_BANDWIDTH
 0x13DC

	)

8956 
	#SLSI_PSID_UNIFI_BB_VERSION
 0x13DD

	)

8969 
	#SLSI_PSID_UNIFI_RF_VERSION
 0x13DE

	)

8984 
	#SLSI_PSID_UNIFI_READ_HARDWARE_COUNTER
 0x13DF

	)

8997 
	#SLSI_PSID_UNIFI_CLEAR_RADIO_TRIM_CACHE
 0x13E0

	)

9010 
	#SLSI_PSID_UNIFI_RADIO_TX_SETTINGS_READ
 0x13E1

	)

9024 
	#SLSI_PSID_UNIFI_MODEM_SGI_OFFSET
 0x13E2

	)

9037 
	#SLSI_PSID_UNIFI_RADIO_TX_POWER_OVERRIDE
 0x13E3

	)

9050 
	#SLSI_PSID_UNIFI_RX_RADIO_CS_MODE
 0x13E4

	)

9063 
	#SLSI_PSID_UNIFI_RX_PRI_ENERGY_DET_THRESHOLD
 0x13E5

	)

9076 
	#SLSI_PSID_UNIFI_RX_SEC_ENERGY_DET_THRESHOLD
 0x13E6

	)

9089 
	#SLSI_PSID_UNIFI_AGC_THRESHOLDS
 0x13E7

	)

9102 
	#SLSI_PSID_UNIFI_RADIO_RX_SETTINGS_READ
 0x13E8

	)

9115 
	#SLSI_PSID_UNIFI_STATIC_DPD_GAIN
 0x13E9

	)

9128 
	#SLSI_PSID_UNIFI_IQ_BUFFER_SIZE
 0x13EA

	)

9142 
	#SLSI_PSID_UNIFI_NARROWBAND_CCA_THRESHOLDS
 0x13EB

	)

9155 
	#SLSI_PSID_UNIFI_RADIO_CCA_DEBUG
 0x13EC

	)

9168 
	#SLSI_PSID_UNIFI_CCACS_THRESH
 0x13ED

	)

9181 
	#SLSI_PSID_UNIFI_CCA_MASTER_SWITCH
 0x13EE

	)

9194 
	#SLSI_PSID_UNIFI_RX_SYNC_CCA_CFG
 0x13EF

	)

9207 
	#SLSI_PSID_UNIFI_MAC_CCA_BUSY_TIME
 0x13F0

	)

9220 
	#SLSI_PSID_UNIFI_MAC_SEC_CHAN_CLEAR_TIME
 0x13F1

	)

9233 
	#SLSI_PSID_UNIFI_DPD_DEBUG
 0x13F2

	)

9246 
	#SLSI_PSID_UNIFI_NARROWBAND_CCA_DEBUG
 0x13F3

	)

9260 
	#SLSI_PSID_UNIFI_NANNY_TEMPERATURE_REPORT_DELTA
 0x13F5

	)

9273 
	#SLSI_PSID_UNIFI_NANNY_TEMPERATURE_REPORT_INTERVAL
 0x13F6

	)

9288 
	#SLSI_PSID_UNIFI_RADIO_RX_DCOC_DEBUG_IQ_VALUE
 0x13F7

	)

9303 
	#SLSI_PSID_UNIFI_RADIO_RX_DCOC_DEBUG
 0x13F8

	)

9317 
	#SLSI_PSID_UNIFI_NANNY_RETRIM_DPD_MOD
 0x13F9

	)

9330 
	#SLSI_PSID_UNIFI_DISABLE_DPD_SUB_ITERATION
 0x13FA

	)

9349 
	#SLSI_PSID_UNIFI_RX_RSSI_ADJUSTMENTS
 0x13FB

	)

9362 
	#SLSI_PSID_UNIFI_FLEXIMAC_CCA_ED_ENABLE
 0x13FC

	)

9375 
	#SLSI_PSID_UNIFI_RADIO_TX_IQ_DELAY
 0x13FD

	)

9392 
	#SLSI_PSID_UNIFI_DISABLE_LNA_BYPASS
 0x13FE

	)

9409 
	#SLSI_PSID_UNIFI_INITIAL_FREQUENCY_OFFSET
 0x13FF

	)

9423 
	#SLSI_PSID_UNIFI_RX_RSSI_NB_HW_GAIN
 0x1400

	)

9437 
	#SLSI_PSID_UNIFI_RX_RSSI_NB_FM_OFFSET
 0x1401

	)

9450 
	#SLSI_PSID_UNIFI_RADIO_TX_SETTINGS_READ_V2
 0x1402

	)

9463 
	#SLSI_PSID_UNIFI_RX_CCK_MODEM_DESENSE
 0x1403

	)

9477 
	#SLSI_PSID_UNIFI_RX_CCK_MODEM_DESENSE_OFFSET
 0x1404

	)

9490 
	#SLSI_PSID_UNIFI_RX_OFDM_MODEM_DESENSE
 0x1405

	)

9504 
	#SLSI_PSID_UNIFI_RX_OFDM_MODEM_DESENSE_OFFSET
 0x1406

	)

9517 
	#SLSI_PSID_UNIFI_RADIO_FEC_CONFIG
 0x1407

	)

9531 
	#SLSI_PSID_UNIFI_TX_POWER_DETECTOR_RESPONSE_FREQUENCY
 0x1408

	)

9547 
	#SLSI_PSID_UNIFI_RADIO_MISC_PER_BAND
 0x1409

	)

9560 
	#SLSI_PSID_UNIFI_NANNY_TRIM_NOW
 0x140A

	)

9573 
	#SLSI_PSID_UNIFI_MAP_RADIO_ID_TO_MAC_ID
 0x140B

	)

9586 
	#SLSI_PSID_UNIFI_REPORT_NARROWBAND_RSSI
 0x140C

	)

9599 
	#SLSI_PSID_UNIFI_ENABLE_FEM_RF_LOOPBACK
 0x140D

	)

9612 
	#SLSI_PSID_UNIFI_RADIO_TRIM_COUNT
 0x140E

	)

9626 
	#SLSI_PSID_UNIFI_RX_RSSI_BAND_COMPENSATION
 0x140F

	)

9639 
	#SLSI_PSID_UNIFI_ENABLE_FREQUENCY_TRACKING
 0x1410

	)

9652 
	#SLSI_PSID_UNIFI_MEDIUM_POWER_MODE_ENABLED
 0x1411

	)

9667 
	#SLSI_PSID_UNIFI_CHIP_TEMPERATURE_DIRECT
 0x1412

	)

9681 
	#SLSI_PSID_UNIFI_ENABLE_FLEXI_MAC_WATCHDOG
 0x1450

	)

9694 
	#SLSI_PSID_UNIFI_RTT_CAPABILITIES
 0x14B4

	)

9707 
	#SLSI_PSID_UNIFI_FTM_MIN_DELTA_FRAMES
 0x14B5

	)

9720 
	#SLSI_PSID_UNIFI_FTM_PER_BURST
 0x14B6

	)

9735 
	#SLSI_PSID_UNIFI_FTM_BURST_DURATION
 0x14B7

	)

9749 
	#SLSI_PSID_UNIFI_FTM_NUM_OF_BURSTS_EXPONENT
 0x14B8

	)

9762 
	#SLSI_PSID_UNIFI_FTM_ASAP_MODE_ACTIVATED
 0x14B9

	)

9775 
	#SLSI_PSID_UNIFI_FTM_RESPONDER_ACTIVATED
 0x14BA

	)

9788 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_SESSION_ESTABLISHMENT_TIMEOUT
 0x14BB

	)

9801 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_GAP_BEFORE_FIRST_BURST_PER_RESPONDER
 0x14BC

	)

9814 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_GAP_BETWEEN_BURSTS
 0x14BD

	)

9828 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_TRIGGER_DELAY
 0x14BE

	)

9842 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_END_BURST_DELAY
 0x14BF

	)

9855 
	#SLSI_PSID_UNIFI_FTM_REQUEST_VALIDATION_ENABLED
 0x14C0

	)

9868 
	#SLSI_PSID_UNIFI_FTM_RESPONSE_VALIDATION_ENABLED
 0x14C1

	)

9881 
	#SLSI_PSID_UNIFI_FTM_USE_RESPONSE_PARAMETERS
 0x14C2

	)

9894 
	#SLSI_PSID_UNIFI_FTM_INITIAL_RESPONSE_TIMEOUT
 0x14C3

	)

9907 
	#SLSI_PSID_UNIFI_FTM_MAC_ADDRESS_RANDOMISATION
 0x14C4

	)

9920 
	#SLSI_PSID_UNIFI_FTM_USE_REQUEST_PARAMETERS
 0x14C9

	)

9933 
	#SLSI_PSID_UNIFI_FTM_MEAN_AROUND_CLUSTER
 0x14CA

	)

9946 
	#SLSI_PSID_UNIFI_FTM11AZ_I2_RLMR_FEEDBACK
 0x14CB

	)

9959 
	#SLSI_PSID_UNIFI_FTM11AZ_SUPPORT
 0x14CC

	)

9973 
	#SLSI_PSID_UNIFI_FTM11AZ_MIN_TIME_BETWEEN_MEASUREMENTS
 0x14CD

	)

9987 
	#SLSI_PSID_UNIFI_FTM11AZ_MAX_TIME_BETWEEN_MEASUREMENTS
 0x14CE

	)

10000 
	#SLSI_PSID_UNIFI_FTM11AZ_TERMINATE_SESSION
 0x14CF

	)

10013 
	#SLSI_PSID_UNIFI_FTM11AZ_FORMAT_BW_RANGING
 0x14D0

	)

10026 
	#SLSI_PSID_UNIFI_FTM11AZ_IMMEDIATE_R2I
 0x14D1

	)

10039 
	#SLSI_PSID_UNIFI_FTM_LEGACY_CALIBRATION
 0x14D5

	)

10052 
	#SLSI_PSID_UNIFI_FTM_HT_VHT_CALIBRATION
 0x14D6

	)

10066 
	#SLSI_PSID_UNIFI_FTM_CHANNEL_ESTIMATE
 0x14D7

	)

10080 
	#SLSI_PSID_UNIFI_SCAN_MAX_CACHE_COUNT
 0x1513

	)

10094 
	#SLSI_PSID_UNIFI_SCAN_MAX_CACHE_TIME
 0x1514

	)

10108 
	#SLSI_PSID_UNIFI_RM_MAX_MEASUREMENT_DURATION
 0x1518

	)

10123 
	#SLSI_PSID_UNIFI_RM_MAX_SCAN_CACHE_TIME
 0x1519

	)

10137 
	#SLSI_PSID_UNIFI_RM_MAX_SCAN_CACHE_COUNT
 0x151A

	)

10150 
	#SLSI_PSID_UNIFI_OBSS_SCAN_START_WAIT
 0x151D

	)

10164 
	#SLSI_PSID_UNIFI_MLME_SCAN_DEFAULT_SHORT_FULL_SCAN_TIME
 0x151E

	)

10177 
	#SLSI_PSID_UNIFI_MLME_SCAN_SHORT_FULL_SCAN_NUM_OF_PROBES
 0x151F

	)

10190 
	#SLSI_PSID_UNIFI_MLME_SCAN_CONTINUE_IF_MORE_THAN_XAPS
 0x1522

	)

10204 
	#SLSI_PSID_UNIFI_MLME_SCAN_STOP_IF_LESS_THAN_XNEW_APS
 0x1523

	)

10217 
	#SLSI_PSID_UNIFI_SCAN_MULTI_VIF_ACTIVATED
 0x1524

	)

10230 
	#SLSI_PSID_UNIFI_SCAN_NEW_ALGORITHM_ACTIVATED
 0x1525

	)

10244 
	#SLSI_PSID_UNIFI_SCAN_REGISTERED_VIF_INFRASTRUCTURE_STA
 0x1526

	)

10258 
	#SLSI_PSID_UNIFI_LNA_CONTROL_EVALUATION_INTERVAL
 0x1778

	)

10273 
	#SLSI_PSID_UNIFI_LNA_CONTROL_RSSI_THRESHOLDS
 0x1779

	)

10286 
	#SLSI_PSID_UNIFI_UNSYNC_VIF_LNA_ENABLED
 0x177A

	)

10302 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER2_GMIMO
 0x177B

	)

10318 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER5_GMIMO
 0x177C

	)

10331 
	#SLSI_PSID_UNIFI_LNA_CONTROL_ENABLED
 0x177D

	)

10344 
	#SLSI_PSID_UNIFI_POWER_IS_GRIP
 0x1780

	)

10359 
	#SLSI_PSID_UNIFI_LOW_POWER_RX_CONFIG
 0x1782

	)

10372 
	#SLSI_PSID_UNIFI_TPC_ENABLED
 0x1783

	)

10386 
	#SLSI_PSID_UNIFI_CURRENT_TXPOWER_LEVEL
 0x1784

	)

10400 
	#SLSI_PSID_UNIFI_USER_SET_TXPOWER_LEVEL
 0x1785

	)

10415 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER_RSSI_THRESHOLD
 0x1786

	)

10430 
	#SLSI_PSID_UNIFI_TPC_MIN_POWER_RSSI_THRESHOLD
 0x1787

	)

10446 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER2G
 0x1788

	)

10462 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER5G
 0x1789

	)

10475 
	#SLSI_PSID_UNIFI_SAR_BACKOFF
 0x178A

	)

10491 
	#SLSI_PSID_UNIFI_TPC_USE_AFTER_CONNECT_RSP
 0x178B

	)

10508 
	#SLSI_PSID_UNIFI_RADIO_LP_RX_RSSI_THRESHOLD_LOWER
 0x178C

	)

10525 
	#SLSI_PSID_UNIFI_RADIO_LP_RX_RSSI_THRESHOLD_UPPER
 0x178D

	)

10538 
	#SLSI_PSID_UNIFI_TEST_TX_POWER_ENABLE
 0x1790

	)

10553 
	#SLSI_PSID_UNIFI_LTE_COEX_MAX_POWER_RSSI_THRESHOLD
 0x1791

	)

10568 
	#SLSI_PSID_UNIFI_LTE_COEX_MIN_POWER_RSSI_THRESHOLD
 0x1792

	)

10583 
	#SLSI_PSID_UNIFI_LTE_COEX_POWER_REDUCTION
 0x1793

	)

10597 
	#SLSI_PSID_UNIFI_PMF_ASSOCIATION_COMEBACK_TIME_DELTA
 0x17A2

	)

10610 
	#SLSI_PSID_UNIFI_TEST_TSPEC_HACK
 0x17AC

	)

10624 
	#SLSI_PSID_UNIFI_TEST_TSPEC_HACK_VALUE
 0x17AD

	)

10638 
	#SLSI_PSID_UNIFI_DEBUG_INSTANT_DELIVERY
 0x17B5

	)

10651 
	#SLSI_PSID_UNIFI_DEBUG_ENABLE
 0x17B7

	)

10667 
	#SLSI_PSID_UNIFI_DPLANE_DEBUG
 0x17B9

	)

10680 
	#SLSI_PSID_UNIFI_NAN_HE_ACTIVATED
 0x17BA

	)

10696 
	#SLSI_PSID_UNIFI_NAN_DEFAULT_EDCA_PARAM
 0x17BB

	)

10711 
	#SLSI_PSID_UNIFI_NAN_ALLOW_CIPHER_SUITE_DOWNGRADE
 0x17BC

	)

10724 
	#SLSI_PSID_UNIFI_NAN_MAX_QUEUED_FOLLOWUPS
 0x17BD

	)

10737 
	#SLSI_PSID_UNIFI_NAN_MAX_SDA_TX_RETRY_COUNT
 0x17BE

	)

10750 
	#SLSI_PSID_UNIFI_NAN_SUPPORTED_CIPHER_SUITES
 0x17BF

	)

10763 
	#SLSI_PSID_UNIFI_NAN_ACTIVATED
 0x17C0

	)

10777 
	#SLSI_PSID_UNIFI_NAN_BEACON_CAPABILITIES
 0x17C1

	)

10790 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_CLUSTERS
 0x17C2

	)

10803 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_PUBLISHES
 0x17C3

	)

10816 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_SUBSCRIBES
 0x17C4

	)

10829 
	#SLSI_PSID_UNIFI_NAN_MAX_SERVICE_NAME_LENGTH
 0x17C5

	)

10842 
	#SLSI_PSID_UNIFI_NAN_MAX_MATCH_FILTER_LENGTH
 0x17C6

	)

10855 
	#SLSI_PSID_UNIFI_NAN_MAX_TOTAL_MATCH_FILTER_LENGTH
 0x17C7

	)

10868 
	#SLSI_PSID_UNIFI_NAN_MAX_SERVICE_SPECIFIC_INFO_LENGTH
 0x17C8

	)

10881 
	#SLSI_PSID_UNIFI_NAN_MAX_EXTENDED_SERVICE_SPECIFIC_INFO_LEN
 0x17C9

	)

10895 
	#SLSI_PSID_UNIFI_NAN_MAX_SUBSCRIBE_INTERFACE_ADDRESSES
 0x17CA

	)

10909 
	#SLSI_PSID_UNIFI_NAN_MAX_NDI_INTERFACES
 0x17CB

	)

10923 
	#SLSI_PSID_UNIFI_NAN_MAX_NDP_SESSIONS
 0x17CC

	)

10936 
	#SLSI_PSID_UNIFI_NAN_MAX_APP_INFO_LENGTH
 0x17CD

	)

10951 
	#SLSI_PSID_UNIFI_NAN_MATCH_EXPIRATION_TIME
 0x17CE

	)

10966 
	#SLSI_PSID_UNIFI_NAN_PERMITTED_CHANNELS
 0x17CF

	)

10980 
	#SLSI_PSID_UNIFI_NAN_DEFAULT_SCAN_PERIOD
 0x17D0

	)

10994 
	#SLSI_PSID_UNIFI_NAN_MAX_CHANNEL_SWITCH_TIME
 0x17D1

	)

11007 
	#SLSI_PSID_UNIFI_NAN_MAC_RANDOMISATION_ACTIVATED
 0x17D2

	)

11025 
	#SLSI_PSID_UNIFI_NAN_DEFAULT_SCHEDULE
 0x17D3

	)

11038 
	#SLSI_PSID_HUTS_READ_WRITE_DATA_ELEMENT_INT32
 0x17D4

	)

11051 
	#SLSI_PSID_HUTS_READ_WRITE_DATA_ELEMENT_BOOLEAN
 0x17D5

	)

11065 
	#SLSI_PSID_HUTS_READ_WRITE_DATA_ELEMENT_OCTET_STRING
 0x17D6

	)

11079 
	#SLSI_PSID_HUTS_READ_WRITE_TABLE_INT16_ROW
 0x17D7

	)

11093 
	#SLSI_PSID_HUTS_READ_WRITE_TABLE_OCTET_STRING_ROW
 0x17D8

	)

11107 
	#SLSI_PSID_HUTS_READ_WRITE_REMOTE_PROCEDURE_CALL_INT32
 0x17D9

	)

11121 
	#SLSI_PSID_HUTS_READ_WRITE_REMOTE_PROCEDURE_CALL_OCTET_STRING
 0x17DB

	)

11135 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_INT16
 0x17DC

	)

11149 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_UINT16
 0x17DD

	)

11164 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_UINT32
 0x17DE

	)

11178 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_INT64
 0x17DF

	)

11192 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_BOOLEAN
 0x17E0

	)

11206 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_OCTET_STRING
 0x17E1

	)

11220 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIXED_SIZE_TABLE_ROW
 0x17E2

	)

11234 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_VAR_SIZE_TABLE_ROW
 0x17E3

	)

11248 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_SIZE_TABLE_KEY1_ROW
 0x17E4

	)

11262 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_SIZE_TABLE_KEY2_ROW
 0x17E5

	)

11275 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_VAR_SIZE_TABLE_KEY1_ROW
 0x17E6

	)

11288 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_VAR_SIZE_TABLE_KEY2_ROW
 0x17E7

	)

11301 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_SIZE_TABLE_KEY_ROW
 0x17E8

	)

11314 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_VAR_SIZE_TABLE_KEY_ROW
 0x17E9

	)

11327 
	#SLSI_PSID_UNIFI_TEST_SCAN_NO_MEDIUM
 0x17EA

	)

11342 
	#SLSI_PSID_UNIFI_DUAL_BAND_CONCURRENCY
 0x17EB

	)

11355 
	#SLSI_PSID_UNIFI_LOGGER_MAX_DELAYED_EVENTS
 0x17EC

	)

11368 
	#SLSI_PSID_UNIFI_NAN_SKIP_NAN_CHANNELS_IF_NDL_EXISTS
 0x17ED

	)

11384 
	#SLSI_PSID_UNIFI_NAN_KEEP_ALIVE_TIMEOUT
 0x17FC

	)

11400 
	#SLSI_PSID_UNIFI_NAN_KEEP_ALIVE_TIMEOUT_CHECK
 0x17FD

	)

11415 
	#SLSI_PSID_UNIFI_NAN_DATA_PATH_TRAFFIC_TIMEOUT
 0x17FE

	)

11429 
	#SLSI_PSID_UNIFI_NAN_DATA_PATH_SETUP_TIMEOUT
 0x17FF

	)

11444 
	#SLSI_PSID_UNIFI_NAN_WARMUP_TIMEOUT
 0x1800

	)

11460 
	#SLSI_PSID_UNIFI_NAN_MULTI_VIF_SHARED_SLOTS
 0x1802

	)

11473 
	#SLSI_PSID_UNIFI_ROAMING_IN_NDL_ACTIVATED
 0x1803

	)

11487 
	#SLSI_PSID_UNIFI_NAN_MULTI_BAND_NDL_PERMITTED
 0x1804

	)

11501 
	#SLSI_PSID_UNIFI_LOGGER_NAN_TRAFFIC_REPORT_PERIOD
 0x1805

	)

11514 
	#SLSI_PSID_UNIFI_NAN_ULW_TEST
 0x1806

	)

11531 
	#SLSI_PSID_UNIFI_NAN_DISCOVERY_BEACON_CONFIG
 0x1807

	)

11545 
	#SLSI_PSID_UNIFI_NAN_FORCE_WIDEST_BANDWIDTH
 0x1808

	)

11559 
	#SLSI_PSID_UNIFI_NAN_SCAN_BO_REPEAT_COUNT
 0x1809

	)

11573 
	#SLSI_PSID_UNIFI_NAN_BLACKOUT_FAW_REDUCTION_ACTIVATED
 0x180A

	)

11586 
	#SLSI_PSID_UNIFI_NAN_RANGING_ACTIVATED
 0x180B

	)

11599 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_RANGING_AS_INITIATOR
 0x180C

	)

11612 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_RANGING_AS_RESPONDER
 0x180D

	)

11626 
	#SLSI_PSID_UNIFI_NAN_RANGING_SETUP_TIMEOUT
 0x180E

	)

11642 
	#SLSI_PSID_UNIFI_NAN_MAX_RANGING_RETRY_COUNT
 0x180F

	)

11657 
	#SLSI_PSID_UNIFI_NAN_TEST_RANGING_DISTANCE
 0x1810

	)

11672 
	#SLSI_PSID_UNIFI_NANSDF_TRANSMISSION_OUTSIDE_DW_PERMITTED
 0x1811

	)

11686 
	#SLSI_PSID_UNIFI_NAN_DEVICE_LINK_SETUP_TIMEOUT
 0x1812

	)

11701 
	#SLSI_PSID_UNIFI_NAN_DEVICE_LINK_SCHEDULE_UPDATE_RETRY_INTERVAL
 0x1813

	)

11715 
	#SLSI_PSID_UNIFI_NAN_MULTI_VIF_DUAL_BAND_CONCURRENCY_PERMITTED
 0x1814

	)

11729 
	#SLSI_PSID_UNIFI_NAN_MAX_NAF_TX_RETRY_COUNT
 0x1815

	)

11744 
	#SLSI_PSID_UNIFI_NAN_TEST_MASTER_PREFERENCE
 0x181A

	)

11757 
	#SLSI_PSID_UNIFI_REGULATORY_PARAMETERS
 0x1F4B

	)

11772 
	#SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
 0x1F4C

	)

11785 
	#SLSI_PSID_UNIFI_DEFAULT_COUNTRY
 0x1F4D

	)

11801 
	#SLSI_PSID_UNIFI_COUNTRY_LIST
 0x1F4E

	)

11814 
	#SLSI_PSID_UNIFI_OPERATING_CLASS_PARAMTERS
 0x1F4F

	)

11827 
	#SLSI_PSID_UNIFI_VIF_COUNTRY
 0x1F50

	)

11840 
	#SLSI_PSID_UNIFI_NO_CELL_MAX_POWER
 0x1F51

	)

11855 
	#SLSI_PSID_UNIFI_NO_CELL_INCLUDED_CHANNELS
 0x1F52

	)

11869 
	#SLSI_PSID_UNIFI_REG_DOM_VERSION
 0x1F53

	)

11882 
	#SLSI_PSID_UNIFI_DEFAULT_COUNTRY_WITHOUT_CH12_CH13
 0x1F54

	)

11895 
	#SLSI_PSID_UNIFI_READ_REG
 0x1F73

	)

11898 
	#SLSI_PSID_UNIFI_MISC_FEATURES_ACTIVATED
 2880

	)

11899 
	#SLSI_PSID_UNIFI_QSFS_VERION
 2391

	)

11900 
	#SLSI_PSID_UNIFI_APPENDIX_VERSIONS
 2881

	)

11902 #ifdeà
__ılu¥lus


	@mib_text_convert.c

8 
	~"debug.h
"

9 
	~"mib_‹xt_cÚv”t.h
"

11 
	#CSR_TOUPPER
(
ch¬aù”
è(((ch¬aù”è>ğ'a'è&& ((ch¬aù”è<ğ'z'è? ((ch¬aù”è- 0x20è: (ch¬aù”))

	)

13 
šlše
 
boŞ
 
	$C¤IsS·û
(
u8
 
c
)

15 
c
) {

21  
Œue
;

23  
çl£
;

25 
	}
}

27 
šlše
 *
	$C¤SŒDup
(cÚ¡ *
¡ršg
)

29 ià(
¡ršg
) {

30 
u32
 
Ën
 = 
	`¡¾’
(
¡ršg
) + 1;

31 *
»suÉ
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

33 ià(
»suÉ
)

34  
	`memıy
(
»suÉ
, 
¡ršg
, 
Ën
);

36  
NULL
;

37 
	}
}

39 
	$C¤SŒNICmp
(cÚ¡ *
¡ršg1
,

40 cÚ¡ *
¡ršg2
,

41 
size_t
 
couÁ
)

43 
u32
 
šdex
;

44 
»tuºV®ue
 = 0;

46 
šdex
 = 0; index < 
couÁ
; index++) {

47 ià(
	`CSR_TOUPPER
(
¡ršg1
[
šdex
]è!ğCSR_TOUPPER(
¡ršg2
[index])) {

48 ià(
	`CSR_TOUPPER
(
¡ršg1
[
šdex
]è> CSR_TOUPPER(
¡ršg2
[index]))

49 
»tuºV®ue
 = 1;

51 
»tuºV®ue
 = -1;

54 ià(
¡ršg1
[
šdex
] == '\0')

57  
»tuºV®ue
;

58 
	}
}

60 
boŞ
 
	$C¤HexSŒToUšt8
(cÚ¡ *
¡ršg
, 
u8
 *
»tuºV®ue
)

62 
u16
 
cu¼’tIndex
 = 0;

64 *
»tuºV®ue
 = 0;

65 ià((
¡ršg
[
cu¼’tIndex
] =ğ'0'è&& (
	`CSR_TOUPPER
(string[currentIndex + 1]) == 'X'))

66 
¡ršg
 += 2;

67 ià(((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

68 ((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

69 *
»tuºV®ue
 = (
u8
)(*»tuºV®u* 16 + (((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è? sŒšg[cu¼’tIndex] - '0' : 
	`CSR_TOUPPER
(string[currentIndex]) - 'A' + 10));

70 
cu¼’tIndex
++;

71 ià(
cu¼’tIndex
 >= 2)

74  
Œue
;

76  
çl£
;

77 
	}
}

79 
boŞ
 
	$C¤HexSŒToUšt16
(cÚ¡ *
¡ršg
, 
u16
 *
»tuºV®ue
)

81 
u16
 
cu¼’tIndex
 = 0;

83 *
»tuºV®ue
 = 0;

84 ià((
¡ršg
[
cu¼’tIndex
] =ğ'0'è&& (
	`CSR_TOUPPER
(string[currentIndex + 1]) == 'X'))

85 
¡ršg
 += 2;

86 ià(((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

87 ((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

88 *
»tuºV®ue
 = (
u16
)(*»tuºV®u* 16 + (((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è? sŒšg[cu¼’tIndex] - '0' : 
	`CSR_TOUPPER
(string[currentIndex]) - 'A' + 10));

89 
cu¼’tIndex
++;

90 ià(
cu¼’tIndex
 >= 4)

93  
Œue
;

95  
çl£
;

96 
	}
}

98 
boŞ
 
	$C¤HexSŒToUšt32
(cÚ¡ *
¡ršg
, 
u32
 *
»tuºV®ue
)

100 
u16
 
cu¼’tIndex
 = 0;

102 *
»tuºV®ue
 = 0;

103 ià((
¡ršg
[
cu¼’tIndex
] =ğ'0'è&& (
	`CSR_TOUPPER
(string[currentIndex + 1]) == 'X'))

104 
¡ršg
 += 2;

105 ià(((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

106 ((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

107 *
»tuºV®ue
 = *»tuºV®u* 16 + (((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è? sŒšg[cu¼’tIndex] - '0' : 
	`CSR_TOUPPER
(string[currentIndex]) - 'A' + 10);

108 
cu¼’tIndex
++;

109 ià(
cu¼’tIndex
 >= 8)

112  
Œue
;

114  
çl£
;

115 
	}
}

117 
boŞ
 
	$C¤WifiMibCÚv”tSŒToUšt16
(cÚ¡ *
¡r
, 
u16
 *
»tuºV®ue
)

119 
u16
 
cu¼’tIndex
 = 0;

121 ià(
¡r
[1] == 'x')

122  
	`C¤HexSŒToUšt16
(
¡r
, 
»tuºV®ue
);

124 *
»tuºV®ue
 = 0;

125 ià((
¡r
[
cu¼’tIndex
] >= '0') && (str[currentIndex] <= '9')) {

126 
¡r
[
cu¼’tIndex
] >= '0' && str[currentIndex] <= '9') {

127 *
»tuºV®ue
 *= 10;

128 *
»tuºV®ue
 +ğ(
u8
)
¡r
[
cu¼’tIndex
++] - '0';

130  
Œue
;

132  
çl£
;

133 
	}
}

135 
boŞ
 
	$C¤WifiMibCÚv”tSŒToUšt32
(cÚ¡ *
¡r
, 
u32
 *
»tuºV®ue
)

137 
u16
 
cu¼’tIndex
 = 0;

139 ià(
¡r
[1] == 'x')

140  
	`C¤HexSŒToUšt32
(
¡r
, 
»tuºV®ue
);

142 *
»tuºV®ue
 = 0;

143 ià((
¡r
[
cu¼’tIndex
] >= '0') && (str[currentIndex] <= '9')) {

144 
¡r
[
cu¼’tIndex
] >= '0' && str[currentIndex] <= '9') {

145 *
»tuºV®ue
 *= 10;

146 *
»tuºV®ue
 +ğ(
u8
)
¡r
[
cu¼’tIndex
++] - '0';

148  
Œue
;

150  
çl£
;

151 
	}
}

153 
boŞ
 
	$C¤WifiMibCÚv”tTextP¬£Lše
(cÚ¡ *
lše¡r
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
)

155 
¦si_mib_’Œy
 
’Œy
;

156 
boŞ
 
»suÉ
 = 
Œue
;

157 
size_t
 
equ®s
 = 0;

158 
size_t
 
dÙ1
 = 0;

159 
size_t
 
dÙ2
 = 0;

160 
size_t
 
ŒimmedIndex
 = 0;

161 *
Œimmed
 = 
	`km®loc
(
	`¡¾’
(
lše¡r
è+ 1, 
GFP_KERNEL
);

162 cÚ¡ *
cu¼’t_ch¬
 = 
lše¡r
;

163 
boŞ
 
´oûssšgSŒ
 = 
çl£
;

165 ià(!
Œimmed
) {

166 
	`SLSI_ERR_NODEV
("Memory‡llocation failed!\n");

167  
çl£
;

169 
	`mem£t
(&
’Œy
, 0x00, (entry));

170 
cu¼’t_ch¬
[0] != '\0') {

171 ià(
cu¼’t_ch¬
[0] == '"')

172 
´oûssšgSŒ
 = !processingStr;

173 ià(!
´oûssšgSŒ
) {

174 ià(
cu¼’t_ch¬
[0] == '#')

176 ià(
	`C¤IsS·û
((
u8
)
cu¼’t_ch¬
[0])) {

177 
cu¼’t_ch¬
++;

180 ià(!
equ®s
 && (
cu¼’t_ch¬
[0] == '.')) {

181 ià(!
dÙ1
) {

182 
dÙ1
 = 
ŒimmedIndex
;

183 } ià(!
dÙ2
) {

184 
dÙ2
 = 
ŒimmedIndex
;

186 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èÚly 2 indexe suµÜ‹d", 
Œimmed
);

187 
»suÉ
 = 
çl£
;

190 ià(!
equ®s
 && (
cu¼’t_ch¬
[0] == '='))

191 
equ®s
 = 
ŒimmedIndex
;

193 
Œimmed
[
ŒimmedIndex
++] = 
cu¼’t_ch¬
[0];

195 
cu¼’t_ch¬
++;

197 
Œimmed
[
ŒimmedIndex
] = '\0';

199 ià(
	`¡¾’
(
Œimmed
) == 0) {

200 
	`kä“
(
Œimmed
);

201  
»suÉ
;

204 ià(
»suÉ
) {

205 
£p
 = 
Œimmed
[
dÙ1
 ? dÙ1 : 
equ®s
];

207 ià(
dÙ1
 || 
equ®s
)

208 
Œimmed
[
dÙ1
 ? dÙ1 : 
equ®s
] = '\0';

209 
Œimmed
[
dÙ1
 ? dÙ1 : 
equ®s
] = 
£p
;

211 ià(!
	`C¤WifiMibCÚv”tSŒToUšt16
(
Œimmed
, &
’Œy
.
psid
)) {

212 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆ<psid> faed", 
Œimmed
);

213 
»suÉ
 = 
çl£
;

215 ià(
dÙ1
 && !
	`C¤WifiMibCÚv”tSŒToUšt16
(&
Œimmed
[dÙ1 + 1], &
’Œy
.
šdex
[0])) {

216 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆ<šdex 1> faed", 
Œimmed
);

217 
»suÉ
 = 
çl£
;

219 ià(
dÙ2
 && !
	`C¤WifiMibCÚv”tSŒToUšt16
(&
Œimmed
[dÙ2 + 1], &
’Œy
.
šdex
[1])) {

220 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆ<šdex 2> faed", 
Œimmed
);

221 
»suÉ
 = 
çl£
;

224 ià(
»suÉ
 && !
equ®s
 && 
mibD©aG‘
) {

225 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_NONE
;

226 ()
	`¦si_mib_’code
(
mibD©aG‘
, &
’Œy
);

229 ià(
»suÉ
 && 
equ®s
 && 
mibD©aS‘
) {

230 *
d©a
 = &
Œimmed
[
equ®s
 + 1];

232 ià(
	`C¤SŒNICmp
(
d©a
, "true", 4) == 0) {

233 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_BOOL
;

234 
’Œy
.
v®ue
.
u
.
boŞV®ue
 = 1;

235 } ià(
	`C¤SŒNICmp
(
d©a
, "false", 5) == 0) {

236 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_BOOL
;

237 
’Œy
.
v®ue
.
u
.
boŞV®ue
 = 0;

238 } ià(
d©a
[0] == '"') {

240 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_OCTET
;

241 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
 = (
u32
)
	`¡¾’
(&
d©a
[1]);

242 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
 = (
u8
 *)
	`C¤SŒDup
(&data[1]);

243 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
[’Œy.v®ue.u.où‘V®ue.
d©aL’gth
 - 1] = '\0';

244 } ià(
d©a
[0] == '[') {

246 
size_t
 
i
;

247 
u16
 
où‘L’
 = ((u16)
	`¡¾’
(&
d©a
[1]) - 1) / 2;

249 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_OCTET
;

250 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
 = 
où‘L’
;

251 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
 = 
	`km®loc
ÓÁry.v®ue.u.où‘V®ue.
d©aL’gth
 + 1, 
GFP_KERNEL
);

252 ià(!
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
) {

253 
	`SLSI_ERR_NODEV
("Memory‡llocation failed!\n");

254 
	`kä“
(
Œimmed
);

255  
çl£
;

257 
i
 = 0; i < 
où‘L’
; i++)

258 ià(!
	`C¤HexSŒToUšt8
(&
d©a
[1 + (
i
 * 2)], &
’Œy
.
v®ue
.
u
.
où‘V®ue
.data[i])) {

259 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆHex By‹ <d©a> faed", 
Œimmed
);

260 
»suÉ
 = 
çl£
;

263 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
[
où‘L’
] = '\0';

264 } ià(
d©a
[0] == '-') {

266 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_INT
;

267 ià(!
	`C¤WifiMibCÚv”tSŒToUšt32
(&
d©a
[1], &
’Œy
.
v®ue
.
u
.
uštV®ue
)) {

268 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆIÁeg” <d©a> faed", 
Œimmed
);

269 
»suÉ
 = 
çl£
;

271 
’Œy
.
v®ue
.
u
.
štV®ue
 = (
s32
)(0 - (
u32
ëÁry.v®ue.u.
uštV®ue
);

273 } ià(!
	`C¤WifiMibCÚv”tSŒToUšt32
(
d©a
, &
’Œy
.
v®ue
.
u
.
uštV®ue
)) {

274 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆUnsigÃd IÁeg” <d©a> faed", 
Œimmed
);

275 
»suÉ
 = 
çl£
;

277 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_UINT
;

279 ià(
»suÉ
)

280 ()
	`¦si_mib_’code
(
mibD©aS‘
, &
’Œy
);

281 ià(
’Œy
.
v®ue
.
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
)

282 
	`kä“
(
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
);

286 
	`kä“
(
Œimmed
);

288  
»suÉ
;

289 
	}
}

291 
boŞ
 
	$C¤WifiMibCÚv”tTextAµ’d
(cÚ¡ *
mibText
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
)

293 
boŞ
 
»suÉ
 = 
Œue
;

294 cÚ¡ *
lšeS¹
 = 
mibText
;

295 cÚ¡ *
lšeEnd
 = 
mibText
;

297 ià(!
mibText
)

298  
çl£
;

300 
lšeEnd
[0] != '\0') {

301 ià((
lšeEnd
[0] == '\n') || (lineEnd[0] == '\r') || (lineEnd[1] == '\0')) {

302 
size_t
 
¡rSize
 = (size_t)(
lšeEnd
 - 
lšeS¹
);

304 ià((
lšeEnd
[1] == '\0'))

305 
¡rSize
++;

306 ià(
¡rSize
 > 2) {

307 *
lše
 = 
	`km®loc
(
¡rSize
 + 1, 
GFP_KERNEL
);

309 ià(!
lše
) {

310 
	`SLSI_ERR_NODEV
("MemÜy‡ÎoÿtiÚ faed!\n", 
lše
);

311  
çl£
;

313 ()
	`¡ºıy
(
lše
, 
lšeS¹
, 
¡rSize
);

314 
lše
[
¡rSize
] = '\0';

315 ià(!
	`C¤WifiMibCÚv”tTextP¬£Lše
(
lše
, 
mibD©aS‘
, 
mibD©aG‘
)) {

316 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše(èFaed fÜ†š'%s'", 
lše
);

317 
»suÉ
 = 
çl£
;

319 
	`kä“
(
lše
);

321 
lšeEnd
++;

322 
lšeS¹
 = 
lšeEnd
;

325 
lšeEnd
++;

328  
»suÉ
;

329 
	}
}

331 
boŞ
 
	$C¤WifiMibCÚv”tText
(cÚ¡ *
mibText
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
)

333 ià(
mibD©aS‘
) {

334 
mibD©aS‘
->
d©a
 = 
NULL
;

335 
mibD©aS‘
->
d©aL’gth
 = 0;

337 ià(
mibD©aG‘
) {

338 
mibD©aG‘
->
d©a
 = 
NULL
;

339 
mibD©aG‘
->
d©aL’gth
 = 0;

342  
	`C¤WifiMibCÚv”tTextAµ’d
(
mibText
, 
mibD©aS‘
, 
mibD©aG‘
);

343 
	}
}

	@mib_text_convert.h

8 #iâdeà
MIB_TEXT_CONVERT_H__


9 
	#MIB_TEXT_CONVERT_H__


	)

11 
	~"mib.h
"

44 
boŞ
 
C¤WifiMibCÚv”tText
(cÚ¡ *
mibText
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
);

	@mlme.c

7 
	~<lšux/d–ay.h
>

8 
	~<Ãt/cfg80211.h
>

9 
	~<lšux/moduË.h
>

10 
	~<lšux/moduË·¿m.h
>

11 
	~<scsc/scsc_log_cŞËùÜ.h
>

12 
	~<scsc/scsc_w¬n.h
>

14 
	~"dev.h
"

15 
	~"debug.h
"

16 
	~"mlme.h
"

17 
	~"mib.h
"

18 
	~"mgt.h
"

19 
	~"ÿc.h
"

21 
	#SLSI_NOA_CONFIG_REQUEST_ID
 (1)

	)

22 
	#SLSI_MLME_ARP_DROP_FREE_SLOTS_COUNT
 16

	)

24 
boŞ
 
	gmissšg_cfm_šd_·nic
 = 
Œue
;

25 
moduË_·¿m
(
missšg_cfm_šd_·nic
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

26 
MODULE_PARM_DESC
(
missšg_cfm_šd_·nic
, "Panic on missing confirm or indication fromhe chip");

28 
	s¦si_mlme_rs£
 {

29 
u8
 
	mgroup_cs_couÁ
;

30 cÚ¡ 
u8
 *
	mgroup_cs
;

31 
u8
 
	m·œwi£_cs_couÁ
;

32 cÚ¡ 
u8
 *
	m·œwi£_cs
;

33 
u8
 
	makm_su™e_couÁ
;

34 cÚ¡ 
u8
 *
	makm_su™e
;

35 
u8
 
	mpmkid_couÁ
;

36 cÚ¡ 
u8
 *
	mpmkid
;

37 cÚ¡ 
u8
 *
	mgroup_mgmt_cs
;

40 
sk_buff
 *
	$¦si_mlme_wa™_fÜ_cfm
(
¦si_dev
 *
sdev
, 
¦si_sig_£nd
 *
sig_wa™
)

42 
sk_buff
 *
cfm
 = 
NULL
;

43 
tm
;

44 
r
;

45 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

47 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


48 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
 - (*sdev->sig_wait_cfm_timeout >> 2)));

49 ià(
tm
 == 0) {

50 
	`SLSI_ERR
(
sdev
, "Wa™šg cfm(0x%.4XèfÜ„eq(0x%04Xè£nd”id=0x%x,ryšgØscheduË wq mªu®ly\n", 
sig_wa™
->
cfm_id
, sig_wa™->
»q_id
, sig_wa™->
´oûss_id
);

51 
	`¦si_h_»´oûss_sk³d_ù¾_bh
(
sdev
);

52 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
 >> 2));

55 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
));

58 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

61 ià(!
sig_wa™
->
cfm
) {

62 
	`SLSI_ERR
(
sdev
, "NØcfm(0x%.4XèfÜ„eq(0x%04Xè£nd”id=0x%x\n", 
sig_wa™
->
cfm_id
, sig_wa™->
»q_id
, sig_wa™->
´oûss_id
);

63 ià(
tm
 == 0) {

64 
»asÚ
[80];

66 
	`WARN
(1, "Timeouˆ- cÚfœm 0x%04x‚Ù„eûived from ch\n", 
sig_wa™
->
cfm_id
);

67 ià(
missšg_cfm_šd_·nic
) {

68 
	`¢´štf
(
»asÚ
, (reason), "Timed out while waiting forhe cfm(0x%.4x) for„eq(0x%04x)",

69 
sig_wa™
->
cfm_id
, sig_wa™->
»q_id
);

71 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

73 
sdev
->
mlme_blocked
 = 
Œue
;

74 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
Œigg”_wÏn_ç_wÜk
);

75 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
,

76 
	`m£cs_to_jiff›s
(
SLSI_WLAN_FAIL_WORK_TIMEOUT
));

77 ià(
r
 == 0) {

78 
	`SLSI_INFO
(
sdev
, "service_fail_started_indicationimeout\n");

79 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "service_fail_started_indicationimeout in cfm\n");

80 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

83 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

86 
	`WARN
(1, "CÚfœm 0x%04x†o¡\n", 
sig_wa™
->
cfm_id
);

89 
	`WARN_ON
(
	`çpi_g‘_u16
(
sig_wa™
->
cfm
, 
»ûiv”_pid
è!ğsig_wa™->
´oûss_id
);

90 
	`WARN_ON
(
	`çpi_g‘_u16
(
sig_wa™
->
cfm
, 
id
è!ğsig_wa™->
cfm_id
);

93 
sig_wa™
->
cfm_id
 = 0;

94 
cfm
 = 
sig_wa™
->cfm;

95 
sig_wa™
->
cfm
 = 
NULL
;

96 ià(!
cfm
)

97 
sig_wa™
->
šd_id
 = 0;

99 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

101  
cfm
;

102 
	}
}

104 
	$·nic_Ú_lo¡_šd
(
u16
 
šd_id
)

106 ià(
šd_id
 =ğ
MLME_SCAN_DONE_IND
 || ind_id =ğ
MLME_NAN_EVENT_IND
)

109 
	}
}

111 
sk_buff
 *
	$¦si_mlme_wa™_fÜ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_sig_£nd
 *
sig_wa™
, 
u16
 
šd_id
)

113 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

114 
sk_buff
 *
šd
 = 
NULL
;

115 
tm
 = 0;

116 
r
 = 0;

117 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

125 ià(
šd_id
 =ğ
MLME_SCAN_DONE_IND
)

127 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(
SLSI_SCAN_DONE_IND_WAIT_TIMEOUT
));

128 ià((
šd_id
 =ğ
MLME_DISCONNECTED_IND
è&& (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
))

129 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
));

130 ià(
šd_id
 =ğ
MLME_NAN_EVENT_IND
)

131 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(
SLSI_NAN_START_TIMEOUT
));

133 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
));

135 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

138 ià(!
sig_wa™
->
šd
) {

139 
	`SLSI_ERR
(
sdev
, "NØšd(0x%.4XèfÜ„eq(0x%04Xè£nd”id=0x%x\n", 
sig_wa™
->
šd_id
, sig_wa™->
»q_id
, sig_wa™->
´oûss_id
);

140 ià(
tm
 == 0) {

141 
»asÚ
[80];

143 
	`WARN
(1, "Timeouˆ- indiÿtiÚ 0x%04x‚Ù„eûived from ch\n", 
sig_wa™
->
šd_id
);

144 ià(
missšg_cfm_šd_·nic
 && 
	`·nic_Ú_lo¡_šd
(
šd_id
)) {

145 
	`¢´štf
(
»asÚ
, (reason), "Timed out while waiting forhe ind(0x%.4x) for„eq(0x%04x)",

146 
sig_wa™
->
šd_id
, sig_wa™->
»q_id
);

148 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

150 
sdev
->
mlme_blocked
 = 
Œue
;

151 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
Œigg”_wÏn_ç_wÜk
);

152 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
,

153 
	`m£cs_to_jiff›s
(
SLSI_WLAN_FAIL_WORK_TIMEOUT
));

154 ià(
r
 == 0) {

155 
	`SLSI_INFO
(
sdev
, "service_fail_started_indicationimeout\n");

156 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "service_fail_started_indicationimeout in ind\n");

157 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

159 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

162 
	`WARN
(1, "IndiÿtiÚ 0x%04x†o¡\n", 
sig_wa™
->
šd_id
);

165 
	`WARN_ON
(
	`çpi_g‘_u16
(
sig_wa™
->
šd
, 
»ûiv”_pid
è!ğsig_wa™->
´oûss_id
);

168 
sig_wa™
->
šd_id
 = 0;

169 
šd
 = 
sig_wa™
->ind;

170 
sig_wa™
->
šd
 = 
NULL
;

172 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

174  
šd
;

175 
	}
}

182 
sk_buff
 *
	$¦si_mlme_tx_rx
(
¦si_dev
 *
sdev
,

183 
Ãt_deviû
 *
dev
,

184 
sk_buff
 *
skb
,

185 
u16
 
cfm_id
,

186 
sk_buff
 **
mib_”rÜ
,

187 
u16
 
šd_id
,

188 
	$boŞ
 (*
v®id©e_cfm_wa™_šd
)(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
))

190 
sk_buff
 *
rx
 = 
NULL
;

191 
”r
;

192 
u16
 
»q_id
 = 
	`çpi_g‘_u16
(
skb
, 
id
);

193 
¦si_sig_£nd
 *
sig_wa™
 = &
sdev
->sig_wait;

195 ià(
dev
) {

196 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

198 
sig_wa™
 = &
ndev_vif
->sig_wait;

200 #ifdeà
SLSI_TEST_DEV


201 ià(
sdev
->
mlme_blocked
) {

202 
	`SLSI_DBG3
(
sdev
, 
SLSI_TX
, "Rejeùed. mlme_blocked=%d\n", sdev->
mlme_blocked
);

203 
	`kä“_skb
(
skb
);

204  
NULL
;

207 ià(
sdev
->
mlme_blocked
 || !sdev->
wÏn_£rviû_Ú
) {

208 
	`SLSI_DBG3
(
sdev
, 
SLSI_TX
, "Rejeùed. mlme_blocked=%d, wÏn_£rviû_Ú=%d\n", sdev->
mlme_blocked
,

209 
sdev
->
wÏn_£rviû_Ú
);

210 
	`kä“_skb
(
skb
);

211  
NULL
;

215 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

216 
	`SLSI_MUTEX_LOCK
(
sig_wa™
->
mu‹x
);

218 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

219 ià(++
sig_wa™
->
´oûss_id
 > 
SLSI_TX_PROCESS_ID_MAX
)

220 
sig_wa™
->
´oûss_id
 = 
SLSI_TX_PROCESS_ID_MIN
;

222 
	`WARN_ON
(
sig_wa™
->
cfm
);

223 
	`WARN_ON
(
sig_wa™
->
šd
);

224 
	`kä“_skb
(
sig_wa™
->
cfm
);

225 
	`kä“_skb
(
sig_wa™
->
šd
);

226 
	`kä“_skb
(
sig_wa™
->
mib_”rÜ
);

227 
sig_wa™
->
cfm
 = 
NULL
;

228 
sig_wa™
->
šd
 = 
NULL
;

229 
sig_wa™
->
mib_”rÜ
 = 
NULL
;

230 
sig_wa™
->
»q_id
 =„eq_id;

231 
sig_wa™
->
cfm_id
 = cfm_id;

232 
sig_wa™
->
šd_id
 = ind_id;

234 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
sig_wa™
->
´oûss_id
);

235 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

237 
”r
 = 
	`¦si_tx_cÚŒŞ
(
sdev
, 
dev
, 
skb
);

238 ià(
”r
 != 0) {

239 
	`SLSI_ERR
(
sdev
, "FaedØ£nd mlmsigÇl:0x%.4X,ƒ¼=%d\n", 
»q_id
, 
”r
);

240 
	`kä“_skb
(
skb
);

241 
ş—n_ex™
;

244 ià(
cfm_id
) {

245 
rx
 = 
	`¦si_mlme_wa™_fÜ_cfm
(
sdev
, 
sig_wa™
);

246 ià(
rx
 && 
šd_id
) {

248 ià(
	`v®id©e_cfm_wa™_šd
(
sdev
, 
dev
, 
rx
)) {

249 
rx
 = 
	`¦si_mlme_wa™_fÜ_šd
(
sdev
, 
dev
, 
sig_wa™
, 
šd_id
);

251 
sig_wa™
->
šd_id
 = 0;

252 
rx
 = 
NULL
;

255 } ià(
šd_id
) {

256 
rx
 = 
	`¦si_mlme_wa™_fÜ_šd
(
sdev
, 
dev
, 
sig_wa™
, 
šd_id
);

260 
	`WARN_ON
(
sig_wa™
->
cfm_id
);

261 
	`WARN_ON
(
sig_wa™
->
šd_id
);

262 
	`WARN_ON
(
sig_wa™
->
cfm
);

263 
	`WARN_ON
(
sig_wa™
->
šd
);

264 
ş—n_ex™
:

266 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

268 
sig_wa™
->
»q_id
 = 0;

269 
sig_wa™
->
cfm_id
 = 0;

270 
sig_wa™
->
šd_id
 = 0;

271 
	`kä“_skb
(
sig_wa™
->
cfm
);

272 
	`kä“_skb
(
sig_wa™
->
šd
);

273 
sig_wa™
->
cfm
 = 
NULL
;

274 
sig_wa™
->
šd
 = 
NULL
;

276 ià(
mib_”rÜ
)

277 *
mib_”rÜ
 = 
sig_wa™
->mib_error;

279 
	`kä“_skb
(
sig_wa™
->
mib_”rÜ
);

280 
sig_wa™
->
mib_”rÜ
 = 
NULL
;

281 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

283 
	`SLSI_MUTEX_UNLOCK
(
sig_wa™
->
mu‹x
);

285 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

286  
rx
;

287 
	}
}

292 
	$¦si_mlme_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

294 
»t
 = 0;

295 
¦si_sig_£nd
 *
sig_wa™
 = &
sdev
->sig_wait;

297 ià(
dev
) {

298 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

300 
sig_wa™
 = &
ndev_vif
->sig_wait;

302 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

303 ià(++
sig_wa™
->
´oûss_id
 > 
SLSI_TX_PROCESS_ID_MAX
)

304 
sig_wa™
->
´oûss_id
 = 
SLSI_TX_PROCESS_ID_MIN
;

305 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
sig_wa™
->
´oûss_id
);

306 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

308 
»t
 = 
	`¦si_tx_cÚŒŞ
(
sdev
, 
dev
, 
skb
);

309 ià(
»t
)

310 
	`kä“_skb
(
skb
);

311  
»t
;

312 
	}
}

314 
sk_buff
 *
	$¦si_mlme_»q_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
šd_id
)

316 ià(
	`WARN_ON
(!
šd_id
))

317 
”r
;

318  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 0, 
NULL
, 
šd_id
, NULL);

319 
”r
:

320 
	`kä“_skb
(
skb
);

321  
NULL
;

322 
	}
}

324 
sk_buff
 *
	$¦si_mlme_»q_no_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

326  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 0, 
NULL
, 0, NULL);

327 
	}
}

329 
sk_buff
 *
	$¦si_mlme_»q_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
cfm_id
)

331 ià(
	`WARN_ON
(!
cfm_id
))

332 
”r
;

333  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 
cfm_id
, 
NULL
, 0, NULL);

334 
”r
:

335 
	`kä“_skb
(
skb
);

336  
NULL
;

337 
	}
}

340 
šlše
 
sk_buff
 *
	$¦si_mlme_»q_cfm_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
cfm_id
, sk_bufà**
mib_”rÜ
)

342 ià(
	`WARN_ON
(!
cfm_id
))

343 
”r
;

344 ià(
	`WARN_ON
(!
mib_”rÜ
))

345 
”r
;

346  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 
cfm_id
, 
mib_”rÜ
, 0, 
NULL
);

347 
”r
:

348 
	`kä“_skb
(
skb
);

349  
NULL
;

350 
	}
}

353 
sk_buff
 *
	$¦si_mlme_»q_cfm_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

354 
u16
 
cfm_id
, u16 
šd_id
,

355 
	$boŞ
 (*
v®id©e_cfm_wa™_šd
)(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
))

357 ià(
	`WARN_ON
(!
cfm_id
))

358 
”r
;

359 ià(
	`WARN_ON
(!
šd_id
))

360 
”r
;

361 ià(
	`WARN_ON
(!
v®id©e_cfm_wa™_šd
))

362 
”r
;

364  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 
cfm_id
, 
NULL
, 
šd_id
, 
v®id©e_cfm_wa™_šd
);

366 
”r
:

367 
	`kä“_skb
(
skb
);

368  
NULL
;

369 
	}
}

371 
›“80211_»g_ruË
 *
	$¦si_g‘_»g_ruË
(
u32
 
ûÁ”_äeq
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
)

373 
›“80211_»g_ruË
 *
ruË
;

374 
i
;

376 
i
 = 0; i < 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
; i++) {

377 
ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
i
];

380 ià(((
ûÁ”_äeq
 - 
	`MHZ_TO_KHZ
(10)è>ğ
ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
) &&

381 ((
ûÁ”_äeq
 + 
	`MHZ_TO_KHZ
(10)è<ğ
ruË
->
äeq_¿nge
.
’d_äeq_khz
))

382  
ruË
;

385  
NULL
;

386 
	}
}

388 
u16
 
	$¦si_compu‹_chªn_šfo
(
¦si_dev
 *
sdev
, 
u16
 
width
, u16 
ûÁ”_äeq0
, u16 
chªÃl_äeq
)

390 
u16
 
chªn_šfo
;

391 
u16
 
´im_chª_pos
 = 0;

393 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "compute channel info\n");

394 
width
) {

395 
NL80211_CHAN_WIDTH_20
:

396 
chªn_šfo
 = 20;

398 
NL80211_CHAN_WIDTH_40
:

399 
chªn_šfo
 = 40;

401 ià(
ûÁ”_äeq0
 < 
chªÃl_äeq
)

402 
chªn_šfo
 |ğ
SLSI_CHANN_INFO_HT_SCB
;

404 
NL80211_CHAN_WIDTH_80
:

406 
´im_chª_pos
 = ((30 + 
chªÃl_äeq
 - 
ûÁ”_äeq0
) / 20);

407 ià(
´im_chª_pos
 > 3) {

408 
	`SLSI_ERR
(
sdev
, "Invalid center_freq0 in chandef : %u,…rimary channel = %u,"

409 "´im¬y chª…o ÿlcuÏ‹d = %d\n", 
ûÁ”_äeq0
, 
chªÃl_äeq
, 
´im_chª_pos
);

410 
´im_chª_pos
 = 0;

412 
´im_chª_pos
 = 0xFFFF & (prim_chan_pos << 8);

413 
chªn_šfo
 = 80 | 
´im_chª_pos
;

416 
	`SLSI_WARN
(
sdev
, "Inv®id chªdef.width(0x%x)\n", 
width
);

417 
chªn_šfo
 = 0;

421 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "chªÃl_width:%u, chªn_šfo:0x%x\n", 
width
, 
chªn_šfo
);

422  
chªn_šfo
;

423 
	}
}

425 
u16
 
	$¦si_g‘_chªn_šfo
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
)

427 
u16
 
chªn_šfo
 = 0;

429 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

431 ià(
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_20
 || chªdef->width =ğ
NL80211_CHAN_WIDTH_20_NOHT
) {

432 
chªn_šfo
 = 20;

433 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "chªÃl_width:%u, chªn_šfo:0x%x\n", 
chªdef
->
width
, 
chªn_šfo
);

434 } ià(
chªdef
->
chª
) {

435 
chªn_šfo
 = 
	`¦si_compu‹_chªn_šfo
(
sdev
, 
chªdef
->
width
, chªdef->
ûÁ”_äeq1
,

436 
chªdef
->
chª
->
ûÁ”_äeq
);

438  
chªn_šfo
;

439 
	}
}

441 
	$¦si_check_chªÃliz©iÚ
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
,

442 
wifi_sh¬šg_chªÃl_sw™ched
)

444 
u8
 
width
;

445 
›“80211_»g_ruË
 *
ruË
 = 
NULL
;

446 
›“80211_chªÃl
 *
chªÃl
 = 
NULL
;

447 
u32
 
»f_æags
;

449 
chªdef
->
width
) {

450 
NL80211_CHAN_WIDTH_20
:

451 
NL80211_CHAN_WIDTH_20_NOHT
:

452 
width
 = 20;

454 
NL80211_CHAN_WIDTH_40
:

455 
width
 = 40;

457 
NL80211_CHAN_WIDTH_80
:

458 
width
 = 80;

461 
	`SLSI_ERR
(
sdev
, "Inv®id chªdef.width(0x%x)\n", 
chªdef
->
width
);

462  -
EINVAL
;

465 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
chªdef
->
chª
->
ûÁ”_äeq
);

466 ià(!
chªÃl
) {

467 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP. ChªÃÈnÙ found\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

468  -
EINVAL
;

471 ià(
wifi_sh¬šg_chªÃl_sw™ched
 == 1)

472 
»f_æags
 = 
IEEE80211_CHAN_DISABLED
;

474 
»f_æags
 = 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_RADAR
;

476 ià(
chªÃl
->
æags
 & 
»f_æags
) {

477 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

478  -
EINVAL
;

480 
ruË
 = 
	`¦si_g‘_»g_ruË
(
	`MHZ_TO_KHZ
(
chªdef
->
ûÁ”_äeq1
), &
sdev
->
deviû_cÚfig
.
domaš_šfo
);

481 ià(!
ruË
) {

482 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP. NØ»g„uË found fÜhi chªÃl\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

483  -
EINVAL
;

486 ià(
	`MHZ_TO_KHZ
(
width
è<ğ
ruË
->
äeq_¿nge
.
max_bªdwidth_khz
) {

487 
u32
 
width_bound¬y1
, 
width_bound¬y2
;

489 
width_bound¬y1
 = 
	`MHZ_TO_KHZ
(
chªdef
->
ûÁ”_äeq1
 - 
width
 / 2);

490 
width_bound¬y2
 = 
	`MHZ_TO_KHZ
(
chªdef
->
ûÁ”_äeq1
 + 
width
 / 2);

491 ià((
width_bound¬y1
 >ğ
ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
è&& (
width_bound¬y2
 <ğruË->äeq_¿nge.
’d_äeq_khz
))

493 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP. ChªÃÈnÙ w™hš f»qu’cy„ªgoàth»g„uË\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

494  -
EINVAL
;

496  -
EINVAL
;

497 
	}
}

502 
	$mib_bufãr_dump_to_log
(
¦si_dev
 *
sdev
, 
u8
 *
mib_bufãr
, 
mib_bufãr_Ën
)

504 
size_t
 
mib_decode_»suÉ
;

505 
size_t
 
off£t
 = 0;

506 
¦si_mib_’Œy
 
decoded_mib_v®ue
;

507 
¦si_mib_d©a
 
mibd©a
;

508 
”rÜ_out_Ën
 = 
mib_bufãr_Ën
 * 3;

509 
”rÜ_out_pos
 = 0;

510 *
”rÜ_out
;

512 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

514 
	`FUNC_ENTER
(
sdev
);

515 
	`SLSI_ERR
(
sdev
, "MIB bufã¸Ëngth: %u. MIB E¼Ü (decoded):", 
mib_bufãr_Ën
);

517 ià(!
mib_bufãr
) {

518 
	`SLSI_ERR
(
sdev
, "MIB buffer…ointer is NULL - can‚ot decode MIB keys\n");

521 
”rÜ_out
 = 
	`km®loc
(
”rÜ_out_Ën
, 
GFP_KERNEL
);

523 
off£t
 < 
mib_bufãr_Ën
) {

524 
”rÜ_out_pos
 = 0;

525 
mibd©a
.
d©a
 = &
mib_bufãr
[
off£t
];

526 
mibd©a
.
d©aL’gth
 = 
mib_bufãr_Ën
 - 
off£t
;

528 
mib_decode_»suÉ
 = 
	`¦si_mib_decode
(&
mibd©a
, &
decoded_mib_v®ue
);

529 ià(!
mib_decode_»suÉ
) {

530 
	`SLSI_ERR_HEX
(
sdev
, 
mibd©a
.
d©a
, mibd©a.
d©aL’gth
, "slsi_mib_decode() Failedo Decode:\n");

534 
off£t
 +ğ
mib_decode_»suÉ
;

536 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "%d", ()(
decoded_mib_v®ue
.
psid
));

537 ià(
decoded_mib_v®ue
.
šdex
[0]) {

538 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, ".%d", ()(
decoded_mib_v®ue
.
šdex
[0]));

539 ià(
decoded_mib_v®ue
.
šdex
[1])

540 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, ".%d", ()(
decoded_mib_v®ue
.
šdex
[1]));

543 
decoded_mib_v®ue
.
v®ue
.
ty³
) {

544 
SLSI_MIB_TYPE_BOOL
:

545 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "=%s\n", 
decoded_mib_v®ue
.
v®ue
.
u
.
boŞV®ue
 ? "TRUE" : "FALSE");

547 
SLSI_MIB_TYPE_UINT
:

548 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "=%d\n", ()
decoded_mib_v®ue
.
v®ue
.
u
.
uštV®ue
);

550 
SLSI_MIB_TYPE_INT
:

551 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "=%d\n", ()
decoded_mib_v®ue
.
v®ue
.
u
.
štV®ue
);

553 
SLSI_MIB_TYPE_OCTET
:

555 
u32
 
i
;

557 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒrror_out_pos, "=[");

558 
i
 = 0; i < 
decoded_mib_v®ue
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
; i++)

559 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "%.2X", ()
decoded_mib_v®ue
.
v®ue
.
u
.
où‘V®ue
.
d©a
[
i
]);

560 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒrror_out_pos, "]\n");

564 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒrror_out_pos, "=Can‚ot decode MIB keyype\n");

568 
	`SLSI_INFO_NODEV
("%s", 
”rÜ_out
);

570 
	`kä“
(
”rÜ_out
);

571 
	`FUNC_EXIT
(
sdev
);

572 
	}
}

574 
	$¦si_mlme_£t__add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

576 
sk_buff
 *
»q
;

577 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

578 
sk_buff
 *
cfm
;

579 
r
 = 0;

580 
u32
 
addr
;

581 
u8
 
muÉiÿ¡_add
[
ETH_ALEN
] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };

583 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

584 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_IP_ADDRESS.request\n");

585  -
EOPNOTSUPP
;

588 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

590 
»q
 = 
	`çpi_®loc
(
mlme_£t__add»ss_»q
, 
MLME_SET_IP_ADDRESS_REQ
, 
ndev_vif
->
iâum
, Òdev_vif->
add»ss
));

591 ià(!
»q
)

592  -
ENOMEM
;

594 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
add»ss_ty³
, 4);

595 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
muÉiÿ¡_add»ss
, 
muÉiÿ¡_add
);

597 
addr
 = 
	`htÚl
(
	`be32_to_ıu
(
ndev_vif
->
add»ss
));

598 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)(&
addr
), (ipaddr));

600 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "¦si_mlme_£t__add»ss(vif: %d, IP: %pI4)\n", 
ndev_vif
->
iâum
, &ndev_vif->
add»ss
);

601 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_IP_ADDRESS_CFM
);

602 ià(!
cfm
)

603  -
EIO
;

605 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

606 
	`SLSI_NET_ERR
(
dev
, "mlme_£t__add»ss_cfmÔesuÉ:0x%04xèERROR\n", 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
));

607 
r
 = -
EINVAL
;

610 
	`kä“_skb
(
cfm
);

611  
r
;

612 
	}
}

614 #ià
IS_ENABLED
(
CONFIG_IPV6
)

615 
	$¦si_mlme_£t_v6_add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

617 
sk_buff
 *
»q
;

618 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

619 
sk_buff
 *
cfm
;

620 
r
 = 0;

621 
u8
 
sŞic™ed_node_addr
[
ETH_ALEN
] = { 0x33, 0x33, 0xff, 0x00, 0x00, 0x00 };

623 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

624 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_IP_ADDRESS.request\n");

625  -
EOPNOTSUPP
;

628 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

630 
»q
 = 
	`çpi_®loc
(
mlme_£t__add»ss_»q
, 
MLME_SET_IP_ADDRESS_REQ
, 
ndev_vif
->
iâum
, 16);

631 ià(!
»q
)

632  -
ENOMEM
;

634 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
add»ss_ty³
, 6);

636 ià(
ndev_vif
->
¡a
.
nd_ofæßd_’abËd
 == 1) {

637 
	`¦si_¥šlock_lock
(&
ndev_vif
->
v6addr_lock
);

638 
	`memıy
(&
sŞic™ed_node_addr
[3], &
ndev_vif
->
v6add»ss
.
s6_addr
[13], 3);

639 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
v6addr_lock
);

641 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
muÉiÿ¡_add»ss
, 
sŞic™ed_node_addr
);

642 
	`çpi_­³nd_d©a
(
»q
, 
ndev_vif
->
v6add»ss
.
s6_addr
, 16);

643 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "mlme_£t__add»ss_»q(vif: %d, IP: %pI6)\n", 
ndev_vif
->
iâum
,

644 &
ndev_vif
->
v6add»ss
);

646 
u8
 
node_addr_nd_di§bË
[16];

648 
	`mem£t
(&
node_addr_nd_di§bË
, 0, (node_addr_nd_disable));

649 
	`çpi_­³nd_d©a
(
»q
, 
node_addr_nd_di§bË
, 16);

650 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "mlme_set_ip_address_req(vif: %d, IP-setting ip‡ddresso‡ll zeros)\n",

651 
ndev_vif
->
iâum
);

654 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_IP_ADDRESS_CFM
);

655 ià(!
cfm
)

656  -
EIO
;

658 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

659 
	`SLSI_NET_ERR
(
dev
, "mlme_set_ip_address_cfm(result:0x%04x) ERROR\n",

660 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
));

661 
r
 = -
EINVAL
;

663 
	`kä“_skb
(
cfm
);

664  
r
;

665 
	}
}

668 
sk_buff
 *
	$¦si_mlme_£t_w™h_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mib
, 
mib_Ën
)

670 
sk_buff
 *
»q
 = 
NULL
;

671 
sk_buff
 *
cfm
 = 
NULL
;

672 
u16
 
iâum
 = 0;

674 ià(
dev
) {

675 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

677 
iâum
 = 
ndev_vif
->ifnum;

679 ià(
iâum
 && !
ndev_vif
->
is_avaabË
)

680  
NULL
;

683 
»q
 = 
	`çpi_®loc
(
mlme_£t_»q
, 
MLME_SET_REQ
, 
iâum
, 
mib_Ën
);

684 ià(!
»q
)

685  
NULL
;

687 
	`çpi_­³nd_d©a
(
»q
, 
mib
, 
mib_Ën
);

689 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CFM
);

690 ià(!
cfm
)

691  
NULL
;

693  
cfm
;

694 
	}
}

696 
	$¦si_mlme_£t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mib
, 
mib_Ën
)

698 
sk_buff
 *
cfm
 = 
NULL
;

700 
cfm
 = 
	`¦si_mlme_£t_w™h_cfm
(
sdev
, 
dev
, 
mib
, 
mib_Ën
);

701 ià(!
cfm
)

702  -
EIO
;

704 ià(
	`çpi_g‘_d©®’
(
cfm
)) {

705 
	`mib_bufãr_dump_to_log
(
sdev
, 
	`çpi_g‘_d©a
(
cfm
), 
	`çpi_g‘_d©®’
(cfm));

706 
	`kä“_skb
(
cfm
);

707  -
EINVAL
;

710 
	`kä“_skb
(
cfm
);

712 
	}
}

714 
	$¦si_mlme_g‘
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mib
, 
mib_Ën
, u8 *
»¥
,

715 
»¥_buf_Ën
, *
»¥_Ën
)

717 
sk_buff
 *
»q
;

718 
sk_buff
 *
”r
 = 
NULL
;

719 
sk_buff
 *
cfm
;

720 
r
 = 0;

721 
u16
 
iâum
 = 0;

723 *
»¥_Ën
 = 0;

725 ià(
dev
) {

726 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

728 
iâum
 = 
ndev_vif
->ifnum;

730 ià(
iâum
 && !
ndev_vif
->
is_avaabË
)

731  -
ENODEV
;

733 
»q
 = 
	`çpi_®loc
(
mlme_g‘_»q
, 
MLME_GET_REQ
, 
iâum
, 
mib_Ën
);

734 ià(!
»q
)

735  -
ENOMEM
;

736 
	`çpi_­³nd_d©a
(
»q
, 
mib
, 
mib_Ën
);

738 
cfm
 = 
	`¦si_mlme_»q_cfm_mib
(
sdev
, 
dev
, 
»q
, 
MLME_GET_CFM
, &
”r
);

739 ià(!
cfm
)

740  -
EIO
;

742 ià(
”r
) {

743 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "ERROR: mlme_get_cfm with mibƒrror\n");

744 
	`mib_bufãr_dump_to_log
(
sdev
, 
	`çpi_g‘_d©a
(
”r
), 
	`çpi_g‘_d©®’
(err));

745 
	`LOG_CONDITIONALLY
(
	`çpi_g‘_d©®’
(
cfm
è> 
»¥_buf_Ën
,

746 
	`SLSI_ERR
(
sdev
, "Insufficient„esp_buf_len(%d). mlme_get_cfm(%d)\n",

747 
»¥_buf_Ën
, 
	`çpi_g‘_d©®’
(
cfm
)));

748 
r
 = -
EINVAL
;

754 ià(
	`çpi_g‘_d©®’
(
cfm
è<ğ
»¥_buf_Ën
) {

755 *
»¥_Ën
 = 
	`çpi_g‘_d©®’
(
cfm
);

756 
	`memıy
(
»¥
, 
	`çpi_g‘_d©a
(
cfm
), 
	`çpi_g‘_d©®’
(cfm));

757 
r
 = 0;

759 
	`SLSI_WARN
(
sdev
, "Insuffic›Á†’gth (%dètØ»ad MIB v®ues,ƒx³ùed =%d\n", 
»¥_buf_Ën
, 
	`çpi_g‘_d©®’
(
cfm
));

760 
r
 = -
EINVAL
;

763 
	`kä“_skb
(
”r
);

764 
	`kä“_skb
(
cfm
);

766  
r
;

767 
	}
}

769 
	$¦si_mlme_add_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
)

771 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

772 
sk_buff
 *
»q
;

773 
sk_buff
 *
cfm
;

774 
r
 = 0, 
i
;

776 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

777 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_ADD_VIF.request\n");

778  -
EOPNOTSUPP
;

781 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

782 ià(
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
]) {

783 
r
 = 
	`¦si_mlme_d–_vif
(
sdev
, 
dev
);

784 ià(
r
 != 0)

785 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif before‡dd_vif failed\n");

787 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

791 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

792 
ndev_vif
->
tx_no_ack
[
i
] = 0;

793 
ndev_vif
->
tx_·ck‘s
[
i
] = 0;

794 
ndev_vif
->
rx_·ck‘s
[
i
] = 0;

796 
»q
 = 
	`çpi_®loc
(
mlme_add_vif_»q
, 
MLME_ADD_VIF_REQ
, 
ndev_vif
->
iâum
, 0);

797 ià(!
»q
)

798  -
ENOMEM
;

799 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
, 
ndev_vif
->
vif_ty³
);

800 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
š‹rçû_add»ss
, interface_address);

801 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
deviû_add»ss
, device_address);

802 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_vif_»q(vif:%d)\n", 
ndev_vif
->
iâum
);

803 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_VIF_CFM
);

804 ià(!
cfm
)

805  -
EIO
;

807 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

808 
	`SLSI_NET_ERR
(
dev
, "mlme_add_vif_cfm(result:0x%04x) ERROR\n",

809 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
));

810 
r
 = -
EINVAL
;

813 
ndev_vif
->
pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

814 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

818 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
))

819 
	`SLSI_WARN
(
sdev
,

821 
ndev_vif
->
¬p_tx_couÁ
, 
sdev
->arp_tx_count);

822 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

824 
	`kä“_skb
(
cfm
);

825  
r
;

826 
	}
}

828 
	$¦si_mlme_add_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
)

830 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

831 
sk_buff
 *
»q
;

832 
sk_buff
 *
cfm
;

833 
r
 = 0;

835 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

836 
	`SLSI_NET_INFO
(
dev
, "WlanLite SKIP MLME_ADD_VIF.request\n");

837  -
EOPNOTSUPP
;

840 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

841 
»q
 = 
	`çpi_®loc
(
mlme_add_vif_»q
, 
MLME_ADD_VIF_REQ
, 
SLSI_NET_INDEX_DETECT
, 0);

842 ià(!
»q
)

843  -
ENOMEM
;

844 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
, 
FAPI_VIFTYPE_DETECT
);

845 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
š‹rçû_add»ss
, interface_address);

846 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
deviû_add»ss
, device_address);

847 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_vif_»q (d‘eù vifè(vif:%d)\n", 
FAPI_VIFTYPE_DETECT
);

848 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_VIF_CFM
);

849 ià(!
cfm
)

850  -
EIO
;

852 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

853 
	`SLSI_NET_ERR
(
dev
, "mlme_add_vif_cfm (detect vif) (result:0x%04x) ERROR\n",

854 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
));

855 
r
 = -
EINVAL
;

858 
	`kä“_skb
(
cfm
);

859  
r
;

860 
	}
}

862 
	$¦si_mlme_d–_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

864 
sk_buff
 *
»q
;

865 
sk_buff
 *
cfm
;

866 
»t
 = 0;

868 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

869 
	`SLSI_INFO_NODEV
("WlanLite SKIP MLME_DEL_VIF.request\n");

870  
»t
;

873 ià(!
sdev
->
d‘eù_vif_aùive
)

874  
»t
;

876 
	`SLSI_DBG4_NODEV
(
SLSI_MLME
, "d–_d‘eù_viàvif:%d, mlme_blocked:%s\n", 
SLSI_NET_INDEX_DETECT
,

877 
sdev
->
mlme_blocked
 ? "true" : "false");

878 ià(
sdev
->
mlme_blocked
)

879  
»t
;

880 
»q
 = 
	`çpi_®loc
(
mlme_d–_vif_»q
, 
MLME_DEL_VIF_REQ
, 
SLSI_NET_INDEX_DETECT
, 0);

881 ià(!
»q
)

882  -
ENOMEM
;

884 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_VIF_CFM
);

885 ià(!
cfm
)

886  -
EIO
;

888 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

889 
	`SLSI_ERR_NODEV
("mlme_del_vif_cfm(result:0x%04x) ERROR\n",

890 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
));

891 
»t
 = -
EINVAL
;

894 
	`kä“_skb
(
cfm
);

895  
»t
;

896 
	}
}

898 
	$¦si_mlme_d–_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

900 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

901 
sk_buff
 *
»q
;

902 
sk_buff
 *
cfm
;

903 
»t
 = 0;

904 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

905 
u32
 
¬p_tx_couÁ
;

908 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

909  -
EINVAL
;

911 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

912 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DEL_VIF.request\n");

913  
»t
;

916 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

918 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "d–_viàvif:%d, mlme_blocked:%s\n", 
ndev_vif
->
iâum
,

919 
sdev
->
mlme_blocked
 ? "true" : "false");

920 ià(
sdev
->
mlme_blocked
)

921  
»t
;

922 
»q
 = 
	`çpi_®loc
(
mlme_d–_vif_»q
, 
MLME_DEL_VIF_REQ
, 
ndev_vif
->
iâum
, 0);

923 ià(!
»q
) {

924 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
Œue
;

925  -
ENOMEM
;

928 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_VIF_CFM
);

929 ià(!
cfm
) {

930 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
Œue
;

931  -
EIO
;

934 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

935 
	`SLSI_NET_ERR
(
dev
, "mlme_del_vif_cfm(result:0x%04x) ERROR\n",

936 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
));

937 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
Œue
;

938 
»t
 = -
EINVAL
;

941 ià(((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
è|| (ndev_vif->iáy³ =ğ
NL80211_IFTYPE_STATION
)) &&

942 (
ndev_vif
->
d–‘e_´obe_»q_›s
)) {

943 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

944 
	`kä“
(
ndev_vif
->
´obe_»q_›s
);

945 
ndev_vif
->
´obe_»q_›s
 = 
NULL
;

946 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

947 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
çl£
;

948 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

950 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
))

951 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

953 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

955 
¬p_tx_couÁ
 = 
	`©omic_»ad
(&
ndev_vif
->arp_tx_count);

956 ià(
¬p_tx_couÁ
) {

957 ià(
¬p_tx_couÁ
 < 
	`©omic_»ad
(&
sdev
->arp_tx_count))

958 
	`©omic_sub
(
¬p_tx_couÁ
, &
sdev
->arp_tx_count);

960 
	`©omic_£t
(&
sdev
->
¬p_tx_couÁ
, 0);

962 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

964 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
))

965 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

968 ià(!
»t
)

969 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

970 
	`kä“_skb
(
cfm
);

971  
»t
;

972 
	}
}

974 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

975 
	$¦si_mlme_£t_fÜw¬d_b—cÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
aùiÚ
)

977 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

978 
sk_buff
 *
»q
;

979 
sk_buff
 *
cfm
;

981 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

982  -
EINVAL
;

984 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

985 
	`SLSI_NET_INFO
(
dev
, "wlanlite does‚ot support mlme_forward_bacon_req\n");

986  -
EOPNOTSUPP
;

989 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_fÜw¬d_b—cÚ_»q×ùiÚ = %s(%d))\n", 
aùiÚ
 ? "start" : "stop",‡ction);

991 
»q
 = 
	`çpi_®loc
(
mlme_fÜw¬d_b—cÚ_»q
, 
MLME_FORWARD_BEACON_REQ
, 
ndev_vif
->
iâum
, 0);

992 ià(!
»q
) {

993 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc for mlme_forward_beacon_req is failed\n");

994  -
ENOMEM
;

997 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_fÜw¬d_b—cÚ_»q
.
ws_aùiÚ
, 
aùiÚ
);

999 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_FORWARD_BEACON_CFM
);

1000 ià(!
cfm
) {

1001 
	`SLSI_NET_ERR
(
dev
, "receiving mlme_forward_beacon_cfm is failed\n");

1002  -
EIO
;

1005 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_fÜw¬d_b—cÚ_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
) {

1006 
	`SLSI_NET_ERR
(
dev
, "mlme_forward_beacon_cfm(result:0x%04x) ERROR\n",

1007 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_fÜw¬d_b—cÚ_cfm
.
»suÉ_code
));

1008  -
EINVAL
;

1011 
ndev_vif
->
is_ws_ruÂšg
 = (
aùiÚ
 ? 
Œue
 : 
çl£
);

1013 
	`kä“_skb
(
cfm
);

1015 
	}
}

1018 
	$¦si_mlme_£t_bªd_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ušt
 
bªd
, 
u16
 
avoid_discÚÃùiÚ
)

1020 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1021 
sk_buff
 *
»q
;

1022 
sk_buff
 *
cfm
;

1023 
»t
 = 0;

1025 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "mlme_£t_bªd_»q(vif:%u bªd:%u)\n", 
ndev_vif
->
iâum
, 
bªd
);

1027 
»q
 = 
	`çpi_®loc
(
mlme_£t_bªd_»q
, 
MLME_SET_BAND_REQ
, 
ndev_vif
->
iâum
, 0);

1028 ià(!
»q
)

1029  -
EIO
;

1030 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bªd_»q
.
vif
, 
ndev_vif
->
iâum
);

1031 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bªd_»q
.
bªd
, band);

1032 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bªd_»q
.
¥¬e_1
, 
avoid_discÚÃùiÚ
);

1034 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_BAND_CFM
);

1035 ià(!
cfm
)

1036  -
EIO
;

1038 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bªd_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1039 
	`SLSI_NET_ERR
(
dev
, "mlme_set_band_cfm(result:0x%04x) ERROR\n",

1040 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bªd_cfm
.
»suÉ_code
));

1041 
»t
 = -
EINVAL
;

1044 
	`kä“_skb
(
cfm
);

1045  
»t
;

1046 
	}
}

1048 
	$¦si_mlme_£t_sÿn_mode_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_mode
, u16 
max_chªÃl_time
,

1049 
u16
 
home_away_time
, u16 
home_time
, u16 
max_chªÃl_·ssive_time
)

1051 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1052 
sk_buff
 *
»q
;

1053 
sk_buff
 *
cfm
;

1054 
»t
 = 0;

1057 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
)) {

1058 
	`SLSI_ERR
(
sdev
, "ndev_vif mutex is‚ot†ocked\n");

1059  -
EINVAL
;

1062 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_sÿn_mode_»q(vif:0, sÿn_mode:%d)\n", 
sÿn_mode
);

1064 
»q
 = 
	`çpi_®loc
(
mlme_£t_sÿn_mode_»q
, 
MLME_SET_SCAN_MODE_REQ
, 0, 0);

1065 ià(!
»q
)

1066  -
EIO
;

1067 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
sÿn_mode
, scan_mode);

1068 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
max_chªÃl_time_aùive
, 
max_chªÃl_time
);

1069 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
home_away_time
, home_away_time);

1070 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
home_time
, home_time);

1071 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
max_chªÃl_time_·ssive
, 
max_chªÃl_·ssive_time
);

1073 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_SET_SCAN_MODE_CFM
);

1074 ià(!
cfm
)

1075  -
EIO
;

1077 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_sÿn_mode_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1078 
	`SLSI_NET_ERR
(
dev
, "mlme_set_scan_mode_cfm(result:0x%04x) ERROR\n",

1079 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_sÿn_mode_cfm
.
»suÉ_code
));

1080 
»t
 = -
EINVAL
;

1083 
	`kä“_skb
(
cfm
);

1084  
»t
;

1085 
	}
}

1087 
	$¦si_mlme_£t_rßmšg_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
mib_v®ue
, 
mib_Ëngth
)

1089 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1090 
sk_buff
 *
»q
;

1091 
sk_buff
 *
cfm
;

1092 
»t
 = 0;

1094 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_rßmšg_·¿m‘”s_»q(vif:%d v®ue:%d)\n", 
ndev_vif
->
iâum
, 
mib_v®ue
);

1095 
»q
 = 
	`çpi_®loc
(
mlme_£t_rßmšg_·¿m‘”s_»q
, 
MLME_SET_ROAMING_PARAMETERS_REQ
, 
ndev_vif
->
iâum
, 0);

1096 ià(!
»q
) {

1097 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1098  -
ENOMEM
;

1100 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_rßmšg_·¿m‘”s_»q
.
vif
, 
ndev_vif
->
iâum
);

1101 
	`çpi_­³nd_d©a_u16
(
»q
, 
psid
);

1102 
	`çpi_­³nd_d©a_u16
(
»q
, 
mib_Ëngth
);

1104 
mib_Ëngth
) {

1106 
	`çpi_­³nd_d©a_u8
(
»q
, 
mib_v®ue
);

1109 
	`çpi_­³nd_d©a_u16
(
»q
, 
mib_v®ue
);

1112 
	`çpi_­³nd_d©a_u32
(
»q
, 
mib_v®ue
);

1115 
	`kä“_skb
(
»q
);

1116  -
EINVAL
;

1119 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_ROAMING_PARAMETERS_CFM
);

1120 ià(!
cfm
) {

1121 
	`SLSI_NET_ERR
(
dev
, "mlme_set_roaming_parameters_cfm failure\n");

1122  -
EIO
;

1124 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_·¿m‘”s_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1125 
	`SLSI_NET_ERR
(
dev
, "mlme_set_roaming_parameters_cfm(result:0x%04x) ERROR\n",

1126 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_ty³_cfm
.
»suÉ_code
));

1127 
»t
 = -
EINVAL
;

1130 
	`kä“_skb
(
cfm
);

1131  
»t
;

1132 
	}
}

1133 
	$¦si_mlme_£t_chªÃl
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, u16 
š‹rv®
, u16 
couÁ
)

1135 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1136 
sk_buff
 *
»q
;

1137 
sk_buff
 *
cfm
;

1138 
r
 = 0;

1140 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1141 
	`SLSI_NET_INFO
(
dev
, "wlanlite does‚ot support MLME_SET_CHANNEL.request\n");

1142  -
EOPNOTSUPP
;

1145 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1147 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_chªÃl_»q(äeq:%u, du¿tiÚ:%u, iÁ”v®:%u, couÁ:%u)\n", 
chª
->
ûÁ”_äeq
, 
du¿tiÚ
, 
š‹rv®
, 
couÁ
);

1149 
»q
 = 
	`çpi_®loc
(
mlme_£t_chªÃl_»q
, 
MLME_SET_CHANNEL_REQ
, 
ndev_vif
->
iâum
, 0);

1150 ià(!
»q
)

1151  -
ENOMEM
;

1153 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
avaab™y_du¿tiÚ
, 
du¿tiÚ
);

1154 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
avaab™y_š‹rv®
, 
š‹rv®
);

1155 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
couÁ
, count);

1156 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
chªÃl_äequ’cy
, 
	`SLSI_FREQ_HOST_TO_FW
(
chª
->
ûÁ”_äeq
));

1158 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CHANNEL_CFM
);

1159 ià(!
cfm
)

1160  -
EIO
;

1162 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_chªÃl_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1163 
	`SLSI_NET_ERR
(
dev
, "mlme_set_channel_cfm(result:0x%04x) ERROR\n",

1164 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_chªÃl_cfm
.
»suÉ_code
));

1165 
r
 = -
EINVAL
;

1168 
	`kä“_skb
(
cfm
);

1169  
r
;

1170 
	}
}

1172 
	$¦si_mlme_un£t_chªÃl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1174 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1175 
sk_buff
 *
»q
;

1176 
sk_buff
 *
cfm
;

1177 
r
 = 0;

1179 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "slsi_mlme_unset_channel_req\n");

1181 
»q
 = 
	`çpi_®loc
(
mlme_un£t_chªÃl_»q
, 
MLME_UNSET_CHANNEL_REQ
, 
ndev_vif
->
iâum
, 0);

1183 ià(!
»q
)

1184  -
ENOMEM
;

1186 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_UNSET_CHANNEL_CFM
);

1188 ià(!
cfm
)

1189  -
EIO
;

1191 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_un£t_chªÃl_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1192 
	`SLSI_NET_ERR
(
dev
, "mlme_unset_channel_cfm(result:0x%04x) ERROR\n",

1193 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_un£t_chªÃl_cfm
.
»suÉ_code
));

1194 
r
 = -
EINVAL
;

1197 
	`kä“_skb
(
cfm
);

1198  
r
;

1199 
	}
}

1201 
	$¦si_­_obss_sÿn_dÚe_šd
(
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
)

1203 
sk_buff
 *
sÿn_»s
;

1204 
u16
 
sÿn_id
 = 
SLSI_SCAN_HW_ID
;

1206 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1208 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Scan before AP start completed\n");

1210 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1211 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
));

1212 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1214 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
sÿn_id
], 
NULL
);

1215 
sÿn_»s
) {

1216 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn_»s
);

1217 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
sÿn_»s
);

1218 
size_t
 
›_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
b—cÚ
.
v¬ŸbË
);

1220 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_MLME
, "OBSS scan„esult (scan_id:%d, %pM, freq:%d,„ssi:%d, ie_len = %zu)\n",

1221 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
sÿn_id
),

1222 
	`çpi_g‘_mgmt
(
sÿn_»s
)->
bssid
,

1223 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2,

1224 
	`çpi_g‘_s16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
rssi
),

1225 
›_Ën
);

1227 ià(!
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›_Ën
)) {

1228 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Non HT BSS detected on…rimary channel\n");

1229 
ndev_vif
->
­
.
nÚ_ht_bss_´e£Á
 = 
Œue
;

1232 
	`kä“_skb
(
sÿn_»s
);

1233 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
sÿn_id
], 
NULL
);

1235 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1236 
	}
}

1239 
boŞ
 
	$¦si_sÿn_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

1241 
boŞ
 
r
 = 
Œue
;

1243 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1244 
	`SLSI_ERR_NODEV
("mlme_add_scan_cfm(result:0x%04x) ERROR\n",

1245 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
));

1246 
r
 = 
çl£
;

1249 
	`kä“_skb
(
cfm
);

1250  
r
;

1251 
	}
}

1253 
	$¦si_mlme_£t_chªÃls_›
(
¦si_mlme_·¿m‘”s
 *
chªÃls_li¡_›
)

1255 
chªÃls_li¡_›
->
–em’t_id
 = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

1256 
chªÃls_li¡_›
->
Ëngth
 = 
SLSI_MLME_PARAM_HEADER_SIZE
;

1257 
	`¦si_mlme_put_oui
(
chªÃls_li¡_›
->
oui
, 
SLSI_MLME_SAMSUNG_OUI
);

1258 
	`¦si_mlme_put_oui_ty³
(
chªÃls_li¡_›
, 
SLSI_MLME_TYPE_SCAN_PARAM
, 
SLSI_MLME_SUBTYPE_CHANNEL_LIST
);

1259 
	}
}

1261 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1262 
	$¦si_mlme_­³nd_gsÿn_chªÃl_li¡
(
¦si_dev
 *
sdev
,

1263 
Ãt_deviû
 *
dev
,

1264 
sk_buff
 *
»q
,

1265 
¦si_Æ_buck‘_·¿m
 *
Æ_buck‘
)

1267 
u16
 
chªÃl_äeq
;

1268 
u8
 
i
;

1269 
u8
 *
p
;

1270 
¦si_mlme_·¿m‘”s
 
chªÃls_li¡_›
 = {0};

1271 
¦si_mlme_·¿m‘”s
 *
chªÃls_li¡_›_h—d
 = 
NULL
;

1273 
	`¦si_mlme_£t_chªÃls_›
(&
chªÃls_li¡_›
);

1275 
chªÃls_li¡_›_h—d
 =

1276 (
¦si_mlme_·¿m‘”s
 *)
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
chªÃls_li¡_›
, (channels_list_ie));

1277 ià(!
chªÃls_li¡_›_h—d
) {

1278 
	`SLSI_WARN
(
sdev
, "channel†ist IE‡ppend failed\n");

1279 
	`kä“_skb
(
»q
);

1280  -
EINVAL
;

1283 ià(
Æ_buck‘
->
bªd
 =ğ
WIFI_BAND_UNSPECIFIED
)

1285 
i
 = 0; i < 
Æ_buck‘
->
num_chªÃls
; i++) {

1286 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1287 ià(!
p
) {

1288 
	`SLSI_ERR
(
sdev
, "chª desc[%d]‡µ’d faed\n", 
i
);

1289 
	`kä“_skb
(
»q
);

1290  -
EINVAL
;

1292 
chªÃl_äeq
 = 
	`SLSI_FREQ_HOST_TO_FW
(
Æ_buck‘
->
chªÃls
[
i
].
chªÃl
);

1293 
chªÃl_äeq
 = 
	`ıu_to_Ë16
(channel_freq);

1294 
	`memıy
(
p
, &
chªÃl_äeq
, (channel_freq));

1295 
p
[2] = 
FAPI_SCANPOLICY_ANY_RA
;

1296 
chªÃls_li¡_›_h—d
->
Ëngth
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1299 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1300 ià(!
p
) {

1301 
	`SLSI_ERR
(
sdev
, "chan desc(band specific)append failed\n");

1302 
	`kä“_skb
(
»q
);

1303  -
EINVAL
;

1306 
chªÃl_äeq
 = 0;

1307 
	`memıy
(
p
, &
chªÃl_äeq
, (channel_freq));

1308 
p
[2] = 
	`¦si_gsÿn_g‘_sÿn_pŞicy
(
Æ_buck‘
->
bªd
);

1309 
chªÃls_li¡_›_h—d
->
Ëngth
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1313 
	}
}

1316 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


1317 
u32
 
	$¦si_mlme_g‘_6hz_·¿m_size
(
u32
 
n_6ghz_·¿ms
)

1319 ià(
n_6ghz_·¿ms
)

1320  (
¦si_mlme_·¿m‘”s
) +

1321 (
n_6ghz_·¿ms
 * (
¦si_mlme_sÿn_6ghz_desütÜ
));

1324 
	}
}

1326 
	$¦si_mlme_­³nd_6hz_·¿m
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
»q
,

1327 
u32
 
n_6ghz_·¿ms
, 
cfg80211_sÿn_6ghz_·¿ms
 *
sÿn_6ghz_·¿ms
)

1329 
¦si_mlme_·¿m‘”s
 
mlme_6ghz_h—d”
 = {0};

1330 
¦si_mlme_sÿn_6ghz_desütÜ
 *
mlme_6ghz_desc
 = 0;

1331 
u32
 
mlme_6ghz_desc_size
 = 
n_6ghz_·¿ms
 * (
¦si_mlme_sÿn_6ghz_desütÜ
);

1332 
u8
 *
sÿn_6ghz_·¿m_h—d”
 = 0;

1333 
i
 = 0;

1335 ià(!
n_6ghz_·¿ms
)

1338 ià(
n_6ghz_·¿ms
 && !
sÿn_6ghz_·¿ms
) {

1339 
	`SLSI_WARN
(
sdev
, "n_6ghz_·¿ms[%d] buˆsÿn_6ghz_·¿m i nuÎ\n", 
n_6ghz_·¿ms
);

1340 
	`kä“_skb
(
»q
);

1341  -
EINVAL
;

1344 
mlme_6ghz_h—d”
.
–em’t_id
 = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

1345 
mlme_6ghz_h—d”
.
Ëngth
 = 
mlme_6ghz_desc_size
 + 
SLSI_MLME_PARAM_HEADER_SIZE
;

1346 
	`¦si_mlme_put_oui
(
mlme_6ghz_h—d”
.
oui
, 
SLSI_MLME_SAMSUNG_OUI
);

1347 
	`¦si_mlme_put_oui_ty³
(&
mlme_6ghz_h—d”
, 
SLSI_MLME_TYPE_SCAN_PARAM
, 
SLSI_MLME_SUBTYPE_6GHZ_PARAM
);

1349 
sÿn_6ghz_·¿m_h—d”
 = 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
mlme_6ghz_h—d”
, (
¦si_mlme_·¿m‘”s
));

1350 ià(!
sÿn_6ghz_·¿m_h—d”
) {

1351 
	`SLSI_WARN
(
sdev
, "scan_6ghz_param_header‡ppend failed\n");

1352 
	`kä“_skb
(
»q
);

1353  -
EINVAL
;

1356 
mlme_6ghz_desc
 = (
¦si_mlme_sÿn_6ghz_desütÜ
 *)
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
mlme_6ghz_desc_size
);

1357 ià(!
mlme_6ghz_desc
) {

1358 
	`SLSI_WARN
(
sdev
, "mlme_6ghz_descriptor‡ppend failed\n");

1359 
	`kä“_skb
(
»q
);

1360  -
EINVAL
;

1363 
i
 = 0; i < 
n_6ghz_·¿ms
; i++) {

1364 ià(
sÿn_6ghz_·¿ms
[
i
].
shÜt_ssid_v®id
)

1365 
mlme_6ghz_desc
[
i
].
shÜt_ssid
 = 
	`ıu_to_Ë32
(
sÿn_6ghz_·¿ms
[i].short_ssid);

1366 
mlme_6ghz_desc
[
i
].
chªÃl_idx
 = 
	`ıu_to_Ë32
(
sÿn_6ghz_·¿ms
[i].channel_idx);

1367 
	`memıy
(
mlme_6ghz_desc
[
i
].
bssid
, 
sÿn_6ghz_·¿ms
[i].bssid, 
ETH_ALEN
);

1369 ià(
sÿn_6ghz_·¿ms
[
i
].
unsŞic™ed_´obe
)

1370 
mlme_6ghz_desc
[
i
].
sÿn_6ghz_İtiÚ
 |ğ
SLSI_UNSOLICITED_PROBE
;

1371 ià(
sÿn_6ghz_·¿ms
[
i
].
shÜt_ssid_v®id
)

1372 
mlme_6ghz_desc
[
i
].
sÿn_6ghz_İtiÚ
 |ğ
SLSI_SHORT_SSID_VALID
;

1373 ià(
sÿn_6ghz_·¿ms
[
i
].
psc_no_li¡’
)

1374 
mlme_6ghz_desc
[
i
].
sÿn_6ghz_İtiÚ
 |ğ
SLSI_PSC_NO_LISTEN
;

1377 
	}
}

1380 
šlše
 
boŞ
 
	$¦si_mlme_is_suµÜt_bªd
(
¦si_dev
 *
sdev
, 
bªd
)

1382 ià(
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
) {

1383 ià(
bªd
 =ğ
NL80211_BAND_2GHZ
 && 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 !ğ
SLSI_FREQ_BAND_2GHZ
)

1384  
çl£
;

1385 ià(
bªd
 =ğ
NL80211_BAND_5GHZ
 && 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 !ğ
SLSI_FREQ_BAND_5GHZ
)

1386  
çl£
;

1387 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


1388 ià(
bªd
 =ğ
NL80211_BAND_6GHZ
 && 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 !ğ
SLSI_FREQ_BAND_6GHZ
)

1389  
çl£
;

1392  
Œue
;

1393 
	}
}

1395 
	$¦si_mlme_­³nd_chªÃl_li¡
(
¦si_dev
 *
sdev
,

1396 
Ãt_deviû
 *
dev
,

1397 
sk_buff
 *
»q
,

1398 
u32
 
num_chªÃls
,

1399 
›“80211_chªÃl
 *
chªÃls
[],

1400 
u16
 
sÿn_ty³
,

1401 
boŞ
 
·ssive_sÿn
)

1403 
chªn
;

1404 
u16
 
äeq_fw_un™
;

1405 
u8
 
i
;

1406 
n_v®id_chªÃls
 = 0;

1407 
u8
 *
p
;

1408 
¦si_mlme_·¿m‘”s
 
chªÃls_li¡_›
 = {0};

1409 
¦si_mlme_·¿m‘”s
 *
chªÃls_li¡_›_h—d
 = 
NULL
;

1411 
	`¦si_mlme_£t_chªÃls_›
(&
chªÃls_li¡_›
);

1413 
chªÃls_li¡_›_h—d
 =

1414 (
¦si_mlme_·¿m‘”s
 *)
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
chªÃls_li¡_›
, (channels_list_ie));

1415 ià(!
chªÃls_li¡_›_h—d
) {

1416 
	`SLSI_WARN
(
sdev
, "channel†ist IE‡ppend failed\n");

1417 
	`kä“_skb
(
»q
);

1418  -
EINVAL
;

1422 ià(
sÿn_ty³
 =ğ
FAPI_SCANTYPE_P2P_SCAN_FULL
) {

1423 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1424 ià(!
p
) {

1425 
	`SLSI_WARN
(
sdev
, "scan channel descriptor‡ppend failed\n");

1426 
	`kä“_skb
(
»q
);

1427  -
EINVAL
;

1429 
p
[0] = 0;

1430 
p
[1] = 0;

1431 
p
[2] = 
FAPI_SCANPOLICY_2_4GHZ
 | 
FAPI_SCANPOLICY_5GHZ
 | 
FAPI_SCANPOLICY_NON_DFS
;

1432 
p
[3] = 0;

1433 
chªÃls_li¡_›_h—d
->
Ëngth
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1437 
i
 = 0; i < 
num_chªÃls
; i++) {

1438 
chªn
 = 
chªÃls
[
i
]->
hw_v®ue
 & 0xFF;

1439 ià(!
	`¦si_mlme_is_suµÜt_bªd
(
sdev
, 
chªÃls
[
i
]->
bªd
))

1442 
n_v®id_chªÃls
++;

1443 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1444 ià(!
p
) {

1445 
	`SLSI_WARN
(
sdev
, "scan channel descriptor‡ppend failed\n");

1446 
	`kä“_skb
(
»q
);

1447  -
EINVAL
;

1449 
äeq_fw_un™
 = 2 * 
	`›“80211_chªÃl_to_äequ’cy
(
chªn
, 
chªÃls
[
i
]->
bªd
);

1450 
äeq_fw_un™
 = 
	`ıu_to_Ë16
(freq_fw_unit);

1451 
	`memıy
(
p
, &
äeq_fw_un™
, (freq_fw_unit));

1453 ià(
·ssive_sÿn
 && (
sÿn_ty³
 !ğ
FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
))

1454 
p
[2] = 
FAPI_SCANPOLICY_PASSIVE
;

1456 
p
[2] = 0;

1457 
p
[3] = 0;

1458 
chªÃls_li¡_›_h—d
->
Ëngth
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1460 ià(
n_v®id_chªÃls
 == 0) {

1461 
	`SLSI_NET_ERR
(
dev
, "no valid channelso Scan\n");

1462 
	`kä“_skb
(
»q
);

1463  -
EINVAL
;

1466 
	}
}

1468 
šlše
 
	$¦si_£t_sÿn_·¿ms
(

1469 
Ãt_deviû
 *
dev
,

1470 
u16
 
sÿn_id
,

1471 
u16
 
sÿn_ty³
,

1472 
u16
 
»pÜt_mode
,

1473 
num_ssids
,

1474 
cfg80211_ssid
 *
ssids
,

1475 
sk_buff
 *
»q
)

1477 
u8
 *
p
 = 
NULL
;

1478 
u8
 
i
;

1479 
cfg80211_ssid
 *
pssid
 = 
ssids
;

1480 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1481 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

1482 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

1485 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_sÿn_»q
.
sÿn_id
, scan_id);

1486 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_sÿn_»q
.
sÿn_ty³
, scan_type);

1487 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_sÿn_»q
.
»pÜt_mode_b™m­
, 
»pÜt_mode
);

1490 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1491 ià(
sdev
->
sÿn_addr_£t
)

1492 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_sÿn_»q
.
deviû_add»ss
, 
sdev
->
sÿn_mac_addr
);

1495 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_sÿn_»q
.
deviû_add»ss
, 
dev
->
dev_addr
);

1497 
i
 = 0; i < 
num_ssids
; i++, 
pssid
++) {

1498 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 2 + 
pssid
->
ssid_Ën
);

1499 ià(!
p
) {

1500 
	`kä“_skb
(
»q
);

1501 
	`SLSI_NET_WARN
(
dev
, "failo‡ppend SSIDƒlemento scan„equest\n");

1502  -
EINVAL
;

1505 *
p
++ = 
WLAN_EID_SSID
;

1506 *
p
++ = 
pssid
->
ssid_Ën
;

1508 ià(
pssid
->
ssid_Ën
)

1509 
	`memıy
(
p
, 
pssid
->
ssid
,…ssid->
ssid_Ën
);

1512 
	}
}

1514 
	#SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
 7

	)

1515 
	$¦si_mlme_add_sched_sÿn
(
¦si_dev
 *
sdev
,

1516 
Ãt_deviû
 *
dev
,

1517 
cfg80211_sched_sÿn_»que¡
 *
»que¡
,

1518 cÚ¡ 
u8
 *
›s
,

1519 
u16
 
›s_Ën
)

1521 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1522 
sk_buff
 *
»q
;

1523 
sk_buff
 *
rx
;

1524 
r
 = 0;

1525 
size_t
 
®loc_d©a_size
 = 0;

1526 
u32
 
i
, 
j
;

1527 
u32
 
num_ssid_f‹r_–em’ts
 = 0;

1528 
u8
 *
deçuÉ_›s
 = 
NULL
;

1529 
deçuÉ_›_Ën
 = 0;

1530 
¦si_mlme_sÿn_timšg_–em’t
 
sÿn_timšg_›
;

1531 
¦si_mlme_·¿m‘”s
 
ssid_f‹r_›_hdr
;

1533 
	`mem£t
(&
sÿn_timšg_›
, 0, (scan_timing_ie));

1534 
sÿn_timšg_›
.
h—d”
.
–em’t_id
 = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

1535 
sÿn_timšg_›
.
h—d”
.
Ëngth
 = 
SLSI_MLME_PARAM_HEADER_SIZE
 +

1536 ((
¦si_mlme_sÿn_timšg_–em’t
è- (
¦si_mlme_·¿m‘”s
));

1537 
	`¦si_mlme_put_oui
(
sÿn_timšg_›
.
h—d”
.
oui
, 
SLSI_MLME_SAMSUNG_OUI
);

1538 
	`¦si_mlme_put_oui_ty³
(&
sÿn_timšg_›
.
h—d”
, 
SLSI_MLME_TYPE_SCAN_PARAM
, 
SLSI_MLME_SUBTYPE_SCAN_TIMING
);

1539 
sÿn_timšg_›
.
expÚ’t
 = 0x1;

1540 
sÿn_timšg_›
.
¡•_couÁ
 = 0x1;

1542 
	`mem£t
(&
ssid_f‹r_›_hdr
, 0, (ssid_filter_ie_hdr));

1543 
ssid_f‹r_›_hdr
.
–em’t_id
 = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

1544 
ssid_f‹r_›_hdr
.
Ëngth
 = 
SLSI_MLME_PARAM_HEADER_SIZE
;

1545 
	`¦si_mlme_put_oui
(
ssid_f‹r_›_hdr
.
oui
, 
SLSI_MLME_SAMSUNG_OUI
);

1546 
	`¦si_mlme_put_oui_ty³
(&
ssid_f‹r_›_hdr
, 
SLSI_MLME_TYPE_SCAN_PARAM
, 
SLSI_MLME_SUBTYPE_SSID_FILTER
);

1548 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1549 
	`SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

1550  -
EOPNOTSUPP
;

1553 ià(
	`WARN_ON
(!(
dev
->
dev_addr
)))

1554  -
EINVAL
;

1556 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
));

1558 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1559 ià(
»que¡
->
æags
 & 
NL80211_SCAN_FLAG_RANDOM_ADDR
) {

1560 ià(
sdev
->
fw_mac_¿ndomiz©iÚ_’abËd
) {

1561 
	`memıy
(
sdev
->
sÿn_mac_addr
, 
»que¡
->
mac_addr
, 
ETH_ALEN
);

1562 
r
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
»que¡
->
mac_addr_mask
);

1563 ià(!
r
)

1564 
sdev
->
sÿn_addr_£t
 = 1;

1566 
	`SLSI_NET_INFO
(
dev
, "Mac Randomization is‚otƒnabled in Firmware\n");

1567 
sdev
->
sÿn_addr_£t
 = 0;

1571 ià(
sdev
->
deçuÉ_sÿn_›s_Ën
 > 0)

1572 
deçuÉ_›s
 = 
	`¦si_g‘_sÿn_exŒa_›s
(
sdev
, 
›s
, 
›s_Ën
, &
deçuÉ_›_Ën
);

1574 
®loc_d©a_size
 +ğ(
sÿn_timšg_›
è+ 
›s_Ën
 + 
SLSI_SCAN_PRIVATE_IE_CHANNEL_LIST_HEADER_LEN
 +

1575 (
»que¡
->
n_chªÃls
 * 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1577 ià(
deçuÉ_›s
 && 
deçuÉ_›_Ën
 > 0)

1578 
®loc_d©a_size
 +ğ
deçuÉ_›_Ën
;

1580 
i
 = 0; i < 
»que¡
->
n_ssids
; i++) {

1582 
®loc_d©a_size
 +ğ(2 + 
»que¡
->
ssids
[
i
].
ssid_Ën
);

1585 ià(
»que¡
->
n_m©ch_£ts
) {

1586 
num_ssid_f‹r_–em’ts
 = (
»que¡
->
n_m©ch_£ts
 / 
SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
) + 1;

1588 
®loc_d©a_size
 +ğ238 * 
num_ssid_f‹r_–em’ts
;

1591 
»q
 = 
	`çpi_®loc
(
mlme_add_sÿn_»q
, 
MLME_ADD_SCAN_REQ
, 0, 
®loc_d©a_size
);

1592 ià(!
»q
)

1593  -
ENOMEM
;

1595 
r
 = 
	`¦si_£t_sÿn_·¿ms
(
dev
, (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_SCHED_ID
),

1596 
FAPI_SCANTYPE_SCHEDULED_SCAN
,

1597 
FAPI_REPORTMODE_REAL_TIME
,

1598 
»que¡
->
n_ssids
,

1599 
»que¡
->
ssids
,

1600 
»q
);

1601 ià(
r
) {

1602 
	`kä“
(
deçuÉ_›s
);

1603  
r
;

1606 #ifdeà
CONFIG_SCSC_WLAN_EXPONENTIAL_SCHED_SCAN


1607 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
[0].
š‹rv®
 * 
USEC_PER_SEC
, &
sÿn_timšg_›
.
mš_³riod
);

1608 ià(
»que¡
->
n_sÿn_¶ªs
 > 1 &&„eque¡->
sÿn_¶ªs
[0].
š‹rv®
 <„equest->scan_plans[1].interval) {

1609 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
[1].
š‹rv®
 * 
USEC_PER_SEC
, &
sÿn_timšg_›
.
max_³riod
);

1610 
sÿn_timšg_›
.
expÚ’t
 = 
»que¡
->
sÿn_¶ªs
[1].
š‹rv®
 /„equest->scan_plans[0].interval;

1611 
sÿn_timšg_›
.
¡•_couÁ
 = 
»que¡
->
sÿn_¶ªs
[0].
™”©iÚs
;

1613 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
[0].
š‹rv®
 * 
USEC_PER_SEC
, &
sÿn_timšg_›
.
max_³riod
);

1614 
sÿn_timšg_›
.
expÚ’t
 = 1;

1615 
sÿn_timšg_›
.
¡•_couÁ
 = 0;

1618 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
->
š‹rv®
 * 
USEC_PER_SEC
, &
sÿn_timšg_›
.
mš_³riod
);

1619 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
->
š‹rv®
 * 
USEC_PER_SEC
, &
sÿn_timšg_›
.
max_³riod
);

1620 ià(
»que¡
->
sÿn_¶ªs
->
™”©iÚs
 < 0xFFFF)

1621 
	`SLSI_U16_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
->
™”©iÚs
, &
sÿn_timšg_›
.
numb”_of_™”©iÚs
);

1623 
	`SLSI_U16_TO_BUFF_LE
(0xFFFF, &
sÿn_timšg_›
.
numb”_of_™”©iÚs
);

1627 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
sÿn_timšg_›
, (scan_timing_ie));

1628 
	`çpi_­³nd_d©a
(
»q
, 
›s
, 
›s_Ën
);

1629 ià(
deçuÉ_›s
 !ğ
NULL
 && 
deçuÉ_›_Ën
 > 0) {

1630 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Aµ’dšg deçuÉ_›_ËÀ%d\n", 
deçuÉ_›_Ën
);

1631 
	`çpi_­³nd_d©a
(
»q
, 
deçuÉ_›s
, 
deçuÉ_›_Ën
);

1632 
	`kä“
(
deçuÉ_›s
);

1635 ià(
»que¡
->
n_m©ch_£ts
) {

1636 
cfg80211_m©ch_£t
 *
m©ch_£ts
 = 
»que¡
->match_sets;

1637 
u8
 *
ssid_f‹r_›
;

1639 
j
 = 0; j < 
num_ssid_f‹r_–em’ts
; j++) {

1640 
ssid_f‹r_›
 = 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
ssid_f‹r_›_hdr
, (ssid_filter_ie_hdr));

1641 ià(!
ssid_f‹r_›
) {

1642 
	`kä“_skb
(
»q
);

1643 
	`SLSI_ERR
(
sdev
, "ssid_filter_ie‡ppend failed\n");

1644  -
EIO
;

1646 
i
 = 0; i < 
SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
; i++, 
m©ch_£ts
++) {

1647 ià((
j
 * 
SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
è+ 
i
 >ğ
»que¡
->
n_m©ch_£ts
)

1649 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "SSID: %.*s",

1650 
m©ch_£ts
->
ssid
.
ssid_Ën
, match_sets->ssid.ssid);

1651 
ssid_f‹r_›
[1] +ğ(1 + 
m©ch_£ts
->
ssid
.
ssid_Ën
);

1652 
	`çpi_­³nd_d©a
(
»q
, &
m©ch_£ts
->
ssid
.
ssid_Ën
, 1);

1653 
	`çpi_­³nd_d©a
(
»q
, 
m©ch_£ts
->
ssid
.ssid, m©ch_£ts->ssid.
ssid_Ën
);

1658 ià(
»que¡
->
n_chªÃls
) {

1659 
r
 = 
	`¦si_mlme_­³nd_chªÃl_li¡
(
sdev
, 
dev
, 
»q
, 
»que¡
->
n_chªÃls
,„eque¡->
chªÃls
,

1660 
FAPI_SCANTYPE_SCHEDULED_SCAN
, 
»que¡
->
n_ssids
 == 0);

1661 ià(
r
)

1662  
r
;

1665 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_SCAN_CFM
);

1666 ià(!
rx
)

1667  -
EIO
;

1669 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1670 
	`SLSI_NET_ERR
(
dev
, "mlme_add_scan_cfm(result:0x%04x) ERROR\n",

1671 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
));

1672 
r
 = -
EINVAL
;

1675 
	`kä“_skb
(
rx
);

1676  
r
;

1677 
	}
}

1679 
¦si_mlme_add_sÿn
(

1680 
¦si_dev
 *
sdev
,

1681 
Ãt_deviû
 *
dev
,

1682 
u16
 
sÿn_ty³
,

1683 
u16
 
»pÜt_mode
,

1684 
u32
 
n_ssids
,

1685 
cfg80211_ssid
 *
ssids
,

1686 
u32
 
n_chªÃls
,

1687 
›“80211_chªÃl
 *
chªÃls
[],

1688 *
gsÿn
,

1689 cÚ¡ 
u8
 *
›s
,

1690 
u16
 
›s_Ën
,

1691 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


1692 
u32
 
n_6ghz_·¿ms
,

1693 
cfg80211_sÿn_6ghz_·¿ms
 *
sÿn_6ghz_·¿ms
,

1695 
boŞ
 
wa™_fÜ_šd
)

1697 
Ãtdev_vif
 *
	gndev_vif
 = 
Ãtdev_´iv
(
dev
);

1698 
sk_buff
 *
	g»q
;

1699 
sk_buff
 *
	grx
;

1700 
	gr
 = 0;

1701 
size_t
 
	g®loc_d©a_size
 = 0;

1702 
u32
 
	gi
;

1703 
u8
 *
	gdeçuÉ_›s
 = 
NULL
;

1704 
	gdeçuÉ_›_Ën
 = 0;

1705 
¦si_mlme_sÿn_timšg_–em’t
 
	gsÿn_timšg_›
;

1707 
mem£t
(&
sÿn_timšg_›
, 0, (scan_timing_ie));

1708 
	gsÿn_timšg_›
.
	gh—d”
.
	g–em’t_id
 = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

1709 
	gsÿn_timšg_›
.
	gh—d”
.
	gËngth
 = 
SLSI_MLME_PARAM_HEADER_SIZE
 +

1710 ((
¦si_mlme_sÿn_timšg_–em’t
è- (
¦si_mlme_·¿m‘”s
));

1711 
¦si_mlme_put_oui
(
sÿn_timšg_›
.
h—d”
.
oui
, 
SLSI_MLME_SAMSUNG_OUI
);

1712 
¦si_mlme_put_oui_ty³
(&
sÿn_timšg_›
.
h—d”
, 
SLSI_MLME_TYPE_SCAN_PARAM
, 
SLSI_MLME_SUBTYPE_SCAN_TIMING
);

1714 ià(
¦si_is_‹¡_mode_’abËd
()) {

1715 
SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

1716  -
	gEOPNOTSUPP
;

1719 ià(
WARN_ON
(!(
dev
->
dev_addr
)))

1720  -
	gEINVAL
;

1722 
WARN_ON
(!
SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
));

1723 
SLSI_INFO
(
sdev
, "scan started for id:0x%x,‚_channels:%d,‚_ssids:%d, scan_type:%d\n",

1724 (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
), 
n_chªÃls
, 
n_ssids
, 
sÿn_ty³
);

1726 ià(!
	ggsÿn
 && 
	gsdev
->
	gdeçuÉ_sÿn_›s_Ën
 > 0)

1727 
	gdeçuÉ_›s
 = 
¦si_g‘_sÿn_exŒa_›s
(
sdev
, 
›s
, 
›s_Ën
, &
deçuÉ_›_Ën
);

1729 
	g®loc_d©a_size
 +ğ(
sÿn_timšg_›
) +

1730 
›s_Ën
 +

1731 (
SLSI_SCAN_PRIVATE_IE_CHANNEL_LIST_HEADER_LEN
 + (
n_chªÃls
 * 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
));

1732 ià(!
	ggsÿn
 && 
	gdeçuÉ_›s
 !ğ
NULL
 && 
deçuÉ_›_Ën
 > 0)

1733 
®loc_d©a_size
 +ğ
deçuÉ_›_Ën
;

1735 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


1736 
	g®loc_d©a_size
 +ğ
¦si_mlme_g‘_6hz_·¿m_size
(
n_6ghz_·¿ms
);

1739 
	gi
 = 0; i < 
	gn_ssids
; i++)

1740 
	g®loc_d©a_size
 +ğ2 + 
ssids
[
i
].
ssid_Ën
;

1742 
	g»q
 = 
çpi_®loc
(
mlme_add_sÿn_»q
, 
MLME_ADD_SCAN_REQ
, 0, 
®loc_d©a_size
);

1743 ià(!
	g»q
) {

1744 
kä“
(
deçuÉ_›s
);

1745  -
	gENOMEM
;

1748 ià(!
	ggsÿn
) {

1749 
	gr
 = 
¦si_£t_sÿn_·¿ms
(

1750 
dev
,

1751 (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
),

1752 
sÿn_ty³
,

1753 
»pÜt_mode
,

1754 
n_ssids
,

1755 
ssids
,

1756 
»q
);

1757 ià(
	gr
)

1758  
	gr
;

1760 
çpi_­³nd_d©a
(
»q
, (
u8
 *)&
sÿn_timšg_›
, (scan_timing_ie));

1761 
çpi_­³nd_d©a
(
»q
, 
›s
, 
›s_Ën
);

1762 ià(
	gdeçuÉ_›s
 && 
	gdeçuÉ_›_Ën
 > 0) {

1763 
SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Aµ’dšg deçuÉ_›_Ën: %d\n", 
deçuÉ_›_Ën
);

1764 
çpi_­³nd_d©a
(
»q
, 
deçuÉ_›s
, 
deçuÉ_›_Ën
);

1765 
kä“
(
deçuÉ_›s
);

1768 ià(
	gn_chªÃls
) {

1769 
	gr
 = 
¦si_mlme_­³nd_chªÃl_li¡
(
sdev
, 
dev
, 
»q
, 
n_chªÃls
, 
chªÃls
, 
sÿn_ty³
,

1770 
n_ssids
 == 0);

1771 ià(
	gr
)

1772  
	gr
;

1775 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1777 
¦si_gsÿn_·¿m
 *
	ggsÿn_·¿m
 = (¦si_gsÿn_·¿m *)
gsÿn
;

1779 
	gr
 = 
¦si_£t_sÿn_·¿ms
(

1780 
dev
,

1781 
gsÿn_·¿m
->
buck‘
->
sÿn_id
,

1782 
sÿn_ty³
,

1783 
»pÜt_mode
,

1784 
n_ssids
,

1785 
ssids
,

1786 
»q
);

1787 ià(
	gr
)

1788  
	gr
;

1790 
SLSI_U32_TO_BUFF_LE
((
gsÿn_·¿m
->
Æ_buck‘
->
³riod
 * 
USEC_PER_MSEC
), &
sÿn_timšg_›
.
mš_³riod
);

1791 ià(
	ggsÿn_·¿m
->
	gÆ_buck‘
->
	gexpÚ’t
) {

1792 
SLSI_U32_TO_BUFF_LE
((
gsÿn_·¿m
->
Æ_buck‘
->
max_³riod
 * 
USEC_PER_MSEC
),

1793 &
sÿn_timšg_›
.
max_³riod
);

1794 
	gsÿn_timšg_›
.
	gexpÚ’t
 = 
gsÿn_·¿m
->
Æ_buck‘
->
expÚ’t
;

1795 
	gsÿn_timšg_›
.
	g¡•_couÁ
 = 
gsÿn_·¿m
->
Æ_buck‘
->
¡•_couÁ
;

1797 
çpi_­³nd_d©a
(
»q
, (
u8
 *)&
sÿn_timšg_›
, (scan_timing_ie));

1799 
	gr
 = 
¦si_mlme_­³nd_gsÿn_chªÃl_li¡
(
sdev
, 
dev
, 
»q
, 
gsÿn_·¿m
->
Æ_buck‘
);

1800 ià(
	gr
)

1801  
	gr
;

1805 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


1806 
	gr
 = 
¦si_mlme_­³nd_6hz_·¿m
(
sdev
, 
dev
, 
»q
, 
n_6ghz_·¿ms
, 
sÿn_6ghz_·¿ms
);

1807 ià(
	gr
)

1808  
	gr
;

1811 ià(
	gwa™_fÜ_šd
) {

1813 
	grx
 = 
¦si_mlme_»q_cfm_šd
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_SCAN_CFM
, 
MLME_SCAN_DONE_IND
, 
¦si_sÿn_cfm_v®id©e
);

1814 ià(!
	grx
)

1815  -
	gEIO
;

1816 
SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "mlme_scan_done_ind()\n");

1824 
	grx
 = 
¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_SCAN_CFM
);

1825 ià(!
	grx
)

1826  -
	gEIO
;

1827 ià(
çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1828 
SLSI_NET_ERR
(
dev
, "mlme_add_scan_cfm(result:0x%04x) ERROR\n",

1829 
çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
));

1830 
	gr
 = -
EINVAL
;

1833 
kä“_skb
(
rx
);

1834  
	gr
;

1837 
	$¦si_mlme_d–_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_timed_out
)

1839 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1840 
sk_buff
 *
»q
;

1841 
sk_buff
 *
cfm
;

1842 
r
 = 0;

1844 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1845 
	`SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

1846  -
EOPNOTSUPP
;

1849 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_d–_sÿn_»q(sÿn_id:%d)\n", 
sÿn_id
);

1851 ià((
sÿn_id
 & 0xFFè=ğ
SLSI_SCAN_HW_ID
 && 
ndev_vif
->
sÿn
[SLSI_SCAN_HW_ID].
sÿn_»q
 && !
sÿn_timed_out
)

1852 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

1854 
»q
 = 
	`çpi_®loc
(
mlme_d–_sÿn_»q
, 
MLME_DEL_SCAN_REQ
, 0, 0);

1855 ià(!
»q
)

1856  -
ENOMEM
;

1857 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_sÿn_»q
.
sÿn_id
, scan_id);

1860 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_DEL_SCAN_CFM
);

1861 ià(!
cfm
)

1862  -
EIO
;

1864 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1865 
	`SLSI_NET_ERR
(
dev
, "mlme_del_scan_cfm(result:0x%04x) ERROR\n",

1866 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_sÿn_cfm
.
»suÉ_code
));

1867 
r
 = -
EINVAL
;

1870 
	`kä“_skb
(
cfm
);

1871  
r
;

1872 
	}
}

1874 
	$¦si_­_add_ext_ÿ·b_›
(
sk_buff
 *
»q
, 
Ãtdev_vif
 *
ndev_vif
, cÚ¡ 
u8
 *
´ev_ext
)

1876 
u8
 
ext_ÿ·_›
[
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
];

1877 
i
;

1878 
´ev_Ën
 = 0;

1880 
ext_ÿ·_›
[0] = 
WLAN_EID_EXT_CAPABILITY
;

1881 
ext_ÿ·_›
[1] = 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
 - 1 - 1;

1882 ià(
´ev_ext
) {

1883 
´ev_Ën
 = 
´ev_ext
[1];

1884 
i
 = 2; i < 
´ev_Ën
 + 2; i++)

1885 
ext_ÿ·_›
[
i
] = 
´ev_ext
[i];

1887 
i
 = 
´ev_Ën
 + 2; i < 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
; i++)

1888 
ext_ÿ·_›
[
i
] = 0x00;

1889 
	`SLSI_DBG3
(
ndev_vif
->
sdev
, 
SLSI_MLME
, "New Ext capab Added\n");

1891 
ext_ÿ·_›
[9] |= 0x40;

1893 
	`çpi_­³nd_d©a
(
»q
, &
ext_ÿ·_›
[0], 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
);

1894 
	}
}

1896 
	$¦si_´•¬e_couÁry_›
(
¦si_dev
 *
sdev
, 
u16
 
ûÁ”_äeq
, 
u8
 *
couÁry_›
, u8 **
Ãw_couÁry_›
)

1898 
›“80211_suµÜ‹d_bªd
 
bªd
;

1899 
›“80211_»g_ruË
 *
ruË
;

1900 
›“80211_chªÃl
 *
chªÃls
;

1901 
u8
 *
›
;

1902 
off£t
 = 0;

1903 
i
;

1906 ià(
ûÁ”_äeq
 < 5180)

1907 
bªd
 = 
¦si_bªd_2ghz
;

1909 
bªd
 = 
¦si_bªd_5ghz
;

1912 
›
 = 
	`km®loc
(5 + (
bªd
.
n_chªÃls
 * 3), 
GFP_KERNEL
);

1913 ià(!
›
) {

1914 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate memory\n");

1915  -
ENOMEM
;

1919 
›
[
off£t
++] = 
couÁry_›
[0];

1920 
›
[
off£t
++] = 0;

1921 
›
[
off£t
++] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[0];

1922 
›
[
off£t
++] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[1];

1923 
›
[
off£t
++] = 
couÁry_›
[4];

1925 
chªÃls
 = 
bªd
.channels;

1926 
i
 = 0; i < 
bªd
.
n_chªÃls
; i++, 
chªÃls
++) {

1928 
ruË
 = 
	`¦si_g‘_»g_ruË
(
	`MHZ_TO_KHZ
(
chªÃls
->
ûÁ”_äeq
), &
sdev
->
deviû_cÚfig
.
domaš_šfo
);

1929 ià(
ruË
) {

1930 
›
[
off£t
++] = 
chªÃls
->
hw_v®ue
;

1931 
›
[
off£t
++] = 1;

1932 
›
[
off£t
++] = 
	`MBM_TO_DBM
(
ruË
->
pow”_ruË
.
max_eœp
);

1936 
›
[1] = 
off£t
 - 2;

1937 *
Ãw_couÁry_›
 = 
›
;

1940 
	}
}

1942 
	$¦si_modify_›s
(
Ãt_deviû
 *
dev
, 
u8
 
eid
, u8 *
›s
, 
›s_Ën
, u8 
›_šdex
, u8 
›_v®ue
)

1944 
u8
 *
›
;

1946 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "eid: %d, ie_v®uğ0x%x\n", 
eid
, 
›_v®ue
);

1948 
›
 = (
u8
 *)
	`cfg80211_fšd_›
(
eid
, 
›s
, 
›s_Ën
);

1949 ià(
›
) {

1950 
eid
) {

1951 
WLAN_EID_HT_CAPABILITY
:

1952 
WLAN_EID_VHT_CAPABILITY
:

1953 
›
[
›_šdex
] |ğ
›_v®ue
;

1955 
WLAN_EID_DS_PARAMS
:

1956 
WLAN_EID_HT_OPERATION
:

1957 ià(
›_šdex
 == 2)

1958 
›
[
›_šdex
] = 
›_v®ue
;

1960 
›
[
›_šdex
] |ğ
›_v®ue
;

1963 
	`SLSI_NET_WARN
(
dev
, "¦si_modify_›s: IEy³ mism©ch : %d\n", 
eid
);

1964  
çl£
;

1966  
Œue
;

1968 
	`SLSI_NET_WARN
(
dev
, "¦si_modify_›s: IE‚Ù found : %d\n", 
eid
);

1969  
çl£
;

1970 
	}
}

1972 
	$¦si_mlme_¡¬t_´•¬e_›s
(
sk_buff
 *
»q
, 
Ãtdev_vif
 *
ndev_vif
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, cÚ¡ 
u8
 *
w·_›_pos
, cÚ¡ u8 *
wmm_›_pos
)

1974 cÚ¡ 
u8
 *
wps_›
, *
vht_ÿ·b_›
, *
_pos
 = 
NULL
, *
ext_ÿ·b_›
;

1975 
size_t
 
b—cÚ_›_Ën
 = 0, 
_Ëngth
 = 0;

1976 
u8
 *
couÁry_›
;

1977 cÚ¡ 
u8
 *
b—cÚ_
 = 
£‰šgs
->
b—cÚ
.

;

1978 
size_t
 
b—cÚ__Ën
 = 
£‰šgs
->
b—cÚ
.
_Ën
;

1984 
couÁry_›
 = (
u8
 *)
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
b—cÚ_
, 
b—cÚ__Ën
);

1985 ià(
couÁry_›
) {

1986 
u8
 *
Ãw_couÁry_›
 = 
NULL
;

1988 
	`SLSI_DBG3
(
ndev_vif
->
sdev
, 
SLSI_MLME
, "CouÁry IE found,†’gth = %d", 
couÁry_›
[1]);

1991 ià(
	`¦si_´•¬e_couÁry_›
(
ndev_vif
->
sdev
,‚dev_vif->
chª
->
ûÁ”_äeq
, 
couÁry_›
, &
Ãw_couÁry_›
) != 0)

1992 
	`SLSI_ERR
(
ndev_vif
->
sdev
, "Failedo…repare country IE");

1995 ià(
Ãw_couÁry_›
) {

1997 
	`çpi_­³nd_d©a
(
»q
, 
Ãw_couÁry_›
, (new_country_ie[1] + 2));

2000 
	`kä“
(
Ãw_couÁry_›
);

2003 
b—cÚ_
 +ğ(
couÁry_›
[1] + 2);

2004 
b—cÚ__Ën
 -ğ(
couÁry_›
[1] + 2);

2009 ià(
ndev_vif
->
­
.
nÚ_ht_bss_´e£Á
) {

2010 
u8
 
İ_mode
 = 1;

2012 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_MLME
, "Modify Operating mode of BSS in HT IE\n");

2013 
	`¦si_modify_›s
(
ndev_vif
->
wdev
.
Ãtdev
, 
WLAN_EID_HT_OPERATION
, (
u8
 *)
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
, 4, 
İ_mode
);

2014 
ndev_vif
->
­
.
nÚ_ht_bss_´e£Á
 = 
çl£
;

2024 ià(
wmm_›_pos
)

2025 
b—cÚ_›_Ën
 = 
wmm_›_pos
 - 
b—cÚ_
;

2028 
wps_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
b—cÚ_
, 
b—cÚ__Ën
);

2029 ià(
wps_›
)

2030 
b—cÚ_›_Ën
 = 
wps_›
 - 
b—cÚ_
;

2032 
b—cÚ_›_Ën
 = 
b—cÚ__Ën
;

2036 ià(
w·_›_pos
) {

2037 
size_t
 
Ën_befÜe
, 
Ën
;

2039 
Ën_befÜe
 = 
w·_›_pos
 - 
b—cÚ_
;

2040 
	`çpi_­³nd_d©a
(
»q
, 
b—cÚ_
, 
Ën_befÜe
);

2042 
Ën
 = 
Ën_befÜe
 + 
ndev_vif
->
­
.
w·_›_Ën
;

2044 ià(
b—cÚ_›_Ën
 > 
Ën
) {

2045 
_Ëngth
 = 
b—cÚ_›_Ën
 - 
Ën
;

2046 
_pos
 = (
b—cÚ_
 + 
Ën
);

2050 
_Ëngth
 = 
b—cÚ_›_Ën
;

2051 
_pos
 = 
b—cÚ_
;

2055 ià(
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_80
) {

2057 
vht_ÿ·b_›
 = (
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
_pos
, 
_Ëngth
));

2058 
ext_ÿ·b_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
_pos
, 
_Ëngth
);

2059 
_Ëngth
 > 2) {

2060 ià(
_pos
[0] =ğ
WLAN_EID_VHT_CAPABILITY
)

2061 
	`¦si_­_add_ext_ÿ·b_›
(
»q
, 
ndev_vif
, 
ext_ÿ·b_›
);

2062 ià(
_pos
[0] !ğ
WLAN_EID_EXT_CAPABILITY
 &&a_pos[0] !ğ
WLAN_EID_VHT_OPERATION
)

2063 
	`çpi_­³nd_d©a
(
»q
, 
_pos
,ail_pos[1] + 2);

2065 
_Ëngth
 -ğ
_pos
[1] + 2;

2066 
_pos
 +=ail_pos[1] + 2;

2068 ià(!
vht_ÿ·b_›
)

2069 
	`¦si_­_add_ext_ÿ·b_›
(
»q
, 
ndev_vif
, 
ext_ÿ·b_›
);

2071 
	`çpi_­³nd_d©a
(
»q
, 
_pos
, 
_Ëngth
);

2073 
	}
}

2077 
	#SLSI_VHT_CAPABILITIES_IE_LEN
 14

	)

2081 
	#SLSI_VHT_OPERATION_IE_LEN
 7

	)

2083 
	$¦si_´•¬e_vht_›s
(
Ãt_deviû
 *
dev
, 
u8
 **
vht_›_ÿ·b
, u8 **
vht_›_İ”©iÚ
)

2085 
u32
 
ÿ·bs
;

2086 
u16
 
mcs
;

2087 
u8
 *
p_ÿp
, *
p_İ”
;

2088 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2090 *
vht_›_ÿ·b
 = 
	`km®loc
(
SLSI_VHT_CAPABILITIES_IE_LEN
, 
GFP_KERNEL
);

2091 ià(!(*
vht_›_ÿ·b
))

2092  -
EINVAL
;

2093 *
vht_›_İ”©iÚ
 = 
	`km®loc
(
SLSI_VHT_OPERATION_IE_LEN
, 
GFP_KERNEL
);

2094 ià(!(*
vht_›_İ”©iÚ
)) {

2095 
	`kä“
(*
vht_›_ÿ·b
);

2096  -
EINVAL
;

2099 
p_ÿp
 = *
vht_›_ÿ·b
;

2100 
p_İ”
 = *
vht_›_İ”©iÚ
;

2102 *
p_ÿp
++ = 
WLAN_EID_VHT_CAPABILITY
;

2103 *
p_ÿp
++ = 
SLSI_VHT_CAPABILITIES_IE_LEN
 - 1 - 1;

2104 
ÿ·bs
 = 
	`ıu_to_Ë32
(
¦si_vht_ÿp
.
ÿp
);

2105 
	`memıy
(
p_ÿp
, &
ÿ·bs
, (capabs));

2106 
p_ÿp
 +ğ(
ÿ·bs
);

2107 
	`memıy
(
p_ÿp
, &
¦si_vht_ÿp
.
vht_mcs
, (slsi_vht_cap.vht_mcs));

2109 *
p_İ”
++ = 
WLAN_EID_VHT_OPERATION
;

2110 *
p_İ”
++ = 
SLSI_VHT_OPERATION_IE_LEN
 - 1 - 1;

2111 *
p_İ”
++ = 
IEEE80211_VHT_CHANWIDTH_80MHZ
;

2112 *
p_İ”
++ = 
	`›“80211_äequ’cy_to_chªÃl
(
ndev_vif
->
chªdef
->
ûÁ”_äeq1
);

2113 *
p_İ”
++ = 0;

2114 
mcs
 = 
	`ıu_to_Ë16
(0xfffc);

2115 
	`memıy
(
p_İ”
, &
mcs
, (mcs));

2118 
	}
}

2120 
	$¦si_mlme_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, cÚ¡ u8 *
w·_›_pos
, cÚ¡ u8 *
wmm_›_pos
, 
boŞ
 
­³nd_vht_›s
)

2122 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2123 
sk_buff
 *
»q
;

2124 
sk_buff
 *
cfm
;

2125 
›“80211_mgmt
 *
mgmt
;

2126 
r
 = 0;

2127 
u8
 *
p
;

2128 
Æ80211_auth_ty³
 
auth_ty³
 = 
£‰šgs
->auth_type;

2129 
u16
 
b—cÚ_›_h—d_Ën
;

2130 
u16
 
chª_šfo
;

2131 
u16
 
fw_äeq
;

2132 
u16
 
vht_›s_Ën
 = 0;

2133 
u8
 
ext_ÿ·b_Ën
 = 0;

2134 
u16
 
chªÃl_’code
 = 0;

2135 cÚ¡ 
u8
 *
»cv_vht_ÿ·b_›
, *
»cv_vht_İ”©iÚ_›
;

2136 
u8
 *
vht_›_ÿ·b
, *
vht_›_İ”©iÚ
;

2137 
u8
 
bss_cŞÜ_›_Ën
 = 0;

2138 #ià(
	`KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE
)

2139 cÚ¡ 
u8
 *
mu_edÿ_›_pos
 = 
NULL
;

2141 
u16
 
mu_edÿ_›_Ën
 = 0;

2142 
u16
 
tÙ®_Ën
 = 0;

2143 
	`SLSI_UNUSED_PARAMETER
(
bssid
);

2145 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2146 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_START.request\n");

2147  -
EOPNOTSUPP
;

2150 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2152 
mgmt
 = (
›“80211_mgmt
 *)
£‰šgs
->
b—cÚ
.
h—d
;

2153 
b—cÚ_›_h—d_Ën
 = 
£‰šgs
->
b—cÚ
.
h—d_Ën
 - ((
u8
 *)
mgmt
->
u
.b—cÚ.
v¬ŸbË
 - (u8 *)mgmt);

2156 
ndev_vif
->
­
.
´ivacy
 = (
mgmt
->
u
.
b—cÚ
.
ÿ·b_šfo
 & 
WLAN_CAPABILITY_PRIVACY
);

2157 
ndev_vif
->
­
.
qos_’abËd
 = (
mgmt
->
u
.
b—cÚ
.
ÿ·b_šfo
 & 
WLAN_CAPABILITY_QOS
);

2159 
auth_ty³
) {

2160 
NL80211_AUTHTYPE_OPEN_SYSTEM
:

2161 
NL80211_AUTHTYPE_SHARED_KEY
:

2163 
NL80211_AUTHTYPE_AUTOMATIC
:

2164 
auth_ty³
 = 
NL80211_AUTHTYPE_OPEN_SYSTEM
;

2165 ià(
£‰šgs
->
´ivacy
 && s‘tšgs->
üy±o
.
ch”_group
 == 0)

2166 
auth_ty³
 = 
NL80211_AUTHTYPE_SHARED_KEY
;

2169 
	`SLSI_NET_ERR
(
dev
, "UnsuµÜ‹d‡uth_ty³: %d\n", 
auth_ty³
);

2170  -
EOPNOTSUPP
;

2173 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_¡¬t_»q(vif:%u, bssid:%pM, ssid:%.*s, hidd’:%d)\n", 
ndev_vif
->
iâum
, 
bssid
, ()
£‰šgs
->
ssid_Ën
, s‘tšgs->
ssid
, s‘tšgs->
hidd’_ssid
);

2175 ià(
­³nd_vht_›s
) {

2176 
vht_›s_Ën
 = 
SLSI_VHT_CAPABILITIES_IE_LEN
 + 
SLSI_VHT_OPERATION_IE_LEN
;

2178 
»cv_vht_ÿ·b_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

,

2179 
£‰šgs
->
b—cÚ
.
_Ën
);

2180 ià(
»cv_vht_ÿ·b_›
)

2181 
vht_›s_Ën
 -ğ(
»cv_vht_ÿ·b_›
[1] + 2);

2183 
»cv_vht_İ”©iÚ_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_OPERATION
, 
£‰šgs
->
b—cÚ
.

,

2184 
£‰šgs
->
b—cÚ
.
_Ën
);

2185 ià(
»cv_vht_İ”©iÚ_›
)

2186 
vht_›s_Ën
 -ğ(
»cv_vht_İ”©iÚ_›
[1] + 2);

2188 ià(
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_80
) {

2192 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VHT - Ext Capab IEo be included\n");

2193 
ext_ÿ·b_Ën
 = 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
;

2196 #ià(
	`KERNEL_VERSION
(5, 7, 0è<ğ
LINUX_VERSION_CODE
è|| 
	`defšed
(
CONFIG_SCSC_WLAN_BSS_COLOR
)

2197 ià(
	`cfg80211_fšd_ext_›
(
WLAN_EID_EXT_HE_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
)) {

2198 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "HE - BSS COLOR IEo be included\n");

2199 
bss_cŞÜ_›_Ën
 = 
SLSI_WLAN_HE_BSS_COLOR_IE_LEN
;

2203 #ià(
	`KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE
)

2204 
mu_edÿ_›_pos
 = 
	`cfg80211_fšd_ext_›
(
WLAN_EID_EXT_HE_MU_EDCA
, 
£‰šgs
->
b—cÚ
.

,

2205 
£‰šgs
->
b—cÚ
.
_Ën
);

2206 ià(
mu_edÿ_›_pos
) {

2207 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "HE - MU_EDCA IEo be included\n");

2208 
mu_edÿ_›_Ën
 = *(
mu_edÿ_›_pos
 + 1) + 2;

2212 
tÙ®_Ën
 = 
b—cÚ_›_h—d_Ën


2213 + 
£‰šgs
->
b—cÚ
.
_Ën
 + 
vht_›s_Ën


2214 + 
ext_ÿ·b_Ën
 + 
bss_cŞÜ_›_Ën
 + 
mu_edÿ_›_Ën
;

2216 ià(
£‰šgs
->
hidd’_ssid
 == 1)

2217 
tÙ®_Ën
 +ğ
£‰šgs
->
ssid_Ën
;

2219 
»q
 = 
	`çpi_®loc
(
mlme_¡¬t_»q
, 
MLME_START_REQ
, 
ndev_vif
->
iâum
, 
tÙ®_Ën
);

2221 ià(!
»q
)

2222  -
ENOMEM
;

2223 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_¡¬t_»q
.
bssid
, 
dev
->
dev_addr
);

2224 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
b—cÚ_³riod
, 
£‰šgs
->
b—cÚ_š‹rv®
);

2225 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
dtim_³riod
, 
£‰šgs
->dtim_period);

2226 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
ÿ·b™y_šfÜm©iÚ
, 
	`Ë16_to_ıu
(
mgmt
->u.
b—cÚ
.
ÿ·b_šfo
));

2227 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
auth’tiÿtiÚ_ty³
, 
auth_ty³
);

2228 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
hidd’_ssid
, 
£‰šgs
->hidd’_ssid < 3 ? s‘tšgs->hidd’_ssid : 
NL80211_HIDDEN_SSID_ZERO_LEN
);

2229 
chªÃl_’code
 = 
ndev_vif
->
acs
 =ğ
Œue
 ? 0 : 1;

2230 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
chªÃl_cÚfigu¿tiÚ
, 
chªÃl_’code
);

2231 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_¡¬t_»q
.
¥¬e_1
, 0);

2232 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 10, 0))

2233 ià(
£‰šgs
->
üy±o
.
§e_pwe
 =ğ
NL80211_SAE_PWE_HASH_TO_ELEMENT
)

2234 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_¡¬t_»q
.
¥¬e_1
, 0x00000001);

2236 
fw_äeq
 = 
ndev_vif
->
chª
->
ûÁ”_äeq
;

2237 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, 
ndev_vif
->
chªdef
);

2238 ià((
chª_šfo
 & 20) != 20)

2239 
fw_äeq
 = 
	`¦si_g‘_ûÁ”_äeq1
(
sdev
, 
chª_šfo
, fw_freq);

2241 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
chªÃl_äequ’cy
, (2 * 
fw_äeq
));

2242 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
chªÃl_šfÜm©iÚ
, 
chª_šfo
);

2243 
ndev_vif
->
­
.
chªÃl_äeq
 = 
fw_äeq
;

2246 ià(
£‰šgs
->
hidd’_ssid
 != 0) {

2247 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 2 + 
£‰šgs
->
ssid_Ën
);

2248 ià(!
p
) {

2249 
	`kä“_skb
(
»q
);

2250  -
EINVAL
;

2252 *
p
++ = 
WLAN_EID_SSID
;

2253 *
p
++ = 
£‰šgs
->
ssid_Ën
;

2254 
	`memıy
(
p
, 
£‰šgs
->
ssid
, s‘tšgs->
ssid_Ën
);

2257 ià(
b—cÚ_›_h—d_Ën
 && 
£‰šgs
->
hidd’_ssid
 == 0)

2258 
	`çpi_­³nd_d©a
(
»q
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
b—cÚ_›_h—d_Ën
);

2259 ià(
b—cÚ_›_h—d_Ën
 && 
£‰šgs
->
hidd’_ssid
 == 1)

2260 
	`çpi_­³nd_d©a
(
»q
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 + 2, 
b—cÚ_›_h—d_Ën
 - 2);

2261 ià(
b—cÚ_›_h—d_Ën
 && 
£‰šgs
->
hidd’_ssid
 == 2)

2262 
	`çpi_­³nd_d©a
(
»q
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 + 2 + 
£‰šgs
->
ssid_Ën
, 
b—cÚ_›_h—d_Ën
 - (2 + settings->ssid_len));

2264 ià(
£‰šgs
->
b—cÚ
.
_Ën
)

2265 
	`¦si_mlme_¡¬t_´•¬e_›s
(
»q
, 
ndev_vif
, 
£‰šgs
, 
w·_›_pos
, 
wmm_›_pos
);

2267 ià((
­³nd_vht_›s
è&& !
	`¦si_´•¬e_vht_›s
(
dev
, &
vht_›_ÿ·b
, &
vht_›_İ”©iÚ
)) {

2268 
	`çpi_­³nd_d©a
(
»q
, 
vht_›_ÿ·b
, 
SLSI_VHT_CAPABILITIES_IE_LEN
);

2269 
	`çpi_­³nd_d©a
(
»q
, 
vht_›_İ”©iÚ
, 
SLSI_VHT_OPERATION_IE_LEN
);

2270 
	`kä“
(
vht_›_ÿ·b
);

2271 
	`kä“
(
vht_›_İ”©iÚ
);

2274 #ià(
	`KERNEL_VERSION
(5, 7, 0è<ğ
LINUX_VERSION_CODE
è|| 
	`defšed
(
CONFIG_SCSC_WLAN_BSS_COLOR
)

2275 ià(
bss_cŞÜ_›_Ën
) {

2276 
u8
 
bss_cŞÜ_›
[] = { 
SLSI_WLAN_EID_VENDOR_SPECIFIC
, 0x06, 0x00, 0x16, 0x32, 0x04, 0x01, 0x00 };

2277 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 10, 0))

2278 
u8
 
bss_cŞÜ_di§bËd
 = !
£‰šgs
->
he_bss_cŞÜ
.
’abËd
;

2280 
u8
 
bss_cŞÜ_di§bËd
 = 
£‰šgs
->
he_bss_cŞÜ
.
di§bËd
;

2283 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "he_bss_color disabled : %d, bss_color : %u\n",

2284 
bss_cŞÜ_di§bËd
, 
£‰šgs
->
he_bss_cŞÜ
.
cŞÜ
);

2286 ià(
bss_cŞÜ_di§bËd
)

2287 
bss_cŞÜ_›
[
SLSI_WLAN_HE_BSS_COLOR_ENABLE_DISABLE_INDEX
] = 
SLSI_WLAN_HE_BSS_COLOR_DISABLED
;

2289 
bss_cŞÜ_›
[
SLSI_WLAN_HE_BSS_COLOR_ENABLE_DISABLE_INDEX
] = (
£‰šgs
->
he_bss_cŞÜ
.
·¹Ÿl
 << 
SLSI_WLAN_HE_BSS_COLOR_PARTIAL_OFFSET
è| s‘tšgs->he_bss_cŞÜ.
cŞÜ
;

2291 
	`çpi_­³nd_d©a
(
»q
, 
bss_cŞÜ_›
, 
SLSI_WLAN_HE_BSS_COLOR_IE_LEN
);

2295 #ià(
	`KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE
)

2296 ià(
mu_edÿ_›_Ën
)

2297 
	`çpi_­³nd_d©a
(
»q
, 
mu_edÿ_›_pos
, 
mu_edÿ_›_Ën
);

2300 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_START_CFM
);

2301 ià(!
cfm
)

2302  -
EIO
;

2303 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2304 
	`SLSI_NET_ERR
(
dev
, "mlme_start_cfm(result:0x%04x) ERROR\n",

2305 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_cfm
.
»suÉ_code
));

2306 
r
 = -
EINVAL
;

2309 
	`kä“_skb
(
cfm
);

2310  
r
;

2311 
	}
}

2313 cÚ¡ 
u8
 *
	$¦si_mlme_cÚÃù_g‘_£c_›
(
cfg80211_cÚÃù_·¿ms
 *
sme
, *
£c_›_Ën
, 
boŞ
 *
r¢x_æag
)

2315 
u16
 
v”siÚ
;

2316 cÚ¡ 
u8
 *
±r
 = 
NULL
;

2317 cÚ¡ 
u8
 *
±r_r¢x
 = 
NULL
;

2318 
u8
 *
£c_›
 = 
NULL
;

2319 
›_Ën
 = 0;

2320 
r¢x_›_Ën
 = 0;

2322 ià(
sme
->
üy±o
.
w·_v”siÚs
 == 0) {

2324 
±r
 = 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_WAPI
, 
sme
->
›
, sme->
›_Ën
);

2325 ià(
±r
) {

2326 
v”siÚ
 = 
±r
[3] << 8 |…tr[2];

2327 ià(
v”siÚ
 != 1) {

2328 
	`SLSI_ERR_NODEV
("UÃx³ùed v”siÚ (%dèš WAPI ie\n", 
v”siÚ
);

2329  
NULL
;

2332 } ià(
sme
->
üy±o
.
w·_v”siÚs
 == 2) {

2334 
±r
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
sme
->
›
, sme->
›_Ën
);

2336 ià(
±r
) {

2338 
v”siÚ
 = 
±r
[2 + 1] << 8 |…tr[2];

2339 ià(
v”siÚ
 != 1) {

2340 
	`SLSI_ERR_NODEV
("UÃx³ùed v”siÚ (%dèš„¢ ie\n", 
v”siÚ
);

2341  
NULL
;

2345 
±r_r¢x
 = 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_RSNX
, 
sme
->
›
, sme->
›_Ën
);

2346 
r¢x_›_Ën
 = (
±r_r¢x
 ?…tr_rsnx[1] + 2 : 0);

2348 
›_Ën
 = (
±r
 ?…tr[1] + 2 : 0);

2349 *
£c_›_Ën
 = 
›_Ën
 + 
r¢x_›_Ën
;

2350 ià(*
£c_›_Ën
 == 0)

2351  
NULL
;

2352 ià(
±r_r¢x
 && 
r¢x_›_Ën
 > 0) {

2353 
£c_›
 = 
	`km®loc
((
size_t
)*
£c_›_Ën
, 
GFP_KERNEL
);

2354 ià(!
£c_›
) {

2355 
	`SLSI_ERR_NODEV
("Error‡locating sec_ie\n");

2356 *
£c_›_Ën
 = 0;

2357  
NULL
;

2359 
	`memıy
(
£c_›
, 
±r
, 
›_Ën
);

2360 
	`memıy
(
£c_›
 + 
›_Ën
, 
±r_r¢x
, 
r¢x_›_Ën
);

2361 *
r¢x_æag
 = 
Œue
;

2362  
£c_›
;

2364  
±r
;

2365 
	}
}

2370 
	$¦si_mlme_cÚÃù_šfo_–ems_›_´•
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
cÚÃù_›
,

2371 cÚ¡ 
size_t
 
cÚÃù_›_Ën
, 
boŞ
 
is_cİy
, 
u8
 *
›_de¡
, 
›_de¡_Ën
)

2373 cÚ¡ 
u8
 *
›_pos
 = 
NULL
;

2374 
šfo_–em_Ëngth
 = 0;

2375 
u16
 
cu¼_›_Ën
, 
»m_Ën
;

2376 
i
 = 0;

2377 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2378 
u8
 
›_eid
[] = {
SLSI_WLAN_EID_INTERWORKING
,

2379 
SLSI_WLAN_EID_EXTENSION
,

2380 
WLAN_EID_VENDOR_SPECIFIC
};

2382 ià(
is_cİy
 && (!
›_de¡
 || 
›_de¡_Ën
 == 0))

2383  -
EINVAL
;

2385 
i
 = 0; i < (
›_eid
è/ (
u8
); i++) {

2386 
›_pos
 = 
	`cfg80211_fšd_›
(
›_eid
[
i
], 
cÚÃù_›
, 
cÚÃù_›_Ën
);

2387 
›_pos
) {

2388 
cu¼_›_Ën
 = *(
›_pos
 + 1) + 2;

2389 ià(
›_eid
[
i
] =ğ
SLSI_WLAN_EID_EXTENSION
 && 
›_pos
[2] =ğ
SLSI_WLAN_EID_EXT_OWE_DH_PARAM
)

2390 
ndev_vif
->
¡a
.
owe_group_duršg_cÚÃùiÚ
 = ((
›_pos
[4] << 8) | ie_pos[3]);

2391 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "IE[%d] i ´e£Á havšg†’gth:%d\n", 
›_eid
[
i
], 
cu¼_›_Ën
);

2392 ià(
is_cİy
) {

2393 ià(
›_de¡_Ën
 >ğ
cu¼_›_Ën
) {

2394 
	`memıy
(
›_de¡
, 
›_pos
, 
cu¼_›_Ën
);

2395 
›_de¡
 +ğ
cu¼_›_Ën
;

2397 
›_de¡_Ën
 -ğ
cu¼_›_Ën
;

2399 
	`SLSI_ERR_NODEV
("IE[%d]ƒxŒaùƒ¼Ü (›_cİy_l:%d, c_›_l:%d):\n", 
›_eid
[
i
],

2400 
›_de¡_Ën
, 
cu¼_›_Ën
);

2401  -
EINVAL
;

2404 
šfo_–em_Ëngth
 +ğ
cu¼_›_Ën
;

2406 
›_pos
 +ğ
cu¼_›_Ën
;

2407 
»m_Ën
 = 
cÚÃù_›_Ën
 - (
›_pos
 - 
cÚÃù_›
);

2408 
›_pos
 = 
	`cfg80211_fšd_›
(
›_eid
[
i
], ie_pos, 
»m_Ën
);

2412 ià(
sdev
->
deviû_cÚfig
.
qos_šfo
 != -1) {

2413 ià(
is_cİy
) {

2414 ià(
›_de¡_Ën
 >= 9) {

2415 
pos
 = 0;

2417 
›_de¡
[
pos
++] = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

2418 
›_de¡
[
pos
++] = 0x07;

2419 
›_de¡
[
pos
++] = 0x00;

2420 
›_de¡
[
pos
++] = 0x50;

2421 
›_de¡
[
pos
++] = 0xf2;

2422 
›_de¡
[
pos
++] = 
WLAN_OUI_TYPE_MICROSOFT_WMM
;

2423 
›_de¡
[
pos
++] = 
WMM_OUI_SUBTYPE_INFORMATION_ELEMENT
;

2424 
›_de¡
[
pos
++] = 
WMM_VERSION
;

2425 
›_de¡
[
pos
++] = 
sdev
->
deviû_cÚfig
.
qos_šfo
 & 0x0F;

2426 
›_de¡
 +ğ
pos
;

2427 
›_de¡_Ën
 -ğ
pos
;

2429 
	`SLSI_ERR_NODEV
("Requœed 9by‹ buˆËá:%d\n", 
›_de¡_Ën
);

2430  -
EINVAL
;

2432 
sdev
->
deviû_cÚfig
.
qos_šfo
 = -1;

2434 
šfo_–em_Ëngth
 += 9;

2437  
šfo_–em_Ëngth
;

2438 
	}
}

2440 
	$¦si_mlme_cÚÃù_šfo_–em’ts
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

2442 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2443 
šfo_–em_Ëngth
 = 0;

2444 
sk_buff
 *
»q
;

2445 
sk_buff
 *
cfm
;

2446 
r
 = 0;

2447 
u8
 *
p
;

2449 
šfo_–em_Ëngth
 = 
	`¦si_mlme_cÚÃù_šfo_–ems_›_´•
(
sdev
, 
dev
, 
sme
->
›
, sme->
›_Ën
, 
çl£
, 
NULL
, 0);

2452 ià(
šfo_–em_Ëngth
 <= 0)

2453  
šfo_–em_Ëngth
;

2455 
»q
 = 
	`çpi_®loc
(
mlme_add_šfo_–em’ts_»q
, 
MLME_ADD_INFO_ELEMENTS_REQ
,

2456 
ndev_vif
->
iâum
, 
šfo_–em_Ëngth
);

2457 ià(!
»q
)

2458  -
ENOMEM
;

2460 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_šfo_–em’ts_»q
.
pu½o£
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
);

2462 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
šfo_–em_Ëngth
);

2463 ià(!
p
) {

2464 
	`kä“_skb
(
»q
);

2465  -
EINVAL
;

2468 ()
	`¦si_mlme_cÚÃù_šfo_–ems_›_´•
(
sdev
, 
dev
, 
sme
->
›
, sme->
›_Ën
, 
Œue
, 
p
, 
šfo_–em_Ëngth
);

2471 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

2472 ià(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
)

2473 
	`kä“
(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
);

2474 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 = 0;

2476 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
 = 
	`km®loc
(
šfo_–em_Ëngth
, 
GFP_KERNEL
);

2477 ià(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
) {

2478 
	`memıy
(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
, 
p
, 
šfo_–em_Ëngth
);

2479 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 = 
šfo_–em_Ëngth
;

2481 
	`SLSI_WARN
(
sdev
, "NØmem fÜ‚dev_vif->¡a.assoc_»q_add_šfo_–em siz%d\n", 
šfo_–em_Ëngth
);

2485 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_šfo_–em’ts_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

2486 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_INFO_ELEMENTS_CFM
);

2487 ià(!
cfm
)

2488  -
EIO
;

2490 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_šfo_–em’ts_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2491 
	`SLSI_NET_ERR
(
dev
, "mlme_add_info_elements_cfm(result:0x%04x) ERROR\n",

2492 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_cÚÃù_cfm
.
»suÉ_code
));

2493 
r
 = -
EINVAL
;

2496 ià(
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
sme
->
›
, sme->
›_Ën
))

2497 
ndev_vif
->
¡a
.
is_wps
 = 
Œue
;

2499 
	`kä“_skb
(
cfm
);

2500  
r
;

2501 
	}
}

2503 
	$¦si_mlme_cÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
, 
›“80211_chªÃl
 *
chªÃl
, cÚ¡ 
u8
 *
bssid
)

2505 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2506 
sk_buff
 *
»q
;

2507 
sk_buff
 *
cfm
;

2508 
r
 = 0;

2509 
u8
 *
p
;

2510 
Æ80211_auth_ty³
 
auth_ty³
 = 
sme
->auth_type;

2511 
u8
 
mac_addr
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

2512 
key_·¿ms
 
¦si_key
;

2513 cÚ¡ 
u8
 *
£c_›
 = 
NULL
;

2514 
£c_›_Ën
 = 0;

2515 
boŞ
 
r¢x_›_æag
 = 
çl£
;

2517 
	`mem£t
(&
¦si_key
, 0, (slsi_key));

2519 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2520 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT.request\n");

2521  -
EOPNOTSUPP
;

2524 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2526 ià(
	`WARN
(!
bssid
, "BSSID is Null"))

2527  -
EINVAL
;

2529 ià(
	`WARN
(!
sme
->
ssid_Ën
, "SSID is Null"))

2530  -
EINVAL
;

2532 
auth_ty³
) {

2533 
NL80211_AUTHTYPE_OPEN_SYSTEM
:

2534 
NL80211_AUTHTYPE_SHARED_KEY
:

2536 
NL80211_AUTHTYPE_SAE
:

2537 
auth_ty³
 = 
FAPI_AUTHENTICATIONTYPE_SAE
;

2539 
NL80211_AUTHTYPE_AUTOMATIC
:

2543 ià(
sme
->
´ivacy
 &&

2544 (
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP40
 ||

2545 
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP104
))

2546 
auth_ty³
 = 
NL80211_AUTHTYPE_SHARED_KEY
;

2548 
auth_ty³
 = 
NL80211_AUTHTYPE_OPEN_SYSTEM
;

2551 
	`SLSI_NET_ERR
(
dev
, "UnsuµÜ‹d‡uth_ty³: %d\n", 
auth_ty³
);

2552  -
EOPNOTSUPP
;

2556 ià((
auth_ty³
 =ğ
NL80211_AUTHTYPE_SHARED_KEY
) &&

2557 ((
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP40
) ||

2558 (
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP104
)) &&

2559 (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
)) {

2560 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "key†’ (%d)\n", 
sme
->
key_Ën
);

2561 
¦si_key
.
key
 = (
u8
 *)
sme
->key;

2562 ià(!
¦si_key
.
key
)

2563  -
EINVAL
;

2564 
¦si_key
.
key_Ën
 = 
sme
->key_len;

2565 
¦si_key
.
£q_Ën
 = 0;

2566 ià(
sme
->
üy±o
.
n_ch”s_·œwi£
)

2567 
¦si_key
.
ch”
 = 
sme
->
üy±o
.
ch”s_·œwi£
[0];

2569 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 
sme
->
key_idx
, 
FAPI_KEYTYPE_WEP
, 
mac_addr
, &
¦si_key
);

2570 ià(
r
 != 0) {

2571 
	`SLSI_NET_ERR
(
dev
, "E¼Ü S‘tšg Sh¬ed key (%d)", 
r
);

2572  
r
;

2577 ià(
sme
->
›_Ën
) {

2578 
r
 = 
	`¦si_mlme_cÚÃù_šfo_–em’ts
(
sdev
, 
dev
, 
sme
);

2579 ià(
r
)

2580  
r
;

2582 
£c_›
 = 
	`¦si_mlme_cÚÃù_g‘_£c_›
(
sme
, &
£c_›_Ën
, &
r¢x_›_æag
);

2583 ià(
£c_›_Ën
 < 0) {

2584 
	`SLSI_NET_ERR
(
dev
, "ERROR…reparing Security IEs\n");

2585  
£c_›_Ën
;

2589 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_cÚÃù_»q(vif:%u, bssid:%pM, ssid:%.*s)\n", 
ndev_vif
->
iâum
, 
bssid
, ()
sme
->
ssid_Ën
, sme->
ssid
);

2590 
»q
 = 
	`çpi_®loc
(
mlme_cÚÃù_»q
, 
MLME_CONNECT_REQ
, 
ndev_vif
->
iâum
,

2591 2 + 
sme
->
ssid_Ën
 +

2592 
£c_›_Ën
);

2593 ià(!
»q
)

2594  -
ENOMEM
;

2596 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_cÚÃù_»q
.
bssid
, bssid);

2597 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚÃù_»q
.
auth’tiÿtiÚ_ty³
, 
auth_ty³
);

2599 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚÃù_»q
.
chªÃl_äequ’cy
, (2 * 
chªÃl
->
ûÁ”_äeq
));

2601 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 2 + 
sme
->
ssid_Ën
 + 
£c_›_Ën
);

2602 ià(!
p
) {

2603 
	`kä“_skb
(
»q
);

2604  -
EINVAL
;

2606 *
p
++ = 
WLAN_EID_SSID
;

2607 *
p
++ = 
sme
->
ssid_Ën
;

2608 
	`memıy
(
p
, 
sme
->
ssid
, sme->
ssid_Ën
);

2609 
p
 +ğ
sme
->
ssid_Ën
;

2611 ià(
£c_›_Ën
)

2612 
	`memıy
(
p
, 
£c_›
, 
£c_›_Ën
);

2613 ià(
r¢x_›_æag
 && 
£c_›
)

2614 
	`kä“
(
£c_›
);

2615 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_CONNECT_CFM
);

2616 ià(!
cfm
)

2617  -
EIO
;

2619 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_cÚÃù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2620 
	`SLSI_NET_ERR
(
dev
, "mlme_connect_cfm(result:0x%04x) ERROR\n",

2621 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_cÚÃù_cfm
.
»suÉ_code
));

2622 
r
 = -
EINVAL
;

2624 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2626 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
Œue
;

2629 ià(
r
 == 0)

2630 
ndev_vif
->
¡a
.
cÚÃù_úf_time
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

2631 
	`kä“_skb
(
cfm
);

2632  
r
;

2633 
	}
}

2635 
	$¦si_mlme_cÚÃù_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2637 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2638 
sk_buff
 *
»q
;

2639 
sk_buff
 *
cfm
;

2641 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2644 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2645 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT_RESP\n");

2649 
	`SLSI_NET_INFO
(
dev
, "mlme_cÚÃù_»¥(vif:%u)\n", 
ndev_vif
->
iâum
);

2650 
»q
 = 
	`çpi_®loc
(
mlme_cÚÃù_»s
, 
MLME_CONNECT_RES
, 
ndev_vif
->
iâum
, 0);

2651 ià(!
»q
)

2654 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

2655 
	`WARN_ON
(
cfm
);

2656 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2657 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
çl£
;

2658 
	`¦si_ä“_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
);

2659 
	`¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
sdev
, 
dev
, 
NULL
);

2661 
	}
}

2663 
	$¦si_mlme_cÚÃùed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
³”_šdex
)

2665 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2666 
sk_buff
 *
»q
;

2667 
u16
 
æow_id
 = 0;

2669 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2672 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2673 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT_RESP\n");

2677 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_cÚÃùed_»¥(vif:%u,…“r_šdex:%d)\n", 
ndev_vif
->
iâum
, 
³”_šdex
);

2678 
»q
 = 
	`çpi_®loc
(
mlme_cÚÃùed_»s
, 
MLME_CONNECTED_RES
, 
ndev_vif
->
iâum
, 0);

2679 ià(!
»q
) {

2680 
	`SLSI_NET_ERR
(
dev
, "mlme-connected-response :: memory‡llocation failed\n");

2683 
æow_id
 = ((
³”_šdex
 & 0xFF) << 8) | (0xFF);

2684 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚÃùed_»s
.
æow_id
, flow_id);

2685 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

2686 
	}
}

2688 
	$¦si_mlme_rßmed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2690 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2691 
sk_buff
 *
»q
;

2692 
sk_buff
 *
cfm
;

2694 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2697 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2698 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_ROAMED_RESP\n");

2702 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_roamed_resp\n");

2703 
»q
 = 
	`çpi_®loc
(
mlme_rßmed_»s
, 
MLME_ROAMED_RES
, 
ndev_vif
->
iâum
, 0);

2704 ià(!
»q
)

2707 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

2708 
	`WARN_ON
(
cfm
);

2709 
	}
}

2712 
boŞ
 
	$¦si_discÚÃù_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

2714 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
);

2715 
boŞ
 
r
 = 
çl£
;

2717 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2719 ià(
	`WARN_ON
(!
dev
))

2720 
ex™
;

2722 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

2723 
r
 = 
Œue
;

2725 ià(
»suÉ
 !ğ
FAPI_RESULTCODE_NOT_PRESENT
)

2726 
	`SLSI_NET_ERR
(
dev
, "mlme_disconnect_cfm(result:0x%04x) ERROR\n",

2727 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
));

2729 
ex™
:

2730 
	`kä“_skb
(
cfm
);

2731  
r
;

2732 
	}
}

2735 
boŞ
 
	$¦si_rßmšg_chªÃl_li¡_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

2737 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßmšg_chªÃl_li¡_cfm
.
»suÉ_code
);

2738 
boŞ
 
r
 = 
çl£
;

2740 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2742 ià(
	`WARN_ON
(!
dev
))

2743 
ex™
;

2745 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

2746 
r
 = 
Œue
;

2748 ià(
»suÉ
 !ğ
FAPI_RESULTCODE_NOT_PRESENT
)

2749 
	`SLSI_NET_ERR
(
dev
, "mlme_roaming_channel_list_cfm(result:0x%04x) ERROR\n",

2750 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßmšg_chªÃl_li¡_cfm
.
»suÉ_code
));

2752 
ex™
:

2753 
	`kä“_skb
(
cfm
);

2754  
r
;

2755 
	}
}

2757 
sk_buff
 *
	$¦si_mlme_rßmšg_chªÃl_li¡_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2759 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2760 
sk_buff
 *
»q
;

2761 
sk_buff
 *
rx
;

2763 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2764 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DISCONNECT.request\n");

2765  
NULL
;

2768 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2770 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_rßmšg_chªÃl_li¡_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

2772 
»q
 = 
	`çpi_®loc
(
mlme_rßmšg_chªÃl_li¡_»q
, 
MLME_ROAMING_CHANNEL_LIST_REQ
, 
ndev_vif
->
iâum
, 0);

2773 ià(!
»q
) {

2774 
	`SLSI_NET_ERR
(
dev
, "fapi_alloc failed!\n");

2775  
NULL
;

2778 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_ROAMING_CHANNEL_LIST_CFM
, 
MLME_ROAMING_CHANNEL_LIST_IND
, 
¦si_rßmšg_chªÃl_li¡_cfm_v®id©e
);

2779 ià(!
rx
) {

2780 
	`SLSI_NET_ERR
(
dev
, "mlme_roaming_channel_list_cfm() ERROR\n");

2781  
NULL
;

2784  
rx
;

2785 
	}
}

2787 
	$¦si_mlme_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mac
, 
u16
 
»asÚ_code
, 
boŞ
 
wa™_šd
)

2789 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2790 
sk_buff
 *
»q
;

2791 
sk_buff
 *
rx
;

2792 
r
 = 0;

2794 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2795 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DISCONNECT.request\n");

2796  -
EOPNOTSUPP
;

2799 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2800 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2801  -
EINVAL
;

2803 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_discÚÃù_»q(vif:%u, bssid:%pM,„—sÚ:%d)\n", 
ndev_vif
->
iâum
, 
mac
, 
»asÚ_code
);

2805 
»q
 = 
	`çpi_®loc
(
mlme_discÚÃù_»q
, 
MLME_DISCONNECT_REQ
, 
ndev_vif
->
iâum
,

2806 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
);

2808 ià(!
»q
)

2809  -
ENOMEM
;

2810 
	`SLSI_INFO
(
sdev
, "S’d DEAUTH,„—sÚ = %d\n", 
»asÚ_code
);

2811 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_discÚÃù_»q
.
»asÚ_code
,„eason_code);

2812 ià(
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 > 0)

2813 
	`çpi_­³nd_d©a
(
»q
, 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
,‚dev_vif->¡a.
v’dÜ_discÚÃù_›s_Ën
);

2814 
	`kä“
(
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
);

2815 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
 = 
NULL
;

2816 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = 0;

2818 ià(
mac
)

2819 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_discÚÃù_»q
.
³”_¡a_add»ss
, 
mac
);

2821 
	`çpi_£t_mem£t
(
»q
, 
u
.
mlme_discÚÃù_»q
.
³”_¡a_add»ss
, 0);

2822 ià(
wa™_šd
) {

2823 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_DISCONNECT_CFM
, 
MLME_DISCONNECTED_IND
, 
¦si_discÚÃù_cfm_v®id©e
);

2824 ià(!
rx
) {

2825 
	`SLSI_NET_ERR
(
dev
, "mlme_disconnect_cfm() ERROR\n");

2826 
r
 = -
EINVAL
;

2829 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DISCONNECT_CFM
);

2830 ià(
rx
) {

2831 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2832 
	`SLSI_NET_ERR
(
dev
, "mlme_disconnect_cfm(result:0x%04x) ERROR\n",

2833 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
));

2834 
r
 = -
EINVAL
;

2837 
r
 = -
EIO
;

2841 
	`kä“_skb
(
rx
);

2842  
r
;

2843 
	}
}

2845 
	$¦si_mlme_£t_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, cÚ¡ 
u8
 *
add»ss
, 
key_·¿ms
 *
key
)

2847 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2848 
sk_buff
 *
»q
;

2849 
sk_buff
 *
cfm
;

2850 
r
 = 0;

2851 
u16
 
key_rsc
[
SLSI_EAPOL_KEY_RSC_LENGTH
] = {0};

2853 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2854 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SETKEYS.request\n");

2855  -
EOPNOTSUPP
;

2858 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2860 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£tkeys_»q(key_id:%d, key_ty³:%d,‡dd»ss:%pM,†’gth:%d, ch”:0x%.8X)\n", 
key_id
, 
key_ty³
, 
add»ss
, 
key
->
key_Ën
, key->
ch”
);

2861 
»q
 = 
	`çpi_®loc
(
mlme_£tkeys_»q
, 
MLME_SETKEYS_REQ
, 
ndev_vif
->
iâum
, 
key
->
key_Ën
 + 1);

2862 ià(!
»q
)

2863  -
ENOMEM
;

2864 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
Ëngth
, 
key
->
key_Ën
 * 8);

2865 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
key_id
, key_id);

2866 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
key_ty³
, key_type);

2867 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£tkeys_»q
.
add»ss
,‡ddress);

2869 ià(
key
->
£q_Ën
 && (
key_ty³
 =ğ
FAPI_KEYTYPE_GROUP
 || key_ty³ =ğ
FAPI_KEYTYPE_IGTK
 || key_ty³ =ğ
FAPI_KEYTYPE_BIGTK
))

2870 
	`memıy
(
key_rsc
, 
key
->
£q
, key->
£q_Ën
);

2871 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£tkeys_»q
.
keyrsc
, 
key_rsc
);

2873 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£tkeys_»q
.
ch”_su™e_£ËùÜ
, 
key
->
ch”
);

2875 ià(
key
->
ch”
 =ğ
WLAN_CIPHER_SUITE_WEP40
 || key->ch” =ğ
WLAN_CIPHER_SUITE_WEP104
) {

2876 
u8
 
w•_key_id
 = (u8)
key_id
;

2878 ià(
key_id
 > 3)

2879 
	`SLSI_NET_WARN
(
dev
, "Key ID is greaterhan 3");

2883 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
Ëngth
, (
key
->
key_Ën
 + 1) * 8);

2884 
	`çpi_­³nd_d©a
(
»q
, &
w•_key_id
, 1);

2886 
	`çpi_­³nd_d©a
(
»q
, 
key
->key, key->
key_Ën
);

2888 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SETKEYS_CFM
);

2889 ià(!
cfm
)

2890  -
EIO
;

2892 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£tkeys_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2893 
	`SLSI_NET_ERR
(
dev
, "mlme_setkeys_cfm(result:0x%04x) ERROR\n",

2894 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£tkeys_cfm
.
»suÉ_code
));

2895 
r
 = -
EINVAL
;

2897 
	`kä“_skb
(
cfm
);

2898  
r
;

2899 
	}
}

2901 
	$¦si_mlme_g‘_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, 
u8
 *
£q
, *
£q_Ën
)

2903 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2904 
sk_buff
 *
»q
;

2905 
sk_buff
 *
cfm
;

2906 
r
 = 0;

2908 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2910 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_g‘_key_£qu’û_»q(key_id:%d, key_ty³:%d)\n", 
key_id
, 
key_ty³
);

2911 
»q
 = 
	`çpi_®loc
(
mlme_g‘_key_£qu’û_»q
, 
MLME_GET_KEY_SEQUENCE_REQ
, 
ndev_vif
->
iâum
, 0);

2912 ià(!
»q
)

2913  -
ENOMEM
;

2914 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_g‘_key_£qu’û_»q
.
key_id
, key_id);

2915 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_g‘_key_£qu’û_»q
.
key_ty³
, key_type);

2917 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_GET_KEY_SEQUENCE_CFM
);

2918 ià(!
cfm
)

2919  -
EIO
;

2921 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_key_£qu’û_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2922 
	`SLSI_NET_ERR
(
dev
, "mlme_get_key_sequence_cfm(result:0x%04x) ERROR\n",

2923 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_key_£qu’û_cfm
.
»suÉ_code
));

2924 
r
 = -
ENOENT
;

2926 
i
;

2927 
u16
 
‹mp_£q
;

2933 *
£q_Ën
 = 8;

2941 
i
 = 0; i < *
£q_Ën
 / 2; i++) {

2942 
‹mp_£q
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_key_£qu’û_cfm
.
£qu’û_numb”
[
i
]);

2943 *
£q
 = (
u8
)(
‹mp_£q
 & 0xFF);

2944 *(
£q
 + 1èğ(
u8
)((
‹mp_£q
 >> 8) & 0xFF);

2946 
£q
 += 2;

2950 
	`kä“_skb
(
cfm
);

2951  
r
;

2952 
	}
}

2954 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


2955 
	$¦si_ÿlc_max_d©a_¿‹
(
Ãt_deviû
 *
dev
, 
u8
 
bªdwidth
, u8 
ª‹Âa_mode
)

2957 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2958 
u8
 
bªdwidth_šdex
, 
¡a_mode
, 
mcs_šdex
;

2960 ià(
bªdwidth
 =ğ0 || 
ª‹Âa_mode
 > 3) {

2961 
	`SLSI_NET_ERR
(
dev
, "MIB value is wrong.");

2965 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2968 
bªdwidth_šdex
 = 
bªdwidth
 / 40;

2969 
¡a_mode
 = 
	`¦si_¡a_›“80211_mode
(
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
->
ûÁ”_äeq
);

2971 ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11B
) {

2972 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = 11;

2973 } ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11G
 || s_mod=ğ
SLSI_80211_MODE_11A
) {

2974 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = 54;

2975 } ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11N
) {

2976 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = ()(
¦si_¿‹s_bË
[
bªdwidth_šdex
][1][7] * (
ª‹Âa_mode
 + 1)) / 10;

2977 } ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11AC
) {

2978 ià(
bªdwidth_šdex
 == 0)

2979 
mcs_šdex
 = 8;

2981 
mcs_šdex
 = 9;

2982 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = ()(
¦si_¿‹s_bË
[
bªdwidth_šdex
][1][
mcs_šdex
] * (
ª‹Âa_mode
 + 1)) / 10;

2984 
	}
}

2987 
	$¦si_decode_fw_¿‹
(
u32
 
fw_¿‹
, 
¿‹_šfo
 *
¿‹
, *
d©a_¿‹_mbps
)

2989 cÚ¡ 
fw_¿‹_idx_to_80211_¿‹
[] = { 0, 10, 20, 55, 60, 90, 110, 120, 180, 240, 360, 480, 540 };

2991 ià(
¿‹
) {

2992 
¿‹
->
æags
 = 0;

2993 
¿‹
->
Ëgacy
 = 0;

2994 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

2995 
¿‹
->
bw
 = 0;

2999 ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_NON_HT_SELECTED
) {

3000 
u16
 
fw_¿‹_idx
 = 
fw_¿‹
 & 
SLSI_FW_API_RATE_INDEX_FIELD
;

3002 ià(
fw_¿‹
 > 0 && 
fw_¿‹_idx
 < 
	`ARRAY_SIZE
(
fw_¿‹_idx_to_80211_¿‹
)) {

3003 ià(
¿‹
)

3004 
¿‹
->
Ëgacy
 = 
fw_¿‹_idx_to_80211_¿‹
[
fw_¿‹_idx
];

3005 ià(
d©a_¿‹_mbps
)

3006 *
d©a_¿‹_mbps
 = ()
fw_¿‹_idx_to_80211_¿‹
[
fw_¿‹_idx
] / 10;

3008 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_HT_SELECTED
) {

3009 
u8
 
mcs_idx
 = 
SLSI_FW_API_RATE_HT_MCS_FIELD
 & 
fw_¿‹
;

3010 
u8
 
nss
 = ((
SLSI_FW_API_RATE_HT_NSS_FIELD
 & 
fw_¿‹
) >> 6) + 1;

3012 ià(
¿‹
) {

3013 
¿‹
->
æags
 |ğ
RATE_INFO_FLAGS_MCS
;

3014 
¿‹
->
mcs
 = 
mcs_idx
;

3016 ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
è=ğ
SLSI_FW_API_RATE_BW_40MHZ
)

3017 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3018 
¿‹
->
bw
 |ğ
RATE_INFO_BW_40
;

3020 
¿‹
->
æags
 |ğ
RATE_INFO_FLAGS_40_MHZ_WIDTH
;

3022 ià(
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
)

3023 
¿‹
->
æags
 |ğ
RATE_INFO_FLAGS_SHORT_GI
;

3026 ià(
d©a_¿‹_mbps
) {

3027 
chª_bw_idx
;

3028 
gi_idx
;

3030 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

3031 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

3034 ià(
chª_bw_idx
 < 2) {

3035 ià(
mcs_idx
 <= 7) {

3036 *
d©a_¿‹_mbps
 = ()
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
] / 10;

3037 } ià(
mcs_idx
 <= 15) {

3038 *
d©a_¿‹_mbps
 = ()(
nss
 * 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
 - 8]) / 10;

3039 } ià(
mcs_idx
 =ğ32 && 
chª_bw_idx
 == 1) {

3041 ià(
gi_idx
 == 1)

3042 *
d©a_¿‹_mbps
 = () 6.7;

3044 *
d©a_¿‹_mbps
 = 6;

3047 
	`SLSI_WARN_NODEV
("FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,‚ss : %d\n",

3048 
fw_¿‹
, 
chª_bw_idx
, 
mcs_idx
, 
nss
);

3051 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_VHT_SELECTED
) {

3052 
chª_bw_idx
;

3053 
gi_idx
;

3054 
mcs_idx
;

3055 
u8
 
nss
;

3060 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

3061 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

3063 
nss
 = ((
SLSI_FW_API_RATE_VHT_NSS_FIELD
 & 
fw_¿‹
) >> 4) + 1;

3064 
mcs_idx
 = 
SLSI_FW_API_RATE_VHT_MCS_FIELD
 & 
fw_¿‹
;

3066 ià((
chª_bw_idx
 <ğ2è&& (
mcs_idx
 <= 11)) {

3067 ià(
¿‹
)

3068 
¿‹
->
Ëgacy
 = 
nss
 * 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
];

3069 ià(
d©a_¿‹_mbps
)

3070 *
d©a_¿‹_mbps
 = ()(
nss
 * 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
]) / 10;

3072 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,nss : %d\n\n",

3073 
fw_¿‹
, 
chª_bw_idx
, 
mcs_idx
, 
nss
);

3075 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HE_SELECTED
) == SLSI_FW_API_RATE_HE_SELECTED) {

3076 
chª_bw_idx
;

3077 
gi_idx
;

3078 
mcs_idx
;

3079 
u8
 
nss
;

3084 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

3085 
gi_idx
 = 
	`SLSI_FW_API_GET_11AX_GI
(
fw_¿‹
);

3087 
nss
 = ((
SLSI_FW_API_RATE_VHT_NSS_FIELD
 & 
fw_¿‹
) >> 4) + 1;

3088 
mcs_idx
 = 
SLSI_FW_API_RATE_VHT_MCS_FIELD
 & 
fw_¿‹
;

3090 ià((
chª_bw_idx
 <ğ3è&& (
mcs_idx
 < 12)) {

3091 ià(
¿‹
)

3092 
¿‹
->
Ëgacy
 = 
nss
 * (
¦si_he_¿‹s_bË_2x2
[
chª_bw_idx
][
mcs_idx
][
gi_idx
] / 2) * 10;

3093 ià(
d©a_¿‹_mbps
)

3094 *
d©a_¿‹_mbps
 = ()
nss
 * (
¦si_he_¿‹s_bË_2x2
[
chª_bw_idx
][
mcs_idx
][
gi_idx
] / 2);

3096 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,nss : %d\n\n",

3097 
fw_¿‹
, 
chª_bw_idx
, 
mcs_idx
, 
nss
);

3100 
	}
}

3102 
	$¦si_mlme_g‘_sšfo_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3103 
¦si_³”
 *
³”
)

3105 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3106 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

3107 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3108 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3109 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


3110 
u8
 
bªdwidth
 = 0, 
ª‹Âa_mode
 = 4;

3112 
d©a_Ëngth
 = 0;

3113 
r
 = 0;

3114 
mib_šdex
 = 0;

3115 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {

3116 { 
SLSI_PSID_UNIFI_TX_DATA_RATE
, { 0, 0 } },

3117 { 
SLSI_PSID_UNIFI_RX_DATA_RATE
, { 0, 0 } },

3118 { 
SLSI_PSID_UNIFI_RSSI
, { 0, 0 } },

3119 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 3, 0 } },

3120 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 25, 0 } },

3121 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 30, 0 } },

3122 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 1, 0 } },

3123 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 2, 0 } },

3124 { 
SLSI_PSID_UNIFI_FRAME_RX_COUNTERS
, { 1, 0 } },

3125 #ifdeà
CONFIG_SCSC_ENHANCED_PACKET_STATS


3126 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 3, 0 } },

3127 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

3128 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 4, 0 } },

3131 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


3132 { 
SLSI_PSID_UNIFI_CURRENT_BSS_BANDWIDTH
, { 0, 0 } },

3133 { 
SLSI_PSID_UNIFI_STA_VIF_LINK_NSS
, { 0, 0 } }

3136 
rx_couÁ”
 = 0;

3138 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3140 ià(!
³”
) {

3141 
	`SLSI_WARN
(
sdev
, "Peer Not‡vailable\n");

3142  -
EINVAL
;

3146 ià(
	`__¿‹lim™
(&
³”
->
sšfo_mib_g‘_rs
))

3149 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)),

3150 
g‘_v®ues
);

3151 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

3152  -
ENOMEM
;

3158 
mibr¥
.
d©aL’gth
 = 114;

3159 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3161 ià(!
mibr¥
.
d©a
) {

3162 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "failedo‡llocate memory\n");

3163 
	`kä“
(
mib»q
.
d©a
);

3164  -
ENOMEM
;

3167 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

3168 
mibr¥
.
d©aL’gth
, &
d©a_Ëngth
);

3169 
	`kä“
(
mib»q
.
d©a
);

3171 ià(
r
 == 0) {

3172 
mibr¥
.
d©aL’gth
 = (
u32
)
d©a_Ëngth
;

3173 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
,

3174 ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)), get_values);

3175 ià(!
v®ues
) {

3176 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

3177 
	`kä“
(
mibr¥
.
d©a
);

3178  -
ENOMEM
;

3181 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3182 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3183 
	`¦si_decode_fw_¿‹
((
u32
)
v®ues
[
mib_šdex
].
u
.
uštV®ue
, &
³”
->
sšfo
.
tx¿‹
, &
ndev_vif
->
¡a
.
d©a_¿‹_mbps
);

3184 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3185 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_TX_BITRATE
);

3187 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_TX_BITRATE
;

3189 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SLSI_PSID_UNIFI_TX_DATA_RATE = 0x%x\n",

3190 
v®ues
[
mib_šdex
].
u
.
uštV®ue
);

3192 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3194 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3195 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3196 
	`¦si_decode_fw_¿‹
((
u32
)
v®ues
[
mib_šdex
].
u
.
uštV®ue
, &
³”
->
sšfo
.
rx¿‹
, 
NULL
);

3197 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3198 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_RX_BITRATE
);

3200 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_RX_BITRATE
;

3202 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SLSI_PSID_UNIFI_RX_DATA_RATE = 0x%x\n",

3203 
v®ues
[
mib_šdex
].
u
.
uštV®ue
);

3205 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3207 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3208 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_INT
);

3209 ià(
v®ues
[
mib_šdex
].
u
.
štV®ue
 >= 0)

3210 
³”
->
sšfo
.
sigÇl
 = -1;

3212 
³”
->
sšfo
.
sigÇl
 = (
s8
)
v®ues
[
mib_šdex
].
u
.
štV®ue
;

3213 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3214 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_SIGNAL
);

3216 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_SIGNAL
;

3218 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SLSI_PSID_UNIFI_RSSI = %d\n",

3219 
v®ues
[
mib_šdex
].
u
.
štV®ue
);

3221 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3222 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3223 
rx_couÁ”
 +ğ
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3225 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3226 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3227 
rx_couÁ”
 +ğ
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3229 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3230 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3231 
rx_couÁ”
 +ğ
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3233 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3234 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3235 
³”
->
sšfo
.
tx_·ck‘s
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3237 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3238 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3239 
³”
->
sšfo
.
tx_çed
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3241 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3242 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3243 
³”
->
sšfo
.
rx_·ck‘s
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3245 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3246 #ifdeà
CONFIG_SCSC_ENHANCED_PACKET_STATS


3247 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3248 
³”
->
sšfo
.
tx_»Œ›s
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3250 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3251 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

3252 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3253 
³”
->
sšfo
.
aœtime_lšk_m‘ric
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3255 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3258 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


3259 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3260 
bªdwidth
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3262 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3263 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

3264 
ª‹Âa_mode
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3265 
	`¦si_ÿlc_max_d©a_¿‹
(
dev
, 
bªdwidth
, 
ª‹Âa_mode
);

3267 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3271 
³”
->
sšfo
.
rx_drİ³d_misc
 = 
rx_couÁ”
;

3273 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3274 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_TX_FAILED
è| BIT(
NL80211_STA_INFO_RX_DROP_MISC
) |

3275 
	`BIT
(
NL80211_STA_INFO_TX_PACKETS
è| BIT(
NL80211_STA_INFO_RX_PACKETS
);

3276 #ifdeà
CONFIG_SCSC_ENHANCED_PACKET_STATS


3277 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_TX_RETRIES
);

3278 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

3279 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_AIRTIME_LINK_METRIC
);

3284 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_g‘_»q faedÔesuÉ:0x%4x)\n", 
r
);

3287 
	`kä“
(
mibr¥
.
d©a
);

3288 
	`kä“
(
v®ues
);

3289  
r
;

3290 
	}
}

3292 
	$¦si_mlme_cÚÃù_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3293 
u32
 
n_ssids
, 
cfg80211_ssid
 *
ssids
, 
›“80211_chªÃl
 *
chªÃl
)

3295 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3296 
r
 = 0;

3297 
›“80211_chªÃl
 **
sÿn_chªÃls
 = 
NULL
;

3298 
›“80211_chªÃl
 **
add_sÿn_chªÃls
;

3299 
n_chªÃls
 = 0;

3300 
sk_buff
 *
sÿn
;

3301 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
Œue
};

3303 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

3305 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

3306 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "stop on-going Scan\n");

3307 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
, 
çl£
);

3308 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

3309 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, &
šfo
);

3311 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, 
Œue
);

3314 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
NULL
;

3317 ià(!
chªÃl
) {

3318 
Æ80211_bªd
 
bªd
;

3319 
why
 *why = 
sdev
->wiphy;

3320 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

3321 
bªd
 = 0; bªd < 
NUM_NL80211_BANDS
; band++) {

3323 
bªd
 = 0; bªd < 
IEEE80211_NUM_BANDS
; band++) {

3325 ià(!
why
->
bªds
[
bªd
])

3327 
n_chªÃls
 +ğ
why
->
bªds
[
bªd
]->n_channels;

3330 
	`WARN_ON
(
n_chªÃls
 == 0);

3331 
sÿn_chªÃls
 = 
	`km®loc_¬¿y
((
size_t
)
n_chªÃls
, (*sÿn_chªÃls), 
GFP_KERNEL
);

3332 ià(!
sÿn_chªÃls
) {

3333 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

3334  -
ENOMEM
;

3336 
n_chªÃls
 = 0;

3337 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

3338 
bªd
 = 0; bªd < 
NUM_NL80211_BANDS
; band++) {

3340 
bªd
 = 0; bªd < 
IEEE80211_NUM_BANDS
; band++) {

3342 
j
;

3344 ià(!
why
->
bªds
[
bªd
])

3346 
j
 = 0; j < 
why
->
bªds
[
bªd
]->
n_chªÃls
; j++)

3347 ià(!(
why
->
bªds
[
bªd
]->
chªÃls
[
j
].
æags
 & 
IEEE80211_CHAN_DISABLED
)) {

3348 
sÿn_chªÃls
[
n_chªÃls
] = &
why
->
bªds
[
bªd
]->
chªÃls
[
j
];

3349 
n_chªÃls
++;

3352 
add_sÿn_chªÃls
 = 
sÿn_chªÃls
;

3354 
n_chªÃls
 = 1;

3355 
add_sÿn_chªÃls
 = &
chªÃl
;

3357 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
Œue
;

3358 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

3359 
dev
,

3360 
FAPI_SCANTYPE_FULL_SCAN
,

3361 
FAPI_REPORTMODE_REAL_TIME
,

3362 
n_ssids
,

3363 
ssids
,

3364 
n_chªÃls
,

3365 
add_sÿn_chªÃls
,

3366 
NULL
,

3367 
ndev_vif
->
´obe_»q_›s
,

3368 
ndev_vif
->
´obe_»q_›_Ën
,

3369 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


3371 
NULL
,

3373 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

3375 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

3376 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

3377 
sÿn
) {

3378 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
sÿn
, 
Œue
);

3379 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

3381 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

3383 
	`kä“
(
sÿn_chªÃls
);

3384 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

3386 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

3387  
r
;

3388 
	}
}

3393 
DEFINE_MUTEX
(
pow”mgt_lock
);

3399 
	$¦si_mlme_pow”mgt_uÆocked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pow”_mode
)

3401 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3402 
sk_buff
 *
»q
;

3403 
sk_buff
 *
rx
;

3404 
r
 = 0;

3406 
	`mu‹x_lock
(&
pow”mgt_lock
);

3408 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
)) {

3409 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3410  -
EINVAL
;

3413 ià(
ndev_vif
->
pow”_mode
 ==…ower_mode) {

3414 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3415 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "power management mode is same‡s„equested. No changes done\n");

3419 
	`SLSI_NET_INFO
(
dev
, "PS MODE mlme_pow”mgt_»q(vif:%d,…ow”_mªagem’t_mode:%d)\n", 
ndev_vif
->
iâum
,

3420 
pow”_mode
);

3421 
»q
 = 
	`çpi_®loc
(
mlme_pow”mgt_»q
, 
MLME_POWERMGT_REQ
, 
ndev_vif
->
iâum
, 0);

3422 ià(!
»q
) {

3423 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3424  -
ENOMEM
;

3426 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_pow”mgt_»q
.
pow”_mªagem’t_mode
, 
pow”_mode
);

3428 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_POWERMGT_CFM
);

3429 ià(!
rx
) {

3430 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3431  -
EIO
;

3434 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_pow”mgt_cfm
.
»suÉ_code
è=ğ
FAPI_RESULTCODE_SUCCESS
) {

3435 
ndev_vif
->
pow”_mode
 =…ower_mode;

3437 
	`SLSI_NET_ERR
(
dev
, "mlme_powermgt_cfm(result:0x%04x) ERROR\n",

3438 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_pow”mgt_cfm
.
»suÉ_code
));

3439 
r
 = -
EINVAL
;

3442 
	`kä“_skb
(
rx
);

3443 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3444  
r
;

3445 
	}
}

3447 
	$¦si_mlme_pow”mgt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pow”_mode
)

3449 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3451 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3453  
	`¦si_mlme_pow”mgt_uÆocked
(
sdev
, 
dev
, 
pow”_mode
);

3454 
	}
}

3456 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


3457 
	$¦si_mlme_g‘_num_ª‹Âas
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
num_ª‹Âas
)

3459 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3460 
sk_buff
 *
»q
;

3461 
sk_buff
 *
cfm
;

3462 
»t
 = 0;

3463 cÚ¡ 
boŞ
 
is_¡a
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
);

3464 cÚ¡ 
boŞ
 
is_soá­
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
);

3466 ià(!
is_¡a
 && !
is_soá­
) {

3467 
	`SLSI_NET_ERR
(
dev
, "Inv®id iÁ”çûy³ %s\n", dev->
Çme
);

3468  -
EPERM
;

3470 ià(
is_¡a
 && (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

3471 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

3472  -
EPERM
;

3474 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "mlme_g‘_num_ª‹Âas_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

3476 
»q
 = 
	`çpi_®loc
(
mlme_g‘_num_ª‹Âas_»q
, 
MLME_GET_NUM_ANTENNAS_REQ
, 
ndev_vif
->
iâum
, 0);

3477 ià(!
»q
)

3478  -
EIO
;

3480 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_GET_NUM_ANTENNAS_CFM
);

3481 ià(!
cfm
)

3482  -
EIO
;

3484 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_num_ª‹Âas_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3485 
	`SLSI_NET_ERR
(
dev
, "mlme_get_num_antennas_cfm(result:0x%04x) ERROR\n",

3486 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_num_ª‹Âas_cfm
.
»suÉ_code
));

3487 
»t
 = -
EINVAL
;

3489 *
num_ª‹Âas
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_num_ª‹Âas_cfm
.
numb”_of_ª‹Âas
);

3491 
	`kä“_skb
(
cfm
);

3492  
»t
;

3493 
	}
}

3496 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3497 
	$¦si_mlme_synchrÚi£d_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3498 
cfg80211_ex‹º®_auth_·¿ms
 *
·¿ms
)

3500 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3501 
sk_buff
 *
»q
;

3502 
sk_buff
 *
cfm
;

3503 ià(
ndev_vif
->
aùiv©ed
) {

3504 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "MLME_SYNCHRONISED_RES\n");

3506 
»q
 = 
	`çpi_®loc
(
mlme_synchrÚi£d_»s
, 
MLME_SYNCHRONISED_RES
, 
ndev_vif
->
iâum
, 0);

3507 ià(!
»q
)

3508  -
ENOMEM
;

3510 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_synchrÚi£d_»s
.
»suÉ_code
, 
·¿ms
->
¡©us
);

3511 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_synchrÚi£d_»s
.
bssid
, 
·¿ms
->bssid);

3513 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_synchronised_response(vif:%d) status:%d\n",

3514 
ndev_vif
->
iâum
, 
·¿ms
->
¡©us
);

3515 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

3516 ià(
cfm
)

3517 
	`SLSI_NET_ERR
(
dev
, "Received cfm for MLME_SYNCHRONISED_RES\n");

3519 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "vif is‚ot‡ctive");

3520 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3521 
ndev_vif
->
¡a
.
w·3_auth_¡©e
 = 
SLSI_WPA3_AUTHENTICATED
;

3525 
	}
}

3528 
	$¦si_mlme_»gi¡”_aùiÚ_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
af_b™m­_aùive
, u32 
af_b™m­_su¥’ded
)

3530 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3531 
sk_buff
 *
»q
;

3532 
sk_buff
 *
cfm
;

3533 
r
 = 0;

3535 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3537 
»q
 = 
	`çpi_®loc
(
mlme_»gi¡”_aùiÚ_äame_»q
, 
MLME_REGISTER_ACTION_FRAME_REQ
, 
ndev_vif
->
iâum
, 0);

3538 ià(!
»q
)

3539  -
ENOMEM
;

3541 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_»gi¡”_aùiÚ_äame_»q
.
aùiÚ_äame_ÿ‹gÜy_b™m­_aùive
, 
af_b™m­_aùive
);

3542 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_»gi¡”_aùiÚ_äame_»q
.
aùiÚ_äame_ÿ‹gÜy_b™m­_su¥’ded
, 
af_b™m­_su¥’ded
);

3544 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_»gi¡”_aùiÚ_äame(vif:%d,‡ùive:%d, su¥’ded:%d)\n", 
ndev_vif
->
iâum
, 
af_b™m­_aùive
, 
af_b™m­_su¥’ded
);

3545 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_REGISTER_ACTION_FRAME_CFM
);

3546 ià(!
cfm
)

3547  -
EIO
;

3549 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»gi¡”_aùiÚ_äame_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3550 
	`SLSI_NET_ERR
(
dev
, "mlme_register_action_frame_cfm(result:0x%04x) ERROR\n",

3551 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»gi¡”_aùiÚ_äame_cfm
.
»suÉ_code
));

3552 
r
 = -
EINVAL
;

3555 
	`kä“_skb
(
cfm
);

3556  
r
;

3557 
	}
}

3559 
	$¦si_mlme_chªÃl_sw™ch
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ûÁ”_äeq
, u16 
chª_šfo
)

3561 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3562 
sk_buff
 *
»q
;

3563 
sk_buff
 *
cfm
;

3564 
r
 = 0;

3566 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3568 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_chªÃl_sw™ch_»q(vif:%d, f»q: %d, chªÃÈšfo: 0x%x)\n", 
ndev_vif
->
iâum
, 
ûÁ”_äeq
, 
chª_šfo
);

3569 
»q
 = 
	`çpi_®loc
(
mlme_chªÃl_sw™ch_»q
, 
MLME_CHANNEL_SWITCH_REQ
, 
ndev_vif
->
iâum
, 0);

3570 ià(!
»q
)

3571  -
ENOMEM
;

3573 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_chªÃl_sw™ch_»q
.
chªÃl_äequ’cy
, 
	`SLSI_FREQ_HOST_TO_FW
(
ûÁ”_äeq
));

3574 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_chªÃl_sw™ch_»q
.
chªÃl_šfÜm©iÚ
, 
chª_šfo
);

3576 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_CHANNEL_SWITCH_CFM
);

3577 ià(!
cfm
)

3578  -
EIO
;

3580 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_chªÃl_sw™ch_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3581 
	`SLSI_NET_ERR
(
dev
, "mlme_channel_switch_cfm(result:0x%04x) ERROR\n",

3582 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_chªÃl_sw™ch_cfm
.
»suÉ_code
));

3583 
r
 = -
EINVAL
;

3586 
	`kä“_skb
(
cfm
);

3587  
r
;

3588 
	}
}

3590 
	$¦si_mlme_add_šfo_–em’ts
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pu½o£
, cÚ¡ 
u8
 *
›s
, cÚ¡ u16 
›s_Ën
)

3592 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3593 
sk_buff
 *
»q
;

3594 
sk_buff
 *
cfm
;

3595 
r
 = 0;

3596 
u8
 *
p
;

3598 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3600 
»q
 = 
	`çpi_®loc
(
mlme_add_šfo_–em’ts_»q
, 
MLME_ADD_INFO_ELEMENTS_REQ
, 
ndev_vif
->
iâum
, 
›s_Ën
);

3601 ià(!
»q
)

3602  -
ENOMEM
;

3604 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_šfo_–em’ts_»q
.
pu½o£
,…urpose);

3606 ià(
›s_Ën
 != 0) {

3607 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
›s
, 
›s_Ën
);

3608 ià(!
p
) {

3609 
	`kä“_skb
(
»q
);

3610  -
EINVAL
;

3614 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_šfo_–em’ts_»q(vif:%d, ies_Ën:%d)\n", 
ndev_vif
->
iâum
, 
›s_Ën
);

3615 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_INFO_ELEMENTS_CFM
);

3616 ià(!
cfm
)

3617  -
EIO
;

3619 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_šfo_–em’ts_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3620 
	`SLSI_NET_ERR
(
dev
, "mlme_add_info_elements_cfm(result:0x%04x) ERROR\n",

3621 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_šfo_–em’ts_cfm
.
»suÉ_code
));

3622 
r
 = -
EINVAL
;

3625 
	`kä“_skb
(
cfm
);

3626  
r
;

3627 
	}
}

3629 
	$¦si_mlme_£nd_äame_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
msg_ty³
,

3630 
u16
 
ho¡_g
, 
u32
 
dw–l_time
, u32 
³riod
)

3632 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3633 
u16
 
Ën
 = 
skb
->len;

3634 
sk_buff
 *
Üigš®_skb
 = 0;

3635 
»t
;

3636 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3637 
is_’hªûd_¬p_»que¡_äame
 = 0;

3641 ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_ARP
) {

3642 
ä“_¦Ùs
 = 0;

3644 
ä“_¦Ùs
 = 
	`h4_ä“_ù¾_¦Ùs_couÁ
(&
sdev
->
h4_š¡
);

3646 ià(
ä“_¦Ùs
 < 0) {

3647 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
,

3649  
ä“_¦Ùs
;

3652 ià(
ä“_¦Ùs
 < 
SLSI_MLME_ARP_DROP_FREE_SLOTS_COUNT
) {

3653 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
,

3654 "drİ ARP (NØARP CÚŒŞ slÙs:%d)\n", 
ä“_¦Ùs
);

3655 
	`kä“_skb
(
skb
);

3656  
NETDEV_TX_OK
;

3659 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3660 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 && (
msg_ty³
 =ğ
FAPI_MESSAGETYPE_ARP
)) {

3661 
u8
 *
äame
 = 
skb
->
d©a
 + (
‘hhdr
);

3662 
u16
 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

3664 ià((
¬p_İcode
 =ğ
SLSI_ARP_REQUEST_OPCODE
) &&

3665 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

3666 !
	`memcmp
(&
äame
[
SLSI_ARP_DEST_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4))

3667 
is_’hªûd_¬p_»que¡_äame
 = 1;

3673 ià(
	`skb_h—droom
(
skb
è< (
	`çpi_sig_size
(
mlme_£nd_äame_»q
))) {

3674 
sk_buff
 *
skb2
 = 
NULL
;

3676 
skb2
 = 
	`skb_»®loc_h—droom
(
skb
, 
	`çpi_sig_size
(
mlme_£nd_äame_»q
));

3677 ià(!
skb2
)

3678  -
EINVAL
;

3679 
Üigš®_skb
 = 
skb
;

3680 
skb
 = 
skb2
;

3682 
Ën
 = 
skb
->len;

3683 ()
	`skb_push
(
skb
, (
	`çpi_sig_size
(
mlme_£nd_äame_»q
)));

3686 
	`çpi_£t_u16
(
skb
, 
id
, 
MLME_SEND_FRAME_REQ
);

3687 
	`çpi_£t_u16
(
skb
, 
»ûiv”_pid
, 0);

3688 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
SLSI_TX_PROCESS_ID_MIN
);

3689 
	`çpi_£t_u16
(
skb
, 
fw_»ã»nû
, 0);

3692 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
vif
, 
ndev_vif
->
iâum
);

3694 ià(
ho¡_g
 == 0)

3695 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3696 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

3697 ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_ARP
 && 
sdev
->
fw_max_¬p_couÁ
)

3698 
ho¡_g
 |ğ
SLSI_HOST_TAG_ARP_MASK
;

3700 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
ho¡_g
, host_tag);

3701 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
d©a_un™_desütÜ
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
);

3702 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
mes§ge_ty³
, 
msg_ty³
);

3703 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
chªÃl_äequ’cy
, 0);

3704 
	`çpi_£t_u32
(
skb
, 
u
.
mlme_£nd_äame_»q
.
dw–l_time
, dwell_time);

3705 
	`çpi_£t_u32
(
skb
, 
u
.
mlme_£nd_äame_»q
.
³riod
,…eriod);

3707 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "vif:%d, mes§ge_ty³:%d, ho¡_g:0x%x\n", 
ndev_vif
->
iâum
, 
msg_ty³
, 
ho¡_g
);

3709 
»t
 = 
	`¦si_tx_cÚŒŞ
(
sdev
, 
dev
, 
skb
);

3710 ià(
»t
 != 0) {

3711 
	`SLSI_WARN
(
sdev
, "çedØ£nd MLME sigÇlÓ¼=%d)\n", 
»t
);

3712  
»t
;

3714 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

3715 ià(
ho¡_g
 & 
SLSI_HOST_TAG_ARP_MASK
) {

3716 
	`©omic_šc
(&
sdev
->
¬p_tx_couÁ
);

3717 
	`©omic_šc
(&
ndev_vif
->
¬p_tx_couÁ
);

3719 ià(
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è=ğsdev->
fw_max_¬p_couÁ
) {

3720 
	`scsc_wifi_·u£_¬p_q_®l_vif
(
sdev
);

3721 ià(
	`d–ayed_wÜk_³ndšg
(&
sdev
->
uÅau£_¬p_q_wÜk
))

3722 
	`ÿnûl_d–ayed_wÜk
(&
sdev
->
uÅau£_¬p_q_wÜk
);

3723 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &sdev->
uÅau£_¬p_q_wÜk
,

3724 
	`m£cs_to_jiff›s
(
SLSI_UNPAUSE_ARP_Q_TIMEOUT_MSEC
));

3728 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3729 ià(
is_’hªûd_¬p_»que¡_äame
) {

3730 
i
;

3732 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_to_low”_mac
++;

3733 
i
 = 0; i < 
SLSI_MAX_ARP_SEND_FRAME
; i++) {

3734 ià(!
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
]) {

3735 
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
] = 
ho¡_g
;

3742 ià(
Üigš®_skb
)

3743 
	`cÚsume_skb
(
Üigš®_skb
);

3749 ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_EAPOL_KEY_M4
) {

3750 
ndev_vif
->
¡a
.
m4_ho¡_g
 = 
ho¡_g
;

3751 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "EAPOL-Key M4 f¿m(ho¡_g:%d)\n", 
ndev_vif
->
¡a
.
m4_ho¡_g
);

3752 } ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_EAP_MESSAGE
) {

3753 ià(!
ndev_vif
->
¡a
.
is_wps
 && (ndev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)) {

3757 
ndev_vif
->
¡a
.
—p_ho¡g
 = 
ho¡_g
;

3758 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "EAP f¿m(ho¡_g:%d)\n", 
ndev_vif
->
¡a
.
—p_ho¡g
);

3762 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 && 
msg_ty³
 =ğ
FAPI_MESSAGETYPE_EAP_MESSAGE
)

3763 
sdev
->
cÚn_log2us_ùx
.
ho¡_g_—p
 = 
ho¡_g
;

3765  
»t
;

3766 
	}
}

3768 
	$¦si_mlme_£nd_äame_mgmt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
äame
, 
äame_Ën
,

3769 
u16
 
d©a_desc
, u16 
msg_ty³
, u16 
ho¡_g
, u16 
äeq
, 
u32
 
dw–l_time
, u32 
³riod
)

3771 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3772 
sk_buff
 *
»q
;

3773 
sk_buff
 *
cfm
;

3774 
r
 = 0;

3775 
u8
 *
p
;

3777 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3779 
»q
 = 
	`çpi_®loc
(
mlme_£nd_äame_»q
, 
MLME_SEND_FRAME_REQ
, 
ndev_vif
->
iâum
, 
äame_Ën
);

3780 ià(!
»q
) {

3781 
	`SLSI_WARN
(
sdev
, "failedo‡lloc memory\n");

3782  -
ENOMEM
;

3785 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
ho¡_g
, host_tag);

3786 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
d©a_un™_desütÜ
, 
d©a_desc
);

3787 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
mes§ge_ty³
, 
msg_ty³
);

3788 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
chªÃl_äequ’cy
, 
äeq
);

3789 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£nd_äame_»q
.
dw–l_time
, dwell_time);

3790 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£nd_äame_»q
.
³riod
,…eriod);

3792 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
äame
, 
äame_Ën
);

3793 ià(!
p
) {

3794 
	`kä“_skb
(
»q
);

3795 
	`SLSI_WARN
(
sdev
, "failedo‡ppend data\n");

3796  -
EINVAL
;

3799 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_send_frame_req(vif:%d, message_type:%d,host_tag:%d, frame_len:%d)\n",

3800 
ndev_vif
->
iâum
, 
msg_ty³
, 
ho¡_g
, 
äame_Ën
);

3801 
	`¦si_debug_äame
(
sdev
, 
dev
, 
»q
, "TX");

3802 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SEND_FRAME_CFM
);

3803 ià(!
cfm
)

3804  -
EIO
;

3806 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£nd_äame_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3807 
	`SLSI_NET_ERR
(
dev
, "mlme_send_frame_cfm(result:0x%04x) ERROR\n",

3808 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£nd_äame_cfm
.
»suÉ_code
));

3809 
r
 = -
EINVAL
;

3812 
	`kä“_skb
(
cfm
);

3813  
r
;

3814 
	}
}

3816 
	$¦si_mlme_wifish¬šg_³rm™‹d_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³rm™‹d_chªÃls
)

3818 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3819 
sk_buff
 *
»q
;

3820 
sk_buff
 *
cfm
;

3821 
r
 = 0;

3823 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3825 
»q
 = 
	`çpi_®loc
(
mlme_wifish¬šg_³rm™‹d_chªÃls_»q
, 
MLME_WIFISHARING_PERMITTED_CHANNELS_REQ
,

3827 ià(!
»q
) {

3828 
r
 = -
ENOMEM
;

3829 
ex™
;

3832 
	`çpi_­³nd_d©a
(
»q
, 
³rm™‹d_chªÃls
, 8);

3834 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_WIFISHARING_PERMITTED_CHANNELS_CFM
);

3835 ià(!
cfm
) {

3836 
r
 = -
EIO
;

3837 
ex™
;

3840 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3841 
	`SLSI_NET_ERR
(
dev
, "mlme_wifisharing_permitted_channels_cfm(result:0x%04x) ERROR\n",

3842 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
.
»suÉ_code
));

3843 
r
 = -
EINVAL
;

3846 
ex™
:

3847 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3848  
r
;

3850 
	}
}

3852 
	$¦si_mlme_»£t_dw–l_time
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3854 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3855 
sk_buff
 *
»q
;

3856 
sk_buff
 *
cfm
;

3857 
r
 = 0;

3859 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3860 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3861  -
EINVAL
;

3863 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_»£t_dw–l_time_»q (vif:%d)\n", 
ndev_vif
->
iâum
);

3865 
»q
 = 
	`çpi_®loc
(
mlme_»£t_dw–l_time_»q
, 
MLME_RESET_DWELL_TIME_REQ
, 
ndev_vif
->
iâum
, 0);

3867 ià(!
»q
)

3868  -
ENOMEM
;

3870 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_RESET_DWELL_TIME_CFM
);

3871 ià(!
cfm
)

3872  -
EIO
;

3874 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»£t_dw–l_time_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3875 
	`SLSI_NET_ERR
(
dev
, "mlme_reset_dwell_time_cfm(result:0x%04x) ERROR\n",

3876 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»£t_dw–l_time_cfm
.
»suÉ_code
));

3877 
r
 = -
EINVAL
;

3880 
	`kä“_skb
(
cfm
);

3881  
r
;

3882 
	}
}

3884 
	$¦si_mlme_£t_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3885 
pkt_f‹r_Ën
,

3886 
u8
 
num_f‹rs
,

3887 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–ems
)

3889 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3890 
sk_buff
 *
»q
;

3891 
sk_buff
 *
cfm
;

3892 
r
 = 0, 
i
 = 0, 
j
 = 0;

3893 
u8
 *
p
;

3894 
šdex
 = 0;

3896 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3897  -
EINVAL
;

3899 ià(
	`WARN_ON
(!
num_f‹rs
))

3900  -
EINVAL
;

3902 
»q
 = 
	`çpi_®loc
(
mlme_£t_·ck‘_f‹r_»q
, 
MLME_SET_PACKET_FILTER_REQ
, 
ndev_vif
->
iâum
, 
pkt_f‹r_Ën
);

3903 ià(!
»q
)

3904  -
ENOMEM
;

3906 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
pkt_f‹r_Ën
);

3907 ià(!
p
) {

3908 
	`kä“_skb
(
»q
);

3909  -
EINVAL
;

3912 
i
 = 0; i < 
num_f‹rs
; i++) {

3913 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
 = 
pkt_f‹r_–ems
[
i
];

3915 
	`memıy
(&
p
[
šdex
], 
pkt_f‹r_–em
.
h—d”
, 
SLSI_PKT_FILTER_ELEM_HDR_LEN
);

3916 
šdex
 +ğ
SLSI_PKT_FILTER_ELEM_HDR_LEN
;

3918 
j
 = 0; j < 
pkt_f‹r_–em
.
num_·‰”n_desc
; j++) {

3919 
p
[
šdex
++] = 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
off£t
;

3920 
p
[
šdex
++] = 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask_Ëngth
;

3921 
	`memıy
(&
p
[
šdex
], 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask
,…kt_f‹r_–em.·‰”n_desc[j].
mask_Ëngth
);

3922 
šdex
 +ğ
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask_Ëngth
;

3923 
	`memıy
(&
p
[
šdex
], 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
·‰”n
,…kt_f‹r_–em.·‰”n_desc[j].
mask_Ëngth
);

3924 
šdex
 +ğ
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask_Ëngth
;

3928 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_·ck‘_f‹r_»q(vif:%d,‚um_f‹rs:%d)\n", 
ndev_vif
->
iâum
, 
num_f‹rs
);

3929 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_PACKET_FILTER_CFM
);

3930 ià(!
cfm
)

3931  -
EIO
;

3933 
	`kä“_skb
(
cfm
);

3934  
r
;

3935 
	}
}

3937 
	$¦si_mlme_rßm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
, 
u16
 
äeq
)

3939 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3940 
sk_buff
 *
»q
;

3941 
sk_buff
 *
cfm
;

3942 
r
 = 0;

3944 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3945 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3946  -
EINVAL
;

3948 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_rßm_»q(vif:%u, bssid:%pM, f»q:%d)\n", 
ndev_vif
->
iâum
, 
bssid
, 
äeq
);

3949 
»q
 = 
	`çpi_®loc
(
mlme_rßm_»q
, 
MLME_ROAM_REQ
, 
ndev_vif
->
iâum
, 0);

3950 ià(!
»q
)

3951  -
ENOMEM
;

3952 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_rßm_»q
.
bssid
, bssid);

3953 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_rßm_»q
.
chªÃl_äequ’cy
, 
	`SLSI_FREQ_HOST_TO_FW
(
äeq
));

3954 
	`©omic_£t
(&
ndev_vif
->
¡a
.
drİ_rßmed_šd
, 1);

3955 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ROAM_CFM
);

3956 
	`©omic_£t
(&
ndev_vif
->
¡a
.
drİ_rßmed_šd
, 0);

3957 ià(!
cfm
)

3958  -
EIO
;

3959 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßm_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3960 
	`SLSI_NET_ERR
(
dev
, "mlme_roam_cfm(result:0x%04x) ERROR\n",

3961 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßm_cfm
.
»suÉ_code
));

3962 
r
 = -
EINVAL
;

3964 
	`kä“_skb
(
cfm
);

3965 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 = 
Œue
;

3966  
r
;

3967 
	}
}

3969 
	$¦si_mlme_£t_ÿched_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
chªÃls_couÁ
, 
u8
 *
chªÃls
)

3971 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3972 
sk_buff
 *
»q
;

3973 
sk_buff
 *
cfm
;

3974 
u8
 *
p
;

3975 
r
 = 0;

3976 
size_t
 
chªÃl_›
 = 0;

3977 
i
;

3978 
¦si_mlme_·¿m‘”s
 
chªÃls_li¡_›
 = {0};

3980 
	`¦si_mlme_£t_chªÃls_›
(&
chªÃls_li¡_›
);

3982 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3983 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3984  -
EINVAL
;

3986 ià(
chªÃls_couÁ
) {

3987 
chªÃl_›
 +ğ6 + (
chªÃls_couÁ
 * 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

3988 
»q
 = 
	`çpi_®loc
(
mlme_£t_ÿched_chªÃls_»q
, 
MLME_SET_CACHED_CHANNELS_REQ
, 
ndev_vif
->
iâum
, 
chªÃl_›
);

3990 
»q
 = 
	`çpi_®loc
(
mlme_£t_ÿched_chªÃls_»q
, 
MLME_SET_CACHED_CHANNELS_REQ
, 
ndev_vif
->
iâum
, 0);

3992 ià(!
»q
)

3993  -
ENOMEM
;

3995 ià(
chªÃls_couÁ
) {

3996 
u16
 
äeq_fw_un™
;

3997 
¦si_mlme_·¿m‘”s
 *
chªÃls_li¡_›_h—d
 =

3998 (
¦si_mlme_·¿m‘”s
 *)
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
chªÃls_li¡_›
,

3999 (
chªÃls_li¡_›
));

4001 ià(!
chªÃls_li¡_›_h—d
) {

4002 
	`SLSI_WARN
(
sdev
, "channel†ist IE‡ppend failed\n");

4003 
	`kä“_skb
(
»q
);

4004  -
EINVAL
;

4007 
i
 = 0; i < 
chªÃls_couÁ
; i++) {

4008 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "»que¡ fÜ chªÃl %d\n", 
chªÃls
[
i
]);

4009 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

4010 ià(!
p
) {

4011 
	`kä“_skb
(
»q
);

4012  -
EINVAL
;

4014 
äeq_fw_un™
 = 2 * 
	`›“80211_chªÃl_to_äequ’cy
(
chªÃls
[
i
], (chªÃls[i] <ğ14è? 
NL80211_BAND_2GHZ
 : 
NL80211_BAND_5GHZ
);

4015 
äeq_fw_un™
 = 
	`ıu_to_Ë16
(freq_fw_unit);

4016 
	`memıy
(
p
, &
äeq_fw_un™
, (freq_fw_unit));

4018 
p
[2] = 
FAPI_SCANPOLICY_2_4GHZ
 | 
FAPI_SCANPOLICY_5GHZ
;

4020 
chªÃls_li¡_›_h—d
->
Ëngth
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

4024 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_ÿched_chªÃls_»q(vif:%d, chªÃl_couÁ:%d)\n", 
ndev_vif
->
iâum
, 
chªÃls_couÁ
);

4025 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CACHED_CHANNELS_CFM
);

4026 ià(!
cfm
)

4027  -
EIO
;

4029 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ÿched_chªÃls_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4030 
	`SLSI_NET_ERR
(
dev
, "mlme_set_cached_channels_cfm(result:0x%04x) ERROR\n",

4031 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ÿched_chªÃls_cfm
.
»suÉ_code
));

4032 
r
 = -
EINVAL
;

4035 
	`kä“_skb
(
cfm
);

4036  
r
;

4037 
	}
}

4039 
	$¦si_mlme_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
iâum
,

4040 
Æ80211_aş_pŞicy
 
aş_pŞicy
, 
max_aş_’Œ›s
,

4041 
mac_add»ss
 
mac_addrs
[])

4043 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4044 
sk_buff
 *
»q
;

4045 
sk_buff
 *
cfm
;

4046 
size_t
 
mac_aş_size
 = 0;

4047 
i
, 
r
 = 0;

4048 
n_aş_’Œ›s
 = 0;

4049 
u8
 
z”o_addr
[
ETH_ALEN
] = {0};

4051 ià(
iâum
 > 0 && 
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4052  -
EINVAL
;

4054 
i
 = 0; i < 
max_aş_’Œ›s
; i++) {

4055 ià(!
	`SLSI_ETHER_EQUAL
(
mac_addrs
[
i
].
addr
, 
z”o_addr
))

4056 
n_aş_’Œ›s
++;

4059 
mac_aş_size
 = ((
mac_addrs
[0])è* (
n_aş_’Œ›s
);

4060 
»q
 = 
	`çpi_®loc
(
mlme_£t_aş_»q
, 
MLME_SET_ACL_REQ
, 
iâum
, 
mac_aş_size
);

4061 ià(!
»q
) {

4062 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

4063  -
ENOMEM
;

4065 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_aş_»q
.
’Œ›s
, 
n_aş_’Œ›s
);

4066 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_aş_»q
.
aş_pŞicy
,‡cl_policy);

4068 
i
 = 0; i < 
max_aş_’Œ›s
; i++) {

4069 ià(!
	`SLSI_ETHER_EQUAL
(
mac_addrs
[
i
].
addr
, 
z”o_addr
))

4070 
	`çpi_­³nd_d©a
(
»q
, 
mac_addrs
[
i
].
addr
, ((mac_addrs[i])));

4073 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_aş_»q(vif:%u,‚_aş_’Œ›s:%d)\n", 
iâum
, 
n_aş_’Œ›s
);

4075 ià(
iâum
)

4076 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_ACL_CFM
);

4078 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_SET_ACL_CFM
);

4079 ià(!
cfm
)

4080  -
EIO
;

4082 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_aş_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4083 
	`SLSI_NET_ERR
(
dev
, "mlme_set_acl_cfm(result:0x%04x) ERROR\n",

4084 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_aş_cfm
.
»suÉ_code
));

4085 
r
 = -
EINVAL
;

4088 
	`kä“_skb
(
cfm
);

4089  
r
;

4090 
	}
}

4092 
	$¦si_mlme_£t_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
, u16 
medium_time
, u16 
mšimun_d©a_¿‹
, 
u8
 *
mac
)

4094 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4095 
sk_buff
 *
»q
;

4096 
sk_buff
 *
rx
;

4097 
r
 = 0;

4099 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4101 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4102  -
EINVAL
;

4104 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
))

4105  -
EINVAL
;

4107 
»q
 = 
	`çpi_®loc
(
mlme_£t_Œaffic_·¿m‘”s_»q
, 
MLME_SET_TRAFFIC_PARAMETERS_REQ
, 
ndev_vif
->
iâum
, 0);

4108 ià(!
»q
)

4109  -
ENOMEM
;

4111 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
u£r_´iÜ™y
, user_priority);

4112 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
medium_time
, medium_time);

4113 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
mšimum_d©a_¿‹
, 
mšimun_d©a_¿‹
);

4115 ià(
mac
)

4116 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
³”_add»ss
, 
mac
);

4118 
	`çpi_£t_mem£t
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
³”_add»ss
, 0);

4120 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_Œaffic_·¿m‘”s_»q(vif:%u, u£r_´iÜ™y:%d, medium_time:%d)\n", 
ndev_vif
->
iâum
, 
u£r_´iÜ™y
, 
medium_time
);

4121 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_TRAFFIC_PARAMETERS_CFM
);

4122 ià(!
rx
)

4123  -
EIO
;

4125 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4126 
	`SLSI_NET_ERR
(
dev
, "mlme_set_traffic_parameters_cfm(result:0x%04x) ERROR\n",

4127 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
));

4128 
r
 = -
EINVAL
;

4131  
r
;

4132 
	}
}

4134 
	$¦si_mlme_d–_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
)

4136 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4137 
sk_buff
 *
»q
;

4138 
sk_buff
 *
rx
;

4139 
r
 = 0;

4141 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4143 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4144  -
EINVAL
;

4146 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
))

4147  -
EINVAL
;

4149 
»q
 = 
	`çpi_®loc
(
mlme_d–_Œaffic_·¿m‘”s_»q
, 
MLME_DEL_TRAFFIC_PARAMETERS_REQ
, 
ndev_vif
->
iâum
, 0);

4150 ià(!
»q
)

4151  -
ENOMEM
;

4153 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_Œaffic_·¿m‘”s_»q
.
u£r_´iÜ™y
, user_priority);

4155 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_d–_Œaffic_·¿m‘”s_»q(vif:%u, u£r_´iÜ™y:%d)\n", 
ndev_vif
->
iâum
, 
u£r_´iÜ™y
);

4156 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_TRAFFIC_PARAMETERS_CFM
);

4157 ià(!
rx
)

4158  -
EIO
;

4160 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_d–_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4161 
	`SLSI_NET_ERR
(
dev
, "mlme_del_traffic_parameters_cfm(result:0x%04x) ERROR\n",

4162 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_d–_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
));

4163 
r
 = -
EINVAL
;

4166  
r
;

4167 
	}
}

4169 
	$¦si_mlme_£t_ext_ÿ·b
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
d©a
, 
d©®’gth
)

4171 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4172 
”rÜ
 = 0;

4174 
”rÜ
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES
, 
d©®’gth
, 
d©a
, 0);

4175 ià(
”rÜ
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4176 
”rÜ
 = -
ENOMEM
;

4177 
ex™
;

4180 ià(
	`WARN_ON
(
mib_d©a
.
d©aL’gth
 == 0)) {

4181 
”rÜ
 = -
EINVAL
;

4182 
ex™
;

4185 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

4186 
	`kä“
(
mib_d©a
.
d©a
);

4188 ià(!
”rÜ
)

4191 
ex™
:

4192 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šgƒxˆÿ·b.ƒ¼Ü = %d\n", 
”rÜ
);

4193  
”rÜ
;

4194 
	}
}

4196 
	$¦si_mlme_tdls_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
³”
, 
aùiÚ
)

4198 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4199 
sk_buff
 *
»q
;

4200 
sk_buff
 *
cfm
;

4201 
r
 = 0;

4203 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_tdls_aùiÚ_»q×ùiÚ:%u)\n", 
aùiÚ
);

4204 
»q
 = 
	`çpi_®loc
(
mlme_tdls_aùiÚ_»q
, 
MLME_TDLS_ACTION_REQ
, 
ndev_vif
->
iâum
, 0);

4205 ià(!
»q
)

4206  -
ENOMEM
;

4208 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_tdls_aùiÚ_»q
.
³”_¡a_add»ss
, 
³”
);

4209 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_tdls_aùiÚ_»q
.
tdls_aùiÚ
, 
aùiÚ
);

4211 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_TDLS_ACTION_CFM
);

4212 ià(!
cfm
)

4213  -
EIO
;

4215 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_tdls_aùiÚ_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4216 
	`SLSI_NET_ERR
(
dev
, "mlme_tdls_action_cfm(result:0x%04x) ERROR\n",

4217 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_tdls_aùiÚ_cfm
.
»suÉ_code
));

4218 
r
 = -
EINVAL
;

4221 
	`kä“_skb
(
cfm
);

4223  
r
;

4224 
	}
}

4226 
	$¦si_mlme_»assocŸ‹
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4228 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4229 
sk_buff
 *
»q
;

4230 
sk_buff
 *
cfm
;

4231 
r
 = 0;

4233 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4234 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4235  -
EINVAL
;

4237 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_»assoc_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

4238 
»q
 = 
	`çpi_®loc
(
mlme_»assocŸ‹_»q
, 
MLME_REASSOCIATE_REQ
, 
ndev_vif
->
iâum
, 0);

4239 ià(!
»q
)

4240  -
ENOMEM
;

4242 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_REASSOCIATE_CFM
);

4243 ià(!
cfm
)

4244  -
EIO
;

4246 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»assocŸ‹_cfm
.
»suÉ_code
è=ğ
FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
) {

4247 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_reassoc_cfm(result:0x%04x)\n",

4248 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»assocŸ‹_cfm
.
»suÉ_code
));

4250 
	`SLSI_NET_ERR
(
dev
, "mlme_reassoc_cfm(result:0x%04x) ERROR\n",

4251 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»assocŸ‹_cfm
.
»suÉ_code
));

4252 
r
 = -
EINVAL
;

4254 
	`kä“_skb
(
cfm
);

4255  
r
;

4256 
	}
}

4258 
	$¦si_mlme_»assocŸ‹_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4260 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4261 
sk_buff
 *
»q
;

4262 
sk_buff
 *
cfm
;

4264 ià(
	`WLBT_WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4267 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4268 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_REASSOCIATE_RESP\n");

4272 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_»assocŸ‹_»¥(vif:%d)\n", 
ndev_vif
->
iâum
);

4273 
»q
 = 
	`çpi_®loc
(
mlme_»assocŸ‹_»s
, 
MLME_REASSOCIATE_RES
, 
ndev_vif
->
iâum
, 0);

4274 ià(!
»q
)

4277 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

4278 
	`WARN_ON
(
cfm
);

4279 
	}
}

4281 
	$¦si_mlme_add_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
,

4282 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
, 
u16
 
¹t_id
, 
u8
 *
sourû_addr
)

4284 
sk_buff
 *
»q
;

4285 
sk_buff
 *
rx
;

4286 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4287 
r
 = 0, 
i
;

4288 
size_t
 
®loc_d©a_size
 = 0;

4289 
u8
 
çpi_›_g’”ic
[] = { 0xdd, 0x1c, 0x00, 0x16, 0x32, 0x0a, 0x01 };

4291 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4293 
®loc_d©a_size
 +ğ
couÁ
 * (
çpi_›_g’”ic
[1] + 2);

4295 
»q
 = 
	`çpi_®loc
(
mlme_add_¿nge_»q
, 
MLME_ADD_RANGE_REQ
, 0, 
®loc_d©a_size
);

4296 ià(!
»q
) {

4297 
	`SLSI_ERR
(
sdev
, "çedØ®loø%zd\n", 
®loc_d©a_size
);

4298  -
ENOMEM
;

4300 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "count:%d‡llocated data size: %d, source_addr:%pM\n",

4301 
couÁ
, 
®loc_d©a_size
, 
sourû_addr
);

4303 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_¿nge_»q
.
vif
, 0);

4304 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_¿nge_»q
.
¹t_id
,„tt_id);

4305 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_¿nge_»q
.
deviû_add»ss
, 
sourû_addr
);

4306 
i
 = 0; i < 
couÁ
; i++) {

4307 
	`çpi_­³nd_d©a
(
»q
, 
çpi_›_g’”ic
, (fapi_ie_generic));

4308 
	`çpi_­³nd_d©a
(
»q
, 
Æ_¹t_·¿ms
[
i
].
³”_addr
, 
ETH_ALEN
);

4309 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
¹t_³”
, 1);

4310 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
¹t_ty³
, 1);

4311 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
chªÃl_äeq
, 2);

4312 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
bur¡_³riod
, 1);

4313 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
num_bur¡
, 1);

4314 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
num_äames_³r_bur¡
, 1);

4315 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
num_»Œ›s_³r_ámr
, 1);

4316 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
bur¡_du¿tiÚ
, 1);

4317 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
´—mbË
, 2);

4318 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
bw
, 2);

4319 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
LCI_»que¡
, 2);

4320 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
LCR_»que¡
, 2);

4322 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_RANGE_CFM
);

4323 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "(After mlme„eq cfm for„tt config)\n");

4324 ià(!
rx
)

4325  -
EIO
;

4326 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_¿nge_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4327 
	`SLSI_ERR
(
sdev
, "mlme_add_range_cfm(ERROR:0x%04x)",

4328 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_¿nge_cfm
.
»suÉ_code
));

4329 
r
 = -
EINVAL
;

4332 
	`kä“_skb
(
rx
);

4333  
r
;

4334 
	}
}

4336 
boŞ
 
	$¦si_d–_¿nge_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

4338 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_¿nge_cfm
.
»suÉ_code
);

4339 
boŞ
 
r
 = 
çl£
;

4341 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

4343 ià(
	`WARN_ON
(!
dev
))

4344 
ex™
;

4346 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

4347 
r
 = 
Œue
;

4349 
	`SLSI_NET_ERR
(
dev
, "mlme_d–_¿nge_cfmÔesuÉ:0x%04xèERROR\n", 
»suÉ
);

4351 
ex™
:

4352 
	`kä“_skb
(
cfm
);

4353  
r
;

4354 
	}
}

4356 
	$¦si_mlme_d–_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
couÁ
,

4357 
u8
 *
addr
, 
u16
 
¹t_id
)

4359 
sk_buff
 *
»q
;

4360 
sk_buff
 *
rx
;

4361 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4362 
r
 = 0, 
i
;

4363 
size_t
 
®loc_d©a_size
 = 0;

4365 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4367 
®loc_d©a_size
 +ğ
couÁ
 * (
ETH_ALEN
);

4369 
»q
 = 
	`çpi_®loc
(
mlme_d–_¿nge_»q
, 
MLME_DEL_RANGE_REQ
, 0, 
®loc_d©a_size
);

4370 ià(!
»q
) {

4371 
	`SLSI_ERR
(
sdev
, "çedØ®loø%zd\n", 
®loc_d©a_size
);

4372  -
ENOMEM
;

4375 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_¿nge_»q
.
vif
, 0);

4376 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_¿nge_»q
.
¹t_id
,„tt_id);

4377 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_¿nge_»q
.
’Œ›s
, 
couÁ
);

4378 
	`SLSI_INFO
(
sdev
, "¹t_id:%d,couÁ:%d\n", 
¹t_id
, 
couÁ
);

4379 
i
 = 0; i < 
couÁ
; i++)

4380 
	`çpi_­³nd_d©a
(
»q
, &
addr
[
i
 * 
ETH_ALEN
], ETH_ALEN);

4382 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_RANGE_CFM
, 
MLME_RANGE_IND
, 
¦si_d–_¿nge_cfm_v®id©e
);

4383 ià(!
rx
) {

4384 
	`SLSI_NET_ERR
(
dev
, "mlme_del_range_cfm() ERROR\n");

4385 
r
 = -
EINVAL
;

4387 
	`kä“_skb
(
rx
);

4388  
r
;

4389 
	}
}

4391 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


4392 
	#SLSI_FAPI_EPNO_NETWORK_MIN_SIZE
 (3)

	)

4393 
	$¦si_mlme_¡¬t_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
mpdu_size_th»shŞd
, 
boŞ
 
agg»ssive_¡©s_’abËd
)

4395 
sk_buff
 *
»q
;

4396 
sk_buff
 *
cfm
;

4397 
r
 = 0;

4399 
»q
 = 
	`çpi_®loc
(
mlme_¡¬t_lšk_¡©i¡ics_»q
, 
MLME_START_LINK_STATISTICS_REQ
, 0, 0);

4400 ià(!
»q
) {

4401 
	`SLSI_ERR
(
sdev
, "memory‡llocation failed for signal\n");

4402  -
ENOMEM
;

4405 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_»q
.
mpdu_size_th»shŞd
, mpdu_size_threshold);

4406 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_»q
.
agg»ssive_¡©i¡ics_g©h”šg_’abËd
,

4407 
agg»ssive_¡©s_’abËd
);

4409 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "(mpdu_size_threshold:%d,‡ggressive_stats_enabled:%d)\n",

4410 
mpdu_size_th»shŞd
, 
agg»ssive_¡©s_’abËd
);

4411 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_START_LINK_STATISTICS_CFM
);

4412 ià(!
cfm
)

4413  -
EIO
;

4415 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4416 
	`SLSI_ERR
(
sdev
, "mlme_start_link_statistics_cfm (result:0x%04x) ERROR\n",

4417 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_cfm
.
»suÉ_code
));

4418 
r
 = -
EINVAL
;

4421 
	`kä“_skb
(
cfm
);

4422  
r
;

4423 
	}
}

4425 
	$¦si_mlme_¡İ_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
¡©s_¡İ_mask
)

4427 
sk_buff
 *
»q
;

4428 
sk_buff
 *
cfm
;

4429 
r
 = 0;

4431 
»q
 = 
	`çpi_®loc
(
mlme_¡İ_lšk_¡©i¡ics_»q
, 
MLME_STOP_LINK_STATISTICS_REQ
, 0, 0);

4432 ià(!
»q
) {

4433 
	`SLSI_ERR
(
sdev
, "memory‡llocation failed for signal\n");

4434  -
ENOMEM
;

4437 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡İ_lšk_¡©i¡ics_»q
.
¡©i¡ics_¡İ_b™m­
, 
¡©s_¡İ_mask
);

4439 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "¡©i¡ics_¡İ_b™m­:%d\n", 
¡©s_¡İ_mask
);

4440 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_STOP_LINK_STATISTICS_CFM
);

4441 ià(!
cfm
)

4442  -
EIO
;

4444 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡İ_lšk_¡©i¡ics_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4445 
	`SLSI_ERR
(
sdev
, "mlme_stop_link_statistics_cfm (result:0x%04x) ERROR\n",

4446 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡İ_lšk_¡©i¡ics_cfm
.
»suÉ_code
));

4447 
r
 = -
EINVAL
;

4449 
	`kä“_skb
(
cfm
);

4450  
r
;

4451 
	}
}

4454 
	$¦si_mlme_£t_rssi_mÚ™Ü
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
’abË
, 
s8
 
low_rssi_th»shŞd
, s8 
high_rssi_th»shŞd
)

4456 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4457 
sk_buff
 *
»q
;

4458 
sk_buff
 *
cfm
;

4459 
r
 = 0;

4461 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_set_rssi_monitor(vif:%u),ƒnable =%d,†ow_rssi_threshold = %d,high_rssi_threshold =%d\n",

4462 
ndev_vif
->
iâum
, 
’abË
, 
low_rssi_th»shŞd
, 
high_rssi_th»shŞd
);

4464 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4465 
»q
 = 
	`çpi_®loc
(
mlme_mÚ™Ü_rssi_»q
, 
MLME_MONITOR_RSSI_REQ
, 
ndev_vif
->
iâum
, 0);

4466 ià(!
»q
) {

4467 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

4468  -
ENOMEM
;

4471 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_mÚ™Ü_rssi_»q
.
rssi_mÚ™Üšg_’abËd
, 
’abË
);

4472 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_mÚ™Ü_rssi_»q
.
low_rssi_th»shŞd
,†ow_rssi_threshold);

4473 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_mÚ™Ü_rssi_»q
.
high_rssi_th»shŞd
, high_rssi_threshold);

4475 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_MONITOR_RSSI_CFM
);

4476 ià(!
cfm
)

4477  -
EIO
;

4479 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_mÚ™Ü_rssi_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4480 
	`SLSI_NET_ERR
(
dev
, "mlme_mÚ™Ü_rssi_cfmÔesuÉ:0x%04xèERROR\n", 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_mÚ™Ü_rssi_cfm
.
»suÉ_code
));

4481 
r
 = -
EINVAL
;

4484 
	`kä“_skb
(
cfm
);

4485  
r
;

4486 
	}
}

4488 
¦si_mib_v®ue
 *
	$¦si_»ad_mibs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

4489 
¦si_mib_g‘_’Œy
 *
mib_’Œ›s
, 
mib_couÁ
, 
¦si_mib_d©a
 *
mibr¥
)

4491 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

4492 
¦si_mib_v®ue
 *
v®ues
;

4493 
rx_Ëngth
, 
r
;

4495 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, 
mib_couÁ
, 
mib_’Œ›s
);

4496 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4497 
	`SLSI_WARN
(
sdev
, "¦si_mib_’code_g‘_li¡ fa %d\n", 
r
);

4498  
NULL
;

4501 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
->d©a, mibr¥->d©aL’gth, &
rx_Ëngth
);

4502 
	`kä“
(
mib»q
.
d©a
);

4504 ià(
r
 != 0) {

4505 
	`SLSI_ERR
(
sdev
, "Mib (”r:%d)\n", 
r
);

4506  
NULL
;

4509 
mibr¥
->
d©aL’gth
 = (
u32
)
rx_Ëngth
;

4510 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(
mibr¥
, 
mib_couÁ
, 
mib_’Œ›s
);

4511 ià(!
v®ues
)

4512 
	`SLSI_WARN
(
sdev
, "decodeƒrror\n");

4513  
v®ues
;

4514 
	}
}

4516 
	$¦si_mlme_£t_ùwšdow
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ù_·¿m
)

4518 
Ãtdev_vif
 *
ndev_vif
;

4519 
sk_buff
 *
»q
;

4520 
sk_buff
 *
cfm
;

4521 
r
 = 0;

4523 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_ùwšdow(ù_·¿m = %d)\n", 
ù_·¿m
);

4525 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4527 
»q
 = 
	`çpi_®loc
(
mlme_£t_ùwšdow_»q
, 
MLME_SET_CTWINDOW_REQ
, 
ndev_vif
->
iâum
, 0);

4528 ià(!
»q
)

4529  -
ENOMEM
;

4531 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_ùwšdow_»q
.
ùwšdow
, 
ù_·¿m
);

4533 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CTWINDOW_CFM
);

4534 ià(!
cfm
)

4535  -
EIO
;

4537 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ùwšdow_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4538 
	`SLSI_NET_ERR
(
dev
, "mlme_set_ctwindow_cfm(result:0x%04x) ERROR\n",

4539 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ùwšdow_cfm
.
»suÉ_code
));

4540 
r
 = -
EINVAL
;

4542 
	`kä“_skb
(
cfm
);

4543  
r
;

4544 
	}
}

4546 
	$¦si_mlme_£t_p2p_nß
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
nß_couÁ
,

4547 
š‹rv®
, 
du¿tiÚ
)

4549 
Ãtdev_vif
 *
ndev_vif
;

4550 
sk_buff
 *
»q
;

4551 
sk_buff
 *
cfm
;

4552 
r
 = 0;

4554 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_set_noa_req(noa_count = %d, interval = %d, duration = %d)\n",

4555 
nß_couÁ
, 
š‹rv®
, 
du¿tiÚ
);

4557 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4559 
»q
 = 
	`çpi_®loc
(
mlme_£t_nß_»q
, 
MLME_SET_NOA_REQ
, 
ndev_vif
->
iâum
, 0);

4560 ià(!
»q
)

4561  -
ENOMEM
;

4563 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_nß_»q
.
»que¡_id
, 
SLSI_NOA_CONFIG_REQUEST_ID
);

4564 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_nß_»q
.
nß_couÁ
,‚oa_count);

4565 ià(!
š‹rv®
)

4566 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£t_nß_»q
.
š‹rv®
, (1 * 1024 * 
ndev_vif
->
­
.
b—cÚ_š‹rv®
));

4568 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£t_nß_»q
.
š‹rv®
, interval * 1000);

4569 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£t_nß_»q
.
du¿tiÚ
, duration * 1000);

4571 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_NOA_CFM
);

4572 ià(!
cfm
)

4573  -
EIO
;

4575 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_nß_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4576 
	`SLSI_NET_ERR
(
dev
, "mlme_set_noa_cfm(result:0x%04x) ERROR\n",

4577 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_nß_cfm
.
»suÉ_code
));

4578 
r
 = -
EINVAL
;

4580 
	`kä“_skb
(
cfm
);

4581  
r
;

4582 
	}
}

4584 
	$¦si_mlme_£t_ho¡_¡©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ho¡_¡©e
)

4586 
sk_buff
 *
»q
;

4587 
sk_buff
 *
cfm
;

4588 
r
 = 0;

4590 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4591 
	`SLSI_NET_INFO
(
dev
, "Skip MLME_HOST_STATE_REQ in wlanlite mode\n");

4592  -
EOPNOTSUPP
;

4595 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_ho¡_¡©e(¡©ğ0x%04x)\n", 
ho¡_¡©e
);

4597 
»q
 = 
	`çpi_®loc
(
mlme_ho¡_¡©e_»q
, 
MLME_HOST_STATE_REQ
, 0, 0);

4598 ià(!
»q
) {

4599 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

4600  -
ENOMEM
;

4603 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ho¡_¡©e_»q
.
ho¡_¡©e
, host_state);

4605 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_HOST_STATE_CFM
);

4606 ià(!
cfm
)

4607  -
EIO
;

4609 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ho¡_¡©e_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4610 
	`SLSI_NET_ERR
(
dev
, "mlme_host_state_cfm(result:0x%04x) ERROR\n",

4611 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ho¡_¡©e_cfm
.
»suÉ_code
));

4612 
r
 = -
EINVAL
;

4615 
	`kä“_skb
(
cfm
);

4616  
r
;

4617 
	}
}

4619 
	$¦si_mlme_»ad_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 **
ho¡_d¡
, *
d©®’
)

4621 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4622 
sk_buff
 *
»q
;

4623 
sk_buff
 *
rx
;

4624 
r
 = 0;

4626 
	`WLBT_WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4628 ià(!
ndev_vif
->
aùiv©ed
) {

4629 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ot‡ctivated\n");

4630 
r
 = -
EINVAL
;

4631 
ex™
;

4634 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

4635 
	`SLSI_ERR
(
sdev
, "vif_type is‚ot FAPI_VIFTYPE_STATION\n");

4636 
r
 = -
EINVAL
;

4637 
ex™
;

4640 
»q
 = 
	`çpi_®loc
(
mlme_»ad_­f_»q
, 
MLME_READ_APF_REQ
, 
ndev_vif
->
iâum
, 0);

4641 ià(!
»q
) {

4642 
r
 = -
ENOMEM
;

4643 
ex™
;

4646 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_»ad_­f_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

4647 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_READ_APF_CFM
);

4648 ià(!
rx
) {

4649 
r
 = -
EIO
;

4650 
ex™
;

4653 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_»ad_­f_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4654 
	`SLSI_NET_ERR
(
dev
, "mlme_read_apf_cfm(result:0x%04x) ERROR\n",

4655 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_»ad_­f_cfm
.
»suÉ_code
));

4656 
r
 = -
EINVAL
;

4659 *
d©®’
 = 
	`çpi_g‘_d©®’
(
rx
);

4660 *
ho¡_d¡
 = 
	`çpi_g‘_d©a
(
rx
);

4662 
ex™
:

4663  
r
;

4664 
	}
}

4666 
	$¦si_mlme_š¡®l_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

4667 
u8
 *
´og¿m
, 
u32
 
´og¿m_Ën
)

4669 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4670 
sk_buff
 *
»q
;

4671 
sk_buff
 *
rx
;

4672 
r
 = 0;

4674 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4676 ià(!
ndev_vif
->
aùiv©ed
) {

4677 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ot‡ctivated\n");

4678 
r
 = -
EINVAL
;

4679 
ex™
;

4682 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

4683 
	`SLSI_ERR
(
sdev
, "vif_type is‚ot FAPI_VIFTYPE_STATION\n");

4684 
r
 = -
EINVAL
;

4685 
ex™
;

4688 
»q
 = 
	`çpi_®loc
(
mlme_š¡®l_­f_»q
, 
MLME_INSTALL_APF_REQ
, 
ndev_vif
->
iâum
, 
´og¿m_Ën
);

4689 ià(!
»q
) {

4690 
r
 = -
ENOMEM
;

4691 
ex™
;

4695 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_š¡®l_­f_»q
.
f‹r_mode
, 
FAPI_APFFILTERMODE_SUSPEND
);

4696 
	`çpi_­³nd_d©a
(
»q
, 
´og¿m
, 
´og¿m_Ën
);

4698 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_install_apf_req(vif:%u, filter_mode:%d)\n",

4699 
ndev_vif
->
iâum
, 
FAPI_APFFILTERMODE_SUSPEND
);

4700 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_INSTALL_APF_CFM
);

4701 ià(!
rx
) {

4702 
r
 = -
EIO
;

4703 
ex™
;

4706 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_š¡®l_­f_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4707 
	`SLSI_NET_ERR
(
dev
, "mlme_install_apf_cfm(result:0x%04x) ERROR\n",

4708 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_š¡®l_­f_cfm
.
»suÉ_code
));

4709 
r
 = -
EINVAL
;

4712 
ex™
:

4713 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4714  
r
;

4715 
	}
}

4717 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


4718 
	$¦si_mlme_¬p_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
aùiÚ
, 
u8
 *
rg‘_addr
)

4720 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4721 
sk_buff
 *
»q
;

4722 
sk_buff
 *
rx
;

4723 
r
 = 0;

4724 
u32
 
add»ss
 = 0x0;

4725 
i
 = 0;

4727 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
)) {

4728 
	`SLSI_ERR
(
sdev
, "ndev_vif mutex is‚ot†ocked\n");

4729 
r
 = -
EINVAL
;

4730 
ex™
;

4733 ià(!
ndev_vif
->
aùiv©ed
) {

4734 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ot‡ctivated\n");

4735 
r
 = -
EINVAL
;

4736 
ex™
;

4739 ià((
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
è&& (ndev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)) {

4740 
	`SLSI_ERR
(
sdev
, "vif_type is‚ot FAPI_VIFTYPE_STATION\n");

4741 
r
 = -
EINVAL
;

4742 
ex™
;

4745 
»q
 = 
	`çpi_®loc
(
mlme_¬p_d‘eù_»q
, 
MLME_ARP_DETECT_REQ
, 
ndev_vif
->
iâum
, 0);

4746 ià(!
»q
) {

4747 
r
 = -
ENOMEM
;

4748 
ex™
;

4751 
i
 = 0; i < 4; i++)

4752 
add»ss
 = (add»s << 8è| (()
rg‘_addr
[
i
]);

4753 
add»ss
 = 
	`htÚl
(ipaddress);

4755 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¬p_d‘eù_»q
.
¬p_d‘eù_aùiÚ
, 
aùiÚ
);

4756 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
add»ss
, 4);

4758 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_arp_detect_req(vif:%u,‡ction:%d IP Address:%d.%d.%d.%d)\n",

4759 
ndev_vif
->
iâum
, 
aùiÚ
,‚dev_vif->
rg‘__addr
[0],‚dev_vif->target_ip_addr[1],

4760 
ndev_vif
->
rg‘__addr
[2],‚dev_vif->target_ip_addr[3]);

4761 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ARP_DETECT_CFM
);

4762 ià(!
rx
) {

4763 
r
 = -
EIO
;

4764 
ex™
;

4767 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_¬p_d‘eù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4768 
	`SLSI_NET_ERR
(
dev
, "mlme_arp_detect_cfm(result:0x%04x) ERROR\n",

4769 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_¬p_d‘eù_cfm
.
»suÉ_code
));

4770 
r
 = -
EINVAL
;

4773 
ex™
:

4774  
r
;

4775 
	}
}

4778 
	$¦si_mlme_¡¬t_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4780 
sk_buff
 *
»q
;

4781 
sk_buff
 *
cfm
;

4782 
r
 = 0;

4784 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_¡¬t_d‘eù_»q(vif:%u)\n", 
SLSI_NET_INDEX_DETECT
);

4785 
»q
 = 
	`çpi_®loc
(
mlme_¡¬t_d‘eù_»q
, 
MLME_START_DETECT_REQ
, 
SLSI_NET_INDEX_DETECT
, 0);

4786 ià(!
»q
) {

4787 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

4788  -
ENOMEM
;

4791 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_START_DETECT_CFM
);

4792 ià(!
cfm
)

4793  -
EIO
;

4795 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_d‘eù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4796 
	`SLSI_NET_ERR
(
dev
, "mlme_start_detect_cfm(result:0x%04x) ERROR\n",

4797 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_d‘eù_cfm
.
»suÉ_code
));

4798 
r
 = -
EINVAL
;

4801 
	`kä“_skb
(
cfm
);

4802  
r
;

4803 
	}
}

4805 
	#SLSI_TEST_CONFIG_MONITOR_MODE_DESCRIPTOR_SIZE
 (12)

	)

4806 
	$¦si_‹¡_§p_cÚfigu»_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_chª_def
 *
chªdef
)

4808 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4809 
sk_buff
 *
»q
;

4810 
sk_buff
 *
cfm
;

4811 
u8
 *
p
 = 
NULL
;

4812 
size_t
 
®loc_d©a_size
 = 0;

4813 
u16
 
ûÁ”_äeq1
;

4814 
u16
 
ûÁ”_äeq2
;

4815 
u16
 
chª_šfo
;

4816 
r
 = 0;

4818 cÚ¡ 
u8
 
mÚ™Ü_cÚfig_›_h—d”
[] = {

4826 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4827 
	`SLSI_NET_WARN
(
dev
, "WlanLite: NOT supported\n");

4828  -
EOPNOTSUPP
;

4831 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4833 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, 
chªdef
);

4834 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "test_configure_monitor_mode_req(center_freq1:%u, chan_info:%u, center_freq2:%u)\n",

4835 
chªdef
->
ûÁ”_äeq1
,

4836 
chª_šfo
,

4837 
chªdef
->
ûÁ”_äeq2
);

4839 
ûÁ”_äeq1
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chªdef
->center_freq1);

4840 
ûÁ”_äeq1
 = 
	`ıu_to_Ë16
(center_freq1);

4841 
ûÁ”_äeq2
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chªdef
->center_freq2);

4842 
ûÁ”_äeq2
 = 
	`ıu_to_Ë16
(center_freq2);

4844 
®loc_d©a_size
 = (
mÚ™Ü_cÚfig_›_h—d”
è+ 
SLSI_TEST_CONFIG_MONITOR_MODE_DESCRIPTOR_SIZE
;

4846 
»q
 = 
	`çpi_®loc
(
‹¡_cÚfigu»_mÚ™Ü_mode_»q
, 
TEST_CONFIGURE_MONITOR_MODE_REQ
, 
ndev_vif
->
iâum
, 
®loc_d©a_size
);

4847 ià(!
»q
) {

4848 
	`SLSI_NET_ERR
(
dev
, "çedØ®loøMÚ™Ü mod»que¡ (Ën:%d)\n", 
®loc_d©a_size
);

4849  -
ENOMEM
;

4852 
	`çpi_­³nd_d©a
(
»q
, 
mÚ™Ü_cÚfig_›_h—d”
, (monitor_config_ie_header));

4853 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
ûÁ”_äeq1
, 2);

4854 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
chª_šfo
, 2);

4855 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
ûÁ”_äeq2
, 2);

4858 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 6);

4859 ià(!
p
) {

4860 
	`SLSI_NET_ERR
(
dev
, "mac‡ddress filtering‡ppend failed\n");

4861 
	`kä“_skb
(
»q
);

4862  -
EINVAL
;

4864 
	`mem£t
(
p
, 0, 6);

4866 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
TEST_CONFIGURE_MONITOR_MODE_CFM
);

4867 ià(!
cfm
) {

4868 
	`SLSI_NET_ERR
(
dev
, "failedo„eceive Confirm\n");

4869  -
EIO
;

4872 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_chªÃl_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4873 
	`SLSI_NET_ERR
(
dev
, "test_configure_monitor_mode_cfm(result:0x%04x) ERROR\n",

4874 
	`çpi_g‘_u16
(
cfm
, 
u
.
‹¡_cÚfigu»_mÚ™Ü_mode_cfm
.
»suÉ_code
));

4875 
r
 = -
EINVAL
;

4878 
	`kä“_skb
(
cfm
);

4879  
r
;

4880 
	}
}

4882 
	$¦si_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_q¡a_add»ss
, 
u16
 
´iÜ™y
, u16 
dœeùiÚ
, u16 
£qu’û_numb”
, u16 
»asÚ_code
)

4884 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4885 
sk_buff
 *
»q
;

4886 
sk_buff
 *
cfm
;

4887 
r
 = 0;

4889 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4890 
	`SLSI_NET_WARN
(
dev
, "WlanLite: NOT supported\n");

4891  -
EOPNOTSUPP
;

4894 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4896 
»q
 = 
	`çpi_®loc
(
mlme_d–ba_»q
, 
MLME_DELBA_REQ
, 
ndev_vif
->
iâum
, 0);

4897 ià(!
»q
) {

4898 
	`SLSI_NET_ERR
(
dev
, "failedo‡lloc DELBA„equest\n");

4899  -
ENOMEM
;

4902 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_delba_req(vif:%d,…eer:%pM,…riority:%d, direction:%d, sn:%d,„eason_code:%d)\n",

4903 
ndev_vif
->
iâum
, 
³”_q¡a_add»ss
, 
´iÜ™y
, 
dœeùiÚ
, 
£qu’û_numb”
, 
»asÚ_code
);

4905 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_d–ba_»q
.
³”_q¡a_add»ss
,…eer_qsta_address);

4906 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
u£r_´iÜ™y
, 
´iÜ™y
);

4907 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
dœeùiÚ
, direction);

4908 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
£qu’û_numb”
, sequence_number);

4909 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
»asÚ
, 
»asÚ_code
);

4911 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DELBA_CFM
);

4912 ià(!
cfm
) {

4913 
	`SLSI_NET_ERR
(
dev
, "failedo„eceive Confirm\n");

4914  -
EIO
;

4917 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–ba_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4918 
	`SLSI_NET_ERR
(
dev
, "mlme_delba_cfm(result:0x%04x) ERROR\n",

4919 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–ba_cfm
.
»suÉ_code
));

4920 
r
 = -
EINVAL
;

4923 
	`kä“_skb
(
cfm
);

4924  
r
;

4925 
	}
}

4928 
	$¦si_mlme_£t_couÁry
(
¦si_dev
 *
sdev
, *
®pha2
)

4930 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4931 
sk_buff
 *
»q
;

4932 
sk_buff
 *
cfm
;

4933 
couÁry_šdex
 = -1;

4934 
u32
 
ruËs_Ën
 = 0;

4935 
u16
 
couÁry_code
 = 0;

4936 
u8
 
­³nd_by‹
 = 0;

4937 
u8
 
İ”©šg_şass_£t
 = 0;

4938 
i
 = 0;

4939 
”rÜ
 = 0;

4940 
äeq_¿nge
 = 0;

4942 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4943 
	`SLSI_WARN
(
sdev
, "WlanLite: NOT supported\n");

4944  -
EOPNOTSUPP
;

4947 ià(
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_SET
) {

4948 
i
 = 0; i < 
sdev
->
»gdb
.
num_couÁr›s
; i++) {

4949 ià((
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
[0] ==‡lpha2[0]) &&

4950 (
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
[1] ==‡lpha2[1])) {

4951 
couÁry_šdex
 = 
i
;

4956 ià(
couÁry_šdex
 == -1) {

4957 
	`SLSI_ERR
(
sdev
, "Invalid country code!\n");

4958  -
EINVAL
;

4962 
ruËs_Ën
 = 7 * 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
;

4963 
İ”©šg_şass_£t
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].operating_class_set;

4967 
»q
 = 
	`çpi_®loc
(
mlme_£t_couÁry_»q
, 
MLME_SET_COUNTRY_REQ
, 0, 
ruËs_Ën
);

4968 ià(!
»q
)

4969  -
ENOMEM
;

4971 
couÁry_code
 = (((
u16
)
®pha2
[0] << 8) | (u16)alpha2[1]);

4972 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_couÁry_»q
.
couÁry_code
, country_code);

4973 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_couÁry_»q
.
İ”©šg_şass_£t
, operating_class_set);

4974 ià(
ruËs_Ën
) {

4975 
i
 = 0; i < 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
; i++) {

4976 ià(
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 >= 57000)

4978 
­³nd_by‹
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 * 2) & 0xFF;

4979 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

4980 
­³nd_by‹
 = ((
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 * 2) >> 8) & 0xFF;

4981 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

4982 
­³nd_by‹
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
’d_äeq
 * 2) & 0xFF;

4983 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

4984 
­³nd_by‹
 = ((
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
’d_äeq
 * 2) >> 8) & 0xFF;

4985 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

4986 
äeq_¿nge
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->äeq_¿nge->
’d_äeq
 -

4987 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
;

4988 ià(((
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 / 1000) == 5) &&

4989 
sdev
->
fÜûd_bªdwidth
 &&

4990 (
äeq_¿nge
 >ğ
sdev
->
fÜûd_bªdwidth
))

4991 
­³nd_by‹
 = 
sdev
->
fÜûd_bªdwidth
;

4993 
­³nd_by‹
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
max_bªdwidth
 & 0xFF;

4994 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

4995 
­³nd_by‹
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
max_eœp
 & 0xFF;

4996 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

4997 
­³nd_by‹
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
æags
 & 0xFF;

4998 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5002 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "mlme_£t_couÁry_»q(couÁry:%c%c, o³¿tšg_şass_£t:%x)\n", 
®pha2
[0],‡Íha2[1], 
İ”©šg_şass_£t
);

5003 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_SET_COUNTRY_CFM
);

5004 ià(!
cfm
)

5005  -
EIO
;

5007 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_couÁry_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5008 
	`SLSI_ERR
(
sdev
, "mlme_set_country_cfm(result:0x%04x) ERROR\n",

5009 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_couÁry_cfm
.
»suÉ_code
));

5010 
	`kä“_skb
(
cfm
);

5011 
”rÜ
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY
, 3, 
®pha2
, 0);

5012 ià(
”rÜ
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

5013  -
ENOMEM
;

5015 ià(
	`WARN_ON
(
mib_d©a
.
d©aL’gth
 == 0))

5016  -
EINVAL
;

5018 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5019 ià(
”rÜ
)

5020  -
EINVAL
;

5022 
	`kä“
(
mib_d©a
.
d©a
);

5026 
	`kä“_skb
(
cfm
);

5028 
	}
}

5030 
	$¦si_mlme_cÚfigu»_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_chª_def
 *
chªdef
)

5032 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5033 
sk_buff
 *
»q
;

5034 
sk_buff
 *
cfm
;

5035 
u16
 
ûÁ”_äeq1
;

5036 
u16
 
ûÁ”_äeq2
;

5037 
u16
 
chª_šfo
;

5038 
r
 = 0;

5040 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

5041 
	`SLSI_NET_WARN
(
dev
, "WlanLite: NOT supported\n");

5042  -
EOPNOTSUPP
;

5045 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5047 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, 
chªdef
);

5048 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "MonitorMode(Cf1:%u, Cinf:%u, Cf2:%u)\n",

5049 
chªdef
->
ûÁ”_äeq1
,

5050 
chª_šfo
,

5051 
chªdef
->
ûÁ”_äeq2
);

5053 
ûÁ”_äeq1
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chªdef
->center_freq1);

5054 
ûÁ”_äeq1
 = 
	`ıu_to_Ë16
(center_freq1);

5055 
ûÁ”_äeq2
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chªdef
->center_freq2);

5056 
ûÁ”_äeq2
 = 
	`ıu_to_Ë16
(center_freq2);

5058 
»q
 = 
	`çpi_®loc
(
mlme_cÚfigu»_mÚ™Ü_mode_»q
, 
MLME_CONFIGURE_MONITOR_MODE_REQ
, 
ndev_vif
->
iâum
, 0);

5059 ià(!
»q
) {

5060 
	`SLSI_NET_ERR
(
dev
, "failedo‡lloc Monitor mode„equest\n");

5061  -
ENOMEM
;

5064 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚfigu»_mÚ™Ü_mode_»q
.
chªÃl_äequ’cy_£gm’t0
, 
ûÁ”_äeq1
);

5065 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚfigu»_mÚ™Ü_mode_»q
.
chªÃl_äequ’cy_£gm’t1
, 
ûÁ”_äeq2
);

5066 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚfigu»_mÚ™Ü_mode_»q
.
chªÃl_šfÜm©iÚ
, 
chª_šfo
);

5068 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_CONFIGURE_MONITOR_MODE_CFM
);

5069 ià(!
cfm
) {

5070 
	`SLSI_NET_ERR
(
dev
, "failedo„eceive Confirm\n");

5071  -
EIO
;

5074 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_chªÃl_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5075 
	`SLSI_NET_ERR
(
dev
, "MonitorModeCfm(result:0x%04x) ERROR\n",

5076 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_cÚfigu»_mÚ™Ü_mode_cfm
.
»suÉ_code
));

5077 
r
 = -
EINVAL
;

5080 
	`kä“_skb
(
cfm
);

5081  
r
;

5082 
	}
}

5084 
	$¦si_mlme_£t_couÁry_fÜ_»cov”y
(
¦si_dev
 *
sdev
)

5086 
»t
 = 0;

5087 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

5089 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5090 
»t
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY
, 3, 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
, 0);

5091 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

5092 
»t
 = -
ENOMEM
;

5093 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
»t
);

5094 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5098 ià(
mib_d©a
.
d©aL’gth
 == 0) {

5099 
»t
 = -
EINVAL
;

5100 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
»t
);

5101 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5105 
»t
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5106 
	`kä“
(
mib_d©a
.
d©a
);

5108 ià(
»t
)

5109 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
»t
);

5110 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5111 
	}
}

5113 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


5115 
	$¦si_mlme_£t_num_ª‹Âas
(
Ãt_deviû
 *
dev
, cÚ¡ 
u16
 
num_of_ª‹Âas
, 
äame_ty³
)

5117 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5118 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5119 
sk_buff
 *
»q
;

5120 
sk_buff
 *
cfm
;

5121 
»t
 = 0;

5122 cÚ¡ 
boŞ
 
is_¡a
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
);

5123 cÚ¡ 
boŞ
 
is_soá­
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
);

5125 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5127 ià(
num_of_ª‹Âas
 > 2 ||‚um_of_antennas == 0) {

5128 
	`SLSI_NET_ERR
(
dev
, "Inv®id‚um_of_ª‹Âa %hu\n", 
num_of_ª‹Âas
);

5129  -
EINVAL
;

5131 ià(
äame_ty³
 < 0 || frame_type > 2) {

5132 
	`SLSI_ERR
(
sdev
, "Inv®id f¿me_ty³: '%d'\n", 
äame_ty³
);

5133  -
EINVAL
;

5135 ià(!
is_¡a
 && !
is_soá­
) {

5136 
	`SLSI_NET_ERR
(
dev
, "Inv®id iÁ”çûy³ %s\n", dev->
Çme
);

5137  -
EPERM
;

5139 ià(
is_¡a
 && (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

5140 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5141  -
EPERM
;

5143 
	`SLSI_NET_INFO
(
dev
, "SetNumAntennas(vif:%u NumAntenna:%u ftype:%d)\n",

5144 
ndev_vif
->
iâum
, 
num_of_ª‹Âas
, 
äame_ty³
);

5146 
»q
 = 
	`çpi_®loc
(
mlme_£t_num_ª‹Âas_»q
, 
MLME_SET_NUM_ANTENNAS_REQ
, 
ndev_vif
->
iâum
, 0);

5147 ià(!
»q
) {

5148 
	`SLSI_NET_ERR
(
dev
, "failedo‡lloc set‚um‡ntennas„equest\n");

5149  -
ENOMEM
;

5151 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_num_ª‹Âas_»q
.
vif
, 
ndev_vif
->
iâum
);

5152 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_num_ª‹Âas_»q
.
numb”_of_ª‹Âas
, 
num_of_ª‹Âas
);

5153 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_num_ª‹Âas_»q
.
äame_ty³
, frame_type);

5154 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_NUM_ANTENNAS_CFM
);

5155 ià(!
cfm
)

5156  -
EIO
;

5158 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_num_ª‹Âas_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5159 
	`SLSI_NET_ERR
(
dev
, "SetNumAntennasCfm(result:0x%04x) ERROR\n",

5160 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_num_ª‹Âas_cfm
.
»suÉ_code
));

5161 
»t
 = -
EINVAL
;

5163 
	`kä“_skb
(
cfm
);

5164  
»t
;

5165 
	}
}

5168 
	$¦si_mlme_£t_muÉiÿ¡_
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
muÉiÿ¡__li¡
[], 
couÁ
)

5170 
sk_buff
 *
»q
;

5171 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5172 
sk_buff
 *
cfm
;

5173 
r
 = 0;

5174 
u32
 
addr
;

5175 
u8
 
muÉiÿ¡_add
[
ETH_ALEN
] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };

5176 
u8
 
Ëngth
 = 
couÁ
 * 4 + 5;

5177 
size_t
 
®loc_d©a_size
 = 0;

5178 
u8
 
çpi_›_g’”ic
[] = { 0xdd, 
Ëngth
, 0x00, 0x16, 0x32, 0x03, 0x01 };

5179 
i
 = 0;

5180 
u16
 
v”siÚ_šfo
 = 0x0100;

5182 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

5183 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_IP_ADDRESS.request\n");

5184  -
EOPNOTSUPP
;

5187 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5189 
®loc_d©a_size
 = 
Ëngth
 + 2;

5190 
»q
 = 
	`çpi_®loc
(
mlme_£t__add»ss_»q
, 
MLME_SET_IP_ADDRESS_REQ
, 
ndev_vif
->
iâum
, 
®loc_d©a_size
);

5191 ià(!
»q
)

5192  -
ENOMEM
;

5194 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
add»ss_ty³
, 
v”siÚ_šfo
);

5195 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
muÉiÿ¡_add»ss
, 
muÉiÿ¡_add
);

5197 
	`çpi_­³nd_d©a
(
»q
, 
çpi_›_g’”ic
, (fapi_ie_generic));

5198 
i
 = 0; i < 
couÁ
; i++) {

5199 
addr
 = 
	`htÚl
(
	`be32_to_ıu
(
muÉiÿ¡__li¡
[
i
]));

5200 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)(&
addr
), (ipaddr));

5203 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "¦si_mlme_£t__add»ss(vif: %d)\n", 
ndev_vif
->
iâum
);

5204 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_IP_ADDRESS_CFM
);

5205 ià(!
cfm
)

5206  -
EIO
;

5208 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5209 
	`SLSI_NET_ERR
(
dev
, "mlme_£t__add»ss_cfmÔesuÉ:0x%04xèERROR\n", 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
));

5210 
r
 = -
EINVAL
;

5212 
	`kä“_skb
(
cfm
);

5213  
r
;

5214 
	}
}

	@mlme.h

7 #iâdeà
__SLSI_MLME_H__


8 
	#__SLSI_MLME_H__


	)

10 
	~"dev.h
"

11 
	~"mib.h
"

13 
	e¦si_ac_šdex_wmm_³
 {

14 
	mAC_BE
,

15 
	mAC_BK
,

16 
	mAC_VI
,

17 
	mAC_VO


20 
	#SLSI_FREQ_FW_TO_HOST
(
f
è((fè/ 2)

	)

21 
	#SLSI_FREQ_HOST_TO_FW
(
f
è((fè* 2)

	)

23 
	#SLSI_SINFO_MIB_ACCESS_TIMEOUT
 (1000è

	)

25 
	#SLSI_WLAN_EID_VENDOR_SPECIFIC
 0xdd

	)

26 
	#SLSI_WLAN_EID_INTERWORKING
 107

	)

27 
	#SLSI_WLAN_EID_EXTENSION
 255

	)

30 
	#SLSI_WLAN_EID_EXT_OWE_DH_PARAM
 32

	)

32 
	#SLSI_WLAN_OUI_TYPE_WFA_HS20_IND
 0x10

	)

33 
	#SLSI_WLAN_OUI_TYPE_WFA_OSEN
 0x12

	)

34 
	#SLSI_WLAN_OUI_TYPE_WFA_MBO
 0x16

	)

36 
	#SLSI_WLAN_FAIL_WORK_TIMEOUT
 1500

	)

39 
	#SLSI_WLAN_EXT_CAPA2_BSS_TRANSISITION_ENABLED
 (
	`BIT
(3))

	)

40 
	#SLSI_WLAN_EXT_CAPA3_INTERWORKING_ENABLED
 (
	`BIT
(7))

	)

41 
	#SLSI_WLAN_EXT_CAPA4_QOS_MAP_ENABLED
 (
	`BIT
(0))

	)

42 
	#SLSI_WLAN_EXT_CAPA5_WNM_NOTIF_ENABLED
 (
	`BIT
(6))

	)

43 
	#SLSI_WLAN_EXT_CAPA2_QBSS_LOAD_ENABLED
 
	`BIT
(7)

	)

44 
	#SLSI_WLAN_EXT_CAPA1_PROXY_ARP_ENABLED
 
	`BIT
(4)

	)

45 
	#SLSI_WLAN_EXT_CAPA2_TFS_ENABLED
 
	`BIT
(0)

	)

46 
	#SLSI_WLAN_EXT_CAPA2_WNM_SLEEP_ENABLED
 
	`BIT
(1)

	)

47 
	#SLSI_WLAN_EXT_CAPA2_TIM_ENABLED
 
	`BIT
(2)

	)

48 
	#SLSI_WLAN_EXT_CAPA2_DMS_ENABLED
 
	`BIT
(4)

	)

51 
	#SLSI_WLAN_RM_CAPA0_LINK_MEASUREMENT_ENABLED
 
	`BIT
(0)

	)

52 
	#SLSI_WLAN_RM_CAPA0_NEIGHBOR_REPORT_ENABLED
 
	`BIT
(1)

	)

53 
	#SLSI_WLAN_RM_CAPA0_PASSIVE_MODE_ENABLED
 
	`BIT
(4)

	)

54 
	#SLSI_WLAN_RM_CAPA0_ACTIVE_MODE_ENABLED
 
	`BIT
(5)

	)

55 
	#SLSI_WLAN_RM_CAPA0_TABLE_MODE_ENABLED
 
	`BIT
(6)

	)

58 
	#SLSI_AP_EXT_CAPAB_IE_LEN_MAX
 12

	)

60 #ià(
KERNEL_VERSION
(5, 7, 0è<ğ
LINUX_VERSION_CODE
è|| 
defšed
(
CONFIG_SCSC_WLAN_BSS_COLOR
)

61 
	#SLSI_WLAN_HE_BSS_COLOR_IE_LEN
 8

	)

62 
	#SLSI_WLAN_HE_BSS_COLOR_PARTIAL_OFFSET
 6

	)

63 
	#SLSI_WLAN_HE_BSS_COLOR_ENABLE_DISABLE_INDEX
 7

	)

64 
	#SLSI_WLAN_HE_BSS_COLOR_DISABLED
 
	`BIT
(7)

	)

67 
	#SLSI_SCAN_DONE_IND_WAIT_TIMEOUT
 40000

	)

68 
	#SLSI_NAN_START_TIMEOUT
 9000

	)

72 #iâdeà
WLAN_EID_COUNTRY


73 
	#WLAN_EID_COUNTRY
 7

	)

77 
	#SLSI_P2P_WILDCARD_SSID
 "DIRECT-"

	)

78 
	#SLSI_P2P_WILDCARD_SSID_LENGTH
 7

	)

79 
	#SLSI_P2P_SOCIAL_CHAN_COUNT
 3

	)

80 
	#SLSI_P2P_SOCIAL_CHAN_1
 1

	)

81 
	#SLSI_P2P_SOCIAL_CHAN_6
 6

	)

82 
	#SLSI_P2P_SOCIAL_CHAN_11
 11

	)

84 
	#SLSI_P2P_IS_SOCAIL_CHAN
(
ch
) ({ \

85 
	`ty³of
(
ch
è
ch_
 = (ch); \

86 ((
ch_
 =ğ
SLSI_P2P_SOCIAL_CHAN_1
) || \

87 (
ch_
 =ğ
SLSI_P2P_SOCIAL_CHAN_6
) || \

88 (
ch_
 =ğ
SLSI_P2P_SOCIAL_CHAN_11
)); \

89 })

	)

94 
	#SLSI_IS_P2P_SSID
(
ssid
, 
ssid_Ën
è((ssid_ËÀ>ğ
SLSI_P2P_WILDCARD_SSID_LENGTH
) && \

95 (
	`memcmp
(
ssid
, 
SLSI_P2P_WILDCARD_SSID
, 
SLSI_P2P_WILDCARD_SSID_LENGTH
è=ğ0))

	)

98 
	#SLSI_ACTION_FRAME_PUBLIC
 (
	`BIT
(4))

	)

99 
	#SLSI_ACTION_FRAME_VENDOR_SPEC_PROTECTED
 (
	`BIT
(30))

	)

100 
	#SLSI_ACTION_FRAME_VENDOR_SPEC
 (
	`BIT
(31))

	)

101 
	#SLSI_ACTION_FRAME_WMM
 (
	`BIT
(17))

	)

102 
	#SLSI_ACTION_FRAME_WNM
 (
	`BIT
(10))

	)

103 
	#SLSI_ACTION_FRAME_QOS
 (
	`BIT
(1))

	)

104 
	#SLSI_ACTION_FRAME_PROTECTED_DUAL
 
	`BIT
(9)

	)

105 
	#SLSI_ACTION_FRAME_RADIO_MEASUREMENT
 
	`BIT
(5)

	)

108 
	#SLSI_TX_RATE_NON_HT_1MBPS
 0x4001

	)

109 
	#SLSI_TX_RATE_NON_HT_6MBPS
 0x4004

	)

110 
	#SLSI_ROAMING_CHANNELS_MAX
 38

	)

112 
	#SLSI_WLAN_EID_WAPI
 68

	)

113 
	#SLSI_WLAN_EID_RSNX
 244

	)

115 
	#SLSI_SCAN_PRIVATE_IE_CHANNEL_LIST_HEADER_LEN
 7

	)

116 
	#SLSI_SCAN_PRIVATE_IE_SSID_FILTER_HEADER_LEN
 7

	)

117 
	#SLSI_CHANN_INFO_HT_SCB
 0x0100

	)

118 
	#SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
 4

	)

125 
	#SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
 (0x0000)

	)

126 
›“80211_suµÜ‹d_bªd
 
¦si_bªd_2ghz
;

127 
›“80211_suµÜ‹d_bªd
 
¦si_bªd_5ghz
;

128 
›“80211_¡a_vht_ÿp
 
¦si_vht_ÿp
;

131 
	#SLSI_MAX_PATTERN_DESC
 4

	)

132 
	#SLSI_PKT_DESC_FIXED_LEN
 2

	)

133 
	#SLSI_PKT_FILTER_ELEM_FIXED_LEN
 6

	)

134 
	#SLSI_PKT_FILTER_ELEM_HDR_LEN
 (2 + 
SLSI_PKT_FILTER_ELEM_FIXED_LEN
è

	)

135 
	#SLSI_MAX_PATTERN_LENGTH
 6

	)

138 
	#SLSI_DEFAULT_UNIFI_PEER_RX_RETRY_PACKETS
 0

	)

139 
	#SLSI_DEFAULT_UNIFI_PEER_RX_BC_MC_PACKETS
 0

	)

140 
	#SLSI_DEFAULT_UNIFI_PEER_BANDWIDTH
 -1

	)

141 
	#SLSI_DEFAULT_UNIFI_PEER_NSS
 0

	)

142 
	#SLSI_DEFAULT_UNIFI_PEER_RSSI
 1

	)

143 
	#SLSI_DEFAULT_UNIFI_PEER_TX_DATA_RATE
 0

	)

145 
	#SLSI_CHECK_TYPE
(
sdev
, 
»cv_ty³
, 
exp_ty³
) \

147 
v¬1
 = 
»cv_ty³
; \

148 
v¬2
 = 
exp_ty³
; \

149 ià(
v¬1
 !ğ
v¬2
) { \

150 
	`SLSI_WARN
(
sdev
, "Ty³ mism©ch,ƒx³ùed:%d„eûived:%d\n", 
v¬2
, 
v¬1
); \

152 } 0)

	)

154 
	s¦si_mlme_·‰”n_desc
 {

155 
u8
 
	moff£t
;

156 
u8
 
	mmask_Ëngth
;

157 
u8
 
	mmask
[
SLSI_MAX_PATTERN_LENGTH
];

158 
u8
 
	m·‰”n
[
SLSI_MAX_PATTERN_LENGTH
];

161 
	s¦si_mlme_pkt_f‹r_–em
 {

162 
u8
 
	mh—d”
[
SLSI_PKT_FILTER_ELEM_HDR_LEN
];

163 
u8
 
	mnum_·‰”n_desc
;

164 
¦si_mlme_·‰”n_desc
 
	m·‰”n_desc
[
SLSI_MAX_PATTERN_DESC
];

167 
	#SLSI_MLME_OUI_LENGTH
 3

	)

168 
	#SLSI_MLME_SAMSUNG_OUI
 0x001632

	)

169 
	#SLSI_MLME_TYPE_SCAN_PARAM
 0x01

	)

170 
	#SLSI_MLME_PARAM_HEADER_SIZE
 5

	)

172 
	#SLSI_MLME_SUBTYPE_SCAN_TIMING
 0x1

	)

173 
	#SLSI_MLME_SUBTYPE_CHANNEL_LIST
 0x2

	)

174 
	#SLSI_MLME_SUBTYPE_SSID_FILTER
 0x4

	)

176 
	#SLSI_KEY_MGMT_PSK
 0x000çc02

	)

177 
	#SLSI_KEY_MGMT_PSK_SHA
 0x000çc06

	)

178 
	#SLSI_KEY_MGMT_FILS_SHA256
 0x000çc0e

	)

179 
	#SLSI_KEY_MGMT_FILS_SHA384
 0x000çc0f

	)

180 
	#SLSI_KEY_MGMT_FT_FILS_SHA256
 0x000çc10

	)

181 
	#SLSI_KEY_MGMT_FT_FILS_SHA384
 0x000çc11

	)

182 
	#SLSI_KEY_MGMT_OWE
 0x000çc12

	)

183 
	#SLSI_KEY_MGMT_OWE_REV
 0x12ac0f00

	)

184 
	#SLSI_KEY_MGMT_802_1X_SUITE_B_192
 0x000çc0c

	)

185 
	#SLSI_KEY_MGMT_802_1X_SUITE_B_192_REV
 0x0ÿc0f00

	)

186 
	#SLSI_KEY_MGMT_FT_802_1X_SHA384
 0x000çc0d

	)

188 
	s¦si_mlme_·¿m‘”s
 {

189 
u8
 
	m–em’t_id
;

190 
u8
 
	mËngth
;

191 
u8
 
	moui
[
SLSI_MLME_OUI_LENGTH
];

192 
u8
 
	moui_ty³
;

193 
u8
 
	moui_subty³
;

194 } 
	g__·cked
;

196 
	s¦si_mlme_sÿn_timšg_–em’t
 {

197 
¦si_mlme_·¿m‘”s
 
	mh—d”
;

198 
u32
 
	mmš_³riod
;

199 
u32
 
	mmax_³riod
;

200 
u8
 
	mexpÚ’t
;

201 
u8
 
	m¡•_couÁ
;

202 
u16
 
	mnumb”_of_™”©iÚs
;

203 
u16
 
	msk_fœ¡_³riod
;

204 } 
	g__·cked
;

206 
šlše
 
	$¦si_mlme_put_oui_ty³
(
¦si_mlme_·¿m‘”s
 *
›
, 
u8
 
ty³
, u8 
subty³
)

208 
›
->
oui_ty³
 = 
ty³
;

209 
›
->
oui_subty³
 = 
subty³
;

210 
	}
}

212 
šlše
 
	$¦si_mlme_put_oui
(
u8
 *
oui
, 
u32
 
v®
)

214 
oui
[0] = (
u8
)((
v®
 >> 16) & 0xff);

215 
oui
[1] = (
u8
)((
v®
 >> 8) & 0xff);

216 
oui
[2] = (
u8
)(
v®
 & 0xff);

217 
	}
}

219 
	#SLSI_5GHZ_MIN_FREQ
 5180

	)

220 
	#SLSI_5GHZ_MAX_FREQ
 5825

	)

221 
	#SLSI_6GHZ_MIN_FREQ
 5955

	)

222 
	#SLSI_6GHZ_MAX_FREQ
 7115

	)

224 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


225 
	#SLSI_NUM_6GHZ_CHANNELS
 59

	)

226 
	#SLSI_MLME_SUBTYPE_6GHZ_PARAM
 0x10

	)

228 
	e¦si_sÿn_6ghz_İt
 {

229 
	mSLSI_UNSOLICITED_PROBE
 = 
BIT
(0),

230 
	mSLSI_SHORT_SSID_VALID
 = 
BIT
(1),

231 
	mSLSI_PSC_NO_LISTEN
 = 
BIT
(2)

234 
	s¦si_mlme_sÿn_6ghz_desütÜ
 {

235 
u32
 
	mshÜt_ssid
;

236 
u32
 
	mchªÃl_idx
;

237 
u8
 
	mbssid
[
ETH_ALEN
];

238 
u8
 
	msÿn_6ghz_İtiÚ
;

239 } 
	g__·cked
;

243 
u16
 
¦si_g‘_chªn_šfo
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
);

244 
¦si_check_chªÃliz©iÚ
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
,

245 
wifi_sh¬šg_chªÃl_sw™ched
);

246 
¦si_mlme_£t__add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

247 #ià
IS_ENABLED
(
CONFIG_IPV6
)

248 
¦si_mlme_£t_v6_add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

250 
¦si_mlme_£t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
»q
, 
»q_Ën
);

251 
sk_buff
 *
¦si_mlme_£t_w™h_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mib
, 
mib_Ën
);

252 
¦si_mlme_g‘
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
»q
, 
»q_Ën
,

253 
u8
 *
»¥
, 
»¥_buf_Ën
, *
»¥_Ën
);

255 
¦si_mlme_add_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
);

256 
¦si_mlme_d–_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

257 
¦si_mlme_add_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
);

258 
¦si_mlme_d–_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

259 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

260 
¦si_mlme_£t_fÜw¬d_b—cÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
aùiÚ
);

262 
¦si_mlme_£t_chªÃl
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, u16 
š‹rv®
, u16 
couÁ
);

263 
¦si_­_obss_sÿn_dÚe_šd
(
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
);

265 
¦si_mlme_un£t_chªÃl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

267 
u16
 
¦si_compu‹_chªn_šfo
(
¦si_dev
 *
sdev
, u16 
width
, u16 
ûÁ”_äeq0
, u16 
chªÃl_äeq
);

274 
¦si_mlme_add_sÿn
(
¦si_dev
 *
sdev
,

275 
Ãt_deviû
 *
dev
,

276 
u16
 
sÿn_ty³
,

277 
u16
 
»pÜt_mode
,

278 
u32
 
n_ssids
,

279 
cfg80211_ssid
 *
ssids
,

280 
u32
 
n_chªÃls
,

281 
›“80211_chªÃl
 *
chªÃls
[],

282 *
gsÿn_·¿m
,

283 cÚ¡ 
u8
 *
›s
,

284 
u16
 
›s_Ën
,

285 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


286 
u32
 
n_6ghz_·¿ms
,

287 
cfg80211_sÿn_6ghz_·¿ms
 *
sÿn_6ghz_·¿ms
,

289 
boŞ
 
wa™_fÜ_šd
);

291 
¦si_mlme_add_sched_sÿn
(
¦si_dev
 *
sdev
,

292 
Ãt_deviû
 *
dev
,

293 
cfg80211_sched_sÿn_»que¡
 *
»que¡
,

294 cÚ¡ 
u8
 *
›s
,

295 
u16
 
›s_Ën
);

297 
¦si_mlme_d–_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_timed_out
);

298 
¦si_mlme_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, cÚ¡ u8 *
w·_›_pos
, cÚ¡ u8 *
wmm_›_pos
, 
boŞ
 
­³nd_vht_›s
);

299 
¦si_mlme_cÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
, 
›“80211_chªÃl
 *
chªÃl
, cÚ¡ 
u8
 *
bssid
);

300 
¦si_mlme_£t_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, cÚ¡ 
u8
 *
add»ss
, 
key_·¿ms
 *
key
);

301 
¦si_mlme_g‘_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, 
u8
 *
£q
, *
£q_Ën
);

313 
¦si_mlme_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
, 
u16
 
»asÚ_code
, 
boŞ
 
wa™_šd
);

314 
sk_buff
 *
¦si_mlme_rßmšg_chªÃl_li¡_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

315 
¦si_mlme_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

316 
sk_buff
 *
¦si_mlme_»q_no_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, sk_bufà*
skb
);

318 
sk_buff
 *
¦si_mlme_»q_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, sk_bufà*
skb
, 
u16
 
šd_id
);

320 
¦si_mlme_g‘_sšfo_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

321 
¦si_³”
 *
³”
);

323 
¦si_mlme_cÚÃù_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

324 
u32
 
n_ssids
, 
cfg80211_ssid
 *
ssids
, 
›“80211_chªÃl
 *
chªÃl
);

325 
¦si_mlme_pow”mgt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ps_mode
);

326 
¦si_mlme_pow”mgt_uÆocked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ps_mode
);

327 
¦si_mlme_»gi¡”_aùiÚ_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
af_b™m­_aùive
, u32 
af_b™m­_su¥’ded
);

328 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


329 
¦si_mlme_synchrÚi£d_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

330 
cfg80211_ex‹º®_auth_·¿ms
 *
·¿ms
);

332 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


333 
¦si_mlme_g‘_num_ª‹Âas
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
num_ª‹Âas
);

335 
¦si_mlme_chªÃl_sw™ch
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ûÁ”_äeq
, u16 
chª_šfo
);

336 
¦si_mlme_add_šfo_–em’ts
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pu½o£
, cÚ¡ 
u8
 *
›s
, cÚ¡ u16 
›s_Ën
);

337 
¦si_mlme_£nd_äame_mgmt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
äame
, 
äame_Ën
, 
u16
 
d©a_desc
, u16 
msg_ty³
, u16 
ho¡_g
, u16 
äeq
, 
u32
 
dw–l_time
, u32 
³riod
);

338 
¦si_mlme_£nd_äame_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
msg_ty³
,

339 
u16
 
ho¡_g
, 
u32
 
dw–l_time
, u32 
³riod
);

340 
¦si_mlme_wifish¬šg_³rm™‹d_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³rm™‹d_chªÃls
);

341 
¦si_mlme_»£t_dw–l_time
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

342 
¦si_mlme_£t_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
pkt_f‹r_Ën
, 
u8
 
num_f‹rs
, 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–ems
);

343 
¦si_mlme_cÚÃù_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

344 
¦si_mlme_cÚÃùed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
³”_šdex
);

345 
¦si_mlme_rßmed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

346 
¦si_mlme_rßm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
, 
u16
 
äeq
);

347 
¦si_mlme_£t_ÿched_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
chªÃls_couÁ
, 
u8
 *
chªÃls
);

348 
¦si_mlme_tdls_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
³”
, 
aùiÚ
);

349 
¦si_mlme_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
iâum
, 
Æ80211_aş_pŞicy
 
aş_pŞicy
, 
max_aş_’Œ›s
, 
mac_add»ss
 
mac_addrs
[]);

350 
¦si_mlme_£t_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
, u16 
medium_time
, u16 
mšimun_d©a_¿‹
, 
u8
 *
mac
);

351 
¦si_mlme_d–_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
);

352 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


353 
¦si_mlme_£t_²o_li¡
(
¦si_dev
 *
sdev
, 
couÁ
,

354 
¦si_•no_·¿m
 *
•no_·¿m
, 
¦si_•no_hs2_·¿m
 *
•no_hs2_·¿m
);

355 
¦si_mlme_¡¬t_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
mpdu_size_th»shŞd
, 
boŞ
 
agg»ssive_¡©is_’abËd
);

356 
¦si_mlme_¡İ_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
¡©s_¡İ_mask
);

357 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


358 
¦si_mlme_Çn_’abË
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
);

359 
¦si_mlme_Çn_publish
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
,

360 
u16
 
publish_id
);

361 
¦si_mlme_Çn_subsüibe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
,

362 
u16
 
subsüibe_id
);

363 
¦si_mlme_Çn_tx_fŞlowup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

364 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
);

365 
¦si_mlme_Çn_£t_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
);

366 
¦si_mlme_ndp_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

367 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
, 
u32
 
ndp_š¡ªû_id
, 
u16
 
ndl_vif_id
);

368 
¦si_mlme_ndp_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

369 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
, 
u16
 
loÿl_ndp_š¡ªû_id
);

370 
¦si_mlme_ndp_‹rmš©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, u16 
Œª§ùiÚ_id
);

371 
¦si_mlme_Çn_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
);

372 
¦si_mlme_Çn_¿nge_ÿnûl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

376 
¦si_mlme_£t_ext_ÿ·b
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
d©a
, 
d©®’gth
);

377 
¦si_mlme_»assocŸ‹
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

378 
¦si_mlme_»assocŸ‹_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

379 
¦si_modify_›s
(
Ãt_deviû
 *
dev
, 
u8
 
eid
, u8 *
›s
, 
›s_Ën
, u8 
›_šdex
, u8 
›_v®ue
);

380 
¦si_mlme_£t_rssi_mÚ™Ü
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
’abË
, 
s8
 
low_rssi_th»shŞd
, s8 
high_rssi_th»shŞd
);

381 
¦si_mib_v®ue
 *
¦si_»ad_mibs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_mib_g‘_’Œy
 *
mib_’Œ›s
, 
mib_couÁ
, 
¦si_mib_d©a
 *
mibr¥
);

382 
¦si_mlme_£t_ho¡_¡©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ho¡_¡©e
);

383 
¦si_mlme_»ad_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 **
ho¡_d¡
, *
d©®’
);

384 
¦si_mlme_š¡®l_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

385 
u8
 *
´og¿m
, 
u32
 
´og¿m_Ën
);

386 
¦si_mlme_£t_muÉiÿ¡_
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
muÉiÿ¡__li¡
[], 
couÁ
);

388 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


389 
¦si_mlme_¬p_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
aùiÚ
, 
u8
 *
addr
);

391 
¦si_mlme_¡¬t_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

392 
¦si_mlme_£t_ùwšdow
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ù_·¿m
);

393 
¦si_mlme_£t_p2p_nß
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
nß_couÁ
,

394 
š‹rv®
, 
du¿tiÚ
);

395 
¦si_decode_fw_¿‹
(
u32
 
fw_¿‹
, 
¿‹_šfo
 *
¿‹
, *
d©a_¿‹_mbps
);

396 
¦si_‹¡_§p_cÚfigu»_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_chª_def
 *
chªdef
);

397 
¦si_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_q¡a_add»ss
, 
u16
 
´iÜ™y
, u16 
dœeùiÚ
, u16 
£qu’û_numb”
, u16 
»asÚ_code
);

398 
¦si_mlme_cÚfigu»_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_chª_def
 *
chªdef
);

399 
sk_buff
 *
¦si_mlme_»q_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, sk_bufà*
skb
, 
u16
 
cfm_id
);

400 
sk_buff
 *
¦si_mlme_»q_cfm_šd
(
¦si_dev
 *
sdev
,

401 
Ãt_deviû
 *
dev
,

402 
sk_buff
 *
skb
,

403 
u16
 
cfm_id
,

404 
u16
 
šd_id
,

405 
	$boŞ
 (*
v®id©e_cfm_wa™_šd
)(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
));

406 
	`¦si_mlme_£t_couÁry
(
¦si_dev
 *
sdev
, *
®pha2
);

407 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
mib_v®ue
, 
mib_Ëngth
);

408 
	`¦si_mlme_£t_bªd_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ušt
 
bªd
, 
u16
 
avoid_discÚÃùiÚ
);

409 
	`¦si_mlme_£t_sÿn_mode_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_mode
, u16 
max_chªÃl_time
,

410 
u16
 
home_away_time
, u16 
home_time
, u16 
max_chªÃl_·ssive_time
);

411 
	`¦si_mlme_add_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
,

412 
u16
 
¹t_id
, 
u8
 *
sourû_addr
);

413 
	`¦si_mlme_d–_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
couÁ
, 
u8
 *
addr
, u16 
¹t_id
);

414 
	`¦si_mlme_£t_couÁry_fÜ_»cov”y
(
¦si_dev
 *
sdev
);

415 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

416 
	`¦si_rx_£nd_äame_cfm_async
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

418 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


419 
	`¦si_mlme_£t_num_ª‹Âas
(
Ãt_deviû
 *
dev
, cÚ¡ 
u16
 
num_of_ª‹Âas
, 
äame_ty³
);

	@mlme_nan.c

7 
	~"debug.h
"

8 
	~"mlme.h
"

9 
	~"Æ80211_v’dÜ_Çn.h
"

11 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_U8
(
»q
, 
©Œibu‹
, 
v®
) \

13 
u16
 
©Œibu‹_Ën
 = 1; \

14 
sk_buff
 *
»q_p
 = 
»q
; \

15 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

16 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

17 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
v®
), 1); \

18 }

	)

20 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_U16
(
»q
, 
©Œibu‹
, 
v®
) \

22 
u16
 
©Œibu‹_Ën
 = 2; \

23 
__Ë16
 
Ë16v®
 = 
	`ıu_to_Ë16
(
v®
); \

24 
sk_buff
 *
»q_p
 = 
»q
; \

25 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

26 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

27 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
Ë16v®
, 2); \

28 }

	)

30 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_U32
(
»q
, 
©Œibu‹
, 
v®
) \

32 
u16
 
©Œibu‹_Ën
 = 4; \

33 
__Ë32
 
Ë32v®
 = 
	`ıu_to_Ë32
(
v®
);\

34 
sk_buff
 *
»q_p
 = 
»q
; \

35 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

36 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

37 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
Ë32v®
, 4); \

38 }

	)

40 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_DATA
(
»q
, 
©Œibu‹
, 
v®
, 
v®_Ën
) \

42 
u16
 
©Œibu‹_Ën
 = (
v®_Ën
); \

43 
sk_buff
 *
»q_p
 = 
»q
; \

44 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

45 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

46 
	`çpi_­³nd_d©a
((
»q_p
), (
v®
), (
©Œibu‹_Ën
)); \

47 }

	)

49 
boŞ
 
	$¦si_Çn_¡¬t_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

51 
boŞ
 
r
 = 
Œue
;

52 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

54 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

55 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_¡¬t_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

56 
	`SLSI_ERR_NODEV
("mlme_nan_start_cfm(result:0x%04x) ERROR\n",

57 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_¡¬t_cfm
.
»suÉ_code
));

58 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_¡¬t_cfm
.
»suÉ_code
è=ğ
FAPI_RESULTCODE_INVALID_PARAMETERS
)

59 
ndev_vif
->
Çn
.
Çn_’abË_¡©us
 = 
FAPI_RESULTCODE_INVALID_PARAMETERS
;

61 
ndev_vif
->
Çn
.
Çn_’abË_¡©us
 = -
EINVAL
;

63 
r
 = 
çl£
;

66 
	`kä“_skb
(
cfm
);

67  
r
;

68 
	}
}

70 
u32
 
	$¦si_mlme_Çn_­³nd_v
(
sk_buff
 *
»q
, 
u16
 
g
, u16 
Ën
, 
u8
 *
d©a
)

72 
u8
 *
p
;

74 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
g
);

75 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
Ën
);

76 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
d©a
, 
Ën
);

77 ià(
p
)

80 
	}
}

82 
u32
 
	$¦si_mlme_Çn_­³nd_£rviû_šfo_v
(
sk_buff
 *
»q
, 
¦si_h®_Çn_d©a_·th_­p_šfo
 *
­p_šfo
)

84 
pos
 = 0;

85 
u16
 
Ëngth
;

86 
»t
 = 1;

88 
pos
 < (
­p_šfo
->
ndp_­p_šfo_Ën
 - 3)) {

89 
Ëngth
 = 
­p_šfo
->
ndp_­p_šfo
[
pos
 + 2] << 8 |‡pp_info->ndp_app_info[pos + 1];

90 ià(
­p_šfo
->
ndp_­p_šfo
[
pos
] == 0x01) {

91 ià((
Ëngth
 + 
pos
 + 3è<ğ
­p_šfo
->
ndp_­p_šfo_Ën
)

92 
»t
 = 
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_WFA_SERVICE_INFO
, 
Ëngth
,

93 &
­p_šfo
->
ndp_­p_šfo
[
pos
 + 3]);

96 
pos
 =…o + 
Ëngth
 + 3;

98  
»t
;

99 
	}
}

101 
u16
 
	$¦si_mlme_Çn_£rviû_šfo_v_Ëngth
(
¦si_h®_Çn_d©a_·th_­p_šfo
 *
­p_šfo
)

103 
pos
 = 0;

104 
u16
 
Ëngth
 = 0;

106 
pos
 < (
­p_šfo
->
ndp_­p_šfo_Ën
 - 3)) {

107 ià(
­p_šfo
->
ndp_­p_šfo
[
pos
] == 0x01) {

108 
Ëngth
 = 
­p_šfo
->
ndp_­p_šfo
[
pos
 + 2] << 8 |‡pp_info->ndp_app_info[pos + 1];

112 
pos
 =…o + 
­p_šfo
->
ndp_­p_šfo
[pos + 1] + 3;

114  
Ëngth
;

115 
	}
}

117 
u32
 
	$¦si_mlme_Çn_­³nd_cÚfig_v
(
sk_buff
 *
»q
, 
u8
 
ma¡”_´ef
, 
u16
 
šşude_ps_id
, u8 
ps_id_couÁ
,

118 
u16
 
šşude_ss_id
, 
u8
 
ss_id_couÁ
, u16 
rssi_wšdow
, 
u32
 
nmi_¿nd_š‹rv®
,

119 
u16
 
şu¡”_m”ge
)

121 
u8
 *
p
;

123 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_CONFIGURATION
);

124 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0011);

125 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
ma¡”_´ef
);

128 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
šşude_ps_id
);

129 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
ps_id_couÁ
);

132 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
šşude_ss_id
);

133 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
ss_id_couÁ
);

135 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
rssi_wšdow
);

136 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
nmi_¿nd_š‹rv®
);

137 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
şu¡”_m”ge
);

139 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 0);

141 ià(
p
)

144 
	}
}

146 
u32
 
	$¦si_mlme_Çn_­³nd_bªd_¥ecific_cÚfig
(
sk_buff
 *
»q
, 
u16
 
g
, 
u8
 
rssi_şo£
, u8 
rssi_middË
,

147 
u8
 
rssi_´oxim™y
, u8 
dw–l_time
, 
u16
 
sÿn_³riod
,

148 
u16
 
u£_dw_št_v®
, 
u8
 
dw_š‹rv®
)

150 
u8
 *
p
;

152 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
g
);

153 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0009);

154 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
rssi_şo£
);

155 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
rssi_middË
);

156 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
rssi_´oxim™y
);

157 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
dw–l_time
);

158 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
sÿn_³riod
);

159 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
u£_dw_št_v®
);

160 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
dw_š‹rv®
);

161 ià(
p
)

164 
	}
}

166 
u32
 
	$¦si_mlme_Çn_­³nd_2g4_bªd_¥ecific_cÚfig
(
sk_buff
 *
»q
, 
u8
 
rssi_şo£
, u8 
rssi_middË
,

167 
u8
 
rssi_´oxim™y
, u8 
dw–l_time
, 
u16
 
sÿn_³riod
,

168 
u16
 
u£_dw_št_v®
, 
u8
 
dw_š‹rv®
)

170  
	`¦si_mlme_Çn_­³nd_bªd_¥ecific_cÚfig
(
»q
, 
SLSI_NAN_TLV_TAG_2G4_BAND_SPECIFIC_CONFIG
, 
rssi_şo£
,

171 
rssi_middË
, 
rssi_´oxim™y
, 
dw–l_time
, 
sÿn_³riod
,

172 
u£_dw_št_v®
, 
dw_š‹rv®
);

173 
	}
}

175 
u32
 
	$¦si_mlme_Çn_­³nd_5g_bªd_¥ecific_cÚfig
(
sk_buff
 *
»q
, 
u8
 
rssi_şo£
, u8 
rssi_middË
,

176 
u8
 
rssi_´oxim™y
, u8 
dw–l_time
, 
u16
 
sÿn_³riod
,

177 
u16
 
u£_dw_št_v®
, 
u8
 
dw_š‹rv®
)

179  
	`¦si_mlme_Çn_­³nd_bªd_¥ecific_cÚfig
(
»q
, 
SLSI_NAN_TLV_TAG_5G_BAND_SPECIFIC_CONFIG
, 
rssi_şo£
,

180 
rssi_middË
, 
rssi_´oxim™y
, 
dw–l_time
, 
sÿn_³riod
,

181 
u£_dw_št_v®
, 
dw_š‹rv®
);

182 
	}
}

184 
u32
 
	$¦si_mlme_Çn_­³nd_cÚfig_suµËm’l
(
sk_buff
 *
»q
, 
u32
 
db_š‹rv®_ms
, u32 
nss_discov”y
,

185 
u32
 
’abË_dw_—¾y_‹rmš©iÚ
, u32 
’abË_¿ngšg
)

187 
u8
 *
p
;

189 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_CONFIG_SUPPLEMENTAL
);

190 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0007);

191 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
db_š‹rv®_ms
);

192 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
nss_discov”y
);

193 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
’abË_dw_—¾y_‹rmš©iÚ
);

194 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
’abË_¿ngšg
);

195 ià(
p
)

198 
	}
}

200 
u32
 
	$¦si_mlme_Çn_­³nd_discov”y_cÚfig
(
sk_buff
 *
»q
, 
u8
 
sd_ty³
, u8 
tx_ty³
, 
u16
 
‰l
, u16 
dw_³riod
,

201 
u8
 
dw_couÁ
, u8 
disc_m©ch_šd
, 
u16
 
u£_rssi_th»s
, u16 
¿ngšg_»q
,

202 
u16
 
d©a_·th_»q
)

204 
u8
 *
p
;

206 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_DISCOVERY_COMMON_SPECIFIC
);

207 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x000e);

208 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
sd_ty³
);

209 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
tx_ty³
);

210 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
‰l
);

211 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
dw_³riod
);

212 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
dw_couÁ
);

213 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
disc_m©ch_šd
);

214 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
u£_rssi_th»s
);

215 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
¿ngšg_»q
);

216 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
d©a_·th_»q
);

217 ià(
p
)

220 
	}
}

222 
u32
 
	$¦si_mlme_Çn_­³nd_subsüibe_¥ecific
(
sk_buff
 *
»q
, 
u8
 
¤f_ty³
, 
u16
 
»¥Úd_if_š_add»ss_£t
,

223 
u16
 
u£_¤f
, u16 
ssi_»quœed_fÜ_m©ch
)

225 
u8
 *
p
;

227 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_SUBSCRIBE_SPECIFIC
);

228 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0007);

229 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
¤f_ty³
);

230 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
»¥Úd_if_š_add»ss_£t
);

231 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
u£_¤f
);

232 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
ssi_»quœed_fÜ_m©ch
);

233 ià(
p
)

236 
	}
}

238 
u32
 
	$¦si_mlme_Çn_­³nd_add»ss_£t
(
sk_buff
 *
»q
, 
u16
 
couÁ
, 
u8
 *
add»s£s
)

240 ià(!
couÁ
)

242  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_INTERFACE_ADDRESS_SET
, 
couÁ
 * 6, 
add»s£s
);

243 
	}
}

245 
u32
 
	$¦si_mlme_Çn_­³nd_£rviû_Çme
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

247 ià(!
Ën
)

249  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_SERVICE_NAME
, 
Ën
, 
d©a
);

250 
	}
}

252 
u32
 
	$¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

254 ià(!
Ën
)

256  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
, 
Ën
, 
d©a
);

257 
	}
}

259 
u32
 
	$¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

261 ià(!
Ën
)

263  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
, 
Ën
, 
d©a
);

264 
	}
}

266 
u32
 
	$¦si_mlme_Çn_­³nd_tx_m©ch_f‹r
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

268 ià(!
Ën
)

270  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_TX_MATCH_FILTER
, 
Ën
, 
d©a
);

271 
	}
}

273 
u32
 
	$¦si_mlme_Çn_­³nd_rx_m©ch_f‹r
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

275 ià(!
Ën
)

277  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_RX_MATCH_FILTER
, 
Ën
, 
d©a
);

278 
	}
}

280 
u32
 
	$¦si_mlme_Çn_­³nd_d©a_·th_£c
(
sk_buff
 *
»q
, 
¦si_Çn_£cur™y_šfo
 *
£c_šfo
)

282 
u8
 *
p
, *
Ën_p
;

283 
u8
 *
pmk
;

284 
u8
 
·s¥h¿£_Ën
 = 0;

285 
u8
 *
·s¥h¿£
;

286 
u8
 
£c_ty³
 = 
£c_šfo
->
key_šfo
.
key_ty³
;

287 
u8
 
pmk_Ën
 = 0;

289 ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 1) {

290 
pmk_Ën
 = 
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.pmk_len;

291 
pmk
 = 
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.pmk;

292 } ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 2) {

293 
·s¥h¿£_Ën
 = 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.passphrase_len;

294 
·s¥h¿£
 = 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.passphrase;

296 
£c_ty³
 = 0;

299 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY
);

300 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0002);

301 
Ën_p
 = 
p
;

302 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
£c_ty³
);

303 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
£c_šfo
->
ch”_ty³
);

304 ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 1) {

305 ià(
pmk_Ën
)

306 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
pmk
, 
pmk_Ën
);

307 ià(
p
 && 
Ën_p
)

308 *
Ën_p
 = 2 + 
pmk_Ën
;

309 } ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 2) {

310 ià(
·s¥h¿£_Ën
)

311 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
·s¥h¿£
, 
·s¥h¿£_Ën
);

312 ià(
p
 && 
Ën_p
)

313 *
Ën_p
 = 2 + 
·s¥h¿£_Ën
;

315 ià(!
p
)

318 
	}
}

320 
u32
 
	$¦si_mlme_Çn_­³nd_¿ngšg
(
sk_buff
 *
»q
, 
¦si_Çn_¿ngšg_cfg
 *
¿ngšg_cfg
)

322 
u8
 *
p
;

324 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_RANGING
);

325 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x000d);

326 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
¿ngšg_cfg
->
¿ngšg_š‹rv®_m£c
);

327 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
¿ngšg_cfg
->
cÚfig_¿ngšg_šdiÿtiÚs
);

328 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
¿ngšg_cfg
->
di¡ªû_šg»ss_mm
);

329 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
¿ngšg_cfg
->
di¡ªû_eg»ss_mm
);

330 ià(
p
)

333 
	}
}

335 
	$¦si_mlme_Çn_­³nd_v6_lšk_v
(
sk_buff
 *
»q
, 
u8
 *
loÿl_ndi
)

337 
u8
 *
p
;

338 
u8
 
š‹rçû_id’tif›r
[8];

340 
	`memıy
(&
š‹rçû_id’tif›r
[0], &
loÿl_ndi
[0], 3);

341 
š‹rçû_id’tif›r
[3] = 0xFF;

342 
š‹rçû_id’tif›r
[4] = 0xFE;

343 
	`memıy
(&
š‹rçû_id’tif›r
[5], &
loÿl_ndi
[3], 3);

345 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_WFA_IPV6_LOCAL_LINK
);

346 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0008);

347 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
š‹rçû_id’tif›r
, 8);

349 ià(
p
)

352 
	}
}

354 
u32
 
	$¦si_mlme_Çn_’abË_çpi_d©a
(
Ãtdev_vif
 *
ndev_vif
, 
sk_buff
 *
»q
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
,

355 
u8
 
şu¡”_m”ge
)

357 
u16
 
publish_id_šc
, 
£rviû_id_šc
;

358 
u8
 
publish_id_šc_couÁ
 = 0;

359 
u8
 
£rviû_id_šc_couÁ
 = 0;

360 
u8
 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
;

361 
u16
 
rssi_wšdow
 = 
h®_»q
->
cÚfig_rssi_wšdow_size
 ? h®_»q->
rssi_wšdow_size_v®
 : 8;

362 
u32
 
»t
;

365 
publish_id_šc
 = 
h®_»q
->
cÚfig_sid_b—cÚ
 && (h®_»q->
sid_b—cÚ_v®
 & 0x01);

366 ià(
publish_id_šc
)

367 
publish_id_šc_couÁ
 = 
h®_»q
->
sid_b—cÚ_v®
 >> 1;

368 
£rviû_id_šc
 = 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 && (h®_»q->
subsüibe_sid_b—cÚ_v®
 & 0x01);

369 ià(
£rviû_id_šc
)

370 
£rviû_id_šc_couÁ
 = 
h®_»q
->
subsüibe_sid_b—cÚ_v®
 >> 1;

371 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_v
(
»q
, 
h®_»q
->
ma¡”_´ef
, 
publish_id_šc
, 
publish_id_šc_couÁ
,

372 
£rviû_id_šc
, 
£rviû_id_šc_couÁ
, 
rssi_wšdow
,

373 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
, 
şu¡”_m”ge
);

374 ià(
»t
) {

375 
	`SLSI_WARN_NODEV
("Error‡ppend config TLV\n");

376  
»t
;

380 
rssi_şo£
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_şo£
 ? h®_»q->
rssi_şo£_2dÙ4g_v®
 : 0;

381 
rssi_middË
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_middË
 ? h®_»q->
rssi_middË_2dÙ4g_v®
 : 0;

382 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_´oxim™y
 ? h®_»q->
rssi_´oxim™y_2dÙ4g_v®
 : 0;

383 
»t
 = 
	`¦si_mlme_Çn_­³nd_2g4_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

384 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[0],

385 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[0],

386 (
u16
)
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
,

387 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
);

388 ià(
»t
) {

389 
	`SLSI_WARN_NODEV
("Error‡ppend 2.4G band specific TLV\n");

390  
»t
;

394 ià(
h®_»q
->
cÚfig_suµÜt_5g
 && h®_»q->
suµÜt_5g_v®
) {

395 
rssi_şo£
 = 
h®_»q
->
cÚfig_5g_rssi_şo£
 ? h®_»q->
rssi_şo£_5g_v®
 : 0;

396 
rssi_middË
 = 
h®_»q
->
cÚfig_5g_rssi_middË
 ? h®_»q->
rssi_middË_5g_v®
 : 0;

397 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 ? h®_»q->
rssi_şo£_´oxim™y_5g_v®
 : 0;

398 
»t
 = 
	`¦si_mlme_Çn_­³nd_5g_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

399 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[1],

400 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[1],

401 (
u16
)
h®_»q
->
cÚfig_5g_dw_bªd
,

402 
h®_»q
->
dw_5g_š‹rv®_v®
);

403 ià(
»t
) {

404 
	`SLSI_WARN_NODEV
("Error‡ppend 5G band specific TLV\n");

405  
»t
;

409 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_suµËm’l
(
»q
, 
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
,

410 
h®_»q
->
nss_discov”y
, h®_»q->
’abË_dw_—¾y_‹rmš©iÚ
,

411 
h®_»q
->
’abË_¿ngšg
);

412 ià(
»t
) {

413 
	`SLSI_WARN_NODEV
("Failedo‡dd config supplemental TLV\n");

414  
»t
;

417  
»t
;

418 
	}
}

420 
	$¦si_mlme_Çn_¡Üe_cÚfig
(
Ãtdev_vif
 *
ndev_vif
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
)

422 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_rssi_´oxim™y
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_´oxim™y
;

423 
ndev_vif
->
Çn
.
cÚfig
.
rssi_şo£_2dÙ4g_v®
 = 
h®_»q
->rssi_close_2dot4g_val;

424 
ndev_vif
->
Çn
.
cÚfig
.
rssi_middË_2dÙ4g_v®
 = 
h®_»q
->rssi_middle_2dot4g_val;

425 
ndev_vif
->
Çn
.
cÚfig
.
rssi_´oxim™y
 = 
h®_»q
->
rssi_´oxim™y_2dÙ4g_v®
;

426 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
dw–l_time
[0] = 
h®_»q
->scan_params_val.dwell_time[0];

427 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
sÿn_³riod
[0] = 
h®_»q
->scan_params_val.scan_period[0];

428 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_2dÙ4g_dw_bªd
 = (
u16
)
h®_»q
->config_2dot4g_dw_band;

429 
ndev_vif
->
Çn
.
cÚfig
.
dw_2dÙ4g_š‹rv®_v®
 = 
h®_»q
->dw_2dot4g_interval_val;

431 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_5g_rssi_şo£_´oxim™y
 = 
h®_»q
->config_5g_rssi_close_proximity;

432 
ndev_vif
->
Çn
.
cÚfig
.
rssi_şo£_5g_v®
 = 
h®_»q
->rssi_close_5g_val;

433 
ndev_vif
->
Çn
.
cÚfig
.
rssi_middË_5g_v®
 = 
h®_»q
->rssi_middle_5g_val;

434 
ndev_vif
->
Çn
.
cÚfig
.
rssi_şo£_´oxim™y_5g_v®
 = 
h®_»q
->rssi_close_proximity_5g_val;

435 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
dw–l_time
[1] = 
h®_»q
->scan_params_val.dwell_time[1];

436 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
sÿn_³riod
[1] = 
h®_»q
->scan_params_val.scan_period[1];

437 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_5g_dw_bªd
 = (
u16
)
h®_»q
->config_5g_dw_band;

438 
ndev_vif
->
Çn
.
cÚfig
.
dw_5g_š‹rv®_v®
 = 
h®_»q
->dw_5g_interval_val;

439 
ndev_vif
->
Çn
.
¡©e
 = 1;

440 
	}
}

442 
	$¦si_mlme_Çn_’abË
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
)

444 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

445 
sk_buff
 *
»q
;

446 
sk_buff
 *
rx
;

447 
r
 = 0;

448 
u16
 
Çn_İ”_ù¾
 = 0;

450 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

453 
»q
 = 
	`çpi_®loc
(
mlme_Çn_¡¬t_»q
, 
MLME_NAN_START_REQ
, 
ndev_vif
->
iâum
, 58);

454 ià(!
»q
) {

455 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

456  -
ENOMEM
;

459 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_¡¬t_»q
.
Çn_İ”©iÚ_cÚŒŞ_æags
, 
Çn_İ”_ù¾
);

461 
r
 = 
	`¦si_mlme_Çn_’abË_çpi_d©a
(
ndev_vif
, 
»q
, 
h®_»q
, !ndev_vif->
Çn
.
di§bË_şu¡”_m”ge
);

462 ià(
r
) {

463 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

464 
	`kä“_skb
(
»q
);

465  -
EINVAL
;

468 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_START_CFM
, 
MLME_NAN_EVENT_IND
, 
¦si_Çn_¡¬t_cfm_v®id©e
);

469 ià(!
rx
)

470  -
EINVAL
;

472 
	`¦si_mlme_Çn_¡Üe_cÚfig
(
ndev_vif
, 
h®_»q
);

473  
r
;

474 
	}
}

476 
u32
 
	$¦si_mlme_Çn_publish_çpi_d©a
(
sk_buff
 *
»q
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
)

478 
u32
 
»t
;

480 
»t
 = 
	`¦si_mlme_Çn_­³nd_discov”y_cÚfig
(
»q
, 
h®_»q
->
publish_ty³
, h®_»q->
tx_ty³
, h®_»q->
‰l
,

481 
h®_»q
->
³riod
, h®_»q->
publish_couÁ
, h®_»q->
publish_m©ch_šdiÿtÜ
,

482 (
u16
)
h®_»q
->
rssi_th»shŞd_æag
, (u16)h®_»q->
sd—_·¿ms
.
¿ngšg_¡©e
,

483 (
u16
)
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
);

484 ià(
»t
) {

485 
	`SLSI_WARN_NODEV
("Error‡ppend disovery config TLV\n");

486  
»t
;

489 ià(
h®_»q
->
£rviû_Çme_Ën
) {

490 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

491 ià(
»t
) {

492 
	`SLSI_WARN_NODEV
("Error‡ppend servicename TLV\n");

493  
»t
;

497 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
) {

498 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

499 
h®_»q
->
£rviû_¥ecific_šfo
);

500 ià(
»t
) {

501 
	`SLSI_WARN_NODEV
("Error‡ppend servSpecInfo TLV\n");

502  
»t
;

506 ià(
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
) {

507 
»t
 = 
	`¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

508 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

509 ià(
»t
) {

510 
	`SLSI_WARN_NODEV
("Error‡ppendƒxtServSpecInfo TLV\n");

511  
»t
;

515 ià(
h®_»q
->
rx_m©ch_f‹r_Ën
) {

516 
»t
 = 
	`¦si_mlme_Çn_­³nd_rx_m©ch_f‹r
(
»q
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
);

517 ià(
»t
) {

518 
	`SLSI_WARN_NODEV
("Error‡ppend„x match filter TLV\n");

519  
»t
;

523 ià(
h®_»q
->
tx_m©ch_f‹r_Ën
) {

524 
»t
 = 
	`¦si_mlme_Çn_­³nd_tx_m©ch_f‹r
(
»q
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
);

525 ià(
»t
) {

526 
	`SLSI_WARN_NODEV
("Error‡ppendx match filter TLV\n");

527  
»t
;

531 ià(
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
) {

532 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
£c_šfo
);

533 ià(
»t
) {

534 
	`SLSI_WARN_NODEV
("Error‡ppend datapath sec TLV\n");

535  
»t
;

538 ià(
h®_»q
->
sd—_·¿ms
.
¿ngšg_¡©e
) {

539 
»t
 = 
	`¦si_mlme_Çn_­³nd_¿ngšg
(
»q
, &
h®_»q
->
¿ngšg_cfg
);

540 ià(
»t
)

541 
	`SLSI_WARN_NODEV
("Error‡ppend„anging config TLV\n");

543  
»t
;

544 
	}
}

546 
	$¦si_mlme_Çn_publish
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
,

547 
u16
 
publish_id
)

549 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

550 
sk_buff
 *
»q
;

551 
sk_buff
 *
cfm
;

552 
r
 = 0;

553 
u16
 
Çn_sdf_æags
 = 0;

555 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

556 ià(
h®_»q
) {

558 
u16
 
Ëngth
 = 18 + 70 + 11;

560 
Ëngth
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? hal_req->service_name_len + 4 : 0;

561 
Ëngth
 +ğ
h®_»q
->
£rviû_¥ecific_šfo_Ën
 ? hal_req->service_specific_info_len + 4 : 0;

562 
Ëngth
 +ğ
h®_»q
->
rx_m©ch_f‹r_Ën
 ? hal_req->rx_match_filter_len + 4 : 0;

563 
Ëngth
 +ğ
h®_»q
->
tx_m©ch_f‹r_Ën
 ? hal_req->tx_match_filter_len + 4 : 0;

564 
Ëngth
 +ğ
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 ? hal_req->sdea_service_specific_info_len + 4 : 0;

566 
»q
 = 
	`çpi_®loc
(
mlme_Çn_publish_»q
, 
MLME_NAN_PUBLISH_REQ
, 
ndev_vif
->
iâum
, 
Ëngth
);

567 ià(!
»q
) {

568 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

569  -
ENOMEM
;

578 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(0))

579 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_PUBLISH_END_EVENT
;

580 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(1))

581 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
;

582 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(2))

583 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_RECEIVED_FOLLOWUP_EVENT
;

585 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
publish_id
] =‚an_sdf_flags;

587 
»q
 = 
	`çpi_®loc
(
mlme_Çn_publish_»q
, 
MLME_NAN_PUBLISH_REQ
, 
ndev_vif
->
iâum
, 0);

588 ià(!
»q
) {

589 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

590  -
ENOMEM
;

594 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_publish_»q
.
£ssiÚ_id
, 
publish_id
);

595 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_publish_»q
.
Çn_sdf_æags
, 0);

597 ià(
h®_»q
) {

598 
r
 = 
	`¦si_mlme_Çn_publish_çpi_d©a
(
»q
, 
h®_»q
);

599 ià(
r
) {

600 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

601 
	`kä“_skb
(
»q
);

602  -
EINVAL
;

606 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_PUBLISH_CFM
);

607 ià(!
cfm
)

608  -
EIO
;

610 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_publish_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

611 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_PUBLISH_CFM(result:0x%04x) ERROR\n",

612 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_publish_cfm
.
»suÉ_code
));

613 
r
 = -
EINVAL
;

616 ià(
h®_»q
 && !
r
)

617 
ndev_vif
->
Çn
.
£rviû_id_m­
 |ğ(
u32
)
	`BIT
(
publish_id
);

619 
ndev_vif
->
Çn
.
£rviû_id_m­
 &ğ(
u32
)~
	`BIT
(
publish_id
);

620 
	`kä“_skb
(
cfm
);

621  
r
;

622 
	}
}

624 
u32
 
	$¦si_mlme_Çn_subsüibe_çpi_d©a
(
sk_buff
 *
»q
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
)

626 
u32
 
»t
;

628 
»t
 = 
	`¦si_mlme_Çn_­³nd_subsüibe_¥ecific
(
»q
, 
h®_»q
->
£rviû_»¥Ú£_f‹r
,

629 
h®_»q
->
£rviû_»¥Ú£_šşude
,

630 
h®_»q
->
u£_£rviû_»¥Ú£_f‹r
,

631 
h®_»q
->
ssi_»quœed_fÜ_m©ch_šdiÿtiÚ
);

632 ià(
»t
) {

633 
	`SLSI_WARN_NODEV
("Error‡ppend subscribe specific TLV\n");

634  
»t
;

637 
»t
 = 
	`¦si_mlme_Çn_­³nd_discov”y_cÚfig
(
»q
, 
h®_»q
->
subsüibe_ty³
,

638 
h®_»q
->
subsüibe_ty³
 ? 0 : 1, h®_»q->
‰l
,

639 
h®_»q
->
³riod
, h®_»q->
subsüibe_couÁ
, h®_»q->
subsüibe_m©ch_šdiÿtÜ
,

640 
h®_»q
->
rssi_th»shŞd_æag
, (
u16
)h®_»q->
sd—_·¿ms
.
¿ngšg_¡©e
,

641 
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
);

642 ià(
»t
) {

643 
	`SLSI_WARN_NODEV
("Error‡ppend discovery config TLV\n");

644  
»t
;

647 ià(
h®_»q
->
£rviû_Çme_Ën
) {

648 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

649 ià(
»t
) {

650 
	`SLSI_WARN_NODEV
("Error‡ppend service‚ame TLV\n");

651  
»t
;

655 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
) {

656 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

657 
h®_»q
->
£rviû_¥ecific_šfo
);

658 ià(
»t
) {

659 
	`SLSI_WARN_NODEV
("Error‡ppend servSpecInfo TLV\n");

660  
»t
;

664 ià(
h®_»q
->
rx_m©ch_f‹r_Ën
) {

665 
»t
 = 
	`¦si_mlme_Çn_­³nd_rx_m©ch_f‹r
(
»q
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
);

666 ià(
»t
) {

667 
	`SLSI_WARN_NODEV
("Error‡ppend„x match filter TLV\n");

668  
»t
;

672 ià(
h®_»q
->
tx_m©ch_f‹r_Ën
) {

673 
»t
 = 
	`¦si_mlme_Çn_­³nd_tx_m©ch_f‹r
(
»q
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
);

674 ià(
»t
) {

675 
	`SLSI_WARN_NODEV
("Error‡ppendx match filter TLV\n");

676  
»t
;

680 ià(
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
) {

681 
»t
 = 
	`¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

682 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

683 ià(
»t
) {

684 
	`SLSI_WARN_NODEV
("Error‡ppendƒxtServSpecInfo TLV\n");

685  
»t
;

689 ià(
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
) {

690 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
£c_šfo
);

691 ià(
»t
) {

692 
	`SLSI_WARN_NODEV
("Error‡ppend datapath sec TLV\n");

693  
»t
;

696 ià(
h®_»q
->
sd—_·¿ms
.
¿ngšg_¡©e
) {

697 
»t
 = 
	`¦si_mlme_Çn_­³nd_¿ngšg
(
»q
, &
h®_»q
->
¿ngšg_cfg
);

698 ià(
»t
) {

699 
	`SLSI_WARN_NODEV
("Error‡ppend„anging config TLV\n");

700  
»t
;

704 
»t
 = 
	`¦si_mlme_Çn_­³nd_add»ss_£t
(
»q
, 
h®_»q
->
num_štf_addr_´e£Á
, (
u8
 *)h®_»q->
štf_addr
);

705 ià(
»t
)

706 
	`SLSI_WARN_NODEV
("Error‡ppend‡ddress set TLV\n");

707  
»t
;

708 
	}
}

710 
	$¦si_mlme_Çn_subsüibe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
,

711 
u16
 
subsüibe_id
)

713 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

714 
sk_buff
 *
»q
;

715 
sk_buff
 *
cfm
;

716 
r
 = 0;

717 
u16
 
Çn_sdf_æags
 = 0;

719 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

720 ià(
h®_»q
) {

722 
u16
 
Ëngth
 = 11 + 18 + 70 + 11;

724 
Ëngth
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? hal_req->service_name_len + 4 : 0;

725 
Ëngth
 +ğ
h®_»q
->
£rviû_¥ecific_šfo_Ën
 ? hal_req->service_specific_info_len + 4 : 0;

726 
Ëngth
 +ğ
h®_»q
->
rx_m©ch_f‹r_Ën
 ? hal_req->rx_match_filter_len + 4 : 0;

727 
Ëngth
 +ğ
h®_»q
->
tx_m©ch_f‹r_Ën
 ? hal_req->tx_match_filter_len + 4 : 0;

728 
Ëngth
 +ğ
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 ? hal_req->sdea_service_specific_info_len + 4 : 0;

729 
Ëngth
 +ğ
h®_»q
->
num_štf_addr_´e£Á
 ? hal_req->num_intf_addr_present * 6 + 4 : 0;

731 
»q
 = 
	`çpi_®loc
(
mlme_Çn_subsüibe_»q
, 
MLME_NAN_SUBSCRIBE_REQ
, 
ndev_vif
->
iâum
, 
Ëngth
);

732 ià(!
»q
) {

733 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

734  -
ENOMEM
;

742 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(0))

743 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_SUBSCRIBE_END_EVENT
;

744 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(1))

745 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
;

746 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(2))

747 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_RECEIVED_FOLLOWUP_EVENT
;

748 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
subsüibe_id
] =‚an_sdf_flags;

750 
»q
 = 
	`çpi_®loc
(
mlme_Çn_subsüibe_»q
, 
MLME_NAN_SUBSCRIBE_REQ
, 
ndev_vif
->
iâum
, 0);

751 ià(!
»q
) {

752 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

753  -
ENOMEM
;

757 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_subsüibe_»q
.
£ssiÚ_id
, 
subsüibe_id
);

758 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_subsüibe_»q
.
Çn_sdf_æags
, 0);

759 ià(
h®_»q
) {

760 
r
 = 
	`¦si_mlme_Çn_subsüibe_çpi_d©a
(
»q
, 
h®_»q
);

761 ià(
r
) {

762 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

763 
	`kä“_skb
(
»q
);

764  -
EINVAL
;

768 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_SUBSCRIBE_CFM
);

769 ià(!
cfm
)

770  -
EIO
;

772 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_subsüibe_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

773 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_SUBSCRIBE_CFM(res:0x%04x)\n",

774 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_subsüibe_cfm
.
»suÉ_code
));

775 
r
 = -
EINVAL
;

778 ià(
h®_»q
 && !
r
)

779 
ndev_vif
->
Çn
.
£rviû_id_m­
 |ğ(
u32
)
	`BIT
(
subsüibe_id
);

781 
ndev_vif
->
Çn
.
£rviû_id_m­
 &ğ(
u32
)~
	`BIT
(
subsüibe_id
);

782 
	`kä“_skb
(
cfm
);

783  
r
;

784 
	}
}

786 
u32
 
	$¦si_mlme_Çn_fŞlowup_çpi_d©a
(
sk_buff
 *
»q
, 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
)

788 
u32
 
»t
;

790 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

791 
h®_»q
->
£rviû_¥ecific_šfo
);

792 ià(
»t
) {

793 
	`SLSI_WARN_NODEV
("Error‡ppend service specific info TLV\n");

794  
»t
;

797 
»t
 = 
	`¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

798 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

799 ià(
»t
)

800 
	`SLSI_WARN_NODEV
("Error‡ppendƒxtServSpecInfo TLV\n");

801  
»t
;

802 
	}
}

804 
	$¦si_mlme_Çn_tx_fŞlowup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

805 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
)

807 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

808 
sk_buff
 *
»q
;

809 
sk_buff
 *
cfm
;

810 
r
 = 0;

811 
u16
 
Çn_sdf_æags
 = 0;

812 
u16
 
d©a_Ën
;

814 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

816 ià(
	`¦si_Çn_push_fŞlowup_ids
(
sdev
, 
dev
, 
h®_»q
->
»que¡Ü_š¡ªû_id
, h®_»q->
Œª§ùiÚ_id
) < 0) {

817 
	`SLSI_WARN
(
sdev
, "Host followup_req queue full\n");

818  
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
;

821 
d©a_Ën
 = 
h®_»q
->
£rviû_¥ecific_šfo_Ën
 ? (hal_req->service_specific_info_len + 4) : 0;

822 
d©a_Ën
 = 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 ? (hal_req->sdea_service_specific_info_len + 4) : 0;

825 
»q
 = 
	`çpi_®loc
(
mlme_Çn_fŞlowup_»q
, 
MLME_NAN_FOLLOWUP_REQ
, 
ndev_vif
->
iâum
, 5 * 255);

826 ià(!
»q
) {

827 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

828  -
ENOMEM
;

831 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_fŞlowup_»q
.
£ssiÚ_id
, 
h®_»q
->
publish_subsüibe_id
);

832 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_fŞlowup_»q
.
m©ch_id
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

833 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_fŞlowup_»q
.
Çn_sdf_æags
,‚an_sdf_flags);

835 
r
 = 
	`¦si_mlme_Çn_fŞlowup_çpi_d©a
(
»q
, 
h®_»q
);

836 ià(
r
) {

837 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

838 
	`kä“_skb
(
»q
);

839  -
EINVAL
;

842 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_FOLLOWUP_CFM
);

843 ià(!
cfm
) {

844 
	`¦si_Çn_pİ_fŞlowup_ids
(
sdev
, 
dev
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

845  -
EIO
;

848 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_fŞlowup_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

849 
	`¦si_Çn_pİ_fŞlowup_ids
(
sdev
, 
dev
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

850 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_FOLLOWUP_CFM(res:0x%04x)\n",

851 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_fŞlowup_cfm
.
»suÉ_code
));

852 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_fŞlowup_cfm
.
»suÉ_code
) ==

853 
FAPI_RESULTCODE_TOO_MANY_SIMULTANEOUS_REQUESTS
)

854 
r
 = 
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
;

856 
r
 = -
EINVAL
;

859 
	`kä“_skb
(
cfm
);

860  
r
;

861 
	}
}

863 
u32
 
	$¦si_mlme_Çn_cÚfig_çpi_d©a
(
Ãtdev_vif
 *
ndev_vif
, 
sk_buff
 *
»q
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
, 
u8
 
şu¡”_m”ge
)

865 
u16
 
rssi_wšdow
 = 
h®_»q
->
cÚfig_rssi_wšdow_size
 ? h®_»q->
rssi_wšdow_size_v®
 : 8;

866 
u32
 
»t
;

867 
u8
 
rssi_şo£
 = 
h®_»q
->
rssi_şo£_2dÙ4g_v®
;

868 
u8
 
rssi_middË
 = 
h®_»q
->
rssi_middË_2dÙ4g_v®
;

869 
u8
 
rssi_´oxim™y
 = 0;

871 
u16
 
is_sid_š_b—cÚ
 = 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 && (h®_»q->
subsüibe_sid_b—cÚ_v®
 & 0x01);

872 
u8
 
sid_couÁ_š_b—cÚ
 = 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 ? h®_»q->
subsüibe_sid_b—cÚ_v®
 >> 1 : 0;

874 ià(!
h®_»q
->
ma¡”_´ef
)

875 
h®_»q
->
ma¡”_´ef
 = 
ndev_vif
->
Çn
.
ma¡”_´ef_v®ue
;

877 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_v
(
»q
, 
h®_»q
->
ma¡”_´ef
,

878 
h®_»q
->
cÚfig_sid_b—cÚ
 && (h®_»q->
sid_b—cÚ
 & 0x01),

879 
h®_»q
->
cÚfig_sid_b—cÚ
 ? h®_»q->
sid_b—cÚ
 >> 1 : 0,

880 
is_sid_š_b—cÚ
, 
sid_couÁ_š_b—cÚ
, 
rssi_wšdow
,

881 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
, 
şu¡”_m”ge
);

882 ià(
»t
) {

883 
	`SLSI_WARN_NODEV
("Error‡ppend config TLV\n");

884  
»t
;

888 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_rssi_´oxim™y
 ? hal_req->rssi_proximity : 0;

890 
»t
 = 
	`¦si_mlme_Çn_­³nd_2g4_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

891 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[0],

892 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[0],

893 
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
,

894 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
);

895 ià(
»t
) {

896 
	`SLSI_WARN_NODEV
("Error‡ppend 2.4G band specific TLV\n");

897  
»t
;

901 
rssi_şo£
 = 
h®_»q
->
rssi_şo£_5g_v®
;

902 
rssi_middË
 = 
h®_»q
->
rssi_middË_5g_v®
;

903 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 ? h®_»q->
rssi_şo£_´oxim™y_5g_v®
 : 0;

905 
»t
 = 
	`¦si_mlme_Çn_­³nd_5g_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

906 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[1],

907 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[1],

908 
h®_»q
->
cÚfig_5g_dw_bªd
,

909 
h®_»q
->
dw_5g_š‹rv®_v®
);

910 ià(
»t
) {

911 
	`SLSI_WARN_NODEV
("Error‡ppend 5G band specific TLV\n");

912  
»t
;

915 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_suµËm’l
(
»q
, 
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
,

916 
h®_»q
->
nss_discov”y
, h®_»q->
’abË_dw_—¾y_‹rmš©iÚ
,

917 
h®_»q
->
’abË_¿ngšg
);

918 ià(
»t
) {

919 
	`SLSI_WARN_NODEV
("Failedo‡dd config supplemental TLV\n");

920  
»t
;

922  
»t
;

923 
	}
}

925 
	$¦si_mlme_Çn_£t_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
)

927 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

928 
sk_buff
 *
»q
;

929 
sk_buff
 *
cfm
;

930 
r
 = 0;

931 
u16
 
Çn_İ”_ù¾
 = 0;

933 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

935 
»q
 = 
	`çpi_®loc
(
mlme_Çn_cÚfig_»q
, 
MLME_NAN_CONFIG_REQ
, 
ndev_vif
->
iâum
, 58);

936 ià(!
»q
) {

937 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

938  -
ENOMEM
;

941 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_cÚfig_»q
.
Çn_İ”©iÚ_cÚŒŞ_æags
, 
Çn_İ”_ù¾
);

943 
r
 = 
	`¦si_mlme_Çn_cÚfig_çpi_d©a
(
ndev_vif
, 
»q
, 
h®_»q
, !ndev_vif->
Çn
.
di§bË_şu¡”_m”ge
);

944 ià(
r
) {

945 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

946 
	`kä“_skb
(
»q
);

947  -
EINVAL
;

950 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_CONFIG_CFM
);

951 ià(!
cfm
)

952  -
EIO
;

954 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_cÚfig_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

955 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_CONFIG_CFM(res:0x%04x)\n",

956 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_cÚfig_cfm
.
»suÉ_code
));

957 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_cÚfig_cfm
.
»suÉ_code
è=ğ
FAPI_RESULTCODE_INVALID_PARAMETERS
)

958 
r
 = 
FAPI_RESULTCODE_INVALID_PARAMETERS
;

960 
r
 = -
EINVAL
;

963 
	`kä“_skb
(
cfm
);

964  
r
;

965 
	}
}

967 
	$¦si_mlme_ndp_»que¡_çpi_d©a
(
sk_buff
 *
»q
,

968 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
,

969 
boŞ
 
šşude_v6_addr_v
, boŞ 
šşude_£rviû_šfo_v
,

970 
u8
 *
loÿl_ndi
)

972 
»t
;

974 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
key_šfo
);

975 ià(
»t
) {

976 
	`SLSI_WARN_NODEV
("Error data_path sec TLV\n");

977  
»t
;

980 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

981 
»t
 = 
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_APP_INFO
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
,

982 
h®_»q
->
­p_šfo
.
ndp_­p_šfo
);

983 ià(
»t
) {

984 
	`SLSI_WARN_NODEV
("Error‡pp info TLV\n");

985  
»t
;

988 ià(
šşude_£rviû_šfo_v
) {

989 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_šfo_v
(
»q
, &
h®_»q
->
­p_šfo
);

990 ià(
»t
)

991 
	`SLSI_WARN_NODEV
("Error Adding Service Info TLV\n");

993 ià(
šşude_v6_addr_v
) {

994 
»t
 = 
	`¦si_mlme_Çn_­³nd_v6_lšk_v
(
»q
, 
loÿl_ndi
);

995 ià(
»t
)

996 
	`SLSI_WARN_NODEV
("Error ipv6†inklv\n");

998 ià(
h®_»q
->
£rviû_Çme_Ën
) {

999 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

1000 ià(
»t
)

1001 
	`SLSI_WARN_NODEV
("Error‡ppend servicename TLV\n");

1003  
»t
;

1004 
	}
}

1006 
	$¦si_mlme_ndp_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1007 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
, 
u32
 
ndp_š¡ªû_id
, 
u16
 
ndl_vif_id
)

1009 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1010 
sk_buff
 *
»q
;

1011 
sk_buff
 *
cfm
;

1012 
r
 = 0, 
d©a_Ën
;

1013 
boŞ
 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
 = 0;

1014 
u8
 *
loÿl_ndi
;

1015 
Ãt_deviû
 *
d©a_dev
;

1016 
Ãtdev_vif
 *
ndev_d©a_vif
;

1018 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

1020 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_iâame
(
sdev
, 
h®_»q
->
ndp_içû
);

1021 ià(!
d©a_dev
) {

1022 
	`SLSI_NET_ERR
(
dev
, "nØÃt_deviû fÜ %s\n", 
h®_»q
->
ndp_içû
);

1023  -
EINVAL
;

1025 
loÿl_ndi
 = 
d©a_dev
->
dev_addr
;

1026 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

1028 
šşude_v6_lšk_v
 = 
	`¦si_dev_Çn_is_v6_lšk_v_šşude
();

1030 
d©a_Ën
 = 74;

1031 
d©a_Ën
 +ğ
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
 ? 4 + hal_req->app_info.ndp_app_info_len : 0;

1032 
d©a_Ën
 +ğ
šşude_v6_lšk_v
 ? 4 + 8 : 0;

1033 
d©a_Ën
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? hal_req->service_name_len + 4 : 0;

1034 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

1035 
u16
 
Ëngth
;

1037 
Ëngth
 = 
	`¦si_mlme_Çn_£rviû_šfo_v_Ëngth
(&
h®_»q
->
­p_šfo
);

1038 
d©a_Ën
 +ğ(
Ëngth
 + 1);

1039 
šşude_£rviû_šfo_v
 = 1;

1041 
»q
 = 
	`çpi_®loc
(
mlme_ndp_»que¡_»q
, 
MLME_NDP_REQUEST_REQ
, 
ndev_vif
->
iâum
, 
d©a_Ën
);

1042 ià(!
»q
) {

1043 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1044  -
ENOMEM
;

1047 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
ndl_vif_šdex
, 
ndl_vif_id
);

1048 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
m©ch_id
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

1049 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
loÿl_ndp_š‹rçû_add»ss
, 
loÿl_ndi
);

1050 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
³”_nmi
, 
h®_»q
->
³”_disc_mac_addr
);

1051 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
ndp_š¡ªû_id
,‚dp_instance_id);

1053 
r
 = 
	`¦si_mlme_ndp_»que¡_çpi_d©a
(
»q
, 
h®_»q
, 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
, 
loÿl_ndi
);

1054 ià(
r
) {

1055 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

1056 
	`kä“_skb
(
»q
);

1057  -
EINVAL
;

1060 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NDP_REQUEST_CFM
);

1061 ià(!
cfm
)

1062  -
EIO
;

1064 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»que¡_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1065 
	`SLSI_NET_ERR
(
dev
, "MLME_NDP_REQUEST_CFM(res:0x%04x)\n",

1066 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»que¡_cfm
.
»suÉ_code
));

1067 
r
 = -
EINVAL
;

1069 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1070 
ndev_d©a_vif
->
Çn
.
ndp_couÁ
++;

1071 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1072 ià(
	`¦si_Çn_ndp_Ãw_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndl_vif_id
, 
loÿl_ndi
, 
h®_»q
->
³”_disc_mac_addr
))

1073 
	`SLSI_NET_ERR
(
dev
, "šv®id‚dl_vifid:%d‚dp_id:%d\n", 
ndl_vif_id
, 
ndp_š¡ªû_id
);

1076 
	`kä“_skb
(
cfm
);

1077  
r
;

1078 
	}
}

1080 
	$¦si_mlme_ndp_»¥Ú£_çpi_d©a
(
sk_buff
 *
»q
,

1081 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
,

1082 
boŞ
 
šşude_v6_lšk_v
, boŞ 
šşude_£rviû_šfo_v
,

1083 
u8
 *
loÿl_ndi
)

1085 
»t
;

1087 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
key_šfo
);

1088 ià(
»t
) {

1089 
	`SLSI_WARN_NODEV
("Error data_path sec TLV\n");

1090  
»t
;

1093 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

1094 
»t
 = 
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_APP_INFO
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
,

1095 
h®_»q
->
­p_šfo
.
ndp_­p_šfo
);

1096 ià(
»t
) {

1097 
	`SLSI_WARN_NODEV
("Error‡pp info TLV\n");

1098  
»t
;

1101 ià(
šşude_£rviû_šfo_v
) {

1102 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_šfo_v
(
»q
, &
h®_»q
->
­p_šfo
);

1103 ià(
»t
)

1104 
	`SLSI_WARN_NODEV
("Error Adding Service Info TLV\n");

1106 ià(
šşude_v6_lšk_v
) {

1107 
»t
 = 
	`¦si_mlme_Çn_­³nd_v6_lšk_v
(
»q
, 
loÿl_ndi
);

1108 ià(
»t
)

1109 
	`SLSI_WARN_NODEV
("Error ipv6†inklv\n");

1111 ià(
h®_»q
->
£rviû_Çme_Ën
) {

1112 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

1113 ià(
»t
)

1114 
	`SLSI_WARN_NODEV
("Error‡ppend servicename TLV\n");

1116  
»t
;

1117 
	}
}

1119 
	$¦si_mlme_ndp_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1120 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
, 
u16
 
loÿl_ndp_š¡ªû_id
)

1122 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1123 
sk_buff
 *
»q
;

1124 
sk_buff
 *
cfm
;

1125 
r
 = 0, 
d©a_Ën
;

1126 
boŞ
 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
 = 0;

1127 
u8
 *
loÿl_ndi
;

1128 
u16
 
ndl_vif_id
, 
r¥_code
;

1129 
Ãt_deviû
 *
d©a_dev
;

1130 
u8
 
nomac
[
ETH_ALEN
] = {0, 0, 0, 0, 0, 0};

1132 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

1133 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_iâame_locked
(
sdev
, 
h®_»q
->
ndp_içû
);

1134 ià(!
d©a_dev
)

1135 
loÿl_ndi
 = 
nomac
;

1137 
loÿl_ndi
 = 
d©a_dev
->
dev_addr
;

1139 
šşude_v6_lšk_v
 = 
	`¦si_dev_Çn_is_v6_lšk_v_šşude
();

1141 
d©a_Ën
 = 74;

1142 
d©a_Ën
 +ğ
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
 ? 4 + hal_req->app_info.ndp_app_info_len : 0;

1143 
d©a_Ën
 +ğ
šşude_v6_lšk_v
 ? 4 + 8 : 0;

1144 
d©a_Ën
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? 4 + hal_req->service_name_len : 0;

1145 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

1146 
u16
 
Ëngth
;

1148 
Ëngth
 = 
	`¦si_mlme_Çn_£rviû_šfo_v_Ëngth
(&
h®_»q
->
­p_šfo
);

1149 
d©a_Ën
 +ğ(
Ëngth
 + 1);

1150 
šşude_£rviû_šfo_v
 = 1;

1153 
»q
 = 
	`çpi_®loc
(
mlme_ndp_»¥Ú£_»q
, 
MLME_NDP_RESPONSE_REQ
, 
ndev_vif
->
iâum
, 
d©a_Ën
);

1154 ià(!
»q
) {

1155 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1156  -
ENOMEM
;

1158 ià(
h®_»q
->
ndp_š¡ªû_id
)

1159 
ndl_vif_id
 = 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
h®_»q
->
ndp_š¡ªû_id
 - 1];

1161 
ndl_vif_id
 = 0;

1162 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
ndl_vif_šdex
, 
ndl_vif_id
);

1163 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
»que¡_id
, 
loÿl_ndp_š¡ªû_id
);

1164 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
loÿl_ndp_š‹rçû_add»ss
, 
loÿl_ndi
);

1165 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
ndp_š¡ªû_id
, 
h®_»q
->ndp_instance_id);

1167 
r¥_code
 = 
h®_»q
->r¥_cod=ğ
NAN_DP_REQUEST_ACCEPT
 ? 
FAPI_REASONCODE_NDP_ACCEPTED
 :

1168 
FAPI_REASONCODE_NDP_REJECTED
;

1169 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
»asÚ_code
, 
r¥_code
);

1170 
r
 = 
	`¦si_mlme_ndp_»¥Ú£_çpi_d©a
(
»q
, 
h®_»q
, 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
, 
loÿl_ndi
);

1171 ià(
r
) {

1172 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

1173 
	`kä“_skb
(
»q
);

1174  -
EINVAL
;

1177 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NDP_RESPONSE_CFM
);

1178 ià(!
cfm
)

1179  -
EIO
;

1181 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»¥Ú£_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1182 
	`SLSI_NET_ERR
(
dev
, "MLME_NDP_RESPONSE_CFM(res:0x%04x)\n",

1183 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»que¡_cfm
.
»suÉ_code
));

1184 
r
 = -
EINVAL
;

1185 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
h®_»q
->
ndp_š¡ªû_id
, 
çl£
);

1187 ià(
r¥_code
 =ğ
FAPI_REASONCODE_NDP_REJECTED
)

1188 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
h®_»q
->
ndp_š¡ªû_id
, 
çl£
);

1192 ià(
h®_»q
->
ndp_š¡ªû_id
 && 
r¥_code
 =ğ
FAPI_REASONCODE_NDP_ACCEPTED
) {

1193 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
ndp_ndi
[
h®_»q
->
ndp_š¡ªû_id
 - 1], 
loÿl_ndi
);

1194 ià(
d©a_dev
) {

1195 
Ãtdev_vif
 *
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

1197 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

1198 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1199 
ndev_d©a_vif
->
Çn
.
ndp_couÁ
++;

1200 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1205 
	`kä“_skb
(
cfm
);

1206  
r
;

1207 
	}
}

1209 
	$¦si_mlme_ndp_‹rmš©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, u16 
Œª§ùiÚ_id
)

1211 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1212 
sk_buff
 *
»q
;

1213 
sk_buff
 *
cfm
;

1215 ià(
ndev_vif
->
Çn
.
ndp_¡©e
[
ndp_š¡ªû_id
 - 1] !ğ
ndp_¦Ù_¡©us_š_u£
) {

1216 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

1220 
»q
 = 
	`çpi_®loc
(
mlme_ndp_‹rmš©e_»q
, 
MLME_NDP_TERMINATE_REQ
, 
ndev_vif
->
iâum
, 0);

1221 ià(!
»q
) {

1222 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1223  -
ENOMEM
;

1226 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_‹rmš©e_»q
.
ndp_š¡ªû_id
,‚dp_instance_id);

1227 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NDP_TERMINATE_CFM
);

1228 ià(!
cfm
) {

1229 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

1230  -
EIO
;

1233 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_‹rmš©e_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1234 
	`SLSI_NET_ERR
(
dev
, "MLME_NDP_TERMINATE_CFM(res:0x%04x)\n",

1235 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_‹rmš©e_cfm
.
»suÉ_code
));

1236 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

1239 
	`kä“_skb
(
cfm
);

1241 
	}
}

1243 
	$¦si_mlme_Çn_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
,

1244 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
)

1246 
sk_buff
 *
»q
;

1247 
sk_buff
 *
rx
;

1248 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1249 
r
 = 0, 
i
;

1251 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1252 
»q
 = 
	`çpi_®loc
(
mlme_Çn_¿nge_»q
, 
MLME_NAN_RANGE_REQ
, 0, 
couÁ
 * (
SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
 + 4));

1253 ià(!
»q
) {

1254 
	`SLSI_ERR
(
sdev
, "çedØ®loø%zd\n", 
couÁ
 * (
SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
 + 4));

1255  -
ENOMEM
;

1257 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "couÁ:%d\n", 
couÁ
);

1259 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_¿nge_»q
.
vif
, 
ndev_vif
->
iâum
);

1260 
i
 = 0; i < 
couÁ
; i++) {

1261 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_NAN_RTT_CONFIG
);

1262 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
);

1263 
	`çpi_­³nd_d©a
(
»q
, 
Æ_¹t_·¿ms
[
i
].
³”_addr
, 
ETH_ALEN
);

1264 
	`çpi_­³nd_d©a_u8
(
»q
, 
Æ_¹t_·¿ms
[
i
].
num_äames_³r_bur¡
);

1265 
	`çpi_­³nd_d©a_u8
(
»q
, 
Æ_¹t_·¿ms
[
i
].
bur¡_du¿tiÚ
);

1266 
	`çpi_­³nd_d©a_u8
(
»q
, 
Æ_¹t_·¿ms
[
i
].
num_»Œ›s_³r_ámr
);

1268 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_RANGE_CFM
);

1269 ià(!
rx
)

1270  -
EIO
;

1271 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_Çn_¿nge_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1272 
	`SLSI_ERR
(
sdev
, "mlme_nan_range_cfm(ERROR:0x%04x)",

1273 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_Çn_¿nge_cfm
.
»suÉ_code
));

1274 
r
 = -
EINVAL
;

1277 
	`kä“_skb
(
rx
);

1278  
r
;

1279 
	}
}

1281 
boŞ
 
	$¦si_Çn_¿nge_ÿnûl_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

1283 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_¿nge_ÿnûl_cfm
.
»suÉ_code
);

1284 
boŞ
 
r
 = 
çl£
;

1286 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1288 ià(
	`WARN_ON
(!
dev
))

1289 
ex™
;

1291 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

1292 
r
 = 
Œue
;

1294 
	`SLSI_NET_ERR
(
dev
, "mlme_Çn_¿nge_ÿnûl_cfmÔesuÉ:0x%04xèERROR\n", 
»suÉ
);

1296 
ex™
:

1297 
	`kä“_skb
(
cfm
);

1298  
r
;

1299 
	}
}

1301 
	$¦si_mlme_Çn_¿nge_ÿnûl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1303 
sk_buff
 *
»q
;

1304 
sk_buff
 *
rx
;

1305 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1306 
r
 = 0;

1308 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1310 
»q
 = 
	`çpi_®loc
(
mlme_Çn_¿nge_ÿnûl_»q
, 
MLME_NAN_RANGE_CANCEL_REQ
, 0, 0);

1311 ià(!
»q
) {

1312 
	`SLSI_ERR
(
sdev
, "failedo‡lloc cancel„eq\n");

1313  -
ENOMEM
;

1316 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_¿nge_ÿnûl_»q
.
vif
, 
ndev_vif
->
iâum
);

1318 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_RANGE_CANCEL_CFM
, 
MLME_NAN_RANGE_CANCELLED_IND
, 
¦si_Çn_¿nge_ÿnûl_cfm_v®id©e
);

1319 ià(!
rx
) {

1320 
	`SLSI_NET_ERR
(
dev
, "mlme_nan_range_cancel_cfm() ERROR\n");

1321 
r
 = -
EINVAL
;

1323 
	`kä“_skb
(
rx
);

1324  
r
;

1325 
	}
}

	@netif.c

7 
	~<lšux/Ãtdeviû.h
>

8 
	~<lšux/‘h”deviû.h
>

9 
	~<lšux/¹Ãšk.h
>

10 
	~<Ãt/sch_g’”ic.h
>

11 
	~<lšux/if_‘h”.h
>

12 
	~<scsc/scsc_logršg.h
>

14 
	~"debug.h
"

15 
	~"Ãtif.h
"

16 
	~"dev.h
"

17 
	~"mgt.h
"

18 #iâdeà
CONFIG_SCSC_WLAN_TX_API


19 
	~"scsc_wifi_fcq.h
"

21 
	~"ioùl.h
"

22 
	~"mib.h
"

23 
	~"mlme.h
"

24 
	~"h4_§m¶”.h
"

26 #ifdeà
CONFIG_SCSC_WLAN_TX_API


27 
	~"tx_­i.h
"

30 
	#IP4_OFFSET_TO_TOS_FIELD
 1

	)

31 
	#IP6_OFFSET_TO_TC_FIELD_0
 0

	)

32 
	#IP6_OFFSET_TO_TC_FIELD_1
 1

	)

33 
	#FIELD_TO_DSCP
 2

	)

37 
	#DSCP_VA
 0x2C

	)

39 
	#DSCP_EF
 0x2E

	)

41 
	#DSCP_AF43
 0x26

	)

42 
	#DSCP_AF42
 0x24

	)

43 
	#DSCP_AF41
 0x22

	)

44 
	#DSCP_AF33
 0x1E

	)

45 
	#DSCP_AF32
 0x1C

	)

46 
	#DSCP_AF31
 0x1A

	)

47 
	#DSCP_AF23
 0x16

	)

48 
	#DSCP_AF22
 0x14

	)

49 
	#DSCP_AF21
 0x12

	)

50 
	#DSCP_AF13
 0x0E

	)

51 
	#DSCP_AF12
 0x0C

	)

52 
	#DSCP_AF11
 0x0A

	)

54 
	#CS7
 0x38

	)

55 
	#CS6
 0x30

	)

56 
	#CS5
 0x28

	)

57 
	#CS4
 0x20

	)

58 
	#CS3
 0x18

	)

59 
	#CS2
 0x10

	)

60 
	#CS0
 0x00

	)

62 
	#CS1
 0x08

	)

64 
	#SLSI_TX_TIMEOUT
 (5 * 
HZ
)

	)

66 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


67 #ifdeà
CONFIG_SOC_EXYNOS9630


68 
ušt
 
	gÇpi_ıu_big_ut_š_mbps
 = 100;

69 #–ià
defšed
(
CONFIG_SOC_S5E9815
è|| defšed(
CONFIG_SOC_S5E8825
)

70 
ušt
 
	gÇpi_ıu_big_ut_š_mbps
 = 50;

72 
ušt
 
	gÇpi_ıu_big_ut_š_mbps
;

74 
moduË_·¿m
(
Çpi_ıu_big_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

75 
MODULE_PARM_DESC
(
Çpi_ıu_big_ut_š_mbps
, "throughput (in Mbps)o switch NAPI‡nd RPSo Big CPU");

77 #ià
defšed
(
CONFIG_SOC_S5E9815
è|| defšed(
CONFIG_SOC_S5E8825
)

78 
ušt
 
	g½s_’abË_ut_š_mbps
 = 300;

80 
ušt
 
	g½s_’abË_ut_š_mbps
 = 400;

82 
moduË_·¿m
(
½s_’abË_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

83 
MODULE_PARM_DESC
(
½s_’abË_ut_š_mbps
, "throughput (in Mbps)oƒnable RPS");

85 #iâdeà
CONFIG_ARM


86 
boŞ
 
	gtı_ack_suµ»ssiÚ_di§bË
;

87 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_di§bË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

88 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_di§bË
, "Disable TCP‡ck suppression feature");

90 
boŞ
 
	gtı_ack_suµ»ssiÚ_di§bË_2g
;

91 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_di§bË_2g
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

92 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_di§bË_2g
, "Disable TCP‡ck suppression for only 2.4GHz band");

94 
boŞ
 
	gtı_ack_suµ»ssiÚ_mÚ™Ü
 = 
Œue
;

95 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_mÚ™Ü
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

96 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_mÚ™Ü
, "TCP‡ck suppressionhroughput monitor: Y:ƒnable (default), N: disable");

98 
ušt
 
	gtı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
 = 500;

99 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

100 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
, "Sampling interval (in ms) forhroughput monitor");

102 
ušt
 
	gtı_ack_suµ»ssiÚ_timeout
 = 16;

103 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_timeout
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

104 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_timeout
, "Timeout (in ms) before cached TCP‡ck is flushedox");

106 
ušt
 
	gtı_ack_suµ»ssiÚ_max
 = 16;

107 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_max
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

108 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_max
, "Maximum‚umber of TCP‡cks suppressed before†atest flushedox");

110 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_v”y_high
 = 100;

111 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high
, , 
S_IRUGO
 | 
S_IWUSR
);

112 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high
, "Rate (in Mbps)o‡pply very high degree of suppression");

114 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
 = 4;

115 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

116 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
, "Timeout (in ms) before cached TCP‡ck is flushed in very high„ate");

118 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
 = 20;

119 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

120 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
, "Maximum‚umber of TCP‡cks suppressed before†atest flushed in very high„ate");

122 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_high
 = 20;

123 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_high
, , 
S_IRUGO
 | 
S_IWUSR
);

124 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_high
, "Rate (in Mbps)o‡pply high degree of suppression");

126 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_high_timeout
 = 4;

127 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_high_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

128 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_high_timeout
, "Timeout (in ms) before cached TCP‡ck is flushed in high„ate");

130 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_high_acks
 = 16;

131 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_high_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

132 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_high_acks
, "Maximum‚umber of TCP‡cks suppressed before†atest flushed in high„ate");

134 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_low
 = 1;

135 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_low
, , 
S_IRUGO
 | 
S_IWUSR
);

136 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_low
, "Rate (in Mbps)o‡pply†ow degree of suppression");

138 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_low_timeout
 = 4;

139 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_low_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

140 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_low_timeout
, "Timeout (in ms) before cached TCP‡ck is flushed in†ow„ate");

142 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_low_acks
 = 10;

143 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_low_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

144 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_low_acks
, "Maximum‚umber of TCP‡cks suppressed before†atest flushed in†ow„ate");

146 
ušt
 
	gtı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
 = 512;

147 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

148 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
, "Maximum‚umber of Acks sent in slow start");

150 
ušt
 
	gtı_ack_suµ»ssiÚ_rcv_wšdow
 = 128;

151 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_rcv_wšdow
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

152 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_rcv_wšdow
, "Receive window size (in unit of Kbytes)hatriggers Ack suppression");

154 
boŞ
 
	gtı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
;

155 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

156 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
, "0: do‚ot suppress delay Acks (default), 1: delay Acks can be suppressed");

158 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


159 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
tim”_li¡
 *
t
);

161 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
d©a
);

163 
¦si_Ãtif_tı_ack_suµ»ssiÚ_¡¬t
(
Ãt_deviû
 *
dev
);

164 
¦si_Ãtif_tı_ack_suµ»ssiÚ_¡İ
(
Ãt_deviû
 *
dev
);

165 
sk_buff
 *
¦si_Ãtif_tı_ack_suµ»ssiÚ_pkt
(
Ãt_deviû
 *
dev
, sk_bufà*
skb
);

168 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


169 
	$¦si_Ãt_¿ndomize_nmi_ndi
(
¦si_dev
 *
sdev
)

171 
exÜ_ba£
 = 1, 
exÜ_by‹
 = 5, 
i
;

172 
u8
 
¿ndom_mac
[
ETH_ALEN
];

175 
	`SLSI_ETHER_COPY
(
¿ndom_mac
, 
sdev
->
hw_addr
);

180 
	`¦si_g‘_¿ndom_by‹s
(&
¿ndom_mac
[3], 3);

181 ià(!
	`memcmp
(&
¿ndom_mac
[3], &
sdev
->
hw_addr
[3], 3))

182 
	`¦si_g‘_¿ndom_by‹s
(&
¿ndom_mac
[3], 3);

183 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
], 
¿ndom_mac
);

185 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
][0] |= 0x02;

187 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
][3] ^= 0x80;

188 
i
 = 
SLSI_NAN_DATA_IFINDEX_START
; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

189 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
i
], 
¿ndom_mac
);

190 
sdev
->
Ãtdev_add»s£s
[
i
][0] |= 0x02;

191 
sdev
->
Ãtdev_add»s£s
[
i
][
exÜ_by‹
] ^ğ
exÜ_ba£
;

192 
exÜ_ba£
++;

196 ià(
exÜ_ba£
 > 0xf)

199 
	}
}

202 
	$¦si_mac_add»ss_š™
(
¦si_dev
 *
sdev
)

204 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "\n");

205 
	`¦si_g‘_hw_mac_add»ss
(
sdev
, sdev->
hw_addr
);

207 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "H¬dw¬MAC‡dd»s ğ%pM\n", sdev->
hw_addr
);

209 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_WLAN
], sdev->
hw_addr
);

211 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
], sdev->
hw_addr
);

213 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
][0] |= 0x02;

215 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
hw_addr
);

217 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][0] |= 0x02;

219 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][4] ^= 0x80;

221 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >ğ4 && 
	`defšed
(
CONFIG_SCSC_WIFI_NAN_ENABLE
)

222 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

223 
	`¦si_Ãt_¿ndomize_nmi_ndi
(
sdev
);

225 
	}
}

227 
šlše
 
boŞ
 
	$¦si_Ãtif_is_udp_pkt
(
sk_buff
 *
skb
)

229 ià(
	`_hdr
(
skb
)->
v”siÚ
 == 4)

230  (
	`_hdr
(
skb
)->
´ÙocŞ
 =ğ
IPPROTO_UDP
);

231 ià(
	`_hdr
(
skb
)->
v”siÚ
 == 6)

232  (
	`v6_hdr
(
skb
)->
Ãxthdr
 =ğ
NEXTHDR_UDP
);

234  
çl£
;

235 
	}
}

237 
šlše
 
	$¦si_Ãtif_£t_tid_chªge_tid
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

239 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

241 ià(
ndev_vif
->
£t_tid_©Œ
.
mode
 =ğ
SLSI_NETIF_SET_TID_OFF
)

245 ià(
skb
->
´iÜ™y
 !ğ
FAPI_PRIORITY_QOS_UP0
)

249 ià(!
	`¦si_Ãtif_is_udp_pkt
(
skb
))

252 
skb
->
´iÜ™y
 = 
ndev_vif
->
£t_tid_©Œ
.
tid
;

253 
	}
}

255 
	$¦si_Ãtif_£t_tid_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
mode
, 
u32
 
uid
, u8 
tid
)

257 
Ãtdev_vif
 *
ndev_vif
;

258 
»t
 = 0;

260 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

262 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

263 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

264 ià(!
ndev_vif
->
aùiv©ed
) {

265 
	`SLSI_NET_WARN
(
dev
, "invalid VIF\n");

266 
»t
 = -
ENODEV
;

267 
ex™
;

270 ià(
mode
 > 
SLSI_NETIF_SET_TID_ALL_UDP
) {

271 
	`SLSI_NET_WARN
(
dev
, "šv®id mod%d\n", 
mode
);

272 
»t
 = -
EINVAL
;

273 
ex™
;

276 ià(
tid
 > 
FAPI_PRIORITY_QOS_UP7
) {

277 
	`SLSI_NET_WARN
(
dev
, "šv®id TID %d\n", 
tid
);

278 
»t
 = -
EINVAL
;

279 
ex™
;

282 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "mode:%d uid:%did:%d\n", 
mode
, 
uid
, 
tid
);

283 
ndev_vif
->
£t_tid_©Œ
.
mode
 = mode;

284 
ndev_vif
->
£t_tid_©Œ
.
uid
 = uid;

285 
ndev_vif
->
£t_tid_©Œ
.
tid
 =id;

287 
ex™
:

288 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

289 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

290  
»t
;

291 
	}
}

294 
	$¦si_Ãt_İ’
(
Ãt_deviû
 *
dev
)

296 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

297 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

298 
”r
;

299 
dev_addr_z”o_check
[
ETH_ALEN
];

300 
Ãt_deviû
 *
­_dev
 = 
NULL
;

301 
Ãtdev_vif
 *
­_dev_vif
;

302 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


303 
Ãt_deviû
 *
Çn_dev
;

304 
Ãtdev_vif
 *
Çn_ndev_vif
;

306 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

307 
u8
 
mhs_Ü_du®_¡a_mac
[
ETH_ALEN
];

309 
r
 = 0;

311 ià(
	`WARN_ON
(
ndev_vif
->
is_avaabË
))

312  -
EINVAL
;

314 ià(
sdev
->
mlme_blocked
) {

315 
	`SLSI_NET_WARN
(
dev
, "Fail: called when MLME in blocked state\n");

316 
	`¦si_dump_sy¡em_”rÜ_bufãr
(
sdev
);

317  -
EIO
;

320 ià(
sdev
->
»cov”y_ç_§ã
) {

321 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
,

322 
	`m£cs_to_jiff›s
(
SLSI_SYS_ERROR_RECOVERY_TIMEOUT
));

324 ià(
r
 == 0) {

325 
	`SLSI_INFO
(
sdev
, "Fail: systemƒrror„ecovery still in…rogress\n");

326 
	`¦si_dump_sy¡em_”rÜ_bufãr
(
sdev
);

328 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

331 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl_š™
);

333 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

334 ià(!
sdev
->
Ãtdev_up_couÁ
) {

335 
	`¦si_purge_bÏckli¡
(
ndev_vif
);

336 
	`mem£t
(&
sdev
->
wake_»asÚ_¡©s
, 0, (
¦si_wÏn_driv”_wake_»asÚ_út
));

337 } ià(
sdev
->
Ãtdev_up_couÁ
 == 1) {

338 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

339 ià(
­_dev
) {

340 
­_dev_vif
 = 
	`Ãtdev_´iv
(
­_dev
);

341 ià(
­_dev_vif
->
is_avaabË
) {

342 
	`mem£t
(&
sdev
->
wake_»asÚ_¡©s
, 0, (
¦si_wÏn_driv”_wake_»asÚ_út
));

343 
	`¦si_purge_bÏckli¡
(
ndev_vif
);

348 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

350 
”r
 = 
	`¦si_¡¬t
(
sdev
, 
dev
);

351 ià(
	`WARN_ON
(
”r
)) {

352 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

353  
”r
;

356 ià(!
sdev
->
Ãtdev_up_couÁ
) {

357 
	`¦si_mac_add»ss_š™
(
sdev
);

358 
sdev
->
š™Ÿl_sÿn
 = 
Œue
;

359 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


360 
Çn_dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

361 
Çn_ndev_vif
 = 
Çn_dev
 ? 
	`Ãtdev_´iv
Òª_devè: 
NULL
;

362 ià(
Çn_ndev_vif
)

363 
	`»š™_com¶‘iÚ
(&
Çn_ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

366 
ndev_vif
->
acs
 = 
çl£
;

367 
	`mem£t
(
dev_addr_z”o_check
, 0, 
ETH_ALEN
);

368 ià((!
	`memcmp
(
dev
->
dev_addr
, 
dev_addr_z”o_check
, 
ETH_ALEN
)) ||

369 (
	`SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
è&& (!
	`memcmp
(
dev
->
dev_addr
, 
SLSI_DEFAULT_HW_MAC_ADDR
, 
ETH_ALEN
)))) {

370 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

371 ià(
	`SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
)) {

372 
	`SLSI_ETHER_COPY
(
mhs_Ü_du®_¡a_mac
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

373 
mhs_Ü_du®_¡a_mac
[2] ^= 0x80;

374 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
mhs_Ü_du®_¡a_mac
);

376 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

379 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

382 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

383 ià(!
	`SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
)) {

384 
	`SLSI_ETHER_COPY
(
dev
->
³rm_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

386 
	`SLSI_ETHER_COPY
(
mhs_Ü_du®_¡a_mac
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

387 
mhs_Ü_du®_¡a_mac
[2] ^= 0x80;

388 
	`SLSI_ETHER_COPY
(
dev
->
³rm_addr
, 
mhs_Ü_du®_¡a_mac
);

391 
	`SLSI_ETHER_COPY
(
dev
->
³rm_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

394 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

396 
	`»š™_com¶‘iÚ
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

398 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_MONITOR
) {

399 
”r
 = 
	`¦si_¡¬t_mÚ™Ü_mode
(
sdev
, 
dev
);

400 ià(
	`WARN_ON
(
”r
)) {

401 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

402 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

403  
”r
;

406 
	`SLSI_NET_INFO
(
dev
, "iâum:%d„:%d MAC:" 
MACSTR
 "\n", 
ndev_vif
->
iâum
, 
sdev
->
»cov”y_¡©us
, 
	`MAC2STR
(dev->
dev_addr
));

407 
ndev_vif
->
is_avaabË
 = 
Œue
;

408 
sdev
->
Ãtdev_up_couÁ
++;

410 #iâdeà
CONFIG_ARM


411 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_¡¬t
(
dev
);

414 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

416 
	`Ãtif_tx_¡¬t_®l_queues
(
dev
);

417 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

421 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

422 
	`SLSI_NET_INFO
(
dev
, "*#rf#„fest mode set isƒnabled.\n");

423 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAMING_ACTIVATED
, 0);

424 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_MODE
, 0);

425 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 2511, 1);

426 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_TPC_MAX_POWER_RSSI_THRESHOLD
, 0);

430 
	}
}

432 
	$¦si_Ãt_¡İ
(
Ãt_deviû
 *
dev
)

434 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

435 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

436 
r
 = 0;

438 ià(
sdev
->
»cov”y_ç_§ã
) {

439 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
,

440 
	`m£cs_to_jiff›s
(
SLSI_SYS_ERROR_RECOVERY_TIMEOUT
));

442 ià(
r
 == 0) {

443 
	`SLSI_INFO
(
sdev
, "Fail: systemƒrror„ecovery still in…rogress\n");

444 
	`¦si_dump_sy¡em_”rÜ_bufãr
(
sdev
);

446 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

449 
	`SLSI_NET_INFO
(
dev
, "iâum:%d„:%d\n", 
ndev_vif
->
iâum
, 
sdev
->
»cov”y_¡©us
);

450 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

451 
	`Ãtif_tx_¡İ_®l_queues
(
dev
);

452 
sdev
->
š™Ÿl_sÿn
 = 
çl£
;

453 
ndev_vif
->
acs
 = 
çl£
;

454 ià(!
ndev_vif
->
is_avaabË
) {

456 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "Not‡vailable\n");

457 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

460 #iâdeà
CONFIG_ARM


461 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_¡İ
(
dev
);

463 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

464 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

465 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

466 
sdev
->
®low_sw™ch_40_mhz
 = 
Œue
;

467 
sdev
->
®low_sw™ch_80_mhz
 = 
Œue
;

468 
sdev
->
acs_chªÃl_sw™ched
 = 
çl£
;

469 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

471 
	}
}

474 
	$¦si_Ãt_ioùl
(
Ãt_deviû
 *
dev
, 
iäeq
 *
rq
, 
cmd
)

476 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "IOCTL cmd:0x%.4x\n", 
cmd
);

478 ià(
cmd
 =ğ
SIOCDEVPRIVATE
 + 2) {

479  
	`¦si_ioùl
(
dev
, 
rq
, 
cmd
);

482  -
EOPNOTSUPP
;

483 
	}
}

485 
Ãt_deviû_¡©s
 *
	$¦si_Ãt_g‘_¡©s
(
Ãt_deviû
 *
dev
)

487 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

489 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "\n");

490  &
ndev_vif
->
¡©s
;

491 
	}
}

493 #iâdeà
CONFIG_WLBT_WARN_ON


494 
	$¦si_Ãtif_show_¡©s
(
Ãt_deviû
 *
dev
)

496 
Ãt_deviû_¡©s
 *
¡©s
;

498 
¡©s
 = 
	`¦si_Ãt_g‘_¡©s
(
dev
);

499 ià(!
¡©s
) {

500 
	`SLSI_NET_ERR
(
dev
, "Cª'ˆg‘ st oà%s\n", dev->
Çme
);

504 
	`SLSI_NET_INFO
(
dev
, "[tx]bytes %lu…ackets %luƒrr %lu drop %lu fifo %lu colls %lu carrier %lu comp %lu\n",

505 
¡©s
->
tx_by‹s
, sts->
tx_·ck‘s
, sts->
tx_”rÜs
, sts->
tx_drİ³d
, sts->
tx_fifo_”rÜs
,

506 
¡©s
->
cŞlisiÚs
, sts->
tx_ÿ¼›r_”rÜs
, sts->
tx_com´es£d
);

507 
	`SLSI_NET_INFO
(
dev
, "[rx]bytes %lu…ackets %luƒrr %lu drop %lu fifo %lu frame %lu comp %lu mc %lu\n",

508 
¡©s
->
rx_by‹s
, sts->
rx_·ck‘s
, sts->
rx_”rÜs
, sts->
rx_drİ³d
, sts->
tx_fifo_”rÜs
,

509 
¡©s
->
rx_äame_”rÜs
, sts->
rx_com´es£d
, sts->
muÉiÿ¡
);

510 
	}
}

512 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 6, 0))

513 
	$¦si_Ãt_tx_timeout
(
Ãt_deviû
 *
dev
, 
txqueue
)

515 
	$¦si_Ãt_tx_timeout
(
Ãt_deviû
 *
dev
)

518 ià(!
	`Ãt_¿‹lim™
())

521 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

522 
	`SLSI_NET_ERR
(
dev
, "T¿nsm™ Timed Out!!!‚am% ¡©0x%lxxq %u\n", dev->
Çme
, dev->
¡©e
, 
txqueue
);

524 
	`SLSI_NET_ERR
(
dev
, "T¿nsm™ Timed Out!!!‚am% ¡©0x%lx\n", dev->
Çme
, dev->
¡©e
);

527 
	`¦si_Ãtif_show_¡©s
(
dev
);

528 
	}
}

531 #ifdeà
CONFIG_SCSC_USE_WMM_TOS


532 
u16
 
	$¦si_g‘_´iÜ™y_äom_tos
(
u8
 *
äame
, 
u16
 
´Ùo
)

534 ià(
	`WARN_ON
(!
äame
))

535  
FAPI_PRIORITY_QOS_UP0
;

537 
´Ùo
) {

538 
ETH_P_IP
:

539  (
u16
)(((
äame
[
IP4_OFFSET_TO_TOS_FIELD
]) & 0xE0) >> 5);

541 
ETH_P_IPV6
:

542  (
u16
)((*
äame
 & 0x0E) >> 1);

545  
FAPI_PRIORITY_QOS_UP0
;

547 
	}
}

550 
u16
 
	$¦si_g‘_´iÜ™y_äom_tos_dsı
(
u8
 *
äame
, 
u16
 
´Ùo
)

552 
u8
 
dsı
;

554 ià(
	`WARN_ON
(!
äame
))

555  
FAPI_PRIORITY_QOS_UP0
;

557 
´Ùo
) {

558 
ETH_P_IP
:

559 
dsı
 = 
äame
[
IP4_OFFSET_TO_TOS_FIELD
] >> 
FIELD_TO_DSCP
;

562 
ETH_P_IPV6
:

564 
dsı
 = (((
äame
[
IP6_OFFSET_TO_TC_FIELD_0
] & 0x0F) << 4) |

565 ((
äame
[
IP6_OFFSET_TO_TC_FIELD_1
] & 0xF0è>> 4)è>> 
FIELD_TO_DSCP
;

569  
FAPI_PRIORITY_QOS_UP0
;

572 
dsı
) {

573 
CS7
:

574 
CS6
:

575  
FAPI_PRIORITY_QOS_UP7
;

576 
DSCP_EF
:

577 
DSCP_VA
:

578  
FAPI_PRIORITY_QOS_UP6
;

579 
CS5
:

580  
FAPI_PRIORITY_QOS_UP5
;

581 
DSCP_AF41
:

582 
DSCP_AF42
:

583 
DSCP_AF43
:

584 
CS4
:

585 
DSCP_AF31
:

586 
DSCP_AF32
:

587 
DSCP_AF33
:

588 
CS3
:

589  
FAPI_PRIORITY_QOS_UP4
;

590 
DSCP_AF21
:

591 
DSCP_AF22
:

592 
DSCP_AF23
:

593  
FAPI_PRIORITY_QOS_UP3
;

594 
CS2
:

595 
DSCP_AF11
:

596 
DSCP_AF12
:

597 
DSCP_AF13
:

598 
CS0
:

599  
FAPI_PRIORITY_QOS_UP0
;

600 
CS1
:

601  
FAPI_PRIORITY_QOS_UP1
;

603  
FAPI_PRIORITY_QOS_UP0
;

605 
	}
}

608 
boŞ
 
	$¦si_Ãt_downg¿de_ac
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

610 
	`SLSI_UNUSED_PARAMETER
(
dev
);

612 
skb
->
´iÜ™y
) {

615 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP5
;

616  
Œue
;

619 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP3
;

620  
Œue
;

623 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP2
;

624  
Œue
;

626  
çl£
;

628 
	}
}

630 
u8
 
	$¦si_Ãt_up_to_ac_m­pšg
(
u8
 
´iÜ™y
)

632 
´iÜ™y
) {

633 
FAPI_PRIORITY_QOS_UP6
:

634 
FAPI_PRIORITY_QOS_UP7
:

635  
	`BIT
(
FAPI_PRIORITY_QOS_UP6
è| BIT(
FAPI_PRIORITY_QOS_UP7
);

636 
FAPI_PRIORITY_QOS_UP4
:

637 
FAPI_PRIORITY_QOS_UP5
:

638  
	`BIT
(
FAPI_PRIORITY_QOS_UP4
è| BIT(
FAPI_PRIORITY_QOS_UP5
);

639 
FAPI_PRIORITY_QOS_UP0
:

640 
FAPI_PRIORITY_QOS_UP3
:

641  
	`BIT
(
FAPI_PRIORITY_QOS_UP0
è| BIT(
FAPI_PRIORITY_QOS_UP3
);

643  
	`BIT
(
FAPI_PRIORITY_QOS_UP1
è| BIT(
FAPI_PRIORITY_QOS_UP2
);

645 
	}
}

647 
¦si_Œaffic_q
 
	$¦si_äame_´iÜ™y_to_ac_queue
(
u16
 
´iÜ™y
)

649 
´iÜ™y
) {

650 
FAPI_PRIORITY_QOS_UP0
:

651 
FAPI_PRIORITY_QOS_UP3
:

652  
SLSI_TRAFFIC_Q_BE
;

653 
FAPI_PRIORITY_QOS_UP1
:

654 
FAPI_PRIORITY_QOS_UP2
:

655  
SLSI_TRAFFIC_Q_BK
;

656 
FAPI_PRIORITY_QOS_UP4
:

657 
FAPI_PRIORITY_QOS_UP5
:

658  
SLSI_TRAFFIC_Q_VI
;

659 
FAPI_PRIORITY_QOS_UP6
:

660 
FAPI_PRIORITY_QOS_UP7
:

661  
SLSI_TRAFFIC_Q_VO
;

663  
SLSI_TRAFFIC_Q_BE
;

665 
	}
}

667 
	$¦si_ac_to_tids
(
¦si_Œaffic_q
 
ac
, *
tids
)

669 
ac
) {

670 
SLSI_TRAFFIC_Q_BE
:

671 
tids
[0] = 
FAPI_PRIORITY_QOS_UP0
;

672 
tids
[1] = 
FAPI_PRIORITY_QOS_UP3
;

675 
SLSI_TRAFFIC_Q_BK
:

676 
tids
[0] = 
FAPI_PRIORITY_QOS_UP1
;

677 
tids
[1] = 
FAPI_PRIORITY_QOS_UP2
;

680 
SLSI_TRAFFIC_Q_VI
:

681 
tids
[0] = 
FAPI_PRIORITY_QOS_UP4
;

682 
tids
[1] = 
FAPI_PRIORITY_QOS_UP5
;

685 
SLSI_TRAFFIC_Q_VO
:

686 
tids
[0] = 
FAPI_PRIORITY_QOS_UP6
;

687 
tids
[1] = 
FAPI_PRIORITY_QOS_UP7
;

691  -
EINVAL
;

695 
	}
}

697 
	$¦si_Ãt_downg¿de_´i
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

698 
sk_buff
 *
skb
)

703 
	`uÆik–y
(
³”
->
wmm_acm
 & 
	`BIT
(
skb
->
´iÜ™y
)) &&

704 !(
³”
->
t¥ec_e¡ablished
 & 
	`¦si_Ãt_up_to_ac_m­pšg
(
skb
->
´iÜ™y
))) {

705 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_NETDEV
, "Downg¿dšg from UP:%d\n", 
skb
->
´iÜ™y
);

706 ià(!
	`¦si_Ãt_downg¿de_ac
(
dev
, 
skb
))

709 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "TØUP:%d\n", 
skb
->
´iÜ™y
);

710 
	}
}

712 #iâdeà
CONFIG_SCSC_WLAN_TX_API


713 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

714 
u16
 
	$¦si_Ãt_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, Ãt_deviû *
sb_dev
)

715 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

716 
u16
 
	$¦si_Ãt_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, Ãt_deviû *
sb_dev
, 
£Ëù_queue_çÎback_t
 
çÎback
)

718 
u16
 
	$¦si_Ãt_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, *
acûl_´iv
, 
£Ëù_queue_çÎback_t
 
çÎback
)

721 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

722 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

723 
u16
 
Ãtif_q
 = 0;

724 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
skb
->
d©a
;

725 
´Ùo
 = 0;

726 
¦si_³”
 *
³”
;

727 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

728 ()
sb_dev
;

730 ()
acûl_´iv
;

732 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(5, 4, 0))

733 ()
çÎback
;

735 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "\n");

738 ià(!
	`skb_mac_h—d”_was_£t
(
skb
))

739 
	`skb_»£t_mac_h—d”
(
skb
);

741 ià(
	`is_z”o_‘h”_addr
(
ehdr
->
h_sourû
)) {

742 
	`SLSI_NET_WARN
(
dev
, "šv®id sourû‡dd»s (¤c:" 
MACSTR
 ")\n", 
	`MAC2STR
(
ehdr
->
h_sourû
));

743 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

744  
SLSI_NETIF_Q_DISCARD
;

747 
´Ùo
 = 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
);

749 
´Ùo
) {

753 
ETH_P_PAE
:

754 
ETH_P_WAI
:

755 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
,

757  
SLSI_NETIF_Q_PRIORITY
;

758 
ETH_P_ARP
:

759 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "ARP frame. ARP Queue Selected\n");

760  
SLSI_NETIF_Q_ARP
;

761 
ETH_P_IP
:

762 ià(
	`¦si_is_dhı_·ck‘
(
skb
->
d©a
è=ğ
SLSI_TX_IS_NOT_DHCP
)

764 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
,

766  
SLSI_NETIF_Q_PRIORITY
;

769 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

771 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

772 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "Multicast AC queue will be selected\n");

773 #ifdeà
CONFIG_SCSC_USE_WMM_TOS


774 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

776 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos_dsı
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

778  
	`¦si_Ãtif_g‘_muÉiÿ¡_queue
(
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
));

781 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

782 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
ehdr
->
h_de¡
);

783 ià(!
³”
) {

784 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "Disÿrd: P“¸%pM NOT found\n", 
ehdr
->
h_de¡
);

785 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

786  
SLSI_NETIF_Q_DISCARD
;

789 ià(
³”
->
qos_’abËd
) {

790 ià(
³”
->
qos_m­_£t
) {

791 
skb
->
´iÜ™y
 = 
	`cfg80211_şassify8021d
(skb, &
³”
->
qos_m­
);

793 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


794 ià((
´Ùo
 =ğ
ETH_P_IP
 && 
	`¦si_is_dns_·ck‘
(
skb
->
d©a
)) ||

795 (
´Ùo
 =ğ
ETH_P_IP
 && 
	`¦si_is_mdns_·ck‘
(
skb
->
d©a
)) ||

796 (
´Ùo
 =ğ
ETH_P_IP
 && 
	`¦si_is_tı_sync_·ck‘
(
dev
, 
skb
))) {

797 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP7
;

801 #ifdeà
CONFIG_SCSC_USE_WMM_TOS


802 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

804 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos_dsı
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

808 
	`¦si_Ãtif_£t_tid_chªge_tid
(
dev
, 
skb
);

810 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP0
;

813 
	`¦si_Ãt_downg¿de_´i
(
dev
, 
³”
, 
skb
);

815 
Ãtif_q
 = 
	`¦si_Ãtif_g‘_³”_queue
(
³”
->
queue£t
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
));

816 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "´io:%d queue:%u\n", 
skb
->
´iÜ™y
, 
Ãtif_q
);

817 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

818  
Ãtif_q
;

819 
	}
}

822 #iâdeà
CONFIG_SCSC_WLAN_TX_API


823 
	$¦si_tdls_move_·ck‘s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

824 
¦si_³”
 *
¡a_³”
, ¦si_³” *
tdls_³”
, 
boŞ
 
cÚÃùiÚ
)

826 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

827 
sk_buff
 *
skb
 = 
NULL
;

828 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

829 
sk_buff
 *
skb_to_ä“
 = 
NULL
;

831 
‘hhdr
 *
ehdr
;

832 
Qdisc
 *
qd
;

833 
u32
 
num_pkts
;

834 
u16
 
¡aq
;

835 
u16
 
tdlsq
;

836 
u16
 
Ãtq
;

837 
u16
 
i
;

838 
u16
 
j
;

839 
šdex
;

840 
¦si_tı_ack_s
 *
tı_ack
;

843 
¡aq
 = 
	`¦si_Ãtif_g‘_³”_queue
(
¡a_³”
->
queue£t
, 0);

844 
tdlsq
 = 
	`¦si_Ãtif_g‘_³”_queue
(
tdls_³”
->
queue£t
, 0);

846 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TDLS
, "Connection: %d, sta_qset: %d,dls_qset: %d, sta_netq: %d,dls_netq: %d\n",

847 
cÚÃùiÚ
, 
¡a_³”
->
queue£t
, 
tdls_³”
->queue£t, 
¡aq
, 
tdlsq
);

850 
	`¦si_tx_·u£_queues
(
sdev
);

853 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

854 
tı_ack
 = &
Ãtdev_vif
->
ack_suµ»ssiÚ
[
šdex
];

855 ià(!
tı_ack
->
¡©e
)

858 
	`skb_queue_w®k
(&
tı_ack
->
li¡
, 
skb
) {

859 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "äamš TCP Ack†i¡ (³”:%pM)\n", 
	`‘h_hdr
(
skb
)->
h_de¡
);

861 ià(
	`com·»_‘h”_addr
(
tdls_³”
->
add»ss
, 
	`‘h_hdr
(
skb
)->
h_de¡
) == 0) {

862 ià(
cÚÃùiÚ
) {

864 
skb
->
queue_m­pšg
 +ğ(
tdls_³”
->
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
);

867 
skb
->
queue_m­pšg
 -ğ(
tdls_³”
->
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
);

877 ià(
cÚÃùiÚ
)

878 
tdls_³”
->
v®id
 = 
Œue
;

880 
tdls_³”
->
v®id
 = 
çl£
;

883 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

884 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "NETQ%d: Before:dlsq_len = %d, staq_len = %d\n",

885 
i
, 
dev
->
_tx
[
tdlsq
 + i].
qdisc
->
q
.
qËn
, dev->_tx[
¡aq
 + i].qdisc->q.qlen);

887 ià(
cÚÃùiÚ
) {

889 ià(
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
->
q
.
qËn
)

890 
	`SLSI_NET_ERR
(
dev
, "tdls_cÚÃùiÚ: Pack‘…»£Á iÀqueu%d\n", 
tdlsq
 + 
i
);

892 
qd
 = 
dev
->
_tx
[
¡aq
 + 
i
].
qdisc
;

894 
num_pkts
 = 
qd
->
q
.
qËn
;

897 
j
 = 0; j < 
num_pkts
; j++) {

898 
qd
 = 
dev
->
_tx
[
¡aq
 + 
i
].
qdisc
;

900 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

901 
skb
 = 
	`skb_³ek
(&
qd
->
gso_skb
);

903 
skb
 = 
qd
->
gso_skb
;

905 ià(
skb
) {

906 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

907 
skb
 = 
	`__skb_dequeue
(&
qd
->
gso_skb
);

909 
qd
->
gso_skb
 = 
NULL
;

911 
qd
->
q
.
qËn
--;

913 
skb
 = 
qd
->
	`dequeue
(qd);

916 ià(!
skb
) {

917 
	`SLSI_NET_ERR
(
dev
, "tdls_connection: STA NETQ skb is NULL\n");

922 
Ãtq
 = 
skb
->
queue_m­pšg
;

923 
ehdr
 = (
‘hhdr
 *)
skb
->
d©a
;

924 ià(
	`com·»_‘h”_addr
(
tdls_³”
->
add»ss
, 
ehdr
->
h_de¡
) == 0) {

925 
Ãtq
 +ğ(
tdls_³”
->
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
);

926 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TDLS
, "NETQ%d: Queue mapping changed from %do %d\n",

927 
i
, 
skb
->
queue_m­pšg
, 
Ãtq
);

928 
	`skb_£t_queue_m­pšg
(
skb
, 
Ãtq
);

931 
qd
 = 
dev
->
_tx
[
Ãtq
].
qdisc
;

932 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

933 
qd
->
	`’queue
(
skb
, qd, &
skb_to_ä“
);

936 
qd
->
	`’queue
(
skb
, qd);

940 
num_pkts
 = 
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
->
q
.
qËn
;

942 
j
 = 0; j < 
num_pkts
; j++) {

944 
qd
 = 
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
;

945 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

946 
skb
 = 
	`skb_³ek
(&
qd
->
gso_skb
);

948 
skb
 = 
qd
->
gso_skb
;

950 ià(
skb
) {

951 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

952 
skb
 = 
	`__skb_dequeue
(&
qd
->
gso_skb
);

954 
qd
->
gso_skb
 = 
NULL
;

956 
qd
->
q
.
qËn
--;

958 
skb
 = 
qd
->
	`dequeue
(qd);

961 ià(!
skb
) {

962 
	`SLSI_NET_ERR
(
dev
, "tdls_teardown: TDLS NETQ skb is NULL\n");

967 
	`skb_£t_queue_m­pšg
(
skb
, 
¡aq
 + 
i
);

970 
qd
 = 
dev
->
_tx
[
¡aq
 + 
i
].
qdisc
;

971 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

972 
qd
->
	`’queue
(
skb
, qd, &
skb_to_ä“
);

975 
qd
->
	`’queue
(
skb
, qd);

979 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "NETQ%d: After :dlsq_len = %d, staq_len = %d\n",

980 
i
, 
dev
->
_tx
[
tdlsq
 + i].
qdisc
->
q
.
qËn
, dev->_tx[
¡aq
 + i].qdisc->q.qlen);

982 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

983 ià(
	`uÆik–y
(
skb_to_ä“
))

984 
	`kä“_skb_li¡
(
skb_to_ä“
);

988 ià(!
cÚÃùiÚ
)

989 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

990 ià(
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
->
q
.
qËn
)

991 
	`SLSI_NET_ERR
(
dev
, "tdls_‹¬down: Pack‘…»£Á iÀNET queu%d\n", 
tdlsq
 + 
i
);

995 
	`¦si_tx_uÅau£_queues
(
sdev
);

996 
	}
}

1034 
Ãtdev_tx_t
 
	$¦si_Ãt_hw_xm™
(
sk_buff
 *
skb
, 
Ãt_deviû
 *
dev
)

1036 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1037 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1038 
r
 = 
NETDEV_TX_OK
;

1039 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1040 
known_u£rs
 = 0;

1047 
·ck‘_Ën
 = 
skb
->
Ën
;

1048 
¦si_Œaffic_q
 
Œaffic_q
 = 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
);

1050 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

1058 ià((
ušŒ_t
)
skb
->
d©a
 & 0x1) {

1059 
sk_buff
 *
skb2
 = 
NULL
;

1063 
skb2
 = 
	`skb_cİy_ex·nd
(
skb
, 
SLSI_NETIF_SKB_HEADROOM
, 
	`skb_room
(skb), 
GFP_ATOMIC
);

1064 ià(
skb2
 && (!(((
ušŒ_t
)skb2->
d©a
) & 0x1))) {

1065 
	`cÚsume_skb
(
skb
);

1066 
skb
 = 
skb2
;

1067 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "Oddly‡ligned skb„ealigned\n");

1070 
	`SLSI_NET_WARN
(
dev
, "Oddly‡ligned skb failed„ealignment, dropping\n");

1071 ià(
skb2
) {

1072 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "skb_copy_expand didn't‡lign for us\n");

1073 
	`kä“_skb
(
skb2
);

1075 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "skb_copy_expand failed whenryingo‡lign\n");

1077 
r
 = -
EFAULT
;

1078 
ev®u©e
;

1087 ià(!
	`skb_mac_h—d”_was_£t
(
skb
))

1088 
	`skb_»£t_mac_h—d”
(
skb
);

1090 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "PrÙØ0x%.4X\n", 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
));

1092 ià(!
ndev_vif
->
is_avaabË
) {

1093 
	`SLSI_NET_WARN
(
dev
, "vif NOT‡vailable\n");

1094 
r
 = -
EFAULT
;

1095 
ev®u©e
;

1098 #iâdeà
CONFIG_SCSC_WLAN_TX_API


1099 ià(
skb
->
queue_m­pšg
 =ğ
SLSI_NETIF_Q_DISCARD
) {

1100 
	`SLSI_NET_WARN
(
dev
, "Discard Queue :: Packet Dropped\n");

1101 
r
 = -
EIO
;

1102 
ev®u©e
;

1106 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1107 ià(
	`¦si_tx_g‘_·ck‘_ty³
(
skb
è=ğ
SLSI_DATA_PKT
) {

1109 ià(
skb
->
queue_m­pšg
 !ğ
SLSI_NETIF_Q_ARP
 && skb->queue_m­pšg !ğ
SLSI_NETIF_Q_PRIORITY
) {

1111 ià(
	`skb_h—droom
(
skb
è< (
	`çpi_sig_size
(
ma_un™d©a_»q
) + 160)) {

1112 
sk_buff
 *
skb2
 = 
NULL
;

1114 
skb2
 = 
	`skb_»®loc_h—droom
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_»q
) + 160);

1115 ià(!
skb2
) {

1116 
	`SLSI_NET_WARN
(
dev
, "alloc SKB headroom failed, drop Tx…kt\n");

1117 
r
 = -
EFAULT
;

1118 
ev®u©e
;

1121 
	`cÚsume_skb
(
skb
);

1122 
skb
 = 
skb2
;

1126 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1127 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

1128 
known_u£rs
 = 
	`»fcouÁ_»ad
(&
skb
->
u£rs
);

1130 
known_u£rs
 = 
	`©omic_»ad
(&
skb
->
u£rs
);

1134 #iâdeà
CONFIG_ARM


1135 
skb
 = 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_pkt
(
dev
, skb);

1136 ià(!
skb
) {

1137 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1138  
NETDEV_TX_OK
;

1143 
r
 = 
	`¦si_tx_d©a
(
sdev
, 
dev
, 
skb
);

1144 
ev®u©e
:

1145 ià(
r
 == 0) {

1147 
ndev_vif
->
tx_·ck‘s
[
Œaffic_q
]++;

1148 
ndev_vif
->
¡©s
.
tx_·ck‘s
++;

1149 
ndev_vif
->
¡©s
.
tx_by‹s
 +ğ
·ck‘_Ën
;

1150 
r
 = 
NETDEV_TX_OK
;

1164 ià(
r
 =ğ-
ENOSPC
) {

1166 
ndev_vif
->
¡©s
.
tx_fifo_”rÜs
++;

1168 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1169 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

1170 
	`WARN_ON
(
known_u£rs
 && 
	`»fcouÁ_»ad
(&
skb
->
u£rs
) != known_users);

1172 
	`WARN_ON
(
known_u£rs
 && 
	`©omic_»ad
(&
skb
->
u£rs
) != known_users);

1175 
	`kä“_skb
(
skb
);

1176 
ndev_vif
->
¡©s
.
tx_drİ³d
++;

1186 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1187  
r
;

1188 
	}
}

1190 
Ãtdev_ã©u»s_t
 
	$¦si_Ãt_fix_ã©u»s
(
Ãt_deviû
 *
dev
, 
Ãtdev_ã©u»s_t
 
ã©u»s
)

1192 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1194 #ifdeà
CONFIG_SCSC_WLAN_SG


1195 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX
, "Scatter-gather‡nd GSOƒnabled\n");

1196 
ã©u»s
 |ğ
NETIF_F_SG
;

1197 
ã©u»s
 |ğ
NETIF_F_GSO
;

1200 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


1201 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX
, "NAPI Rx GROƒnabled\n");

1202 
ã©u»s
 |ğ
NETIF_F_GRO
;

1204 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX
, "NAPI Rx GRO disabled\n");

1205 
ã©u»s
 &ğ~
NETIF_F_GRO
;

1207  
ã©u»s
;

1208 
	}
}

1210 
	$¦si_£t_muÉiÿ¡_li¡
(
Ãt_deviû
 *
dev
)

1212 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1213 
u8
 
couÁ
, 
i
 = 0;

1214 
u8
 
mdns_addr
[
ETH_ALEN
] = { 0x01, 0x00, 0x5E, 0x00, 0x00, 0xFB };

1215 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1216 
u8
 
mdns6_addr
[
ETH_ALEN
] = { 0x33, 0x33, 0x00, 0x00, 0x00, 0xFB };

1217 cÚ¡ 
u8
 
sŞic™ed_node_addr
[
ETH_ALEN
] = { 0x33, 0x33, 0xff, 0x00, 0x00, 0x01 };

1218 
u8
 
v6addr_suffix
[3];

1220 
u8
 
mc_addr_´efix
[3] = { 0x01, 0x00, 0x5e };

1222 
Ãtdev_hw_addr
 *
ha
;

1224 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

1227 ià(!
ndev_vif
->
is_avaabË
) {

1228 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "vif NOT‡vailable\n");

1232 
couÁ
 = 
	`Ãtdev_mc_couÁ
(
dev
);

1233 ià(!
couÁ
) {

1234 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
 = 0;

1238 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1239 
	`¦si_¥šlock_lock
(&
ndev_vif
->
v6addr_lock
);

1240 
	`memıy
(
v6addr_suffix
, &
ndev_vif
->
v6add»ss
.
s6_addr
[13], 3);

1241 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
v6addr_lock
);

1244 
	`¦si_¥šlock_lock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

1245 
	`Ãtdev_fÜ_—ch_mc_addr
(
ha
, 
dev
) {

1246 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1247 ià((!
	`memcmp
(
ha
->
addr
, 
mdns_addr
, 
ETH_ALEN
)) ||

1248 (!
	`memcmp
(
ha
->
addr
, 
mdns6_addr
, 
ETH_ALEN
)) ||

1249 (!
	`memcmp
(
ha
->
addr
, 
sŞic™ed_node_addr
, 3) &&

1250 !
	`memcmp
(&
ha
->
addr
[3], 
v6addr_suffix
, 3))) {

1252 ià((!
	`memcmp
(
ha
->
addr
, 
mdns_addr
, 
ETH_ALEN
)) ||

1253 (
	`memcmp
(
ha
->
addr
, 
mc_addr_´efix
, 3))) {

1255 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_NETDEV
, "Drİ MAC %pM\n", 
ha
->
addr
);

1258 ià(
i
 =ğ
SLSI_MC_ADDR_ENTRY_MAX
) {

1259 
	`SLSI_NET_WARN
(
dev
, "MAC†i¡ ha »ached max†im™ (%d),‡ùu® couÁ %d\n", 
SLSI_MC_ADDR_ENTRY_MAX
, 
couÁ
);

1263 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_NETDEV
, "idx %d MAC %pM\n", 
i
, 
ha
->
addr
);

1264 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
++], 
ha
->
addr
);

1266 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
 = 
i
;

1267 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

1269 
	`¦si_wake_lock
(&
ndev_vif
->
sdev
->
wÏn_wl
);

1270 
	`scheduË_wÜk
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

1271 
	}
}

1273 
	$¦si_£t_mac_add»ss
(
Ãt_deviû
 *
dev
, *
addr
)

1275 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1276 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1277 
sockaddr
 *
§
 = (sockadd¸*)
addr
;

1279 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "%pM\n", 
§
->
§_d©a
);

1280 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
§
->
§_d©a
);

1281 
sdev
->
mac_chªged
 = 
Œue
;

1282 
ndev_vif
->
add»ss
 = 0;

1287 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

1288 
sdev
->
š™Ÿl_sÿn
 = 
Œue
;

1290 
	}
}

1292 cÚ¡ 
Ãt_deviû_İs
 
	g¦si_Ãtdev_İs
 = {

1293 .
ndo_İ’
 = 
¦si_Ãt_İ’
,

1294 .
	gndo_¡İ
 = 
¦si_Ãt_¡İ
,

1295 .
	gndo_¡¬t_xm™
 = 
¦si_Ãt_hw_xm™
,

1296 .
	gndo_do_ioùl
 = 
¦si_Ãt_ioùl
,

1297 #iâdeà
CONFIG_WLBT_WARN_ON


1298 .
	gndo_tx_timeout
 = 
¦si_Ãt_tx_timeout
,

1300 .
	gndo_g‘_¡©s
 = 
¦si_Ãt_g‘_¡©s
,

1301 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1302 .
	gndo_£Ëù_queue
 = 
¦si_tx_£Ëù_queue
,

1304 .
	gndo_£Ëù_queue
 = 
¦si_Ãt_£Ëù_queue
,

1306 .
	gndo_fix_ã©u»s
 = 
¦si_Ãt_fix_ã©u»s
,

1307 .
	gndo_£t_rx_mode
 = 
¦si_£t_muÉiÿ¡_li¡
,

1308 .
	gndo_£t_mac_add»ss
 = 
¦si_£t_mac_add»ss
,

1311 
	$¦si_if_£tup
(
Ãt_deviû
 *
dev
)

1313 
	`‘h”_£tup
(
dev
);

1314 
dev
->
Ãtdev_İs
 = &
¦si_Ãtdev_İs
;

1315 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 9))

1316 
dev
->
Ãeds_ä“_Ãtdev
 = 
Œue
;

1318 
dev
->
de¡ruùÜ
 = 
ä“_Ãtdev
;

1320 #iâdeà
CONFIG_WLBT_WARN_ON


1321 
dev
->
w©chdog_timeo
 = 
SLSI_TX_TIMEOUT
;

1323 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1324 
	`¦si_tx_£tup_Ãt_deviû
(
dev
);

1326 
	}
}

1328 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1329 #ià
defšed
(
CONFIG_SOC_EXYNOS9610
è|| defšed(
CONFIG_SOC_EXYNOS3830
)

1330 
	#SCSC_NETIF_NAPI_CPU_BIG
 7

	)

1331 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "70"

	)

1332 #–ià
defšed
(
CONFIG_SOC_S5E9815
)

1333 
	#SCSC_NETIF_NAPI_CPU_BIG
 4

	)

1334 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "60"

	)

1335 #–ià
defšed
(
CONFIG_SOC_EXYNOS9630
è|| defšed(
CONFIG_SOC_S5E8825
)

1336 
	#SCSC_NETIF_NAPI_CPU_BIG
 7

	)

1337 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "40"

	)

1338 #–ià
defšed
(
CONFIG_SOC_EXYNOS7885
)

1339 
	#SCSC_NETIF_NAPI_CPU_BIG
 0

	)

1340 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "40"

	)

1342 
	#SCSC_NETIF_NAPI_CPU_BIG
 0

	)

1343 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "0"

	)

1346 #ià
defšed
(
CONFIG_SOC_EXYNOS3830
)

1347 
	#SCSC_NETIF_RPS_CPUS_MASK
 "ã"

	)

1349 
	#SCSC_NETIF_RPS_CPUS_MASK
 "0"

	)

1353 
	$¦si_Ãtif_½s_m­_ş—r
(
Ãt_deviû
 *
dev
)

1355 
½s_m­
 *
m­
;

1357 
m­
 = 
	`rcu_d”eã»nû_´Ùeùed
(
dev
->
_rx
->
½s_m­
, 1);

1358 ià(
m­
) {

1359 
	`RCU_INIT_POINTER
(
dev
->
_rx
->
½s_m­
, 
NULL
);

1360 
	`kä“_rcu
(
m­
, 
rcu
);

1361 
	`SLSI_NET_INFO
(
dev
, "clear„ps_cpus map\n");

1363 
	}
}

1365 
	$¦si_Ãtif_½s_m­_£t
(
Ãt_deviû
 *
dev
, *
buf
, 
size_t
 
Ën
)

1367 
½s_m­
 *
Şd_m­
, *
m­
;

1368 
ıumask_v¬_t
 
mask
;

1369 
”r
, 
ıu
, 
i
;

1370 
	`DEFINE_SPINLOCK
(
½s_m­_lock
);

1372 ià(!
	`®loc_ıumask_v¬
(&
mask
, 
GFP_KERNEL
))

1373  -
ENOMEM
;

1375 
”r
 = 
	`b™m­_·r£
(
buf
, 
Ën
, 
	`ıumask_b™s
(
mask
), 
Ä_ıumask_b™s
);

1376 ià(
”r
) {

1377 
	`ä“_ıumask_v¬
(
mask
);

1378 
	`SLSI_NET_WARN
(
dev
, "CPU bitmap…arse failed\n");

1379  
”r
;

1382 
m­
 = 
	`kz®loc
(
	`max_t
(, 
	`RPS_MAP_SIZE
(
	`ıumask_weight
(
mask
)), 
L1_CACHE_BYTES
), 
GFP_KERNEL
);

1383 ià(!
m­
) {

1384 
	`ä“_ıumask_v¬
(
mask
);

1385 
	`SLSI_NET_WARN
(
dev
, "CPU mask‡lloc failed\n");

1386  -
ENOMEM
;

1389 
i
 = 0;

1390 
	`fÜ_—ch_ıu_ªd
(
ıu
, 
mask
, 
ıu_Úlše_mask
)

1391 
m­
->
ıus
[
i
++] = 
ıu
;

1393 ià(
i
) {

1394 
m­
->
Ën
 = 
i
;

1396 
	`kä“
(
m­
);

1397 
m­
 = 
NULL
;

1400 
	`¥š_lock
(&
½s_m­_lock
);

1401 
Şd_m­
 = 
	`rcu_d”eã»nû_´Ùeùed
(
dev
->
_rx
->
½s_m­
, 
	`lockd•_is_h–d
(&
½s_m­_lock
));

1402 
	`rcu_assign_poš‹r
(
dev
->
_rx
->
½s_m­
, 
m­
);

1403 
	`¥š_uÆock
(&
½s_m­_lock
);

1405 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

1406 ià(
m­
)

1407 
	`¡©ic_b¿nch_šc
(&
½s_Ãeded
);

1408 ià(
Şd_m­
)

1409 
	`¡©ic_b¿nch_dec
(&
½s_Ãeded
);

1411 ià(
m­
)

1412 
	`¡©ic_key_¦ow_šc
(&
½s_Ãeded
);

1413 ià(
Şd_m­
)

1414 
	`¡©ic_key_¦ow_dec
(&
½s_Ãeded
);

1417 ià(
Şd_m­
)

1418 
	`kä“_rcu
(
Şd_m­
, 
rcu
);

1420 
	`ä“_ıumask_v¬
(
mask
);

1421 
	`SLSI_NET_INFO
(
dev
, "½s_ıu m­ s‘(%s)\n", 
buf
);

1422  
Ën
;

1423 
	}
}

1425 
	$¦si_£t_muÉiÿ¡_f‹r_wÜk
(
wÜk_¡ruù
 *
d©a
)

1427 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
d©a
, Ãtdev_vif, 
£t_muÉiÿ¡_f‹r_wÜk
);

1428 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1430 ià(!
sdev
) {

1431 
	`SLSI_WARN_NODEV
("sdev is NULL\n");

1434 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1435 ià(!
ndev_vif
->
is_avaabË
 ||

1436 !
ndev_vif
->
aùiv©ed
 ||

1437 
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

1438 
ex™
;

1440 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1441 
	`SLSI_INFO_NODEV
("STA is‚ot connected!\n");

1442 
ex™
;

1444 ià(
ndev_vif
->
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1445 
	`SLSI_INFO_NODEV
("Im´İ” ifidx: %d\n", 
ndev_vif
->
iâum
);

1446 
ex™
;

1448 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1449 
	`SLSI_INFO_NODEV
("u£r_su¥’d_modğ%d\n", 
ndev_vif
->
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
);

1451 ià(
ndev_vif
->
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 == 1) {

1452 
Ãt_deviû
 *
dev
 = 
NULL
;

1453 
»t
 = 0;

1455 
dev
 = 
sdev
->
Ãtdev
[
ndev_vif
->
iâum
];

1456 ià(!
dev
) {

1457 
	`SLSI_ERR_NODEV
("Dev i NULL iâum:%d\n", 
ndev_vif
->
iâum
);

1458 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1459 
ex™
;

1461 
»t
 = 
	`¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
ndev_vif
->
sdev
, 
dev
);

1462 ià(
»t
)

1463 
	`SLSI_NET_ERR
(
dev
, "Failedo update mcast filter\n");

1465 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1466 
ex™
:

1467 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1468 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1469 
	}
}

1471 
	$¦si_upd©e_pkt_f‹r_wÜk
(
wÜk_¡ruù
 *
d©a
)

1473 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
d©a
, Ãtdev_vif, 
upd©e_pkt_f‹r_wÜk
);

1474 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1475 
Ãt_deviû
 *
dev
 = 
NULL
;

1476 
»t
 = 0;

1478 ià(!
sdev
) {

1479 
	`SLSI_WARN_NODEV
("sdev is NULL\n");

1482 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1483 ià(!
ndev_vif
->
is_avaabË
 || !ndev_vif->
aùiv©ed
 ||

1484 
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

1485 
ex™
;

1487 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1488 
	`SLSI_INFO_NODEV
("STA is‚ot connected!\n");

1489 
ex™
;

1491 ià(
ndev_vif
->
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1492 
	`SLSI_INFO_NODEV
("Im´İ” ifidx: %d\n", 
ndev_vif
->
iâum
);

1493 
ex™
;

1496 
dev
 = 
sdev
->
Ãtdev
[
ndev_vif
->
iâum
];

1497 ià(!
dev
) {

1498 
	`SLSI_ERR_NODEV
("Dev i NULL iâum:%d\n", 
ndev_vif
->
iâum
);

1499 
ex™
;

1502 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1503 
	`SLSI_INFO_NODEV
("u£r_su¥’d_modğ%d, is_İt_ouˆğ%d\n", 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
, 
ndev_vif
->
is_İt_out_·ck‘
);

1505 ià(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 =ğ1 && 
ndev_vif
->
is_İt_out_·ck‘
) {

1506 
»t
 = 
	`¦si_upd©e_·ck‘_f‹rs
(
sdev
, 
dev
);

1507 ià(
»t
)

1508 
	`SLSI_NET_ERR
(
dev
, "Failedo update_packet_filters\n");

1509 } ià(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 == 0) {

1510 
»t
 = 
	`¦si_upd©e_·ck‘_f‹rs
(
sdev
, 
dev
);

1511 ià(
»t
)

1512 
	`SLSI_NET_ERR
(
dev
, "Failedo update_packet_filters\n");

1514 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 = 1;

1515 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_LCD_ACTIVE
;

1517 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, sdev->
deviû_cÚfig
.
ho¡_¡©e
);

1518 ià(
»t
 != 0)

1519 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d", 
»t
);

1521 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1522 
ex™
:

1523 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1524 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1525 
	}
}

1527 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1528 
	$¦si_Ãtif_Œaffic_mÚ™Ü_wÜk
(
wÜk_¡ruù
 *
d©a
)

1530 
Ãt_deviû
 *
dev
;

1531 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
d©a
, Ãtdev_vif, 
Œaffic_mÚ_wÜk
);

1532 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1534 ià(!
sdev
) {

1535 
	`WARN_ON
(1);

1539 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1541 ià(!
ndev_vif
->
is_avaabË
) {

1542 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1545 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
ndev_vif
->
iâum
);

1547 
	`SLSI_NET_INFO
(
dev
, "chªg¡©tØ%d\n", 
ndev_vif
->
Œaffic_mÚ_¡©e
);

1549 ià(
Çpi_ıu_big_ut_š_mbps
 || 
½s_’abË_ut_š_mbps
) {

1550 ià(
ndev_vif
->
Œaffic_mÚ_¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
) {

1551 
	`¦si_Ãtif_½s_m­_£t
(
dev
, 
SCSC_NETIF_RPS_CPUS_BIG_MASK
, 
	`¡¾’
(SCSC_NETIF_RPS_CPUS_BIG_MASK));

1552 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 
SCSC_NETIF_NAPI_CPU_BIG
, 
Œue
);

1554 ià((
½s_’abË_ut_š_mbps
è&& (
ndev_vif
->
throughput_rx
 > (rps_enable_tput_in_mbps * 1000 * 1000))) {

1555 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "’abË RPS (ut_rx:%d bps)\n", 
ndev_vif
->
throughput_rx
);

1556 
	`¦si_Ãtif_½s_m­_£t
(
dev
, 
SCSC_NETIF_RPS_CPUS_BIG_MASK
, 
	`¡¾’
(SCSC_NETIF_RPS_CPUS_BIG_MASK));

1558 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "di§bË RPS (ut_rx:%d bps)\n", 
ndev_vif
->
throughput_rx
);

1559 
	`¦si_Ãtif_½s_m­_ş—r
(
dev
);

1563 ià((
Çpi_ıu_big_ut_š_mbps
è&& ((
sdev
->
agg_dev_throughput_rx
 + sdev->
agg_dev_throughput_tx
) > (napi_cpu_big_tput_in_mbps * 1000 * 1000)))

1564 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 
SCSC_NETIF_NAPI_CPU_BIG
, 
Œue
);

1566 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 0, 
çl£
);

1569 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1570 
	}
}

1572 
	$¦si_Ãtif_Œaffic_mÚ™Ü_cb
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

1574 
Ãt_deviû
 *
dev
 = (Ãt_deviû *)
ş›Á_ùx
;

1575 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1576 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1577 
¦si_h4
 *
h
 = &(
sdev
->
h4_š¡
);

1578 
boŞ
 
chªge
 = 
çl£
;

1579 
u32
 
Şd_¡©e
 = 
ndev_vif
->
Œaffic_mÚ_¡©e
;

1581 ià(!
sdev
)

1584 
	`¦si_¥šlock_lock
(&
sdev
->
Ãtdev_lock
);

1586 ià(!
ndev_vif
->
is_avaabË
) {

1587 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1591 
	`SLSI_NET_INFO
(
dev
, "ŒaffiømÚ™Ü:ƒv’ˆ(cu¼’t:%d‚ew:%d,put_tx:%u bps,put_rx:%u bps)\n", 
ndev_vif
->
Œaffic_mÚ_¡©e
, 
¡©e
, 
ut_tx
, 
ut_rx
);

1593 
sdev
->
agg_dev_throughput_tx
 = 
ut_tx
;

1594 
sdev
->
agg_dev_throughput_rx
 = 
ut_rx
;

1596 ià(
¡©e
 !ğ
ndev_vif
->
Œaffic_mÚ_¡©e
) {

1598 ià(
¡©e
 >ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 &&

1599 
ndev_vif
->
Œaffic_mÚ_¡©e
 >ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
) {

1600 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1603 
chªge
 = 
Œue
;

1604 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
¡©e
;

1607 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1609 ià(
chªge
) {

1610 ià(!
	`queue_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
Œaffic_mÚ_wÜk
)) {

1615 
	`SLSI_NET_WARN
(
dev
, "failedo queue work!„esetraffic stateo„etry\n");

1616 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

1617 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
Şd_¡©e
;

1618 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1621 
	}
}

1623 
	$¦si_Ãtif_add_locked
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
, 
iâum
)

1625 
Ãt_deviû
 *
dev
 = 
NULL
;

1626 
Ãtdev_vif
 *
ndev_vif
;

1627 
wœ–ess_dev
 *
wdev
;

1628 
®loc_size
, 
txq_couÁ
 = 0, 
»t
;

1630 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1632 ià(
	`WARN_ON
(!
sdev
 || 
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 || sdev->
Ãtdev
[ifnum]))

1633  -
EINVAL
;

1635 
®loc_size
 = (
Ãtdev_vif
);

1637 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1638 
txq_couÁ
 = 
	`¦si_tx_g‘_numb”_of_queues
();

1640 
txq_couÁ
 = 
SLSI_NETIF_Q_PEER_START
 + (
SLSI_NETIF_Q_PER_PEER
 * (
SLSI_ADHOC_PEER_CONNECTIONS_MAX
));

1643 
dev
 = 
	`®loc_Ãtdev_mqs
(
®loc_size
, 
Çme
, 
NET_NAME_PREDICTABLE
, 
¦si_if_£tup
, 
txq_couÁ
, 1);

1644 ià(!
dev
) {

1645 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate…rivate data for‚etdev\n");

1646  -
ENOMEM
;

1650 
dev
->
Ãeded_h—droom
 = 
SLSI_NETIF_SKB_HEADROOM
;

1651 
dev
->
Ãeded_room
 = 
SLSI_NETIF_SKB_TAILROOM
;

1653 
»t
 = 
	`dev_®loc_Çme
(
dev
, dev->
Çme
);

1654 ià(
»t
 < 0)

1655 
ex™_w™h_”rÜ
;

1657 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1658 
	`mem£t
(
ndev_vif
, 0x00, (*ndev_vif));

1659 
	`SLSI_MUTEX_INIT
(
ndev_vif
->
vif_mu‹x
);

1660 
	`SLSI_MUTEX_INIT
(
ndev_vif
->
sÿn_mu‹x
);

1661 
	`SLSI_MUTEX_INIT
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1662 
	`INIT_WORK
(&
ndev_vif
->
sched_sÿn_¡İ_wk
, 
¦si_sched_sÿn_¡İ³d
);

1663 
	`INIT_WORK
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
, 
¦si_£t_muÉiÿ¡_f‹r_wÜk
);

1665 
ndev_vif
->
is_İt_out_·ck‘
 = 
çl£
;

1666 
	`INIT_WORK
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
, 
¦si_upd©e_pkt_f‹r_wÜk
);

1667 
	`skb_queue_h—d_š™
(&
ndev_vif
->
ba_com¶‘e
);

1668 
	`¦si_sig_£nd_š™
(&
ndev_vif
->
sig_wa™
);

1669 
ndev_vif
->
sdev
 = sdev;

1670 
ndev_vif
->
iâum
 = ifnum;

1671 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

1672 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1673 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
v6addr_lock
);

1675 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
³”_lock
);

1676 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
ba_lock
);

1677 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 0);

1678 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

1681 ià(!(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è|| 
	`SLSI_IS_VIF_INDEX_NAN
(ndev_vif))) {

1682 
queue£t
;

1684 
queue£t
 = 0; queue£ˆ< 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queueset++) {

1685 
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
] = 
	`kz®loc
((*ndev_vif->³”_¡a_»cÜd[queue£t]), 
GFP_KERNEL
);

1687 ià(!
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
]) {

1688 
j
;

1690 
	`SLSI_NET_ERR
(
dev
, "Could‚Ù‡Îoÿ‹ memÜy fÜ…“¸’Œy (queue£t:%d)\n", 
queue£t
);

1693 
j
 = 0; j < 
queue£t
; j++) {

1694 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
j
]);

1695 
ndev_vif
->
³”_¡a_»cÜd
[
j
] = 
NULL
;

1698 
»t
 = -
ENOMEM
;

1699 
ex™_w™h_”rÜ
;

1705 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

1706 
	`SLSI_NET_ERR
(
dev
, "*#rf#„fest mode set isƒnabled.\n");

1707 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

1709 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

1712 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
ÃtwÜk_m­
);

1713 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_fw_li¡
);

1714 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_ioùl_li¡
);

1715 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1716 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
ssid_šfo
);

1717 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
bÏckli¡_h—d
);

1719 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "iâum=%d\n", 
ndev_vif
->
iâum
);

1722 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1723 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_NO_VIF
;

1724 
	`SLSI_NET_INFO
(
dev
, "Initializing Hs2 Del Vif Work\n");

1725 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
¦si_hs2_unsync_vif_d–‘e_wÜk
);

1726 } ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1728 
»t
 = 
	`¦si_p2p_š™
(
sdev
, 
ndev_vif
);

1729 ià(
»t
)

1730 
ex™_w™h_”rÜ
;

1733 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
sÿn_timeout_wÜk
, 
¦si_sÿn_šd_timeout_hªdË
);

1735 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
bÏckli¡_d–_wÜk
, 
¦si_bÏckli¡_d–_wÜk_hªdË
);

1736 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


1737 
»t
 = 
	`¦si_skb_wÜk_š™
(
sdev
, 
dev
, &
ndev_vif
->
rx_d©a
, "¦si_wÏn_rx_d©a", 
¦si_rx_Ãtdev_d©a_wÜk
);

1738 ià(
»t
)

1739 
ex™_w™h_”rÜ
;

1741 
»t
 = 
	`¦si_skb_wÜk_š™
(
sdev
, 
dev
, &
ndev_vif
->
rx_mlme
, "¦si_wÏn_rx_mlme", 
¦si_rx_Ãtdev_mlme_wÜk
);

1742 ià(
»t
) {

1743 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


1744 
	`¦si_skb_wÜk_deš™
(&
ndev_vif
->
rx_d©a
);

1746 
ex™_w™h_”rÜ
;

1749 
wdev
 = &
ndev_vif
->wdev;

1751 
dev
->
›“80211_±r
 = 
wdev
;

1752 
wdev
->
why
 = 
sdev
->wiphy;

1753 
wdev
->
Ãtdev
 = 
dev
;

1754 
wdev
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

1755 
	`SET_NETDEV_DEV
(
dev
, 
sdev
->dev);

1758 
	`Ãtif_ÿ¼›r_off
(
dev
);

1760 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1761 ià(
	`¡rcmp
(
Çme
, 
CONFIG_SCSC_AP_INTERFACE_NAME
) == 0)

1762 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

1764 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
iâum
]);

1766 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
iâum
]);

1768 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "Add:%pM\n", 
dev
->
dev_addr
);

1769 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
iâum
], 
dev
);

1770 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
çl£
;

1771 
ndev_vif
->
´obe_»q_›s
 = 
NULL
;

1772 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

1773 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

1774 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

1776 ià(!(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è|| 
	`SLSI_IS_VIF_INDEX_NAN
(ndev_vif))) {

1777 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1778 ià(
Çpi_ıu_big_ut_š_mbps
 || 
½s_’abË_ut_š_mbps
) {

1779 
u32
 
mid_ut
;

1780 
u32
 
high_ut
;

1782 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

1783 
	`INIT_WORK
(&
ndev_vif
->
Œaffic_mÚ_wÜk
, 
¦si_Ãtif_Œaffic_mÚ™Ü_wÜk
);

1785 ià(
½s_’abË_ut_š_mbps
 < 
Çpi_ıu_big_ut_š_mbps
) {

1786 
	`SLSI_NET_INFO
(
dev
, "napihreshold is biggerhan„ps\n");

1787 
mid_ut
 = (
½s_’abË_ut_š_mbps
 * 1000 * 1000);

1788 
high_ut
 = (
Çpi_ıu_big_ut_š_mbps
 * 1000 * 1000);

1790 
mid_ut
 = (
Çpi_ıu_big_ut_š_mbps
 * 1000 * 1000);

1791 
high_ut
 = (
½s_’abË_ut_š_mbps
 * 1000 * 1000);

1794 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "š™ŸlizRX¿ffiømÚ™Ü cl›Á (mid_ut:%d Mbps, high_ut:%d Mbps)\n", 
mid_ut
, 
high_ut
);

1795 ià(
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, 
dev
, 
TRAFFIC_MON_CLIENT_MODE_EVENTS
, 
mid_ut
, 
high_ut
, 
¦si_Ãtif_Œaffic_mÚ™Ü_cb
))

1796 
	`SLSI_NET_WARN
(
dev
, "failedo‡dd‡ clientoraffic monitor\n");

1799 
	`¦si_Ãtif_½s_m­_£t
(
dev
, 
SCSC_NETIF_RPS_CPUS_MASK
, 
	`¡¾’
(SCSC_NETIF_RPS_CPUS_MASK));

1804 
ex™_w™h_”rÜ
:

1805 
	`mu‹x_lock
(&
sdev
->
Ãtdev_»move_mu‹x
);

1806 
	`ä“_Ãtdev
(
dev
);

1807 
	`mu‹x_uÆock
(&
sdev
->
Ãtdev_»move_mu‹x
);

1808  
»t
;

1809 
	}
}

1811 
	$¦si_Ãtif_dyÇmic_içû_add
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
)

1813 
šdex
 = -
EINVAL
;

1814 
”r
;

1816 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1818 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 9)

1819 ià(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
] =ğsdev->
Ãtdev_­
) {

1820 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
], 
NULL
);

1821 
”r
 = 
	`¦si_Ãtif_add_locked
(
sdev
, 
Çme
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

1822 
šdex
 = 
”r
 ?ƒ¼ : 
SLSI_NET_INDEX_P2PX_SWLAN
;

1825 
”r
 = 
	`¦si_Ãtif_add_locked
(
sdev
, 
Çme
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

1826 
šdex
 = 
”r
 ?ƒ¼ : 
SLSI_NET_INDEX_P2PX_SWLAN
;

1829 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1830  
šdex
;

1831 
	}
}

1833 
	$¦si_Ãtif_š™
(
¦si_dev
 *
sdev
)

1835 
i
;

1837 
	`SLSI_DBG3
(
sdev
, 
SLSI_NETDEV
, "\n");

1839 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1842 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

1843 
	`RCU_INIT_POINTER
(
sdev
->
Ãtdev
[
i
], 
NULL
);

1845 ià(
	`¦si_Ãtif_add_locked
(
sdev
, "wÏn%d", 
SLSI_NET_INDEX_WLAN
) != 0) {

1846 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1847  -
EINVAL
;

1850 ià(
	`¦si_Ãtif_add_locked
(
sdev
, "p2p%d", 
SLSI_NET_INDEX_P2P
) != 0) {

1851 
	`¹Æ_lock
();

1852 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1853 
	`¹Æ_uÆock
();

1854 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1855  -
EINVAL
;

1857 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1858 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1859 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
], 
SLSI_DEFAULT_HW_MAC_ADDR
);

1860 ià(
	`¦si_Ãtif_add_locked
(
sdev
, 
CONFIG_SCSC_AP_INTERFACE_NAME
, 
SLSI_NET_INDEX_P2PX_SWLAN
) != 0) {

1861 
	`¹Æ_lock
();

1862 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1863 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]);

1864 
	`¹Æ_uÆock
();

1865 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1866  -
EINVAL
;

1870 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

1871 ià(
	`¦si_Ãtif_add_locked
(
sdev
, "wifi-aw¬e%d", 
SLSI_NET_INDEX_NAN
) != 0) {

1872 
	`¹Æ_lock
();

1873 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1874 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]);

1875 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1876 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1877 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

1880 
	`¹Æ_uÆock
();

1881 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1882  -
EINVAL
;

1885 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1887 
	}
}

1889 
	$¦si_Ãtif_»gi¡”_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1891 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1892 
”r
;

1894 
	`WARN_ON
(!
	`¹Æ_is_locked
());

1895 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1896 ià(
	`©omic_»ad
(&
ndev_vif
->
is_»gi¡”ed
)) {

1897 
	`SLSI_NET_ERR
(
dev
, "Regi¡”:" 
MACSTR
 " Faed: AÌ—dy„egi¡”ed\n", 
	`MAC2STR
(dev->
dev_addr
));

1901 
”r
 = 
	`»gi¡”_Ãtdeviû
(
dev
);

1902 ià(
”r
)

1903 
	`SLSI_NET_ERR
(
dev
, "Regi¡”:" 
MACSTR
 " Faed\n", 
	`MAC2STR
(dev->
dev_addr
));

1905 
	`©omic_£t
(&
ndev_vif
->
is_»gi¡”ed
, 1);

1906  
”r
;

1907 
	}
}

1909 
	$¦si_Ãtif_»gi¡”_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1911 
”r
;

1913 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1914 
”r
 = 
	`¦si_Ãtif_»gi¡”_locked
(
sdev
, 
dev
);

1915 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1916  
”r
;

1917 
	}
}

1919 
	$¦si_Ãtif_»gi¡”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1921 
”r
;

1923 
	`¹Æ_lock
();

1924 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1925 
”r
 = 
	`¦si_Ãtif_»gi¡”_locked
(
sdev
, 
dev
);

1926 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1927 
	`¹Æ_uÆock
();

1928  
”r
;

1929 
	}
}

1931 
	$¦si_Ãtif_»move_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1933 
i
;

1934 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1935 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1936 
li¡_h—d
 *
pos
, *
q
;

1938 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

1940 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "UÄegi¡”:%pM\n", dev->
dev_addr
);

1942 
	`WARN_ON
(!
	`¹Æ_is_locked
());

1943 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1945 ià(
	`©omic_»ad
(&
ndev_vif
->
is_»gi¡”ed
)) {

1946 
	`Ãtif_tx_di§bË
(
dev
);

1947 
	`Ãtif_ÿ¼›r_off
(
dev
);

1949 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

1952 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
ndev_vif
->
iâum
], 
NULL
);

1953 
	`synchrÚize_rcu
();

1956 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1957 
queue£t
;

1959 
queue£t
 = 0; queue£ˆ< 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queueset++) {

1960 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
]);

1961 
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
] = 
NULL
;

1965 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1966 
	`¦si_p2p_deš™
(
sdev
, 
ndev_vif
);

1967 } ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1968 
	`ÿnûl_d–ayed_wÜk_sync
(&
ndev_vif
->
bÏckli¡_d–_wÜk
);

1969 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_NO_VIF
;

1970 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

1972 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1973 ià(
Çpi_ıu_big_ut_š_mbps
 || 
½s_’abË_ut_š_mbps
) {

1974 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "tear-down RXraffic monitor client\n");

1975 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
Œaffic_mÚ_wÜk
);

1976 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
dev
);

1979 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

1980 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

1981 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


1982 
	`¦si_skb_wÜk_deš™
(&
ndev_vif
->
rx_d©a
);

1984 
	`¦si_skb_wÜk_deš™
(&
ndev_vif
->
rx_mlme
);

1985 
i
 = 0; i < 
SLSI_SCAN_MAX
; i++)

1986 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
i
);

1988 
	`kä“_skb
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

1989 
	`¦si_rßm_chªÃl_ÿche_´uÃ
(
dev
, 0, 
NULL
);

1991 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1992 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1993 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "Cleaning up scan†ist!\n");

1994 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

1995 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

1996 
li¡_h—d
 *
bssid_pos
, *
p
;

1998 
	`li¡_fÜ_—ch_§ã
(
bssid_pos
, 
p
, &
ssid_šfo
->
bssid_li¡
) {

1999 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
bssid_pos
, ¦si_bssid_šfo, 
li¡
);

2001 
	`li¡_d–
(
bssid_pos
);

2002 
	`kä“
(
bssid_šfo
);

2004 
	`li¡_d–
(
pos
);

2005 
	`kä“
(
ssid_šfo
);

2009 
	`kä“
(
ndev_vif
->
aş_d©a_suµliÿÁ
);

2010 
ndev_vif
->
aş_d©a_suµliÿÁ
 = 
NULL
;

2012 
	`kä“
(
ndev_vif
->
aş_d©a_h®
);

2013 
ndev_vif
->
aş_d©a_h®
 = 
NULL
;

2015 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2016 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

2017 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

2019 
	`li¡_d–
(
bÏckli¡_pos
);

2020 
	`kä“
(
bÏckli¡_šfo
);

2023 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

2024 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

2025 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

2027 
	`li¡_d–
(
bÏckli¡_pos
);

2028 
	`kä“
(
bÏckli¡_šfo
);

2031 
	`kä“
(
ndev_vif
->
´obe_»q_›s
);

2032 
ndev_vif
->
´obe_»q_›s
 = 
NULL
;

2033 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

2035 
	`¦si_Ãtif_½s_m­_ş—r
(
dev
);

2037 ià(
	`©omic_»ad
(&
ndev_vif
->
is_»gi¡”ed
)) {

2038 
	`©omic_£t
(&
ndev_vif
->
is_»gi¡”ed
, 0);

2039 
	`uÄegi¡”_Ãtdeviû
(
dev
);

2041 
	`mu‹x_lock
(&
sdev
->
Ãtdev_»move_mu‹x
);

2042 
	`ä“_Ãtdev
(
dev
);

2043 
	`mu‹x_uÆock
(&
sdev
->
Ãtdev_»move_mu‹x
);

2045 
	}
}

2047 
	$¦si_Ãtif_»move_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2049 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2050 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev
);

2051 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2052 
	}
}

2054 
	$¦si_Ãtif_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2056 
	`¹Æ_lock
();

2057 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2058 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev
);

2059 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2060 
	`¹Æ_uÆock
();

2061 
	}
}

2063 
	$¦si_Ãtif_»move_®l
(
¦si_dev
 *
sdev
)

2065 
i
;

2067 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "\n");

2068 
	`¹Æ_lock
();

2069 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2070 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

2071 ià(
sdev
->
Ãtdev
[
i
])

2072 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
i
]);

2073 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, 
NULL
);

2074 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2075 
	`¹Æ_uÆock
();

2076 
	}
}

2078 
	$¦si_Ãtif_deš™
(
¦si_dev
 *
sdev
)

2080 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "\n");

2081 
	`¦si_Ãtif_»move_®l
(
sdev
);

2082 
	}
}

2084 #iâdeà
CONFIG_ARM


2085 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_¡¬t
(
Ãt_deviû
 *
dev
)

2087 
šdex
;

2088 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2089 
¦si_tı_ack_s
 *
tı_ack
;

2091 
ndev_vif
->
Ï¡_tı_ack
 = 
NULL
;

2092 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2093 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2094 
tı_ack
->
dpÜt
 = 0;

2095 
tı_ack
->
daddr
 = 0;

2096 
tı_ack
->
¥Üt
 = 0;

2097 
tı_ack
->
§ddr
 = 0;

2098 
tı_ack
->
ack_£q
 = 0;

2099 
tı_ack
->
couÁ
 = 0;

2100 
tı_ack
->
max
 = 0;

2101 
tı_ack
->
age
 = 0;

2102 
	`skb_queue_h—d_š™
(&
tı_ack
->
li¡
);

2103 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2104 
	`tim”_£tup
(&
tı_ack
->
tim”
, 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
, 0);

2106 
tı_ack
->
tim”
.
funùiÚ
 = 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
;

2107 
tı_ack
->
tim”
.
d©a
 = ()tcp_ack;

2108 
	`š™_tim”
(&
tı_ack
->
tim”
);

2110 
tı_ack
->
ndev_vif
 =‚dev_vif;

2111 
tı_ack
->
¡©e
 = 1;

2113 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
tı_ack_lock
);

2114 
	`mem£t
(&
ndev_vif
->
tı_ack_¡©s
, 0, (
¦si_tı_ack_¡©s
));

2116 
	}
}

2118 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_¡İ
(
Ãt_deviû
 *
dev
)

2120 
šdex
;

2121 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2122 
¦si_tı_ack_s
 *
tı_ack
;

2124 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2125 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2126 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2127 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2128 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2129 
	`d–_tim”_sync
(&
tı_ack
->
tim”
);

2130 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2131 
tı_ack
->
¡©e
 = 0;

2132 
	`skb_queue_purge
(&
tı_ack
->
li¡
);

2134 
ndev_vif
->
Ï¡_tı_ack
 = 
NULL
;

2135 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2136 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2138 
	}
}

2140 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2141 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
tim”_li¡
 *
t
)

2143 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
d©a
)

2146 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2147 
¦si_tı_ack_s
 *
tı_ack
 = 
	`äom_tim”
Ñı_ack, 
t
, 
tim”
);

2149 
¦si_tı_ack_s
 *
tı_ack
 = (¦si_tı_ack_ *)
d©a
;

2151 
sk_buff
 *
skb
;

2152 
Ãtdev_vif
 *
ndev_vif
;

2153 
¦si_dev
 *
sdev
;

2154 
r
;

2156 ià(!
tı_ack
)

2159 
ndev_vif
 = 
tı_ack
->ndev_vif;

2161 ià(!
ndev_vif
)

2164 
sdev
 = 
ndev_vif
->sdev;

2166 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2168 ià(!
tı_ack
->
¡©e
) {

2169 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2173 (
skb
 = 
	`skb_dequeue
(&
tı_ack
->
li¡
)) != 0) {

2174 
tı_ack
->
couÁ
 = 0;

2176 ià(!
skb
->
dev
) {

2177 
	`kä“_skb
(
skb
);

2178 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2182 
ndev_vif
->
tı_ack_¡©s
.
ck_timeout
++;

2184 
r
 = 
	`¦si_tx_d©a
(
sdev
, 
skb
->
dev
, skb);

2185 ià(
r
 == 0) {

2186 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2187 
tı_ack
->
Ï¡_£Á
 = 
	`ktime_g‘
();

2188 } ià(
r
 =ğ-
ENOSPC
) {

2189 
ndev_vif
->
tı_ack_¡©s
.
ck_drİ³d
++;

2190 
	`kä“_skb
(
skb
);

2192 
ndev_vif
->
tı_ack_¡©s
.
ck_drİ³d
++;

2195 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2196 
	}
}

2198 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
sk_buff
 *
skb
, 
u32
 
İtiÚ
)

2200 *
İtiÚs
;

2201 
u32
 
İ’
 = 0, 
Ën
 = 0;

2203 ià(
	`tı_hdr
(
skb
)->
doff
 > 5)

2204 
İ’
 = (
	`tı_hdr
(
skb
)->
doff
 - 5) * 4;

2206 
İtiÚs
 = ((
u8
 *)
	`tı_hdr
(
skb
)è+ 
TCP_ACK_SUPPRESSION_OPTIONS_OFFSET
;

2208 
İ’
 > 0) {

2209 
İtiÚs
[0]) {

2210 
TCP_ACK_SUPPRESSION_OPTION_EOL
:

2212 
TCP_ACK_SUPPRESSION_OPTION_NOP
:

2213 
Ën
 = 1;

2215 
TCP_ACK_SUPPRESSION_OPTION_MSS
:

2216 ià(
İtiÚ
 =ğ
TCP_ACK_SUPPRESSION_OPTION_MSS
)

2217  ((
İtiÚs
[2] << 8) | options[3]);

2218 
Ën
 = 
İtiÚs
[1];

2220 
TCP_ACK_SUPPRESSION_OPTION_WINDOW
:

2221 ià(
İtiÚ
 =ğ
TCP_ACK_SUPPRESSION_OPTION_WINDOW
)

2222  
İtiÚs
[2];

2223 
Ën
 = 1;

2225 
TCP_ACK_SUPPRESSION_OPTION_SACK
:

2226 ià(
İtiÚ
 =ğ
TCP_ACK_SUPPRESSION_OPTION_SACK
)

2228 
Ën
 = 
İtiÚs
[1];

2231 
Ën
 = 
İtiÚs
[1];

2237 ià(
Ën
 =ğ0 ||†’ > 
İ’
) {

2238 
	`SLSI_DBG_HEX_NODEV
(
SLSI_TX
, 
skb
->
d©a
, skb->
Ën
 < 128 ? skb->len : 128, "SKB:\n");

2241 
İ’
 -ğ
Ën
;

2242 
İtiÚs
 +ğ
Ën
;

2245 
	}
}

2247 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_syn
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2249 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2250 
¦si_tı_ack_s
 *
tı_ack
;

2251 
šdex
;

2253 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "\n");

2254 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2255 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2256 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2258 ià(!
tı_ack
->
¡©e
) {

2259 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2263 ià(
tı_ack
->
daddr
) {

2264 ià(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
tı_ack
->
Ï¡_£Á
)è>ğ
TCP_ACK_SUPPRESSION_RECORD_UNUSED_TIMEOUT
 * 1000) {

2265 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "d–‘© %d (%pI4.%d > %pI4.%d)\n", 
šdex
, &
tı_ack
->
§ddr
, 
	`Áohs
Ñı_ack->
¥Üt
), &tı_ack->
daddr
,‚tohsÑı_ack->
dpÜt
));

2266 
	`skb_queue_purge
(&
tı_ack
->
li¡
);

2267 
tı_ack
->
dpÜt
 = 0;

2268 
tı_ack
->
¥Üt
 = 0;

2269 
tı_ack
->
daddr
 = 0;

2270 
tı_ack
->
§ddr
 = 0;

2271 
tı_ack
->
couÁ
 = 0;

2272 
tı_ack
->
ack_£q
 = 0;

2273 
	`d–_tim”
(&
tı_ack
->
tim”
);

2277 ià(
tı_ack
->
daddr
 == 0) {

2278 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "add‡ˆ%d (%pI4.%d > %pI4.%d)\n", 
šdex
, &
	`_hdr
(
skb
)->
§ddr
, 
	`Áohs
(
	`tı_hdr
(skb)->
sourû
), &_hdr(skb)->
daddr
,‚tohsÑı_hdr(skb)->
de¡
));

2279 
tı_ack
->
daddr
 = 
	`_hdr
(
skb
)->daddr;

2280 
tı_ack
->
§ddr
 = 
	`_hdr
(
skb
)->saddr;

2281 
tı_ack
->
dpÜt
 = 
	`tı_hdr
(
skb
)->
de¡
;

2282 
tı_ack
->
¥Üt
 = 
	`tı_hdr
(
skb
)->
sourû
;

2283 
tı_ack
->
couÁ
 = 0;

2284 
tı_ack
->
ack_£q
 = 0;

2285 
tı_ack
->
¦ow_¡¬t_couÁ
 = 0;

2286 
tı_ack
->
tı_¦ow_¡¬t
 = 
Œue
;

2287 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2288 
tı_ack
->
max
 = 0;

2289 
tı_ack
->
age
 = 0;

2291 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_max
;

2292 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_timeout
;

2294 
tı_ack
->
Ï¡_£Á
 = 
	`ktime_g‘
();

2296 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2297 
tı_ack
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

2298 
tı_ack
->
Ï¡_ack_£q
 = 0;

2299 
tı_ack
->
Ï¡_tı_¿‹
 = 0;

2300 
tı_ack
->
num_by‹s
 = 0;

2301 
tı_ack
->
hy¡”esis
 = 0;

2303 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2304 
tı_ack
->
¡»am_id
 = 
šdex
;

2307 
tı_ack
->
wšdow_muÉl›r
 = 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
skb
, 
TCP_ACK_SUPPRESSION_OPTION_WINDOW
);

2308 ià(
tı_ack
->
wšdow_muÉl›r
 > 14)

2309 
tı_ack
->
wšdow_muÉl›r
 = 0;

2310 
tı_ack
->
mss
 = 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
skb
, 
TCP_ACK_SUPPRESSION_OPTION_MSS
);

2311 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "İtiÚs: mss:%u, wšdow:%u\n", 
tı_ack
->
mss
,ı_ack->
wšdow_muÉl›r
);

2312 
	`SCSC_HIP4_SAMPLER_TCP_SYN
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
šdex
, 
tı_ack
->
mss
);

2313 
	`SCSC_HIP4_SAMPLER_TCP_DATA
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
šdex
, 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
£q
));

2314 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2318 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2319 
	}
}

2321 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_fš
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2323 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2324 
¦si_tı_ack_s
 *
tı_ack
;

2325 
šdex
;

2327 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "\n");

2328 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2329 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2330 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2332 ià((
tı_ack
->
dpÜt
 =ğ
	`tı_hdr
(
skb
)->
de¡
) &&

2333 (
tı_ack
->
daddr
 =ğ
	`_hdr
(
skb
)->daddr)) {

2334 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "d–‘© %d (%pI4.%d > %pI4.%d)\n", 
šdex
, &
tı_ack
->
§ddr
, 
	`Áohs
Ñı_ack->
¥Üt
), &tı_ack->
daddr
,‚tohsÑı_ack->
dpÜt
));

2335 
	`skb_queue_purge
(&
tı_ack
->
li¡
);

2336 
tı_ack
->
dpÜt
 = 0;

2337 
tı_ack
->
¥Üt
 = 0;

2338 
tı_ack
->
daddr
 = 0;

2339 
tı_ack
->
§ddr
 = 0;

2340 
tı_ack
->
couÁ
 = 0;

2341 
tı_ack
->
ack_£q
 = 0;

2343 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2344 
tı_ack
->
Ï¡_ack_£q
 = 0;

2345 
tı_ack
->
Ï¡_tı_¿‹
 = 0;

2346 
tı_ack
->
num_by‹s
 = 0;

2347 
tı_ack
->
hy¡”esis
 = 0;

2350 
	`d–_tim”
(&
tı_ack
->
tim”
);

2351 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2352 
tı_ack
->
¡»am_id
 = 0;

2354 
	`SCSC_HIP4_SAMPLER_TCP_FIN
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
šdex
);

2355 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2359 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2360 
	}
}

2362 
boŞ
 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_is_possibË
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2364 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2366 ià(
tı_ack_suµ»ssiÚ_di§bË
 ||

2367 (
tı_ack_suµ»ssiÚ_di§bË_2g
 && !
	`SLSI_IS_VIF_CHANNEL_5G
(
ndev_vif
)))

2368  
çl£
;

2373 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && (
	`com·»_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_sourû
, 
dev
->
dev_addr
) != 0))

2374  
çl£
;

2377 ià(
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
è!ğ
ETH_P_IP
 ||

2378 
	`_hdr
(
skb
)->
´ÙocŞ
 !ğ
IPPROTO_TCP
 ||

2379 !
	`skb_Œª¥Üt_h—d”_was_£t
(
skb
))

2380  
çl£
;

2382 ià(
	`tı_hdr
(
skb
)->
syn
) {

2383 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_syn
(
dev
, 
skb
);

2384  
çl£
;

2386 ià(
	`tı_hdr
(
skb
)->
fš
) {

2387 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_fš
(
dev
, 
skb
);

2388  
çl£
;

2390 ià(!
	`tı_hdr
(
skb
)->
ack
 ||ı_hdr(skb)->
r¡
 ||ı_hdr(skb)->
urg
)

2391  
çl£
;

2393  
Œue
;

2394 
	}
}

2396 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_¿‹_ÿl
(
Ãt_deviû
 *
dev
, 
¦si_tı_ack_s
 *
tı_ack
, 
sk_buff
 *
skb
)

2398 
u32
 
tı_»cv_wšdow_size
 = 0;

2403 ià(
tı_ack
->
Ï¡_ack_£q
)

2404 
tı_ack
->
num_by‹s
 +ğ((
u32
)
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è-ı_ack->
Ï¡_ack_£q
);

2406 
tı_ack
->
Ï¡_ack_£q
 = 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
);

2407 ià(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
tı_ack
->
Ï¡_§m¶e_time
)è> 
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
) {

2408 
u16
 
acks_max
;

2409 
u32
 
tı_¿‹
 = ((
tı_ack
->
num_by‹s
 * 8è/ (
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
 * 1000));

2411 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "hysteresis:%uotal_bytes:%llu„ate:%u Mbps\n",

2412 
tı_ack
->
hy¡”esis
,ı_ack->
num_by‹s
, 
tı_¿‹
);

2415 ià((
	`abs
(
tı_¿‹
 - 
tı_ack
->
Ï¡_tı_¿‹
)è>ı_ack->
hy¡”esis
) {

2416 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2417 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2419 ià(
tı_¿‹
 >ğ
tı_ack_suµ»ssiÚ_¿‹_v”y_high
) {

2420 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
;

2421 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
;

2422 } ià(
tı_¿‹
 >ğ
tı_ack_suµ»ssiÚ_¿‹_high
) {

2423 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_¿‹_high_acks
;

2424 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_¿‹_high_timeout
;

2425 } ià(
tı_¿‹
 >ğ
tı_ack_suµ»ssiÚ_¿‹_low
) {

2426 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_¿‹_low_acks
;

2427 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_¿‹_low_timeout
;

2429 
tı_ack
->
max
 = 0;

2430 
tı_ack
->
age
 = 0;

2437 ià(
tı_ack
->
wšdow_muÉl›r
)

2438 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
è* (2 << 
tı_ack
->
wšdow_muÉl›r
);

2440 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
);

2441 
	`SCSC_HIP4_SAMPLER_TCP_RWND
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
tı_»cv_wšdow_size
);

2443 
acks_max
 = (
tı_»cv_wšdow_size
 / 5è/ (2 * 
tı_ack
->
mss
);

2444 ià(
tı_ack
->
max
 > 
acks_max
)

2445 
tı_ack
->
max
 = 
acks_max
;

2447 
tı_ack
->
hy¡”esis
 = 
tı_¿‹
 / 5;

2448 
tı_ack
->
Ï¡_tı_¿‹
 = 
tı_¿‹
;

2449 
tı_ack
->
num_by‹s
 = 0;

2450 
tı_ack
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

2452 
	}
}

2454 
sk_buff
 *
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_pkt
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2456 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2457 
šdex
, 
found
;

2458 
¦si_tı_ack_s
 *
tı_ack
;

2459 
fÜw¬d_now
 = 0, 
æush
 = 0;

2460 
sk_buff
 *
cskb
 = 0;

2461 
u32
 
tı_»cv_wšdow_size
 = 0;

2463 ià(!
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_is_possibË
(
dev
, 
skb
))

2464  
skb
;

2466 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2467 
ndev_vif
->
tı_ack_¡©s
.
ck_acks
++;

2469 
found
 = 0;

2470 ià(
ndev_vif
->
Ï¡_tı_ack
) {

2471 
tı_ack
 = 
ndev_vif
->
Ï¡_tı_ack
;

2472 ià(!
tı_ack
->
¡©e
) {

2473 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2474 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2475 
	`SLSI_ERR_NODEV
("last_tcp_ack„ecord‚otƒnabled\n");

2476  
skb
;

2478 ià((
tı_ack
->
dpÜt
 =ğ
	`tı_hdr
(
skb
)->
de¡
) &&

2479 (
tı_ack
->
¥Üt
 =ğ
	`tı_hdr
(
skb
)->
sourû
) &&

2480 (
tı_ack
->
daddr
 =ğ
	`_hdr
(
skb
)->daddr)) {

2481 
found
 = 1;

2482 
ndev_vif
->
tı_ack_¡©s
.
ck_Ï¡»cÜd
++;

2485 ià(
found
 == 0) {

2487 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2488 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2490 ià(!
tı_ack
->
¡©e
) {

2491 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2492 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2493 
	`SLSI_ERR_NODEV
("tı_ack„ecÜd %d‚ÙƒÇbËd\n", 
šdex
);

2494  
skb
;

2496 ià((
tı_ack
->
dpÜt
 =ğ
	`tı_hdr
(
skb
)->
de¡
) &&

2497 (
tı_ack
->
¥Üt
 =ğ
	`tı_hdr
(
skb
)->
sourû
) &&

2498 (
tı_ack
->
daddr
 =ğ
	`_hdr
(
skb
)->daddr)) {

2499 
found
 = 1;

2500 
ndev_vif
->
tı_ack_¡©s
.
ck_£¬ch»cÜd
++;

2504 ià(
found
 == 0) {

2506 
ndev_vif
->
tı_ack_¡©s
.
ck_nÜecÜd
++;

2507 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2508 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2509  
skb
;

2511 
ndev_vif
->
Ï¡_tı_ack
 = 
tı_ack
;

2515 ià(
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è< 
tı_ack
->ack_seq) {

2517 ià(((
s32
)((
u32
)
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è- (u32)
tı_ack
->ack_seq)) < 0) {

2518 
ndev_vif
->
tı_ack_¡©s
.
ck_dacks
++;

2519 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2520 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2521  
skb
;

2526 ià(
	`be16_to_ıu
(
	`_hdr
(
skb
)->
tÙ_Ën
è> ((_hdr(skb)->
ihl
 * 4è+ (
	`tı_hdr
(skb)->
doff
 * 4))) {

2527 
	`SCSC_HIP4_SAMPLER_TCP_DATA
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
£q
));

2528 
	`SCSC_HIP4_SAMPLER_TCP_CWND
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, (
skb
->
sk
è? 
	`tı_sk
(skb->sk)->
¢d_cwnd
 : 0);

2529 
	`SCSC_HIP4_SAMPLER_TCP_SEND_BUF
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, (
skb
->
sk
è? (skb->sk)->
sk_¢dbuf
 : 0);

2530 
ndev_vif
->
tı_ack_¡©s
.
ck_hasd©a
++;

2531 
fÜw¬d_now
 = 1;

2532 
_fÜw¬d_now
;

2536 ià(
	`tı_hdr
(
skb
)->
psh
) {

2537 
ndev_vif
->
tı_ack_¡©s
.
ck_psh
++;

2538 
fÜw¬d_now
 = 1;

2539 
_fÜw¬d_now
;

2545 ià(
	`tı_hdr
(
skb
)->
eû
) {

2546 
ndev_vif
->
tı_ack_¡©s
.
ck_eû
++;

2547 
fÜw¬d_now
 = 1;

2548 
_fÜw¬d_now
;

2551 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
)

2552 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_¿‹_ÿl
(
dev
, 
tı_ack
, 
skb
);

2555 ià(
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
skb
, 
TCP_ACK_SUPPRESSION_OPTION_SACK
)) {

2556 
ndev_vif
->
tı_ack_¡©s
.
ck_§cks
++;

2566 
tı_ack
->
¦ow_¡¬t_couÁ
 = 0;

2567 
tı_ack
->
tı_¦ow_¡¬t
 = 
Œue
;

2568 
fÜw¬d_now
 = 1;

2569 
_fÜw¬d_now
;

2572 ià(
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è=ğ
tı_ack
->ack_seq) {

2573 
ndev_vif
->
tı_ack_¡©s
.
ck_dacks
++;

2574 
fÜw¬d_now
 = 1;

2575 
_fÜw¬d_now
;

2582 ià(
tı_ack
->
tı_¦ow_¡¬t
) {

2583 
tı_ack
->
¦ow_¡¬t_couÁ
++;

2584 ià(
tı_ack
->
¦ow_¡¬t_couÁ
 >ğ
tı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
) {

2585 
tı_ack
->
¦ow_¡¬t_couÁ
 = 0;

2586 
tı_ack
->
tı_¦ow_¡¬t
 = 
çl£
;

2588 
fÜw¬d_now
 = 1;

2589 
_fÜw¬d_now
;

2593 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
 && (!
tı_ack
->
max
 || !tı_ack->
age
)) {

2594 
fÜw¬d_now
 = 1;

2595 
_fÜw¬d_now
;

2599 ià((!
tı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
) &&

2600 ((
u32
)
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è- 
tı_ack
->ack_£q > (2 *ı_ack->
mss
))) {

2601 
ndev_vif
->
tı_ack_¡©s
.
ck_d–ay_acks
++;

2602 
fÜw¬d_now
 = 1;

2603 
_fÜw¬d_now
;

2613 ià(!
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2614 ià(
tı_ack
->
wšdow_muÉl›r
)

2615 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
è* (2 << 
tı_ack
->
wšdow_muÉl›r
);

2617 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
);

2618 ià(
tı_»cv_wšdow_size
 < 
tı_ack_suµ»ssiÚ_rcv_wšdow
 * 1024) {

2619 
ndev_vif
->
tı_ack_¡©s
.
ck_low_wšdow
++;

2620 
fÜw¬d_now
 = 1;

2621 
_fÜw¬d_now
;

2625 ià(!
tı_ack_suµ»ssiÚ_mÚ™Ü
 && 
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
tı_ack
->
Ï¡_£Á
)è>ğtı_ack->
age
) {

2626 
ndev_vif
->
tı_ack_¡©s
.
ck_ktime
++;

2627 
fÜw¬d_now
 = 1;

2628 
_fÜw¬d_now
;

2632 ià(!
	`skb_queue_Ën
(&
tı_ack
->
li¡
)) {

2633 
	`skb_queue_
(&
tı_ack
->
li¡
, 
skb
);

2634 
tı_ack
->
couÁ
 = 1;

2635 
tı_ack
->
ack_£q
 = 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->ack_seq);

2636 ià(
tı_ack
->
age
)

2637 
	`mod_tim”
(&
tı_ack
->
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
Ñı_ack->
age
));

2638 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2641 
_fÜw¬d_now
:

2642 
cskb
 = 
	`skb_dequeue
(&
tı_ack
->
li¡
);

2643 ià(
cskb
) {

2644 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
 && 
tı_ack
->
age
)

2645 
	`mod_tim”
(&
tı_ack
->
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
Ñı_ack->
age
));

2646 
ndev_vif
->
tı_ack_¡©s
.
ck_suµ»s£d
++;

2647 
	`cÚsume_skb
(
cskb
);

2649 
	`skb_queue_
(&
tı_ack
->
li¡
, 
skb
);

2650 
tı_ack
->
ack_£q
 = 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->ack_seq);

2651 
tı_ack
->
couÁ
++;

2652 ià(
fÜw¬d_now
) {

2653 
æush
 = 1;

2655 ià(
tı_ack
->
couÁ
 >ğtı_ack->
max
) {

2656 
æush
 = 1;

2657 
ndev_vif
->
tı_ack_¡©s
.
ck_max
++;

2660 ià(!
æush
) {

2661 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2665 
cskb
 = 
	`skb_dequeue
(&
tı_ack
->
li¡
);

2666 
tı_ack
->
couÁ
 = 0;

2668 ià(
tı_ack
->
age
)

2669 
	`d–_tim”
(&
tı_ack
->
tim”
);

2671 
tı_ack
->
Ï¡_£Á
 = 
	`ktime_g‘
();

2672 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2673 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2674  
cskb
;

2675 
	}
}

	@netif.h

7 
	~"dev.h
"

9 #iâdeà
__SLSI_NETIF_H__


10 
	#__SLSI_NETIF_H__


	)

40 #iâdeà
ETH_P_PAE


41 
	#ETH_P_PAE
 0x888e

	)

43 #iâdeà
ETH_P_WAI


44 
	#ETH_P_WAI
 0x88b4

	)

47 
	#SLSI_NETIF_Q_PRIORITY
 0

	)

48 
	#SLSI_NETIF_Q_DISCARD
 1

	)

49 
	#SLSI_NETIF_Q_MULTICAST_START
 2

	)

50 
	#SLSI_NETIF_Q_ARP
 6

	)

51 
	#SLSI_NETIF_Q_PEER_START
 7

	)

53 
	#SLSI_NETIF_Q_PER_PEER
 4

	)

56 
	#SLSI_NETIF_SKB_HEADROOM
 (68 + 160)

	)

57 
	#SLSI_NETIF_SKB_TAILROOM
 0

	)

58 
	#SLSI_SYS_ERROR_RECOVERY_TIMEOUT
 1000

	)

60 
šlše
 
u16
 
	$¦si_Ãtif_g‘_³”_queue
(
s16
 
queue£t
, s16 
ac
)

62 
	`WARN_ON
(
ac
 > 
SLSI_NETIF_Q_PER_PEER
);

63  
SLSI_NETIF_Q_PEER_START
 + (
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
è+ 
ac
;

64 
	}
}

67 
šlše
 
	$¦si_Ãtif_g‘_qs_äom_queue
(
queue
, 
ac
)

69  ((
queue
 - 
ac
 - 
SLSI_NETIF_Q_PEER_START
è/ 
SLSI_NETIF_Q_PER_PEER
);

70 
	}
}

72 
šlše
 
u16
 
	$¦si_Ãtif_g‘_muÉiÿ¡_queue
(
s16
 
ac
)

74 
	`WARN_ON
(
ac
 > 
SLSI_NETIF_Q_PER_PEER
);

75  
SLSI_NETIF_Q_MULTICAST_START
 + 
ac
;

76 
	}
}

78 
	#MAP_QS_TO_AID
(
qs
è(q + 1)

	)

79 
	#MAP_AID_TO_QS
(
aid
è×id - 1)

	)

81 
	e¦si_Œaffic_q
 {

82 
	mSLSI_TRAFFIC_Q_BE
 = 0,

83 
	mSLSI_TRAFFIC_Q_BK
,

84 
	mSLSI_TRAFFIC_Q_VI
,

85 
	mSLSI_TRAFFIC_Q_VO
,

88 
¦si_Œaffic_q
 
¦si_äame_´iÜ™y_to_ac_queue
(
u16
 
´iÜ™y
);

89 
¦si_ac_to_tids
(
¦si_Œaffic_q
 
ac
, *
tids
);

91 
	g¦si_dev
;

92 
	g¦si_³”
;

94 
¦si_Ãtif_š™
(
¦si_dev
 *
sdev
);

96 
¦si_Ãtif_dyÇmic_içû_add
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
);

97 
¦si_Ãtif_»gi¡”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

98 
¦si_Ãtif_»gi¡”_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

99 
¦si_Ãtif_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

100 
¦si_Ãtif_»move_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

101 
¦si_Ãtif_»move_®l
(
¦si_dev
 *
sdev
);

102 
¦si_Ãtif_deš™
(
¦si_dev
 *
sdev
);

103 
¦si_tdls_move_·ck‘s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

104 
¦si_³”
 *
¡a_³”
, ¦si_³” *
tdls_³”
, 
boŞ
 
cÚÃùiÚ
);

105 
¦si_Ãtif_»move_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

106 
¦si_Ãtif_add_locked
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
, 
iâum
);

107 
¦si_Ãtif_»gi¡”_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

108 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


109 
¦si_Ãt_¿ndomize_nmi_ndi
(
¦si_dev
 *
sdev
);

111 
¦si_Ãtif_£t_tid_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
mode
, 
u32
 
uid
, u8 
tid
);

112 
¦si_Ãtif_£t_tid_chªge_tid
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

113 #ifdeà
CONFIG_SCSC_USE_WMM_TOS


114 
u16
 
¦si_g‘_´iÜ™y_äom_tos
(
u8
 *
äame
, u16 
´Ùo
);

116 
u16
 
¦si_g‘_´iÜ™y_äom_tos_dsı
(
u8
 *
äame
, u16 
´Ùo
);

118 
boŞ
 
¦si_Ãt_downg¿de_ac
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

119 
¦si_Ãt_downg¿de_´i
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
);

	@nl80211_vendor.c

6 
	~<lšux/v”siÚ.h
>

7 
	~<Ãt/cfg80211.h
>

8 
	~<Ãt/.h
>

9 
	~<lšux/‘h”deviû.h
>

10 
	~"dev.h
"

11 
	~"cfg80211_İs.h
"

12 
	~"debug.h
"

13 
	~"mgt.h
"

14 
	~"mlme.h
"

15 
	~"Ãtif.h
"

16 
	~"unifiio.h
"

17 
	~"mib.h
"

18 
	~"Æ80211_v’dÜ.h
"

19 
	~"log2us.h
"

20 
	~<lšux/uacûss.h
>

21 
	~"scsc_wifogg”_ršg_cÚÃùiv™y_­i.h
"

22 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


23 
	~"scsc_wifogg”.h
"

24 
	~"scsc_wifogg”_ršgs.h
"

25 
	~"scsc_wifogg”_ty³s.h
"

26 
	~"scsc_wifogg”_ršg_cÚÃùiv™y_­i.h
"

30 
	#FAPI_EVENT_WIFI_EVENT_AUTH_RECEIVED
 0x0001

	)

31 
	#FAPI_EVENT_WIFI_EVENT_FW_AUTH_SENT
 0x0003

	)

32 
	#FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_QUERY
 0x004B

	)

33 
	#FAPI_EVENT_WIFI_EVENT_FW_DEAUTHENTICATION_RECEIVED
 0x004c

	)

34 
	#FAPI_EVENT_WIFI_EVENT_FW_DISASSOCIATION_RECEIVED
 0x004d

	)

35 
	#FAPI_EVENT_WIFI_EVENT_FW_DEAUTHENTICATION_SENT
 0x004e

	)

36 
	#FAPI_EVENT_WIFI_EVENT_FW_BTM_CANDIDATE
 0x004f

	)

38 
	#SLSI_WIFI_TAG_VENDOR_SPECIFIC
 0

	)

39 
	#SLSI_WIFI_TAG_BSSID
 1

	)

40 
	#SLSI_WIFI_TAG_ADDR
 2

	)

41 
	#SLSI_WIFI_TAG_SSID
 3

	)

42 
	#SLSI_WIFI_TAG_STATUS
 4

	)

43 
	#SLSI_WIFI_TAG_IE
 12

	)

44 
	#SLSI_WIFI_TAG_REASON_CODE
 14

	)

45 
	#SLSI_WIFI_TAG_RSSI
 21

	)

46 
	#SLSI_WIFI_TAG_CHANNEL
 22

	)

47 
	#SLSI_WIFI_TAG_EAPOL_MESSAGE_TYPE
 29

	)

49 
	#SLSI_GSCAN_INVALID_RSSI
 0x7FFF

	)

50 
	#SLSI_EPNO_AUTH_FIELD_WEP_OPEN
 1

	)

51 
	#SLSI_EPNO_AUTH_FIELD_WPA_PSK
 2

	)

52 
	#SLSI_EPNO_AUTH_FIELD_WPA_EAP
 4

	)

53 
	#WIFI_EVENT_FW_RM_FRAME_RESPONSE
 59

	)

54 
	#WIFI_EVENT_ASSOCIATING_DEAUTH_RECEIVED
 72

	)

55 
	#WIFI_EVENT_FW_BEACON_REPORT_RESPONSE
 73

	)

57 
	#SLSI_WIFI_TAG_VD_FRAME
 0xf00a

	)

58 
	#SLSI_WIFI_TAG_VD_RETRY_COUNT
 0xf00f

	)

59 
	#SLSI_WIFI_TAG_VD_EAPOL_KEY_TYPE
 0xF008

	)

60 
	#SLSI_WIFI_TAG_VD_LOCAL_DURATION
 0xf00b

	)

61 
	#SLSI_WIFI_TAG_VD_SCAN_TYPE
 0xf012

	)

62 
	#SLSI_WIFI_TAG_VD_SEQUENCE_NUMBER
 0xf014

	)

63 
	#SLSI_WIFI_TAG_VD_ROAMING_REASON
 0xf019

	)

64 
	#SLSI_WIFI_TAG_VD_CHANNEL_UTILISATION
 0xf01a

	)

65 
	#SLSI_WIFI_TAG_VD_BTM_REQUEST_MODE
 0xf01b

	)

66 
	#SLSI_WIFI_TAG_VD_BTM_RESPONSE_STATUS
 0xf01c

	)

67 
	#SLSI_WIFI_TAG_VD_SCORE
 0xf01d

	)

68 
	#SLSI_WIFI_TAG_VD_RSSI_THRESHOLD
 0xf01e

	)

69 
	#SLSI_WIFI_TAG_VD_DIASSOCIATION_TIMER
 0xf01f

	)

70 
	#SLSI_WIFI_TAG_VD_VALIDITY_INTERVAL
 0xf020

	)

71 
	#SLSI_WIFI_TAG_VD_CANDIDATE_LIST_COUNT
 0xf021

	)

72 
	#SLSI_WIFI_TAG_VD_OPERATING_CLASS
 0xf022

	)

73 
	#SLSI_WIFI_TAG_VD_MEASUREMENT_MODE
 0xf023

	)

74 
	#SLSI_WIFI_TAG_VD_MEASUREMENT_DURATION
 0xf024

	)

75 
	#SLSI_WIFI_TAG_VD_MIN_AP_COUNT
 0xf025

	)

76 
	#SLSI_WIFI_TAG_VD_CLUSTER_ID
 0xf026

	)

77 
	#SLSI_WIFI_TAG_VD_NAN_ROLE
 0xf027

	)

78 
	#SLSI_WIFI_TAG_VD_NAN_AMR
 0xf028

	)

79 
	#SLSI_WIFI_TAG_VD_NAN_HOP_COUNT
 0xf029

	)

80 
	#SLSI_WIFI_TAG_VD_NAN_NMI
 0xf02a

	)

81 
	#SLSI_WIFI_TAG_VD_MESSAGE_TYPE
 0xf02b

	)

82 
	#SLSI_WIFI_TAG_VD_ESTIMATED_TP
 0xf02c

	)

83 
	#SLSI_WIFI_TAG_VD_EXPIRED_TIMER_VALUE
 0xf02d

	)

84 
	#SLSI_WIFI_TAG_VD_NAN_NDP_ID
 0xf02e

	)

85 
	#SLSI_WIFI_TAG_VD_MASTER_TSF
 0xf030

	)

86 
	#SLSI_WIFI_TAG_VD_SCHEDULE_TYPE
 0xf031

	)

87 
	#SLSI_WIFI_TAG_VD_START_OFFSET
 0xf032

	)

88 
	#SLSI_WIFI_TAG_VD_SLOT_DURATION
 0xf033

	)

89 
	#SLSI_WIFI_TAG_VD_SLOT_PERIOD
 0xf034

	)

90 
	#SLSI_WIFI_TAG_VD_BITMAP
 0xf035

	)

91 
	#SLSI_WIFI_TAG_VD_CHANNEL_INFO
 0xf036

	)

92 
	#SLSI_WIFI_TAG_VD_ULW_REASON
 0xf037

	)

93 
	#SLSI_WIFI_TAG_VD_ULW_INDEX
 0xf038

	)

94 
	#SLSI_WIFI_TAG_VD_ULW_START_TIME
 0xf039

	)

95 
	#SLSI_WIFI_TAG_VD_ULW_PERIOD
 0xf03a

	)

96 
	#SLSI_WIFI_TAG_VD_ULW_DURATION
 0xf03b

	)

97 
	#SLSI_WIFI_TAG_VD_ULW_COUNT
 0xf03c

	)

98 
	#SLSI_WIFI_TAG_VD_NAN_RX_TOTAL
 0xf03d

	)

99 
	#SLSI_WIFI_TAG_VD_NAN_TX_TOTAL
 0xf03e

	)

100 
	#SLSI_WIFI_TAG_VD_NAN_RX_AVERAGE
 0xf03f

	)

101 
	#SLSI_WIFI_TAG_VD_NAN_TX_AVERAGE
 0xf040

	)

102 
	#SLSI_WIFI_TAG_VD_FULL_SCAN_COUNT
 0xf041

	)

103 
	#SLSI_WIFI_TAG_VD_CU_RSSI_THRESHOLD
 0xf042

	)

104 
	#SLSI_WIFI_TAG_VD_CU_THRESHOLD
 0xf043

	)

105 
	#SLSI_WIFI_TAG_VD_ROAMING_TYPE
 0xf044

	)

106 
	#SLSI_WIFI_TAG_VD_AUTH_ALGO
 0xf046

	)

107 
	#SLSI_WIFI_TAG_VD_SAE_MESSAGE_TYPE
 0xf047

	)

108 
	#SLSI_WIFI_TAG_VD_DIALOG_TOKEN
 0xf048

	)

109 
	#SLSI_WIFI_TAG_VD_BTM_CANDIDATE_PREFERENCE
 0xf049

	)

110 
	#SLSI_WIFI_TAG_VD_BTM_CANDIDATE_COUNT
 0xf04a

	)

111 
	#SLSI_WIFI_TAG_VD_ELIGIBLE
 0xf04b

	)

112 
	#SLSI_WIFI_TAG_VD_PARAMETER_SET
 0xff00

	)

113 
	#WIFI_TAG_VD_MGMT_FRAME_SUBTYPE
 0xf04c

	)

114 
	#SLSI_WIFI_TAG_VD_IS_ROAMING
 0xf04d

	)

116 
	#SLSI_PSID_UNIFI_AC_NO_ACKS
 0x0918

	)

118 
	#MAX_SSID_LEN
 100

	)

119 
	#SLSI_MAX_NUM_RING
 10

	)

121 
	#MIN
(
a
, 
b
è((×è< (b)è? (aè: (b))

	)

123 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


124 
	gmem_dump_bufãr_size
;

125 *
	gmem_dump_bufãr
;

127 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


128 *
	$¦si_´št_ev’t_Çme
(
ev’t_id
)

130 
ev’t_id
) {

131 
SLSI_NL80211_SCAN_RESULTS_AVAILABLE_EVENT
:

133 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
:

135 
SLSI_NL80211_SCAN_EVENT
:

137 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


138 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
:

141 
SLSI_NL80211_VENDOR_HANGED_EVENT
:

143 
SLSI_NL80211_EPNO_EVENT
:

145 
SLSI_NL80211_HOTSPOT_MATCH
:

147 
SLSI_NL80211_RSSI_REPORT_EVENT
:

149 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


150 
SLSI_NL80211_LOGGER_RING_EVENT
:

152 
SLSI_NL80211_LOGGER_FW_DUMP_EVENT
:

155 
SLSI_NL80211_NAN_RESPONSE_EVENT
:

157 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
:

159 
SLSI_NL80211_NAN_MATCH_EVENT
:

161 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
:

163 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
:

165 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
:

167 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
:

169 
SLSI_NL80211_RTT_RESULT_EVENT
:

171 
SLSI_NL80211_RTT_COMPLETE_EVENT
:

173 
SLSI_NL80211_VENDOR_ACS_EVENT
:

175 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
:

177 
SLSI_NAN_EVENT_NDP_REQ
:

179 
SLSI_NAN_EVENT_NDP_CFM
:

181 
SLSI_NAN_EVENT_NDP_END
:

183 
SLSI_NL80211_SUBSYSTEM_RESTART_EVENT
:

185 
SLSI_NL80211_NAN_INTERFACE_CREATED_EVENT
:

187 
SLSI_NL80211_NAN_INTERFACE_DELETED_EVENT
:

192 
	}
}

195 
	$¦si_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
ev’t_id
, cÚ¡ *
d©a
, 
Ën
)

197 
sk_buff
 *
skb
;

198 
»t
 = 0;

200 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


201 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "Event: %s(%d), data = %p,†en = %d\n",

202 
	`¦si_´št_ev’t_Çme
(
ev’t_id
),ƒv’t_id, 
d©a
, 
Ën
);

205 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

206 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
Ën
, 
ev’t_id
, 
GFP_KERNEL
);

208 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
Ën
, 
ev’t_id
, 
GFP_KERNEL
);

210 ià(!
skb
) {

211 
	`SLSI_ERR_NODEV
("FaedØ®loÿ‹ skb fÜ v’dÜƒv’t: %d\n", 
ev’t_id
);

212  -
ENOMEM
;

215 
»t
 = 
	`Æa_put_nohdr
(
skb
, 
Ën
, 
d©a
);

216 ià(
»t
) {

217 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

218 
	`kä“_skb
(
skb
);

219  -
EINVAL
;

222 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

225 
	}
}

227 
	$¦si_v’dÜ_cmd_»¶y
(
why
 *why, cÚ¡ *
d©a
, 
Ën
)

229 
sk_buff
 *
skb
;

230 
»t
 = 0;

232 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
Ën
);

233 ià(!
skb
) {

234 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb\n");

235  -
ENOMEM
;

238 
»t
 = 
	`Æa_put_nohdr
(
skb
, 
Ën
, 
d©a
);

239 ià(
»t
) {

240 
	`SLSI_ERR_NODEV
("E¼Ü iÀÆa_put_*:%x\n", 
»t
);

241 
	`kä“_skb
(
skb
);

242  -
EINVAL
;

244  
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

245 
	}
}

247 
Ãt_deviû
 *
	$¦si_gsÿn_g‘_Ãtdev
(
¦si_dev
 *
sdev
)

249  
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

250 
	}
}

252 
Ãtdev_vif
 *
	$¦si_gsÿn_g‘_vif
(
¦si_dev
 *
sdev
)

254 
Ãt_deviû
 *
dev
;

256 
dev
 = 
	`¦si_gsÿn_g‘_Ãtdev
(
sdev
);

257 ià(!
dev
) {

258 
	`SLSI_WARN_NODEV
("Dev is NULL\n");

259  
NULL
;

262  
	`Ãtdev_´iv
(
dev
);

263 
	}
}

265 
	$¦si_numb”_dig™s
(
num
)

267 
dig
 = 0;

269 
num
) {

270 
dig
++;

271 
num
 =‚um / 10;

274  
dig
;

275 
	}
}

277 *
	$¦si_´št_chªÃl_li¡
(
chªÃl_li¡
[], 
chªÃl_couÁ
)

279 
i
, 
¦’
 = 0;

280 
max_size
;

281 *
¡ršg
;

283 ià(!
chªÃl_couÁ
)

284 
max_size
 = 2;

286 
max_size
 = (
chªÃl_couÁ
 * 4) + 1;

288 
¡ršg
 = 
	`km®loc
(
max_size
, 
GFP_KERNEL
);

290 ià(!
¡ršg
) {

291 
	`SLSI_ERR_NODEV
("Failedo‡llocate channel string\n");

292  
¡ršg
;

295 ià(!
chªÃl_couÁ
) {

296 
	`¢´štf
(
¡ršg
, 
max_size
, "%d", 0);

297  
¡ršg
;

300 
i
 = 0; i < 
chªÃl_couÁ
 && 
¦’
 < 
max_size
; i++)

301 
¦’
 +ğ
	`¢´štf
(&
¡ršg
[¦’], 
max_size
 - sËn, "%d ", 
chªÃl_li¡
[
i
]);

303  
¡ršg
;

304 
	}
}

306 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


307 
	$¦si_gsÿn_add_dump_·¿ms
(
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
)

309 
i
;

310 
j
;

312 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "Parameters for SLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN sub-command:\n");

313 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "base_period: %d max_ap_per_scan: %d„eport_threshold_percent: %d„eport_threshold_num_scans = %d‚um_buckets: %d\n",

314 
Æ_gsÿn_·¿m
->
ba£_³riod
,‚l_gsÿn_·¿m->
max_­_³r_sÿn
,

315 
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
,‚l_gsÿn_·¿m->
»pÜt_th»shŞd_num_sÿns
,

316 
Æ_gsÿn_·¿m
->
num_buck‘s
);

318 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++) {

319 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "Buck‘: %d\n", 
i
);

320 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "\tbucket_index: %d band: %d…eriod: %d„eport_events: %d‚um_channels: %d\n",

321 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
buck‘_šdex
,‚l_gsÿn_·¿m->Æ_buck‘[i].
bªd
,

322 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
³riod
,‚l_gsÿn_·¿m->Æ_buck‘[i].
»pÜt_ev’ts
,

323 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
num_chªÃls
);

325 
j
 = 0; j < 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
num_chªÃls
; j++)

326 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "\tchannel_list[%d]: %d\n",

327 
j
, 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
chªÃls
[j].
chªÃl
);

329 
	}
}

331 
	$¦si_gsÿn_sÿn_»s_dump
(
¦si_gsÿn_»suÉ
 *
sÿn_d©a
)

333 
¦si_Æ_sÿn_»suÉ_·¿m
 *
Æ_sÿn_»s
 = &
sÿn_d©a
->nl_scan_res;

335 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "TS:%llu SSID:%s BSSID:%pM Chan:%d RSSI:%d Bcn_Int:%d Capab:%#x IE_Len:%d\n",

336 
Æ_sÿn_»s
->
ts
,‚l_sÿn_»s->
ssid
,‚l_sÿn_»s->
bssid
,‚l_sÿn_»s->
chªÃl
,

337 
Æ_sÿn_»s
->
rssi
,‚l_sÿn_»s->
b—cÚ_³riod
,‚l_sÿn_»s->
ÿ·b™y
,‚l_sÿn_»s->
›_Ëngth
);

339 
	`SLSI_DBG_HEX_NODEV
(
SLSI_GSCAN
, &
Æ_sÿn_»s
->
›_d©a
[0],‚l_sÿn_»s->
›_Ëngth
, "IE_Data:\n");

340 ià(
sÿn_d©a
->
ªqp_Ëngth
) {

341 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "ANQP_LENGTH:%d\n", 
sÿn_d©a
->
ªqp_Ëngth
);

342 
	`SLSI_DBG_HEX_NODEV
(
SLSI_GSCAN
, 
Æ_sÿn_»s
->
›_d©a
 +‚l_sÿn_»s->
›_Ëngth
, 
sÿn_d©a
->
ªqp_Ëngth
, "ANQP_info:\n");

344 
	}
}

347 
	$¦si_gsÿn_g‘_ÿ·b™›s
(
why
 *wiphy,

348 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

350 
¦si_Æ_gsÿn_ÿ·b™›s
 
Æ_ÿp
;

351 
»t
 = 0;

352 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

354 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_GET_GSCAN_CAPABILITIES\n");

355 ià(!
	`¦si_dev_gsÿn_suµÜ‹d
())

356  -
ENOTSUPP
;

358 
	`mem£t
(&
Æ_ÿp
, 0, (
¦si_Æ_gsÿn_ÿ·b™›s
));

360 
»t
 = 
	`¦si_mib_g‘_gsÿn_ÿp
(
sdev
, &
Æ_ÿp
);

361 ià(
»t
 != 0) {

362 
	`SLSI_ERR
(
sdev
, "Failedo„ead mib\n");

363  
»t
;

366 
Æ_ÿp
.
max_sÿn_ÿche_size
 = 
SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
;

367 
Æ_ÿp
.
max_­_ÿche_³r_sÿn
 = 
SLSI_GSCAN_MAX_AP_CACHE_PER_SCAN
;

368 
Æ_ÿp
.
max_sÿn_»pÜtšg_th»shŞd
 = 
SLSI_GSCAN_MAX_SCAN_REPORTING_THRESHOLD
;

370 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
Æ_ÿp
, (
¦si_Æ_gsÿn_ÿ·b™›s
));

371 ià(
»t
)

372 
	`SLSI_ERR_NODEV
("gsÿn_g‘_ÿ·b™› v’dÜ cmd„•ly faed (”¸ğ%d)\n", 
»t
);

374  
»t
;

375 
	}
}

377 
u32
 
	$¦si_gsÿn_put_chªÃls
(
›“80211_suµÜ‹d_bªd
 *
chª_d©a
, 
boŞ
 
no_dfs
, boŞ 
Úly_dfs
, 
u32
 *
buf
)

379 
u32
 
chª_couÁ
 = 0;

380 
u32
 
chª_æags
;

381 
i
;

383 ià(
chª_d©a
 =ğ
NULL
) {

384 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "Band‚ot supported\n");

387 
chª_æags
 = (
IEEE80211_CHAN_NO_IR
 | 
IEEE80211_CHAN_NO_OFDM
 | 
IEEE80211_CHAN_RADAR
);

389 
i
 = 0; i < 
chª_d©a
->
n_chªÃls
; i++) {

390 ià(
chª_d©a
->
chªÃls
[
i
].
æags
 & 
IEEE80211_CHAN_DISABLED
)

392 ià(
Úly_dfs
) {

393 ià(
chª_d©a
->
chªÃls
[
i
].
æags
 & 
chª_æags
)

394 
buf
[
chª_couÁ
++] = 
chª_d©a
->
chªÃls
[
i
].
ûÁ”_äeq
;

397 ià(
no_dfs
 && (
chª_d©a
->
chªÃls
[
i
].
æags
 & 
chª_æags
))

399 
buf
[
chª_couÁ
++] = 
chª_d©a
->
chªÃls
[
i
].
ûÁ”_äeq
;

401  
chª_couÁ
;

402 
	}
}

404 
	$¦si_gsÿn_g‘_v®id_chªÃl
(
why
 *wiphy,

405 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

407 
»t
 = 0, 
ty³
, 
bªd
;

408 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

409 
u32
 *
chª_li¡
;

410 
u32
 
chª_couÁ
 = 0, 
mem_Ën
 = 0;

411 
sk_buff
 *
»¶y
;

413 ià(
Ën
 < 
SLSI_NL_VENDOR_DATA_OVERHEAD
 || !
d©a
)

414  -
EINVAL
;

416 
ty³
 = 
	`Æa_ty³
(
d©a
);

418 ià(
ty³
 =ğ
GSCAN_ATTRIBUTE_BAND
) {

419 ià(
	`¦si_ut_Æa_g‘_u32
((
Æ©Œ
 *)
d©a
, (
u32
 *)(&
bªd
)))

420  -
EINVAL
;

422  -
EINVAL
;

424 ià(
bªd
 == 0) {

425 
	`SLSI_WARN
(
sdev
, "NO Bands.„eturn 0 channel\n");

426  
»t
;

429 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

430 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "bªd %d\n", 
bªd
);

431 ià(
why
->
bªds
[
NL80211_BAND_2GHZ
])

432 
mem_Ën
 +ğ
why
->
bªds
[
NL80211_BAND_2GHZ
]->
n_chªÃls
 * (
u32
);

434 ià(
why
->
bªds
[
NL80211_BAND_5GHZ
])

435 
mem_Ën
 +ğ
why
->
bªds
[
NL80211_BAND_5GHZ
]->
n_chªÃls
 * (
u32
);

437 ià(
mem_Ën
 == 0) {

438 
»t
 = -
ENOTSUPP
;

439 
ex™
;

442 
chª_li¡
 = 
	`km®loc
(
mem_Ën
, 
GFP_KERNEL
);

443 ià(
chª_li¡
 =ğ
NULL
) {

444 
»t
 = -
ENOMEM
;

445 
ex™
;

447 
mem_Ën
 +ğ
SLSI_NL_VENDOR_REPLY_OVERHEAD
 + (
SLSI_NL_ATTRIBUTE_U32_LEN
 * 2);

448 
»¶y
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
mem_Ën
);

449 ià(
»¶y
 =ğ
NULL
) {

450 
»t
 = -
ENOMEM
;

451 
ex™_w™h_chª_li¡
;

453 
bªd
) {

454 
WIFI_BAND_BG
:

455 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_2GHZ
], 
çl£
, f®£, 
chª_li¡
);

457 
WIFI_BAND_A
:

458 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
Œue
, 
çl£
, 
chª_li¡
);

460 
WIFI_BAND_A_DFS
:

461 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
çl£
, 
Œue
, 
chª_li¡
);

463 
WIFI_BAND_A_WITH_DFS
:

464 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
çl£
, f®£, 
chª_li¡
);

466 
WIFI_BAND_ABG
:

467 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_2GHZ
], 
Œue
, 
çl£
, 
chª_li¡
);

468 
chª_couÁ
 +ğ
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
Œue
, 
çl£
, 
chª_li¡
 + chan_count);

470 
WIFI_BAND_ABG_WITH_DFS
:

471 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_2GHZ
], 
çl£
, f®£, 
chª_li¡
);

472 
chª_couÁ
 +ğ
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
çl£
, f®£, 
chª_li¡
 + chan_count);

475 
chª_couÁ
 = 0;

476 
	`SLSI_WARN
(
sdev
, "Inv®id Bªd %d\n", 
bªd
);

478 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
GSCAN_ATTRIBUTE_NUM_CHANNELS
, 
chª_couÁ
);

479 
»t
 |ğ
	`Æa_put
(
»¶y
, 
GSCAN_ATTRIBUTE_CHANNEL_LIST
, 
chª_couÁ
 * (
u32
), 
chª_li¡
);

480 ià(
»t
) {

481 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

482 
	`kä“_skb
(
»¶y
);

483 
ex™_w™h_chª_li¡
;

485 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
»¶y
);

487 ià(
»t
)

488 
	`SLSI_ERR
(
sdev
, "FAILEDo„eply GET_VALID_CHANNELS\n");

490 
ex™_w™h_chª_li¡
:

491 
	`kä“
(
chª_li¡
);

492 
ex™
:

493 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

494  
»t
;

495 
	}
}

497 
¦si_gsÿn_»suÉ
 *
	$¦si_´•¬e_sÿn_»suÉ
(
sk_buff
 *
skb
, 
u16
 
ªqp_Ëngth
, 
hs2_id
)

499 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

500 
¦si_gsÿn_»suÉ
 *
sÿn_»s
;

501 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

502 
time¥ec64
 
ts
;

504 
time¥ec
 
ts
;

506 cÚ¡ 
u8
 *
ssid_›
;

507 
mem_»qd
;

508 
›_Ën
 = 0;

509 
u8
 *
›
;

511 
›
 = &
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
[0];

512 
›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
è- (
›
 - (
u8
 *)
mgmt
è- 
ªqp_Ëngth
;

514 ià(
›_Ën
 <= 0) {

515 
	`SLSI_ERR_NODEV
("šv®id ie_ËÀ: %d\n", 
›_Ën
);

516  
NULL
;

520 
mem_»qd
 = ((
¦si_gsÿn_»suÉ
è- 1è+ 
›_Ën
 + 
ªqp_Ëngth
 + (è+ (
u16
);

523 
sÿn_»s
 = 
	`km®loc
(
mem_»qd
, 
GFP_KERNEL
);

524 ià(
sÿn_»s
 =ğ
NULL
) {

525 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for scan„esult\n");

526  
NULL
;

530 
sÿn_»s
->
sÿn_»s_Ën
 = ((
¦si_Æ_sÿn_»suÉ_·¿m
è- 1è+ 
›_Ën
;

531 
sÿn_»s
->
ªqp_Ëngth
 = 0;

532 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

533 
ts
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

534 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

535 
ts
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

537 
	`g‘_mÚÙÚic_boÙtime
(&
ts
);

539 
sÿn_»s
->
Æ_sÿn_»s
.
ts
 = (
u64
)
	`TIMESPEC_TO_US
(ts);

541 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, &
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
[0], 
›_Ën
);

542 ià((
ssid_›
 !ğ
NULL
è&& (ssid_›[1] > 0è&& (ssid_›[1] < 
IEEE80211_MAX_SSID_LEN
)) {

543 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
ssid
, &
ssid_›
[2], ssid_ie[1]);

544 
sÿn_»s
->
Æ_sÿn_»s
.
ssid
[
ssid_›
[1]] = '\0';

546 
sÿn_»s
->
Æ_sÿn_»s
.
ssid
[0] = '\0';

549 
	`SLSI_ETHER_COPY
(
sÿn_»s
->
Æ_sÿn_»s
.
bssid
, 
mgmt
->bssid);

550 
sÿn_»s
->
Æ_sÿn_»s
.
chªÃl
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2;

551 
sÿn_»s
->
Æ_sÿn_»s
.
rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.rssi);

552 
sÿn_»s
->
Æ_sÿn_»s
.
¹t
 = 
SLSI_GSCAN_RTT_UNSPECIFIED
;

553 
sÿn_»s
->
Æ_sÿn_»s
.
¹t_sd
 = 
SLSI_GSCAN_RTT_UNSPECIFIED
;

554 
sÿn_»s
->
Æ_sÿn_»s
.
b—cÚ_³riod
 = 
mgmt
->
u
.
b—cÚ
.
b—cÚ_št
;

555 
sÿn_»s
->
Æ_sÿn_»s
.
ÿ·b™y
 = 
mgmt
->
u
.
b—cÚ
.
ÿ·b_šfo
;

556 
sÿn_»s
->
Æ_sÿn_»s
.
›_Ëngth
 = 
›_Ën
;

557 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
, 
›
, 
›_Ën
);

558 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
 + 
›_Ën
, &
hs2_id
, ());

559 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
 + 
›_Ën
 + (), &
ªqp_Ëngth
, (
u16
));

560 ià(
ªqp_Ëngth
) {

561 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
 + 
›_Ën
 + (
u16
è+ (), 
›
 + ie_Ën, 
ªqp_Ëngth
);

562 
sÿn_»s
->
ªqp_Ëngth
 =‡nqp_Ëngth + (
u16
) + ();

565 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


566 
	`¦si_gsÿn_sÿn_»s_dump
(
sÿn_»s
);

569  
sÿn_»s
;

570 
	}
}

572 
	$¦si_gsÿn_hash_add
(
¦si_dev
 *
sdev
, 
¦si_gsÿn_»suÉ
 *
sÿn_»s
)

574 
u8
 
key
 = 
	`SLSI_GSCAN_GET_HASH_KEY
(
sÿn_»s
->
Æ_sÿn_»s
.
bssid
[5]);

575 
Ãtdev_vif
 *
ndev_vif
;

577 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

578 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

579 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

581 
sÿn_»s
->
hÃxt
 = 
sdev
->
gsÿn_hash_bË
[
key
];

582 
sdev
->
gsÿn_hash_bË
[
key
] = 
sÿn_»s
;

585 
sdev
->
bufãr_cÚsumed
 +ğ
sÿn_»s
->
sÿn_»s_Ën
;

586 
sdev
->
num_gsÿn_»suÉs
++;

587 
	}
}

589 
¦si_gsÿn_»suÉ
 *
	$¦si_gsÿn_hash_g‘
(
¦si_dev
 *
sdev
, 
u8
 *
mac
)

591 
¦si_gsÿn_»suÉ
 *
‹mp
;

592 
Ãtdev_vif
 *
ndev_vif
;

593 
u8
 
key
 = 
	`SLSI_GSCAN_GET_HASH_KEY
(
mac
[5]);

595 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

597 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

598 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

600 
‹mp
 = 
sdev
->
gsÿn_hash_bË
[
key
];

601 
‹mp
 !ğ
NULL
) {

602 ià(
	`memcmp
(
‹mp
->
Æ_sÿn_»s
.
bssid
, 
mac
, 
ETH_ALEN
) == 0)

603  
‹mp
;

604 
‹mp
 =emp->
hÃxt
;

607  
NULL
;

608 
	}
}

610 
	$¦si_gsÿn_hash_»move
(
¦si_dev
 *
sdev
, 
u8
 *
mac
)

612 
u8
 
key
 = 
	`SLSI_GSCAN_GET_HASH_KEY
(
mac
[5]);

613 
¦si_gsÿn_»suÉ
 *
cu¼
;

614 
¦si_gsÿn_»suÉ
 *
´ev
;

615 
Ãtdev_vif
 *
ndev_vif
;

616 
¦si_gsÿn_»suÉ
 *
sÿn_»s
 = 
NULL
;

618 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

619 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

620 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

622 ià(
sdev
->
gsÿn_hash_bË
[
key
] =ğ
NULL
)

625 ià(
	`memcmp
(
sdev
->
gsÿn_hash_bË
[
key
]->
Æ_sÿn_»s
.
bssid
, 
mac
, 
ETH_ALEN
) == 0) {

626 
sÿn_»s
 = 
sdev
->
gsÿn_hash_bË
[
key
];

627 
sdev
->
gsÿn_hash_bË
[
key
] = sdev->gsÿn_hash_bË[key]->
hÃxt
;

629 
´ev
 = 
sdev
->
gsÿn_hash_bË
[
key
];

630 
cu¼
 = 
´ev
->
hÃxt
;

632 
cu¼
 !ğ
NULL
) {

633 ià(
	`memcmp
(
cu¼
->
Æ_sÿn_»s
.
bssid
, 
mac
, 
ETH_ALEN
) == 0) {

634 
sÿn_»s
 = 
cu¼
;

635 
´ev
->
hÃxt
 = 
cu¼
->hnext;

638 
´ev
 = 
cu¼
;

639 
cu¼
 = cu¼->
hÃxt
;

643 ià(
sÿn_»s
) {

645 
sdev
->
bufãr_cÚsumed
 -ğ
sÿn_»s
->
sÿn_»s_Ën
;

646 
sdev
->
num_gsÿn_»suÉs
--;

647 
	`kä“
(
sÿn_»s
);

650 ià(
sdev
->
num_gsÿn_»suÉs
 < 0)

651 
	`SLSI_ERR
(
sdev
, "WrÚg‚um_gsÿn_»suÉs: %d\n", sdev->
num_gsÿn_»suÉs
);

652 
	}
}

654 
	$¦si_check_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
¦si_buck‘
 *
buck‘
, 
¦si_gsÿn_»suÉ
 *
Ãw_sÿn_»s
)

656 
¦si_gsÿn_»suÉ
 *
sÿn_»s
;

659 
sÿn_»s
 = 
	`¦si_gsÿn_hash_g‘
(
sdev
, 
Ãw_sÿn_»s
->
Æ_sÿn_»s
.
bssid
);

660 ià(
sÿn_»s
 =ğ
NULL
) {

661 ià((
sdev
->
bufãr_cÚsumed
 + 
Ãw_sÿn_»s
->
sÿn_»s_Ën
è>ğ
SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
) {

662 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
,

664 
sdev
->
bufãr_cÚsumed
, sdev->
bufãr_th»shŞd
);

667  
SLSI_DISCARD_SCAN_RESULT
;

670  
SLSI_KEEP_SCAN_RESULT
;

674 ià(
sÿn_»s
->
sÿn_cyşe
 =ğ
buck‘
->scan_cycle)

676 ià(
Ãw_sÿn_»s
->
Æ_sÿn_»s
.
rssi
 < 
sÿn_»s
->nl_scan_res.rssi)

677  
SLSI_DISCARD_SCAN_RESULT
;

680 
	`¦si_gsÿn_hash_»move
(
sdev
, 
sÿn_»s
->
Æ_sÿn_»s
.
bssid
);

682  
SLSI_KEEP_SCAN_RESULT
;

683 
	}
}

685 
	$¦si_gsÿn_hªdË_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_dÚe
)

687 
¦si_gsÿn_»suÉ
 *
sÿn_»s
 = 
NULL
;

688 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

689 
¦si_buck‘
 *
buck‘
;

690 
u16
 
buck‘_šdex
;

691 
ev’t_ty³
 = 
WIFI_SCAN_FAILED
;

692 
u16
 
ªqp_Ëngth
 = 0;

693 
hs2_ÃtwÜk_id
;

695 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

696 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

698 
	`SLSI_NET_DBG_HEX
(
dev
, 
SLSI_GSCAN
, 
skb
->
d©a
, skb->
Ën
, "mlme_scan_ind skb->len: %d\n", skb->len);

700 
buck‘_šdex
 = 
sÿn_id
 - 
SLSI_GSCAN_SCAN_ID_START
;

701 ià(
buck‘_šdex
 >ğ
SLSI_GSCAN_MAX_BUCKETS
) {

702 
	`SLSI_NET_ERR
(
dev
, "Inv®id buck‘ index: %d (sÿn_id = %#x)\n", 
buck‘_šdex
, 
sÿn_id
);

703 
out
;

706 
buck‘
 = &
sdev
->buck‘[
buck‘_šdex
];

707 ià(!
buck‘
->
u£d
) {

708 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_GSCAN
, "Buck‘ i nÙ‡ùive, index: %d (sÿn_id = %#x)\n", 
buck‘_šdex
, 
sÿn_id
);

709 
out
;

713 ià(
sÿn_dÚe
) {

714 
buck‘
->
sÿn_cyşe
++;

715 
buck‘
->
gsÿn
->
num_sÿns
++;

717 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "scan done, scan_cycle = %d,‚um_scans = %d\n",

718 
buck‘
->
sÿn_cyşe
, buck‘->
gsÿn
->
num_sÿns
);

720 ià(
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_EACH_SCAN
)

721 
ev’t_ty³
 = 
WIFI_SCAN_RESULTS_AVAILABLE
;

722 ià(
buck‘
->
gsÿn
->
num_sÿns
 % buck‘->gsÿn->
»pÜt_th»shŞd_num_sÿns
 == 0)

723 
ev’t_ty³
 = 
WIFI_SCAN_THRESHOLD_NUM_SCANS
;

724 ià(
sdev
->
bufãr_cÚsumed
 >ğsdev->
bufãr_th»shŞd
)

725 
ev’t_ty³
 = 
WIFI_SCAN_THRESHOLD_PERCENT
;

727 ià(
ev’t_ty³
 !ğ
WIFI_SCAN_FAILED
)

728 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_SCAN_EVENT
, &
ev’t_ty³
, (event_type));

730 
out
;

735 
hs2_ÃtwÜk_id
 = 1;

737 
sÿn_»s
 = 
	`¦si_´•¬e_sÿn_»suÉ
(
skb
, 
ªqp_Ëngth
, 
hs2_ÃtwÜk_id
);

738 ià(
sÿn_»s
 =ğ
NULL
) {

739 
	`SLSI_NET_ERR
(
dev
, "Failedo…repare scan„esult\n");

740 
out
;

744 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
´eã¼edÃtwÜk_­
)) {

745 ià(
ªqp_Ëngth
 == 0)

746 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_EPNO_EVENT
,

747 &
sÿn_»s
->
Æ_sÿn_»s
, sÿn_»s->
sÿn_»s_Ën
);

749 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_HOTSPOT_MATCH
,

750 &
sÿn_»s
->
Æ_sÿn_»s
, sÿn_»s->
sÿn_»s_Ën
 + sÿn_»s->
ªqp_Ëngth
);

753 ià(
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_FULL_RESULTS
) {

754 
sk_buff
 *
Æev’t
;

756 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "report_events: SLSI_REPORT_EVENTS_FULL_RESULTS\n");

757 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

758 
Æev’t
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
sÿn_»s
->
sÿn_»s_Ën
 + 4, 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
, 
GFP_KERNEL
);

760 
Æev’t
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
sÿn_»s
->
sÿn_»s_Ën
 + 4, 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
, 
GFP_KERNEL
);

762 ià(!
Æev’t
) {

763 
	`SLSI_ERR
(
sdev
, "çedØ®loÿ‹ sbk oàsize:%d\n", 
sÿn_»s
->
sÿn_»s_Ën
 + 4);

764 
	`kä“
(
sÿn_»s
);

765 
out
;

767 ià(
	`Æa_put_u32
(
Æev’t
, 
GSCAN_ATTRIBUTE_SCAN_BUCKET_BIT
, (1 << 
buck‘_šdex
)) ||

768 
	`Æa_put
(
Æev’t
, 
GSCAN_ATTRIBUTE_SCAN_RESULTS
, 
sÿn_»s
->
sÿn_»s_Ën
, &sÿn_»s->
Æ_sÿn_»s
)) {

769 
	`SLSI_ERR
(
sdev
, "failedo…ut data\n");

770 
	`kä“_skb
(
Æev’t
);

771 
	`kä“
(
sÿn_»s
);

772 
out
;

774 
	`cfg80211_v’dÜ_ev’t
(
Æev’t
, 
GFP_KERNEL
);

777 ià(
	`¦si_check_sÿn_»suÉ
(
sdev
, 
buck‘
, 
sÿn_»s
è=ğ
SLSI_DISCARD_SCAN_RESULT
) {

778 
	`kä“
(
sÿn_»s
);

779 
out
;

781 
	`¦si_gsÿn_hash_add
(
sdev
, 
sÿn_»s
);

783 
out
:

784 
	`kä“_skb
(
skb
);

785 
	}
}

787 
u8
 
	$¦si_gsÿn_g‘_sÿn_pŞicy
(
wifi_bªd
 
bªd
)

789 
u8
 
sÿn_pŞicy
;

791 
bªd
) {

792 
WIFI_BAND_UNSPECIFIED
:

793 
sÿn_pŞicy
 = 
FAPI_SCANPOLICY_ANY_RA
;

795 
WIFI_BAND_BG
:

796 
sÿn_pŞicy
 = 
FAPI_SCANPOLICY_2_4GHZ
;

798 
WIFI_BAND_A
:

799 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

800 
FAPI_SCANPOLICY_NON_DFS
);

802 
WIFI_BAND_A_DFS
:

803 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

804 
FAPI_SCANPOLICY_DFS
);

806 
WIFI_BAND_A_WITH_DFS
:

807 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

808 
FAPI_SCANPOLICY_NON_DFS
 |

809 
FAPI_SCANPOLICY_DFS
);

811 
WIFI_BAND_ABG
:

812 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

813 
FAPI_SCANPOLICY_NON_DFS
 |

814 
FAPI_SCANPOLICY_2_4GHZ
);

816 
WIFI_BAND_ABG_WITH_DFS
:

817 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

818 
FAPI_SCANPOLICY_NON_DFS
 |

819 
FAPI_SCANPOLICY_DFS
 |

820 
FAPI_SCANPOLICY_2_4GHZ
);

823 
sÿn_pŞicy
 = 
FAPI_SCANPOLICY_ANY_RA
;

827 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "SÿÀPŞicy: %#x\n", 
sÿn_pŞicy
);

829  
sÿn_pŞicy
;

830 
	}
}

832 
	$¦si_gsÿn_add_»ad_·¿ms
(
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
, cÚ¡ *
d©a
, 
Ën
)

834 
j
 = 0;

835 
ty³
, 
tmp
, 
tmp1
, 
tmp2
, 
k
 = 0;

836 cÚ¡ 
Æ©Œ
 *
™”
, *
™”1
, *
™”2
;

837 
¦si_Æ_buck‘_·¿m
 *
Æ_buck‘
;

838 
u32
 
v®
 = 0;

840 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

841 ià(!
™”
)

842  -
EINVAL
;

844 
ty³
 = 
	`Æa_ty³
(
™”
);

846 ià(
j
 >ğ
SLSI_GSCAN_MAX_BUCKETS
)

849 
ty³
) {

850 
GSCAN_ATTRIBUTE_BASE_PERIOD
:

851 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
ba£_³riod
))

852  -
EINVAL
;

854 
GSCAN_ATTRIBUTE_NUM_AP_PER_SCAN
:

855 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
max_­_³r_sÿn
))

856  -
EINVAL
;

858 
GSCAN_ATTRIBUTE_REPORT_THRESHOLD
:

859 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
))

860  -
EINVAL
;

862 
GSCAN_ATTRIBUTE_REPORT_THRESHOLD_NUM_SCANS
:

863 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_num_sÿns
))

864  -
EINVAL
;

866 
GSCAN_ATTRIBUTE_NUM_BUCKETS
:

867 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
num_buck‘s
))

868  -
EINVAL
;

870 
GSCAN_ATTRIBUTE_CH_BUCKET_1
:

871 
GSCAN_ATTRIBUTE_CH_BUCKET_2
:

872 
GSCAN_ATTRIBUTE_CH_BUCKET_3
:

873 
GSCAN_ATTRIBUTE_CH_BUCKET_4
:

874 
GSCAN_ATTRIBUTE_CH_BUCKET_5
:

875 
GSCAN_ATTRIBUTE_CH_BUCKET_6
:

876 
GSCAN_ATTRIBUTE_CH_BUCKET_7
:

877 
GSCAN_ATTRIBUTE_CH_BUCKET_8
:

878 
	`Æa_fÜ_—ch_Ã¡ed
(
™”1
, 
™”
, 
tmp1
) {

879 ià(!
™”1
)

880  -
EINVAL
;

882 
ty³
 = 
	`Æa_ty³
(
™”1
);

884 
Æ_buck‘
 = 
Æ_gsÿn_·¿m
->nl_bucket;

886 
ty³
) {

887 
GSCAN_ATTRIBUTE_BUCKET_ID
:

888 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
buck‘_šdex
)))

889  -
EINVAL
;

891 
GSCAN_ATTRIBUTE_BUCKET_PERIOD
:

892 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
³riod
)))

893  -
EINVAL
;

895 
GSCAN_ATTRIBUTE_BUCKET_NUM_CHANNELS
:

896 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
num_chªÃls
)))

897  -
EINVAL
;

899 
GSCAN_ATTRIBUTE_BUCKET_CHANNELS
:

900 
	`Æa_fÜ_—ch_Ã¡ed
(
™”2
, 
™”1
, 
tmp2
) {

901 ià(
k
 >ğ
SLSI_GSCAN_MAX_CHANNELS
)

903 ià(
	`¦si_ut_Æa_g‘_u32
(
™”2
, &(
Æ_buck‘
[
j
].
chªÃls
[
k
].
chªÃl
)))

904  -
EINVAL
;

905 
k
++;

907 
k
 = 0;

909 
GSCAN_ATTRIBUTE_BUCKETS_BAND
:

910 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
bªd
)))

911  -
EINVAL
;

913 
GSCAN_ATTRIBUTE_REPORT_EVENTS
:

914 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &
v®
))

915  -
EINVAL
;

916 
Æ_buck‘
[
j
].
»pÜt_ev’ts
 = (
u8
)
v®
;

918 
GSCAN_ATTRIBUTE_BUCKET_EXPONENT
:

919 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
expÚ’t
)))

920  -
EINVAL
;

922 
GSCAN_ATTRIBUTE_BUCKET_STEP_COUNT
:

923 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
¡•_couÁ
)))

924  -
EINVAL
;

926 
GSCAN_ATTRIBUTE_BUCKET_MAX_PERIOD
:

927 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
max_³riod
)))

928  -
EINVAL
;

931 
	`SLSI_ERR_NODEV
("NØATTR_BUKTS_ty³ - %x\n", 
ty³
);

935 
j
++;

938 
	`SLSI_ERR_NODEV
("NØGSCAN_ATTR_CH_BUKT_ty³ - %x\n", 
ty³
);

944 
	}
}

946 
	$¦si_gsÿn_add_v”ify_·¿ms
(
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
)

948 
i
;

950 ià((
Æ_gsÿn_·¿m
->
max_­_³r_sÿn
 < 0è|| (Æ_gsÿn_·¿m->max_­_³r_sÿÀ> 
SLSI_GSCAN_MAX_AP_CACHE_PER_SCAN
)) {

951 
	`SLSI_ERR_NODEV
("Inv®id max_­_³r_sÿn: %d\n", 
Æ_gsÿn_·¿m
->
max_­_³r_sÿn
);

952  -
EINVAL
;

955 ià((
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
 < 0è|| (Æ_gsÿn_·¿m->»pÜt_th»shŞd_³rûÁ > 
SLSI_GSCAN_MAX_SCAN_REPORTING_THRESHOLD
)) {

956 
	`SLSI_ERR_NODEV
("Inv®id„•Üt_th»shŞd_³rûÁ: %d\n", 
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
);

957  -
EINVAL
;

960 ià((
Æ_gsÿn_·¿m
->
num_buck‘s
 <ğ0è|| (Æ_gsÿn_·¿m->num_buck‘ > 
SLSI_GSCAN_MAX_BUCKETS
)) {

961 
	`SLSI_ERR_NODEV
("Inv®id‚um_buck‘s: %d\n", 
Æ_gsÿn_·¿m
->
num_buck‘s
);

962  -
EINVAL
;

965 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++) {

966 ià((
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
bªd
 =ğ
WIFI_BAND_UNSPECIFIED
è&& (Æ_gsÿn_·¿m->Æ_buck‘[i].
num_chªÃls
 == 0)) {

967 
	`SLSI_ERR_NODEV
("No band/channels…rovided for gscan: band = %d,‚um_channel = %d\n",

968 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
bªd
,‚l_gsÿn_·¿m->Æ_buck‘[i].
num_chªÃls
);

969  -
EINVAL
;

972 ià(
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
»pÜt_ev’ts
 > 4) {

973 
	`SLSI_ERR_NODEV
("UnsuµÜ‹d„•Üˆev’t:„•Üt_ev’ˆğ%d\n", 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
»pÜt_ev’ts
);

974  -
EINVAL
;

979 
	}
}

981 
	$¦si_gsÿn_add_to_li¡
(
¦si_gsÿn
 **
sdev_gsÿn
, ¦si_gsÿÀ*
gsÿn
)

983 
gsÿn
->
Ãxt
 = *
sdev_gsÿn
;

984 *
sdev_gsÿn
 = 
gsÿn
;

985 
	}
}

987 
	$¦si_gsÿn_®loc_buck‘s
(
¦si_dev
 *
sdev
, 
¦si_gsÿn
 *
gsÿn
, 
num_buck‘s
)

989 
i
;

990 
buck‘_šdex
 = 0;

991 
ä“_buck‘s
 = 0;

993 
i
 = 0; i < 
SLSI_GSCAN_MAX_BUCKETS
; i++)

994 ià(!
sdev
->
buck‘
[
i
].
u£d
)

995 
ä“_buck‘s
++;

997 ià(
num_buck‘s
 > 
ä“_buck‘s
) {

998 
	`SLSI_ERR_NODEV
("Notƒnough free buckets,‚um_buckets = %d, free_buckets = %d\n",

999 
num_buck‘s
, 
ä“_buck‘s
);

1000  -
EINVAL
;

1004 
i
 = 0; i < 
SLSI_GSCAN_MAX_BUCKETS
; i++)

1005 ià(!
sdev
->
buck‘
[
i
].
u£d
) {

1006 
sdev
->
buck‘
[
i
].
u£d
 = 
Œue
;

1007 
sdev
->
buck‘
[
i
].
gsÿn
 = gscan;

1008 
gsÿn
->
buck‘
[
buck‘_šdex
] = &
sdev
->buck‘[
i
];

1009 
buck‘_šdex
++;

1010 ià(
buck‘_šdex
 =ğ
num_buck‘s
)

1015 
	}
}

1017 
	$¦si_gsÿn_ä“_buck‘s
(
¦si_gsÿn
 *
gsÿn
)

1019 
¦si_buck‘
 *
buck‘
;

1020 
i
;

1022 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "gsÿÀğ%p,‚um_buck‘ ğ%d\n", 
gsÿn
, gsÿn->
num_buck‘s
);

1024 
i
 = 0; i < 
gsÿn
->
num_buck‘s
; i++) {

1025 
buck‘
 = 
gsÿn
->buck‘[
i
];

1027 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "bucket = %p, used = %d,„eport_events = %d, scan_id = %#x, gscan = %p\n",

1028 
buck‘
, buck‘->
u£d
, buck‘->
»pÜt_ev’ts
, buck‘->
sÿn_id
, buck‘->
gsÿn
);

1029 ià(
buck‘
->
u£d
) {

1030 
buck‘
->
u£d
 = 
çl£
;

1031 
buck‘
->
»pÜt_ev’ts
 = 0;

1032 
buck‘
->
gsÿn
 = 
NULL
;

1035 
	}
}

1037 
	$¦si_gsÿn_æush_sÿn_»suÉs
(
¦si_dev
 *
sdev
)

1039 
Ãtdev_vif
 *
ndev_vif
;

1040 
¦si_gsÿn_»suÉ
 *
‹mp
;

1041 
i
;

1043 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

1044 ià(!
ndev_vif
) {

1045 
	`SLSI_WARN_NODEV
("ndev_vif is NULL");

1049 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1050 
i
 = 0; i < 
SLSI_GSCAN_HASH_TABLE_SIZE
; i++)

1051 
sdev
->
gsÿn_hash_bË
[
i
]) {

1052 
‹mp
 = 
sdev
->
gsÿn_hash_bË
[
i
];

1053 
sdev
->
gsÿn_hash_bË
[
i
] = sdev->gsÿn_hash_bË[i]->
hÃxt
;

1054 
sdev
->
num_gsÿn_»suÉs
--;

1055 
sdev
->
bufãr_cÚsumed
 -ğ
‹mp
->
sÿn_»s_Ën
;

1056 
	`kä“
(
‹mp
);

1059 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "num_gscan_results: %d, buffer_consumed = %d\n",

1060 
sdev
->
num_gsÿn_»suÉs
, sdev->
bufãr_cÚsumed
);

1062 ià(
sdev
->
num_gsÿn_»suÉs
 != 0)

1063 
	`SLSI_WARN_NODEV
("sdev->num_gscan_results is‚ot zero\n");

1065 ià(
sdev
->
bufãr_cÚsumed
 != 0)

1066 
	`SLSI_WARN_NODEV
("sdev->buffer_consumedis‚ot zero\n");

1068 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1069 
	}
}

1071 
	$¦si_gsÿn_add_mlme
(
¦si_dev
 *
sdev
, 
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
, 
¦si_gsÿn
 *
gsÿn
)

1073 
¦si_gsÿn_·¿m
 
gsÿn_·¿m
;

1074 
Ãt_deviû
 *
dev
;

1075 
»t
 = 0;

1076 
i
;

1077 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1078 
j
;

1079 
u8
 
mac_addr_mask
[
ETH_ALEN
];

1082 
dev
 = 
	`¦si_gsÿn_g‘_Ãtdev
(
sdev
);

1084 ià(!
dev
) {

1085 
	`SLSI_WARN_NODEV
("dev is NULL\n");

1086  -
EINVAL
;

1089 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++) {

1090 
u16
 
»pÜt_mode
 = 0;

1092 
gsÿn_·¿m
.
Æ_buck‘
 = &
Æ_gsÿn_·¿m
->Æ_buck‘[
i
];

1093 
gsÿn_·¿m
.
buck‘
 = 
gsÿn
->buck‘[
i
];

1095 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
) {

1096 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_EACH_SCAN
)

1097 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_END_OF_SCAN_CYCLE
;

1098 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_FULL_RESULTS
)

1099 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_REAL_TIME
;

1100 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_NO_BATCH
)

1101 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_NO_BATCH
;

1103 
»pÜt_mode
 = 
FAPI_REPORTMODE_RESERVED
;

1106 ià(
»pÜt_mode
 == 0) {

1107 
	`SLSI_NET_ERR
(
dev
, "Inv®id„•Üˆev’ˆv®ue: %d\n", 
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
);

1108  -
EINVAL
;

1112 ià(
sdev
->
•no_aùive
)

1113 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_NO_BATCH
;

1115 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1116 
	`mem£t
(
mac_addr_mask
, 0xFF, 
ETH_ALEN
);

1117 ià(
sdev
->
sÿn_addr_£t
 == 1) {

1118 
j
 = 3; j < 
ETH_ALEN
; j++)

1119 
mac_addr_mask
[
j
] = 0x00;

1120 
»t
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
mac_addr_mask
);

1121 ià(
»t
)

1122 
sdev
->
sÿn_addr_£t
 = 0;

1124 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
mac_addr_mask
);

1126 
»t
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

1127 
dev
,

1128 
FAPI_SCANTYPE_GSCAN
,

1129 
»pÜt_mode
,

1131 
NULL
,

1132 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
num_chªÃls
,

1133 
NULL
,

1134 &
gsÿn_·¿m
,

1135 
NULL
,

1137 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


1139 
NULL
,

1141 
çl£
 );

1143 ià(
»t
 != 0) {

1144 
	`SLSI_NET_ERR
(
dev
, "FaedØadd buck‘: %d\n", 
i
);

1147 
i
 = (i - 1); i >= 0; i--)

1148 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
gsÿn
->
buck‘
[
i
]->
sÿn_id
, 
çl£
);

1153  
»t
;

1154 
	}
}

1156 
	$¦si_gsÿn_add
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1158 
»t
 = 0;

1159 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1160 
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
 = 
NULL
;

1161 
¦si_gsÿn
 *
gsÿn
;

1162 
Ãtdev_vif
 *
ndev_vif
;

1163 
bufãr_th»shŞd
;

1164 
i
;

1166 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_ADD_GSCAN\n");

1168 ià(!
sdev
) {

1169 
	`SLSI_WARN_NODEV
("sdev is NULL\n");

1170  -
EINVAL
;

1173 ià(!
	`¦si_dev_gsÿn_suµÜ‹d
())

1174  -
ENOTSUPP
;

1176 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

1178 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1180 
Æ_gsÿn_·¿m
 = 
	`kz®loc
((*Æ_gsÿn_·¿m), 
GFP_KERNEL
);

1181 ià(
Æ_gsÿn_·¿m
 =ğ
NULL
) {

1182 
	`SLSI_ERR_NODEV
("Failed for‡llocate memory for gscan…arams\n");

1183 
»t
 = -
ENOMEM
;

1184 
ex™
;

1187 
	`¦si_gsÿn_add_»ad_·¿ms
(
Æ_gsÿn_·¿m
, 
d©a
, 
Ën
);

1189 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1190 
	`¦si_gsÿn_add_dump_·¿ms
(
Æ_gsÿn_·¿m
);

1193 
»t
 = 
	`¦si_gsÿn_add_v”ify_·¿ms
(
Æ_gsÿn_·¿m
);

1194 ià(
»t
) {

1196 ià(
Æ_gsÿn_·¿m
->
num_buck‘s
 == 0) {

1197 
	`kä“
(
Æ_gsÿn_·¿m
);

1198 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1202 
ex™
;

1206 
gsÿn
 = 
	`kz®loc
((*gsÿn), 
GFP_KERNEL
);

1207 ià(
gsÿn
 =ğ
NULL
) {

1208 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for gscan\n");

1209 
»t
 = -
ENOMEM
;

1210 
ex™
;

1213 
gsÿn
->
num_buck‘s
 = 
Æ_gsÿn_·¿m
->num_buckets;

1214 
gsÿn
->
»pÜt_th»shŞd_³rûÁ
 = 
Æ_gsÿn_·¿m
->report_threshold_percent;

1215 
gsÿn
->
»pÜt_th»shŞd_num_sÿns
 = 
Æ_gsÿn_·¿m
->report_threshold_num_scans;

1216 
gsÿn
->
Æ_buck‘
 = 
Æ_gsÿn_·¿m
->nl_bucket[0];

1219 
bufãr_th»shŞd
 = (
SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
 * 
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
) / 100;

1220 ià((
sdev
->
bufãr_th»shŞd
 == 0) || (buffer_threshold < sdev->buffer_threshold))

1221 
sdev
->
bufãr_th»shŞd
 = buffer_threshold;

1223 
»t
 = 
	`¦si_gsÿn_®loc_buck‘s
(
sdev
, 
gsÿn
, 
Æ_gsÿn_·¿m
->
num_buck‘s
);

1224 ià(
»t
)

1225 
ex™_w™h_gsÿn_ä“
;

1227 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++)

1228 
gsÿn
->
buck‘
[
i
]->
»pÜt_ev’ts
 = 
Æ_gsÿn_·¿m
->
Æ_buck‘
[i].report_events;

1230 
»t
 = 
	`¦si_gsÿn_add_mlme
(
sdev
, 
Æ_gsÿn_·¿m
, 
gsÿn
);

1231 ià(
»t
) {

1233 
	`¦si_gsÿn_ä“_buck‘s
(
gsÿn
);

1235 
ex™_w™h_gsÿn_ä“
;

1238 
	`¦si_gsÿn_add_to_li¡
(&
sdev
->
gsÿn
, gscan);

1240 
ex™
;

1242 
ex™_w™h_gsÿn_ä“
:

1243 
	`kä“
(
gsÿn
);

1244 
ex™
:

1245 
	`kä“
(
Æ_gsÿn_·¿m
);

1247 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1248  
»t
;

1249 
	}
}

1251 
	$¦si_gsÿn_d–
(
why
 *wiphy,

1252 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1254 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1255 
Ãt_deviû
 *
dev
;

1256 
Ãtdev_vif
 *
ndev_vif
;

1257 
¦si_gsÿn
 *
gsÿn
;

1258 
»t
 = 0;

1259 
i
;

1261 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_DEL_GSCAN\n");

1263 
dev
 = 
	`¦si_gsÿn_g‘_Ãtdev
(
sdev
);

1264 ià(!
dev
) {

1265 
	`SLSI_WARN_NODEV
("dev is NULL\n");

1266  -
EINVAL
;

1269 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1271 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1272 
sdev
->
gsÿn
 !ğ
NULL
) {

1273 
gsÿn
 = 
sdev
->gscan;

1275 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "gsÿÀğ%p,‚um_buck‘ ğ%d\n", 
gsÿn
, gsÿn->
num_buck‘s
);

1277 
i
 = 0; i < 
gsÿn
->
num_buck‘s
; i++)

1278 ià(
gsÿn
->
buck‘
[
i
]->
u£d
)

1279 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
gsÿn
->
buck‘
[
i
]->
sÿn_id
, 
çl£
);

1280 
	`¦si_gsÿn_ä“_buck‘s
(
gsÿn
);

1281 
sdev
->
gsÿn
 = gsÿn->
Ãxt
;

1282 
	`kä“
(
gsÿn
);

1284 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1286 
	`¦si_gsÿn_æush_sÿn_»suÉs
(
sdev
);

1288 
sdev
->
bufãr_th»shŞd
 = 0;

1290  
»t
;

1291 
	}
}

1293 
	$¦si_gsÿn_g‘_sÿn_»suÉs
(
why
 *wiphy,

1294 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1296 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1297 
sk_buff
 *
skb
;

1298 
¦si_gsÿn_»suÉ
 *
sÿn_»s
;

1299 
Æ©Œ
 *
sÿn_hdr
;

1300 
Ãtdev_vif
 *
ndev_vif
;

1301 
num_»suÉs
 = 0;

1302 
mem_Ãeded
;

1303 cÚ¡ 
Æ©Œ
 *
©Œ
;

1304 
Æ_num_»suÉs
 = 0;

1305 
»t
 = 0;

1306 
‹mp
;

1307 
ty³
;

1308 
i
;

1310 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_GET_SCAN_RESULTS\n");

1313 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1314 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1316 
ty³
) {

1317 
GSCAN_ATTRIBUTE_NUM_OF_RESULTS
:

1318 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
Æ_num_»suÉs
))

1319  -
EINVAL
;

1322 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1327 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

1328 ià(!
ndev_vif
) {

1329 
	`SLSI_WARN_NODEV
("ndev_vif is NULL\n");

1330  -
EINVAL
;

1333 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1335 
num_»suÉs
 = 
sdev
->
num_gsÿn_»suÉs
;

1337 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Æ_num_»suÉs: %d,‚um_»suÉ ğ%d\n", 
Æ_num_»suÉs
, sdev->
num_gsÿn_»suÉs
);

1339 ià(
num_»suÉs
 == 0) {

1340 
	`SLSI_DBG1
(
sdev
, 
SLSI_GSCAN
, "No scan„esults‡vailable\n");

1342 
ex™
;

1346 ià(
num_»suÉs
 > 
Æ_num_»suÉs
)

1347 
num_»suÉs
 = 
Æ_num_»suÉs
;

1350 
mem_Ãeded
 = 
num_»suÉs
 * (
¦si_Æ_sÿn_»suÉ_·¿m
) + 12;

1352 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
mem_Ãeded
);

1353 ià(
skb
 =ğ
NULL
) {

1354 
	`SLSI_ERR_NODEV
("skb‡lloc failed");

1355 
»t
 = -
ENOMEM
;

1356 
ex™
;

1359 
sÿn_hdr
 = 
	`Æa_Ã¡_¡¬t
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_RESULTS
);

1360 ià(
sÿn_hdr
 =ğ
NULL
) {

1361 
	`kä“_skb
(
skb
);

1362 
	`SLSI_ERR_NODEV
("scan_hdr is NULL.\n");

1363 
»t
 = -
ENOMEM
;

1364 
ex™
;

1367 
»t
 |ğ
	`Æa_put_u32
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_ID
, 0);

1368 
»t
 |ğ
	`Æa_put_u8
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_FLAGS
, 0);

1369 
»t
 |ğ
	`Æa_put_u32
(
skb
, 
GSCAN_ATTRIBUTE_NUM_OF_RESULTS
, 
num_»suÉs
);

1371 
i
 = 0; i < 
SLSI_GSCAN_HASH_TABLE_SIZE
; i++)

1372 
sdev
->
gsÿn_hash_bË
[
i
]) {

1373 
sÿn_»s
 = 
sdev
->
gsÿn_hash_bË
[
i
];

1374 
sdev
->
gsÿn_hash_bË
[
i
] = sdev->gsÿn_hash_bË[i]->
hÃxt
;

1375 
sdev
->
num_gsÿn_»suÉs
--;

1376 
sdev
->
bufãr_cÚsumed
 -ğ
sÿn_»s
->
sÿn_»s_Ën
;

1378 
»t
 |ğ
	`Æa_put
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_RESULTS
, (
¦si_Æ_sÿn_»suÉ_·¿m
), &
sÿn_»s
->
Æ_sÿn_»s
);

1379 
	`kä“
(
sÿn_»s
);

1380 
num_»suÉs
--;

1381 ià(
num_»suÉs
 == 0)

1382 
out
;

1384 
out
:

1385 
	`Æa_Ã¡_’d
(
skb
, 
sÿn_hdr
);

1386 ià(
»t
) {

1387 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

1388 
	`kä“_skb
(
skb
);

1389 
ex™
;

1391 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

1392 
ex™
:

1393 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1394  
»t
;

1395 
	}
}

1397 
	$¦si_rx_rssi_»pÜt_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1399 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1400 
¦si_rssi_mÚ™Ü_evt
 
ev’t_d©a
;

1402 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1403 
	`SLSI_ETHER_COPY
(
ev’t_d©a
.
bssid
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_rssi_»pÜt_šd
.bssid));

1404 
ev’t_d©a
.
rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_rssi_»pÜt_šd
.rssi);

1405 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "RSSIh»shŞd b»ached, Cu¼’ˆRSSI fÜ %pMğ%d\n", 
ev’t_d©a
.
bssid
,ƒv’t_d©a.
rssi
);

1406 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_RSSI_REPORT_EVENT
, &
ev’t_d©a
, (event_data));

1407 
	`kä“_skb
(
skb
);

1408 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1409 
	}
}

1411 
	$¦si_£t_v’dÜ_›
(
why
 *wiphy,

1412 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1414 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1415 
Ãt_deviû
 *
Ãt_dev
;

1416 
Ãtdev_vif
 *
ndev_vif
;

1417 cÚ¡ 
Æ©Œ
 *
©Œ
;

1418 
r
 = 0;

1419 
‹mp
;

1420 
ty³
;

1421 
u8
 *
›_li¡
 = 
NULL
;

1422 
›_li¡_Ën
 = 0;

1424 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1425 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1427 
	`SLSI_INFO
(
sdev
, "Vendor CMD SCAN_DEFAULT_IES\n");

1428 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1429 ià(!
©Œ
)

1430  -
EINVAL
;

1431 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1432 
ty³
) {

1433 
SLSI_SCAN_DEFAULT_IES
:

1435 ià(!
	`Æa_Ën
(
©Œ
))

1437 
	`kä“
(
›_li¡
);

1438 
›_li¡
 = 
	`km®loc
(
	`Æa_Ën
(
©Œ
), 
GFP_KERNEL
);

1439 ià(!
›_li¡
) {

1440 
	`SLSI_ERR
(
sdev
, "No memory for ie_list!");

1441  -
ENOMEM
;

1443 
	`memıy
(
›_li¡
, 
	`Æa_d©a
(
©Œ
), 
	`Æa_Ën
(attr));

1444 
›_li¡_Ën
 = 
	`Æa_Ën
(
©Œ
);

1445 
	`SLSI_INFO
(
sdev
, "SCAN_DEFAULT_IES L’:%d\n", 
›_li¡_Ën
);

1449 ià(
ty³
 > 
SLSI_SCAN_DEFAULT_MAX
)

1450 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

1455 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1456 
	`kä“
(
sdev
->
deçuÉ_sÿn_›s
);

1457 
sdev
->
deçuÉ_sÿn_›s_Ën
 = 
›_li¡_Ën
;

1458 
sdev
->
deçuÉ_sÿn_›s
 = (
u8
 *)
›_li¡
;

1459 ià(
ndev_vif
->
aùiv©ed
)

1460 
r
 = 
	`¦si_add_´obe_›s_»que¡
(
sdev
, 
Ãt_dev
);

1461 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1462  
r
;

1463 
	}
}

1465 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


1466 
	$¦si_key_mgmt_£t_pmk
(
why
 *wiphy,

1467 
wœ–ess_dev
 *
wdev
, cÚ¡ *
pmk
, 
pmkËn
)

1469 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1470 
Ãt_deviû
 *
Ãt_dev
;

1471 
Ãtdev_vif
 *
ndev_vif
;

1472 
r
 = 0;

1473 
key_·¿ms
 
·¿ms
;

1474 
u8
 
mac_addr
[
ETH_ALEN
] = {0};

1476 ià(
wdev
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1477 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Not„equiredo set PMK for P2P client\n");

1478  
r
;

1480 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "SUBCMD_SET_PMK Received\n");

1482 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1483 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1484 
	`mem£t
(&
·¿ms
, 0, (params));

1485 
	`mem£t
(
mac_addr
, 0x00, 
ETH_ALEN
);

1486 
·¿ms
.
key
 = 
pmk
;

1487 
·¿ms
.
key_Ën
 = 
pmkËn
;

1488 
·¿ms
.
ch”
 = 
WLAN_CIPHER_SUITE_PMK
;

1490 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1491 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
Ãt_dev
, 0, 
FAPI_KEYTYPE_PMK
, 
mac_addr
, &
·¿ms
);

1492 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1493  
r
;

1494 
	}
}

1497 
	$¦si_£t_bssid_bÏckli¡
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1499 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1500 
Ãt_deviû
 *
Ãt_dev
;

1501 
Ãtdev_vif
 *
ndev_vif
;

1502 
‹mp1
;

1503 
ty³
;

1504 cÚ¡ 
Æ©Œ
 *
©Œ
;

1505 
u32
 
num_bssids
 = 0;

1506 
u8
 
i
 = 0;

1507 
u8
 
äom_suµliÿÁ
 = 0;

1508 
»t
 = 0;

1509 
u8
 *
bssid
 = 
NULL
;

1510 
cfg80211_aş_d©a
 *
aş_d©a
 = 
NULL
;

1512 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_SET_BSSID_BLACK_LIST\n");

1514 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1515 ià(!
Ãt_dev
) {

1516 
	`SLSI_WARN_NODEV
("net_dev is NULL\n");

1517  -
EINVAL
;

1520 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1522 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1523 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp1
) {

1524 ià(!
©Œ
) {

1525 
	`SLSI_ERR_NODEV
("A‰ribu‹ i nuÎ :†’ = %d\n", 
Ën
);

1526 
»t
 = -
EINVAL
;

1530 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1532 
ty³
) {

1533 
GSCAN_ATTRIBUTE_NUM_BSSID
:

1534 ià(
aş_d©a
)

1537 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
num_bssids
)) {

1538 
»t
 = -
EINVAL
;

1539 
ex™
;

1541 ià(
num_bssids
 > (
u32
)((
ULONG_MAX
 - (*
aş_d©a
)è/ ((
mac_add»ss
)))) {

1542 
»t
 = -
EINVAL
;

1543 
ex™
;

1545 
aş_d©a
 = 
	`km®loc
((*aş_d©aè+ ((
mac_add»ss
è* 
num_bssids
), 
GFP_KERNEL
);

1546 ià(!
aş_d©a
) {

1547 
»t
 = -
ENOMEM
;

1548 
ex™
;

1550 
aş_d©a
->
n_aş_’Œ›s
 = 
num_bssids
;

1553 
GSCAN_ATTRIBUTE_BLACKLIST_BSSID
:

1554 ià(!
aş_d©a
) {

1555 
»t
 = -
EINVAL
;

1556 
ex™
;

1559 ià(
	`Æa_Ën
(
©Œ
) != 6) {

1560 
»t
 = -
EINVAL
;

1561 
ex™
;

1564 ià(
i
 >ğ
num_bssids
) {

1565 
»t
 = -
EINVAL
;

1566 
ex™
;

1569 ià(
	`Æa_Ën
(
©Œ
è< 
ETH_ALEN
) {

1570 
»t
 = -
EINVAL
;

1571 
ex™
;

1573 
bssid
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1575 
	`SLSI_ETHER_COPY
(
aş_d©a
->
mac_addrs
[
i
].
addr
, 
bssid
);

1576 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "mac_addrs[%d]:%pM)\n", 
i
, 
aş_d©a
->
mac_addrs
[i].
addr
);

1577 
i
++;

1579 
GSCAN_ATTRIBUTE_BLACKLIST_FROM_SUPPLICANT
:

1580 
äom_suµliÿÁ
 = 1;

1583 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1584 
»t
 = -
EINVAL
;

1585 
ex™
;

1589 ià(
aş_d©a
) {

1590 ià(
äom_suµliÿÁ
) {

1591 
	`kä“
(
ndev_vif
->
aş_d©a_suµliÿÁ
);

1592 
ndev_vif
->
aş_d©a_suµliÿÁ
 = 
aş_d©a
;

1594 
	`kä“
(
ndev_vif
->
aş_d©a_h®
);

1595 
ndev_vif
->
aş_d©a_h®
 = 
aş_d©a
;

1597 
»t
 = 
	`¦si_£t_aş
(
sdev
, 
Ãt_dev
);

1598 
aş_d©a
 = 
NULL
;

1601 
ex™
:

1602 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1603 
	`kä“
(
aş_d©a
);

1604  
»t
;

1605 
	}
}

1607 
	$¦si_¡¬t_k“·live_ofæßd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1609 #iâdeà
CONFIG_SCSC_WLAN_NAT_KEEPALIVE_DISABLE


1610 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1611 
Ãt_deviû
 *
Ãt_dev
;

1612 
Ãtdev_vif
 *
ndev_vif
;

1614 
‹mp
;

1615 
ty³
;

1616 cÚ¡ 
Æ©Œ
 *
©Œ
;

1617 
u16
 
_pkt_Ën
 = 0;

1618 
u8
 *
_pkt
 = 
NULL
, *
¤c_mac_addr
 = NULL, *
d¡_mac_addr
 = NULL;

1619 
u32
 
³riod
 = 0;

1620 
¦si_³”
 *
³”
;

1621 
sk_buff
 *
skb
;

1622 
‘hhdr
 *
ehdr
;

1623 
r
 = 0;

1624 
u16
 
ho¡_g
 = 0;

1625 
u8
 
šdex
 = 0;

1627 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SUBCMD_START_KEEPALIVE_OFFLOAD„eceived\n");

1628 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1629 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1631 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1632 ià(!
ndev_vif
->
aùiv©ed
) {

1633 
	`SLSI_WARN_NODEV
("ndev_vif is‚ot‡ctivated\n");

1634 
r
 = -
EINVAL
;

1635 
ex™
;

1637 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

1638 
	`SLSI_WARN_NODEV
("ndev_vif->vif_type is‚ot FAPI_VIFTYPE_STATION\n");

1639 
r
 = -
EINVAL
;

1640 
ex™
;

1642 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1643 
	`SLSI_WARN_NODEV
("ndev_vif->sta.vif_status is‚ot SLSI_VIF_STATUS_CONNECTED\n");

1644 
r
 = -
EINVAL
;

1645 
ex™
;

1648 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãt_dev
, 
SLSI_STA_PEER_QUEUESET
);

1649 ià(!
³”
) {

1650 
	`SLSI_WARN_NODEV
("peer is NULL\n");

1651 
r
 = -
EINVAL
;

1652 
ex™
;

1655 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1656 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1658 
ty³
) {

1659 
MKEEP_ALIVE_ATTRIBUTE_IP_PKT_LEN
:

1660 ià(
	`¦si_ut_Æa_g‘_u16
(
©Œ
, &
_pkt_Ën
)) {

1661 
r
 = -
EINVAL
;

1662 
ex™
;

1666 
MKEEP_ALIVE_ATTRIBUTE_IP_PKT
:

1667 ià(
	`Æa_Ën
(
©Œ
è< 
_pkt_Ën
) {

1668 
r
 = -
EINVAL
;

1669 
ex™
;

1671 
_pkt
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1674 
MKEEP_ALIVE_ATTRIBUTE_PERIOD_MSEC
:

1675 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
³riod
)) {

1676 
r
 = -
EINVAL
;

1677 
ex™
;

1681 
MKEEP_ALIVE_ATTRIBUTE_DST_MAC_ADDR
:

1682 ià(
	`Æa_Ën
(
©Œ
è< 
ETH_ALEN
) {

1683 
r
 = -
EINVAL
;

1684 
ex™
;

1686 
d¡_mac_addr
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1689 
MKEEP_ALIVE_ATTRIBUTE_SRC_MAC_ADDR
:

1690 ià(
	`Æa_Ën
(
©Œ
è< 
ETH_ALEN
) {

1691 
r
 = -
EINVAL
;

1692 
ex™
;

1694 
¤c_mac_addr
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1697 
MKEEP_ALIVE_ATTRIBUTE_ID
:

1698 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
šdex
)) {

1699 
r
 = -
EINVAL
;

1700 
ex™
;

1702 ià(
šdex
 > 
SLSI_MAX_KEEPALIVE_ID
) {

1703 
r
 = -
EINVAL
;

1704 
ex™
;

1709 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1710 
r
 = -
EINVAL
;

1711 
ex™
;

1714 ià(!
šdex
) {

1715 
	`SLSI_WARN_NODEV
("No MKEEP_ALIVE_ATTRIBUTE_ID\n");

1716 
r
 = -
EINVAL
;

1717 
ex™
;

1723 ià(!
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãt_dev
, 
NULL
, 0,

1724 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
,

1725 
FAPI_MESSAGETYPE_ANY_OTHER
,

1726 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1], 0, 0, 0))

1727 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "slsi_mlme_send_frame_mgmt„eturned failure\n");

1728 
skb
 = 
	`®loc_skb
(
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
_pkt_Ën
, 
GFP_KERNEL
);

1729 ià(!
skb
) {

1730 
	`SLSI_WARN_NODEV
("memÜy‡ÎoÿtiÚ faed fÜ skb (size: %d)\n", 
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
_pkt_Ën
);

1731 
r
 = -
ENOMEM
;

1732 
ex™
;

1735 
	`skb_»£rve
(
skb
, 
SLSI_NETIF_SKB_HEADROOM
 - 
	`SLSI_SKB_GET_ALIGNMENT_OFFSET
(skb));

1736 
	`skb_»£t_mac_h—d”
(
skb
);

1737 
	`skb_£t_ÃtwÜk_h—d”
(
skb
, (
‘hhdr
));

1740 
ehdr
 = (
‘hhdr
 *)
	`skb_put
(
skb
, (ethhdr));

1742 ià(
d¡_mac_addr
)

1743 
	`SLSI_ETHER_COPY
(
ehdr
->
h_de¡
, 
d¡_mac_addr
);

1744 ià(
¤c_mac_addr
)

1745 
	`SLSI_ETHER_COPY
(
ehdr
->
h_sourû
, 
¤c_mac_addr
);

1746 
ehdr
->
h_´Ùo
 = 
	`ıu_to_be16
(
ETH_P_IP
);

1747 ià(
_pkt
)

1748 
	`memıy
(
	`skb_put
(
skb
, 
_pkt_Ën
), 
_pkt
, ip_pkt_len);

1750 
skb
->
dev
 = 
Ãt_dev
;

1751 
skb
->
´ÙocŞ
 = 
ETH_P_IP
;

1752 
skb
->
_summed
 = 
CHECKSUM_UNNECESSARY
;

1755 
skb
->
queue_m­pšg
 = 
	`¦si_Ãtif_g‘_³”_queue
(0, 0);

1758 
	`_hdr
(
skb
)->
äag_off
 |ğ
	`htÚs
(
IP_DF
);

1761 
	`_hdr
(
skb
)->
check
 = 0;

1762 
	`_£nd_check
(
	`_hdr
(
skb
));

1764 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

1765 
r
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
Ãt_dev
, 
skb
, 
FAPI_MESSAGETYPE_ANY_OTHER
, 
ho¡_g
,

1766 0, (
³riod
 * 1000));

1767 ià(
r
 == 0)

1768 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1] = 
ho¡_g
;

1770 
	`kä“_skb
(
skb
);

1772 
ex™
:

1773 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1774  
r
;

1776 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "SUBCMD_START_KEEPALIVE_OFFLOAD„eceived\n");

1777 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "NAT Keep Alive Feature is disabled\n");

1778  -
EOPNOTSUPP
;

1781 
	}
}

1783 
	$¦si_¡İ_k“·live_ofæßd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1785 #iâdeà
CONFIG_SCSC_WLAN_NAT_KEEPALIVE_DISABLE


1786 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1787 
Ãt_deviû
 *
Ãt_dev
;

1788 
Ãtdev_vif
 *
ndev_vif
;

1789 
r
 = 0;

1790 
‹mp
;

1791 
ty³
;

1792 cÚ¡ 
Æ©Œ
 *
©Œ
;

1793 
u8
 
šdex
 = 0;

1795 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SUBCMD_STOP_KEEPALIVE_OFFLOAD„eceived\n");

1796 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1797 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1799 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1800 ià(!
ndev_vif
->
aùiv©ed
) {

1801 
	`SLSI_WARN
(
sdev
, "VIF is‚ot‡ctivated\n");

1802 
r
 = -
EINVAL
;

1803 
ex™
;

1805 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

1806 
	`SLSI_WARN
(
sdev
, "Not‡ STA VIF\n");

1807 
r
 = -
EINVAL
;

1808 
ex™
;

1810 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1811 
	`SLSI_WARN
(
sdev
, "VIF is‚ot connected\n");

1812 
r
 = -
EINVAL
;

1813 
ex™
;

1816 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1817 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1819 
ty³
) {

1820 
MKEEP_ALIVE_ATTRIBUTE_ID
:

1821 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
šdex
)) {

1822 
r
 = -
EINVAL
;

1823 
ex™
;

1825 ià(
šdex
 > 
SLSI_MAX_KEEPALIVE_ID
) {

1826 
r
 = -
EINVAL
;

1827 
ex™
;

1832 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1833 
r
 = -
EINVAL
;

1834 
ex™
;

1837 ià(!
šdex
) {

1838 
	`SLSI_WARN_NODEV
("No MKEEP_ALIVE_ATTRIBUTE_ID\n");

1839 
r
 = -
EINVAL
;

1840 
ex™
;

1843 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãt_dev
, 
NULL
, 0, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
,

1844 
FAPI_MESSAGETYPE_ANY_OTHER
, 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1], 0, 0, 0);

1845 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1] = 0;

1847 
ex™
:

1848 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1849  
r
;

1851 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "SUBCMD_STOP_KEEPALIVE_OFFLOAD„eceived\n");

1852 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "NAT Keep Alive Feature is disabled\n");

1853  -
EOPNOTSUPP
;

1856 
	}
}

1858 
šlše
 
	$¦si_•no_ssid_li¡_g‘
(
¦si_dev
 *
sdev
,

1859 
¦si_•no_ssid_·¿m
 *
•no_ssid_·¿ms
, cÚ¡ 
Æ©Œ
 *
ou‹r
)

1861 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "SUBCMD_GET_EPNO_LIST Received\n");

1862  -
EOPNOTSUPP
;

1863 
	}
}

1865 
	$¦si_£t_•no_ssid
(
why
 *wiphy,

1866 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1868 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "SUBCMD_SET_EPNO_LIST Received\n");

1869  -
EOPNOTSUPP
;

1870 
	}
}

1872 
	$¦si_£t_hs_·¿ms
(
why
 *wiphy,

1873 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1875 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "SUBCMD_SET_HS_LIST Received\n");

1876  -
EOPNOTSUPP
;

1877 
	}
}

1879 
	$¦si_»£t_hs_·¿ms
(
why
 *wiphy,

1880 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1882 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "SUBCMD_RESET_HS_LIST Received\n");

1883  -
EOPNOTSUPP
;

1884 
	}
}

1886 
	$¦si_£t_rssi_mÚ™Ü
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1888 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1889 
Ãt_deviû
 *
Ãt_dev
;

1890 
Ãtdev_vif
 *
ndev_vif
;

1891 
r
 = 0;

1892 
‹mp
;

1893 
ty³
;

1894 cÚ¡ 
Æ©Œ
 *
©Œ
;

1895 
s8
 
mš_rssi
 = 0, 
max_rssi
 = 0;

1896 
u16
 
’abË
 = 0;

1897 
u8
 
v®
 = 0;

1899 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Recd RSSI monitor command\n");

1901 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1902 ià(
Ãt_dev
 =ğ
NULL
) {

1903 
	`SLSI_ERR
(
sdev
, "netdev is NULL!!\n");

1904  -
ENODEV
;

1907 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1908 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1910 ià(!
ndev_vif
->
aùiv©ed
) {

1911 
	`SLSI_ERR
(
sdev
, "Vif‚ot‡ctivated\n");

1912 
r
 = -
EINVAL
;

1913 
ex™
;

1915 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

1916 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif\n");

1917 
r
 = -
EINVAL
;

1918 
ex™
;

1920 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1921 
	`SLSI_ERR
(
sdev
, "STA vif‚ot connected\n");

1922 
r
 = -
EINVAL
;

1923 
ex™
;

1926 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1927 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1928 
ty³
) {

1929 
SLSI_RSSI_MONITOR_ATTRIBUTE_START
:

1930 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

1931 
r
 = -
EINVAL
;

1932 
ex™
;

1934 
’abË
 = (
u16
)
v®
;

1936 
SLSI_RSSI_MONITOR_ATTRIBUTE_MIN_RSSI
:

1937 ià(
	`¦si_ut_Æa_g‘_s8
(
©Œ
, &
mš_rssi
)) {

1938 
r
 = -
EINVAL
;

1939 
ex™
;

1942 
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX_RSSI
:

1943 ià(
	`¦si_ut_Æa_g‘_s8
(
©Œ
, &
max_rssi
)) {

1944 
r
 = -
EINVAL
;

1945 
ex™
;

1949 
r
 = -
EINVAL
;

1950 
ex™
;

1953 ià(
mš_rssi
 > 
max_rssi
) {

1954 
	`SLSI_ERR
(
sdev
, "Inv®id…¬ams, mš_rssiğ%d ,max_rss˜ğ%d\n", 
mš_rssi
, 
max_rssi
);

1955 
r
 = -
EINVAL
;

1956 
ex™
;

1958 
r
 = 
	`¦si_mlme_£t_rssi_mÚ™Ü
(
sdev
, 
Ãt_dev
, 
’abË
, 
mš_rssi
, 
max_rssi
);

1959 
ex™
:

1960 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1961  
r
;

1962 
	}
}

1964 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1965 
	$¦si_Îs_debug_dump_¡©s
(
¦si_dev
 *
sdev
, 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©
,

1966 
¦si_Îs_içû_¡©
 *
içû_¡©
, 
u8
 *
buf
, 
buf_Ën
, 
num_of_¿dios
)

1968 
i
, 
j
;

1970 
j
 = 0; j < 
num_of_¿dios
; j++) {

1971 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "radio_stat====\n");

1972 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\tradio_id : %d, on_time : %d,x_time : %d,„x_time : %d,"

1973 "Ú_time_sÿÀ: %d,‚um_chªÃl : %d\n", 
¿dio_¡©
->
¿dio
,„adio_¡©->
Ú_time
,

1974 
¿dio_¡©
->
tx_time
,„adio_¡©->
rx_time
,„adio_¡©->
Ú_time_sÿn
,

1975 
¿dio_¡©
->
num_chªÃls
);

1977 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)((
u8
 *)radio_stat + (slsi_lls_radio_stat) +

1978 ((
¦si_Îs_chªÃl_¡©
è* 
¿dio_¡©
->
num_chªÃls
));

1980 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "iface_stat====\n");

1981 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\tiface %p info : (mode : %d, mac_addr : %pM, state : %d,„oaming : %d,"

1983 
içû_¡©
->
içû
, içû_¡©->
šfo
.
mode
, içû_¡©->šfo.
mac_addr
, içû_¡©->šfo.
¡©e
,

1984 
içû_¡©
->
šfo
.
rßmšg
, içû_¡©->šfo.
ÿ·b™›s
, içû_¡©->šfo.
ssid
,

1985 
içû_¡©
->
šfo
.
bssid
, içû_¡©->šfo.
­_couÁry_¡r
[0], iface_stat->info.ap_country_str[1],

1986 
içû_¡©
->
šfo
.
­_couÁry_¡r
[2], içû_¡©->
rssi_d©a
, içû_¡©->
rssi_mgmt
);

1988 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\Šum_³” %d\n", 
içû_¡©
->
num_³”s
);

1989 
i
 = 0; i < 
içû_¡©
->
num_³”s
; i++) {

1990 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\t\“r_mac_add»s %pM\n", 
içû_¡©
->
³”_šfo
[
i
].
³”_mac_add»ss
);

1993 
	`SLSI_DBG_HEX
(
sdev
, 
SLSI_GSCAN
, 
buf
, 
buf_Ën
, "return buffer\n");

1994 
	}
}

1997 
	$¦si_Îs_£t_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1999 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2000 
Ãt_deviû
 *
Ãt_dev
 = 
NULL
;

2001 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2002 
‹mp
;

2003 
ty³
;

2004 cÚ¡ 
Æ©Œ
 *
©Œ
;

2005 
u32
 
mpdu_size_th»shŞd
 = 0;

2006 
u32
 
aggr_¡©_g©h”šg
 = 0;

2007 
r
 = 0, 
i
;

2009 ià(!
	`¦si_dev_Îs_suµÜ‹d
())

2010  -
EOPNOTSUPP
;

2012 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2013 
	`SLSI_WARN
(
sdev
, "not supported in WlanLite mode\n");

2014  -
EOPNOTSUPP
;

2017 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2018 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2020 
ty³
) {

2021 
LLS_ATTRIBUTE_SET_MPDU_SIZE_THRESHOLD
:

2022 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
mpdu_size_th»shŞd
))

2023  -
EINVAL
;

2026 
LLS_ATTRIBUTE_SET_AGGR_STATISTICS_GATHERING
:

2027 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
aggr_¡©_g©h”šg
))

2028  -
EINVAL
;

2032 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

2033 
r
 = -
EINVAL
;

2037 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2039 ()
	`¦si_mlme_¡¬t_lšk_¡©s_»q
(
sdev
, 
mpdu_size_th»shŞd
, 
aggr_¡©_g©h”šg
);

2041 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2042 ià(
Ãt_dev
) {

2043 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2044 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

2045 
ndev_vif
->
rx_·ck‘s
[
i
] = 0;

2046 
ndev_vif
->
tx_·ck‘s
[
i
] = 0;

2047 
ndev_vif
->
tx_no_ack
[
i
] = 0;

2050 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2052 
	}
}

2054 
	$¦si_Îs_ş—r_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2056 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2057 
‹mp
;

2058 
ty³
;

2059 cÚ¡ 
Æ©Œ
 *
©Œ
;

2060 
u32
 
¡©s_ş—r_»q_mask
 = 0;

2061 
u32
 
¡İ_»q
 = 0;

2062 
r
 = 0, 
i
;

2063 
Ãt_deviû
 *
Ãt_dev
 = 
NULL
;

2064 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2066 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2068 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2069 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2071 
ty³
) {

2072 
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST_MASK
:

2073 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
¡©s_ş—r_»q_mask
))

2074  -
EINVAL
;

2075 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "¡©s_ş—r_»q_mask:%u\n", 
¡©s_ş—r_»q_mask
);

2078 
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST
:

2079 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
¡İ_»q
))

2080  -
EINVAL
;

2081 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "¡İ_»q:%u\n", 
¡İ_»q
);

2085 
	`SLSI_ERR
(
sdev
, "UnknowÀ©Œibu‹:%d\n", 
ty³
);

2086 
r
 = -
EINVAL
;

2093 ià(!
¡İ_»q
)

2094 
¡©s_ş—r_»q_mask
 = ~stats_clear_req_mask;

2096 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2097 ()
	`¦si_mlme_¡İ_lšk_¡©s_»q
(
sdev
, 
¡©s_ş—r_»q_mask
);

2098 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2099 ià(
Ãt_dev
) {

2100 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2101 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

2102 
ndev_vif
->
rx_·ck‘s
[
i
] = 0;

2103 
ndev_vif
->
tx_·ck‘s
[
i
] = 0;

2104 
ndev_vif
->
tx_no_ack
[
i
] = 0;

2107 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2109 
	}
}

2111 
u32
 
	$¦si_Îs_›_to_ÿp
(cÚ¡ 
u8
 *
›s
, 
›s_Ën
)

2113 
u32
 
ÿ·b™›s
 = 0;

2114 cÚ¡ 
u8
 *
›_d©a
;

2115 cÚ¡ 
u8
 *
›
;

2116 
›_Ën
;

2118 ià(!
›s
 || 
›s_Ën
 == 0) {

2119 
	`SLSI_ERR_NODEV
("nØ›[&%°%d]\n", 
›s
, 
›s_Ën
);

2122 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
›s
, 
›s_Ën
);

2123 ià(
›
) {

2124 
›_Ën
 = 
›
[1];

2125 
›_d©a
 = &
›
[2];

2126 ià((
›_Ën
 >ğ4è&& (
›_d©a
[3] & 
SLSI_WLAN_EXT_CAPA3_INTERWORKING_ENABLED
))

2127 
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_INTERWORKING
;

2128 ià((
›_Ën
 >ğ7è&& (
›_d©a
[6] & 0x01))

2129 
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_SSID_UTF8
;

2132 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_HS20_IND
, 
›s
, 
›s_Ën
);

2133 ià(
›
)

2134 
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_HS20
;

2135  
ÿ·b™›s
;

2136 
	}
}

2138 
	$¦si_Îs_içû_¡a_¡©s
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

2139 
¦si_Îs_içû_¡©
 *
içû_¡©
)

2141 
i
;

2142 
¦si_Îs_š‹rçû_lšk_Ïy”_šfo
 *
Îs_šfo
 = &
içû_¡©
->
šfo
;

2143 
¦si_Îs_³”_ty³
 
³”_ty³
;

2144 
¦si_³”
 *
³”
;

2145 cÚ¡ 
u8
 *
›_d©a
, *
›
;

2146 
›_Ën
;

2148 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2150 ià(
ndev_vif
->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
) {

2151 
Îs_šfo
->
mode
 = 
SLSI_LLS_INTERFACE_STA
;

2152 
³”_ty³
 = 
SLSI_LLS_PEER_AP
;

2154 
Îs_šfo
->
mode
 = 
SLSI_LLS_INTERFACE_P2P_CLIENT
;

2155 
³”_ty³
 = 
SLSI_LLS_PEER_P2P_GO
;

2158 
ndev_vif
->
¡a
.
vif_¡©us
) {

2159 
SLSI_VIF_STATUS_CONNECTING
:

2160 
Îs_šfo
->
¡©e
 = 
SLSI_LLS_AUTHENTICATING
;

2162 
SLSI_VIF_STATUS_CONNECTED
:

2163 
Îs_šfo
->
¡©e
 = 
SLSI_LLS_ASSOCIATED
;

2166 
Îs_šfo
->
¡©e
 = 
SLSI_LLS_DISCONNECTED
;

2168 
Îs_šfo
->
rßmšg
 = 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 ?

2169 
SLSI_LLS_ROAMING_ACTIVE
 : 
SLSI_LLS_ROAMING_IDLE
;

2171 
içû_¡©
->
šfo
.
ÿ·b™›s
 = 0;

2172 
Îs_šfo
->
ssid
[0] = 0;

2173 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

2174 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

2175 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

2176 ià(
›
) {

2177 
›_Ën
 = 
›
[1];

2178 
›_d©a
 = &
›
[2];

2179 
	`memıy
(
Îs_šfo
->
ssid
, 
›_d©a
, 
›_Ën
);

2180 
Îs_šfo
->
ssid
[
›_Ën
] = 0;

2182 
	`SLSI_ETHER_COPY
(
Îs_šfo
->
bssid
, 
ndev_vif
->
¡a
.
¡a_bss
->bssid);

2183 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

2184 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

2185 ià(
›
) {

2186 
›_d©a
 = &
›
[2];

2187 
	`memıy
(
Îs_šfo
->
­_couÁry_¡r
, 
›_d©a
, 3);

2188 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_COUNTRY
;

2192 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

2193 ià(
³”
 &&…“r->
v®id
 &&…“r->
assoc_›
 &&…“r->
assoc_»¥_›
) {

2194 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
	`¦si_Îs_›_to_ÿp
(
³”
->
assoc_›
->
d©a
,…“r->assoc_›->
Ën
);

2195 ià(
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) {

2196 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_PROTECTED
;

2197 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_PROTECTED
;

2199 ià(
³”
->
qos_’abËd
) {

2200 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2201 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2203 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
	`¦si_Îs_›_to_ÿp
(
³”
->
assoc_»¥_›
->
d©a
,…“r->assoc_»¥_›->
Ën
);

2205 
	`SLSI_ETHER_COPY
(
içû_¡©
->
³”_šfo
[0].
³”_mac_add»ss
, 
³”
->
add»ss
);

2206 
içû_¡©
->
³”_šfo
[0].
ty³
 = 
³”_ty³
;

2207 
içû_¡©
->
num_³”s
 = 1;

2210 
i
 = 
	`MAP_AID_TO_QS
(
SLSI_TDLS_PEER_INDEX_MIN
); i <ğMAP_AID_TO_QS(
SLSI_TDLS_PEER_INDEX_MAX
); i++) {

2211 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

2212 ià(
³”
 &&…“r->
v®id
) {

2213 
	`SLSI_ETHER_COPY
(
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
³”_mac_add»ss
, 
³”
->
add»ss
);

2214 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ty³
 = 
SLSI_LLS_PEER_TDLS
;

2215 ià(
³”
->
qos_’abËd
)

2216 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2217 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
num_¿‹
 = 0;

2218 
içû_¡©
->
num_³”s
++;

2221 
	}
}

2223 
	$¦si_Îs_içû_­_¡©s
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
¦si_Îs_içû_¡©
 *
içû_¡©
)

2225 
¦si_Îs_³”_ty³
 
³”_ty³
 = 
SLSI_LLS_PEER_INVALID
;

2226 
¦si_³”
 *
³”
;

2227 
i
;

2228 
Ãt_deviû
 *
dev
;

2230 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2233 
	`memıy
(
içû_¡©
->
šfo
.
­_couÁry_¡r
, içû_¡©->šfo.
couÁry_¡r
, 3);

2235 ià(
ndev_vif
->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
) {

2236 
içû_¡©
->
šfo
.
mode
 = 
SLSI_LLS_INTERFACE_SOFTAP
;

2237 
³”_ty³
 = 
SLSI_LLS_PEER_STA
;

2238 } ià(
ndev_vif
->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) {

2239 
dev
 = 
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
];

2240 ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
)) {

2241 
içû_¡©
->
šfo
.
mode
 = 
SLSI_LLS_INTERFACE_P2P_GO
;

2242 
³”_ty³
 = 
SLSI_LLS_PEER_P2P_CLIENT
;

2246 
i
 = 
	`MAP_AID_TO_QS
(
SLSI_PEER_INDEX_MIN
); i <ğMAP_AID_TO_QS(
SLSI_PEER_INDEX_MAX
); i++) {

2247 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

2248 ià(
³”
 &&…“r->
v®id
) {

2249 
	`SLSI_ETHER_COPY
(
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
³”_mac_add»ss
, 
³”
->
add»ss
);

2250 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ty³
 = 
³”_ty³
;

2251 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
num_¿‹
 = 0;

2252 ià(
³”
->
qos_’abËd
)

2253 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ÿ·b™›s
 = 
SLSI_LLS_CAPABILITY_QOS
;

2254 
içû_¡©
->
num_³”s
++;

2258 
	`memıy
(
içû_¡©
->
šfo
.
ssid
, 
ndev_vif
->
­
.ssid,‚dev_vif->­.
ssid_Ën
);

2259 
içû_¡©
->
šfo
.
ssid
[
ndev_vif
->
­
.
ssid_Ën
] = 0;

2260 ià(
ndev_vif
->
­
.
´ivacy
)

2261 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_PROTECTED
;

2262 ià(
ndev_vif
->
­
.
qos_’abËd
)

2263 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2264 
	}
}

2266 
	$¦si_Îs_içû_¡©_fl
(
¦si_dev
 *
sdev
,

2267 
Ãt_deviû
 *
Ãt_dev
,

2268 
¦si_Îs_içû_¡©
 *
içû_¡©
)

2270 
i
;

2271 
Ãtdev_vif
 *
ndev_vif
;

2272 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2273 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2274 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_BE
 + 1, 0 } },

2275 { 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_BK
 + 1, 0 } },

2276 { 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_VI
 + 1, 0 } },

2277 { 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_VO
 + 1, 0 } },

2278 { 
SLSI_PSID_UNIFI_BEACON_RECEIVED
, {0, 0} },

2279 { 
SLSI_PSID_UNIFI_PS_LEAKY_AP
, {0, 0} },

2280 { 
SLSI_PSID_UNIFI_RSSI
, {0, 0} },

2281 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_BE
 + 1, 0 } },

2282 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_BK
 + 1, 0 } },

2283 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_VI
 + 1, 0 } },

2284 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_VO
 + 1, 0 } } };

2286 
içû_¡©
->
içû
 = 
NULL
;

2287 
içû_¡©
->
šfo
.
mode
 = 
SLSI_LLS_INTERFACE_UNKNOWN
;

2288 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2289 
içû_¡©
->
šfo
.
couÁry_¡r
[0] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[0];

2290 
içû_¡©
->
šfo
.
couÁry_¡r
[1] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[1];

2291 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2292 
içû_¡©
->
šfo
.
couÁry_¡r
[2] = ' ';

2294 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++)

2295 
içû_¡©
->
ac
[
i
].aøğ
SLSI_LLS_AC_MAX
;

2297 ià(!
Ãt_dev
)

2300 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2301 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2303 ià(!
ndev_vif
->
aùiv©ed
)

2304 
ex™
;

2306 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

2307 
	`¦si_Îs_içû_¡a_¡©s
(
sdev
, 
ndev_vif
, 
içû_¡©
);

2308 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

2309 
	`¦si_Îs_içû_­_¡©s
(
sdev
, 
ndev_vif
, 
içû_¡©
);

2310 
	`SLSI_ETHER_COPY
(
içû_¡©
->
šfo
.
bssid
, 
Ãt_dev
->
dev_addr
);

2312 
	`SLSI_ETHER_COPY
(
içû_¡©
->
šfo
.
mac_addr
, 
Ãt_dev
->
dev_addr
);

2314 ià((
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
è&& (ndev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

2315 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2319 
mibr¥
.
d©aL’gth
 = 10 * (
g‘_v®ues
) / (get_values[0]);

2320 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2321 ià(!
mibr¥
.
d©a
) {

2322 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹ fÜ iÁ”çû MIBs\n", 
mibr¥
.
d©aL’gth
);

2323 
ex™
;

2326 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
Ãt_dev
, 
g‘_v®ues
, (g‘_v®uesè/ (g‘_v®ues[0]), &
mibr¥
);

2327 ià(!
v®ues
)

2328 
ex™
;

2330 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

2331 ià(
v®ues
[
i
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

2332 
içû_¡©
->
ac
[
i
].aøğ
	`¦si_çpi_to_ªdroid_Œaffic_q
(i);

2333 
içû_¡©
->
ac
[
i
].
»Œ›s
 = 
v®ues
[i].
u
.
uštV®ue
;

2334 
içû_¡©
->
ac
[
i
].
rx_mpdu
 = 
ndev_vif
->
rx_·ck‘s
[i];

2335 
içû_¡©
->
ac
[
i
].
tx_mpdu
 = 
ndev_vif
->
tx_·ck‘s
[i];

2336 
ndev_vif
->
tx_no_ack
[
i
] = 
v®ues
[˜+ 7].
u
.
uštV®ue
;

2337 
içû_¡©
->
ac
[
i
].
mpdu_lo¡
 = 
ndev_vif
->
tx_no_ack
[i];

2341 ià(
v®ues
[4].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2342 
içû_¡©
->
b—cÚ_rx
 = 
v®ues
[4].
u
.
uštV®ue
;

2344 ià(
v®ues
[5].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

2345 
içû_¡©
->
Ëaky_­_d‘eùed
 = 
v®ues
[5].
u
.
uštV®ue
;

2346 
içû_¡©
->
Ëaky_­_gu¬d_time
 = 5;

2349 ià(
v®ues
[6].
ty³
 =ğ
SLSI_MIB_TYPE_INT
) {

2350 
içû_¡©
->
rssi_d©a
 = 
v®ues
[6].
u
.
štV®ue
;

2351 
içû_¡©
->
rssi_mgmt
 = 
v®ues
[6].
u
.
štV®ue
;

2354 
ex™
:

2355 
	`kä“
(
v®ues
);

2356 
	`kä“
(
mibr¥
.
d©a
);

2357 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2358 
	}
}

2360 
	$¦si_Îs_¿dio_¡©_fl
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

2361 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©
,

2362 
max_chª_couÁ
, 
¿dio_šdex
, 
twoÜfive
)

2364 
Ãtdev_vif
 *
ndev_vif
;

2365 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2366 
¦si_mib_d©a
 
suµÜ‹d_chª_mib
 = { 0, 
NULL
 };

2367 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2368 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_RADIO_SCAN_TIME
, { 
¿dio_šdex
, 0 } },

2369 { 
SLSI_PSID_UNIFI_RADIO_RX_TIME
, { 
¿dio_šdex
, 0 } },

2370 { 
SLSI_PSID_UNIFI_RADIO_TX_TIME
, { 
¿dio_šdex
, 0 } },

2371 { 
SLSI_PSID_UNIFI_RADIO_ON_TIME
, { 
¿dio_šdex
, 0 } },

2372 { 
SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
, { 0, 0 } } };

2373 
u32
 *
¿dio_d©a
[] = {&
¿dio_¡©
->
Ú_time_sÿn
, &¿dio_¡©->
rx_time
,

2374 &
¿dio_¡©
->
tx_time
, &¿dio_¡©->
Ú_time
};

2375 
i
, 
j
, 
chª_couÁ
, 
chª_¡¬t
, 
k
;

2377 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2378 
¿dio_¡©
->
¿dio
 = 
¿dio_šdex
;

2381 
mibr¥
.
d©aL’gth
 = 15 * (
g‘_v®ues
) / (get_values[0]);

2382 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2383 ià(
mibr¥
.
d©a
 =ğ
NULL
) {

2384 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

2387 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, (g‘_v®uesè/ (g‘_v®ues[0]), &
mibr¥
);

2388 ià(!
v®ues
)

2389 
ex™_w™h_mibr¥
;

2391 
i
 = 0; i < ((
g‘_v®ues
) / (get_values[0])) - 1; i++) {

2392 ià(
v®ues
[
i
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

2393 *
¿dio_d©a
[
i
] = 
v®ues
[i].
u
.
uštV®ue
;

2395 
	`SLSI_ERR
(
sdev
, "šv®idy³. i‹r:%d", 
i
);

2398 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
) {

2399 
	`SLSI_ERR
(
sdev
, "Supported_Chan invalidype.");

2400 
ex™_w™h_v®ues
;

2403 
suµÜ‹d_chª_mib
 = 
v®ues
[4].
u
.
où‘V®ue
;

2404 ià(!
suµÜ‹d_chª_mib
.
d©a
)

2405 
ex™_w™h_v®ues
;

2406 
j
 = 0; j < 
suµÜ‹d_chª_mib
.
d©aL’gth
 / 2; j++) {

2407 
¦si_Îs_chªÃl_šfo
 *
¿dio_chª
;

2409 
chª_¡¬t
 = 
suµÜ‹d_chª_mib
.
d©a
[
j
 * 2];

2410 
chª_couÁ
 = 
suµÜ‹d_chª_mib
.
d©a
[
j
 * 2 + 1];

2411 ià(
¿dio_¡©
->
num_chªÃls
 + 
chª_couÁ
 > 
max_chª_couÁ
)

2412 
chª_couÁ
 = 
max_chª_couÁ
 - 
¿dio_¡©
->
num_chªÃls
;

2413 ià(
chª_¡¬t
 =ğ1 && (
twoÜfive
 & 
	`BIT
(0))) {

2414 
k
 = 0; k < 
chª_couÁ
; k++) {

2415 
¿dio_chª
 = &
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
chªÃl
;

2416 ià(
k
 + 
chª_¡¬t
 == 14)

2417 
¿dio_chª
->
ûÁ”_äeq
 = 2484;

2419 
¿dio_chª
->
ûÁ”_äeq
 = 2407 + (
chª_¡¬t
 + 
k
) * 5;

2420 
¿dio_chª
->
width
 = 
SLSI_LLS_CHAN_WIDTH_20
;

2421 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2422 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

2423 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
 &&

2424 
ndev_vif
->
chª
 &&‚dev_vif->chª->
hw_v®ue
 =ğ(
chª_¡¬t
 + 
k
))

2425 
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
Ú_time
 =

2426 
¿dio_¡©
->
Ú_time
;

2427 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2429 
¿dio_¡©
->
num_chªÃls
 +ğ
chª_couÁ
;

2430 } ià(
chª_¡¬t
 !ğ1 && (
twoÜfive
 & 
	`BIT
(1))) {

2432 
k
 = 0; k < 
chª_couÁ
; k++) {

2433 
¿dio_chª
 = &
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
chªÃl
;

2434 
¿dio_chª
->
ûÁ”_äeq
 = 5000 + (
chª_¡¬t
 + (
k
 * 4)) * 5;

2435 
¿dio_chª
->
width
 = 
SLSI_LLS_CHAN_WIDTH_20
;

2436 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2437 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

2438 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
 &&

2439 
ndev_vif
->
chª
 &&‚dev_vif->chª->
hw_v®ue
 =ğ(
chª_¡¬t
 + (
k
 * 4)))

2440 
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
Ú_time
 =

2441 
¿dio_¡©
->
Ú_time
;

2442 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2444 
¿dio_¡©
->
num_chªÃls
 +ğ
chª_couÁ
;

2447 
ex™_w™h_v®ues
:

2448 
	`kä“
(
v®ues
);

2449 
ex™_w™h_mibr¥
:

2450 
	`kä“
(
mibr¥
.
d©a
);

2451 
	}
}

2453 
	$¦si_Îs_fl
(
¦si_dev
 *
sdev
, 
u8
 **
¤c_buf
)

2455 
Ãt_deviû
 *
Ãt_dev
 = 
NULL
;

2456 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©
;

2457 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©_‹mp
;

2458 
¦si_Îs_içû_¡©
 *
içû_¡©
;

2459 
buf_Ën
 = 0;

2460 
max_chª_couÁ
 = 0;

2461 
u8
 *
buf
;

2462 
num_of_¿dios_suµÜ‹d
;

2463 
i
 = 0;

2464 
¿dio_ty³
[2] = {
	`BIT
(0), BIT(1)};

2466 ià(
sdev
->
Îs_num_¿dio
 == 0) {

2467 
	`SLSI_ERR
(
sdev
, "Number of„adios‡re zero forhis…latform\n");

2468  -
EIO
;

2470 
num_of_¿dios_suµÜ‹d
 = 
sdev
->
Îs_num_¿dio
;

2471 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2473 ià(
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
])

2474 
max_chª_couÁ
 = 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
]->
n_chªÃls
;

2475 ià(
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
])

2476 
max_chª_couÁ
 +ğ
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
]->
n_chªÃls
;

2477 
buf_Ën
 = ()((
num_of_¿dios_suµÜ‹d
 * (
¦si_Îs_¿dio_¡©
))

2478 + (
¦si_Îs_içû_¡©
)

2479 + (
u8
)

2480 + ((
¦si_Îs_³”_šfo
è* 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
)

2481 + ((
¦si_Îs_chªÃl_¡©
è* 
max_chª_couÁ
));

2482 
buf
 = 
	`kz®loc
(
buf_Ën
, 
GFP_KERNEL
);

2483 ià(!
buf
) {

2484 
	`SLSI_ERR
(
sdev
, "NØmem. Size:%d\n", 
buf_Ën
);

2485  -
ENOMEM
;

2487 
buf
[0] = 
num_of_¿dios_suµÜ‹d
;

2488 *
¤c_buf
 = 
buf
;

2489 
içû_¡©
 = (
¦si_Îs_içû_¡©
 *)(
buf
 + (
u8
));

2490 
	`¦si_Îs_içû_¡©_fl
(
sdev
, 
Ãt_dev
, 
içû_¡©
);

2492 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)(
buf
 + (
u8
è+ (
¦si_Îs_içû_¡©
) +

2493 ((
¦si_Îs_³”_šfo
è* 
içû_¡©
->
num_³”s
));

2494 
¿dio_¡©_‹mp
 = 
¿dio_¡©
;

2495 ià(
num_of_¿dios_suµÜ‹d
 == 1) {

2496 
¿dio_ty³
[0] = 
	`BIT
(0) | BIT(1);

2497 
	`¦si_Îs_¿dio_¡©_fl
(
sdev
, 
Ãt_dev
, 
¿dio_¡©
, 
max_chª_couÁ
, 0, 
¿dio_ty³
[0]);

2498 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)((
u8
 *)radio_stat + (slsi_lls_radio_stat) +

2499 ((
¦si_Îs_chªÃl_¡©
è* 
¿dio_¡©
->
num_chªÃls
));

2501 
i
 = 1; i <ğ
num_of_¿dios_suµÜ‹d
 ; i++) {

2502 
	`¦si_Îs_¿dio_¡©_fl
(
sdev
, 
Ãt_dev
, 
¿dio_¡©
, 
max_chª_couÁ
, 
i
, 
¿dio_ty³
[i - 1]);

2503 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)((
u8
 *)radio_stat +

2504 (
¦si_Îs_¿dio_¡©
è+ ((
¦si_Îs_chªÃl_¡©
)

2505 * 
¿dio_¡©
->
num_chªÃls
));

2508 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2509 ià(
	`¦si_dev_Î¦ogs_suµÜ‹d
())

2510 
	`¦si_Îs_debug_dump_¡©s
(
sdev
, 
¿dio_¡©_‹mp
, 
içû_¡©
, 
buf
, 
buf_Ën
, 
num_of_¿dios_suµÜ‹d
);

2512  
buf_Ën
;

2513 
	}
}

2515 
	$¦si_Îs_g‘_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2517 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2518 
»t
;

2519 
u8
 *
buf
 = 
NULL
;

2520 
buf_Ën
;

2522 ià(!
	`¦si_dev_Îs_suµÜ‹d
())

2523  -
EOPNOTSUPP
;

2525 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2526 
	`SLSI_WARN
(
sdev
, "not supported in WlanLite mode\n");

2527  -
EOPNOTSUPP
;

2530 ià(!
sdev
) {

2531 
	`SLSI_ERR
(
sdev
, "sdev is Null\n");

2532  -
EINVAL
;

2536 ià(
sdev
->
mlme_blocked
)

2537 
buf_Ën
 = -
EIO
;

2539 
buf_Ën
 = 
	`¦si_Îs_fl
(
sdev
, &
buf
);

2541 ià(
buf_Ën
 > 0) {

2542 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, 
buf
, 
buf_Ën
);

2543 ià(
»t
)

2544 
	`SLSI_ERR_NODEV
("v’dÜ cmd„•ly faed (”r:%d)\n", 
»t
);

2546 
»t
 = 
buf_Ën
;

2548 
	`kä“
(
buf
);

2549  
»t
;

2550 
	}
}

2552 
	$¦si_gsÿn_£t_oui
(
why
 *wiphy,

2553 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2555 
»t
 = 0;

2557 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


2559 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2560 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2561 
Ãtdev_vif
 *
ndev_vif
;

2562 
‹mp
;

2563 
ty³
;

2564 cÚ¡ 
Æ©Œ
 *
©Œ
;

2565 
u8
 
sÿn_oui
[6];

2567 
	`mem£t
(&
sÿn_oui
, 0, 6);

2569 ià(!
dev
) {

2570 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

2571  -
EINVAL
;

2574 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2575 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

2576 
sdev
->
sÿn_addr_£t
 = 0;

2578 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2579 ià(!
©Œ
) {

2580 
»t
 = -
EINVAL
;

2584 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2585 
ty³
) {

2586 
SLSI_NL_ATTRIBUTE_PNO_RANDOM_MAC_OUI
:

2588 ià(
	`¦si_ut_Æa_g‘_d©a
(
©Œ
, 3, &
sÿn_oui
)) {

2589 
»t
 = -
EINVAL
;

2592 
	`memıy
(
sdev
->
sÿn_mac_addr
, 
sÿn_oui
, 6);

2593 
sdev
->
sÿn_addr_£t
 = 1;

2597 
»t
 = -
EINVAL
;

2598 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

2602 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

2604  
»t
;

2605 
	}
}

2607 
	$¦si_g‘_ã©u»_£t
(
why
 *wiphy,

2608 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2610 
u32
 
ã©u»_£t
 = 0;

2611 
»t
 = 0;

2612 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2614 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "\n");

2616 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_INFRA
;

2617 ià(
sdev
->
bªd_5g_suµÜ‹d
)

2618 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_INFRA_5G
;

2619 #iâdeà
CONFIG_SCSC_WLAN_STA_ONLY


2620 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_P2P
;

2621 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_SOFT_AP
;

2623 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_RSSI_MONITOR
;

2624 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_CONTROL_ROAMING
;

2625 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_TDLS
 | 
SLSI_WIFI_HAL_FEATURE_TDLS_OFFCHANNEL
;

2626 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_HOTSPOT
;

2627 #iâdeà
CONFIG_SCSC_WLAN_NAT_KEEPALIVE_DISABLE


2628 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_MKEEP_ALIVE
;

2630 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


2631 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_LOGGER
;

2633 ià(
	`¦si_dev_gsÿn_suµÜ‹d
())

2634 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_GSCAN
;

2635 ià(
	`¦si_dev_Îs_suµÜ‹d
())

2636 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_LINK_LAYER_STATS
;

2637 ià(
	`¦si_dev_•no_suµÜ‹d
())

2638 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_HAL_EPNO
;

2639 ià(
	`¦si_dev_Çn_suµÜ‹d
(
	`SDEV_FROM_WIPHY
(
why
)))

2640 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_NAN
;

2641 ià(
	`¦si_dev_¹t_suµÜ‹d
()) {

2642 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_D2D_RTT
;

2643 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_D2AP_RTT
;

2646 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_BATCH_SCAN
;

2647 #ià!
	`defšed
(
SCSC_SEP_VERSION
) || (defined(SCSC_SEP_VERSION) && SCSC_SEP_VERSION >= 11)

2648 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_PNO
;

2650 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2651 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_AP_STA
;

2653 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_CONFIG_NDO
;

2654 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


2655 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_SCAN_RAND
;

2657 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_DYNAMIC_SET_MAC
;

2658 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_LOW_LATENCY
;

2659 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_P2P_RAND_MAC
;

2661 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
ã©u»_£t
, (feature_set));

2663  
»t
;

2664 
	}
}

2666 
	$¦si_£t_couÁry_code
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2668 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2669 
»t
 = 0;

2670 
‹mp
;

2671 
ty³
;

2672 cÚ¡ 
Æ©Œ
 *
©Œ
;

2673 
couÁry_code
[
SLSI_COUNTRY_CODE_LEN
];

2675 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Received country code command\n");

2677 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2678 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2679 
ty³
) {

2680 
SLSI_NL_ATTRIBUTE_COUNTRY_CODE
:

2682 ià(
	`¦si_ut_Æa_g‘_d©a
(
©Œ
, (
SLSI_COUNTRY_CODE_LEN
 - 1), 
couÁry_code
)) {

2683 
»t
 = -
EINVAL
;

2684 
	`SLSI_ERR
(
sdev
, "Insuffic›Á CouÁry CodL’gth : %d\n", 
	`Æa_Ën
(
©Œ
));

2685  
»t
;

2690 
»t
 = -
EINVAL
;

2691 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

2692  
»t
;

2695 
»t
 = 
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
couÁry_code
, 
SLSI_COUNTRY_CODE_LEN
);

2696 ià(
»t
 < 0)

2697 
	`SLSI_ERR
(
sdev
, "S‘ couÁry faed„‘:%d\n", 
»t
);

2698  
»t
;

2699 
	}
}

2701 
	$¦si_­f_»ad_f‹r
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2703 
»t
 = 0;

2704 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2705 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2706 
u8
 *
ho¡_d¡
;

2707 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2708 
d©®’
;

2710 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_APF_READ_FILTER\n");

2711 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2712 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2713 ià(!
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
) {

2714 
	`SLSI_WARN
(
sdev
, "APF‚ot supported byhe firmware.\n");

2715 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2716 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2717  -
ENOTSUPP
;

2720 
»t
 = 
	`¦si_mlme_»ad_­f_»que¡
(
sdev
, 
dev
, &
ho¡_d¡
, &
d©®’
);

2721 ià(!
»t
)

2722 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, 
ho¡_d¡
, 
d©®’
);

2724 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2725 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2726  
»t
;

2727 
	}
}

2729 
	$¦si_­f_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2731 
»t
 = 0;

2732 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2733 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2734 
sk_buff
 *
Æ_skb
;

2735 
Æ©Œ
 *
Æ©Œ_¡¬t
;

2737 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_APF_GET_CAPABILITIES\n");

2738 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2739 ià(!
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
) {

2740 
	`SLSI_WARN
(
sdev
, "APF‚ot supported byhe firmware.\n");

2741 
»t
 = -
ENOTSUPP
;

2742 
ex™
;

2744 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
­f_ÿp
, 0, (
¦si_­f_ÿ·b™›s
));

2746 
»t
 = 
	`¦si_mib_g‘_­f_ÿp
(
sdev
, 
dev
);

2747 ià(
»t
 != 0) {

2748 
	`SLSI_ERR
(
sdev
, "Failedo„ead mib\n");

2749 
ex™
;

2751 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "APF v”siÚ: %d Max_L’gth:%d\n", sdev->
deviû_cÚfig
.
­f_ÿp
.
v”siÚ
,

2752 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
max_Ëngth
);

2753 
Æ_skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
);

2754 ià(!
Æ_skb
) {

2755 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

2756 
»t
 = -
ENOMEM
;

2757 
ex™
;

2760 
Æ©Œ_¡¬t
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
NL80211_ATTR_VENDOR_DATA
);

2761 ià(!
Æ©Œ_¡¬t
) {

2762 
	`SLSI_ERR
(
sdev
, "failedo…ut NL80211_ATTR_VENDOR_DATA\n");

2764 
	`kä“_skb
(
Æ_skb
);

2765 
»t
 = -
EINVAL
;

2766 
ex™
;

2769 
»t
 = 
	`Æa_put_u16
(
Æ_skb
, 
SLSI_APF_ATTR_VERSION
, 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
v”siÚ
);

2770 
»t
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_APF_ATTR_MAX_LEN
, 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
max_Ëngth
);

2771 ià(
»t
) {

2772 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

2774 
	`kä“_skb
(
Æ_skb
);

2775 
ex™
;

2778 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
Æ_skb
);

2779 ià(
»t
)

2780 
	`SLSI_ERR
(
sdev
, "­f_g‘_ÿ·b™› cfg80211_v’dÜ_cmd_»¶y faed :%d\n", 
»t
);

2781 
ex™
:

2782 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2783  
»t
;

2784 
	}
}

2786 
	$¦si_­f_£t_f‹r
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2788 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2789 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2790 
»t
 = 0;

2791 
‹mp
;

2792 
ty³
;

2793 cÚ¡ 
Æ©Œ
 *
©Œ
;

2794 
u32
 
´og¿m_Ën
 = 0;

2795 
u8
 *
´og¿m
 = 
NULL
;

2797 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Received‡pf_set_filter command\n");

2798 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2799 ià(!
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
) {

2800 
	`SLSI_WARN
(
sdev
, "APF‚ot supported byhe firmware.\n");

2801 
»t
 = -
ENOTSUPP
;

2802 
ex™
;

2805 ià(!
dev
) {

2806 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

2807 
»t
 = -
EINVAL
;

2808 
ex™
;

2811 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2812 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2813 
ty³
) {

2814 
SLSI_APF_ATTR_PROGRAM_LEN
:

2816 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
´og¿m_Ën
)) {

2817 
»t
 = -
EINVAL
;

2818 
ex™
;

2820 
	`kä“
(
´og¿m
);

2821 
´og¿m
 = 
	`km®loc
(
´og¿m_Ën
, 
GFP_KERNEL
);

2822 ià(!
´og¿m
) {

2823 
»t
 = -
ENOMEM
;

2824 
ex™
;

2828 
SLSI_APF_ATTR_PROGRAM
:

2830 ià(!
´og¿m
) {

2831 
	`SLSI_ERR
(
sdev
, "Program†en is‚ot set!\n");

2832 
»t
 = -
EINVAL
;

2833 
ex™
;

2835 ià(
	`¦si_ut_Æa_g‘_d©a
(
©Œ
, 
´og¿m_Ën
, 
´og¿m
)) {

2836 
»t
 = -
EINVAL
;

2837 
ex™
;

2842 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

2843 
»t
 = -
EINVAL
;

2844 
ex™
;

2848 
»t
 = 
	`¦si_mlme_š¡®l_­f_»que¡
(
sdev
, 
dev
, 
´og¿m
, 
´og¿m_Ën
);

2849 ià(
»t
 < 0) {

2850 
	`SLSI_ERR
(
sdev
, "­f_£t_f‹¸çed„‘:%d\n", 
»t
);

2851 
»t
 = -
EINVAL
;

2852 
ex™
;

2854 
ex™
:

2855 
	`kä“
(
´og¿m
);

2856 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2857  
»t
;

2858 
	}
}

2860 
	$¦si_¹t_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2862 
¦si_¹t_ÿ·b™›s
 
¹t_ÿp
;

2863 
»t
 = 0;

2864 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2865 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2867 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_GET_RTT_CAPABILITIES\n");

2868 ià(!
	`¦si_dev_¹t_suµÜ‹d
()) {

2869 
	`SLSI_WARN
(
sdev
, "RTT‚ot supported.\n");

2870  -
ENOTSUPP
;

2872 
	`mem£t
(&
¹t_ÿp
, 0, (
¦si_¹t_ÿ·b™›s
));

2874 
»t
 = 
	`¦si_mib_g‘_¹t_ÿp
(
sdev
, 
dev
, &
¹t_ÿp
);

2875 ià(
»t
 != 0) {

2876 
	`SLSI_ERR
(
sdev
, "Failedo„ead mib\n");

2877  
»t
;

2879 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
¹t_ÿp
, (
¦si_¹t_ÿ·b™›s
));

2880 ià(
»t
)

2881 
	`SLSI_ERR_NODEV
("¹t_g‘_ÿ·b™› v’dÜ cmd„•ly faed (”¸ğ%d)\n", 
»t
);

2882  
»t
;

2883 
	}
}

2885 
	$¦si_¹t_´oûss_rg‘_šfo
(cÚ¡ 
Æ©Œ
 *
™”
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
,

2886 
u8
 *
¹t_³”
, 
num_deviûs
)

2888 
j
 = 0, 
tmp1
, 
tmp2
;

2889 
u16
 
chªÃl_äeq
 = 0;

2890 cÚ¡ 
Æ©Œ
 *
ou‹r
, *
šÃr
;

2892 
	`Æa_fÜ_—ch_Ã¡ed
(
ou‹r
, 
™”
, 
tmp1
) {

2893 
	`Æa_fÜ_—ch_Ã¡ed
(
šÃr
, 
ou‹r
, 
tmp2
) {

2894 
	`Æa_ty³
(
šÃr
)) {

2895 
SLSI_RTT_ATTRIBUTE_TARGET_MAC
:

2896 ià(
	`¦si_ut_Æa_g‘_d©a
(
šÃr
, 
ETH_ALEN
, 
Æ_¹t_·¿ms
[
j
].
³”_addr
))

2897  -
EINVAL
;

2899 
SLSI_RTT_ATTRIBUTE_TARGET_TYPE
:

2900 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
¹t_ty³
))

2901  -
EINVAL
;

2903 
SLSI_RTT_ATTRIBUTE_TARGET_PEER
:

2904 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, 
¹t_³”
))

2905  -
EINVAL
;

2906 
Æ_¹t_·¿ms
[
j
].
¹t_³”
 = *rtt_peer;

2908 
SLSI_RTT_ATTRIBUTE_TARGET_CHAN_FREQ
:

2909 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
chªÃl_äeq
))

2910  -
EINVAL
;

2911 
Æ_¹t_·¿ms
[
j
].
chªÃl_äeq
 = channel_freq * 2;

2913 
SLSI_RTT_ATTRIBUTE_TARGET_PERIOD
:

2914 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
bur¡_³riod
))

2915  -
EINVAL
;

2917 
SLSI_RTT_ATTRIBUTE_TARGET_NUM_BURST
:

2918 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
num_bur¡
))

2919  -
EINVAL
;

2921 
SLSI_RTT_ATTRIBUTE_TARGET_NUM_FTM_BURST
:

2922 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
num_äames_³r_bur¡
))

2923  -
EINVAL
;

2925 
SLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTMR
:

2926 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
num_»Œ›s_³r_ámr
))

2927  -
EINVAL
;

2929 
SLSI_RTT_ATTRIBUTE_TARGET_BURST_DURATION
:

2930 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
bur¡_du¿tiÚ
))

2931  -
EINVAL
;

2933 
SLSI_RTT_ATTRIBUTE_TARGET_PREAMBLE
:

2934 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
´—mbË
))

2935  -
EINVAL
;

2937 
SLSI_RTT_ATTRIBUTE_TARGET_BW
:

2938 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
bw
))

2939  -
EINVAL
;

2941 
SLSI_RTT_ATTRIBUTE_TARGET_LCI
:

2942 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
LCI_»que¡
))

2943  -
EINVAL
;

2945 
SLSI_RTT_ATTRIBUTE_TARGET_LCR
:

2946 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
LCR_»que¡
))

2947  -
EINVAL
;

2953 
j
++;

2954 ià(
j
 > 
num_deviûs
)

2958 
	}
}

2960 
	$¦si_¹t_£t_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2962 
r
 = -
EINVAL
, 
ty³
, 
¹t_id
, 
j
 = 0;

2963 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2964 
Ãtdev_vif
 *
ndev_vif
;

2965 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2966 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
;

2967 
¦si_¹t_id_·¿ms
 *
¹t_id_·¿ms
 = 
NULL
;

2968 cÚ¡ 
Æ©Œ
 *
™”
;

2969 
u8
 
sourû_addr
[
ETH_ALEN
];

2970 
tmp
;

2971 
u16
 
»que¡_id
 = 0;

2972 
u8
 
num_deviûs
 = 0;

2973 
u8
 
¹t_³”
 = 
SLSI_RTT_PEER_AP
;

2975 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_RTT_RANGE_START\n");

2976 ià(!
	`¦si_dev_¹t_suµÜ‹d
()) {

2977 
	`SLSI_ERR
(
sdev
, "RTT‚ot supported.\n");

2978  
WIFI_HAL_ERROR_NOT_SUPPORTED
;

2980 ià(!
dev
) {

2981 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

2982  
r
;

2985 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2986 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2987 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2988 
ty³
 = 
	`Æa_ty³
(
™”
);

2989 
ty³
) {

2990 
SLSI_RTT_ATTRIBUTE_TARGET_CNT
:

2991 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
num_deviûs
))

2992 
ex™_w™h_mu‹x
;

2993 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "T¬g‘ cÁ %d\n", 
num_deviûs
);

2995 
SLSI_RTT_ATTRIBUTE_TARGET_ID
:

2996 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
»que¡_id
))

2997 
ex™_w™h_mu‹x
;

2998 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Reque¡ ID: %d\n", 
»que¡_id
);

3005 ià(!
num_deviûs
) {

3006 
	`SLSI_ERR_NODEV
("No device found for„tt configuration!\n");

3007 
ex™_w™h_mu‹x
;

3010 
Æ_¹t_·¿ms
 = 
	`kÿÎoc
(
num_deviûs
, (*Æ_¹t_·¿ms), 
GFP_KERNEL
);

3011 ià(!
Æ_¹t_·¿ms
) {

3012 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for config„tt_param\n");

3013 
r
 = -
ENOMEM
;

3014 
ex™_w™h_mu‹x
;

3016 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

3017 
ty³
 = 
	`Æa_ty³
(
™”
);

3018 
ty³
) {

3019 
SLSI_RTT_ATTRIBUTE_TARGET_INFO
:

3020 
r
 = 
	`¦si_¹t_´oûss_rg‘_šfo
(
™”
, 
Æ_¹t_·¿ms
, &
¹t_³”
, 
num_deviûs
);

3021 ià(
r
)

3022 
ex™_w™h_Æ_¹t_·¿ms
;

3028 
	`SLSI_ETHER_COPY
(
sourû_addr
, 
dev
->
dev_addr
);

3030 
¹t_id
 = 
SLSI_MIN_RTT_ID
;„‰_id <ğ
SLSI_MAX_RTT_ID
;„tt_id++) {

3031 ià(!
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]) {

3032 
¹t_id_·¿ms
 = 
	`kz®loc
((
¦si_¹t_id_·¿ms
è+ 
ETH_ALEN
 * 
num_deviûs
, 
GFP_KERNEL
);

3033 ià(!
¹t_id_·¿ms
) {

3034 
	`SLSI_INFO
(
sdev
, "Failedo‡llocate memory for„tt_id_params.\n");

3035 
r
 = -
ENOMEM
;

3036 
ex™_w™h_Æ_¹t_·¿ms
;

3038 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] =„tt_id_params;

3042 ià(
¹t_id
 > 
SLSI_MAX_RTT_ID
) {

3043 
	`SLSI_ERR_NODEV
("RTT_ID(1-7) is in use currently!!\n");

3044 
ex™_w™h_Æ_¹t_·¿ms
;

3046 
¹t_id_·¿ms
->
çpi_»q_id
 = 
¹t_id
;

3047 
¹t_id_·¿ms
->
h®_»que¡_id
 = 
»que¡_id
;

3048 
¹t_id_·¿ms
->
³”_couÁ
 = 
num_deviûs
;

3049 
¹t_id_·¿ms
->
³”_ty³
 = 
¹t_³”
;

3051 
j
 = 0; j < 
num_deviûs
; j++)

3052 
	`SLSI_ETHER_COPY
(&
¹t_id_·¿ms
->
³”s
[
j
 * 
ETH_ALEN
], 
Æ_¹t_·¿ms
[j].
³”_addr
);

3053 ià(
¹t_³”
 =ğ
SLSI_RTT_PEER_NAN
) {

3054 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


3055 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3056 
r
 = 
	`¦si_£nd_Çn_¿nge_cÚfig
(
sdev
, 
num_deviûs
, 
Æ_¹t_·¿ms
, 
¹t_id
);

3057 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3059 
	`SLSI_ERR_NODEV
("NAN‚otƒnabled\n");

3060 
r
 = -
ENOTSUPP
;

3063 
r
 = 
	`¦si_mlme_add_¿nge_»q
(
sdev
, 
dev
, 
num_deviûs
, 
Æ_¹t_·¿ms
, 
¹t_id
, 
sourû_addr
);

3064 ià(
r
) {

3065 
	`kä“
(
¹t_id_·¿ms
);

3066 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3067 
	`SLSI_ERR_NODEV
("Failedo set„tt config\n");

3070 
ex™_w™h_Æ_¹t_·¿ms
:

3071 
	`kä“
(
Æ_¹t_·¿ms
);

3073 
ex™_w™h_mu‹x
:

3074 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3075  
r
;

3076 
	}
}

3078 
	$¦si_tx_¿‹_ÿlc
(
sk_buff
 *
Æ_skb
, 
u16
 
fw_¿‹
, 
»s
, 
boŞ
 
tx_¿‹
)

3080 
u8
 
´—mbË
;

3081 cÚ¡ 
u32
 
fw_¿‹_idx_to_80211_¿‹
[] = { 0, 10, 20, 55, 60, 90, 110, 120, 180, 240, 360, 480, 540 };

3082 
u32
 
d©a_¿‹
 = 0;

3083 
u32
 
mcs
 = 0, 
nss
 = 0;

3084 
u32
 
chª_bw_idx
 = 0;

3085 
gi_idx
;

3087 
´—mbË
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
) >> 14;

3088 ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_NON_HT_SELECTED
) {

3089 
u16
 
fw_¿‹_idx
 = 
fw_¿‹
 & 
SLSI_FW_API_RATE_INDEX_FIELD
;

3091 ià(
fw_¿‹
 > 0 && 
fw_¿‹_idx
 < 
	`ARRAY_SIZE
(
fw_¿‹_idx_to_80211_¿‹
))

3092 
d©a_¿‹
 = 
fw_¿‹_idx_to_80211_¿‹
[
fw_¿‹_idx
];

3093 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_HT_SELECTED
) {

3094 
nss
 = (
SLSI_FW_API_RATE_HT_NSS_FIELD
 & 
fw_¿‹
) >> 6;

3095 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

3096 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

3097 
mcs
 = 
SLSI_FW_API_RATE_HT_MCS_FIELD
 & 
fw_¿‹
;

3098 ià(
chª_bw_idx
 < 2 && 
mcs
 <= 7) {

3099 
d©a_¿‹
 = (
nss
 + 1è* 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs
];

3100 } ià(
mcs
 =ğ32 && 
chª_bw_idx
 == 1) {

3101 ià(
gi_idx
 == 1)

3102 
d©a_¿‹
 = (
nss
 + 1) * 67;

3104 
d©a_¿‹
 = (
nss
 + 1) * 60;

3106 
	`SLSI_WARN_NODEV
("FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,‚ss : %d\n",

3107 
fw_¿‹
, 
chª_bw_idx
, 
mcs
, 
nss
);

3109 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_VHT_SELECTED
) {

3113 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

3114 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

3116 
nss
 = (
SLSI_FW_API_RATE_VHT_NSS_FIELD
 & 
fw_¿‹
) >> 4;

3117 
mcs
 = 
SLSI_FW_API_RATE_VHT_MCS_FIELD
 & 
fw_¿‹
;

3119 ià(
chª_bw_idx
 <ğ2 && 
mcs
 <= 11)

3120 
d©a_¿‹
 = (
nss
 + 1è* 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs
];

3122 
	`SLSI_WARN_NODEV
("FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,nss : %d\n",

3123 
fw_¿‹
, 
chª_bw_idx
, 
mcs
, 
nss
);

3124 ià(
nss
 > 1)

3125 
nss
 += 1;

3128 ià(
tx_¿‹
) {

3129 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_PREAMBLE
, 
´—mbË
);

3130 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_NSS
, 
nss
);

3131 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_BW
, 
chª_bw_idx
);

3132 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_MCS
, 
mcs
);

3133 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_RATE
, 
d©a_¿‹
);

3135 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_PREAMBLE
, 
´—mbË
);

3136 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_NSS
, 
nss
);

3137 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_BW
, 
chª_bw_idx
);

3138 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_MCS
, 
mcs
);

3139 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_RATE
, 
d©a_¿‹
);

3141  
»s
;

3142 
	}
}

3144 
	$¦si_rx_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3146 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3147 
u32
 
i
, 
tm
;

3148 
u16
 
¹t_’Œy_couÁ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¿nge_šd
.
’Œ›s
);

3149 
u16
 
¹t_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¿nge_šd
.rtt_id);

3150 
u16
 
»que¡_id
;

3151 
u32
 
tmac
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
mlme_¿nge_šd
.
time¡amp
);

3152 
d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3153 
u8
 *
_±r
, *
¡¬t_±r
;

3154 
u16
 
tx_d©a
 = 0, 
rx_d©a
 = 0;

3155 
sk_buff
 *
Æ_skb
;

3156 
»s
 = 0;

3157 
Æ©Œ
 *
Æ©Œ_Ã¡ed
;

3158 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3159 
time¥ec64
 
ts
;

3161 
time¥ec
 
ts
;

3163 
u64
 
tk”Ãl
;

3164 
u8
 
»p_út
 = 0;

3165 
__Ë16
 *
Ë16_±r
 = 
NULL
;

3166 
__Ë32
 *
Ë32_±r
 = 
NULL
;

3167 
u16
 
v®ue
;

3168 
u32
 
‹mp_v®ue
;

3170 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3172 ià(
¹t_’Œy_couÁ
 > 
SLSI_WIFI_RTT_RESULT_MAX_ENTRY
) {

3173 
	`SLSI_WARN
(
sdev
, "Inv®id„‰„esuÉƒÁry couÁ : %d\n", 
¹t_’Œy_couÁ
);

3174 
ex™
;

3176 ià(
d©a_Ën
 < 
SLSI_WIFI_RTT_RESULT_LENGTH
 + 2) {

3177 
	`SLSI_WARN
(
sdev
, "Inv®id„‰„esuÉ†’gth : %d\n", 
d©a_Ën
);

3178 
ex™
;

3180 ià(
¹t_id
 < 
SLSI_MIN_RTT_ID
 ||„‰_id > 
SLSI_MAX_RTT_ID
) {

3181 
	`SLSI_WARN
(
sdev
, "Inv®id„‰_id : %d\n", 
¹t_id
);

3182 
ex™
;

3184 
»que¡_id
 = 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]->
h®_»que¡_id
;

3186 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

3187 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

3188 
SLSI_NL80211_RTT_RESULT_EVENT
, 
GFP_KERNEL
);

3190 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_RTT_RESULT_EVENT
,

3191 
GFP_KERNEL
);

3193 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3194 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3195 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_RESULT_EVENT
), SLSI_NL80211_RTT_RESULT_EVENT);

3198 ià(!
Æ_skb
) {

3199 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3200 
ex™
;

3203 
_±r
 = 
	`çpi_g‘_d©a
(
skb
);

3204 
¡¬t_±r
 = 
	`çpi_g‘_d©a
(
skb
);

3205 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULT_CNT
, 
¹t_’Œy_couÁ
);

3206 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_TARGET_ID
, 
»que¡_id
);

3207 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULTS_PER_TARGET
, 1);

3208 
i
 = 0; i < 
¹t_’Œy_couÁ
; i++) {

3209 ià(
_±r
[0] !ğ
SLSI_WIFI_RTT_RESULT_ID
) {

3210 
	`SLSI_WARN
(
sdev
, "rtt_entry : %d Invalid id : %d\n",

3211 
i
, 
_±r
[0]);

3214 ià(
_±r
[1] !ğ
SLSI_WIFI_RTT_RESULT_LENGTH
) {

3215 
	`SLSI_WARN
(
sdev
, "rtt_entry : %d Invalid†en:%d\n",

3216 
i
, 
_±r
[1]);

3220 
Æ©Œ_Ã¡ed
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULT
);

3221 ià(!
Æ©Œ_Ã¡ed
) {

3222 
	`SLSI_ERR
(
sdev
, "Error in‚la_nest_start\n");

3224 
	`kä“_skb
(
Æ_skb
);

3225 
ex™
;

3227 
_±r
 += 7;

3228 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_ADDR
, 
ETH_ALEN
, 
_±r
);

3229 
_±r
 += 6;

3231 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3232 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3233 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_NUM
, 
v®ue
);

3234 
_±r
 += 2;

3236 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_MEASUREMENT_NUM
, *
_±r
++);

3237 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_SUCCESS_NUM
, *
_±r
++);

3238 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NUM_PER_BURST_PEER
, *
_±r
++);

3240 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3241 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3242 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_STATUS
, 
v®ue
);

3243 
_±r
 += 2;

3244 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RETRY_AFTER_DURATION
, *
_±r
++);

3246 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TYPE
, *
_±r
++);

3248 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI
, *
_±r
++);

3250 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI_SPREAD
, *
_±r
++);

3252 
	`memıy
(&
tx_d©a
, 
_±r
, 2);

3253 
»s
 = 
	`¦si_tx_¿‹_ÿlc
(
Æ_skb
, 
tx_d©a
,„es, 1);

3254 
_±r
 += 2;

3256 
	`memıy
(&
rx_d©a
, 
_±r
, 2);

3257 
»s
 = 
	`¦si_tx_¿‹_ÿlc
(
Æ_skb
, 
rx_d©a
,„es, 0);

3258 
_±r
 += 2;

3260 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3261 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3262 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT
, 
‹mp_v®ue
);

3263 
_±r
 += 4;

3265 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3266 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3267 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SD
, 
v®ue
);

3268 
_±r
 += 2;

3270 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3271 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3272 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SPREAD
, 
v®ue
);

3273 
_±r
 += 2;

3275 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3276 
ts
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

3277 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

3278 
ts
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

3280 
	`g‘_mÚÙÚic_boÙtime
(&
ts
);

3283 
tk”Ãl
 = (
u64
)
	`TIMESPEC_TO_US
(
ts
);

3284 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3285 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3286 
tm
 = 
‹mp_v®ue
;

3287 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TIMESTAMP_US
, 
tk”Ãl
 - (
tmac
 - 
tm
));

3288 
_±r
 += 4;

3290 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3291 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3292 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_MM
, 
‹mp_v®ue
);

3293 
_±r
 += 4;

3295 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3296 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3297 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_SD_MM
, 
‹mp_v®ue
);

3298 
_±r
 += 4;

3300 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_DURATION_MSN
, *
_±r
++);

3301 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NEGOTIATED_BURST_NUM
, *
_±r
++);

3302 
»p_út
 = 0;„ep_cnt < 2;„ep_cnt++) {

3303 ià(
_±r
 - 
¡¬t_±r
 < 
d©a_Ën
 && ip_±r[0] =ğ
WLAN_EID_MEASURE_REPORT
) {

3304 ià(
_±r
[4] == 8)

3305 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_LCI
,

3306 
_±r
[1] + 2, ip_ptr);

3307 ià(
_±r
[4] == 11)

3308 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_LCR
,

3309 
_±r
[1] + 2, ip_ptr);

3310 
_±r
 += ip_ptr[1] + 2;

3313 
	`Æa_Ã¡_’d
(
Æ_skb
, 
Æ©Œ_Ã¡ed
);

3315 
	`SLSI_DBG_HEX
(
sdev
, 
SLSI_GSCAN
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb), "range indication skb buffer:\n");

3316 ià(
»s
) {

3317 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3318 
	`kä“_skb
(
Æ_skb
);

3319 
ex™
;

3321 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3322 
ex™
:

3323 
	`kä“_skb
(
skb
);

3324 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3325 
	}
}

3327 
	$¦si_rx_¿nge_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3329 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3330 
u16
 
¹t_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¿nge_šd
.rtt_id);

3331 
u16
 
»que¡_id
;

3333 ià(
¹t_id
 < 
SLSI_MIN_RTT_ID
 ||„‰_id > 
SLSI_MAX_RTT_ID
) {

3334 
	`SLSI_WARN
(
sdev
, "Inv®id„‰_id : %d\n", 
¹t_id
);

3335 
	`kä“_skb
(
skb
);

3338 
»que¡_id
 = 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]->
h®_»que¡_id
;

3340 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3341 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3342 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3343 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_COMPLETE_EVENT
), SLSI_NL80211_RTT_COMPLETE_EVENT);

3345 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_RTT_COMPLETE_EVENT
, &
»que¡_id
, (request_id));

3347 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]);

3348 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3349 
	`kä“_skb
(
skb
);

3350 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3351 
	}
}

3354 
	$¦si_¹t_»move_³”
(
¦si_dev
 *
sdev
, 
u8
 *
addr
, u8 
¹t_id_idx
, u8 
couÁ_addr
)

3356 
i
 = 0, 
j
;

3357 
u8
 
z”o_addr
[
ETH_ALEN
];

3358 
u8
 
»move_id
 = 1;

3360 
	`mem£t
(
z”o_addr
, 0, 
ETH_ALEN
);

3362 
i
 = 0; i < 
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”_couÁ
; i++) {

3363 
j
 = 0; j < 
couÁ_addr
; j++)

3364 ià(
	`SLSI_ETHER_EQUAL
(&
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”s
[
i
 * 
ETH_ALEN
],

3365 &
addr
[
j
 * 
ETH_ALEN
]))

3366 
	`SLSI_ETHER_COPY
(&
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”s
[
i
 * 
ETH_ALEN
], 
z”o_addr
);

3368 ià(!
	`SLSI_ETHER_EQUAL
(&
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”s
[
i
 * 
ETH_ALEN
], 
z”o_addr
))

3369 
»move_id
 = 0;

3372 ià(
»move_id
) {

3373 
	`SLSI_INFO
(
sdev
, "Remov¹ˆid:%d\n", 
¹t_id_idx
 + 1);

3374 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]);

3375 
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
] = 
NULL
;

3377 
	}
}

3379 
	$¦si_¹t_ÿnûl_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3381 
‹mp
, 
r
 = 1, 
j
 = 0, 
ty³
, 
couÁ
 = 0, 
i
 = 0, 
k
 = 0;

3382 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3383 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3384 
Ãtdev_vif
 *
ndev_vif
;

3385 
u8
 *
addr
;

3387 
u8
 *
ÿnûl_addr_li¡
;

3388 cÚ¡ 
Æ©Œ
 *
™”
;

3389 
u16
 
num_deviûs
 = 0;

3390 
u8
 
couÁ_addr
 = 0, 
³”_couÁ
 = 0;

3392 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "RTT_SUBCMD_CANCEL_CONFIG\n");

3393 ià(!
	`¦si_dev_¹t_suµÜ‹d
()) {

3394 
	`SLSI_WARN
(
sdev
, "RTT‚ot supported.\n");

3395  -
ENOTSUPP
;

3397 ià(!
dev
) {

3398 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3399  -
EINVAL
;

3402 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3403 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3404 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
‹mp
) {

3405 
ty³
 = 
	`Æa_ty³
(
™”
);

3406 
ty³
) {

3407 
SLSI_RTT_ATTRIBUTE_TARGET_CNT
:

3408 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
num_deviûs
)) {

3409 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3410  -
EINVAL
;

3412 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "T¬g‘ cÁ %d\n", 
num_deviûs
);

3415 
	`SLSI_ERR_NODEV
("NØATTRIBUTE_T¬g‘ cÁ - %d\n", 
ty³
);

3419 ià(!
num_deviûs
) {

3420 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3421  
r
;

3424 
addr
 = 
	`kz®loc
(
ETH_ALEN
 * 
num_deviûs
, 
GFP_KERNEL
);

3425 ià(!
addr
) {

3426 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for mac‡ddresses\n");

3427 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3428  -
ENOMEM
;

3430 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
‹mp
) {

3431 
ty³
 = 
	`Æa_ty³
(
™”
);

3432 ià(
ty³
 =ğ
SLSI_RTT_ATTRIBUTE_TARGET_MAC
) {

3433 ià(
couÁ
 >ğ
num_deviûs
)

3435 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, &
addr
[
j
]))

3437 
j
 = j + 
ETH_ALEN
;

3438 
couÁ
++;

3440 
	`SLSI_ERR_NODEV
("NØATTRIBUTE_MAC - %d\n", 
ty³
);

3443 
ÿnûl_addr_li¡
 = 
	`kz®loc
(
ETH_ALEN
 * 
num_deviûs
, 
GFP_KERNEL
);

3444 ià(!
ÿnûl_addr_li¡
) {

3445 
	`SLSI_INFO
(
sdev
, "Failedo‡llocate memory for cancel_addr_list.\n");

3446 
	`kä“
(
addr
);

3447 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3448  -
ENOMEM
;

3451 
i
 = 0; i < 
SLSI_MAX_RTT_ID
; i++) {

3452 
couÁ_addr
 = 0;

3453 ià(!
sdev
->
¹t_id_·¿ms
[
i
])

3455 
j
 = 0; j < 
num_deviûs
; j++) {

3456 
³”_couÁ
 = 
sdev
->
¹t_id_·¿ms
[
i
]->peer_count;

3457 
k
 = 0; k < 
³”_couÁ
; k++)

3458 ià(
	`SLSI_ETHER_EQUAL
(&
sdev
->
¹t_id_·¿ms
[
i
]->
³”s
[
k
 * 
ETH_ALEN
],

3459 &
addr
[
j
 * 
ETH_ALEN
])) {

3460 
	`SLSI_ETHER_COPY
(&
ÿnûl_addr_li¡
[
couÁ_addr
 * 
ETH_ALEN
], &
addr
[
j
 * ETH_ALEN]);

3461 
couÁ_addr
++;

3465 ià(!
couÁ_addr
)

3467 ià(
sdev
->
¹t_id_·¿ms
[
i
]->
³”_ty³
 =ğ
SLSI_RTT_PEER_NAN
) {

3468 
sdev
->
¹t_id_·¿ms
[
i
]->
³”_ty³
 = 0;

3469 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


3470 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3471 
r
 = 
	`¦si_£nd_Çn_¿nge_ÿnûl
(
sdev
);

3472 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3474 
	`SLSI_ERR_NODEV
("NAN‚otƒnabled\n");

3475 
r
 = -
ENOTSUPP
;

3478 
r
 = 
	`¦si_mlme_d–_¿nge_»q
(
sdev
, 
dev
, 
couÁ_addr
, 
ÿnûl_addr_li¡
, 
i
 + 1);

3480 
	`¦si_¹t_»move_³”
(
sdev
, 
ÿnûl_addr_li¡
, 
i
, 
couÁ_addr
);

3481 ià(
r
)

3482 
	`SLSI_ERR_NODEV
("FaedØÿnûÈ¹ˆcÚfig fÜ id:%d\n", 
i
 + 1);

3483 
	`mem£t
(
ÿnûl_addr_li¡
, 0, 
ETH_ALEN
 * 
num_deviûs
);

3485 
	`kä“
(
addr
);

3486 
	`kä“
(
ÿnûl_addr_li¡
);

3487 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3488  
r
;

3489 
	}
}

3491 #ià
IS_ENABLED
(
CONFIG_IPV6
)

3492 
	$¦si_cÚfigu»_nd_ofæßd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3494 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3495 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3496 
Ãtdev_vif
 *
ndev_vif
;

3497 
»t
 = 0;

3498 
‹mp
;

3499 
ty³
;

3500 cÚ¡ 
Æ©Œ
 *
©Œ
;

3501 
u8
 
nd_ofæßd_’abËd
 = 0;

3503 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Received‚d_offload command\n");

3505 ià(!
dev
) {

3506 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3507  -
EINVAL
;

3510 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3511 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3513 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

3514 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3515 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "vifƒrror\n");

3516 
»t
 = -
EPERM
;

3517 
ex™
;

3520 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

3521 
ty³
 = 
	`Æa_ty³
(
©Œ
);

3522 
ty³
) {

3523 
SLSI_NL_ATTRIBUTE_ND_OFFLOAD_VALUE
:

3525 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
nd_ofæßd_’abËd
)) {

3526 
»t
 = -
EINVAL
;

3527 
ex™
;

3532 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

3533 
»t
 = -
EINVAL
;

3534 
ex™
;

3538 
ndev_vif
->
¡a
.
nd_ofæßd_’abËd
 =‚d_offload_enabled;

3539 
»t
 = 
	`¦si_mlme_£t_v6_add»ss
(
sdev
, 
dev
);

3540 ià(
»t
 < 0) {

3541 
	`SLSI_ERR
(
sdev
, "CÚfigu»‚d_ofæßd faed„‘:%d‚d_ofæßd_’abËd: %d\n", 
»t
, 
nd_ofæßd_’abËd
);

3542 
»t
 = -
EINVAL
;

3543 
ex™
;

3545 
ex™
:

3546 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3547  
»t
;

3548 
	}
}

3551 
	$¦si_g‘_rßmšg_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3553 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3554 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3555 
Ãtdev_vif
 *
ndev_vif
;

3556 
»t
 = 0;

3557 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3558 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3559 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_ROAM_BLACKLIST_SIZE
, { 0, 0 } } };

3560 
u32
 
max_bÏckli¡_size
 = 0;

3561 
u32
 
max_wh™–i¡_size
 = 0;

3562 
sk_buff
 *
Æ_skb
;

3563 
Æ©Œ
 *
Æ©Œ_¡¬t
;

3565 ià(!
dev
) {

3566 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3567  -
EINVAL
;

3570 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3572 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3574 
mibr¥
.
d©aL’gth
 = 10;

3575 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3576 ià(!
mibr¥
.
d©a
) {

3577 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

3578 
»t
 = -
ENOMEM
;

3579 
ex™
;

3581 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

3582 ià(
v®ues
 && (v®ues[0].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
 || v®ues[0].ty³ =ğ
SLSI_MIB_TYPE_INT
))

3583 
max_bÏckli¡_size
 = 
v®ues
[0].
u
.
uštV®ue
;

3584 
Æ_skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
);

3585 ià(!
Æ_skb
) {

3586 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3587 
»t
 = -
ENOMEM
;

3588 
ex™_w™h_mib_»¥
;

3591 
Æ©Œ_¡¬t
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
NL80211_ATTR_VENDOR_DATA
);

3592 ià(!
Æ©Œ_¡¬t
) {

3593 
	`SLSI_ERR
(
sdev
, "failedo…ut NL80211_ATTR_VENDOR_DATA\n");

3595 
	`kä“_skb
(
Æ_skb
);

3596 
»t
 = -
EINVAL
;

3597 
ex™_w™h_mib_»¥
;

3600 
»t
 = 
	`Æa_put_u32
(
Æ_skb
, 
SLSI_NL_ATTR_MAX_BLACKLIST_SIZE
, 
max_bÏckli¡_size
);

3601 
»t
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_NL_ATTR_MAX_WHITELIST_SIZE
, 
max_wh™–i¡_size
);

3602 ià(
»t
) {

3603 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

3605 
	`kä“_skb
(
Æ_skb
);

3606 
ex™_w™h_mib_»¥
;

3609 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
Æ_skb
);

3610 ià(
»t
)

3611 
	`SLSI_ERR
(
sdev
, "cfg80211_v’dÜ_cmd_»¶y faed :%d\n", 
»t
);

3612 
ex™_w™h_mib_»¥
:

3613 
	`kä“
(
mibr¥
.
d©a
);

3614 
	`kä“
(
v®ues
);

3615 
ex™
:

3616 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3617  
»t
;

3618 
	}
}

3620 
	$¦si_£t_rßmšg_¡©e
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3622 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3623 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3624 
‹mp
 = 0;

3625 
ty³
 = 0;

3626 cÚ¡ 
Æ©Œ
 *
©Œ
;

3627 
»t
 = 0;

3628 
rßm_¡©e
 = 0;

3629 
u8
 
v®
 = 0;

3631 ià(!
dev
) {

3632 
	`SLSI_WARN_NODEV
("net_dev is NULL\n");

3633  -
EINVAL
;

3636 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

3637 
ty³
 = 
	`Æa_ty³
(
©Œ
);

3638 
ty³
) {

3639 
SLSI_NL_ATTR_ROAM_STATE
:

3640 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

3641 
»t
 = -
EINVAL
;

3642 
ex™
;

3644 
rßm_¡©e
 = ()
v®
;

3647 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

3648 
»t
 = -
EINVAL
;

3649 
ex™
;

3653 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_SET_ROAMING_STATE„ßm_¡©ğ%d\n", 
rßm_¡©e
);

3654 
»t
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAMING_ACTIVATED
, 
rßm_¡©e
);

3655 ià(
»t
 < 0)

3656 
	`SLSI_ERR_NODEV
("Failedo set„oaming state\n");

3658 
ex™
:

3659  
»t
;

3660 
	}
}

3662 *
	$¦si_g‘_rßm_»asÚ_¡r
(
rßm_»asÚ
)

3664 
rßm_»asÚ
) {

3665 
SLSI_WIFI_ROAMING_SEARCH_REASON_RESERVED
:

3667 
SLSI_WIFI_ROAMING_SEARCH_REASON_LOW_RSSI
:

3669 
SLSI_WIFI_ROAMING_SEARCH_REASON_LINK_LOSS
:

3671 
SLSI_WIFI_ROAMING_SEARCH_REASON_BTM_REQ
:

3673 
SLSI_WIFI_ROAMING_SEARCH_REASON_CU_TRIGGER
:

3675 
SLSI_WIFI_ROAMING_SEARCH_REASON_EMERGENCY
:

3677 
SLSI_WIFI_ROAMING_SEARCH_REASON_IDLE
:

3679 
SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER1_EXPIRY
:

3681 
SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER2_EXPIRY
:

3683 
SLSI_WIFI_ROAMING_SEARCH_REASON_INACTIVE_TIMER_EXPIRY
:

3688 
	}
}

3690 *
	$¦si_g‘_Çn_rŞe_¡r
(
Çn_rŞe
)

3692 
Çn_rŞe
) {

3706 
	}
}

3708 *
	$¦si_äame_Œªsm™_çu»_mes§ge_ty³
(
mes§ge_ty³
)

3710 
mes§ge_ty³
) {

3730 
	}
}

3732 *
	$¦si_g‘_sÿn_ty³
(
sÿn_ty³
)

3734 
sÿn_ty³
) {

3735 
FAPI_SCANTYPE_SOFT_CACHED_ROAMING_SCAN
:

3737 
FAPI_SCANTYPE_SOFT_FULL_ROAMING_SCAN
:

3739 
FAPI_SCANTYPE_HARD_CACHED_ROAMING_SCAN
:

3741 
FAPI_SCANTYPE_HARD_FULL_ROAMING_SCAN
:

3746 
	}
}

3748 *
	$¦si_g‘_m—su»_mode
(
m—su»_mode
)

3750 
m—su»_mode
) {

3760 
	}
}

3762 *
	$¦si_g‘_Çn_scheduË_ty³_¡r
(
scheduË_ty³
)

3764 
scheduË_ty³
) {

3774 
	}
}

3776 *
	$¦si_g‘_Çn_ulw_»asÚ_¡r
(
ulw_»asÚ
)

3778 
ulw_»asÚ
) {

3794 
	}
}

3796 
	#SLSI_32BYTES_ARRAY_PATTERN
 "%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d " \

3797 "%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d "

	)

3798 
	#SLSI_32BYTES_ARRAY_LIST
(
¬¿y
) \

3799 
¬¿y
[0],‡rray[1],‡rray[2],‡rray[3], \

3800 
¬¿y
[4],‡rray[5],‡rray[6],‡rray[7], \

3801 
¬¿y
[8],‡rray[9],‡rray[10],‡rray[11], \

3802 
¬¿y
[12],‡rray[13],‡rray[14],‡rray[15], \

3803 
¬¿y
[16],‡rray[17],‡rray[18],‡rray[19], \

3804 
¬¿y
[20],‡rray[21],‡rray[22],‡rray[23], \

3805 
¬¿y
[24],‡rray[25],‡rray[26],‡rray[27], \

3806 
¬¿y
[28],‡¼ay[29],‡¼ay[30],‡¼ay[31]

	)

3808 
	s·¿m‘”_£t
 {

3809 
u32
 
	mma¡”_tsf
;

3810 
u32
 
	mchªÃl
;

3811 
u8
 
	mwidth
;

3812 
u8
 
	mpos™iÚ
;

3813 
u32
 
	mscheduË_ty³
;

3814 
u32
 
	m¡¬t_off£t
;

3815 
u32
 
	m¦Ù_du¿tiÚ
;

3816 
u32
 
	m¦Ù_b™m­
;

3819 
	$¦si_´št_avaab™y_log_šd
(
¦si_dev
 *
sdev
, 
·¿m‘”_£t
 *
pm_£t
, cÚ¡ *
ev’t
, 
u64
 
time¡amp
)

3821 ià(
pm_£t
->
¦Ù_b™m­
) {

3822 
	`SLSI_INFO
(
sdev
, "[0x%x] %s, Master_TSF: %x, Freq: %d, Width: %d, Primary channel Position: %d, Schedule Type: %s,"

3824 
SLSI_BYTE_TO_BINARY_PATTERN
" "SLSI_BYTE_TO_BINARY_PATTERN" "

3825 
SLSI_BYTE_TO_BINARY_PATTERN
" "SLSI_BYTE_TO_BINARY_PATTERN"\n",

3826 
time¡amp
, 
ev’t
, 
pm_£t
->
ma¡”_tsf
,…m_£t->
chªÃl
,…m_£t->
width
,…m_£t->
pos™iÚ
,

3827 
	`¦si_g‘_Çn_scheduË_ty³_¡r
(
pm_£t
->
scheduË_ty³
),…m_£t->
¡¬t_off£t
,

3828 
pm_£t
->
¦Ù_du¿tiÚ
, 
	`SLSI_BYTE_TO_BINARY
Õm_£t->
¦Ù_b™m­
),

3829 
	`SLSI_BYTE_TO_BINARY
(
pm_£t
->
¦Ù_b™m­
 >> 8), SLSI_BYTE_TO_BINARY(pm_set->slot_bitmap >> 16),

3830 
	`SLSI_BYTE_TO_BINARY
(
pm_£t
->
¦Ù_b™m­
 >> 24));

3832 
	`SLSI_INFO
(
sdev
, "[0x%x] %s, Master_TSF: %x, Freq: %d, Width: %d, Primary channel Position: %d, Schedule Type: %s\n",

3833 
time¡amp
, 
ev’t
, 
pm_£t
->
ma¡”_tsf
,…m_£t->
chªÃl
,…m_£t->
width
,…m_£t->
pos™iÚ
,

3834 
	`¦si_g‘_Çn_scheduË_ty³_¡r
(
pm_£t
->
scheduË_ty³
));

3836 
	}
}

3838 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


3839 
	$¦si_hªdË_Çn_rx_ev’t_log_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3841 
u16
 
ev’t_id
 = 0;

3842 
u64
 
time¡amp
 = 0;

3843 
u8
 *
v_d©a
;

3844 
v_bufãr__Ën
 = 
	`çpi_g‘_d©®’
(
skb
), 
i
 = 0, 
¡©us_code
 = -1, 
tx_£nd_¡©us
 = -1, 
¡©us_¡Üed
 = 0;

3845 
u16
 
v’dÜ_Ën
, 
g_id
, 
g_Ën
, 
vg_id
, 
ndp_id
 = 0;

3846 
u32
 
g_v®ue
, 
vg_v®ue
;

3847 
boŞ
 
muÉi_·¿m
 = 
çl£
, 
·¿m_£t_avaabË
 = false;

3848 
u32
 
Çn_rŞe
 = 0, 
hİ_couÁ
 = 0;

3849 
u32
 
ulw_»asÚ
 = 0, 
ulw_šdex
 = 0, 
ulw_¡¬t
 = 0, 
ulw_³riod
 = 0, 
ulw_du¿tiÚ
 = 0, 
ulw_couÁ
 = 0;

3850 
u32
 
tx_mpdu_tÙ®
 = 0, 
rx_mpdu_tÙ®
 = 0;

3851 
u32
 
¦Ù_avg_rx
[32] = { 0}, 
¦Ù_avg_tx
[32] = {0};

3852 
u8
 
Çn_şu¡”_id
[
ETH_ALEN
] = {0}, 
Çn_nmi
[ETH_ALEN] = {0}, 
³”_mac_addr
[ETH_ALEN] = {0};

3853 
u32
 
Çn_amr_high”
 = 0, 
Çn_amr_low”
 = 0;

3854 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3855 
·¿m‘”_£t
 
pm_£t
 = {0};

3857 
ev’t_id
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_ev’t_log_šd
.
ev’t
);

3858 
time¡amp
 = 
	`çpi_g‘_u64
(
skb
, 
u
.
mlme_ev’t_log_šd
.
fw_tsf
);

3859 
v_d©a
 = 
	`çpi_g‘_d©a
(
skb
);

3860 
i
 + 4 < 
v_bufãr__Ën
) {

3861 
g_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

3862 
g_Ën
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
 + 2]));

3863 
i
 += 4;

3864 ià(
i
 + 
g_Ën
 > 
v_bufãr__Ën
) {

3865 
	`SLSI_INFO
(
sdev
,

3867 
ev’t_id
, 
time¡amp
, 
g_id
, 
g_Ën
, 
i
, 
v_bufãr__Ën
);

3868 
	`SLSI_INFO_HEX
(
sdev
, 
v_d©a
, 
v_bufãr__Ën
, "mbulk_data\n");

3871 
g_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
], 
g_Ën
);

3872 
muÉi_·¿m
 = 
çl£
;

3873 
g_id
) {

3874 
SLSI_WIFI_TAG_CHANNEL
:

3875 
pm_£t
.
chªÃl
 = 
g_v®ue
 / 2;

3877 
SLSI_WIFI_TAG_STATUS
:

3878 ià(!
¡©us_¡Üed
) {

3879 
¡©us_code
 = 
g_v®ue
;

3880 
¡©us_¡Üed
 = 1;

3882 
tx_£nd_¡©us
 = 
g_v®ue
;

3885 
SLSI_WIFI_TAG_ADDR
:

3886 
	`SLSI_ETHER_COPY
(
³”_mac_addr
, &
v_d©a
[
i
]);

3888 
SLSI_WIFI_TAG_VENDOR_SPECIFIC
:

3889 
v’dÜ_Ën
 = 
g_Ën
 - 2;

3890 
vg_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

3891 
vg_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

3892 
vg_id
) {

3893 
SLSI_WIFI_TAG_VD_CLUSTER_ID
:

3894 ià(
v’dÜ_Ën
 !ğ
ETH_ALEN
) {

3895 
	`mem£t
(
Çn_şu¡”_id
, 0, 
ETH_ALEN
);

3896 
	`SLSI_ERR
(
sdev
, "Clu£¸ID should boà6 by‹s,by‹ »ûived:%d\n", 
v’dÜ_Ën
);

3899 
	`memıy
(
Çn_şu¡”_id
, &
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

3901 
SLSI_WIFI_TAG_VD_NAN_ROLE
:

3902 
Çn_rŞe
 = 
vg_v®ue
;

3904 
SLSI_WIFI_TAG_VD_NAN_AMR
:

3905 ià(
v’dÜ_Ën
 != 8) {

3906 
	`SLSI_ERR
(
sdev
, "NAN AMR should boà8 by‹s,by‹ »ûived:%d\n", 
v’dÜ_Ën
);

3909 
	`¦si_cÚv”t_v_to_64b™_v®ue
(&
v_d©a
[
i
 + 2], 
v’dÜ_Ën
, &
Çn_amr_low”
, &
Çn_amr_high”
);

3911 
SLSI_WIFI_TAG_VD_NAN_NMI
:

3912 ià(
v’dÜ_Ën
 !ğ
ETH_ALEN
) {

3913 
	`mem£t
(
Çn_nmi
, 0, 
ETH_ALEN
);

3914 
	`SLSI_ERR
(
sdev
, "NAN NMI should boà6 by‹s,by‹ »ûived:%d\n", 
v’dÜ_Ën
);

3917 
	`memıy
(
Çn_nmi
, &
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

3919 
SLSI_WIFI_TAG_VD_NAN_HOP_COUNT
:

3920 
hİ_couÁ
 = 
vg_v®ue
;

3922 
SLSI_WIFI_TAG_VD_MASTER_TSF
:

3923 
pm_£t
.
ma¡”_tsf
 = 
vg_v®ue
;

3925 
SLSI_WIFI_TAG_VD_CHANNEL_INFO
:

3926 ià(
v’dÜ_Ën
 < 2) {

3927 
	`SLSI_ERR
(
sdev
, "Channel_info should be‡t†east 2 bytes!\n");

3930 
pm_£t
.
width
 = 
v_d©a
[
i
 + 2];

3931 
pm_£t
.
pos™iÚ
 = 
v_d©a
[
i
 + 3];

3933 
SLSI_WIFI_TAG_VD_SCHEDULE_TYPE
:

3934 
pm_£t
.
scheduË_ty³
 = 
vg_v®ue
;

3936 
SLSI_WIFI_TAG_VD_START_OFFSET
:

3937 
pm_£t
.
¡¬t_off£t
 = 
vg_v®ue
;

3939 
SLSI_WIFI_TAG_VD_SLOT_DURATION
:

3940 
pm_£t
.
¦Ù_du¿tiÚ
 = 
vg_v®ue
;

3942 
SLSI_WIFI_TAG_VD_BITMAP
:

3943 
pm_£t
.
¦Ù_b™m­
 = 
vg_v®ue
;

3945 
SLSI_WIFI_TAG_VD_NAN_NDP_ID
:

3946 
ndp_id
 = 
vg_v®ue
;

3948 
SLSI_WIFI_TAG_VD_ULW_REASON
:

3949 
ulw_»asÚ
 = 
vg_v®ue
;

3951 
SLSI_WIFI_TAG_VD_ULW_INDEX
:

3952 
ulw_šdex
 = 
vg_v®ue
;

3954 
SLSI_WIFI_TAG_VD_ULW_START_TIME
:

3955 
ulw_¡¬t
 = 
vg_v®ue
;

3957 
SLSI_WIFI_TAG_VD_ULW_PERIOD
:

3958 
ulw_³riod
 = 
vg_v®ue
;

3960 
SLSI_WIFI_TAG_VD_ULW_DURATION
:

3961 
ulw_du¿tiÚ
 = 
vg_v®ue
;

3963 
SLSI_WIFI_TAG_VD_ULW_COUNT
:

3964 
ulw_couÁ
 = 
vg_v®ue
;

3966 
SLSI_WIFI_TAG_VD_NAN_RX_TOTAL
:

3967 
rx_mpdu_tÙ®
 = 
vg_v®ue
;

3969 
SLSI_WIFI_TAG_VD_NAN_TX_TOTAL
:

3970 
tx_mpdu_tÙ®
 = 
vg_v®ue
;

3972 
SLSI_WIFI_TAG_VD_NAN_RX_AVERAGE
:

3973 ià(
v’dÜ_Ën
 > (
¦Ù_avg_rx
))

3974 
v’dÜ_Ën
 = (
¦Ù_avg_rx
);

3975 
	`memıy
(
¦Ù_avg_rx
, &
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

3977 
SLSI_WIFI_TAG_VD_NAN_TX_AVERAGE
:

3978 ià(
v’dÜ_Ën
 > (
¦Ù_avg_tx
))

3979 
v’dÜ_Ën
 = (
¦Ù_avg_tx
);

3980 
	`memıy
(
¦Ù_avg_tx
, &
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

3982 
SLSI_WIFI_TAG_VD_PARAMETER_SET
:

3983 
muÉi_·¿m
 = 
Œue
;

3984 ià(!
·¿m_£t_avaabË
) {

3985 
·¿m_£t_avaabË
 = 
Œue
;

3988 
ev’t_id
) {

3989 
FAPI_EVENT_WIFI_EVENT_NAN_AVAILABILITY_UPDATE
:

3990 ià(
	`SLSI_ETHER_EQUAL
(
Çn_nmi
, 
ndev_vif
->
Çn
.
loÿl_nmi
)) {

3991 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
,

3992 "NAN_OWN_AVAILABILITY", 
time¡amp
);

3994 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
,

3995 "NAN_PEER_AVAILABILITY", 
time¡amp
);

3998 
FAPI_EVENT_WIFI_EVENT_NAN_PEER_AVAILABILITY_UPDATE
:

3999 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
,

4000 "NAN_PEER_AVAILABILITY", 
time¡amp
);

4002 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_RX
:

4003 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
, "NDP_CFM_RX", 
time¡amp
);

4005 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_TX_STATUS
:

4006 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
, "NDP_CFM_TX", 
time¡amp
);

4013 ià(
muÉi_·¿m
)

4014 
i
 += 2;

4016 
i
 +ğ
g_Ën
;

4018 
ev’t_id
) {

4019 
FAPI_EVENT_WIFI_EVENT_FW_NAN_ROLE_TYPE
:

4020 
	`SLSI_INFO
(
sdev
, "[0x%lx] WIFI_EVENT_FW_NAN_ROLE_TYPE, Clu¡” Id:" 
MACSTR
 ", NAN Role:%s, "

4021 "AMR:0x%08x%08x, NMI:" 
MACSTR
 ", Hİ CouÁ:%d\n", 
time¡amp
,

4022 
	`MAC2STR
(
Çn_şu¡”_id
), 
	`¦si_g‘_Çn_rŞe_¡r
(
Çn_rŞe
), 
Çn_amr_high”
, 
Çn_amr_low”
,

4023 
	`MAC2STR
(
Çn_nmi
), 
hİ_couÁ
);

4024 
ndev_vif
->
Çn
.
amr_low”
 = 
Çn_amr_low”
;

4025 
ndev_vif
->
Çn
.
amr_high”
 = 
Çn_amr_high”
;

4026 
ndev_vif
->
Çn
.
hİcouÁ
 = 
hİ_couÁ
;

4027 
ndev_vif
->
Çn
.
rŞe
 = 
Çn_rŞe
;

4029 
FAPI_EVENT_WIFI_EVENT_NAN_AVAILABILITY_UPDATE
:

4030 ià(
	`SLSI_ETHER_EQUAL
(
Çn_nmi
, 
ndev_vif
->
Çn
.
loÿl_nmi
)) {

4031 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
, "NAN_OWN_AVAILABILITY", 
time¡amp
);

4033 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
, "NAN_PEER_AVAILABILITY", 
time¡amp
);

4036 
FAPI_EVENT_WIFI_EVENT_NAN_PEER_AVAILABILITY_UPDATE
:

4037 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
, "NAN_PEER_AVAILABILITY", 
time¡amp
);

4039 
FAPI_EVENT_WIFI_EVENT_NAN_ULW_UPDATE
:

4040 
	`SLSI_INFO
(
sdev
, "[0x%lx] NAN_ULW_UPDATE, Master_TSF: %x, ULW_Reason:%s, ULW_Index: %d,"

4042 
time¡amp
, 
pm_£t
.
ma¡”_tsf
, 
	`¦si_g‘_Çn_ulw_»asÚ_¡r
(
ulw_»asÚ
), 
ulw_šdex
,

4043 
ulw_¡¬t
, 
ulw_³riod
, 
ulw_du¿tiÚ
, 
ulw_couÁ
, 
pm_£t
.
chªÃl
);

4045 
FAPI_EVENT_WIFI_EVENT_NAN_TRAFFIC_UPDATE
:

4046 
	`SLSI_INFO
(
sdev
, "[0x%lx] NAN_TRAFFIC_UPDATE, Rx MPDUsotal: %d, Tx MPDUs Total: %d, "

4047 "SlÙ Av”agRx: "
SLSI_32BYTES_ARRAY_PATTERN
" Slot Average Tx: "

4048 
SLSI_32BYTES_ARRAY_PATTERN
"\n", 
time¡amp
, 
rx_mpdu_tÙ®
, 
tx_mpdu_tÙ®
,

4049 
	`SLSI_32BYTES_ARRAY_LIST
(
¦Ù_avg_rx
), SLSI_32BYTES_ARRAY_LIST(
¦Ù_avg_tx
));

4051 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_REQUEST_RX
:

4052 
	`SLSI_INFO
(
sdev
, "[0x%lx] NDP_RXy³:NDP_REQ NDP_ID:%d…“r_mac_addr=" 
MACSTR
 ", stus:%d\n", 
time¡amp
,

4053 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
);

4055 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_RESPONSE_RX
:

4056 
	`SLSI_INFO
(
sdev
, "[0x%lx] NDP_RXy³:NDP_RSP NDP_ID:%d…“r_mac_addr=" 
MACSTR
 " stus:%d\n", 
time¡amp
,

4057 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
);

4059 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_RX
:

4060 ià(
pm_£t
.
¦Ù_b™m­
)

4061 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
, "NDP_CFM_RX", 
time¡amp
);

4062 
	`SLSI_INFO
(
sdev
, "[0x%lx] NDP_RXy³:NDP_CONFIRM NDP_ID:%d…“r_mac_addr=" 
MACSTR
 " status:%d\n",

4063 
time¡amp
, 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
);

4065 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_INSTALL_RX
:

4066 
	`SLSI_INFO
(
sdev
, "[0x%lx] NDP_RXy³:NDP_INSTALL NDP_ID:%d…“r_mac_addr=" 
MACSTR
 " status:%d\n",

4067 
time¡amp
, 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
);

4069 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_REQUEST_TX_STATUS
:

4070 
	`SLSI_INFO
(
sdev
, "[0x%lx] NDP_TXy³:NDP_REQ NDP_ID:%d…“r_mac_addr=" 
MACSTR
 " status:%dx_status:%d\n",

4071 
time¡amp
, 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
, 
tx_£nd_¡©us
);

4073 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_RESPONSE_TX_STATUS
:

4074 
	`SLSI_INFO
(
sdev
, "[0x%lx]NDP_TXy³:NDP_RSP NDP_ID:%d…“r_mac_addr=" 
MACSTR
 " status:%dx_status:%d\n",

4075 
time¡amp
, 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
, 
tx_£nd_¡©us
);

4077 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_TX_STATUS
:

4078 ià(
pm_£t
.
¦Ù_b™m­
)

4079 
	`¦si_´št_avaab™y_log_šd
(
sdev
, &
pm_£t
, "NDP_CFM_TX", 
time¡amp
);

4080 
	`SLSI_INFO
(
sdev
, "[0x%lx] NDP_TXy³:NDP_CONFIRM NDP_ID:%d…“r_mac_addr=" 
MACSTR
 " status:%dx_status:%d\n",

4081 
time¡amp
, 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
, 
tx_£nd_¡©us
);

4083 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_INSTALL_TX_STATUS
:

4084 
	`SLSI_INFO
(
sdev
, "[0x%lx] NDP_TXy³:NDP_INSTALL NDP_ID:%d…“r_mac_addr=" 
MACSTR
 " status:%dx_status:%d\n",

4085 
time¡amp
, 
ndp_id
, 
	`MAC2STR
(
³”_mac_addr
), 
¡©us_code
, 
tx_£nd_¡©us
);

4088 
	}
}

4091 
	$dump_rßm_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

4092 
boŞ
 *
cu¼
, *
bssid
, 
äeq
,

4093 
rssi
, 
cu
,

4094 
scÜe
, 
_scÜe
, 
boŞ
 
–igibË_v®ue
)

4096 
	`¦si_cÚn_log2us_rßm_sÿn_»suÉ
(
sdev
, 
dev
, *
cu¼
, 
bssid
,

4097 
äeq
, 
rssi
,

4098 
cu
, 
scÜe
,

4099 
_scÜe
, 
–igibË_v®ue
);

4100 ià(*
cu¼
) {

4101 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_RESULT, Cu¼’ˆAP, BSSID:" 
MACSTR


4103 
	`MAC2STR
(
bssid
), 
rssi
, 
cu
, 
scÜe
 / 100, scÜ% 100, 
_scÜe
);

4104 *
cu¼
 = 
çl£
;

4106 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_RESULT, Cªdid©AP, BSSID:" 
MACSTR


4108 
	`MAC2STR
(
bssid
), 
rssi
, 
cu
, 
scÜe
 / 100, scÜ% 100, 
_scÜe
,

4109 
–igibË_v®ue
 ? "true" : "false");

4111 
	}
}

4113 
	$¦si_rx_ev’t_log_šdiÿtiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4115 
u16
 
ev’t_id
 = 0;

4116 
u64
 
time¡amp
 = 0;

4117 
u8
 *
v_d©a
;

4118 
u8
 
fuÎ_sÿn_couÁ
 = 0;

4119 
u32
 
rßm_»asÚ
 = 0, 
_scÜe_v®
 = 0;

4120 
u32
 
btm_»que¡_mode
 = 0, 
btm_»¥Ú£
 = 0, 
—pŞ_msg_ty³
 = 0;

4121 
u32
 
»asÚ_code
 = 0, 
—pŞ_»Œy_couÁ
 = 0, 
¡©us_code
 = 0, 
tx_¡©us
 = 0;

4122 
u16
 
v’dÜ_Ën
, 
g_id
, 
g_Ën
, 
vg_id
, 
—pŞ_key_ty³
 = 0, 
cu_th»sh
 = 0;

4123 
u32
 
g_v®ue
, 
vg_v®ue
, 
chª_äequ’cy
 = 0, 
sÿn_ty³
 = 0, 
rßmšg_ty³
 = 0;

4124 
scÜe_v®
 = 0, 
rssi_th»sh
 = 0, 
cu_rssi_th»sh
 = 0;

4125 
u32
 
İ”©šg_şass
 = 0, 
m—su»_mode
 = 0, 
m—su»_du¿tiÚ
 = 0, 
­_couÁ
 = 0, 
ÿndid©e_couÁ
 = 0;

4126 
u32
 
mes§ge_ty³
 = 0, 
expœed_tim”_v®ue
 = 0;

4127 
rßm_rssi_v®
 = 0, 
chª_uti§tiÚ
 = 0;

4128 
u8
 
mac_addr
[6] = {0};

4129 
v_bufãr__Ën
 = 
	`çpi_g‘_d©®’
(
skb
), 
i
 = 0, 
chªÃl_v®
 = 0, 
™”
 = 0, 
chªÃl_couÁ
 = 0, 
lim
 = 0;

4130 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

4131 
ssid
[
MAX_SSID_LEN
];

4132 *
¡ršg
 = 
NULL
;

4133 
boŞ
 
muÉi_·¿m
 = 
çl£
, 
cu¼’t_šfo
 = 
Œue
, 
v®id_d©a
 = f®£, 
–igibË_v®ue
 = false;

4134 
u32
 
auth_®go_ty³
 = 0, 
§e_ty³
 = 0, 
¢
 = 0;

4135 
äeq_li¡
[
MAX_FREQUENCY_COUNT
] = {0};

4136 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4137 
dŸlog_tok’
 = 0, 
di§ssoc_tim”
 = 0, 
v®id™y_time
 = 0, 
btm_ÿnd_´eã»nû
 = 0, 
is_rßmšg
 = 0;

4138 
btm_ÿnd_couÁ
 = 0, 
btm_v®id™y_š‹rv®
 = 0, 
btm_di§ssoc_tim”
 = 0, 
mgmt_äame_subty³
 = 0;

4140 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4141 
ev’t_id
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_ev’t_log_šd
.
ev’t
);

4142 
time¡amp
 = 
	`çpi_g‘_u64
(
skb
, 
u
.
mlme_ev’t_log_šd
.
fw_tsf
);

4143 
v_d©a
 = 
	`çpi_g‘_d©a
(
skb
);

4145 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

4146 "¦si_rx_ev’t_log_šdiÿtiÚ,ƒv’ˆid = %d,†’ = %d\n", 
ev’t_id
, 
v_bufãr__Ën
);

4148 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

4149 
	`SCSC_WLOG_FW_EVENT
(
WLOG_NORMAL
, 
ev’t_id
, 
time¡amp
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb));

4151 
ev’t_id
) {

4152 
FAPI_EVENT_WIFI_EVENT_FW_NAN_ROLE_TYPE
:

4153 
FAPI_EVENT_WIFI_EVENT_NAN_AVAILABILITY_UPDATE
:

4154 
FAPI_EVENT_WIFI_EVENT_NAN_ULW_UPDATE
:

4155 
FAPI_EVENT_WIFI_EVENT_NAN_TRAFFIC_UPDATE
:

4156 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_REQUEST_RX
:

4157 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_RESPONSE_RX
:

4158 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_RX
:

4159 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_INSTALL_RX
:

4160 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_REQUEST_TX_STATUS
:

4161 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_RESPONSE_TX_STATUS
:

4162 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_TX_STATUS
:

4163 
FAPI_EVENT_WIFI_EVENT_NAN_NDP_INSTALL_TX_STATUS
:

4164 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


4165 
	`¦si_hªdË_Çn_rx_ev’t_log_šd
(
sdev
, 
dev
, 
skb
);

4167 
	`SLSI_ERR
(
sdev
, "NAN i nÙƒÇbËd buˆNANƒv’t:0x%x„eûived\n", 
ev’t_id
);

4169 
ex™
;

4171 
i
 + 4 < 
v_bufãr__Ën
) {

4172 
g_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

4173 
g_Ën
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
 + 2]));

4174 
i
 += 4;

4175 ià(
i
 + 
g_Ën
 > 
v_bufãr__Ën
) {

4176 
	`SLSI_INFO
(
sdev
, "Incorrect fapi bulk data\n");

4177 
	`kä“_skb
(
skb
);

4178 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4181 
g_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
], 
g_Ën
);

4182 
muÉi_·¿m
 = 
çl£
;

4183 
g_id
) {

4184 
SLSI_WIFI_TAG_RSSI
:

4185 
rßm_rssi_v®
 = ()
g_v®ue
;

4187 
SLSI_WIFI_TAG_REASON_CODE
:

4188 
»asÚ_code
 = 
g_v®ue
;

4190 
SLSI_WIFI_TAG_VENDOR_SPECIFIC
:

4191 
v’dÜ_Ën
 = 
g_Ën
 - 2;

4192 
vg_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

4193 
vg_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

4194 
vg_id
) {

4195 
SLSI_WIFI_TAG_VD_CHANNEL_UTILISATION
:

4196 
chª_uti§tiÚ
 = ()
vg_v®ue
;

4198 
SLSI_WIFI_TAG_VD_ROAMING_REASON
:

4199 
rßm_»asÚ
 = 
vg_v®ue
;

4201 
SLSI_WIFI_TAG_VD_BTM_REQUEST_MODE
:

4202 
btm_»que¡_mode
 = 
vg_v®ue
;

4204 
SLSI_WIFI_TAG_VD_BTM_RESPONSE_STATUS
:

4205 
btm_»¥Ú£
 = 
vg_v®ue
;

4207 
SLSI_WIFI_TAG_VD_RETRY_COUNT
:

4208 
—pŞ_»Œy_couÁ
 = 
vg_v®ue
;

4210 
SLSI_WIFI_TAG_VD_EAPOL_KEY_TYPE
:

4211 
—pŞ_key_ty³
 = 
vg_v®ue
;

4213 
SLSI_WIFI_TAG_VD_SCAN_TYPE
:

4214 
sÿn_ty³
 = 
vg_v®ue
;

4216 
SLSI_WIFI_TAG_VD_SCORE
:

4217 
scÜe_v®
 = ()
vg_v®ue
;

4219 
SLSI_WIFI_TAG_VD_RSSI_THRESHOLD
:

4220 
rssi_th»sh
 = ()
vg_v®ue
;

4222 
SLSI_WIFI_TAG_VD_OPERATING_CLASS
:

4223 
İ”©šg_şass
 = 
vg_v®ue
;

4225 
SLSI_WIFI_TAG_VD_MEASUREMENT_MODE
:

4226 
m—su»_mode
 = 
vg_v®ue
;

4228 
SLSI_WIFI_TAG_VD_MEASUREMENT_DURATION
:

4229 
m—su»_du¿tiÚ
 = 
vg_v®ue
;

4231 
SLSI_WIFI_TAG_VD_MIN_AP_COUNT
:

4232 
­_couÁ
 = 
vg_v®ue
;

4234 
SLSI_WIFI_TAG_VD_CANDIDATE_LIST_COUNT
:

4235 
ÿndid©e_couÁ
 = 
vg_v®ue
;

4237 
SLSI_WIFI_TAG_VD_MESSAGE_TYPE
:

4238 
mes§ge_ty³
 = 
vg_v®ue
;

4240 
SLSI_WIFI_TAG_VD_EXPIRED_TIMER_VALUE
:

4241 
expœed_tim”_v®ue
 = 
vg_v®ue
;

4243 
SLSI_WIFI_TAG_VD_ESTIMATED_TP
:

4244 
_scÜe_v®
 = 
vg_v®ue
;

4246 
WIFI_TAG_VD_MGMT_FRAME_SUBTYPE
:

4247 
mgmt_äame_subty³
 = 
vg_v®ue
;

4249 
SLSI_WIFI_TAG_VD_IS_ROAMING
:

4250 
is_rßmšg
 = 
vg_v®ue
;

4252 
SLSI_WIFI_TAG_VD_ELIGIBLE
:

4253 
–igibË_v®ue
 = 
vg_v®ue
;

4255 
SLSI_WIFI_TAG_VD_PARAMETER_SET
:

4256 
muÉi_·¿m
 = 
Œue
;

4257 ià(!
v®id_d©a
) {

4258 
v®id_d©a
 = 
Œue
;

4261 ià(
ev’t_id
 =ğ
FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_RESULT
) {

4262 ià(!
v®id_d©a
) {

4263 
v®id_d©a
 = 
Œue
;

4266 
	`dump_rßm_sÿn_»suÉ
(
sdev
, 
dev
, &
cu¼’t_šfo
, 
mac_addr
,

4267 
chª_äequ’cy
, 
rßm_rssi_v®
,

4268 
chª_uti§tiÚ
, 
scÜe_v®
,

4269 
_scÜe_v®
, 
–igibË_v®ue
);

4270 
	`mem£t
(
mac_addr
, 0, 
ETH_ALEN
);

4271 
chª_äequ’cy
 = 0;

4272 
rßm_rssi_v®
 = 0;

4273 
chª_uti§tiÚ
 = 0;

4274 
scÜe_v®
 = 0;

4275 
_scÜe_v®
 = 0;

4276 
–igibË_v®ue
 = 
çl£
;

4279 
SLSI_WIFI_TAG_VD_FULL_SCAN_COUNT
:

4280 
fuÎ_sÿn_couÁ
 = 
vg_v®ue
;

4282 
SLSI_WIFI_TAG_VD_CU_RSSI_THRESHOLD
:

4283 
cu_rssi_th»sh
 = ()
vg_v®ue
;

4285 
SLSI_WIFI_TAG_VD_CU_THRESHOLD
:

4286 
cu_th»sh
 = 
vg_v®ue
;

4288 
SLSI_WIFI_TAG_VD_ROAMING_TYPE
:

4289 
rßmšg_ty³
 = 
vg_v®ue
;

4291 
SLSI_WIFI_TAG_VD_AUTH_ALGO
:

4292 
auth_®go_ty³
 = 
vg_v®ue
;

4294 
SLSI_WIFI_TAG_VD_SAE_MESSAGE_TYPE
:

4295 
§e_ty³
 = 
vg_v®ue
;

4297 
SLSI_WIFI_TAG_VD_SEQUENCE_NUMBER
:

4298 
¢
 = 
vg_v®ue
;

4300 
SLSI_WIFI_TAG_VD_DIALOG_TOKEN
:

4301 
dŸlog_tok’
 = 
vg_v®ue
;

4303 
SLSI_WIFI_TAG_VD_DIASSOCIATION_TIMER
:

4304 
di§ssoc_tim”
 = 
vg_v®ue
;

4306 
SLSI_WIFI_TAG_VD_VALIDITY_INTERVAL
:

4307 
v®id™y_time
 = 
vg_v®ue
;

4309 
SLSI_WIFI_TAG_VD_BTM_CANDIDATE_PREFERENCE
:

4310 
btm_ÿnd_´eã»nû
 = 
vg_v®ue
;

4312 
SLSI_WIFI_TAG_VD_BTM_CANDIDATE_COUNT
:

4313 
btm_ÿnd_couÁ
 = 
vg_v®ue
;

4315 
SLSI_WIFI_TAG_VD_LOCAL_DURATION
:

4316 ià(
btm_di§ssoc_tim”
)

4317 
btm_v®id™y_š‹rv®
 = 
vg_v®ue
;

4319 
btm_di§ssoc_tim”
 = 
vg_v®ue
;

4323 
SLSI_WIFI_TAG_EAPOL_MESSAGE_TYPE
:

4324 
—pŞ_msg_ty³
 = 
g_v®ue
;

4326 
SLSI_WIFI_TAG_STATUS
:

4327 ià(
¡©us_code
)

4328 
tx_¡©us
 = 
g_v®ue
;

4330 
¡©us_code
 = 
g_v®ue
;

4332 
SLSI_WIFI_TAG_BSSID
:

4333 
	`SLSI_ETHER_COPY
(
mac_addr
, &
v_d©a
[
i
]);

4335 
SLSI_WIFI_TAG_CHANNEL
:

4336 
chª_äequ’cy
 = 
g_v®ue
;

4338 
SLSI_WIFI_TAG_IE
:

4339 
™”
 = 
i
;

4340 
lim
 = 
™”
 + 
v_d©a
[iter + 1] + 2;

4341 
™”
 += 7;

4342 
™”
 < 
lim
 &&†im <ğ
i
 + 
g_Ën
) {

4343 ià(
chªÃl_couÁ
 >ğ
MAX_CHANNEL_COUNT
) {

4344 
	`SLSI_ERR
(
sdev
, "ERR: ChªÃÈli¡„eûived >ğ%d\n", 
MAX_CHANNEL_COUNT
);

4347 
chªÃl_v®
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
™”
]));

4348 
äeq_li¡
[
chªÃl_couÁ
] = 
chªÃl_v®
 / 2;

4349 
chªÃl_li¡
[
chªÃl_couÁ
] = 
	`›“80211_äequ’cy_to_chªÃl
(
chªÃl_v®
 / 2);

4350 ià(
chªÃl_li¡
[
chªÃl_couÁ
] < 1 || channel_list[channel_count] > 196) {

4351 
	`SLSI_ERR
(
sdev
, "ERR: Inv®id chªÃÈ»ûived %d\n", 
chªÃl_li¡
[
chªÃl_couÁ
]);

4353 
	`SCSC_BIN_TAG_INFO
(
BINARY
, &
v_d©a
[
i
],lv_data[i + 1] + 2);

4356 
™”
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

4357 
chªÃl_couÁ
 += 1;

4360 
SLSI_WIFI_TAG_SSID
:

4361 
	`mem£t
(
ssid
, '\0', (ssid));

4362 ià(
g_Ën
 > 
MAX_SSID_LEN
)

4363 
	`memıy
(
ssid
, &
v_d©a
[
i
], 
MAX_SSID_LEN
);

4365 
	`memıy
(
ssid
, &
v_d©a
[
i
], 
g_Ën
);

4368 ià(
muÉi_·¿m
)

4369 
i
 += 2;

4371 
i
 +ğ
g_Ën
;

4373 
ev’t_id
) {

4374 
FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START
:

4375 ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_GTK
) {

4376 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)

4377 
sdev
->
cÚn_log2us_ùx
.
is_—pŞ_gtk
 = 
Œue
;

4378 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START, S’d GTK, G%d\n", 
—pŞ_msg_ty³
);

4379 } ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_PTK
) {

4380 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
) {

4381 
sdev
->
cÚn_log2us_ùx
.
is_—pŞ_±k
 = 
Œue
;

4382 
sdev
->
cÚn_log2us_ùx
.
—pŞ_±k_msg_ty³
 = 
—pŞ_msg_ty³
;

4384 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START, Send 4way-H/S, M%d\n",

4385 
—pŞ_msg_ty³
);

4388 
FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP
:

4389 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP,Result Code:%d, Retry Count:%d\n",

4390 
¡©us_code
, 
—pŞ_»Œy_couÁ
);

4391 
	`¦si_cÚn_log2us_—pŞ_tx
(
sdev
, 
dev
, 
¡©us_code
);

4393 
FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED
:

4394 ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_GTK
) {

4395 
	`¦si_cÚn_log2us_—pŞ_gtk
(
sdev
, 
dev
, 
—pŞ_msg_ty³
);

4396 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED, Reûived GTK, G%d\n", 
—pŞ_msg_ty³
);

4397 } ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_PTK
) {

4398 
	`¦si_cÚn_log2us_—pŞ_±k
(
sdev
, 
dev
, 
—pŞ_msg_ty³
);

4399 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED, Reûived 4way-H/S, M%d\n", 
—pŞ_msg_ty³
);

4402 
FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_REQUEST
:

4403 
	`SLSI_INFO
(
sdev
,

4405 
btm_»que¡_mode
, 
btm_di§ssoc_tim”
, 
btm_v®id™y_š‹rv®
, 
btm_ÿnd_couÁ
);

4406 
	`¦si_cÚn_log2us_btm_»q
(
sdev
, 
dev
, 
dŸlog_tok’
, 
btm_»que¡_mode
, 
btm_di§ssoc_tim”
,

4407 
btm_v®id™y_š‹rv®
, 
btm_ÿnd_couÁ
);

4409 
FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_RESPONSE
:

4410 ià(
btm_»¥Ú£
 == 0)

4411 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BTM_FRAME_RESPONSE,Stu code:%d, BSSID:"
MACSTR
"\n",

4412 
btm_»¥Ú£
, 
	`MAC2STR
(
mac_addr
));

4414 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BTM_FRAME_RESPONSE,Stu code:%d\n", 
btm_»¥Ú£
);

4415 
	`¦si_cÚn_log2us_btm_»¥
(
sdev
, 
dev
, 
dŸlog_tok’
, 
btm_»¥Ú£
, 
btm_di§ssoc_tim”
,

4416 
mac_addr
);

4418 
FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_QUERY
:

4419 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BTM_FRAME_QUERY, dialog_token:%d,„eason:%d\n",

4420 
dŸlog_tok’
, 
»asÚ_code
);

4421 
	`¦si_cÚn_log2us_btm_qu”y
(
sdev
, 
dev
, 
dŸlog_tok’
, 
»asÚ_code
);

4423 
FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STARTED
:

4424 
	`¦si_cÚn_log2us_rßm_sÿn_¡¬t
(
sdev
, 
dev
, 
rßm_»asÚ
, 
rßm_rssi_v®
, 
chª_uti§tiÚ
,

4425 
rssi_th»sh
, 
time¡amp
);

4426 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SEARCH_STARTED, Roaming Type : %s, RSSI:%d, Deauth Reason:0x%04x, "

4428 (
rßmšg_ty³
 =ğ0 ? "Legacy" : "NCHO"), 
rßm_rssi_v®
, 
»asÚ_code
, 
rssi_th»sh
, 
chª_uti§tiÚ
,

4429 
	`¦si_g‘_rßm_»asÚ_¡r
(
rßm_»asÚ
), 
expœed_tim”_v®ue
);

4431 
FAPI_EVENT_WIFI_EVENT_FW_AUTH_SENT
:

4432 ià(
is_rßmšg
)

4433 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_AUTH_STARTED iÀRßmšg, BSSID:" 
MACSTR
 "\n", 
	`MAC2STR
(
mac_addr
));

4435 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_AUTH_STARTED, BSSID:" 
MACSTR
 "\n", 
	`MAC2STR
(
mac_addr
));

4436 
	`¦si_cÚn_log2us_auth_»q
(
sdev
, 
dev
, 
mac_addr
, 
auth_®go_ty³
, 
§e_ty³
, 
¢
,

4437 
¡©us_code
, 
tx_¡©us
, 
is_rßmšg
);

4439 
FAPI_EVENT_WIFI_EVENT_AUTH_RECEIVED
:

4440 ià(
is_rßmšg
)

4441 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_AUTH_COMPLETE iÀRßmšg,Stu code:%d\n", 
¡©us_code
);

4443 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_AUTH_COMPLETE,Stu code:%d\n", 
¡©us_code
);

4444 
	`¦si_cÚn_log2us_auth_»¥
(
sdev
, 
dev
, 
mac_addr
, 
auth_®go_ty³
, 
§e_ty³
, 
¢
, 
¡©us_code
, 
is_rßmšg
);

4446 
FAPI_EVENT_WIFI_EVENT_FW_ASSOC_STARTED
:

4447 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_ASSOC_REQ
)

4448 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_ASSOC_STARTED, stu code: %d\n", 
¡©us_code
);

4449 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_REASSOC_REQ
)

4450 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_REASSOC_STARTED, stu code: %d\n", 
¡©us_code
);

4451 
	`¦si_cÚn_log2us_assoc_»q
(
sdev
, 
dev
, 
mac_addr
, 
¢
, 
¡©us_code
, 
mgmt_äame_subty³
);

4453 
FAPI_EVENT_WIFI_EVENT_ASSOC_COMPLETE
:

4454 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_ASSOC_RESP
)

4455 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ASSOC_COMPLETE,„—sÚ code: %d\n", 
»asÚ_code
);

4456 ià(
mgmt_äame_subty³
 =ğ
SLSI_MGMT_FRAME_SUBTYPE_REASSOC_RESP
)

4457 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_REASSOC_COMPLETE,„—sÚ code: %d\n", 
»asÚ_code
);

4458 
	`¦si_cÚn_log2us_assoc_»¥
(
sdev
, 
dev
, 
mac_addr
, 
¢
, 
»asÚ_code
, 
mgmt_äame_subty³
);

4460 
FAPI_EVENT_WIFI_EVENT_FW_DEAUTHENTICATION_RECEIVED
:

4461 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_DEAUTHENTICATION_RECEIVED,„—sÚ code: %d\n", 
»asÚ_code
);

4462 
	`¦si_cÚn_log2us_d—uth
(
sdev
, 
dev
, "RX", 
ndev_vif
->
¡a
.
bssid
, 
¢
, 
»asÚ_code
);

4464 
FAPI_EVENT_WIFI_EVENT_FW_DEAUTHENTICATION_SENT
:

4465 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_DEAUTHENTICATION_SENT,„—sÚ code: %d\n", 
»asÚ_code
);

4466 
	`¦si_cÚn_log2us_d—uth
(
sdev
, 
dev
, "TX", 
ndev_vif
->
¡a
.
bssid
, 
¢
, 
»asÚ_code
);

4468 
FAPI_EVENT_WIFI_EVENT_DISASSOCIATION_REQUESTED
:

4469 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_DISASSOCIATION_REQUESTED,„—sÚ code: %d\n", 
»asÚ_code
);

4470 
	`¦si_cÚn_log2us_di§ssoc
(
sdev
, 
dev
, "TX", 
ndev_vif
->
¡a
.
bssid
, 
¢
, 
»asÚ_code
);

4472 
FAPI_EVENT_WIFI_EVENT_FW_DISASSOCIATION_RECEIVED
:

4473 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_DISASSOCIATION_RECEIVED,„—sÚ code: %d\n", 
»asÚ_code
);

4474 
	`¦si_cÚn_log2us_di§ssoc
(
sdev
, 
dev
, "RX", 
ndev_vif
->
¡a
.
bssid
, 
¢
, 
»asÚ_code
);

4476 
FAPI_EVENT_WIFI_EVENT_ROAM_ASSOC_COMPLETE
:

4477 
	`SLSI_INFO
(
sdev
, "Received Association Response\n");

4479 
FAPI_EVENT_WIFI_EVENT_FW_NR_FRAME_REQUEST
:

4480 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_NR_FRAME_REQUEST Send Radio Measurement Frame"

4482 
	`¦si_cÚn_log2us_Ä_äame_»q
(
sdev
, 
dev
);

4484 
WIFI_EVENT_FW_RM_FRAME_RESPONSE
:

4485 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_RM_FRAME_RESPONSE Received Radio Measurement "

4488 
FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_SENT
:

4489 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_AUTH_SENT, BSSID:" 
MACSTR
 ", F»qu’cy:%d\n", 
	`MAC2STR
(
mac_addr
), 
chª_äequ’cy
 / 2);

4491 
FAPI_EVENT_WIFI_EVENT_FW_NR_FRAME_RESPONSE
:

4492 
¡ršg
 = 
	`¦si_´št_chªÃl_li¡
(
chªÃl_li¡
, 
chªÃl_couÁ
);

4493 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_NR_FRAME_RESPONSE, ChªÃÈLi¡:%s\n", (!
¡ršg
 ? "-1" : string));

4494 
	`¦si_cÚn_log2us_Ä_äame_»¥
(
sdev
, 
dev
, (!
¡ršg
 ? "-1" : string));

4495 
	`kä“
(
¡ršg
);

4497 
FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_RECEIVED
:

4498 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_AUTH_RECEIVED, BSSID:" 
MACSTR
 ", ResuÉ:%d\n", 
	`MAC2STR
(
mac_addr
), 
¡©us_code
);

4500 
FAPI_EVENT_WIFI_EVENT_AUTH_TIMEOUT
:

4501 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_AUTH_TIMEOUT, BSSID:" 
MACSTR
 ", ResuÉ:%d\n", 
	`MAC2STR
(
mac_addr
), 
¡©us_code
);

4503 
FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_TIMEOUT
:

4504 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_AUTH_TIMEOUT, BSSID:" 
MACSTR
 ", Result:%d\n",

4505 
	`MAC2STR
(
mac_addr
), 
¡©us_code
);

4507 
FAPI_EVENT_WIFI_EVENT_FW_CONNECTION_ATTEMPT_ABORTED
:

4508 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_CONNECTION_ATTEMPT_ABORTED, BSSID:" 
MACSTR
 ", ResuÉ:%d\n", 
	`MAC2STR
(
mac_addr
), 
»asÚ_code
);

4510 
FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_STARTED
:

4511 
¡ršg
 = 
	`¦si_´št_chªÃl_li¡
(
chªÃl_li¡
, 
chªÃl_couÁ
);

4512 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_STARTED, SSID:%s, Scan Type:%s, Channel List:%s\n",

4513 
ssid
, 
	`¦si_g‘_sÿn_ty³
(
sÿn_ty³
), (!
¡ršg
 ? "-1" : string));

4514 
	`kä“
(
¡ršg
);

4515 
	`¦si_cÚn_log2us_rßm_sÿn_§ve
(
sdev
, 
dev
, 
sÿn_ty³
,

4516 
chªÃl_couÁ
, 
äeq_li¡
);

4518 
FAPI_EVENT_WIFI_EVENT_ROAM_RSSI_THRESHOLD
:

4519 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_RSSI_THRESHOLD, Full scan count:%d, RSSI Threshold:%d, "

4520 "CU RSSI Th»shŞd:%d, CU Th»shŞd:%d\n", 
fuÎ_sÿn_couÁ
, 
rssi_th»sh
, 
cu_rssi_th»sh
, 
cu_th»sh
);

4522 
FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_COMPLETE
:

4523 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_COMPLETE, SÿÀTy³:%s\n", 
	`¦si_g‘_sÿn_ty³
(
sÿn_ty³
));

4524 
	`¦si_cÚn_log2us_rßm_sÿn_dÚe
(
sdev
, 
dev
, 
time¡amp
);

4525 ià(
	`is_z”o_‘h”_addr
(
mac_addr
)) {

4526 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_COMPLETE, [ROAM] RESULT NO_ROAM BSSID:" 
MACSTR
 ", \
:1\n", 
	`MAC2STR
(
ndev_vif
->
¡a
.
bssid
));

4528 
	`¦si_cÚn_log2us_rßm_»suÉ
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
bssid
, 
time¡amp
, 
çl£
);

4531 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_COMPLETE, [ROAM] RESULT ROAM BSSID:" 
MACSTR
 ", \
:0\n", 
	`MAC2STR
(
mac_addr
));

4533 
	`¦si_cÚn_log2us_rßm_»suÉ
(
sdev
, 
dev
, 
mac_addr
, 
time¡amp
, 
Œue
);

4536 
FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_RESULT
:

4537 
	`dump_rßm_sÿn_»suÉ
(
sdev
, 
dev
, &
cu¼’t_šfo
, 
mac_addr
,

4538 
chª_äequ’cy
, 
rßm_rssi_v®
, 
chª_uti§tiÚ
,

4539 
scÜe_v®
, 
_scÜe_v®
, 
–igibË_v®ue
);

4541 
FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STOPPED
:

4542 
	`SLSI_INFO
(
sdev
, "FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STOPPED, R—sÚ:%d\n", 
»asÚ_code
);

4544 
FAPI_EVENT_WIFI_EVENT_FW_BEACON_REPORT_REQUEST
:

4545 
¡ršg
 = 
	`¦si_´št_chªÃl_li¡
(
chªÃl_li¡
, 
chªÃl_couÁ
);

4546 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BEACON_REPORT_REQUEST, Token:%d,Operating Class:%d,channel†ist:%s,"

4547 "M—su»m’ˆDu¿tiÚ:%d,M—su»m’ˆMode:%s,BSSID:"
MACSTR
",SSID:%s\n", 
dŸlog_tok’
,

4548 
İ”©šg_şass
, (!
¡ršg
 ? "-1" : sŒšg), 
m—su»_du¿tiÚ
,

4549 
	`¦si_g‘_m—su»_mode
(
m—su»_mode
), 
	`MAC2STR
(
mac_addr
), 
ssid
);

4550 
	`¦si_cÚn_log2us_b—cÚ_»pÜt_»que¡
(
sdev
, 
dev
, 
dŸlog_tok’
, 
İ”©šg_şass
,

4551 (!
¡ršg
 ? "-1" : string),

4552 
m—su»_du¿tiÚ
, 
	`¦si_g‘_m—su»_mode
(
m—su»_mode
),

4553 
mac_addr
, 
ssid
);

4554 
	`kä“
(
¡ršg
);

4556 
WIFI_EVENT_FW_BEACON_REPORT_RESPONSE
:

4557 ià(
»asÚ_code
) {

4558 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BEACON_REPORT_RESPONSE, Token:%d, Scanned AP Number:%d, "

4559 "R—sÚ:%d\n", 
dŸlog_tok’
, 
­_couÁ
, 
»asÚ_code
);

4561 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BEACON_REPORT_RESPONSE, Token:%d, Scanned AP Number:%d\n",

4562 
dŸlog_tok’
, 
­_couÁ
);

4564 
	`¦si_cÚn_log2us_b—cÚ_»pÜt_»¥Ú£
(
sdev
, 
dev
, 
dŸlog_tok’
, 
­_couÁ
, 
»asÚ_code
);

4566 
FAPI_EVENT_WIFI_EVENT_FW_FTM_RANGE_REQUEST
:

4567 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_FTM_RANGE_REQUEST, Min Ap Count:%d, Candidate List Count:%d\n",

4568 
­_couÁ
, 
ÿndid©e_couÁ
);

4570 
FAPI_EVENT_WIFI_EVENT_FW_FRAME_TRANSMIT_FAILURE
:

4571 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_FRAME_TRANSMIT_FAILURE, Message Type:%s, Result:%d, Retry Count:%d\n",

4572 
	`¦si_äame_Œªsm™_çu»_mes§ge_ty³
(
mes§ge_ty³
), 
¡©us_code
, 
—pŞ_»Œy_couÁ
);

4574 
WIFI_EVENT_ASSOCIATING_DEAUTH_RECEIVED
:

4575 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ASSOCIATING_DEAUTH_RECEIVED, BSSID:" 
MACSTR
 ", Reason:%d\n",

4576 
	`MAC2STR
(
mac_addr
), 
»asÚ_code
);

4578 
FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCO_START
:

4579 
sdev
->
cÚn_log2us_ùx
.
btcÛx_sco
 = 1;

4581 
FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCO_STOP
:

4582 
sdev
->
cÚn_log2us_ùx
.
btcÛx_sco
 = 0;

4584 
FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCAN_START
:

4585 
sdev
->
cÚn_log2us_ùx
.
btcÛx_sÿn
 = 1;

4587 
FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCAN_STOP
:

4588 
sdev
->
cÚn_log2us_ùx
.
btcÛx_sÿn
 = 0;

4590 
FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_HID_START
:

4591 
sdev
->
cÚn_log2us_ùx
.
btcÛx_hid
 = 1;

4593 
FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_HID_STOP
:

4594 
sdev
->
cÚn_log2us_ùx
.
btcÛx_hid
 = 0;

4596 
FAPI_EVENT_WIFI_EVENT_FW_BTM_CANDIDATE
:

4597 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BTM_CANDIDATE, BSSID:" 
MACSTR
 ", Preference:%d",

4598 
	`MAC2STR
(
mac_addr
), 
btm_ÿnd_´eã»nû
);

4599 
	`¦si_cÚn_log2us_btm_ÿnd
(
sdev
, 
dev
, 
mac_addr
, 
btm_ÿnd_´eã»nû
);

4602 
ex™
:

4603 
	`kä“_skb
(
skb
);

4604 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4605 
	}
}

4607 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


4608 
	$¦si_Ú_ršg_bufãr_d©a
(*
ršg_Çme
, *
bufãr
, 
bufãr_size
,

4609 
scsc_wifi_ršg_bufãr_¡©us
 *
bufãr_¡©us
, *
ùx
)

4611 
sk_buff
 *
skb
;

4612 
ev’t_id
 = 
SLSI_NL80211_LOGGER_RING_EVENT
;

4613 
¦si_dev
 *
sdev
 = 
ùx
;

4615 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4616 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

4617 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4619 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4621 ià(!
skb
) {

4622 
	`SLSI_ERR_NODEV
("FaedØ®loÿ‹ skb fÜ v’dÜƒv’t: %d\n", 
ev’t_id
);

4626 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_STATUS
, (*
bufãr_¡©us
), buffer_status) ||

4627 
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_DATA
, 
bufãr_size
, 
bufãr
)) {

4628 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4629 
	`kä“_skb
(
skb
);

4632 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

4633 
	}
}

4635 
	$¦si_Ú_®”t
(*
bufãr
, 
bufãr_size
, 
”r_code
, *
ùx
)

4637 
sk_buff
 *
skb
;

4638 
ev’t_id
 = 
SLSI_NL80211_LOGGER_FW_DUMP_EVENT
;

4639 
¦si_dev
 *
sdev
 = 
ùx
;

4641 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4642 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4643 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

4644 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4646 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4648 ià(!
skb
) {

4649 
	`SLSI_ERR_NODEV
("FaedØ®loÿ‹ skb fÜ v’dÜƒv’t: %d\n", 
ev’t_id
);

4650 
ex™
;

4653 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
, 
bufãr_size
) ||

4654 
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_DATA
, 
bufãr_size
, 
bufãr
)) {

4655 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4656 
	`kä“_skb
(
skb
);

4657 
ex™
;

4659 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

4660 
ex™
:

4661 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4662 
	}
}

4664 
	$¦si_Ú_fœmw¬e_memÜy_dump
(*
bufãr
, 
bufãr_size
, *
ùx
)

4666 
	`SLSI_ERR_NODEV
("slsi_on_firmware_memory_dump\n");

4667 
	`kä“
(
mem_dump_bufãr
);

4668 
mem_dump_bufãr
 = 
NULL
;

4669 
mem_dump_bufãr
 = 
	`km®loc
(
bufãr_size
, 
GFP_KERNEL
);

4670 ià(!
mem_dump_bufãr
) {

4671 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for mem_dump_buffer\n");

4674 
mem_dump_bufãr_size
 = 
bufãr_size
;

4675 
	`memıy
(
mem_dump_bufãr
, 
bufãr
, 
mem_dump_bufãr_size
);

4676 
	}
}

4678 
	$¦si_Ú_driv”_memÜy_dump
(*
bufãr
, 
bufãr_size
, *
ùx
)

4680 
	`SLSI_ERR_NODEV
("slsi_on_driver_memory_dump\n");

4681 
	`kä“
(
mem_dump_bufãr
);

4682 
mem_dump_bufãr
 = 
NULL
;

4683 
mem_dump_bufãr_size
 = 
bufãr_size
;

4684 
mem_dump_bufãr
 = 
	`km®loc
(
mem_dump_bufãr_size
, 
GFP_KERNEL
);

4685 ià(!
mem_dump_bufãr
) {

4686 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for mem_dump_buffer\n");

4689 
	`memıy
(
mem_dump_bufãr
, 
bufãr
, 
mem_dump_bufãr_size
);

4690 
	}
}

4692 
	$¦si_’abË_loggšg
(
¦si_dev
 *
sdev
, 
boŞ
 
’abË
)

4694 
¡©us
 = 0;

4695 #ifdeà
ENABLE_WIFI_LOGGER_MIB_WRITE


4696 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4698 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "V®uoà’abË i : %d\n", 
’abË
);

4699 
¡©us
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_LOGGER_ENABLED
, 
’abË
, 0);

4700 ià(
¡©us
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4701 
	`SLSI_ERR
(
sdev
, "slsi_enable_logging failed:‚o mem for MIB\n");

4702 
¡©us
 = -
ENOMEM
;

4703 
ex™
;

4705 
¡©us
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

4706 
	`kä“
(
mib_d©a
.
d©a
);

4707 ià(
¡©us
)

4708 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiLogg”EÇbËd MIB.ƒ¼Ü = %d\n", 
¡©us
);

4710 
ex™
:

4711  
¡©us
;

4713 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "UnifiLoggerEnabled MIB write disabled\n");

4714  
¡©us
;

4716 
	}
}

4718 
	$¦si_¡¬t_loggšg
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4720 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4721 
»t
 = 0;

4722 
‹mp
 = 0;

4723 
ty³
 = 0;

4724 
ršg_Çme
[32] = {0};

4725 
v”bo£_Ëv–
 = 0;

4726 
ršg_æags
 = 0;

4727 
max_š‹rv®_£c
 = 0;

4728 
mš_d©a_size
 = 0;

4729 cÚ¡ 
Æ©Œ
 *
©Œ
;

4731 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4732 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4733 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

4734 ià(!
©Œ
) {

4735 
»t
 = -
EINVAL
;

4736 
ex™
;

4739 
ty³
 = 
	`Æa_ty³
(
©Œ
);

4741 
ty³
) {

4742 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
:

4743 
	`¡ºıy
(
ršg_Çme
, 
	`Æa_d©a
(
©Œ
), 
	`MIN
(Ôšg_Çmeè- 1, 
	`Æa_Ën
(attr)));

4745 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_VERBOSE_LEVEL
:

4746 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
v”bo£_Ëv–
)) {

4747 
»t
 = -
EINVAL
;

4748 
ex™
;

4751 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_FLAGS
:

4752 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
ršg_æags
)) {

4753 
»t
 = -
EINVAL
;

4754 
ex™
;

4757 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MAX_INTERVAL
:

4758 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
max_š‹rv®_£c
)) {

4759 
»t
 = -
EINVAL
;

4760 
ex™
;

4763 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MIN_DATA_SIZE
:

4764 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
mš_d©a_size
)) {

4765 
»t
 = -
EINVAL
;

4766 
ex™
;

4770 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

4771 
»t
 = -
EINVAL
;

4772 
ex™
;

4775 
»t
 = 
	`scsc_wifi_£t_log_hªdËr
(
¦si_Ú_ršg_bufãr_d©a
, 
sdev
);

4776 ià(
»t
 < 0) {

4777 
	`SLSI_ERR
(
sdev
, "scsc_wifi_£t_log_hªdË¸çed„‘: %d\n", 
»t
);

4778 
ex™
;

4780 
»t
 = 
	`scsc_wifi_£t_®”t_hªdËr
(
¦si_Ú_®”t
, 
sdev
);

4781 ià(
»t
 < 0)

4782 
	`SLSI_ERR
(
sdev
, "W¬nšg : scsc_wifi_£t_®”t_hªdË¸çed„‘: %d\n", 
»t
);

4783 
»t
 = 
	`¦si_’abË_loggšg
(
sdev
, 1);

4784 ià(
»t
 < 0) {

4785 
	`SLSI_ERR
(
sdev
, "¦si_’abË_loggšg fÜƒÇbË = 1, faed„‘: %d\n", 
»t
);

4786 
ex™_w™h_»£t_®”t_hªdËr
;

4788 
»t
 = 
	`scsc_wifi_¡¬t_loggšg
(
v”bo£_Ëv–
, 
ršg_æags
, 
max_š‹rv®_£c
, 
mš_d©a_size
, 
ršg_Çme
);

4789 ià(
»t
 < 0) {

4790 
	`SLSI_ERR
(
sdev
, "scsc_wifi_¡¬t_loggšg faed„‘: %d\n", 
»t
);

4791 
ex™_w™h_di§bË_loggšg
;

4793 
ex™
;

4795 
ex™_w™h_di§bË_loggšg
:

4796 
»t
 = 
	`¦si_’abË_loggšg
(
sdev
, 0);

4797 ià(
»t
 < 0)

4798 
	`SLSI_ERR
(
sdev
, "¦si_’abË_loggšg fÜƒÇbË = 0, faed„‘: %d\n", 
»t
);

4799 
ex™_w™h_»£t_®”t_hªdËr
:

4800 
»t
 = 
	`scsc_wifi_»£t_®”t_hªdËr
();

4801 ià(
»t
 < 0)

4802 
	`SLSI_ERR
(
sdev
, "W¬nšg : scsc_wifi_»£t_®”t_hªdË¸çed„‘: %d\n", 
»t
);

4803 
»t
 = 
	`scsc_wifi_»£t_log_hªdËr
();

4804 ià(
»t
 < 0)

4805 
	`SLSI_ERR
(
sdev
, "scsc_wifi_»£t_log_hªdË¸çed„‘: %d\n", 
»t
);

4806 
ex™
:

4807 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4808  
»t
;

4809 
	}
}

4811 
	$¦si_»£t_loggšg
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4813 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4814 
»t
 = 0;

4816 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4817 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4818 
»t
 = 
	`¦si_’abË_loggšg
(
sdev
, 0);

4819 ià(
»t
 < 0)

4820 
	`SLSI_ERR
(
sdev
, "¦si_’abË_loggšg fÜƒÇbË = 0, faed„‘: %d\n", 
»t
);

4821 
»t
 = 
	`scsc_wifi_»£t_log_hªdËr
();

4822 ià(
»t
 < 0)

4823 
	`SLSI_ERR
(
sdev
, "scsc_wifi_»£t_log_hªdË¸çed„‘: %d\n", 
»t
);

4824 
»t
 = 
	`scsc_wifi_»£t_®”t_hªdËr
();

4825 ià(
»t
 < 0)

4826 
	`SLSI_ERR
(
sdev
, "W¬nšg : scsc_wifi_»£t_®”t_hªdË¸çed„‘: %d\n", 
»t
);

4827 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4828  
»t
;

4829 
	}
}

4831 
	$¦si_Œigg”_fw_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4833 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4834 
»t
 = 0;

4835 
sk_buff
 *
skb
 = 
NULL
;

4836 
Ëngth
 = 100;

4838 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4839 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4841 
»t
 = 
	`scsc_wifi_g‘_fœmw¬e_memÜy_dump
(
¦si_Ú_fœmw¬e_memÜy_dump
, 
sdev
);

4842 ià(
»t
) {

4843 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_fœmw¬e_memÜy_dum°çed : %d\n", 
»t
);

4844 
ex™
;

4848 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
Ëngth
);

4849 ià(!
skb
) {

4850 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4851 
»t
 = -
ENOMEM
;

4852 
ex™
;

4855 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
, 
mem_dump_bufãr_size
)) {

4856 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4857 
	`kä“_skb
(
skb
);

4858 
»t
 = -
EINVAL
;

4859 
ex™
;

4862 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

4864 ià(
»t
)

4865 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

4867 
ex™
:

4868 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4869  
»t
;

4870 
	}
}

4872 
	$¦si_g‘_fw_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4874 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4875 
»t
 = 0;

4876 
‹mp
 = 0;

4877 
ty³
 = 0;

4878 
buf_Ën
 = 0;

4879 
__u£r
 *
u£r_buf
 = 
NULL
;

4880 cÚ¡ 
Æ©Œ
 *
©Œ
;

4881 
sk_buff
 *
skb
;

4882 
u64
 
v®
 = 0;

4884 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4885 ià(!
d©a
)

4886  -
EINVAL
;

4888 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4889 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

4890 
ty³
 = 
	`Æa_ty³
(
©Œ
);

4891 
ty³
) {

4892 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
:

4893 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
buf_Ën
)) {

4894 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4895  -
EINVAL
;

4898 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
:

4899 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

4900 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4901  -
EINVAL
;

4903 
u£r_buf
 = (
__u£r
 *)()(
v®
);

4906 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

4907 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4908  -
EINVAL
;

4911 ià(
buf_Ën
 > 0 && 
u£r_buf
 && 
mem_dump_bufãr
) {

4912 ià(
buf_Ën
 > 
mem_dump_bufãr_size
)

4913 
buf_Ën
 = 
mem_dump_bufãr_size
;

4914 
»t
 = 
	`cİy_to_u£r
(
u£r_buf
, 
mem_dump_bufãr
, 
buf_Ën
);

4915 ià(
»t
) {

4916 
	`SLSI_ERR
(
sdev
, "çedØcİy memdum°štØu£¸bufã¸: %d\n", 
»t
);

4917 
ex™
;

4921 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 100);

4922 ià(!
skb
) {

4923 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4924 
»t
 = -
ENOMEM
;

4925 
ex™
;

4929 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
, (
»t
), &ret)) {

4930 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4931 
	`kä“_skb
(
skb
);

4932 
»t
 = -
EINVAL
;

4933 
ex™
;

4936 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

4938 ià(
»t
)

4939 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

4942 
ex™
:

4943 
	`kä“
(
mem_dump_bufãr
);

4944 
mem_dump_bufãr
 = 
NULL
;

4945 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4946  
»t
;

4947 
	}
}

4949 
	$¦si_Œigg”_driv”_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4951 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4952 
»t
 = 0;

4953 
sk_buff
 *
skb
 = 
NULL
;

4954 
Ëngth
 = 100;

4956 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4957 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4959 
»t
 = 
	`scsc_wifi_g‘_driv”_memÜy_dump
(
¦si_Ú_driv”_memÜy_dump
, 
sdev
);

4960 ià(
»t
) {

4961 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_driv”_memÜy_dum°çed : %d\n", 
»t
);

4962 
ex™
;

4966 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
Ëngth
);

4967 ià(!
skb
) {

4968 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4969 
»t
 = -
ENOMEM
;

4970 
ex™
;

4973 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
, 
mem_dump_bufãr_size
)) {

4974 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4975 
	`kä“_skb
(
skb
);

4976 
»t
 = -
EINVAL
;

4977 
ex™
;

4980 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

4982 ià(
»t
)

4983 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

4985 
ex™
:

4986 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4987  
»t
;

4988 
	}
}

4990 
	$¦si_g‘_driv”_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4992 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4993 
»t
 = 0;

4994 
‹mp
 = 0;

4995 
ty³
 = 0;

4996 
buf_Ën
 = 0;

4997 
__u£r
 *
u£r_buf
 = 
NULL
;

4998 cÚ¡ 
Æ©Œ
 *
©Œ
;

4999 
sk_buff
 *
skb
;

5000 
u64
 
v®
 = 0;

5002 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5003 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5004 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5005 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5006 
ty³
) {

5007 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
:

5008 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
buf_Ën
)) {

5009 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5010  -
EINVAL
;

5013 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
:

5014 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

5015 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5016  -
EINVAL
;

5018 
u£r_buf
 = (
__u£r
 *)()(
v®
);

5021 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5022 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5023  -
EINVAL
;

5026 ià(
buf_Ën
 > 0 && 
u£r_buf
 && 
mem_dump_bufãr_size
) {

5027 ià(
buf_Ën
 > 
mem_dump_bufãr_size
)

5028 
buf_Ën
 = 
mem_dump_bufãr_size
;

5029 
»t
 = 
	`cİy_to_u£r
(
u£r_buf
, 
mem_dump_bufãr
, 
buf_Ën
);

5030 ià(
»t
) {

5031 
	`SLSI_ERR
(
sdev
, "çedØcİy memdum°štØu£¸bufã¸: %d\n", 
»t
);

5032 
ex™
;

5036 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 100);

5037 ià(!
skb
) {

5038 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5039 
»t
 = -
ENOMEM
;

5040 
ex™
;

5044 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
, (
»t
), &ret)) {

5045 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5046 
	`kä“_skb
(
skb
);

5047 
»t
 = -
EINVAL
;

5048 
ex™
;

5051 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5053 ià(
»t
)

5054 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5057 
ex™
:

5058 
	`kä“
(
mem_dump_bufãr
);

5059 
mem_dump_bufãr
 = 
NULL
;

5060 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5061  
»t
;

5062 
	}
}

5064 
	$¦si_g‘_v”siÚ
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5066 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5067 
»t
 = 0;

5068 
‹mp
 = 0;

5069 
ty³
 = 0;

5070 
bufãr_size
 = 1024;

5071 
boŞ
 
log_v”siÚ
 = 
çl£
;

5072 *
bufãr
;

5073 cÚ¡ 
Æ©Œ
 *
©Œ
;

5075 
bufãr
 = 
	`kz®loc
(
bufãr_size
, 
GFP_KERNEL
);

5076 ià(!
bufãr
) {

5077 
	`SLSI_ERR
(
sdev
, "NØmem. Size:%d\n", 
bufãr_size
);

5078  -
ENOMEM
;

5080 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5081 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5082 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5083 
ty³
) {

5084 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_VERSION
:

5085 
log_v”siÚ
 = 
Œue
;

5087 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_VERSION
:

5088 
log_v”siÚ
 = 
çl£
;

5091 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5092 
»t
 = -
EINVAL
;

5093 
ex™
;

5097 ià(
log_v”siÚ
)

5098 
»t
 = 
	`scsc_wifi_g‘_driv”_v”siÚ
(
bufãr
, 
bufãr_size
);

5100 
»t
 = 
	`scsc_wifi_g‘_fœmw¬e_v”siÚ
(
bufãr
, 
bufãr_size
);

5102 ià(
»t
 < 0) {

5103 
	`SLSI_ERR
(
sdev
, "çedØg‘hv”siÚ %d\n", 
»t
);

5104 
ex™
;

5107 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, 
bufãr
, 
	`¡¾’
(buffer));

5108 
ex™
:

5109 
	`kä“
(
bufãr
);

5110 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5111  
»t
;

5112 
	}
}

5114 
	$¦si_g‘_ršg_bufãrs_¡©us
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5116 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5117 
»t
 = 0;

5118 
num_ršgs
 = 
SLSI_MAX_NUM_RING
;

5119 
sk_buff
 *
skb
;

5120 
scsc_wifi_ršg_bufãr_¡©us
 
¡©us
[
SLSI_MAX_NUM_RING
];

5122 
	`SLSI_DBG1
(
sdev
, 
SLSI_GSCAN
, "\n");

5123 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5124 
	`mem£t
(
¡©us
, 0, (
scsc_wifi_ršg_bufãr_¡©us
è* 
num_ršgs
);

5125 
»t
 = 
	`scsc_wifi_g‘_ršg_bufãrs_¡©us
(&
num_ršgs
, 
¡©us
);

5126 ià(
»t
 < 0) {

5127 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_ršg_bufãrs_¡©u çed„‘:%d\n", 
»t
);

5128 
ex™
;

5132 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 700);

5133 ià(!
skb
) {

5134 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5135 
»t
 = -
ENOMEM
;

5136 
ex™
;

5140 ià(
	`Æa_put_u8
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NUM
, 
num_ršgs
) ||

5141 
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_STATUS
, (
¡©us
[0]è* 
num_ršgs
, status)) {

5142 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5143 
	`kä“_skb
(
skb
);

5144 
»t
 = -
EINVAL
;

5145 
ex™
;

5148 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5150 ià(
»t
)

5151 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5152 
ex™
:

5153 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5154  
»t
;

5155 
	}
}

5157 
	$¦si_g‘_ršg_d©a
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5159 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5160 
»t
 = 0;

5161 
‹mp
 = 0;

5162 
ty³
 = 0;

5163 
ršg_Çme
[32] = {0};

5164 cÚ¡ 
Æ©Œ
 *
©Œ
;

5166 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5167 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5168 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5169 ià(!
©Œ
) {

5170 
»t
 = -
EINVAL
;

5171 
ex™
;

5173 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5174 
ty³
) {

5175 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
:

5176 
	`¡ºıy
(
ršg_Çme
, 
	`Æa_d©a
(
©Œ
), 
	`MIN
(Ôšg_Çmeè- 1, 
	`Æa_Ën
(attr)));

5179 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5180 
ex™
;

5184 
»t
 = 
	`scsc_wifi_g‘_ršg_d©a
(
ršg_Çme
);

5185 ià(
»t
 < 0)

5186 
	`SLSI_ERR
(
sdev
, "Œigg”_g‘_d©¨çed„‘:%d\n", 
»t
);

5187 
ex™
:

5188 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5189  
»t
;

5190 
	}
}

5192 
	$¦si_g‘_logg”_suµÜ‹d_ã©u»_£t
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

5193 cÚ¡ *
d©a
, 
Ën
)

5195 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5196 
»t
 = 0;

5197 
u32
 
suµÜ‹d_ã©u»s
 = 0;

5199 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5200 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5201 
»t
 = 
	`scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
(&
suµÜ‹d_ã©u»s
);

5202 ià(
»t
 < 0) {

5203 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£ˆçed„‘:%d\n", 
»t
);

5204 
ex™
;

5206 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
suµÜ‹d_ã©u»s
, (supported_features));

5207 
ex™
:

5208 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5209  
»t
;

5210 
	}
}

5212 
	$¦si_¡¬t_pkt_ç‹_mÚ™Üšg
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5214 
»t
 = 0;

5215 #ifdeà
ENABLE_WIFI_LOGGER_MIB_WRITE


5216 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5217 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

5219 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5220 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5221 
»t
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_TX_DATA_CONFIRM
, 1, 0);

5222 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

5223 
	`SLSI_ERR
(
sdev
, "Failedo set UnifiTxDataConfirm MIB :‚o mem for MIB\n");

5224 
»t
 = -
ENOMEM
;

5225 
ex™
;

5228 
»t
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5230 ià(
»t
) {

5231 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg UnifiTxD©aCÚfœm MIB.ƒ¼Ü = %d\n", 
»t
);

5232 
ex™
;

5235 
»t
 = 
	`scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
();

5236 ià(
»t
 < 0) {

5237 
	`SLSI_ERR
(
sdev
, "scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg faed,„‘=%d\n", 
»t
);

5240 
mib_d©a
.
d©aL’gth
 = 0;

5241 
mib_d©a
.
d©a
 = 
NULL
;

5242 
»t
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_TX_DATA_CONFIRM
, 1, 0);

5243 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

5244 
	`SLSI_ERR
(
sdev
, "Failedo set UnifiTxDataConfirm MIB :‚o mem for MIB\n");

5245 
»t
 = -
ENOMEM
;

5246 
ex™
;

5249 
»t
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5251 ià(
»t
) {

5252 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg UnifiTxD©aCÚfœm MIB.ƒ¼Ü = %d\n", 
»t
);

5253 
ex™
;

5256 
ex™
:

5257 
	`kä“
(
mib_d©a
.
d©a
);

5258 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5259  
»t
;

5261 
	`SLSI_ERR_NODEV
("slsi_start_pkt_fate_monitoring : UnifiTxDataConfirm MIB write disabled\n");

5262  
»t
;

5264 
	}
}

5266 
	$¦si_g‘_tx_pkt_ç‹s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5268 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5269 
»t
 = 0;

5270 
‹mp
 = 0;

5271 
ty³
 = 0;

5272 
__u£r
 *
u£r_buf
 = 
NULL
;

5273 
u32
 
»q_couÁ
 = 0;

5274 
size_t
 
´ovided_couÁ
 = 0;

5275 
sk_buff
 *
skb
;

5276 cÚ¡ 
Æ©Œ
 *
©Œ
;

5277 
u64
 
v®
 = 0;

5279 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5280 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5281 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5282 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5283 
ty³
) {

5284 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
:

5285 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
»q_couÁ
)) {

5286 
»t
 = -
EINVAL
;

5287 
ex™
;

5289 ià(
»q_couÁ
 > 
MAX_FATE_LOG_LEN
) {

5290 
	`SLSI_ERR
(
sdev
, "Found inv®id„eq_couÁ %d fÜ SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM", 
»q_couÁ
);

5291 
»t
 = -
EINVAL
;

5292 
ex™
;

5295 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
:

5296 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

5297 
»t
 = -
EINVAL
;

5298 
ex™
;

5300 
u£r_buf
 = (
__u£r
 *)()(
v®
);

5303 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5304 
»t
 = -
EINVAL
;

5305 
ex™
;

5309 
»t
 = 
	`scsc_wifi_g‘_tx_pkt_ç‹s
(
u£r_buf
, 
»q_couÁ
, &
´ovided_couÁ
, 
Œue
);

5310 ià(
»t
 < 0) {

5311 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_tx_pkt_ç‹ çed„‘: %d\n", 
»t
);

5312 
ex™
;

5316 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 200);

5317 ià(!
skb
) {

5318 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5319 
»t
 = -
ENOMEM
;

5320 
ex™
;

5323 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
, (
´ovided_couÁ
), &provided_count)) {

5324 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5325 
	`kä“_skb
(
skb
);

5326 
»t
 = -
EINVAL
;

5327 
ex™
;

5330 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5332 ià(
»t
)

5333 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5334 
ex™
:

5335 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5336  
»t
;

5337 
	}
}

5339 
	$¦si_g‘_rx_pkt_ç‹s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5341 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5342 
»t
 = 0;

5343 
‹mp
 = 0;

5344 
ty³
 = 0;

5345 
__u£r
 *
u£r_buf
 = 
NULL
;

5346 
u32
 
»q_couÁ
 = 0;

5347 
size_t
 
´ovided_couÁ
 = 0;

5348 
sk_buff
 *
skb
;

5349 cÚ¡ 
Æ©Œ
 *
©Œ
;

5350 
u64
 
v®
 = 0;

5352 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5353 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5354 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5355 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5356 
ty³
) {

5357 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
:

5358 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
»q_couÁ
)) {

5359 
»t
 = -
EINVAL
;

5360 
ex™
;

5362 ià(
»q_couÁ
 > 
MAX_FATE_LOG_LEN
) {

5363 
	`SLSI_ERR
(
sdev
, "Found inv®id„eq_couÁ %d fÜ SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM", 
»q_couÁ
);

5364 
»t
 = -
EINVAL
;

5365 
ex™
;

5368 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
:

5369 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

5370 
»t
 = -
EINVAL
;

5371 
ex™
;

5373 
u£r_buf
 = (
__u£r
 *)()(
v®
);

5376 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5377 
»t
 = -
EINVAL
;

5378 
ex™
;

5382 
»t
 = 
	`scsc_wifi_g‘_rx_pkt_ç‹s
(
u£r_buf
, 
»q_couÁ
, &
´ovided_couÁ
, 
Œue
);

5383 ià(
»t
 < 0) {

5384 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_rx_pkt_ç‹ çed„‘: %d\n", 
»t
);

5385 
ex™
;

5389 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 200);

5390 ià(!
skb
) {

5391 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5392 
»t
 = -
ENOMEM
;

5393 
ex™
;

5396 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
, (
´ovided_couÁ
), &provided_count)) {

5397 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5398 
	`kä“_skb
(
skb
);

5399 
»t
 = -
EINVAL
;

5400 
ex™
;

5403 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5405 ià(
»t
)

5406 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5407 
ex™
:

5408 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5409  
»t
;

5410 
	}
}

5412 
	$¦si_wake_¡©s_©Œ_g‘_út_sz
(
¦si_wÏn_driv”_wake_»asÚ_út
 *
wake_»asÚ_couÁ
,

5413 cÚ¡ *
d©a
, 
Ën
)

5415 cÚ¡ 
Æ©Œ
 *
©Œ
;

5416 
ty³
 = 0, 
‹mp
 = 0;

5418 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5419 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5420 
ty³
) {

5421 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_SZ
:

5422 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
wake_»asÚ_couÁ
->
cmd_ev’t_wake_út_sz
))

5423  -
EINVAL
;

5425 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_SZ
:

5426 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
wake_»asÚ_couÁ
->
driv”_fw_loÿl_wake_út_sz
))

5427  -
EINVAL
;

5430 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

5431  -
EINVAL
;

5435 
	}
}

5437 
	$¦si_wake_¡©s_©Œ_put_skb_bufãr
(
sk_buff
 *
skb
,

5438 
¦si_Æa_put
 *
put_ruË
, 
u32
 
put_ruË_Ën
)

5440 
i
 = 0, 
»t
 = 0;

5442 
i
 = 0; i < 
put_ruË_Ën
; i++) {

5443 ià(
put_ruË
[
i
].
Æa_ty³
 =ğ
NLA_U32
) {

5444 
»t
 = 
	`Æa_put_u32
(
skb
, 
put_ruË
[
i
].
©Œ
, *((
u32
 *íut_ruË[i].
v®ue_±r
));

5445 } ià(
put_ruË
[
i
].
Æa_ty³
 =ğ
NLA_BINARY
) {

5446 
»t
 = 
	`Æa_put
(
skb
, 
put_ruË
[
i
].
©Œ
,…ut_ruË[i].
v®ue_Ën
, (
u32
 *íut_ruË[i].
v®ue_±r
);

5448 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆ©Œibu‹ (unsuµÜ‹dy³): [%d]\n", 
put_ruË
[
i
].
©Œ
);

5449  -
EINVAL
;

5452 ià(
»t
 < 0) {

5453 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆ©Œibu‹y³ [%d]„‘ [%d]\n", 
put_ruË
[
i
].
©Œ
, 
»t
);

5454  -
EINVAL
;

5458 
	}
}

5460 
	#SLSI_WAKE_REASON_ATTR
(
ty³
, 
©Œ_Çme
, 
f›ld
, 
Ën
) { \

5461 .
Æa_ty³
 = 
ty³
, \

5462 .
©Œ
 = 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_
 ## 
©Œ_Çme
, \

5463 .
v®ue_±r
 = &
wake_»asÚ_couÁ
.
f›ld
, \

5464 .
v®ue_Ën
 = 
Ën
 \

5465 }

	)

5467 
	#SLSI_WAKE_REASON_U32
(
©Œ_Çme
, 
f›ld
è
	`SLSI_WAKE_REASON_ATTR
(
NLA_U32
,‡‰r_Çme, f›ld, 0)

	)

5468 
	#SLSI_WAKE_REASON_ARRAY
(
©Œ_Çme
, 
f›ld
, 
Ën
è
	`SLSI_WAKE_REASON_ATTR
(
NLA_BINARY
,‡‰r_Çme, f›ld,†’)

	)

5470 
	$¦si_g‘_wake_»asÚ_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5472 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5473 
¦si_wÏn_driv”_wake_»asÚ_út
 
wake_»asÚ_couÁ
;

5474 
»t
 = 0;

5475 
sk_buff
 *
skb
;

5476 
¦si_Æa_put
 
¡©s_put_ruË
[] = {

5477 
	`SLSI_WAKE_REASON_U32
(
TOTAL_CMD_EVENT_WAKE
, 
tÙ®_cmd_ev’t_wake
),

5478 
	`SLSI_WAKE_REASON_ARRAY
(
CMD_EVENT_WAKE_CNT_PTR
, 
cmd_ev’t_wake_út
, 0),

5479 
	`SLSI_WAKE_REASON_U32
(
TOTAL_DRIVER_FW_LOCAL_WAKE
, 
tÙ®_driv”_fw_loÿl_wake
),

5480 
	`SLSI_WAKE_REASON_ARRAY
(
DRIVER_FW_LOCAL_WAKE_CNT_PTR
, 
driv”_fw_loÿl_wake_út
, 0),

5481 
	`SLSI_WAKE_REASON_U32
(
TOTAL_RX_DATA_WAKE
, 
tÙ®_rx_d©a_wake
),

5482 
	`SLSI_WAKE_REASON_U32
(
RX_UNICAST_CNT
, 
rx_wake_d‘as
.
rx_uniÿ¡_út
),

5483 
	`SLSI_WAKE_REASON_U32
(
RX_MULTICAST_CNT
, 
rx_wake_d‘as
.
rx_muÉiÿ¡_út
),

5484 
	`SLSI_WAKE_REASON_U32
(
RX_BROADCAST_CNT
, 
rx_wake_d‘as
.
rx_brßdÿ¡_út
),

5485 
	`SLSI_WAKE_REASON_U32
(
ICMP_PKT
, 
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp_pkt
),

5486 
	`SLSI_WAKE_REASON_U32
(
ICMP6_PKT
, 
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_pkt
),

5487 
	`SLSI_WAKE_REASON_U32
(
ICMP6_RA
, 
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_¿
),

5488 
	`SLSI_WAKE_REASON_U32
(
ICMP6_NA
, 
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_Ç
),

5489 
	`SLSI_WAKE_REASON_U32
(
ICMP6_NS
, 
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_ns
),

5490 
	`SLSI_WAKE_REASON_U32
(
ICMP4_RX_MULTICAST_CNT
, 
rx_muÉiÿ¡_wake_pkt_šfo
.
v4_rx_muÉiÿ¡_addr_út
),

5491 
	`SLSI_WAKE_REASON_U32
(
ICMP6_RX_MULTICAST_CNT
, 
rx_muÉiÿ¡_wake_pkt_šfo
.
v6_rx_muÉiÿ¡_addr_út
),

5492 
	`SLSI_WAKE_REASON_U32
(
OTHER_RX_MULTICAST_CNT
, 
rx_muÉiÿ¡_wake_pkt_šfo
.
Ùh”_rx_muÉiÿ¡_addr_út
),

5495 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5497 
	`mem£t
(&
wake_»asÚ_couÁ
, 0, (
¦si_wÏn_driv”_wake_»asÚ_út
));

5499 
	`¦si_¥šlock_lock
(&
sdev
->
wake_¡©s_lock
);

5500 
wake_»asÚ_couÁ
 = 
sdev
->
wake_»asÚ_¡©s
;

5501 
	`¦si_¥šlock_uÆock
(&
sdev
->
wake_¡©s_lock
);

5502 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5504 
»t
 = 
	`¦si_wake_¡©s_©Œ_g‘_út_sz
(&
wake_»asÚ_couÁ
, 
d©a
, 
Ën
);

5505 ià(
»t
 < 0) {

5506 
	`SLSI_ERR
(
sdev
, "FaedØg‘ wak»asÚ st ©Œibu‹ : %d\n", 
»t
);

5507 
ex™
;

5511 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
NLMSG_DEFAULT_SIZE
);

5512 ià(!
skb
) {

5513 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5514 
»t
 = -
ENOMEM
;

5515 
ex™
;

5518 
»t
 = 
	`¦si_wake_¡©s_©Œ_put_skb_bufãr
(
skb
, 
¡©s_put_ruË
, 
	`ARRAY_SIZE
(stats_put_rule));

5519 ià(
»t
 < 0) {

5520 
	`kä“_skb
(
skb
);

5521 
ex™
;

5524 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5525 ià(
»t
)

5526 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5527 
ex™
:

5528 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5529  
»t
;

5530 
	}
}

5534 
	$¦si_acs_v®id©e_width_hw_mode
(
¦si_acs_»que¡
 *
»que¡
)

5536 ià(
»que¡
->
hw_mode
 !ğ
SLSI_ACS_MODE_IEEE80211A
 &&„eque¡->hw_mod!ğ
SLSI_ACS_MODE_IEEE80211B
 &&

5537 
»que¡
->
hw_mode
 !ğ
SLSI_ACS_MODE_IEEE80211G
 &&„eque¡->hw_mod!ğ
SLSI_ACS_MODE_IEEE80211ANY
)

5538  -
EINVAL
;

5539 ià(
»que¡
->
ch_width
 != 20 &&„equest->ch_width != 40 &&„equest->ch_width != 80)

5540  -
EINVAL
;

5542 
	}
}

5544 
	$¦si_acs_š™
(
why
 *wiphy,

5545 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5547 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5548 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5549 
Ãtdev_vif
 *
ndev_vif
;

5550 
¦si_acs_»que¡
 *
»que¡
;

5551 
‹mp
;

5552 
ty³
;

5553 cÚ¡ 
Æ©Œ
 *
©Œ
;

5554 
r
 = 0;

5555 
u32
 *
äeq_li¡
 = 
NULL
;

5556 
äeq_li¡_Ën
 = 0;

5558 
	`SLSI_INFO
(
sdev
, "SUBCMD_ACS_INIT Received\n");

5559 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

5560 
	`SLSI_ERR
(
sdev
, "Not supported in WlanLite mode\n");

5561  -
EOPNOTSUPP
;

5563 ià(
wdev
->
iáy³
 !ğ
NL80211_IFTYPE_AP
) {

5564 
	`SLSI_ERR
(
sdev
, "Inv®id iáy³: %d\n", 
wdev
->
iáy³
);

5565  -
EINVAL
;

5567 ià(!
dev
) {

5568 
	`SLSI_ERR
(
sdev
, "Dev‚ot found!\n");

5569  -
ENODEV
;

5571 
»que¡
 = 
	`kÿÎoc
(1, (*»que¡), 
GFP_KERNEL
);

5572 ià(!
»que¡
) {

5573 
	`SLSI_ERR
(
sdev
, "No memory for„equest!");

5574  -
ENOMEM
;

5576 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5578 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

5579 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5580 ià(!
©Œ
) {

5581 
	`kä“
(
»que¡
);

5582 
r
 = -
EINVAL
;

5583 
ex™
;

5586 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5588 
ty³
) {

5589 
SLSI_ACS_ATTR_HW_MODE
:

5591 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &(
»que¡
->
hw_mode
))) {

5592 
	`kä“
(
»que¡
);

5593 
r
 = -
EINVAL
;

5594 
ex™
;

5596 
	`SLSI_INFO
(
sdev
, "ACS hw mode: %d\n", 
»que¡
->
hw_mode
);

5599 
SLSI_ACS_ATTR_CHWIDTH
:

5601 ià(
	`¦si_ut_Æa_g‘_u16
(
©Œ
, &(
»que¡
->
ch_width
))) {

5602 
	`kä“
(
»que¡
);

5603 
r
 = -
EINVAL
;

5604 
ex™
;

5606 
	`SLSI_INFO
(
sdev
, "ACS ch_width: %d\n", 
»que¡
->
ch_width
);

5609 
SLSI_ACS_ATTR_FREQ_LIST
:

5611 ià(
äeq_li¡
)

5614 
äeq_li¡
 = 
	`km®loc
(
	`Æa_Ën
(
©Œ
), 
GFP_KERNEL
);

5615 ià(!
äeq_li¡
) {

5616 
	`SLSI_ERR
(
sdev
, "No memory for frequency†ist!");

5617 
	`kä“
(
»que¡
);

5618 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5619  -
ENOMEM
;

5621 
	`memıy
(
äeq_li¡
, 
	`Æa_d©a
(
©Œ
), 
	`Æa_Ën
(attr));

5622 
äeq_li¡_Ën
 = 
	`Æa_Ën
(
©Œ
è/ (
u32
);

5623 
	`SLSI_INFO
(
sdev
, "ACS f»q_li¡_Ën: %d\n", 
äeq_li¡_Ën
);

5624 ià(
äeq_li¡_Ën
 > 
MAX_CHAN_VALUE_ACS
)

5625 
äeq_li¡_Ën
 = 
MAX_CHAN_VALUE_ACS
;

5629 ià(
ty³
 > 
SLSI_ACS_ATTR_MAX
)

5630 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

5635 
r
 = 
	`¦si_acs_v®id©e_width_hw_mode
(
»que¡
);

5636 ià(
r
 =ğ0 && 
äeq_li¡_Ën
) {

5637 
›“80211_chªÃl
 *
chªÃls
[
MAX_CHAN_VALUE_ACS
];

5638 
¦si_acs_chª_šfo
 
ch_šfo
[
MAX_CHAN_VALUE_ACS
];

5639 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
;

5640 
i
 = 0, 
num_chªÃls
 = 0;

5641 
idx
;

5642 
u32
 
chª_æags
 = (
IEEE80211_CHAN_INDOOR_ONLY
 | 
IEEE80211_CHAN_RADAR
 |

5643 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_NO_IR
);

5645 
	`mem£t
(
chªÃls
, 0, (channels));

5646 
	`mem£t
(&
ch_šfo
, 0, (ch_info));

5647 
i
 = 0; i < 
äeq_li¡_Ën
; i++) {

5648 
chªÃls
[
num_chªÃls
] = 
	`›“80211_g‘_chªÃl
(
why
, 
äeq_li¡
[
i
]);

5649 ià(!
chªÃls
[
num_chªÃls
]) {

5650 
	`SLSI_INFO
(
sdev
, "IgnÜšv®id f»q:%d iÀäeq†i¡\n", 
äeq_li¡
[
i
]);

5651 } ià(
chªÃls
[
num_chªÃls
]->
æags
 & 
chª_æags
) {

5652 
	`SLSI_INFO
(
sdev
, "Sk inv®id chªÃl:%d fÜ ACS\n", 
chªÃls
[
num_chªÃls
]->
hw_v®ue
);

5654 
idx
 = 
	`¦si_fšd_chª_idx
(
chªÃls
[
num_chªÃls
]->
hw_v®ue
, 
»que¡
->
hw_mode
);

5655 
ch_šfo
[
idx
].
chª
 = 
chªÃls
[
num_chªÃls
]->
hw_v®ue
;

5656 
num_chªÃls
++;

5660 ià(
num_chªÃls
 == 1) {

5661 
	`mem£t
(&
acs_£Ëùed_chªÃls
, 0, (acs_selected_channels));

5662 
acs_£Ëùed_chªÃls
.
ch_width
 = 20;

5663 
acs_£Ëùed_chªÃls
.
hw_mode
 = 
»que¡
->hw_mode;

5664 
acs_£Ëùed_chªÃls
.
´i_chªÃl
 = 
chªÃls
[0]->
hw_v®ue
;

5665 
r
 = 
	`¦si_£nd_acs_ev’t
(
sdev
, 
acs_£Ëùed_chªÃls
);

5666 
sdev
->
acs_chªÃl_sw™ched
 = 
Œue
;

5667 
	`kä“
(
äeq_li¡
);

5668 
	`kä“
(
»que¡
);

5669 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5670  
r
;

5673 ià(
»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211A
)

5674 
»que¡
->
ch_li¡_Ën
 = 
MAX_5G_CHANNELS
;

5675 ià(
»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211B
 ||„eque¡->hw_mod=ğ
SLSI_ACS_MODE_IEEE80211G
)

5676 
»que¡
->
ch_li¡_Ën
 = 
MAX_24G_CHANNELS
;

5678 
»que¡
->
ch_li¡_Ën
 = 
MAX_CHAN_VALUE_ACS
;

5680 
	`memıy
(&
»que¡
->
acs_chª_šfo
[0], &
ch_šfo
[0], (ch_info));

5681 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
 = 
»que¡
;

5682 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

5683 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

5684 
dev
,

5685 
FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
,

5686 
FAPI_REPORTMODE_REAL_TIME
,

5688 
NULL
,

5689 
num_chªÃls
,

5690 
chªÃls
,

5691 
NULL
,

5692 
NULL
,

5694 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


5696 
NULL
,

5698 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

5700 
	`SLSI_ERR
(
sdev
, "Inv®id f»q_li¡†’:%d o¸ch_width:%d o¸hw_mode:%d\n", 
äeq_li¡_Ën
,

5701 
»que¡
->
ch_width
,„eque¡->
hw_mode
);

5702 
r
 = -
EINVAL
;

5703 
	`kä“
(
»que¡
);

5705 
ex™
:

5706 
	`kä“
(
äeq_li¡
);

5707 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5708  
r
;

5709 
	}
}

5711 
	$¦si_cÚfigu»_Ï‹ncy_mode
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5713 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5714 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5715 
‹mp
 = 0;

5716 
ty³
 = 0;

5717 cÚ¡ 
Æ©Œ
 *
©Œ
;

5718 
»t
 = 0;

5719 
low_Ï‹ncy_mode
 = 0;

5720 
u8
 
v®
 = 0;

5722 ià(!
dev
) {

5723 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5724  -
EINVAL
;

5727 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5728 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5729 
ty³
) {

5730 
SLSI_NL_ATTRIBUTE_LATENCY_MODE
:

5731 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

5732 
»t
 = -
EINVAL
;

5733 
ex™
;

5735 
low_Ï‹ncy_mode
 = ()
v®
;

5738 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

5739 
»t
 = -
EINVAL
;

5740 
ex™
;

5744 
»t
 = 
	`¦si_£t_Ï‹ncy_mode
(
dev
, 
low_Ï‹ncy_mode
, 
Ën
);

5745 ià(
»t
)

5746 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šg†ow†©’cy mod»t:%d\n", 
»t
);

5747 
ex™
:

5748  
»t
;

5749 
	}
}

5752 
	#SLSI_PSID_UNIFI_DTIM_MULTIPLIER
 3002

	)

5754 
	$¦si_£t_dtim_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5756 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5757 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5758 
Ãtdev_vif
 *
ndev_vif
;

5759 cÚ¡ 
Æ©Œ
 *
©Œ
;

5760 
»t
 = 0;

5761 
‹mp
 = 0;

5762 
ty³
 = 0;

5763 
muÉl›r
 = 0;

5764 
u32
 
v®
 = 0;

5766 ià(!
dev
) {

5767 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5768  -
EINVAL
;

5770 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5771 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5772 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

5773 
	`SLSI_WARN
(
sdev
, "Not‡ STA VIF\n");

5774 
»t
 = -
EINVAL
;

5775 
ex™
;

5777 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

5778 
	`SLSI_WARN
(
sdev
, "VIF is‚ot connected\n");

5779 
»t
 = -
EINVAL
;

5780 
ex™
;

5782 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5783 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5784 
ty³
) {

5785 
SLSI_VENDOR_ATTR_DTIM_MULTIPLIER
:

5786 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
v®
)) {

5787 
»t
 = -
EINVAL
;

5788 
ex™
;

5790 ià(
v®
 < 1 || val > 9) {

5791 
»t
 = -
EINVAL
;

5792 
ex™
;

5794 
muÉl›r
 = ()
v®
;

5797 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

5798 
»t
 = -
EINVAL
;

5799 
ex™
;

5802 
	`SLSI_INFO
(
sdev
, "muÉl›¸%d\n", 
muÉl›r
);

5803 ià(
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_DTIM_MULTIPLIER
, 
muÉl›r
)) {

5804 
	`SLSI_ERR
(
sdev
, "Set MIB DTIM_MULTIPLIER failed\n");

5805 
»t
 = -
EIO
;

5806 
ex™
;

5808 
ex™
:

5809 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5810  
»t
;

5811 
	}
}

5813 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


5814 
	$¦si_£Ëù_tx_pow”_sûÇrio
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5816 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5817 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5818 
‹mp
 = 0;

5819 
ty³
 = 0;

5820 cÚ¡ 
Æ©Œ
 *
©Œ
;

5821 
»t
 = 0;

5822 
pow”_sûÇrio
 = 0;

5823 
u8
 
v®
 = 0;

5825 ià(!
dev
) {

5826 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5827  -
EINVAL
;

5830 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5831 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5832 
ty³
) {

5833 
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
:

5834 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

5835 
»t
 = -
EINVAL
;

5836 
ex™
;

5838 
pow”_sûÇrio
 = ()
v®
;

5841 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

5842 
»t
 = -
ENOTSUPP
;

5843 
ex™
;

5846 ià(
pow”_sûÇrio
 < 0 ||…ower_scenario > 4) {

5847 
	`SLSI_ERR_NODEV
("UnknowÀpow”_sûÇrio: %d\n", 
pow”_sûÇrio
);

5848 
»t
 = -
EINVAL
;

5849 
ex™
;

5851 ià(
pow”_sûÇrio
 == 0) {

5852 
	`SLSI_INFO_NODEV
("SAR Scenario 0ƒquivalento 2 (Voice call)\n");

5853 
pow”_sûÇrio
 = 2;

5855 
»t
 = 
	`¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
dev
, 
pow”_sûÇrio
);

5856 ià(
»t
)

5857 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šg SAR…ow” sûÇrio,„‘:%d\n", 
»t
);

5858 
ex™
:

5859  
»t
;

5860 
	}
}

5862 
	$¦si_»£t_tx_pow”_sûÇrio
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5864 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5865 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5866 
»t
 = 0;

5867 
mode
 = -1;

5869 ià(!
dev
) {

5870 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5871  -
EINVAL
;

5874 
»t
 = 
	`¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
dev
, 
mode
);

5875 ià(
»t
)

5876 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ»£ˆSAR…ow” sûÇrio,„‘:%d\n", 
»t
);

5877  
»t
;

5878 
	}
}

5881 cÚ¡ 
Æ80211_v’dÜ_cmd_šfo
 
	g¦si_v’dÜ_ev’ts
[] = {

5883 { 
OUI_GOOGLE
, 
SLSI_NL80211_SIGNIFICANT_CHANGE_EVENT
 },

5884 { 
OUI_GOOGLE
, 
SLSI_NL80211_HOTLIST_AP_FOUND_EVENT
 },

5886 { 
OUI_GOOGLE
, 
SLSI_NL80211_SCAN_RESULTS_AVAILABLE_EVENT
 },

5887 { 
OUI_GOOGLE
, 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
 },

5888 { 
OUI_GOOGLE
, 
SLSI_NL80211_SCAN_EVENT
 },

5890 { 
OUI_GOOGLE
, 
SLSI_NL80211_HOTLIST_AP_LOST_EVENT
 },

5892 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
 },

5893 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_HANGED_EVENT
 },

5894 { 
OUI_GOOGLE
, 
SLSI_NL80211_EPNO_EVENT
 },

5895 { 
OUI_GOOGLE
, 
SLSI_NL80211_HOTSPOT_MATCH
 },

5896 { 
OUI_GOOGLE
, 
SLSI_NL80211_RSSI_REPORT_EVENT
},

5897 { 
OUI_GOOGLE
, 
SLSI_NL80211_LOGGER_RING_EVENT
},

5898 { 
OUI_GOOGLE
, 
SLSI_NL80211_LOGGER_FW_DUMP_EVENT
},

5899 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_RESPONSE_EVENT
},

5900 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
},

5901 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_MATCH_EVENT
},

5902 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
},

5903 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
},

5904 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
},

5905 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
},

5906 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_DISABLED_EVENT
},

5907 { 
OUI_GOOGLE
, 
SLSI_NL80211_RTT_RESULT_EVENT
},

5908 { 
OUI_GOOGLE
, 
SLSI_NL80211_RTT_COMPLETE_EVENT
},

5909 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_ACS_EVENT
},

5910 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_FORWARD_BEACON
},

5911 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
},

5912 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
},

5913 { 
OUI_GOOGLE
, 
SLSI_NAN_EVENT_NDP_REQ
},

5914 { 
OUI_GOOGLE
, 
SLSI_NAN_EVENT_NDP_CFM
},

5915 { 
OUI_GOOGLE
, 
SLSI_NAN_EVENT_NDP_END
},

5916 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_RCL_EVENT
},

5917 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT
},

5918 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_CONNECTIVITY_LOG_EVENT
},

5919 { 
OUI_GOOGLE
, 
SLSI_NL80211_SUBSYSTEM_RESTART_EVENT
},

5920 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_TWT_SETUP_EVENT
},

5921 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_TWT_TEARDOWN_EVENT
},

5922 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_TWT_NOTIFICATION_EVENT
},

5923 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_SCHED_PM_TEARDOWN_EVENT
},

5924 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_SCHED_PM_LEAKY_AP_DETECT_EVENT
},

5925 { 
OUI_SAMSUNG
, 
SLSI_NL80211_NAN_INTERFACE_CREATED_EVENT
},

5926 { 
OUI_SAMSUNG
, 
SLSI_NL80211_NAN_INTERFACE_DELETED_EVENT
}

5929 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

5930 cÚ¡ 
Æa_pŞicy
 
	g¦si_no_pŞicy
[2] = {0};

5932 cÚ¡ 
Æa_pŞicy


5933 
	g¦si_wÏn_v’dÜ_acs_pŞicy
[
SLSI_ACS_ATTR_MAX
 + 1] = {

5934 [
SLSI_ACS_ATTR_HW_MODE
] = {.
ty³
 = 
NLA_U8
},

5935 [
SLSI_ACS_ATTR_HT_ENABLED
] = {.
ty³
 = 
NLA_FLAG
},

5936 [
SLSI_ACS_ATTR_HT40_ENABLED
] = {.
ty³
 = 
NLA_FLAG
},

5937 [
SLSI_ACS_ATTR_VHT_ENABLED
] = {.
ty³
 = 
NLA_FLAG
 },

5938 [
SLSI_ACS_ATTR_CHWIDTH
] = {.
ty³
 = 
NLA_U16
},

5939 [
SLSI_ACS_ATTR_FREQ_LIST
] = {.
ty³
 = 
NLA_BINARY
,

5940 .
	gËn
 = (
MAX_CHAN_VALUE_ACS
 * (
u32
)) },

5943 cÚ¡ 
Æa_pŞicy


5944 
	g¦si_wÏn_v’dÜ_deçuÉ_sÿn_pŞicy
[
SLSI_SCAN_DEFAULT_MAX
 + 1] = {

5945 [
SLSI_SCAN_DEFAULT_IE_LEN
] = {.
ty³
 = 
NLA_U32
},

5946 [
SLSI_SCAN_DEFAULT_IES
] = {.
ty³
 = 
NLA_BINARY
},

5949 cÚ¡ 
Æa_pŞicy


5950 
	g¦si_wÏn_v’dÜ_Îs_pŞicy
[
LLS_ATTRIBUTE_MAX
 + 1] = {

5951 [
LLS_ATTRIBUTE_SET_MPDU_SIZE_THRESHOLD
] = {.
ty³
 = 
NLA_U32
},

5952 [
LLS_ATTRIBUTE_SET_AGGR_STATISTICS_GATHERING
] = {.
ty³
 = 
NLA_U32
},

5953 [
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST_MASK
] = {.
ty³
 = 
NLA_U32
},

5954 [
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST
] = {.
ty³
 = 
NLA_U32
},

5955 [
LLS_ATTRIBUTE_STATS_VERSION
] = {.
ty³
 = 
NLA_U32
},

5956 [
LLS_ATTRIBUTE_GET_STATS_TYPE
] = {.
ty³
 = 
NLA_U32
},

5957 [
LLS_ATTRIBUTE_GET_STATS_STRUCT
] = {.
ty³
 = 
NLA_U32
},

5960 cÚ¡ 
Æa_pŞicy


5961 
	g¦si_wÏn_v’dÜ_¡¬t_k“·live_ofæßd_pŞicy
[
MKEEP_ALIVE_ATTRIBUTE_MAX
 + 1] = {

5962 [
MKEEP_ALIVE_ATTRIBUTE_ID
] = {.
ty³
 = 
NLA_U8
},

5963 [
MKEEP_ALIVE_ATTRIBUTE_IP_PKT
] = {.
ty³
 = 
NLA_BINARY
},

5964 [
MKEEP_ALIVE_ATTRIBUTE_IP_PKT_LEN
] = {.
ty³
 = 
NLA_U16
},

5965 [
MKEEP_ALIVE_ATTRIBUTE_PERIOD_MSEC
] = {.
ty³
 = 
NLA_U32
},

5966 [
MKEEP_ALIVE_ATTRIBUTE_DST_MAC_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

5967 .
	gËn
 = 
ETH_ALEN
},

5968 [
MKEEP_ALIVE_ATTRIBUTE_SRC_MAC_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

5969 .
	gËn
 = 
ETH_ALEN
},

5972 cÚ¡ 
Æa_pŞicy


5973 
	g¦si_wÏn_v’dÜ_low_Ï‹ncy_pŞicy
[
SLSI_NL_ATTRIBUTE_LATENCY_MAX
 + 1] = {

5974 [
SLSI_NL_ATTRIBUTE_LATENCY_MODE
] = {.
ty³
 = 
NLA_U8
},

5977 cÚ¡ 
Æa_pŞicy


5978 
	g¦si_wÏn_v’dÜ_dtim_pŞicy
[
SLSI_VENDOR_ATTR_DTIM_MAX
 + 1] = {

5979 [
SLSI_VENDOR_ATTR_DTIM_MULTIPLIER
] = {.
ty³
 = 
NLA_U32
},

5982 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


5983 cÚ¡ 
Æa_pŞicy


5984 
	g¦si_wÏn_v’dÜ_tx_pow”_sûÇrio_pŞicy
[
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO_MAX
 + 1] = {

5985 [
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
] = {.
ty³
 = 
NLA_U8
},

5989 cÚ¡ 
Æa_pŞicy


5990 
	g¦si_wÏn_v’dÜ_couÁry_code_pŞicy
[
SLSI_NL_ATTRIBUTE_COUNTRY_CODE_MAX
 + 1] = {

5991 [
SLSI_NL_ATTRIBUTE_COUNTRY_CODE
] = {.
ty³
 = 
NLA_BINARY
},

5994 cÚ¡ 
Æa_pŞicy


5995 
	g¦si_wÏn_v’dÜ_rßm_¡©e_pŞicy
[
SLSI_NL_ATTR_ROAM_MAX
 + 1] = {

5996 [
SLSI_NL_ATTR_ROAM_STATE
] = {.
ty³
 = 
NLA_U8
},

5999 cÚ¡ 
Æa_pŞicy


6000 
	g¦si_wÏn_v’dÜ_rssi_mÚ™Ü
[
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX
 + 1] = {

6001 [
SLSI_RSSI_MONITOR_ATTRIBUTE_START
] = {.
ty³
 = 
NLA_U8
},

6002 [
SLSI_RSSI_MONITOR_ATTRIBUTE_MIN_RSSI
] = {.
ty³
 = 
NLA_S8
},

6003 [
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX_RSSI
] = {.
ty³
 = 
NLA_S8
},

6006 cÚ¡ 
Æa_pŞicy


6007 
	g¦si_wÏn_v’dÜ_¹t_pŞicy
[
SLSI_RTT_ATTRIBUTE_MAX
 + 1] = {

6008 [
SLSI_RTT_ATTRIBUTE_TARGET_CNT
] = {.
ty³
 = 
NLA_U8
},

6009 [
SLSI_RTT_ATTRIBUTE_TARGET_ID
] = {.
ty³
 = 
NLA_U16
},

6010 [
SLSI_RTT_ATTRIBUTE_TARGET_INFO
] = {.
ty³
 = 
NLA_NESTED_ARRAY
,

6011 .
	gËn
 = 
SLSI_RTT_ATTRIBUTE_MAX
,

6012 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6013 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_¹t_pŞicy
},

6017 [
SLSI_RTT_ATTRIBUTE_TARGET_MAC
] = {.
ty³
 = 
NLA_BINARY
},

6018 [
SLSI_RTT_ATTRIBUTE_TARGET_TYPE
] = {.
ty³
 = 
NLA_U8
},

6019 [
SLSI_RTT_ATTRIBUTE_TARGET_PEER
] = {.
ty³
 = 
NLA_U8
},

6020 [
SLSI_RTT_ATTRIBUTE_TARGET_CHAN_FREQ
] = {.
ty³
 = 
NLA_U16
},

6021 [
SLSI_RTT_ATTRIBUTE_TARGET_PERIOD
] = {.
ty³
 = 
NLA_U8
},

6022 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_BURST
] = {.
ty³
 = 
NLA_U8
},

6023 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_FTM_BURST
] = {.
ty³
 = 
NLA_U8
},

6024 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTM
] = {.
ty³
 = 
NLA_U8
},

6025 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTMR
] = {.
ty³
 = 
NLA_U8
},

6026 [
SLSI_RTT_ATTRIBUTE_TARGET_BURST_DURATION
] = {.
ty³
 = 
NLA_U8
},

6027 [
SLSI_RTT_ATTRIBUTE_TARGET_PREAMBLE
] = {.
ty³
 = 
NLA_U16
},

6028 [
SLSI_RTT_ATTRIBUTE_TARGET_BW
] = {.
ty³
 = 
NLA_U16
},

6029 [
SLSI_RTT_ATTRIBUTE_TARGET_LCI
] = {.
ty³
 = 
NLA_U16
},

6030 [
SLSI_RTT_ATTRIBUTE_TARGET_LCR
] = {.
ty³
 = 
NLA_U16
},

6033 cÚ¡ 
Æa_pŞicy


6034 
	g¦si_wÏn_v’dÜ_­f_f‹r_pŞicy
[
SLSI_APF_ATTR_MAX
 + 1] = {

6035 [
SLSI_APF_ATTR_PROGRAM_LEN
] = {.
ty³
 = 
NLA_U32
},

6036 [
SLSI_APF_ATTR_PROGRAM
] = {.
ty³
 = 
NLA_BINARY
},

6039 cÚ¡ 
Æa_pŞicy


6040 
	g¦si_wÏn_v’dÜ_gsÿn_pŞicy
[
GSCAN_ATTRIBUTE_MAX
] = {

6041 [
GSCAN_ATTRIBUTE_NUM_BUCKETS
] = {.
ty³
 = 
NLA_U32
},

6042 [
GSCAN_ATTRIBUTE_BASE_PERIOD
] = {.
ty³
 = 
NLA_U32
},

6043 [
GSCAN_ATTRIBUTE_BUCKETS_BAND
] = {.
ty³
 = 
NLA_U32
},

6044 [
GSCAN_ATTRIBUTE_BUCKET_ID
] = {.
ty³
 = 
NLA_U32
},

6045 [
GSCAN_ATTRIBUTE_BUCKET_PERIOD
] = {.
ty³
 = 
NLA_U32
},

6046 [
GSCAN_ATTRIBUTE_BUCKET_NUM_CHANNELS
] = {.
ty³
 = 
NLA_U32
},

6047 [
GSCAN_ATTRIBUTE_BUCKET_CHANNELS
] = {.
ty³
 = 
NLA_NESTED
},

6048 [
GSCAN_ATTRIBUTE_NUM_AP_PER_SCAN
] = {.
ty³
 = 
NLA_U32
},

6049 [
GSCAN_ATTRIBUTE_REPORT_THRESHOLD
] = {.
ty³
 = 
NLA_U32
},

6050 [
GSCAN_ATTRIBUTE_REPORT_THRESHOLD_NUM_SCANS
] = {.
ty³
 = 
NLA_U32
},

6051 [
GSCAN_ATTRIBUTE_BUCKETS_BAND
] = {.
ty³
 = 
NLA_U32
},

6052 [
GSCAN_ATTRIBUTE_REPORT_EVENTS
] = {.
ty³
 = 
NLA_U32
},

6053 [
GSCAN_ATTRIBUTE_BUCKET_EXPONENT
] = {.
ty³
 = 
NLA_U32
},

6054 [
GSCAN_ATTRIBUTE_BUCKET_STEP_COUNT
] = {.
ty³
 = 
NLA_U32
},

6055 [
GSCAN_ATTRIBUTE_BUCKET_MAX_PERIOD
] = {.
ty³
 = 
NLA_U32
},

6056 [
GSCAN_ATTRIBUTE_CH_BUCKET_1
] = {.
ty³
 = 
NLA_NESTED
,

6057 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6058 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6059 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6063 [
GSCAN_ATTRIBUTE_CH_BUCKET_2
] = {.
ty³
 = 
NLA_NESTED
,

6064 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6065 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6066 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6070 [
GSCAN_ATTRIBUTE_CH_BUCKET_3
] = {.
ty³
 = 
NLA_NESTED
,

6071 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6072 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6073 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6077 [
GSCAN_ATTRIBUTE_CH_BUCKET_4
] = {.
ty³
 = 
NLA_NESTED
,

6078 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6079 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6080 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6084 [
GSCAN_ATTRIBUTE_CH_BUCKET_5
] = {.
ty³
 = 
NLA_NESTED
,

6085 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6086 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6087 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6091 [
GSCAN_ATTRIBUTE_CH_BUCKET_6
] = {.
ty³
 = 
NLA_NESTED
,

6092 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6093 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6094 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6098 [
GSCAN_ATTRIBUTE_CH_BUCKET_7
] = {.
ty³
 = 
NLA_NESTED
,

6099 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6100 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6101 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6105 [
GSCAN_ATTRIBUTE_CH_BUCKET_8
] = {.
ty³
 = 
NLA_NESTED
,

6106 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

6107 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6108 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

6112 [
GSCAN_ATTRIBUTE_NUM_OF_RESULTS
] = {.
ty³
 = 
NLA_U32
},

6113 [
GSCAN_ATTRIBUTE_NUM_BSSID
] = {.
ty³
 = 
NLA_U32
},

6114 [
GSCAN_ATTRIBUTE_BLACKLIST_BSSID
] = {.
ty³
 = 
NLA_BINARY
},

6115 [
GSCAN_ATTRIBUTE_BLACKLIST_FROM_SUPPLICANT
] = {.
ty³
 = 
NLA_U8
},

6118 cÚ¡ 
Æa_pŞicy


6119 
	g¦si_wÏn_v’dÜ_gsÿn_oui_pŞicy
[
SLSI_NL_ATTRIBUTE_MAC_OUI_MAX
] = {

6120 [
SLSI_NL_ATTRIBUTE_ND_OFFLOAD_VALUE
] = {.
ty³
 = 
NLA_U8
},

6121 [
SLSI_NL_ATTRIBUTE_PNO_RANDOM_MAC_OUI
] = {.
ty³
 = 
NLA_BINARY
},

6124 cÚ¡ 
Æa_pŞicy


6125 
	g¦si_wÏn_v’dÜ_•no_pŞicy
[
SLSI_ATTRIBUTE_EPNO_MAX
] = {

6126 [
SLSI_ATTRIBUTE_EPNO_MINIMUM_5G_RSSI
] = {.
ty³
 = 
NLA_U16
},

6127 [
SLSI_ATTRIBUTE_EPNO_MINIMUM_2G_RSSI
] = {.
ty³
 = 
NLA_U16
},

6128 [
SLSI_ATTRIBUTE_EPNO_INITIAL_SCORE_MAX
] = {.
ty³
 = 
NLA_U16
},

6129 [
SLSI_ATTRIBUTE_EPNO_CUR_CONN_BONUS
] = {.
ty³
 = 
NLA_U8
},

6130 [
SLSI_ATTRIBUTE_EPNO_SAME_NETWORK_BONUS
] = {.
ty³
 = 
NLA_U8
},

6131 [
SLSI_ATTRIBUTE_EPNO_SECURE_BONUS
] = {.
ty³
 = 
NLA_U8
},

6132 [
SLSI_ATTRIBUTE_EPNO_5G_BONUS
] = {.
ty³
 = 
NLA_U8
},

6133 [
SLSI_ATTRIBUTE_EPNO_SSID_LIST
] = {.
ty³
 = 
NLA_NESTED
},

6134 [
SLSI_ATTRIBUTE_EPNO_SSID_NUM
] = {.
ty³
 = 
NLA_U8
},

6137 cÚ¡ 
Æa_pŞicy


6138 
	g¦si_wÏn_v’dÜ_•no_hs_pŞicy
[
SLSI_ATTRIBUTE_EPNO_HS_MAX
] = {

6139 [
SLSI_ATTRIBUTE_EPNO_HS_PARAM_LIST
] = {.
ty³
 = 
NLA_NESTED_ARRAY
,

6140 .
	gËn
 = 
SLSI_ATTRIBUTE_EPNO_HS_MAX
,

6141 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6142 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_•no_hs_pŞicy
},

6146 [
SLSI_ATTRIBUTE_EPNO_HS_NUM
] = {.
ty³
 = 
NLA_U8
},

6147 [
SLSI_ATTRIBUTE_EPNO_HS_ID
] = {.
ty³
 = 
NLA_U32
},

6148 [
SLSI_ATTRIBUTE_EPNO_HS_REALM
] = {.
ty³
 = 
NLA_BINARY
},

6149 [
SLSI_ATTRIBUTE_EPNO_HS_CONSORTIUM_IDS
] = {.
ty³
 = 
NLA_BINARY
},

6150 [
SLSI_ATTRIBUTE_EPNO_HS_PLMN
] = {.
ty³
 = 
NLA_BINARY
},

6153 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


6154 cÚ¡ 
Æa_pŞicy


6155 
	g¦si_wÏn_v’dÜ_’hªûd_loggšg_pŞicy
[
SLSI_ENHANCED_LOGGING_ATTRIBUTE_MAX
] = {

6156 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6157 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_VERBOSE_LEVEL
] = {.
ty³
 = 
NLA_U32
},

6158 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_FLAGS
] = {.
ty³
 = 
NLA_U32
},

6159 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MAX_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

6160 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MIN_DATA_SIZE
] = {.
ty³
 = 
NLA_U32
},

6161 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
] = {.
ty³
 = 
NLA_U32
},

6162 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
] = {.
ty³
 = 
NLA_U64
},

6163 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
] = {.
ty³
 = 
NLA_U32
},

6164 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
] = {.
ty³
 = 
NLA_U64
},

6165 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_VERSION
] = {.
ty³
 = 
NLA_BINARY
},

6166 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_VERSION
] = {.
ty³
 = 
NLA_BINARY
},

6167 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
] = {.
ty³
 = 
NLA_U32
},

6168 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
] = {.
ty³
 = 
NLA_U64
},

6171 cÚ¡ 
Æa_pŞicy


6172 
	g¦si_wÏn_v’dÜ_wake_»asÚ_¡©s_pŞicy
[
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_MAX
] = {

6173 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_SZ
] = {.
ty³
 = 
NLA_U32
},

6174 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_SZ
] = {.
ty³
 = 
NLA_U32
},

6178 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


6179 cÚ¡ 
Æa_pŞicy


6180 
	g¦si_wÏn_v’dÜ_Çn_pŞicy
[
NAN_REQ_ATTR_MAX
 + 1] = {

6181 [
NAN_REQ_ATTR_MASTER_PREF
] = {.
ty³
 = 
NLA_U8
},

6182 [
NAN_REQ_ATTR_CLUSTER_LOW
] = {.
ty³
 = 
NLA_U16
},

6183 [
NAN_REQ_ATTR_CLUSTER_HIGH
] = {.
ty³
 = 
NLA_U16
},

6184 [
NAN_REQ_ATTR_HOP_COUNT_LIMIT_VAL
] = {.
ty³
 = 
NLA_U8
},

6185 [
NAN_REQ_ATTR_SID_BEACON_VAL
] = {.
ty³
 = 
NLA_U8
},

6186 [
NAN_REQ_ATTR_SUPPORT_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

6187 [
NAN_REQ_ATTR_SUPPORT_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

6188 [
NAN_REQ_ATTR_RSSI_CLOSE_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

6189 [
NAN_REQ_ATTR_RSSI_MIDDLE_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

6190 [
NAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

6191 [
NAN_REQ_ATTR_BEACONS_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

6192 [
NAN_REQ_ATTR_SDF_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

6193 [
NAN_REQ_ATTR_CHANNEL_2G4_MHZ_VAL
] = {.
ty³
 = 
NLA_U32
},

6194 [
NAN_REQ_ATTR_RSSI_PROXIMITY_VAL
] = {.
ty³
 = 
NLA_U32
},

6195 [
NAN_REQ_ATTR_RSSI_CLOSE_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

6196 [
NAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

6197 [
NAN_REQ_ATTR_RSSI_MIDDLE_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

6198 [
NAN_REQ_ATTR_RSSI_PROXIMITY_5G_VAL
] = {.
ty³
 = 
NLA_U32
},

6199 [
NAN_REQ_ATTR_BEACON_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

6200 [
NAN_REQ_ATTR_SDF_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

6201 [
NAN_REQ_ATTR_CHANNEL_5G_MHZ_VAL
] = {.
ty³
 = 
NLA_U32
},

6202 [
NAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
] = {.
ty³
 = 
NLA_U8
},

6203 [
NAN_REQ_ATTR_OUI_VAL
] = {.
ty³
 = 
NLA_U32
},

6204 [
NAN_REQ_ATTR_MAC_ADDR_VAL
] = {.
ty³
 = 
NLA_BINARY
,

6205 .
	gËn
 = 
ETH_ALEN
},

6206 [
NAN_REQ_ATTR_CLUSTER_VAL
] = {.
ty³
 = 
NLA_U8
},

6207 [
NAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
] = {.
ty³
 = 
NLA_BINARY
,

6208 .
	gËn
 = 
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
},

6209 [
NAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
] = {.
ty³
 = 
NLA_BINARY
,

6210 .
	gËn
 = 
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
 * (
u16
)},

6211 [
NAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
] = {.
ty³
 = 
NLA_U8
},

6212 [
NAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
] = {.
ty³
 = 
NLA_U8
},

6213 [
NAN_REQ_ATTR_CONN_CAPABILITY_PAYLOAD_TX
] = {.
ty³
 = 
NLA_U8
},

6214 [
NAN_REQ_ATTR_CONN_CAPABILITY_IBSS
] = {.
ty³
 = 
NLA_U8
},

6215 [
NAN_REQ_ATTR_CONN_CAPABILITY_WFD
] = {.
ty³
 = 
NLA_U8
},

6216 [
NAN_REQ_ATTR_CONN_CAPABILITY_WFDS
] = {.
ty³
 = 
NLA_U8
},

6217 [
NAN_REQ_ATTR_CONN_CAPABILITY_TDLS
] = {.
ty³
 = 
NLA_U8
},

6218 [
NAN_REQ_ATTR_CONN_CAPABILITY_MESH
] = {.
ty³
 = 
NLA_U8
},

6219 [
NAN_REQ_ATTR_CONN_CAPABILITY_WLAN_INFRA
] = {.
ty³
 = 
NLA_U8
},

6220 [
NAN_REQ_ATTR_DISCOVERY_ATTR_NUM_ENTRIES
] = {.
ty³
 = 
NLA_U8
},

6221 [
NAN_REQ_ATTR_DISCOVERY_ATTR_VAL
] = {.
ty³
 = 
NLA_NESTED
,

6222 .
	gËn
 = 
NAN_REQ_ATTR_MAX
,

6223 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6224 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_Çn_pŞicy
},

6228 [
NAN_REQ_ATTR_CONN_TYPE
] = {.
ty³
 = 
NLA_U8
},

6229 [
NAN_REQ_ATTR_NAN_ROLE
] = {.
ty³
 = 
NLA_U8
},

6230 [
NAN_REQ_ATTR_TRANSMIT_FREQ
] = {.
ty³
 = 
NLA_U8
},

6231 [
NAN_REQ_ATTR_AVAILABILITY_DURATION
] = {.
ty³
 = 
NLA_U8
},

6232 [
NAN_REQ_ATTR_AVAILABILITY_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

6233 [
NAN_REQ_ATTR_MESH_ID_LEN
] = {.
ty³
 = 
NLA_U16
},

6234 [
NAN_REQ_ATTR_MESH_ID
] = {.
ty³
 = 
NLA_BINARY
},

6235 [
NAN_REQ_ATTR_INFRASTRUCTURE_SSID_LEN
] = {.
ty³
 = 
NLA_U16
},

6236 [
NAN_REQ_ATTR_INFRASTRUCTURE_SSID
] = {.
ty³
 = 
NLA_BINARY
},

6237 [
NAN_REQ_ATTR_FURTHER_AVAIL_NUM_ENTRIES
] = {.
ty³
 = 
NLA_U8
},

6238 [
NAN_REQ_ATTR_FURTHER_AVAIL_VAL
] = {.
ty³
 = 
NLA_NESTED
,

6239 .
	gËn
 = 
NAN_REQ_ATTR_MAX
,

6240 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6241 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_Çn_pŞicy
},

6245 [
NAN_REQ_ATTR_FURTHER_AVAIL_ENTRY_CTRL
] = {.
ty³
 = 
NLA_U8
},

6246 [
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_CLASS
] = {.
ty³
 = 
NLA_U8
},

6247 [
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN
] = {.
ty³
 = 
NLA_U8
},

6248 [
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_MAPID
] = {.
ty³
 = 
NLA_U8
},

6249 [
NAN_REQ_ATTR_FURTHER_AVAIL_INTERVAL_BITMAP
] = {.
ty³
 = 
NLA_U32
},

6250 [
NAN_REQ_ATTR_PUBLISH_ID
] = {.
ty³
 = 
NLA_U16
},

6251 [
NAN_REQ_ATTR_PUBLISH_TTL
] = {.
ty³
 = 
NLA_U16
},

6252 [
NAN_REQ_ATTR_PUBLISH_PERIOD
] = {.
ty³
 = 
NLA_U16
},

6253 [
NAN_REQ_ATTR_PUBLISH_TYPE
] = {.
ty³
 = 
NLA_U8
},

6254 [
NAN_REQ_ATTR_PUBLISH_TX_TYPE
] = {.
ty³
 = 
NLA_U8
},

6255 [
NAN_REQ_ATTR_PUBLISH_COUNT
] = {.
ty³
 = 
NLA_U8
},

6256 [
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U16
},

6257 [
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6258 [
NAN_REQ_ATTR_PUBLISH_MATCH_ALGO
] = {.
ty³
 = 
NLA_U8
},

6259 [
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO_LEN
] = {.
ty³
 = 
NLA_U16
},

6260 [
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO
] = {.
ty³
 = 
NLA_BINARY
},

6261 [
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6262 [
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6263 [
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6264 [
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6265 [
NAN_REQ_ATTR_PUBLISH_RSSI_THRESHOLD_FLAG
] = {.
ty³
 = 
NLA_U8
},

6266 [
NAN_REQ_ATTR_PUBLISH_CONN_MAP
] = {.
ty³
 = 
NLA_U8
},

6267 [
NAN_REQ_ATTR_PUBLISH_RECV_IND_CFG
] = {.
ty³
 = 
NLA_U8
},

6268 [
NAN_REQ_ATTR_SUBSCRIBE_ID
] = {.
ty³
 = 
NLA_U16
},

6269 [
NAN_REQ_ATTR_SUBSCRIBE_TTL
] = {.
ty³
 = 
NLA_U16
},

6270 [
NAN_REQ_ATTR_SUBSCRIBE_PERIOD
] = {.
ty³
 = 
NLA_U16
},

6271 [
NAN_REQ_ATTR_SUBSCRIBE_TYPE
] = {.
ty³
 = 
NLA_U8
},

6272 [
NAN_REQ_ATTR_SUBSCRIBE_RESP_FILTER_TYPE
] = {.
ty³
 = 
NLA_U8
},

6273 [
NAN_REQ_ATTR_SUBSCRIBE_RESP_INCLUDE
] = {.
ty³
 = 
NLA_U8
},

6274 [
NAN_REQ_ATTR_SUBSCRIBE_USE_RESP_FILTER
] = {.
ty³
 = 
NLA_U8
},

6275 [
NAN_REQ_ATTR_SUBSCRIBE_SSI_REQUIRED
] = {.
ty³
 = 
NLA_U8
},

6276 [
NAN_REQ_ATTR_SUBSCRIBE_MATCH_INDICATOR
] = {.
ty³
 = 
NLA_U8
},

6277 [
NAN_REQ_ATTR_SUBSCRIBE_COUNT
] = {.
ty³
 = 
NLA_U8
},

6278 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U16
},

6279 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6280 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO_LEN
] = {.
ty³
 = 
NLA_U16
},

6281 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO
] = {.
ty³
 = 
NLA_BINARY
},

6282 [
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6283 [
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6284 [
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6285 [
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6286 [
NAN_REQ_ATTR_SUBSCRIBE_RSSI_THRESHOLD_FLAG
] = {.
ty³
 = 
NLA_U8
},

6287 [
NAN_REQ_ATTR_SUBSCRIBE_CONN_MAP
] = {.
ty³
 = 
NLA_U8
},

6288 [
NAN_REQ_ATTR_SUBSCRIBE_NUM_INTF_ADDR_PRESENT
] = {.
ty³
 = 
NLA_U8
},

6289 [
NAN_REQ_ATTR_SUBSCRIBE_INTF_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

6290 .
	gËn
 = 
SLSI_HAL_NAN_MAX_SUBSCRIBE_MAX_ADDRESS
 * 
ETH_ALEN
},

6291 [
NAN_REQ_ATTR_SUBSCRIBE_RECV_IND_CFG
] = {.
ty³
 = 
NLA_U8
},

6292 [
NAN_REQ_ATTR_FOLLOWUP_ID
] = {.
ty³
 = 
NLA_U16
},

6293 [
NAN_REQ_ATTR_FOLLOWUP_REQUESTOR_ID
] = {.
ty³
 = 
NLA_U32
},

6294 [
NAN_REQ_ATTR_FOLLOWUP_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

6295 .
	gËn
 = 
ETH_ALEN
},

6296 [
NAN_REQ_ATTR_FOLLOWUP_PRIORITY
] = {.
ty³
 = 
NLA_U8
},

6297 [
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U16
},

6298 [
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6299 [
NAN_REQ_ATTR_FOLLOWUP_TX_WINDOW
] = {.
ty³
 = 
NLA_U8
},

6300 [
NAN_REQ_ATTR_FOLLOWUP_RECV_IND_CFG
] = {.
ty³
 = 
NLA_U8
},

6301 [
NAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
] = {.
ty³
 = 
NLA_U8
},

6302 [
NAN_REQ_ATTR_DW_2G4_INTERVAL
] = {.
ty³
 = 
NLA_U8
},

6303 [
NAN_REQ_ATTR_DW_5G_INTERVAL
] = {.
ty³
 = 
NLA_U8
},

6304 [
NAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

6305 [
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
] = {.
ty³
 = 
NLA_U16
},

6306 [
NAN_REQ_ATTR_PUBLISH_SDEA
] = {.
ty³
 = 
NLA_BINARY
},

6307 [
NAN_REQ_ATTR_RANGING_AUTO_RESPONSE
] = {.
ty³
 = 
NLA_U8
},

6308 [
NAN_REQ_ATTR_SDEA_PARAM_NDP_TYPE
] = {.
ty³
 = 
NLA_U8
},

6309 [
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
] = {.
ty³
 = 
NLA_U8
},

6310 [
NAN_REQ_ATTR_SDEA_PARAM_RANGING_STATE
] = {.
ty³
 = 
NLA_U8
},

6311 [
NAN_REQ_ATTR_SDEA_PARAM_RANGE_REPORT
] = {.
ty³
 = 
NLA_U8
},

6312 [
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
] = {.
ty³
 = 
NLA_U8
},

6313 [
NAN_REQ_ATTR_RANGING_CFG_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

6314 [
NAN_REQ_ATTR_RANGING_CFG_INDICATION
] = {.
ty³
 = 
NLA_U32
},

6315 [
NAN_REQ_ATTR_RANGING_CFG_INGRESS_MM
] = {.
ty³
 = 
NLA_U32
},

6316 [
NAN_REQ_ATTR_RANGING_CFG_EGRESS_MM
] = {.
ty³
 = 
NLA_U32
},

6317 [
NAN_REQ_ATTR_CIPHER_TYPE
] = {.
ty³
 = 
NLA_U32
},

6318 [
NAN_REQ_ATTR_SCID_LEN
] = {.
ty³
 = 
NLA_U32
},

6319 [
NAN_REQ_ATTR_SCID
] = {.
ty³
 = 
NLA_BINARY
},

6320 [
NAN_REQ_ATTR_SECURITY_KEY_TYPE
] = {.
ty³
 = 
NLA_U32
},

6321 [
NAN_REQ_ATTR_SECURITY_PMK_LEN
] = {.
ty³
 = 
NLA_U32
},

6322 [
NAN_REQ_ATTR_SECURITY_PMK
] = {.
ty³
 = 
NLA_BINARY
},

6323 [
NAN_REQ_ATTR_SECURITY_PASSPHRASE_LEN
] = {.
ty³
 = 
NLA_U32
},

6324 [
NAN_REQ_ATTR_SECURITY_PASSPHRASE
] = {.
ty³
 = 
NLA_BINARY
},

6325 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PUBLISH_ID
] = {.
ty³
 = 
NLA_U16
},

6326 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_REQUESTOR_ID
] = {.
ty³
 = 
NLA_U32
},

6327 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PEER_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

6328 .
	gËn
 = 
ETH_ALEN
},

6329 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_RANGING_RESPONSE
] = {.
ty³
 = 
NLA_U16
},

6330 [
NAN_REQ_ATTR_REQ_INSTANCE_ID
] = {.
ty³
 = 
NLA_U32
},

6331 [
NAN_REQ_ATTR_NDP_INSTANCE_ID
] = {.
ty³
 = 
NLA_U32
},

6332 [
NAN_REQ_ATTR_CHAN_REQ_TYPE
] = {.
ty³
 = 
NLA_U8
},

6333 [
NAN_REQ_ATTR_CHAN
] = {.
ty³
 = 
NLA_U32
},

6334 [
NAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
] = {.
ty³
 = 
NLA_U8
},

6335 [
NAN_REQ_ATTR_DATA_INTERFACE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6336 [
NAN_REQ_ATTR_APP_INFO_LEN
] = {.
ty³
 = 
NLA_U16
},

6337 [
NAN_REQ_ATTR_APP_INFO
] = {.
ty³
 = 
NLA_BINARY
},

6338 [
NAN_REQ_ATTR_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U32
},

6339 [
NAN_REQ_ATTR_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6340 [
NAN_REQ_ATTR_NDP_RESPONSE_CODE
] = {.
ty³
 = 
NLA_U8
},

6341 [
NAN_REQ_ATTR_USE_NDPE_ATTR
] = {.
ty³
 = 
NLA_U32
},

6342 [
NAN_REQ_ATTR_HAL_TRANSACTION_ID
] = {.
ty³
 = 
NLA_U16
},

6343 [
NAN_REQ_ATTR_CONFIG_DISC_MAC_ADDR_RANDOM
] = {.
ty³
 = 
NLA_U8
},

6344 [
NAN_REQ_ATTR_DISCOVERY_BEACON_INT
] = {.
ty³
 = 
NLA_U32
},

6345 [
NAN_REQ_ATTR_NSS
] = {.
ty³
 = 
NLA_U32
},

6346 [
NAN_REQ_ATTR_ENABLE_RANGING
] = {.
ty³
 = 
NLA_U32
},

6347 [
NAN_REQ_ATTR_DW_EARLY_TERMINATION
] = {.
ty³
 = 
NLA_U32
},

6352 
why_v’dÜ_commªd
 
	g¦si_v’dÜ_cmd
[] = {

6355 .
v’dÜ_id
 = 
OUI_GOOGLE
,

6356 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_CAPABILITIES


6358 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6359 .
	gdo™
 = 
¦si_gsÿn_g‘_ÿ·b™›s


6363 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6364 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_VALID_CHANNELS


6366 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6367 .
	gdo™
 = 
¦si_gsÿn_g‘_v®id_chªÃl


6371 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6372 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN


6374 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6375 .
	gdo™
 = 
¦si_gsÿn_add


6379 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6380 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_DEL_GSCAN


6382 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6383 .
	gdo™
 = 
¦si_gsÿn_d–


6387 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6388 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_SCAN_RESULTS


6390 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6391 .
	gdo™
 = 
¦si_gsÿn_g‘_sÿn_»suÉs


6395 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6396 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_GSCAN_OUI


6398 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6399 .
	gdo™
 = 
¦si_gsÿn_£t_oui


6401 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


6404 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6405 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_SET_KEY


6407 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6408 .
	gdo™
 = 
¦si_key_mgmt_£t_pmk


6413 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6414 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_DEFAULT_SCAN_IES


6416 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6417 .
	gdo™
 = 
¦si_£t_v’dÜ_›


6421 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6422 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST


6424 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6425 .
	gdo™
 = 
¦si_£t_bssid_bÏckli¡


6429 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6430 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST


6432 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6433 .
	gdo™
 = 
¦si_£t_bssid_bÏckli¡


6437 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6438 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_START_KEEP_ALIVE_OFFLOAD


6440 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6441 .
	gdo™
 = 
¦si_¡¬t_k“·live_ofæßd


6445 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6446 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_STOP_KEEP_ALIVE_OFFLOAD


6448 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6449 .
	gdo™
 = 
¦si_¡İ_k“·live_ofæßd


6453 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6454 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_EPNO_LIST


6456 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6457 .
	gdo™
 = 
¦si_£t_•no_ssid


6461 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6462 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_HS_LIST


6464 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6465 .
	gdo™
 = 
¦si_£t_hs_·¿ms


6469 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6470 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RESET_HS_LIST


6472 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6473 .
	gdo™
 = 
¦si_»£t_hs_·¿ms


6477 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6478 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_RSSI_MONITOR


6480 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6481 .
	gdo™
 = 
¦si_£t_rssi_mÚ™Ü


6485 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6486 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_SET_STATS


6488 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6489 .
	gdo™
 = 
¦si_Îs_£t_¡©s


6493 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6494 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_GET_STATS


6496 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6497 .
	gdo™
 = 
¦si_Îs_g‘_¡©s


6501 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6502 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_CLEAR_STATS


6504 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6505 .
	gdo™
 = 
¦si_Îs_ş—r_¡©s


6509 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6510 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE_SET


6512 .
	gæags
 = 0,

6513 .
	gdo™
 = 
¦si_g‘_ã©u»_£t


6517 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6518 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_COUNTRY_CODE


6520 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6521 .
	gdo™
 = 
¦si_£t_couÁry_code


6523 #ià
IS_ENABLED
(
CONFIG_IPV6
)

6526 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6527 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_CONFIGURE_ND_OFFLOAD


6529 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6530 .
	gdo™
 = 
¦si_cÚfigu»_nd_ofæßd


6533 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


6536 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6537 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_START_LOGGING


6539 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6540 .
	gdo™
 = 
¦si_¡¬t_loggšg


6544 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6545 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RESET_LOGGING


6547 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6548 .
	gdo™
 = 
¦si_»£t_loggšg


6552 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6553 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_FW_MEM_DUMP


6555 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6556 .
	gdo™
 = 
¦si_Œigg”_fw_mem_dump


6560 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6561 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_FW_MEM_DUMP


6563 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6564 .
	gdo™
 = 
¦si_g‘_fw_mem_dump


6568 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6569 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_DRIVER_MEM_DUMP


6571 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6572 .
	gdo™
 = 
¦si_Œigg”_driv”_mem_dump


6576 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6577 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_DRIVER_MEM_DUMP


6579 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6580 .
	gdo™
 = 
¦si_g‘_driv”_mem_dump


6584 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6585 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_VERSION


6587 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6588 .
	gdo™
 = 
¦si_g‘_v”siÚ


6592 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6593 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_STATUS


6595 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6596 .
	gdo™
 = 
¦si_g‘_ršg_bufãrs_¡©us


6600 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6601 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_DATA


6603 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6604 .
	gdo™
 = 
¦si_g‘_ršg_d©a


6608 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6609 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE


6611 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6612 .
	gdo™
 = 
¦si_g‘_logg”_suµÜ‹d_ã©u»_£t


6616 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6617 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_START_PKT_FATE_MONITORING


6619 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6620 .
	gdo™
 = 
¦si_¡¬t_pkt_ç‹_mÚ™Üšg


6624 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6625 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_TX_PKT_FATES


6627 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6628 .
	gdo™
 = 
¦si_g‘_tx_pkt_ç‹s


6632 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6633 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_RX_PKT_FATES


6635 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6636 .
	gdo™
 = 
¦si_g‘_rx_pkt_ç‹s


6640 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6641 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_WAKE_REASON_STATS


6643 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6644 .
	gdo™
 = 
¦si_g‘_wake_»asÚ_¡©s


6647 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


6650 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6651 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_ENABLE


6653 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6654 .
	gdo™
 = 
¦si_Çn_’abË


6658 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6659 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DISABLE


6661 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6662 .
	gdo™
 = 
¦si_Çn_di§bË


6666 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6667 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISH


6669 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6670 .
	gdo™
 = 
¦si_Çn_publish


6674 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6675 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISHCANCEL


6677 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6678 .
	gdo™
 = 
¦si_Çn_publish_ÿnûl


6682 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6683 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBE


6685 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6686 .
	gdo™
 = 
¦si_Çn_subsüibe


6690 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6691 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBECANCEL


6693 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6694 .
	gdo™
 = 
¦si_Çn_subsüibe_ÿnûl


6698 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6699 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_TXFOLLOWUP


6701 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6702 .
	gdo™
 = 
¦si_Çn_Œªsm™_fŞlowup


6706 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6707 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CONFIG


6709 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6710 .
	gdo™
 = 
¦si_Çn_£t_cÚfig


6714 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6715 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CAPABILITIES


6717 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6718 .
	gdo™
 = 
¦si_Çn_g‘_ÿ·b™›s


6723 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6724 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_CREATE


6726 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6727 .
	gdo™
 = 
¦si_Çn_d©a_içû_ü—‹


6731 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6732 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_DELETE


6734 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6735 .
	gdo™
 = 
¦si_Çn_d©a_içû_d–‘e


6739 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6740 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_REQUEST_INITIATOR


6742 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6743 .
	gdo™
 = 
¦si_Çn_ndp_š™Ÿ‹


6747 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6748 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INDICATION_RESPONSE


6750 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6751 .
	gdo™
 = 
¦si_Çn_ndp_»¥Úd


6755 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6756 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_END


6758 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6759 .
	gdo™
 = 
¦si_Çn_ndp_’d


6764 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6765 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_ROAMING_CAPABILITIES


6767 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6768 .
	gdo™
 = 
¦si_g‘_rßmšg_ÿ·b™›s


6772 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6773 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_ROAMING_STATE


6775 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6776 .
	gdo™
 = 
¦si_£t_rßmšg_¡©e


6780 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6781 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RTT_GET_CAPABILITIES


6783 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6784 .
	gdo™
 = 
¦si_¹t_g‘_ÿ·b™›s


6788 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6789 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_START


6791 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6792 .
	gdo™
 = 
¦si_¹t_£t_cÚfig


6796 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6797 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_CANCEL


6799 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6800 .
	gdo™
 = 
¦si_¹t_ÿnûl_cÚfig


6804 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6805 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_ACS_INIT


6807 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6808 .
	gdo™
 = 
¦si_acs_š™


6812 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6813 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_APF_GET_CAPABILITIES


6815 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6816 .
	gdo™
 = 
¦si_­f_g‘_ÿ·b™›s


6820 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6821 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_APF_SET_FILTER


6823 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6824 .
	gdo™
 = 
¦si_­f_£t_f‹r


6828 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6829 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_APF_READ_FILTER


6831 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6832 .
	gdo™
 = 
¦si_­f_»ad_f‹r


6836 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6837 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_LATENCY_MODE


6839 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6840 .
	gdo™
 = 
¦si_cÚfigu»_Ï‹ncy_mode


6844 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6845 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_DTIM_CONFIG


6847 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6848 .
	gdo™
 = 
¦si_£t_dtim_cÚfig


6851 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


6854 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6855 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SELECT_TX_POWER_SCENARIO


6857 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6858 .
	gdo™
 = 
¦si_£Ëù_tx_pow”_sûÇrio


6862 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6863 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RESET_TX_POWER_SCENARIO


6865 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6866 .
	gdo™
 = 
¦si_»£t_tx_pow”_sûÇrio


6871 
	$¦si_Æ80211_v’dÜ_deš™
(
¦si_dev
 *
sdev
)

6873 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "De-initialise vendor command‡ndƒvents\n");

6874 
sdev
->
why
->
v’dÜ_commªds
 = 
NULL
;

6875 
sdev
->
why
->
n_v’dÜ_commªds
 = 0;

6876 
sdev
->
why
->
v’dÜ_ev’ts
 = 
NULL
;

6877 
sdev
->
why
->
n_v’dÜ_ev’ts
 = 0;

6879 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "Gscan cleanup\n");

6880 
	`¦si_gsÿn_æush_sÿn_»suÉs
(
sdev
);

6881 
	}
}

6883 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

6884 
	$¦si_Æl80211_v’dÜ_š™_pŞicy
(
why_v’dÜ_commªd
 *
¦si_v’dÜ_cmd
, 
n_v’dÜ_commªds
)

6886 
i
;

6887 
why_v’dÜ_commªd
 *
vcmd
;

6889 
i
 = 0; i < 
n_v’dÜ_commªds
; i++) {

6890 
vcmd
 = &
¦si_v’dÜ_cmd
[
i
];

6891 
vcmd
->
šfo
.
subcmd
) {

6892 
SLSI_NL80211_VENDOR_SUBCMD_GET_CAPABILITIES
:

6893 
SLSI_NL80211_VENDOR_SUBCMD_DEL_GSCAN
:

6894 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6895 
vcmd
->
max©Œ
 = 0;

6897 
SLSI_NL80211_VENDOR_SUBCMD_GET_VALID_CHANNELS
:

6898 
SLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN
:

6899 
SLSI_NL80211_VENDOR_SUBCMD_GET_SCAN_RESULTS
:

6900 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
;

6901 
vcmd
->
max©Œ
 = 
GSCAN_ATTRIBUTE_MAX
;

6903 
SLSI_NL80211_VENDOR_SUBCMD_SET_GSCAN_OUI
:

6904 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_oui_pŞicy
;

6905 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_MAC_OUI_MAX
;

6907 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


6908 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_SET_KEY
:

6909 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6910 
vcmd
->
max©Œ
 = 0;

6913 
SLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST
:

6914 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
;

6915 
vcmd
->
max©Œ
 = 
GSCAN_ATTRIBUTE_MAX
;

6917 
SLSI_NL80211_VENDOR_SUBCMD_START_KEEP_ALIVE_OFFLOAD
:

6918 
SLSI_NL80211_VENDOR_SUBCMD_STOP_KEEP_ALIVE_OFFLOAD
:

6919 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_¡¬t_k“·live_ofæßd_pŞicy
;

6920 
vcmd
->
max©Œ
 = 
MKEEP_ALIVE_ATTRIBUTE_MAX
;

6922 
SLSI_NL80211_VENDOR_SUBCMD_SET_EPNO_LIST
:

6923 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_•no_pŞicy
;

6924 
vcmd
->
max©Œ
 = 
SLSI_ATTRIBUTE_EPNO_MAX
;

6926 
SLSI_NL80211_VENDOR_SUBCMD_SET_HS_LIST
:

6927 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_•no_hs_pŞicy
;

6928 
vcmd
->
max©Œ
 = 
SLSI_ATTRIBUTE_EPNO_HS_MAX
;

6930 
SLSI_NL80211_VENDOR_SUBCMD_RESET_HS_LIST
:

6931 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6932 
vcmd
->
max©Œ
 = 0;

6934 
SLSI_NL80211_VENDOR_SUBCMD_SET_RSSI_MONITOR
:

6935 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_rssi_mÚ™Ü
;

6936 
vcmd
->
max©Œ
 = 
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX
;

6938 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_SET_STATS
:

6939 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_Îs_pŞicy
;

6940 
vcmd
->
max©Œ
 = 
LLS_ATTRIBUTE_MAX
;

6942 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_GET_STATS
:

6943 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_Îs_pŞicy
;

6944 
vcmd
->
max©Œ
 = 
LLS_ATTRIBUTE_MAX
;

6946 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_CLEAR_STATS
:

6947 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_Îs_pŞicy
;

6948 
vcmd
->
max©Œ
 = 
LLS_ATTRIBUTE_MAX
;

6950 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE_SET
:

6951 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6952 
vcmd
->
max©Œ
 = 0;

6954 
SLSI_NL80211_VENDOR_SUBCMD_SET_COUNTRY_CODE
:

6955 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_couÁry_code_pŞicy
;

6956 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_COUNTRY_CODE_MAX
;

6958 
SLSI_NL80211_VENDOR_SUBCMD_CONFIGURE_ND_OFFLOAD
:

6959 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_oui_pŞicy
;

6960 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_MAC_OUI_MAX
;

6962 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


6963 
SLSI_NL80211_VENDOR_SUBCMD_RESET_LOGGING
:

6964 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_FW_MEM_DUMP
:

6965 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_DRIVER_MEM_DUMP
:

6966 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_STATUS
:

6967 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE
:

6968 
SLSI_NL80211_VENDOR_SUBCMD_START_PKT_FATE_MONITORING
:

6969 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6970 
vcmd
->
max©Œ
 = 0;

6972 
SLSI_NL80211_VENDOR_SUBCMD_START_LOGGING
:

6973 
SLSI_NL80211_VENDOR_SUBCMD_GET_FW_MEM_DUMP
:

6974 
SLSI_NL80211_VENDOR_SUBCMD_GET_DRIVER_MEM_DUMP
:

6975 
SLSI_NL80211_VENDOR_SUBCMD_GET_VERSION
:

6976 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_DATA
:

6977 
SLSI_NL80211_VENDOR_SUBCMD_GET_TX_PKT_FATES
:

6978 
SLSI_NL80211_VENDOR_SUBCMD_GET_RX_PKT_FATES
:

6979 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_’hªûd_loggšg_pŞicy
;

6980 
vcmd
->
max©Œ
 = 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_MAX
;

6982 
SLSI_NL80211_VENDOR_SUBCMD_GET_WAKE_REASON_STATS
:

6983 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_wake_»asÚ_¡©s_pŞicy
;

6984 
vcmd
->
max©Œ
 = 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_MAX
;

6987 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


6988 
SLSI_NL80211_VENDOR_SUBCMD_NAN_ENABLE
:

6989 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DISABLE
:

6990 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISH
:

6991 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISHCANCEL
:

6992 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBE
:

6993 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBECANCEL
:

6994 
SLSI_NL80211_VENDOR_SUBCMD_NAN_TXFOLLOWUP
:

6995 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CONFIG
:

6996 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CAPABILITIES
:

6997 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_CREATE
:

6998 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_DELETE
:

6999 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_REQUEST_INITIATOR
:

7000 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INDICATION_RESPONSE
:

7001 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_END
:

7002 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_Çn_pŞicy
;

7003 
vcmd
->
max©Œ
 = 
NAN_REQ_ATTR_MAX
;

7006 
SLSI_NL80211_VENDOR_SUBCMD_GET_ROAMING_CAPABILITIES
:

7007 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

7008 
vcmd
->
max©Œ
 = 0;

7010 
SLSI_NL80211_VENDOR_SUBCMD_SET_ROAMING_STATE
:

7011 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_rßm_¡©e_pŞicy
;

7012 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTR_ROAM_MAX
;

7014 
SLSI_NL80211_VENDOR_SUBCMD_RTT_GET_CAPABILITIES
:

7015 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

7016 
vcmd
->
max©Œ
 = 0;

7018 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_START
:

7019 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_CANCEL
:

7020 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_¹t_pŞicy
;

7021 
vcmd
->
max©Œ
 = 
SLSI_RTT_ATTRIBUTE_MAX
;

7023 
SLSI_NL80211_VENDOR_SUBCMD_ACS_INIT
:

7024 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_acs_pŞicy
;

7025 
vcmd
->
max©Œ
 = 
SLSI_ACS_ATTR_MAX
;

7027 
SLSI_NL80211_VENDOR_SUBCMD_DEFAULT_SCAN_IES
:

7028 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_deçuÉ_sÿn_pŞicy
;

7029 
vcmd
->
max©Œ
 = 
SLSI_SCAN_DEFAULT_MAX
;

7031 
SLSI_NL80211_VENDOR_SUBCMD_APF_GET_CAPABILITIES
:

7032 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

7033 
vcmd
->
max©Œ
 = 0;

7035 
SLSI_NL80211_VENDOR_SUBCMD_APF_SET_FILTER
:

7036 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_­f_f‹r_pŞicy
;

7037 
vcmd
->
max©Œ
 = 
SLSI_APF_ATTR_MAX
;

7039 
SLSI_NL80211_VENDOR_SUBCMD_APF_READ_FILTER
:

7040 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

7041 
vcmd
->
max©Œ
 = 0;

7043 
SLSI_NL80211_VENDOR_SUBCMD_SET_LATENCY_MODE
:

7044 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_low_Ï‹ncy_pŞicy
;

7045 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_LATENCY_MAX
;

7047 
SLSI_NL80211_VENDOR_SUBCMD_SET_DTIM_CONFIG
:

7048 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_dtim_pŞicy
;

7049 
vcmd
->
max©Œ
 = 
SLSI_VENDOR_ATTR_DTIM_MAX
;

7051 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


7052 
SLSI_NL80211_VENDOR_SUBCMD_SELECT_TX_POWER_SCENARIO
:

7053 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_tx_pow”_sûÇrio_pŞicy
;

7054 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO_MAX
;

7056 
SLSI_NL80211_VENDOR_SUBCMD_RESET_TX_POWER_SCENARIO
:

7057 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

7058 
vcmd
->
max©Œ
 = 0;

7063 
	}
}

7066 
	$¦si_Æ80211_v’dÜ_š™
(
¦si_dev
 *
sdev
)

7068 
i
;

7070 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "Init vendor command‡ndƒvents\n");

7072 
sdev
->
why
->
v’dÜ_commªds
 = (cÚ¡ 
why_v’dÜ_commªd
 *)
¦si_v’dÜ_cmd
;

7073 
sdev
->
why
->
n_v’dÜ_commªds
 = 
	`ARRAY_SIZE
(
¦si_v’dÜ_cmd
);

7074 
sdev
->
why
->
v’dÜ_ev’ts
 = 
¦si_v’dÜ_ev’ts
;

7075 
sdev
->
why
->
n_v’dÜ_ev’ts
 = 
	`ARRAY_SIZE
(
¦si_v’dÜ_ev’ts
);

7077 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 3, 0))

7078 
	`¦si_Æl80211_v’dÜ_š™_pŞicy
(
¦si_v’dÜ_cmd
, 
sdev
->
why
->
n_v’dÜ_commªds
);

7081 
i
 = 0; i < 
SLSI_GSCAN_MAX_BUCKETS
; i++)

7082 
sdev
->
buck‘
[
i
].
sÿn_id
 = (
SLSI_GSCAN_SCAN_ID_START
 + i);

7084 
i
 = 0; i < 
SLSI_GSCAN_HASH_TABLE_SIZE
; i++)

7085 
sdev
->
gsÿn_hash_bË
[
i
] = 
NULL
;

7087 
	`INIT_LIST_HEAD
(&
sdev
->
hÙli¡_»suÉs
);

7088 
	}
}

	@nl80211_vendor.h

7 
	~"Æ80211_v’dÜ_Çn.h
"

9 #iâdeà
__SLSI_NL80211_VENDOR_H_


10 
	#__SLSI_NL80211_VENDOR_H_


	)

12 
	#OUI_GOOGLE
 0x001A11

	)

13 
	#OUI_SAMSUNG
 0x0000f0

	)

14 
	#SLSI_NL80211_GSCAN_SUBCMD_RANGE_START
 0x1000

	)

15 
	#SLSI_NL80211_GSCAN_EVENT_RANGE_START
 0x01

	)

16 
	#SLSI_NL80211_RTT_SUBCMD_RANGE_START
 0x1100

	)

17 
	#SLSI_NL80211_LOGGING_SUBCMD_RANGE_START
 0x1400

	)

18 
	#SLSI_NL80211_NAN_SUBCMD_RANGE_START
 0x1500

	)

19 
	#SLSI_NL80211_APF_SUBCMD_RANGE_START
 0x1600

	)

20 
	#SLSI_GSCAN_SCAN_ID_START
 0x410

	)

21 
	#SLSI_GSCAN_SCAN_ID_END
 0x500

	)

23 
	#SLSI_GSCAN_MAX_BUCKETS
 (8)

	)

24 
	#SLSI_GSCAN_MAX_CHANNELS
 (16è

	)

25 
	#SLSI_GSCAN_MAX_HOTLIST_APS
 (64)

	)

26 
	#SLSI_GSCAN_MAX_BUCKETS_PER_GSCAN
 (
SLSI_GSCAN_MAX_BUCKETS
)

	)

27 
	#SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
 (12000)

	)

28 
	#SLSI_GSCAN_MAX_AP_CACHE_PER_SCAN
 (16)

	)

29 
	#SLSI_GSCAN_MAX_SCAN_REPORTING_THRESHOLD
 (100)

	)

30 
	#SLSI_GSCAN_MAX_SIGNIFICANT_CHANGE_APS
 (64)

	)

31 
	#SLSI_GSCAN_MAX_EPNO_SSIDS
 (32)

	)

32 
	#SLSI_GSCAN_MAX_EPNO_HS2_PARAM
 (8è

	)

34 
	#SLSI_REPORT_EVENTS_NONE
 (0)

	)

35 
	#SLSI_REPORT_EVENTS_EACH_SCAN
 (1)

	)

36 
	#SLSI_REPORT_EVENTS_FULL_RESULTS
 (2)

	)

37 
	#SLSI_REPORT_EVENTS_NO_BATCH
 (4)

	)

39 
	#SLSI_NL_ATTRIBUTE_U32_LEN
 (
NLA_HDRLEN
 + 4)

	)

41 
	#SLSI_NL_VENDOR_ID_OVERHEAD
 
SLSI_NL_ATTRIBUTE_U32_LEN


	)

42 
	#SLSI_NL_VENDOR_SUBCMD_OVERHEAD
 
SLSI_NL_ATTRIBUTE_U32_LEN


	)

43 
	#SLSI_NL_VENDOR_DATA_OVERHEAD
 (
NLA_HDRLEN
)

	)

45 
	#SLSI_NL_VENDOR_REPLY_OVERHEAD
 (
SLSI_NL_VENDOR_ID_OVERHEAD
 + \

46 
SLSI_NL_VENDOR_SUBCMD_OVERHEAD
 + \

47 
SLSI_NL_VENDOR_DATA_OVERHEAD
)

	)

49 
	#SLSI_GSCAN_RTT_UNSPECIFIED
 (-1)

	)

50 
	#SLSI_GSCAN_HASH_TABLE_SIZE
 (32)

	)

51 
	#SLSI_GSCAN_HASH_KEY_MASK
 (0x1F)

	)

52 
	#SLSI_GSCAN_GET_HASH_KEY
(
_key
è(_key & 
SLSI_GSCAN_HASH_KEY_MASK
)

	)

54 
	#SLSI_KEEP_SCAN_RESULT
 (0)

	)

55 
	#SLSI_DISCARD_SCAN_RESULT
 (1)

	)

57 
	#SLSI_GSCAN_MAX_BSSID_PER_IE
 (20)

	)

59 
	#SLSI_LLS_CAPABILITY_QOS
 0x00000001

	)

60 
	#SLSI_LLS_CAPABILITY_PROTECTED
 0x00000002

	)

61 
	#SLSI_LLS_CAPABILITY_INTERWORKING
 0x00000004

	)

62 
	#SLSI_LLS_CAPABILITY_HS20
 0x00000008

	)

63 
	#SLSI_LLS_CAPABILITY_SSID_UTF8
 0x00000010

	)

64 
	#SLSI_LLS_CAPABILITY_COUNTRY
 0x00000020

	)

66 
	#TIMESPEC_TO_US
(
ts
è(((
u64
)Ñs).
tv_£c
 * 
USEC_PER_SEC
è+ (ts).
tv_n£c
 / 
NSEC_PER_USEC
)

	)

69 
	#SLSI_WIFI_HAL_FEATURE_INFRA
 0x000001

	)

70 
	#SLSI_WIFI_HAL_FEATURE_INFRA_5G
 0x000002

	)

71 
	#SLSI_WIFI_HAL_FEATURE_HOTSPOT
 0x000004

	)

72 
	#SLSI_WIFI_HAL_FEATURE_P2P
 0x000008

	)

73 
	#SLSI_WIFI_HAL_FEATURE_SOFT_AP
 0x000010

	)

74 
	#SLSI_WIFI_HAL_FEATURE_GSCAN
 0x000020

	)

75 
	#SLSI_WIFI_HAL_FEATURE_NAN
 0x000040

	)

76 
	#SLSI_WIFI_HAL_FEATURE_D2D_RTT
 0x000080

	)

77 
	#SLSI_WIFI_HAL_FEATURE_D2AP_RTT
 0x000100

	)

78 
	#SLSI_WIFI_HAL_FEATURE_BATCH_SCAN
 0x000200

	)

79 
	#SLSI_WIFI_HAL_FEATURE_PNO
 0x000400

	)

80 
	#SLSI_WIFI_HAL_FEATURE_ADDITIONAL_STA
 0x000800

	)

81 
	#SLSI_WIFI_HAL_FEATURE_TDLS
 0x001000

	)

82 
	#SLSI_WIFI_HAL_FEATURE_TDLS_OFFCHANNEL
 0x002000

	)

83 
	#SLSI_WIFI_HAL_FEATURE_EPR
 0x004000

	)

84 
	#SLSI_WIFI_HAL_FEATURE_AP_STA
 0x008000

	)

85 
	#SLSI_WIFI_HAL_FEATURE_LINK_LAYER_STATS
 0x010000

	)

86 
	#SLSI_WIFI_HAL_FEATURE_LOGGER
 0x020000

	)

87 
	#SLSI_WIFI_HAL_FEATURE_HAL_EPNO
 0x040000

	)

88 
	#SLSI_WIFI_HAL_FEATURE_RSSI_MONITOR
 0x080000

	)

89 
	#SLSI_WIFI_HAL_FEATURE_MKEEP_ALIVE
 0x100000

	)

90 
	#SLSI_WIFI_HAL_FEATURE_CONFIG_NDO
 0x200000

	)

91 
	#SLSI_WIFI_HAL_FEATURE_CONTROL_ROAMING
 0x800000

	)

92 
	#SLSI_WIFI_HAL_FEATURE_SCAN_RAND
 0x2000000

	)

93 
	#SLSI_WIFI_HAL_FEATURE_DYNAMIC_SET_MAC
 0x10000000

	)

94 
	#SLSI_WIFI_HAL_FEATURE_LOW_LATENCY
 0x40000000

	)

95 
	#SLSI_WIFI_HAL_FEATURE_P2P_RAND_MAC
 0x80000000

	)

97 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

98 
	#SLSI_ATTRIBUTE_START_VAL
 1

	)

100 
	#SLSI_ATTRIBUTE_START_VAL
 0

	)

101 
	#SLSI_NL_ATTRIBUTE_COUNTRY_CODE
 4

	)

102 
	#SLSI_NL_ATTRIBUTE_LATENCY_MODE
 5

	)

103 
	#SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
 6

	)

106 
	#SLSI_WIFI_EAPOL_KEY_TYPE_GTK
 0x0000

	)

107 
	#SLSI_WIFI_EAPOL_KEY_TYPE_PTK
 0x0001

	)

108 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_RESERVED
 0

	)

109 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_LOW_RSSI
 1

	)

110 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_LINK_LOSS
 2

	)

111 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_BTM_REQ
 3

	)

112 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_CU_TRIGGER
 4

	)

113 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_EMERGENCY
 5

	)

114 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_IDLE
 6

	)

115 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER1_EXPIRY
 7

	)

116 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER2_EXPIRY
 8

	)

117 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_INACTIVE_TIMER_EXPIRY
 9

	)

119 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_REQUEST_RX
 0x0050

	)

120 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_RESPONSE_RX
 0x0051

	)

121 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_RX
 0x0052

	)

122 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_INSTALL_RX
 0x0053

	)

123 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_REQUEST_TX_STATUS
 0x0054

	)

124 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_RESPONSE_TX_STATUS
 0x0055

	)

125 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_CONFIRM_TX_STATUS
 0x0056

	)

126 
	#FAPI_EVENT_WIFI_EVENT_NAN_NDP_INSTALL_TX_STATUS
 0x0057

	)

128 
	#FAPI_EVENT_WIFI_EVENT_NAN_PEER_AVAILABILITY_UPDATE
 0x0058

	)

130 
	#SLSI_WIFI_RTT_RESULT_MAX_ENTRY
 8

	)

131 
	#SLSI_WIFI_RTT_RESULT_ID
 0xdd

	)

132 
	#SLSI_WIFI_RTT_RESULT_LENGTH
 0x30

	)

134 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

135 
	e¦si_low_Ï‹ncy_©Œ
 {

136 
	mSLSI_NL_ATTRIBUTE_LATENCY_MODE
 = 1,

137 
	mSLSI_NL_ATTRIBUTE_LATENCY_MAX


140 
	e¦si_couÁry_code_©Œ
 {

141 
	mSLSI_NL_ATTRIBUTE_COUNTRY_CODE
 = 1,

142 
	mSLSI_NL_ATTRIBUTE_COUNTRY_CODE_MAX


145 
	e¦si_tx_pow”_sûÇrio_©Œ
 {

146 
	mSLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
 = 1,

147 
	mSLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO_MAX


151 
	e¦si_wifi_©Œ
 {

152 
	mSLSI_NL_ATTRIBUTE_ND_OFFLOAD_VALUE
 = 
SLSI_ATTRIBUTE_START_VAL
,

153 
	mSLSI_NL_ATTRIBUTE_PNO_RANDOM_MAC_OUI
,

154 
	mSLSI_NL_ATTRIBUTE_MAC_OUI_MAX


157 
	eSLSI_APF_ATTRIBUTES
 {

158 
	mSLSI_APF_ATTR_VERSION
 = 0,

159 
	mSLSI_APF_ATTR_MAX_LEN
,

160 
	mSLSI_APF_ATTR_PROGRAM
,

161 
	mSLSI_APF_ATTR_PROGRAM_LEN
,

162 
	mSLSI_APF_ATTR_MAX


165 
	eSLSI_ROAM_ATTRIBUTES
 {

166 
	mSLSI_NL_ATTR_MAX_BLACKLIST_SIZE
,

167 
	mSLSI_NL_ATTR_MAX_WHITELIST_SIZE
,

168 
	mSLSI_NL_ATTR_ROAM_STATE
,

169 
	mSLSI_NL_ATTR_ROAM_MAX


172 
	e¦si_acs_©Œ_ofæßd
 {

173 
	mSLSI_ACS_ATTR_CHANNEL_INVALID
 = 0,

174 
	mSLSI_ACS_ATTR_PRIMARY_CHANNEL
,

175 
	mSLSI_ACS_ATTR_SECONDARY_CHANNEL
,

176 
	mSLSI_ACS_ATTR_HW_MODE
,

177 
	mSLSI_ACS_ATTR_HT_ENABLED
,

178 
	mSLSI_ACS_ATTR_HT40_ENABLED
,

179 
	mSLSI_ACS_ATTR_VHT_ENABLED
,

180 
	mSLSI_ACS_ATTR_CHWIDTH
,

181 
	mSLSI_ACS_ATTR_CH_LIST
,

182 
	mSLSI_ACS_ATTR_VHT_SEG0_CENTER_CHANNEL
,

183 
	mSLSI_ACS_ATTR_VHT_SEG1_CENTER_CHANNEL
,

184 
	mSLSI_ACS_ATTR_FREQ_LIST
,

186 
	mSLSI_ACS_ATTR_AFTER_LAST
,

187 
	mSLSI_ACS_ATTR_MAX
 =

188 
SLSI_ACS_ATTR_AFTER_LAST
 - 1

191 
	e¦si_sÿn_©Œ_cÚfig
 {

192 
	mSLSI_SCAN_DEFAULT_IE_LEN
 = 1,

193 
	mSLSI_SCAN_DEFAULT_IES
,

195 
	mSLSI_SCAN_DEFAULT_AFTER_LAST
,

196 
	mSLSI_SCAN_DEFAULT_MAX
 =

197 
SLSI_SCAN_DEFAULT_AFTER_LAST
 - 1,

200 #ifdeà
CONFIG_SLSI_WLAN_STA_FWD_BEACON


201 
	e¦si_ws_©Œ
 {

202 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SSID
 = 0,

203 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BSSID
,

204 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_CHANNEL
,

205 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BCN_INTERVAL
,

206 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP1
,

207 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP2
,

208 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SYS_TIME
,

209 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_MAX


212 
	e¦si_ws_abÜt_©Œ
 {

213 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_ABORT
 = 0,

214 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_ABORT_MAX
,

217 
	e¦si_fÜw¬d_b—cÚ_abÜt_»asÚ
 {

218 
	mSLSI_FORWARD_BEACON_ABORT_REASON_UNSPECIFIED
 = 0,

219 
	mSLSI_FORWARD_BEACON_ABORT_REASON_SCANNING
,

220 
	mSLSI_FORWARD_BEACON_ABORT_REASON_ROAMING
,

221 
	mSLSI_FORWARD_BEACON_ABORT_REASON_SUSPENDED
,

222 
	mSLSI_FORWARD_BEACON_ABORT_REASON_OFFSET
 = 0x8007,

226 
	e¦si_acs_hw_mode
 {

227 
	mSLSI_ACS_MODE_IEEE80211B
,

228 
	mSLSI_ACS_MODE_IEEE80211G
,

229 
	mSLSI_ACS_MODE_IEEE80211A
,

230 
	mSLSI_ACS_MODE_IEEE80211AD
,

231 
	mSLSI_ACS_MODE_IEEE80211ANY
,

234 
	eGSCAN_ATTRIBUTE
 {

235 
	mGSCAN_ATTRIBUTE_NUM_BUCKETS
 = 10,

236 
	mGSCAN_ATTRIBUTE_BASE_PERIOD
,

237 
	mGSCAN_ATTRIBUTE_BUCKETS_BAND
,

238 
	mGSCAN_ATTRIBUTE_BUCKET_ID
,

239 
	mGSCAN_ATTRIBUTE_BUCKET_PERIOD
,

240 
	mGSCAN_ATTRIBUTE_BUCKET_NUM_CHANNELS
,

241 
	mGSCAN_ATTRIBUTE_BUCKET_CHANNELS
,

242 
	mGSCAN_ATTRIBUTE_NUM_AP_PER_SCAN
,

243 
	mGSCAN_ATTRIBUTE_REPORT_THRESHOLD
,

244 
	mGSCAN_ATTRIBUTE_NUM_SCANS_TO_CACHE
,

245 
	mGSCAN_ATTRIBUTE_REPORT_THRESHOLD_NUM_SCANS
,

246 
	mGSCAN_ATTRIBUTE_BAND
 = 
GSCAN_ATTRIBUTE_BUCKETS_BAND
,

248 
	mGSCAN_ATTRIBUTE_ENABLE_FEATURE
 = 20,

249 
	mGSCAN_ATTRIBUTE_SCAN_RESULTS_COMPLETE
,

250 
	mGSCAN_ATTRIBUTE_REPORT_EVENTS
,

253 
	mGSCAN_ATTRIBUTE_NUM_OF_RESULTS
 = 30,

254 
	mGSCAN_ATTRIBUTE_SCAN_RESULTS
,

255 
	mGSCAN_ATTRIBUTE_NUM_CHANNELS
,

256 
	mGSCAN_ATTRIBUTE_CHANNEL_LIST
,

257 
	mGSCAN_ATTRIBUTE_SCAN_ID
,

258 
	mGSCAN_ATTRIBUTE_SCAN_FLAGS
,

259 
	mGSCAN_ATTRIBUTE_SCAN_BUCKET_BIT
,

262 
	mGSCAN_ATTRIBUTE_RSSI_SAMPLE_SIZE
 = 60,

263 
	mGSCAN_ATTRIBUTE_LOST_AP_SAMPLE_SIZE
,

264 
	mGSCAN_ATTRIBUTE_MIN_BREACHING
,

265 
	mGSCAN_ATTRIBUTE_SIGNIFICANT_CHANGE_BSSIDS
,

267 
	mGSCAN_ATTRIBUTE_BUCKET_STEP_COUNT
 = 70,

268 
	mGSCAN_ATTRIBUTE_BUCKET_EXPONENT
,

269 
	mGSCAN_ATTRIBUTE_BUCKET_MAX_PERIOD
,

271 
	mGSCAN_ATTRIBUTE_NUM_BSSID
,

272 
	mGSCAN_ATTRIBUTE_BLACKLIST_BSSID
,

273 
	mGSCAN_ATTRIBUTE_BLACKLIST_FROM_SUPPLICANT
,

275 
	mGSCAN_ATTRIBUTE_MAX


278 
	e•no_ssid_©Œibu‹
 {

279 
	mSLSI_ATTRIBUTE_EPNO_MINIMUM_5G_RSSI
 = 
SLSI_ATTRIBUTE_START_VAL
,

280 
	mSLSI_ATTRIBUTE_EPNO_MINIMUM_2G_RSSI
,

281 
	mSLSI_ATTRIBUTE_EPNO_INITIAL_SCORE_MAX
,

282 
	mSLSI_ATTRIBUTE_EPNO_CUR_CONN_BONUS
,

283 
	mSLSI_ATTRIBUTE_EPNO_SAME_NETWORK_BONUS
,

284 
	mSLSI_ATTRIBUTE_EPNO_SECURE_BONUS
,

285 
	mSLSI_ATTRIBUTE_EPNO_5G_BONUS
,

286 
	mSLSI_ATTRIBUTE_EPNO_SSID_NUM
,

287 
	mSLSI_ATTRIBUTE_EPNO_SSID_LIST
,

288 
	mSLSI_ATTRIBUTE_EPNO_SSID
,

289 
	mSLSI_ATTRIBUTE_EPNO_SSID_LEN
,

290 
	mSLSI_ATTRIBUTE_EPNO_FLAGS
,

291 
	mSLSI_ATTRIBUTE_EPNO_AUTH
,

292 
	mSLSI_ATTRIBUTE_EPNO_MAX


295 
	e•no_hs_©Œibu‹
 {

296 
	mSLSI_ATTRIBUTE_EPNO_HS_PARAM_LIST
 = 
SLSI_ATTRIBUTE_START_VAL
,

297 
	mSLSI_ATTRIBUTE_EPNO_HS_NUM
,

298 
	mSLSI_ATTRIBUTE_EPNO_HS_ID
,

299 
	mSLSI_ATTRIBUTE_EPNO_HS_REALM
,

300 
	mSLSI_ATTRIBUTE_EPNO_HS_CONSORTIUM_IDS
,

301 
	mSLSI_ATTRIBUTE_EPNO_HS_PLMN
,

302 
	mSLSI_ATTRIBUTE_EPNO_HS_MAX


305 
	egsÿn_buck‘_©Œibu‹s
 {

306 
	mGSCAN_ATTRIBUTE_CH_BUCKET_1
,

307 
	mGSCAN_ATTRIBUTE_CH_BUCKET_2
,

308 
	mGSCAN_ATTRIBUTE_CH_BUCKET_3
,

309 
	mGSCAN_ATTRIBUTE_CH_BUCKET_4
,

310 
	mGSCAN_ATTRIBUTE_CH_BUCKET_5
,

311 
	mGSCAN_ATTRIBUTE_CH_BUCKET_6
,

312 
	mGSCAN_ATTRIBUTE_CH_BUCKET_7
,

313 
	mGSCAN_ATTRIBUTE_CH_BUCKET_8


316 
	ewifi_bªd
 {

317 
	mWIFI_BAND_UNSPECIFIED
,

318 
	mWIFI_BAND_BG
 = 1,

319 
	mWIFI_BAND_A
 = 2,

320 
	mWIFI_BAND_A_DFS
 = 4,

321 
	mWIFI_BAND_A_WITH_DFS
 = 6,

322 
	mWIFI_BAND_ABG
 = 3,

323 
	mWIFI_BAND_ABG_WITH_DFS
 = 7,

326 
	ewifi_sÿn_ev’t
 {

327 
	mWIFI_SCAN_RESULTS_AVAILABLE
,

328 
	mWIFI_SCAN_THRESHOLD_NUM_SCANS
,

329 
	mWIFI_SCAN_THRESHOLD_PERCENT
,

330 
	mWIFI_SCAN_FAILED
,

333 
	ewifi_mk“p_®ive_©Œibu‹
 {

334 
	mMKEEP_ALIVE_ATTRIBUTE_ID
 = 
SLSI_ATTRIBUTE_START_VAL
,

335 
	mMKEEP_ALIVE_ATTRIBUTE_IP_PKT
,

336 
	mMKEEP_ALIVE_ATTRIBUTE_IP_PKT_LEN
,

337 
	mMKEEP_ALIVE_ATTRIBUTE_SRC_MAC_ADDR
,

338 
	mMKEEP_ALIVE_ATTRIBUTE_DST_MAC_ADDR
,

339 
	mMKEEP_ALIVE_ATTRIBUTE_PERIOD_MSEC
,

340 
	mMKEEP_ALIVE_ATTRIBUTE_MAX


343 
	ewifi_rssi_mÚ™Ü_©Œ
 {

344 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_MAX_RSSI
 = 
SLSI_ATTRIBUTE_START_VAL
,

345 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_MIN_RSSI
,

346 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_START
,

347 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_MAX


350 
	eÎs_©Œibu‹
 {

351 
	mLLS_ATTRIBUTE_SET_MPDU_SIZE_THRESHOLD
 = 1,

352 
	mLLS_ATTRIBUTE_SET_AGGR_STATISTICS_GATHERING
,

353 
	mLLS_ATTRIBUTE_CLEAR_STOP_REQUEST_MASK
,

354 
	mLLS_ATTRIBUTE_CLEAR_STOP_REQUEST
,

355 
	mLLS_ATTRIBUTE_STATS_VERSION
,

356 
	mLLS_ATTRIBUTE_GET_STATS_TYPE
,

357 
	mLLS_ATTRIBUTE_GET_STATS_STRUCT
,

358 
	mLLS_ATTRIBUTE_MAX


361 
	e¦si_h®_v’dÜ_subcmds
 {

362 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_CAPABILITIES
 = 
SLSI_NL80211_GSCAN_SUBCMD_RANGE_START
,

363 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_VALID_CHANNELS
,

364 
	mSLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN
,

365 
	mSLSI_NL80211_VENDOR_SUBCMD_DEL_GSCAN
,

366 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_SCAN_RESULTS
,

368 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_HOTLIST
,

369 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_BSSID_HOTLIST
,

370 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_HOTLIST_RESULTS
,

371 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_SIGNIFICANT_CHANGE
,

372 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_SIGNIFICANT_CHANGE
,

374 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_GSCAN_OUI
,

375 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_NODFS
,

376 
	mSLSI_NL80211_VENDOR_SUBCMD_START_KEEP_ALIVE_OFFLOAD
,

377 
	mSLSI_NL80211_VENDOR_SUBCMD_STOP_KEEP_ALIVE_OFFLOAD
,

378 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST
,

379 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_EPNO_LIST
,

380 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_HS_LIST
,

381 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_HS_LIST
,

382 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_RSSI_MONITOR
,

383 
	mSLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_SET_STATS
,

384 
	mSLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_GET_STATS
,

385 
	mSLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_CLEAR_STATS
,

386 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE_SET
,

387 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_COUNTRY_CODE
,

388 
	mSLSI_NL80211_VENDOR_SUBCMD_CONFIGURE_ND_OFFLOAD
,

389 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_ROAMING_CAPABILITIES
,

390 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_ROAMING_STATE
,

391 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_LATENCY_MODE
,

392 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_DTIM_CONFIG
,

393 
	mSLSI_NL80211_VENDOR_SUBCMD_SELECT_TX_POWER_SCENARIO
,

394 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_TX_POWER_SCENARIO
,

395 
	mSLSI_NL80211_VENDOR_SUBCMD_RTT_GET_CAPABILITIES
 = 
SLSI_NL80211_RTT_SUBCMD_RANGE_START
,

396 
	mSLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_START
,

397 
	mSLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_CANCEL
,

398 
	mSLSI_NL80211_VENDOR_SUBCMD_START_LOGGING
 = 
SLSI_NL80211_LOGGING_SUBCMD_RANGE_START
,

399 
	mSLSI_NL80211_VENDOR_SUBCMD_TRIGGER_FW_MEM_DUMP
,

400 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_FW_MEM_DUMP
,

401 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_VERSION
,

402 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_RING_STATUS
,

403 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_RING_DATA
,

404 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE
,

405 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_LOGGING
,

406 
	mSLSI_NL80211_VENDOR_SUBCMD_TRIGGER_DRIVER_MEM_DUMP
,

407 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_DRIVER_MEM_DUMP
,

408 
	mSLSI_NL80211_VENDOR_SUBCMD_START_PKT_FATE_MONITORING
,

409 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_TX_PKT_FATES
,

410 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_RX_PKT_FATES
,

411 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_WAKE_REASON_STATS
,

412 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_ENABLE
 = 
SLSI_NL80211_NAN_SUBCMD_RANGE_START
,

413 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DISABLE
,

414 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISH
,

415 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISHCANCEL
,

416 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBE
,

417 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBECANCEL
,

418 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_TXFOLLOWUP
,

419 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_CONFIG
,

420 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_CAPABILITIES
,

421 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_CREATE
,

422 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_DELETE
,

423 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_REQUEST_INITIATOR
,

424 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INDICATION_RESPONSE
,

425 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_END
,

426 
	mSLSI_NL80211_VENDOR_SUBCMD_APF_SET_FILTER
 = 
SLSI_NL80211_APF_SUBCMD_RANGE_START
,

427 
	mSLSI_NL80211_VENDOR_SUBCMD_APF_GET_CAPABILITIES
,

428 
	mSLSI_NL80211_VENDOR_SUBCMD_APF_READ_FILTER


431 
	e¦si_suµ_v’dÜ_subcmds
 {

432 
	mSLSI_NL80211_VENDOR_SUBCMD_UNSPEC
 = 0,

433 
	mSLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_SET_KEY
,

434 
	mSLSI_NL80211_VENDOR_SUBCMD_ACS_INIT
,

435 
	mSLSI_NL80211_VENDOR_SUBCMD_DEFAULT_SCAN_IES


438 
	e¦si_v’dÜ_ev’t_v®ues
 {

440 
	mSLSI_NL80211_SIGNIFICANT_CHANGE_EVENT
,

441 
	mSLSI_NL80211_HOTLIST_AP_FOUND_EVENT
,

443 
	mSLSI_NL80211_SCAN_RESULTS_AVAILABLE_EVENT
,

444 
	mSLSI_NL80211_FULL_SCAN_RESULT_EVENT
,

445 
	mSLSI_NL80211_SCAN_EVENT
,

447 
	mSLSI_NL80211_HOTLIST_AP_LOST_EVENT
,

449 
	mSLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
,

450 
	mSLSI_NL80211_VENDOR_HANGED_EVENT
,

451 
	mSLSI_NL80211_EPNO_EVENT
,

452 
	mSLSI_NL80211_HOTSPOT_MATCH
,

453 
	mSLSI_NL80211_RSSI_REPORT_EVENT
 = 10,

454 
	mSLSI_NL80211_LOGGER_RING_EVENT
,

455 
	mSLSI_NL80211_LOGGER_FW_DUMP_EVENT
,

456 
	mSLSI_NL80211_NAN_RESPONSE_EVENT
,

457 
	mSLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
,

458 
	mSLSI_NL80211_NAN_MATCH_EVENT
,

459 
	mSLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
,

460 
	mSLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
,

461 
	mSLSI_NL80211_NAN_FOLLOWUP_EVENT
,

462 
	mSLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
,

463 
	mSLSI_NL80211_NAN_DISABLED_EVENT
 = 20,

464 
	mSLSI_NL80211_RTT_RESULT_EVENT
,

465 
	mSLSI_NL80211_RTT_COMPLETE_EVENT
,

466 
	mSLSI_NL80211_VENDOR_ACS_EVENT
,

467 
	mSLSI_NL80211_VENDOR_FORWARD_BEACON
,

468 
	mSLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
,

469 
	mSLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
,

470 
	mSLSI_NAN_EVENT_NDP_REQ
,

471 
	mSLSI_NAN_EVENT_NDP_CFM
,

472 
	mSLSI_NAN_EVENT_NDP_END
,

473 
	mSLSI_NL80211_VENDOR_RCL_EVENT
 = 30,

474 
	mSLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT
,

475 
	mSLSI_NL80211_VENDOR_CONNECTIVITY_LOG_EVENT
,

476 
	mSLSI_NL80211_SUBSYSTEM_RESTART_EVENT
,

477 
	mSLSI_NL80211_VENDOR_TWT_SETUP_EVENT
 = 34,

478 
	mSLSI_NL80211_VENDOR_TWT_TEARDOWN_EVENT
,

479 
	mSLSI_NL80211_VENDOR_TWT_NOTIFICATION_EVENT
,

480 
	mSLSI_NL80211_VENDOR_SCHED_PM_TEARDOWN_EVENT
 = 37,

481 
	mSLSI_NL80211_VENDOR_SCHED_PM_LEAKY_AP_DETECT_EVENT
 = 38,

482 
	mSLSI_NL80211_NAN_INTERFACE_CREATED_EVENT
 = 39,

483 
	mSLSI_NL80211_NAN_INTERFACE_DELETED_EVENT
 = 40

486 
	e¦si_Îs_š‹rçû_mode
 {

487 
	mSLSI_LLS_INTERFACE_STA
 = 0,

488 
	mSLSI_LLS_INTERFACE_SOFTAP
 = 1,

489 
	mSLSI_LLS_INTERFACE_IBSS
 = 2,

490 
	mSLSI_LLS_INTERFACE_P2P_CLIENT
 = 3,

491 
	mSLSI_LLS_INTERFACE_P2P_GO
 = 4,

492 
	mSLSI_LLS_INTERFACE_NAN
 = 5,

493 
	mSLSI_LLS_INTERFACE_MESH
 = 6,

494 
	mSLSI_LLS_INTERFACE_UNKNOWN
 = -1

497 
	e¦si_Îs_cÚÃùiÚ_¡©e
 {

498 
	mSLSI_LLS_DISCONNECTED
 = 0,

499 
	mSLSI_LLS_AUTHENTICATING
 = 1,

500 
	mSLSI_LLS_ASSOCIATING
 = 2,

501 
	mSLSI_LLS_ASSOCIATED
 = 3,

502 
	mSLSI_LLS_EAPOL_STARTED
 = 4,

503 
	mSLSI_LLS_EAPOL_COMPLETED
 = 5,

506 
	e¦si_Îs_rßm_¡©e
 {

507 
	mSLSI_LLS_ROAMING_IDLE
 = 0,

508 
	mSLSI_LLS_ROAMING_ACTIVE
 = 1,

512 
	e¦si_Îs_Œaffic_ac
 {

513 
	mSLSI_LLS_AC_VO
 = 0,

514 
	mSLSI_LLS_AC_VI
 = 1,

515 
	mSLSI_LLS_AC_BE
 = 2,

516 
	mSLSI_LLS_AC_BK
 = 3,

517 
	mSLSI_LLS_AC_MAX
 = 4,

521 
	e¦si_Îs_chªÃl_width
 {

522 
	mSLSI_LLS_CHAN_WIDTH_20
 = 0,

523 
	mSLSI_LLS_CHAN_WIDTH_40
 = 1,

524 
	mSLSI_LLS_CHAN_WIDTH_80
 = 2,

525 
	mSLSI_LLS_CHAN_WIDTH_160
 = 3,

526 
	mSLSI_LLS_CHAN_WIDTH_80P80
 = 4,

527 
	mSLSI_LLS_CHAN_WIDTH_5
 = 5,

528 
	mSLSI_LLS_CHAN_WIDTH_10
 = 6,

529 
	mSLSI_LLS_CHAN_WIDTH_INVALID
 = -1

533 
	e¦si_Îs_³”_ty³
 {

534 
	mSLSI_LLS_PEER_STA
,

535 
	mSLSI_LLS_PEER_AP
,

536 
	mSLSI_LLS_PEER_P2P_GO
,

537 
	mSLSI_LLS_PEER_P2P_CLIENT
,

538 
	mSLSI_LLS_PEER_NAN
,

539 
	mSLSI_LLS_PEER_TDLS
,

540 
	mSLSI_LLS_PEER_INVALID
,

544 
	e¦si_’hªûd_loggšg_©Œibu‹s
 {

545 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_VERSION
 = 
SLSI_ATTRIBUTE_START_VAL
,

546 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_VERSION
,

547 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_ID
,

548 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
,

549 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_FLAGS
,

550 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_VERBOSE_LEVEL
,

551 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MAX_INTERVAL
,

552 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MIN_DATA_SIZE
,

553 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
,

554 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
,

555 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_DATA
,

556 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_STATUS
,

557 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NUM
,

558 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
,

559 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
,

560 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
,

561 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
,

562 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_MAX
,

563 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_INVALID
 = 0,

564 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_CMD_EVENT_WAKE
,

565 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_PTR
,

566 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_SZ
,

567 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_DRIVER_FW_LOCAL_WAKE
,

568 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_PTR
,

569 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_SZ
,

570 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_RX_DATA_WAKE
,

571 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_UNICAST_CNT
,

572 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_MULTICAST_CNT
,

573 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_BROADCAST_CNT
,

574 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP_PKT
,

575 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_PKT
,

576 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_RA
,

577 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_NA
,

578 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_NS
,

579 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP4_RX_MULTICAST_CNT
,

580 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_RX_MULTICAST_CNT
,

581 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_OTHER_RX_MULTICAST_CNT
,

582 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_MAX
,

585 
	e¦si_¹t_ev’t_©Œibu‹s
 {

586 
	mSLSI_RTT_EVENT_ATTR_ADDR
 = 0,

587 
	mSLSI_RTT_EVENT_ATTR_BURST_NUM
,

588 
	mSLSI_RTT_EVENT_ATTR_MEASUREMENT_NUM
,

589 
	mSLSI_RTT_EVENT_ATTR_SUCCESS_NUM
,

590 
	mSLSI_RTT_EVENT_ATTR_NUM_PER_BURST_PEER
,

591 
	mSLSI_RTT_EVENT_ATTR_STATUS
,

592 
	mSLSI_RTT_EVENT_ATTR_RETRY_AFTER_DURATION
,

593 
	mSLSI_RTT_EVENT_ATTR_TYPE
,

594 
	mSLSI_RTT_EVENT_ATTR_RSSI
,

595 
	mSLSI_RTT_EVENT_ATTR_RSSI_SPREAD
,

596 
	mSLSI_RTT_EVENT_ATTR_TX_PREAMBLE
,

597 
	mSLSI_RTT_EVENT_ATTR_TX_NSS
,

598 
	mSLSI_RTT_EVENT_ATTR_TX_BW
,

599 
	mSLSI_RTT_EVENT_ATTR_TX_MCS
,

600 
	mSLSI_RTT_EVENT_ATTR_TX_RATE
,

601 
	mSLSI_RTT_EVENT_ATTR_RX_PREAMBLE
,

602 
	mSLSI_RTT_EVENT_ATTR_RX_NSS
,

603 
	mSLSI_RTT_EVENT_ATTR_RX_BW
,

604 
	mSLSI_RTT_EVENT_ATTR_RX_MCS
,

605 
	mSLSI_RTT_EVENT_ATTR_RX_RATE
,

606 
	mSLSI_RTT_EVENT_ATTR_RTT
,

607 
	mSLSI_RTT_EVENT_ATTR_RTT_SD
,

608 
	mSLSI_RTT_EVENT_ATTR_RTT_SPREAD
,

609 
	mSLSI_RTT_EVENT_ATTR_DISTANCE_MM
,

610 
	mSLSI_RTT_EVENT_ATTR_DISTANCE_SD_MM
,

611 
	mSLSI_RTT_EVENT_ATTR_DISTANCE_SPREAD_MM
,

612 
	mSLSI_RTT_EVENT_ATTR_TIMESTAMP_US
,

613 
	mSLSI_RTT_EVENT_ATTR_BURST_DURATION_MSN
,

614 
	mSLSI_RTT_EVENT_ATTR_NEGOTIATED_BURST_NUM
,

615 
	mSLSI_RTT_EVENT_ATTR_LCI
,

616 
	mSLSI_RTT_EVENT_ATTR_LCR
,

621 
	e¦si_¹t_³”_ty³
 {

622 
	mSLSI_RTT_PEER_AP
 = 0x1,

623 
	mSLSI_RTT_PEER_STA
,

624 
	mSLSI_RTT_PEER_P2P_GO
,

625 
	mSLSI_RTT_PEER_P2P_CLIENT
,

626 
	mSLSI_RTT_PEER_NAN
,

630 
	e¦si_wifi_¹t_bw
 {

631 
	mSLSI_WIFI_RTT_BW_5
 = 0x01,

632 
	mSLSI_WIFI_RTT_BW_10
 = 0x02,

633 
	mSLSI_WIFI_RTT_BW_20
 = 0x04,

634 
	mSLSI_WIFI_RTT_BW_40
 = 0x08,

635 
	mSLSI_WIFI_RTT_BW_80
 = 0x10,

636 
	mSLSI_WIFI_RTT_BW_160
 = 0x20

640 
	e¦si_wifi_¹t_´—mbË
 {

641 
	mSLSI_WIFI_RTT_PREAMBLE_LEGACY
 = 0x1,

642 
	mSLSI_WIFI_RTT_PREAMBLE_HT
 = 0x2,

643 
	mSLSI_WIFI_RTT_PREAMBLE_VHT
 = 0x4

647 
	e¦si_wifi_¹t_ty³
 {

648 
	mSLSI_RTT_TYPE_1_SIDED
 = 0x1,

649 
	mSLSI_RTT_TYPE_2_SIDED
,

652 
	e¦si_¹t_©Œibu‹
 {

653 
	mSLSI_RTT_ATTRIBUTE_TARGET_CNT
 = 
SLSI_ATTRIBUTE_START_VAL
,

654 
	mSLSI_RTT_ATTRIBUTE_TARGET_INFO
,

655 
	mSLSI_RTT_ATTRIBUTE_TARGET_MAC
,

656 
	mSLSI_RTT_ATTRIBUTE_TARGET_TYPE
,

657 
	mSLSI_RTT_ATTRIBUTE_TARGET_PEER
,

658 
	mSLSI_RTT_ATTRIBUTE_TARGET_CHAN_FREQ
,

659 
	mSLSI_RTT_ATTRIBUTE_TARGET_PERIOD
,

660 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_BURST
,

661 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_FTM_BURST
,

662 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTM
,

663 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTMR
,

664 
	mSLSI_RTT_ATTRIBUTE_TARGET_LCI
,

665 
	mSLSI_RTT_ATTRIBUTE_TARGET_LCR
,

666 
	mSLSI_RTT_ATTRIBUTE_TARGET_BURST_DURATION
,

667 
	mSLSI_RTT_ATTRIBUTE_TARGET_PREAMBLE
,

668 
	mSLSI_RTT_ATTRIBUTE_TARGET_BW
,

669 
	mSLSI_RTT_ATTRIBUTE_RESULTS_COMPLETE
 = 30,

670 
	mSLSI_RTT_ATTRIBUTE_RESULTS_PER_TARGET
,

671 
	mSLSI_RTT_ATTRIBUTE_RESULT_CNT
,

672 
	mSLSI_RTT_ATTRIBUTE_RESULT
,

673 
	mSLSI_RTT_ATTRIBUTE_TARGET_ID
,

674 
	mSLSI_RTT_ATTRIBUTE_MAX


678 
	e¦si_wifi_¹t_¡©us
 {

679 
	mSLSI_RTT_STATUS_SUCCESS
 = 0,

680 
	mSLSI_RTT_STATUS_FAILURE
,

681 
	mSLSI_RTT_STATUS_FAIL_NO_RSP
,

682 
	mSLSI_RTT_STATUS_FAIL_REJECTED
,

683 
	mSLSI_RTT_STATUS_FAIL_NOT_SCHEDULED_YET
,

684 
	mSLSI_RTT_STATUS_FAIL_TM_TIMEOUT
,

685 
	mSLSI_RTT_STATUS_FAIL_AP_ON_DIFF_CHANNEL
,

686 
	mSLSI_RTT_STATUS_FAIL_NO_CAPABILITY
,

687 
	mSLSI_RTT_STATUS_ABORTED
,

688 
	mSLSI_RTT_STATUS_FAIL_INVALID_TS
,

689 
	mSLSI_RTT_STATUS_FAIL_PROTOCOL
,

690 
	mSLSI_RTT_STATUS_FAIL_SCHEDULE
,

691 
	mSLSI_RTT_STATUS_FAIL_BUSY_TRY_LATER
,

692 
	mSLSI_RTT_STATUS_INVALID_REQ
,

693 
	mSLSI_RTT_STATUS_NO_WIFI
,

694 
	mSLSI_RTT_STATUS_FAIL_FTM_PARAM_OVERRIDE


697 
	ewifi_dtim_cÚfig_©Œ
 {

698 
	mSLSI_VENDOR_ATTR_DTIM_MULTIPLIER
 = 1,

699 
	mSLSI_VENDOR_ATTR_DTIM_MAX


703 
	s¦si_wifi_šfÜm©iÚ_–em’t
 {

704 
u8
 
	mid
;

705 
u8
 
	mËn
;

706 
u8
 
	md©a
[];

709 
	s¦si_Æ_gsÿn_ÿ·b™›s
 {

710 
	mmax_sÿn_ÿche_size
;

711 
	mmax_sÿn_buck‘s
;

712 
	mmax_­_ÿche_³r_sÿn
;

713 
	mmax_rssi_§m¶e_size
;

714 
	mmax_sÿn_»pÜtšg_th»shŞd
;

715 
	mmax_hÙli¡_­s
;

716 
	mmax_hÙli¡_ssids
;

717 
	mmax_signifiÿÁ_wifi_chªge_­s
;

718 
	mmax_bssid_hi¡Üy_’Œ›s
;

719 
	mmax_numb”_•no_ÃtwÜks
;

720 
	mmax_numb”_•no_ÃtwÜks_by_ssid
;

721 
	mmax_numb”_of_wh™e_li¡ed_ssid
;

724 
	s¦si_Æ_chªÃl_·¿m
 {

725 
	mchªÃl
;

726 
	mdw–l_time_ms
;

727 
	m·ssive
;

730 
	s¦si_Æ_buck‘_·¿m
 {

731 
	mbuck‘_šdex
;

732 
wifi_bªd
 
	mbªd
;

733 
	m³riod
;

734 
u8
 
	m»pÜt_ev’ts
;

735 
	mmax_³riod
;

736 
	mexpÚ’t
;

737 
	m¡•_couÁ
;

738 
	mnum_chªÃls
;

739 
¦si_Æ_chªÃl_·¿m
 
	mchªÃls
[
SLSI_GSCAN_MAX_CHANNELS
];

742 
	s¦si_Æ_gsÿn_·¿m
 {

743 
	mba£_³riod
;

744 
	mmax_­_³r_sÿn
;

745 
	m»pÜt_th»shŞd_³rûÁ
;

746 
	m»pÜt_th»shŞd_num_sÿns
;

747 
	mnum_buck‘s
;

748 
¦si_Æ_buck‘_·¿m
 
	mÆ_buck‘
[
SLSI_GSCAN_MAX_BUCKETS
];

751 
	s¦si_Æ_sÿn_»suÉ_·¿m
 {

752 
u64
 
	mts
;

753 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
 + 1];

754 
u8
 
	mbssid
[6];

755 
	mchªÃl
;

756 
	mrssi
;

757 
s64
 
	m¹t
;

758 
s64
 
	m¹t_sd
;

759 
u16
 
	mb—cÚ_³riod
;

760 
u16
 
	mÿ·b™y
;

761 
u32
 
	m›_Ëngth
;

762 
u8
 
	m›_d©a
[1];

765 
	s¦si_buck‘
 {

766 
boŞ
 
	mu£d
;

767 
boŞ
 
	mfÜ_chªge_Œackšg
;

768 
u8
 
	m»pÜt_ev’ts
;

769 
u16
 
	msÿn_id
;

770 
	msÿn_cyşe
;

771 
¦si_gsÿn
 *
	mgsÿn
;

774 
	s¦si_gsÿn
 {

775 
	mmax_­_³r_sÿn
;

776 
	m»pÜt_th»shŞd_³rûÁ
;

777 
	m»pÜt_th»shŞd_num_sÿns
;

778 
	mnum_sÿns
;

779 
	mnum_buck‘s
;

780 
¦si_Æ_buck‘_·¿m
 
	mÆ_buck‘
;

781 
¦si_buck‘
 *
	mbuck‘
[
SLSI_GSCAN_MAX_BUCKETS_PER_GSCAN
];

782 
¦si_gsÿn
 *
	mÃxt
;

785 
	s¦si_gsÿn_·¿m
 {

786 
¦si_Æ_buck‘_·¿m
 *
	mÆ_buck‘
;

787 
¦si_buck‘
 *
	mbuck‘
;

790 
	s¦si_gsÿn_»suÉ
 {

791 
¦si_gsÿn_»suÉ
 *
	mhÃxt
;

792 
	msÿn_cyşe
;

793 
	msÿn_»s_Ën
;

794 
	mªqp_Ëngth
;

795 
¦si_Æ_sÿn_»suÉ_·¿m
 
	mÆ_sÿn_»s
;

798 
	s¦si_•no_ssid_·¿m
 {

799 
u16
 
	mæags
;

800 
u8
 
	mssid_Ën
;

801 
u8
 
	mssid
[32];

804 
	s¦si_•no_·¿m
 {

805 
u16
 
	mmš_5g_rssi
;

806 
u16
 
	mmš_2g_rssi
;

807 
u16
 
	mš™Ÿl_scÜe_max
;

808 
u8
 
	mcu¼’t_cÚÃùiÚ_bÚus
;

811 
u8
 
	m§me_ÃtwÜk_bÚus
;

812 
u8
 
	m£cu»_bÚus
;

813 
u8
 
	mbªd_5g_bÚus
;

814 
u8
 
	mnum_ÃtwÜks
;

815 
¦si_•no_ssid_·¿m
 
	m•no_ssid
[];

818 
	s¦si_•no_hs2_·¿m
 {

819 
u32
 
	mid
;

820 
u8
 
	m»®m
[256];

821 
s64
 
	mrßmšg_cÚsÜtium_ids
[16];

822 
u8
 
	m¶mn
[3];

825 
	s¦si_rssi_mÚ™Ü_evt
 {

826 
s16
 
	mrssi
;

827 
u8
 
	mbssid
[
ETH_ALEN
];

831 
	s¦si_Îs_chªÃl_šfo
 {

832 
¦si_Îs_chªÃl_width
 
	mwidth
;

833 
	mûÁ”_äeq
;

834 
	mûÁ”_äeq0
;

835 
	mûÁ”_äeq1
;

839 
	s¦si_Îs_chªÃl_¡©
 {

840 
¦si_Îs_chªÃl_šfo
 
	mchªÃl
;

841 
u32
 
	mÚ_time
;

842 
u32
 
	mcÿ_busy_time
;

846 
	s¦si_Îs_¿‹
 {

847 
u32
 
	m´—mbË
 :3;

848 
u32
 
	mnss
 :2;

849 
u32
 
	mbw
 :3;

850 
u32
 
	m¿‹_mcs_idx
 :8;

851 
u32
 
	m»£rved
 :16;

852 
u32
 
	mb™¿‹
;

856 
	s¦si_Îs_¿‹_¡©
 {

857 
¦si_Îs_¿‹
 
	m¿‹
;

858 
u32
 
	mtx_mpdu
;

859 
u32
 
	mrx_mpdu
;

860 
u32
 
	mmpdu_lo¡
;

861 
u32
 
	m»Œ›s
;

862 
u32
 
	m»Œ›s_shÜt
;

863 
u32
 
	m»Œ›s_lÚg
;

867 
	s¦si_Îs_¿dio_¡©
 {

868 
	m¿dio
;

869 
u32
 
	mÚ_time
;

870 
u32
 
	mtx_time
;

871 
u32
 
	mrx_time
;

872 
u32
 
	mÚ_time_sÿn
;

873 
u32
 
	mÚ_time_nbd
;

874 
u32
 
	mÚ_time_gsÿn
;

875 
u32
 
	mÚ_time_rßm_sÿn
;

876 
u32
 
	mÚ_time_²o_sÿn
;

877 
u32
 
	mÚ_time_hs20
;

878 
u32
 
	mnum_chªÃls
;

879 
¦si_Îs_chªÃl_¡©
 
	mchªÃls
[];

882 
	s¦si_Îs_š‹rçû_lšk_Ïy”_šfo
 {

883 
¦si_Îs_š‹rçû_mode
 
	mmode
;

884 
u8
 
	mmac_addr
[6];

885 
¦si_Îs_cÚÃùiÚ_¡©e
 
	m¡©e
;

886 
¦si_Îs_rßm_¡©e
 
	mrßmšg
;

887 
u32
 
	mÿ·b™›s
;

888 
u8
 
	mssid
[33];

889 
u8
 
	mbssid
[6];

890 
u8
 
	m­_couÁry_¡r
[3];

891 
u8
 
	mcouÁry_¡r
[3];

895 
	s¦si_Îs_³”_šfo
 {

896 
¦si_Îs_³”_ty³
 
	mty³
;

897 
u8
 
	m³”_mac_add»ss
[6];

898 
u32
 
	mÿ·b™›s
;

899 
u32
 
	mnum_¿‹
;

900 
¦si_Îs_¿‹_¡©
 
	m¿‹_¡©s
[];

904 
	s¦si_Îs_wmm_ac_¡©
 {

905 
¦si_Îs_Œaffic_ac
 
	mac
;

906 
u32
 
	mtx_mpdu
;

907 
u32
 
	mrx_mpdu
;

908 
u32
 
	mtx_mÿ¡
;

909 
u32
 
	mrx_mÿ¡
;

910 
u32
 
	mrx_ampdu
;

911 
u32
 
	mtx_ampdu
;

912 
u32
 
	mmpdu_lo¡
;

913 
u32
 
	m»Œ›s
;

914 
u32
 
	m»Œ›s_shÜt
;

915 
u32
 
	m»Œ›s_lÚg
;

916 
u32
 
	mcÚ‹ÁiÚ_time_mš
;

917 
u32
 
	mcÚ‹ÁiÚ_time_max
;

918 
u32
 
	mcÚ‹ÁiÚ_time_avg
;

919 
u32
 
	mcÚ‹ÁiÚ_num_§m¶es
;

922 
	s¦si_rx_d©a_út_d‘as
 {

923 
	mrx_uniÿ¡_út
;

924 
	mrx_muÉiÿ¡_út
;

925 
	mrx_brßdÿ¡_út
;

928 
	s¦si_rx_wake_pkt_ty³_şassifiÿtiÚ
 {

929 
	micmp_pkt
;

930 
	micmp6_pkt
;

931 
	micmp6_¿
;

932 
	micmp6_Ç
;

933 
	micmp6_ns
;

936 
	s¦si_rx_muÉiÿ¡_út
 {

937 
	mv4_rx_muÉiÿ¡_addr_út
;

938 
	mv6_rx_muÉiÿ¡_addr_út
;

939 
	mÙh”_rx_muÉiÿ¡_addr_út
;

951 
	s¦si_wÏn_driv”_wake_»asÚ_út
 {

952 
	mtÙ®_cmd_ev’t_wake
;

953 *
	mcmd_ev’t_wake_út
;

954 
	mcmd_ev’t_wake_út_sz
;

955 
	mcmd_ev’t_wake_út_u£d
;

957 
	mtÙ®_driv”_fw_loÿl_wake
;

958 *
	mdriv”_fw_loÿl_wake_út
;

959 
	mdriv”_fw_loÿl_wake_út_sz
;

960 
	mdriv”_fw_loÿl_wake_út_u£d
;

962 
	mtÙ®_rx_d©a_wake
;

963 
¦si_rx_d©a_út_d‘as
 
	mrx_wake_d‘as
;

964 
¦si_rx_wake_pkt_ty³_şassifiÿtiÚ
 
	mrx_wake_pkt_şassifiÿtiÚ_šfo
;

965 
¦si_rx_muÉiÿ¡_út
 
	mrx_muÉiÿ¡_wake_pkt_šfo
;

968 
	s¦si_Æa_put
 {

969 
u32
 
	mÆa_ty³
;

970 
u32
 
	m©Œ
;

971 *
	mv®ue_±r
;

972 
	mv®ue_Ën
;

976 
	s¦si_Îs_içû_¡©
 {

977 *
	miçû
;

978 
¦si_Îs_š‹rçû_lšk_Ïy”_šfo
 
	mšfo
;

979 
u32
 
	mb—cÚ_rx
;

980 
u64
 
	mav”age_tsf_off£t
;

981 
u32
 
	mËaky_­_d‘eùed
;

982 
u32
 
	mËaky_­_avg_num_äames_Ëaked
;

983 
u32
 
	mËaky_­_gu¬d_time
;

984 
u32
 
	mmgmt_rx
;

985 
u32
 
	mmgmt_aùiÚ_rx
;

986 
u32
 
	mmgmt_aùiÚ_tx
;

987 
	mrssi_mgmt
;

988 
	mrssi_d©a
;

989 
	mrssi_ack
;

990 
¦si_Îs_wmm_ac_¡©
 
	mac
[
SLSI_LLS_AC_MAX
];

991 
u32
 
	mnum_³”s
;

992 
¦si_Îs_³”_šfo
 
	m³”_šfo
[];

995 
	e¦si_wifi_h®_­i_»tuº_ty³s
 {

996 
	mWIFI_HAL_SUCCESS
 = 0,

997 
	mWIFI_HAL_ERROR_NONE
 = 0,

998 
	mWIFI_HAL_ERROR_UNKNOWN
 = -1,

999 
	mWIFI_HAL_ERROR_UNINITIALIZED
 = -2,

1000 
	mWIFI_HAL_ERROR_NOT_SUPPORTED
 = -3,

1001 
	mWIFI_HAL_ERROR_NOT_AVAILABLE
 = -4,

1002 
	mWIFI_HAL_ERROR_INVALID_ARGS
 = -5,

1003 
	mWIFI_HAL_ERROR_INVALID_REQUEST_ID
 = -6,

1004 
	mWIFI_HAL_ERROR_TIMED_OUT
 = -7,

1005 
	mWIFI_HAL_ERROR_TOO_MANY_REQUESTS
 = -8,

1006 
	mWIFI_HAL_ERROR_OUT_OF_MEMORY
 = -9

1009 
	s¦si_¹t_ÿ·b™›s
 {

1010 
u8
 
	m¹t_Úe_sided_suµÜ‹d
;

1011 
u8
 
	m¹t_ám_suµÜ‹d
;

1012 
u8
 
	mlci_suµÜt
;

1013 
u8
 
	mlü_suµÜt
;

1014 
u8
 
	m´—mbË_suµÜt
;

1015 
u8
 
	mbw_suµÜt
;

1016 
u8
 
	m»¥Úd”_suµÜ‹d
;

1017 
u8
 
	mmc_v”siÚ
;

1023 
	s¦si_¹t_id_·¿ms
 {

1024 
u8
 
	mçpi_»q_id
;

1025 
u32
 
	mh®_»que¡_id
;

1026 
u8
 
	m³”_ty³
;

1027 
u32
 
	m³”_couÁ
;

1028 
u8
 
	m³”s
[];

1032 
	s¦si_¹t_cÚfig
 {

1033 
u8
 
	m³”_addr
[
ETH_ALEN
];

1034 
u8
 
	m¹t_³”
;

1035 
u8
 
	m¹t_ty³
;

1036 
u16
 
	mchªÃl_äeq
;

1037 
u16
 
	mchªÃl_šfo
;

1038 
u8
 
	mbur¡_³riod
;

1042 
u8
 
	mnum_bur¡
;

1053 
u8
 
	mnum_äames_³r_bur¡
;

1061 
u8
 
	mnum_»Œ›s_³r_ámr
;

1065 
u8
 
	mbur¡_du¿tiÚ
;

1074 
u16
 
	m´—mbË
;

1075 
u16
 
	mbw
;

1076 
u16
 
	mLCI_»que¡
;

1077 
u16
 
	mLCR_»que¡
;

1080 
	#MAX_24G_CHANNELS
 14

	)

1081 
	#MAX_5G_CHANNELS
 25

	)

1082 
	#MAX_CHAN_VALUE_ACS
 (
MAX_24G_CHANNELS
 + 
MAX_5G_CHANNELS
)

	)

1083 
	#MAX_AP_THRESHOLD
 10

	)

1085 
	s¦si_acs_chª_šfo
 {

1086 
u16
 
	mchª
;

1087 
u8
 
	mnum_­
;

1088 
u8
 
	mnum_bss_lßd_­
;

1089 
u8
 
	mtÙ®_chª_utiz©iÚ
;

1090 
u8
 
	mavg_chª_utiz©iÚ
;

1091 
	mrssi_çùÜ
;

1092 
	madj_rssi_çùÜ
;

1095 
	s¦si_acs_£Ëùed_chªÃls
 {

1096 
u8
 
	m´i_chªÃl
;

1097 
u8
 
	m£c_chªÃl
;

1098 
u8
 
	mvht_£g0_ûÁ”_ch
;

1099 
u8
 
	mvht_£g1_ûÁ”_ch
;

1100 
u16
 
	mch_width
;

1101 
¦si_acs_hw_mode
 
	mhw_mode
;

1104 
	s¦si_acs_»que¡
 {

1105 
¦si_acs_chª_šfo
 
	macs_chª_šfo
[
MAX_CHAN_VALUE_ACS
];

1106 
u8
 
	mhw_mode
;

1107 
u16
 
	mch_width
;

1108 
u8
 
	mch_li¡_Ën
;

1111 
¦si_Æ80211_v’dÜ_š™
(
¦si_dev
 *
sdev
);

1112 
¦si_Æ80211_v’dÜ_deš™
(
¦si_dev
 *
sdev
);

1113 
u8
 
¦si_gsÿn_g‘_sÿn_pŞicy
(
wifi_bªd
 
bªd
);

1114 
¦si_gsÿn_hªdË_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_dÚe
);

1115 
¦si_gsÿn_hash_»move
(
¦si_dev
 *
sdev
, 
u8
 *
mac
);

1116 
¦si_rx_signifiÿÁ_chªge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1117 
¦si_gsÿn_®loc_buck‘s
(
¦si_dev
 *
sdev
, 
¦si_gsÿn
 *
gsÿn
, 
num_buck‘s
);

1118 
¦si_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
ev’t_id
, cÚ¡ *
d©a
, 
Ën
);

1119 
¦si_mib_g‘_gsÿn_ÿp
(
¦si_dev
 *
sdev
, 
¦si_Æ_gsÿn_ÿ·b™›s
 *
ÿp
);

1120 
¦si_rx_rssi_»pÜt_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1121 
¦si_mib_g‘_­f_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

1122 
¦si_mib_g‘_¹t_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_¹t_ÿ·b™›s
 *
ÿp
);

1123 
¦si_rx_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1124 
¦si_rx_¿nge_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1125 
¦si_tx_¿‹_ÿlc
(
sk_buff
 *
Æ_skb
, 
u16
 
fw_¿‹
, 
»s
, 
boŞ
 
tx_¿‹
);

1126 
¦si_rx_ev’t_log_šdiÿtiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1127 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1128 *
¦si_´št_ev’t_Çme
(
ev’t_id
);

1131 
šlše
 
boŞ
 
	$¦si_is_gsÿn_id
(
u16
 
sÿn_id
)

1133 ià((
sÿn_id
 >ğ
SLSI_GSCAN_SCAN_ID_START
è&& (sÿn_id <ğ
SLSI_GSCAN_SCAN_ID_END
))

1134  
Œue
;

1136  
çl£
;

1137 
	}
}

1139 
šlše
 
¦si_Îs_Œaffic_ac
 
	$¦si_çpi_to_ªdroid_Œaffic_q
(
¦si_Œaffic_q
 
çpi_q
)

1141 
çpi_q
) {

1142 
SLSI_TRAFFIC_Q_BE
:

1143  
SLSI_LLS_AC_BE
;

1144 
SLSI_TRAFFIC_Q_BK
:

1145  
SLSI_LLS_AC_BK
;

1146 
SLSI_TRAFFIC_Q_VI
:

1147  
SLSI_LLS_AC_VI
;

1148 
SLSI_TRAFFIC_Q_VO
:

1149  
SLSI_LLS_AC_VO
;

1151  
SLSI_LLS_AC_MAX
;

1153 
	}
}

	@nl80211_vendor_nan.c

7 
	~"cfg80211_İs.h
"

8 
	~"debug.h
"

9 
	~"mgt.h
"

10 
	~"mlme.h
"

12 
Ãt_deviû
 *
	$¦si_Çn_g‘_Ãtdev
(
¦si_dev
 *
sdev
)

14 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

15  
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_NAN
);

17  
NULL
;

19 
	}
}

21 *
	$¦si_Çn_cÚv”t_by‹_to_¡ršg
(
Ëngth
, 
u8
 *
by‹_¡ršg
)

23 
šfo_¡ršg
[61] = {0};

24 
Ën
 = 
Ëngth
 > 20 ? 20 :†ength;

25 
i
 = 0, 
max_size
 = 61, 
¦’
 = 0;

27 
i
 = 0; i < 
Ën
 && 
¦’
 < 
max_size
 - 3; i++)

28 
¦’
 +ğ
	`¢´štf
(&
šfo_¡ršg
[¦’], 61 - sËn, "%02x ", 
by‹_¡ršg
[
i
]);

29 
šfo_¡ršg
[
¦’
] = '\0';

30  
šfo_¡ršg
;

31 
	}
}

33 
	$¦si_couÁ_£tb™s_u16
(
u16
 
n
)

35 
couÁ
 = 0;

37 
n
) {

38 
couÁ
 +ğ
n
 & 1;

39 
n
 >>= 1;

41  
couÁ
;

42 
	}
}

44 
	$¦si_Çn_dump_vif_d©a
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
)

46 
¦si_vif_Çn
 
Çn
 = 
ndev_vif
->nan;

47 
¦si_Çn_discov”y_šfo
 *
disc_šfo
 = 
Çn
.disc_info;

48 
i
 = 0;

50 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

51 
	`SLSI_INFO
(
sdev
, "S”viû Id_M­: 0x%x, fŞlowup_id_m­: 0x%x,‚dp_š¡ªû_id_m­: 0x%x\n", 
Çn
.
£rviû_id_m­
,

52 
Çn
.
fŞlowup_id_m­
,‚ª.
ndp_š¡ªû_id_m­
);

53 
	`SLSI_INFO
(
sdev
, "Ãxt_£rviû_id: 0x%x,‚ext_ndp_š¡ªû_id: 0x%x\n", 
Çn
.
Ãxt_£rviû_id
,‚ª.
Ãxt_ndp_š¡ªû_id
);

54 
i
 = 0; i < 
SLSI_NAN_MAX_NDP_INSTANCES
; i++) {

55 
	`SLSI_INFO
(
sdev
, "NDL Li¡…“r_nmi: " 
MACSTR
 ",‚dp_couÁ:%d\n", 
	`MAC2STR
(
Çn
.
ndl_li¡
[
i
].
³”_nmi
),

56 
Çn
.
ndl_li¡
[
i
].
ndp_couÁ
);

57 
	`SLSI_INFO
(
sdev
, "ndp_ndi: " 
MACSTR
 ",‚dp_š¡ªû_id2ndl_vif: %d\n", 
	`MAC2STR
(
Çn
.
ndp_ndi
[
i
]),‚ª.
ndp_š¡ªû_id2ndl_vif
[i]);

58 
	`SLSI_INFO
(
sdev
, "ndp_loÿl_ndp_š¡ªû_id: %d,‚dp_¡©e: %d\n", 
Çn
.
ndp_loÿl_ndp_š¡ªû_id
[
i
],‚ª.
ndp_¡©e
[i]);

60 
	`SLSI_INFO
(
sdev
, "di§bË_şu¡”_m”ge: %d\n", 
Çn
.
di§bË_şu¡”_m”ge
);

61 
i
 = 0; i < 
SLSI_NAN_MAX_SERVICE_ID
 + 1; i++)

62 
	`SLSI_INFO
(
sdev
, "Çn_sdf_æags: %d\n", 
Çn
.
Çn_sdf_æags
[
i
]);

63 
	`SLSI_INFO
(
sdev
, "loÿl_nmi: " 
MACSTR
 ", cluster_id: " MACSTR "\n",

64 
	`MAC2STR
(
Çn
.
loÿl_nmi
), MAC2STR(
sdev
->
Çn_şu¡”_id
));

65 
	`SLSI_INFO
(
sdev
, "¡©e: %d,„Şe: %d, o³¿tšg_chªÃl: %d, %d\n", 
Çn
.
¡©e
,‚ª.
rŞe
,

66 
Çn
.
İ”©šg_chªÃl
[0],‚an.operating_channel[1]);

67 
	`SLSI_INFO
(
sdev
, "master_pref_value: %d,‡mr: 0x%08x%08x, hopcount: %d\n",

68 
Çn
.
ma¡”_´ef_v®ue
,‚ª.
amr_high”
,‚ª.
amr_low”
,‚ª.
hİcouÁ
);

69 
	`SLSI_INFO
(
sdev
, "¿ndom_mac_š‹rv®_£c: %d\n", 
Çn
.
¿ndom_mac_š‹rv®_£c
);

70 
	`SLSI_INFO
(
sdev
, "m©chid: %d\n", 
Çn
.
m©chid
);

71 
disc_šfo
) {

72 
	`SLSI_INFO
(
sdev
, "Disc_InfØ³”_addr: " 
MACSTR
 ", sessiÚ_id: %d, m©ch_id: %d", 
	`MAC2STR
(
disc_šfo
->
³”_addr
),

73 
disc_šfo
->
£ssiÚ_id
, disc_šfo->
m©ch_id
);

74 
disc_šfo
 = disc_šfo->
Ãxt
;

76 
	}
}

78 
	$¦si_Çn_dump_ndp_³”_šfo
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Çn_mgmt_dev
,

79 
Ãt_deviû
 *
d©a_dev
)

81 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

82 
i
;

83 
¦si_³”
 *
³”
;

84 
u32
 
ndp_š¡ªû_id
;

86 
i
 = 0; i < 
SLSI_NAN_MAX_NDP_INSTANCES
 + 1; i++) {

87 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

88 ià(
³”
 &&…“r->
v®id
) {

89 
ndp_š¡ªû_id
 = 
	`¦si_Çn_g‘_ndp_äom_ndl_loÿl_ndi
(
Çn_mgmt_dev
, 
³”
->
ndl_vif
, 
d©a_dev
->
dev_addr
);

90 
	`SLSI_INFO
(
sdev
, "PeerIdx:%d,‚dpInstId:%d,‚dl_vif:%d,…eer‚dpCount:%d\n",

91 
i
, 
ndp_š¡ªû_id
, 
³”
->
ndl_vif
,…“r->
ndp_couÁ
);

94 
	}
}

96 
	$¦si_Çn_dump_ndp_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Çn_mgmt_dev
)

98 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
Çn_mgmt_dev
);

99 
Ãt_deviû
 *
d©a_dev
;

100 
¦si_Çn_ndl_šfo
 *
ndl_li¡
 = 
ndev_vif
->
Çn
.ndl_list;

101 
tÙ®ndpcouÁ
 = 0;

102 
i
;

104 
tÙ®ndpcouÁ
 = 
	`¦si_couÁ_£tb™s_u16
(
ndev_vif
->
Çn
.
ndp_aùive_id_m­
);

105 
	`SLSI_INFO
(
sdev
, "NDP MAP:0x%08x NDP CouÁ %d\n", 
ndev_vif
->
Çn
.
ndp_š¡ªû_id_m­
, 
tÙ®ndpcouÁ
);

106 
	`SLSI_INFO
(
sdev
, "ndl_list:[%pM,%d][%pM,%d][%pM,%d][%pM,%d][%pM,%d][%pM,%d][%pM,%d][%pM,%d]\n",

107 
ndl_li¡
[0].
³”_nmi
,‚dl_li¡[0].
ndp_couÁ
,

108 
ndl_li¡
[1].
³”_nmi
,‚dl_li¡[1].
ndp_couÁ
,

109 
ndl_li¡
[2].
³”_nmi
,‚dl_li¡[2].
ndp_couÁ
,

110 
ndl_li¡
[3].
³”_nmi
,‚dl_li¡[3].
ndp_couÁ
,

111 
ndl_li¡
[4].
³”_nmi
,‚dl_li¡[4].
ndp_couÁ
,

112 
ndl_li¡
[5].
³”_nmi
,‚dl_li¡[5].
ndp_couÁ
,

113 
ndl_li¡
[6].
³”_nmi
,‚dl_li¡[6].
ndp_couÁ
,

114 
ndl_li¡
[7].
³”_nmi
,‚dl_li¡[7].
ndp_couÁ
);

115 
	`SLSI_INFO
(
sdev
, "ndp_ndiable: [%pM][%pM][%pM][%pM][%pM][%pM][%pM][%pM]\n",

116 
ndev_vif
->
Çn
.
ndp_ndi
[0],‚dev_vif->nan.ndp_ndi[1],‚dev_vif->nan.ndp_ndi[2],

117 
ndev_vif
->
Çn
.
ndp_ndi
[3],‚dev_vif->nan.ndp_ndi[4],‚dev_vif->nan.ndp_ndi[5],

118 
ndev_vif
->
Çn
.
ndp_ndi
[6],‚dev_vif->nan.ndp_ndi[7]);

119 
	`SLSI_INFO
(
sdev
, "ndp_instance_id2ndl_vif: [%d, %d, %d, %d, %d, %d, %d, %d]\n",

120 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[0],‚dev_vif->nan.ndp_instance_id2ndl_vif[1],

121 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[2],‚dev_vif->nan.ndp_instance_id2ndl_vif[3],

122 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[4],‚dev_vif->nan.ndp_instance_id2ndl_vif[5],

123 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[6],‚dev_vif->nan.ndp_instance_id2ndl_vif[7]);

124 
i
 = 
SLSI_NAN_DATA_IFINDEX_START
; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

125 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

126 ià(!
d©a_dev
)

128 
	`¦si_Çn_dump_ndp_³”_šfo
(
sdev
, 
Çn_mgmt_dev
, 
d©a_dev
);

130 
	}
}

132 
	$¦si_Çn_g‘_Ãw_id
(
u32
 
id_m­
, 
max_ids
, 
¡¬t_idx
)

134 
i
;

136 ià(
¡¬t_idx
 > 
max_ids
)

139 ià(!
¡¬t_idx
)

140 
¡¬t_idx
 = 1;

142 
i
 = 
¡¬t_idx
; i <ğ
max_ids
; i++) {

143 ià(!(
id_m­
 & 
	`BIT
(
i
)))

144  
i
;

146 
i
 = 1; i < 
¡¬t_idx
; i++) {

147 ià(!(
id_m­
 & 
	`BIT
(
i
)))

148  
i
;

151 
	}
}

153 
	$¦si_Çn_g‘_Ãw_publish_id
(
Ãtdev_vif
 *
ndev_vif
)

155 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

156  
	`¦si_Çn_g‘_Ãw_id
(
ndev_vif
->
Çn
.
£rviû_id_m­
, 
SLSI_NAN_MAX_SERVICE_ID
,

157 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
);

158 
	}
}

160 
	$¦si_Çn_g‘_Ãw_subsüibe_id
(
Ãtdev_vif
 *
ndev_vif
)

162 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

163  
	`¦si_Çn_g‘_Ãw_id
(
ndev_vif
->
Çn
.
£rviû_id_m­
, 
SLSI_NAN_MAX_SERVICE_ID
,

164 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
);

165 
	}
}

167 
boŞ
 
	$¦si_Çn_is_publish_id_aùive
(
Ãtdev_vif
 *
ndev_vif
, 
u32
 
id
)

169 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

170  
ndev_vif
->
Çn
.
£rviû_id_m­
 & 
	`BIT
(
id
);

171 
	}
}

173 
boŞ
 
	$¦si_Çn_is_subsüibe_id_aùive
(
Ãtdev_vif
 *
ndev_vif
, 
u32
 
id
)

175 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

176  
ndev_vif
->
Çn
.
£rviû_id_m­
 & 
	`BIT
(
id
);

177 
	}
}

179 
	$¦si_Çn_g‘_Ãw_ndp_š¡ªû_id
(
Ãtdev_vif
 *
ndev_vif
)

181 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

182  
	`¦si_Çn_g‘_Ãw_id
(
ndev_vif
->
Çn
.
ndp_š¡ªû_id_m­
, 
SLSI_NAN_MAX_NDP_INSTANCES
,

183 
ndev_vif
->
Çn
.
Ãxt_ndp_š¡ªû_id
);

184 
	}
}

186 
	$¦si_Çn_push_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
, u16 
Œªs_id
)

188 
i
;

189 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

191 
i
 = 0; i < 
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
; i++) {

192 ià(!
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0]) {

193 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] = 
m©ch_id
;

194 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][1] = 
Œªs_id
;

195  
i
;

200 
	}
}

202 
	$¦si_Çn_pİ_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
)

204 
i
;

205 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

207 
i
 = 0; i < 
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
; i++) {

208 ià(
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] =ğ
m©ch_id
) {

209 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] = 0;

210 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][1] = 0;

214 
	}
}

216 
u16
 
	$¦si_Çn_g‘_fŞlowup_Œªs_id
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
m©ch_id
)

218 
i
;

220 
i
 = 0; i < 
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
; i++) {

221 ià(
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] =ğ
m©ch_id
)

222  
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][1];

225 
	}
}

227 
	$¦si_Çn_´e_check
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
»t
, *
»¶y_¡©us
)

229 *
»t
 = 
WIFI_HAL_SUCCESS
;

230 *
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

231 ià(!
dev
) {

232 
	`SLSI_ERR
(
sdev
, "No NAN interface\n");

233 *
»t
 = -
WIFI_HAL_ERROR_NOT_SUPPORTED
;

234 *
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

237 ià(!
	`¦si_dev_Çn_suµÜ‹d
(
sdev
)) {

238 
	`SLSI_ERR
(
sdev
, "NAN‚Ù‡Îowed(mib:%d)\n", sdev->
Çn_’abËd
);

239 *
»t
 = 
WIFI_HAL_ERROR_NOT_SUPPORTED
;

240 *
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

242 
	}
}

244 
	$¦si_Çn_ndp_Ãw_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
,

245 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
, u8 *
³”_nmi
)

247 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

248 
u16
 
ndl_id
;

250 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

252 ià(
ndl_vif_id
 < 
SLSI_NAN_DATA_IFINDEX_START
 ||

253 
ndl_vif_id
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 + 
SLSI_NAN_MAX_NDP_INSTANCES
) {

254 
	`SLSI_ERR
(
sdev
, "Inv®id‚dl_vif:%d\n", 
ndl_vif_id
);

258 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

259 
	`SLSI_ERR
(
sdev
, "Inv®id‚dp:%d\n", 
ndp_š¡ªû_id
);

263 
ndl_id
 = 
ndl_vif_id
 - 
SLSI_NAN_DATA_IFINDEX_START
;

264 ià(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 < 0 ||

265 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

266 
	`SLSI_WARN
(
sdev
, "improper‚dp count(%d) for vif_id(%d)\n",

267 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
, 
ndl_vif_id
);

270 
ndev_vif
->
Çn
.
ndp_š¡ªû_id_m­
 |ğ(
u32
)
	`BIT
(
ndp_š¡ªû_id
);

271 ià(
³”_nmi
)

272 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
³”_nmi
,…eer_nmi);

273 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
++;

274 ià(
loÿl_ndi
)

275 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1], 
loÿl_ndi
);

276 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1] = 
ndl_vif_id
;

277 
ndev_vif
->
Çn
.
ndp_¡©e
[
ndp_š¡ªû_id
 - 1] = 
ndp_¦Ù_¡©us_š_u£
;

279 
	}
}

281 
	$¦si_Çn_ndp_d–_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
, cÚ¡ 
boŞ
 
ndl_vif_locked
)

283 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

284 
Ãtdev_vif
 *
ndev_d©a_vif
;

285 
Ãt_deviû
 *
d©a_dev
;

286 
u16
 
ndl_vif_id
, 
ndl_id
;

288 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

290 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

291 
	`SLSI_WARN
(
sdev
, "Inv®id‚d°In¡ªû Id:%d\n", 
ndp_š¡ªû_id
);

295 
ndl_vif_id
 = 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1];

296 ià(
ndl_vif_id
 < 
SLSI_NAN_DATA_IFINDEX_START
 ||

297 
ndl_vif_id
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 + 
SLSI_NAN_MAX_NDP_INSTANCES
) {

298 
	`SLSI_WARN
(
sdev
, "Inv®id‚dl_vif:%d\n", 
ndl_vif_id
);

302 
ndl_id
 = 
ndl_vif_id
 - 
SLSI_NAN_DATA_IFINDEX_START
;

303 
ndev_vif
->
Çn
.
ndp_š¡ªû_id_m­
 &ğ~(
u32
)
	`BIT
(
ndp_š¡ªû_id
);

304 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
--;

305 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr_locked
(
sdev
, 
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1],

306 
SLSI_NAN_DATA_IFINDEX_START
);

307 ià(
d©a_dev
) {

308 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

309 ià(!
ndl_vif_locked
)

310 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

312 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_d©a_vif
->
vif_mu‹x
));

313 ià(
ndev_d©a_vif
->
Çn
.
ndp_couÁ
 == 0)

314 
ndev_d©a_vif
->
aùiv©ed
 = 
çl£
;

315 ià(!
ndl_vif_locked
)

316 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

318 ià(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 == 0)

319 
	`¦si_‘h_z”o_addr
(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
³”_nmi
);

320 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1] = 0;

321 
	`¦si_‘h_z”o_addr
(
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1]);

322 ià(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 < 0)

323 
	`SLSI_WARN
(
sdev
, "ndp_count is‚egative %d for‚dl idx %d\n",

324 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
,‚dl_id);

325 
ndev_vif
->
Çn
.
ndp_¡©e
[
ndp_š¡ªû_id
 - 1] = 
ndp_¦Ù_¡©us_ä“
;

326 
	}
}

328 
u16
 
	$¦si_Çn_ndp_g‘_ndl_vif_id
(
u8
 *
³”_mni
, 
¦si_Çn_ndl_šfo
 *
ndl_li¡
)

330 
u16
 
i
, 
ä“_idx
 = 
SLSI_NAN_MAX_NDP_INSTANCES
 + 
SLSI_NAN_DATA_IFINDEX_START
;

332 
i
 = 0; i < 
SLSI_NAN_MAX_NDP_INSTANCES
; i++) {

333 ià(
	`‘h”_addr_equ®
(
³”_mni
, 
ndl_li¡
[
i
].
³”_nmi
))

334  
i
 + 
SLSI_NAN_DATA_IFINDEX_START
;

335 ià(
ä“_idx
 =ğ
SLSI_NAN_MAX_NDP_INSTANCES
 + 
SLSI_NAN_DATA_IFINDEX_START
 &&

336 
ndl_li¡
[
i
].
ndp_couÁ
 == 0)

337 
ä“_idx
 = 
i
 + 
SLSI_NAN_DATA_IFINDEX_START
;

339  
ä“_idx
;

340 
	}
}

342 
	$¦si_Çn_g‘_mac
(
¦si_dev
 *
sdev
, *
Çn_mac_addr
)

344 
	`mem£t
(
Çn_mac_addr
, 0, 
ETH_ALEN
);

345 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

346 ià(
	`¦si_dev_Çn_suµÜ‹d
(
sdev
))

347 
	`‘h”_addr_cİy
(
Çn_mac_addr
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
]);

349 
	}
}

351 
	$¦si_purge_Çn_discov”y_šfo
(
Ãtdev_vif
 *
ndev_vif
)

353 
¦si_Çn_discov”y_šfo
 *
discov”yšfo
;

354 
¦si_Çn_discov”y_šfo
 *
´ev
 = 
NULL
;

356 
discov”yšfo
 = 
ndev_vif
->
Çn
.
disc_šfo
;

357 
discov”yšfo
) {

358 
´ev
 = 
discov”yšfo
;

359 
discov”yšfo
 = discov”yšfo->
Ãxt
;

360 
	`kä“
(
´ev
);

362 
	}
}

364 
	$¦si_add_Çn_discov”y_šfo
(
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
addr
, 
u16
 
publish_subsüibe_id
, 
u32
 
»q_š¡ªû_id
)

366 
¦si_Çn_discov”y_šfo
 *
discov”yšfo
;

367 
¦si_Çn_discov”y_šfo
 *
h—d
 = 
ndev_vif
->
Çn
.
disc_šfo
;

369 
discov”yšfo
 = 
	`kz®loc
((*discov”yšfo), 
GFP_KERNEL
);

370 ià(!
discov”yšfo
)

372 
	`‘h”_addr_cİy
(
discov”yšfo
->
³”_addr
, 
addr
);

373 
discov”yšfo
->
£ssiÚ_id
 = 
publish_subsüibe_id
;

374 
discov”yšfo
->
m©ch_id
 = 
»q_š¡ªû_id
;

375 
discov”yšfo
->
Ãxt
 = 
h—d
;

376 
ndev_vif
->
Çn
.
disc_šfo
 = 
discov”yšfo
;

377 
	}
}

379 
	$¦si_v’dÜ_Çn_commªd_»¶y
(
why
 *why, 
u32
 
¡©us
, u32 
”rÜ
, u32 
»¥Ú£_ty³
,

380 
u16
 
id
, 
¦si_h®_Çn_ÿ·b™›s
 *
ÿ·b™›s
, u16 
»q_id
, 
Ãtdev_vif
 *
ndev_vif
)

382 
sk_buff
 *
»¶y
;

383 
u8
 
mac_addr
[
ETH_ALEN
] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

384 
»t
 = 0;

386 
»¶y
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
NLMSG_DEFAULT_SIZE
);

387 ià(!
»¶y
) {

388 
	`SLSI_WARN_NODEV
("SKB‡lloc failed for vendor_cmd„eply\n");

392 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_STATUS_TYPE
, 
¡©us
);

393 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_VALUE
, 
”rÜ
);

394 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_RESPONSE_TYPE
, 
»¥Ú£_ty³
);

395 
»t
 |ğ
	`Æa_put_u16
(
»¶y
, 
NAN_REPLY_ATTR_HAL_TRANSACTION_ID
, 
»q_id
);

396 ià(
»¥Ú£_ty³
 =ğ
NAN_RESPONSE_ENABLED
) {

397 ià(
ndev_vif
)

398 
»t
 |ğ
	`Æa_put
(
»¶y
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
, 
ETH_ALEN
, 
ndev_vif
->
Çn
.
loÿl_nmi
);

400 
»t
 |ğ
	`Æa_put
(
»¶y
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
, 
ETH_ALEN
, 
mac_addr
);

402 ià(
ÿ·b™›s
) {

403 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_CONCURRENT_CLUSTER
,

404 
ÿ·b™›s
->
max_cÚcu¼’t_Çn_şu¡”s
);

405 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_PUBLISHES
, 
ÿ·b™›s
->
max_publishes
);

406 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SUBSCRIBES
, 
ÿ·b™›s
->
max_subsüibes
);

407 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SERVICE_NAME_LEN
, 
ÿ·b™›s
->
max_£rviû_Çme_Ën
);

408 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_MATCH_FILTER_LEN
, 
ÿ·b™›s
->
max_m©ch_f‹r_Ën
);

409 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_TOTAL_MATCH_FILTER_LEN
,

410 
ÿ·b™›s
->
max_tÙ®_m©ch_f‹r_Ën
);

411 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SERVICE_SPECIFIC_INFO_LEN
,

412 
ÿ·b™›s
->
max_£rviû_¥ecific_šfo_Ën
);

413 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_VSA_DATA_LEN
, 
ÿ·b™›s
->
max_v§_d©a_Ën
);

414 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_MESH_DATA_LEN
, 
ÿ·b™›s
->
max_mesh_d©a_Ën
);

415 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_NDI_INTERFACES
, 
ÿ·b™›s
->
max_ndi_š‹rçûs
);

416 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_NDP_SESSIONS
, 
ÿ·b™›s
->
max_ndp_£ssiÚs
);

417 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_APP_INFO_LEN
, 
ÿ·b™›s
->
max_­p_šfo_Ën
);

418 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_QUEUED_TRANSMIT_FOLLOWUP_MGS
,

419 
ÿ·b™›s
->
max_queued_Œªsm™_fŞlowup_msgs
);

420 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SUBSCRIBE_ADDRESS
,

421 
ÿ·b™›s
->
max_subsüibe_add»ss
);

422 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_CIPHER_SUITES_SUPPORTED
,

423 
ÿ·b™›s
->
ch”_su™es_suµÜ‹d
);

424 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SDEA_SERVICE_SPECIFIC_INFO_LEN
,

425 
ÿ·b™›s
->
max_sd—_£rviû_¥ecific_šfo_Ën
);

426 } ià(
id
) {

427 ià(
»¥Ú£_ty³
 < 
NAN_DP_INTERFACE_CREATE
)

428 
»t
 |ğ
	`Æa_put_u16
(
»¶y
, 
NAN_REPLY_ATTR_PUBLISH_SUBSCRIBE_TYPE
, 
id
);

430 
»t
 |ğ
	`Æa_put_u16
(
»¶y
, 
NAN_REPLY_ATTR_NDP_INSTANCE_ID
, 
id
);

433 ià(
»t
) {

434 
	`SLSI_ERR_NODEV
("E¼Ü iÀÆa_put:%x\n", 
»t
);

435 
	`kä“_skb
(
»¶y
);

436 } ià(
	`cfg80211_v’dÜ_cmd_»¶y
(
»¶y
)) {

437 
	`SLSI_ERR_NODEV
("FAILEDØ»¶y‚ª cßmmnd.„e¥Ú£_ty³:%d\n", 
»¥Ú£_ty³
);

439 
	}
}

441 
	$¦si_Çn_g‘_sd—_·¿ms_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_sd—_ù¾_·¿ms
 *
sd—_·¿ms
,

442 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

444 
Æ_©Œ_id
) {

445 
NAN_REQ_ATTR_SDEA_PARAM_NDP_TYPE
:

446 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
ndp_ty³
);

447 
sd—_·¿ms
->
cÚfig_Çn_d©a_·th
 = 1;

449 
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
:

450 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
£cur™y_cfg
);

451 
sd—_·¿ms
->
cÚfig_Çn_d©a_·th
 = 1;

453 
NAN_REQ_ATTR_SDEA_PARAM_RANGING_STATE
:

454 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
¿ngšg_¡©e
);

456 
NAN_REQ_ATTR_SDEA_PARAM_RANGE_REPORT
:

457 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
¿nge_»pÜt
);

459 
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
:

460 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
qos_cfg
);

463  -
EINVAL
;

466 
	}
}

468 
	$¦si_Çn_g‘_¿ngšg_cfg_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_¿ngšg_cfg
 *
¿ngšg_cfg
,

469 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

471 
Æ_©Œ_id
) {

472 
NAN_REQ_ATTR_RANGING_CFG_INTERVAL
:

473 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
¿ngšg_š‹rv®_m£c
);

475 
NAN_REQ_ATTR_RANGING_CFG_INDICATION
:

476 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
cÚfig_¿ngšg_šdiÿtiÚs
);

478 
NAN_REQ_ATTR_RANGING_CFG_INGRESS_MM
:

479 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
di¡ªû_šg»ss_mm
);

481 
NAN_REQ_ATTR_RANGING_CFG_EGRESS_MM
:

482 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
di¡ªû_eg»ss_mm
);

485  -
EINVAL
;

488 
	}
}

490 
	$¦si_Çn_g‘_£cur™y_šfo_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_£cur™y_šfo
 *
£c_šfo
,

491 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

493 
u32
 
key_ty³
;

495 
Æ_©Œ_id
) {

496 
NAN_REQ_ATTR_CIPHER_TYPE
:

497 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
ch”_ty³
);

499 
NAN_REQ_ATTR_SECURITY_KEY_TYPE
:

500 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
key_ty³
);

501 
£c_šfo
->
key_šfo
.
key_ty³
 = key_type;

503 
NAN_REQ_ATTR_SECURITY_PMK_LEN
:

504 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.
pmk_Ën
);

506 
NAN_REQ_ATTR_SECURITY_PMK
:

507 ià(
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.
pmk_Ën
 > 
SLSI_NAN_PMK_INFO_LEN
)

508  -
EINVAL
;

509 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.
pmk_Ën
,

510 
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.
pmk
);

512 
NAN_REQ_ATTR_SECURITY_PASSPHRASE_LEN
:

513 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.
·s¥h¿£_Ën
);

515 
NAN_REQ_ATTR_SECURITY_PASSPHRASE
:

516 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.
·s¥h¿£_Ën
,

517 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.
·s¥h¿£
);

519 
NAN_REQ_ATTR_SCID_LEN
:

520 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
scid_Ën
);

522 
NAN_REQ_ATTR_SCID
:

523 ià(
£c_šfo
->
scid_Ën
 > (£c_šfo->
scid
))

524 
£c_šfo
->
scid_Ën
 = (£c_šfo->
scid
);

525 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
£c_šfo
->
scid_Ën
, sec_šfo->
scid
);

528  -
EINVAL
;

531 
	}
}

533 
	$¦si_Çn_g‘_¿nge_»¥_cfg_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_¿nge_»¥Ú£_cfg
 *
cfg
,

534 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

536 
u16
 
¿nge_»¥Ú£
;

538 
Æ_©Œ_id
) {

539 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PUBLISH_ID
:

540 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
cfg
->
publish_id
);

543 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_REQUESTOR_ID
:

544 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
cfg
->
»que¡Ü_š¡ªû_id
);

547 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PEER_ADDR
:

548 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, 
cfg
->
³”_addr
);

551 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_RANGING_RESPONSE
:

552 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
¿nge_»¥Ú£
);

553 
cfg
->
¿ngšg_»¥Ú£
 = 
¿nge_»¥Ú£
;

557  -
EINVAL
;

560 
	}
}

564 
	$¦si_Çn_’abË_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
,

565 cÚ¡ *
d©a
, 
Ën
)

567 
ty³
, 
tmp
;

568 cÚ¡ 
Æ©Œ
 *
™”
;

569 
u8
 
v®
 = 0;

570 
u32
 
¿ndom_š‹rv®
 = 0, 
chªÃl_5g_v®
 = 0;

571 #ifdeà
SCSC_SEP_VERSION


572 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

573 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

576 
	`mem£t
(
h®_»q
, 0, (*hal_req));

577 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

578 
ty³
 = 
	`Æa_ty³
(
™”
);

579 
ty³
) {

580 
NAN_REQ_ATTR_MASTER_PREF
:

581 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ma¡”_´ef
);

584 
NAN_REQ_ATTR_CLUSTER_LOW
:

585 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
şu¡”_low
);

588 
NAN_REQ_ATTR_CLUSTER_HIGH
:

589 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
şu¡”_high
);

592 
NAN_REQ_ATTR_SUPPORT_5G_VAL
:

593 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
suµÜt_5g_v®
);

594 
h®_»q
->
cÚfig_suµÜt_5g
 = 1;

597 
NAN_REQ_ATTR_SID_BEACON_VAL
:

598 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sid_b—cÚ_v®
);

599 
h®_»q
->
cÚfig_sid_b—cÚ
 = 1;

602 
NAN_REQ_ATTR_RSSI_CLOSE_2G4_VAL
:

603 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_2dÙ4g_v®
);

604 
h®_»q
->
cÚfig_2dÙ4g_rssi_şo£
 = 1;

607 
NAN_REQ_ATTR_RSSI_MIDDLE_2G4_VAL
:

608 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_middË_2dÙ4g_v®
);

609 
h®_»q
->
cÚfig_2dÙ4g_rssi_middË
 = 1;

612 
NAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
:

613 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_´oxim™y_2dÙ4g_v®
);

614 
h®_»q
->
cÚfig_2dÙ4g_rssi_´oxim™y
 = 1;

617 
NAN_REQ_ATTR_HOP_COUNT_LIMIT_VAL
:

618 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
hİ_couÁ_lim™_v®
);

619 
h®_»q
->
cÚfig_hİ_couÁ_lim™
 = 1;

622 
NAN_REQ_ATTR_SUPPORT_2G4_VAL
:

623 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
suµÜt_2dÙ4g_v®
);

624 
h®_»q
->
cÚfig_2dÙ4g_suµÜt
 = 1;

627 
NAN_REQ_ATTR_BEACONS_2G4_VAL
:

628 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
b—cÚ_2dÙ4g_v®
);

629 
h®_»q
->
cÚfig_2dÙ4g_b—cÚs
 = 1;

632 
NAN_REQ_ATTR_SDF_2G4_VAL
:

633 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sdf_2dÙ4g_v®
);

634 
h®_»q
->
cÚfig_2dÙ4g_sdf
 = 1;

637 
NAN_REQ_ATTR_BEACON_5G_VAL
:

638 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
b—cÚ_5g_v®
);

639 
h®_»q
->
cÚfig_5g_b—cÚs
 = 1;

642 
NAN_REQ_ATTR_SDF_5G_VAL
:

643 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sdf_5g_v®
);

644 
h®_»q
->
cÚfig_5g_sdf
 = 1;

647 
NAN_REQ_ATTR_RSSI_CLOSE_5G_VAL
:

648 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_5g_v®
);

649 
h®_»q
->
cÚfig_5g_rssi_şo£
 = 1;

652 
NAN_REQ_ATTR_RSSI_MIDDLE_5G_VAL
:

653 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_middË_5g_v®
);

654 
h®_»q
->
cÚfig_5g_rssi_middË
 = 1;

657 
NAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
:

658 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_´oxim™y_5g_v®
);

659 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 = 1;

662 
NAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
:

663 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_wšdow_size_v®
);

664 
h®_»q
->
cÚfig_rssi_wšdow_size
 = 1;

667 
NAN_REQ_ATTR_OUI_VAL
:

668 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
oui_v®
);

669 
h®_»q
->
cÚfig_oui
 = 1;

672 
NAN_REQ_ATTR_MAC_ADDR_VAL
:

673 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, 
h®_»q
->
štf_addr_v®
);

674 
h®_»q
->
cÚfig_štf_addr
 = 1;

677 
NAN_REQ_ATTR_CLUSTER_VAL
:

678 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚfig_şu¡”_©Œibu‹_v®
);

681 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
:

682 
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
),

683 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
);

684 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

687 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
:

688 
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
),

689 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
);

690 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

693 
NAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
:

694 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ndom_çùÜ_fÜû_v®
);

695 
h®_»q
->
cÚfig_¿ndom_çùÜ_fÜû
 = 1;

698 
NAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
:

699 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
hİ_couÁ_fÜû_v®
);

700 
h®_»q
->
cÚfig_hİ_couÁ_fÜû
 = 1;

703 
NAN_REQ_ATTR_CHANNEL_2G4_MHZ_VAL
:

704 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
chªÃl_24g_v®
);

705 
h®_»q
->
cÚfig_24g_chªÃl
 = 1;

708 
NAN_REQ_ATTR_CHANNEL_5G_MHZ_VAL
:

709 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
chªÃl_5g_v®
);

710 
h®_»q
->
chªÃl_5g_v®
 = ()channel_5g_val;

711 
h®_»q
->
cÚfig_5g_chªÃl
 = 1;

714 
NAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
:

715 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

716 
h®_»q
->
subsüibe_sid_b—cÚ_v®
 = (
u32
)
v®
;

717 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 = 1;

720 
NAN_REQ_ATTR_DW_2G4_INTERVAL
:

721 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

722 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 = (
u32
)
v®
;

724 ià(
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 > 0 && hal_req->dw_2dot4g_interval_val < 5)

725 
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
 = 1;

728 
NAN_REQ_ATTR_DW_5G_INTERVAL
:

729 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

730 
h®_»q
->
dw_5g_š‹rv®_v®
 = (
u32
)
v®
;

732 ià(
h®_»q
->
dw_5g_š‹rv®_v®
 < 5)

733 
h®_»q
->
cÚfig_5g_dw_bªd
 = 1;

736 
NAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
:

737 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ndom_š‹rv®
);

738 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

739 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 
¿ndom_š‹rv®
;

741 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 0;

742 #ifdeà
SCSC_SEP_VERSION


743 
¿ndom_š‹rv®
 =„ªdom_š‹rv® & 
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
;

744 ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
) {

745 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 0;

746 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

747 } ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_DISABLE_MASK
) {

748 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 1;

749 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

754 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

755 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

757 
NAN_REQ_ATTR_DISCOVERY_BEACON_INT
:

758 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
);

760 
NAN_REQ_ATTR_NSS
:

761 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
nss_discov”y
);

763 
NAN_REQ_ATTR_ENABLE_RANGING
:

764 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_¿ngšg
);

766 
NAN_REQ_ATTR_DW_EARLY_TERMINATION
:

767 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_dw_—¾y_‹rmš©iÚ
);

770 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NANƒÇbË‡‰ribu‹ TYPE:%d\n", 
ty³
);

773  
SLSI_HAL_NAN_STATUS_SUCCESS
;

774 
	}
}

776 
	$¦si_Çn_’abË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

778 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

779 
¦si_h®_Çn_’abË_»q
 
h®_»q
;

780 
»t
;

781 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

782 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

783 
u8
 
Çn_vif_mac_add»ss
[
ETH_ALEN
];

784 
u8
 
brßdÿ¡_mac
[
ETH_ALEN
] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};

785 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

787 
h®_»q
.
Œª§ùiÚ_id
 = 0;

788 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

789 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

790 
ex™
;

792 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

794 
»¶y_¡©us
 = 
	`¦si_Çn_’abË_g‘_Æ_·¿ms
(
sdev
, &
h®_»q
, 
d©a
, 
Ën
);

795 ià(
»¶y_¡©us
 !ğ
SLSI_HAL_NAN_STATUS_SUCCESS
) {

796 
»t
 = -
EINVAL
;

797 
ex™
;

800 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

801 ià(
ndev_vif
->
aùiv©ed
) {

802 
»t
 = -
EINVAL
;

803 
	`SLSI_DBG1
(
sdev
, 
SLSI_GSCAN
, "Already Enabled. Req Rejected\n");

804 
ex™_w™h_mu‹x
;

806 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_NAN
;

807 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

808 
	`¦si_Ãt_¿ndomize_nmi_ndi
(
sdev
);

810 ià(
h®_»q
.
cÚfig_štf_addr
)

811 
	`‘h”_addr_cİy
(
Çn_vif_mac_add»ss
, 
h®_»q
.
štf_addr_v®
);

813 
	`¦si_Çn_g‘_mac
(
sdev
, 
Çn_vif_mac_add»ss
);

815 
»t
 = 
	`¦si_mlme_add_vif
(
sdev
, 
dev
, 
Çn_vif_mac_add»ss
, 
brßdÿ¡_mac
);

816 ià(
»t
) {

817 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

818 
	`SLSI_ERR
(
sdev
, "failedo‡dd‚an vif. Cannot start NAN\n");

820 
ndev_vif
->
Çn
.
Çn_’abË_¡©us
 = 0;

821 
»t
 = 
	`¦si_mlme_Çn_’abË
(
sdev
, 
dev
, &
h®_»q
);

822 ià(
»t
) {

823 
	`SLSI_ERR
(
sdev
, "failedoƒnable NAN.\n");

824 ià(
ndev_vif
->
Çn
.
Çn_’abË_¡©us
 =ğ
FAPI_RESULTCODE_INVALID_PARAMETERS
)

825 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

827 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

829 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

830 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

831 
ndev_vif
->
aùiv©ed
 = 
çl£
;

832 
ndev_vif
->
Çn
.
£rviû_id_m­
 = 0;

834 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0)

835 
	`SLSI_NET_ERR
(
dev
, "slsi_vif_activated failed\n");

836 
ndev_vif
->
Çn
.
ma¡”_´ef_v®ue
 = 
h®_»q
.
ma¡”_´ef
;

837 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
loÿl_nmi
, 
Çn_vif_mac_add»ss
);

838 
ndev_vif
->
Çn
.
¡©e
 = 1;

839 ià(
h®_»q
.
cÚfig_24g_chªÃl
)

840 
ndev_vif
->
Çn
.
İ”©šg_chªÃl
[0] = 
h®_»q
.
chªÃl_24g_v®
;

841 ià(
h®_»q
.
cÚfig_5g_chªÃl
)

842 
ndev_vif
->
Çn
.
İ”©šg_chªÃl
[1] = 
h®_»q
.
chªÃl_5g_v®
;

843 ià(
h®_»q
.
cÚfig_hİ_couÁ_lim™
)

844 
ndev_vif
->
Çn
.
hİcouÁ
 = 
h®_»q
.
hİ_couÁ_lim™_v®
;

845 
	`¦si_‘h_z”o_addr
(
sdev
->
Çn_şu¡”_id
);

846 
ndev_vif
->
Çn
.
¿ndom_mac_š‹rv®_£c
 = 
h®_»q
.
disc_mac_addr_¿nd_š‹rv®_£c
;

847 
	`SLSI_INFO
(
sdev
,

849 
h®_»q
.
Œª§ùiÚ_id
, h®_»q.
ma¡”_´ef
, h®_»q.
chªÃl_24g_v®
,

850 
h®_»q
.
chªÃl_5g_v®
, h®_»q.
disc_mac_addr_¿nd_š‹rv®_£c
);

853 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
loÿl_nmi
, 
Çn_vif_mac_add»ss
);

854 
	`š™_com¶‘iÚ
(&
ndev_vif
->
Çn
.
ndp_d–ay
);

855 
ex™_w™h_mu‹x
:

856 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

857 
ex™
:

858 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_ENABLED
, 0, 
NULL
, 
h®_»q
.
Œª§ùiÚ_id
, 
ndev_vif
);

860 
	}
}

862 
	$¦si_Çn_di§bË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

864 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

865 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

866 
Ãt_deviû
 *
d©a_dev
;

867 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
, *
d©a_ndev_vif
;

868 
u8
 
i
;

869 
ty³
, 
tmp
;

870 cÚ¡ 
Æ©Œ
 *
™”
;

871 
u16
 
Œª§ùiÚ_id
 = 0;

873 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

874 
ty³
 = 
	`Æa_ty³
(
™”
);

875 
ty³
) {

876 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

877 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
Œª§ùiÚ_id
);

884 ià(
dev
) {

885 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

886 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

887 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

889 ià(
ndev_vif
->
aùiv©ed
) {

890 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

891 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

892 
ndev_vif
->
aùiv©ed
 = 
çl£
;

893 
	`SLSI_INFO
(
sdev
, "Œª§ùiÚ_id:%d\n", 
Œª§ùiÚ_id
);

895 
	`SLSI_INFO
(
sdev
, "Œª§ùiÚ_id:%d NAN‚Ù‡ùive\n", 
Œª§ùiÚ_id
);

897 
i
 = 
SLSI_NAN_DATA_IFINDEX_START
; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

898 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

899 ià(
d©a_dev
) {

900 
d©a_ndev_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

901 
	`SLSI_MUTEX_LOCK
(
d©a_ndev_vif
->
vif_mu‹x
);

902 
	`¦si_vif_ş—nup
(
sdev
, 
d©a_dev
, 
Œue
, 0);

903 
d©a_ndev_vif
->
Çn
.
ndp_couÁ
 = 0;

904 
	`SLSI_MUTEX_UNLOCK
(
d©a_ndev_vif
->
vif_mu‹x
);

907 
	`¦si_purge_Çn_discov”y_šfo
(
ndev_vif
);

908 
	`mem£t
(&
ndev_vif
->
Çn
, 0, (ndev_vif->nan));

909 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

910 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

912 
	`SLSI_WARN
(
sdev
, "No NAN interface!!");

915 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
SLSI_HAL_NAN_STATUS_SUCCESS
, 0, 
NAN_RESPONSE_DISABLED
, 0, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

918 
	}
}

920 
	$¦si_Çn_publish_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
,

921 cÚ¡ *
d©a
, 
Ën
)

923 
ty³
, 
tmp
, 
r
;

924 cÚ¡ 
Æ©Œ
 *
™”
;

926 
	`mem£t
(
h®_»q
, 0, (*hal_req));

927 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

928 
ty³
 = 
	`Æa_ty³
(
™”
);

929 
ty³
) {

930 
NAN_REQ_ATTR_PUBLISH_ID
:

931 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
publish_id
);

934 
NAN_REQ_ATTR_PUBLISH_TTL
:

935 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
‰l
);

938 
NAN_REQ_ATTR_PUBLISH_PERIOD
:

939 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
³riod
);

942 
NAN_REQ_ATTR_PUBLISH_TYPE
:

943 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
publish_ty³
);

946 
NAN_REQ_ATTR_PUBLISH_TX_TYPE
:

947 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
tx_ty³
);

950 
NAN_REQ_ATTR_PUBLISH_COUNT
:

951 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
publish_couÁ
);

954 
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME_LEN
:

955 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_Çme_Ën
);

958 
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME
:

959 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

962 
NAN_REQ_ATTR_PUBLISH_MATCH_ALGO
:

963 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
publish_m©ch_šdiÿtÜ
);

966 
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO_LEN
:

967 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_¥ecific_šfo_Ën
);

970 
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO
:

971 ià(
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 > 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
)

972  -
EINVAL
;

973 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

974 
h®_»q
->
£rviû_¥ecific_šfo
);

977 
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER_LEN
:

978 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
rx_m©ch_f‹r_Ën
);

981 
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER
:

982 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
);

985 
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER_LEN
:

986 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
tx_m©ch_f‹r_Ën
);

989 
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER
:

990 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
);

993 
NAN_REQ_ATTR_PUBLISH_RSSI_THRESHOLD_FLAG
:

994 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_th»shŞd_æag
);

997 
NAN_REQ_ATTR_PUBLISH_CONN_MAP
:

998 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚnm­
);

1001 
NAN_REQ_ATTR_PUBLISH_RECV_IND_CFG
:

1002 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
»cv_šdiÿtiÚ_cfg
);

1005 
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
:

1006 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
);

1009 
NAN_REQ_ATTR_PUBLISH_SDEA
:

1010 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

1011 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

1014 
NAN_REQ_ATTR_RANGING_AUTO_RESPONSE
:

1015 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ngšg_auto_»¥Ú£
);

1017 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1018 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

1022 
r
 = 
	`¦si_Çn_g‘_sd—_·¿ms_Æ
(
sdev
, &
h®_»q
->
sd—_·¿ms
, 
™”
, 
ty³
);

1023 ià(
r
)

1024 
r
 = 
	`¦si_Çn_g‘_¿ngšg_cfg_Æ
(
sdev
, &
h®_»q
->
¿ngšg_cfg
, 
™”
, 
ty³
);

1025 ià(
r
)

1026 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
£c_šfo
, 
™”
, 
ty³
);

1027 ià(
r
)

1028 
r
 = 
	`¦si_Çn_g‘_¿nge_»¥_cfg_Æ
(
sdev
, &
h®_»q
->
¿nge_»¥Ú£_cfg
, 
™”
, 
ty³
);

1029 ià(
r
) {

1030 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN…ublish‡‰ribu‹ TYPE:%d\n", 
ty³
);

1031  
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1035  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1036 
	}
}

1038 
	$¦si_Çn_publish
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1040 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1041 
¦si_h®_Çn_publish_»q
 *
h®_»q
;

1042 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1043 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1044 
»t
;

1045 
u32
 
»¶y_¡©us
;

1046 
u32
 
publish_id
 = 0;

1047 
u16
 
Œª§ùiÚ_id
 = 0;

1049 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1050 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1051 
ex™
;

1053 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

1054 ià(!
h®_»q
) {

1055 
	`SLSI_ERR
(
sdev
, "failedo‡lloc hal_req\n");

1056 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

1057 
»t
 = -
ENOMEM
;

1058 
ex™
;

1061 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1062 
»¶y_¡©us
 = 
	`¦si_Çn_publish_g‘_Æ_·¿ms
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

1063 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

1064 ià(
»¶y_¡©us
 !ğ
SLSI_HAL_NAN_STATUS_SUCCESS
) {

1065 
	`kä“
(
h®_»q
);

1066 
»t
 = -
EINVAL
;

1067 
ex™
;

1070 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1072 ià(!
ndev_vif
->
aùiv©ed
) {

1073 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

1074 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1075 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1076 
ex™_w™h_lock
;

1079 ià(!
h®_»q
->
publish_id
) {

1080 
h®_»q
->
publish_id
 = 
	`¦si_Çn_g‘_Ãw_publish_id
(
ndev_vif
);

1081 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
 = (
h®_»q
->
publish_id
 + 1è% (
SLSI_NAN_MAX_SERVICE_ID
 + 1);

1082 } ià(!
	`¦si_Çn_is_publish_id_aùive
(
ndev_vif
, 
h®_»q
->
publish_id
)) {

1083 
	`SLSI_WARN
(
sdev
, "Publish id %d‚Ù found. m­:%x\n", 
h®_»q
->
publish_id
,

1084 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1085 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1086 
»t
 = -
EINVAL
;

1087 
ex™_w™h_lock
;

1090 ià(
h®_»q
->
publish_id
) {

1091 
»t
 = 
	`¦si_mlme_Çn_publish
(
sdev
, 
dev
, 
h®_»q
, h®_»q->
publish_id
);

1092 ià(
»t
) {

1093 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1094 
	`SLSI_INFO
(
sdev
, "transId:%d,…ubId:%d failed\n",

1095 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
publish_id
);

1097 
publish_id
 = 
h®_»q
->publish_id;

1098 
	`SLSI_INFO
(
sdev
,

1100 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
publish_id
, h®_»q->
publish_ty³
,

1101 
h®_»q
->
»cv_šdiÿtiÚ_cfg
, h®_»q->
£rviû_Çme
);

1102 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
)

1103 
	`SLSI_INFO_HEX
(
sdev
, 
h®_»q
->
£rviû_¥ecific_šfo
, h®_»q->
£rviû_¥ecific_šfo_Ën
,

1107 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1108 
	`SLSI_WARN
(
sdev
, "Too Many PUBLISH REQ(map:%x)\n",

1109 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1110 
»t
 = -
ENOTSUPP
;

1112 
ex™_w™h_lock
:

1113 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1114 
	`kä“
(
h®_»q
);

1115 
ex™
:

1116 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_PUBLISH
, 
publish_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

1117  
»t
;

1118 
	}
}

1120 
	$¦si_Çn_publish_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

1121 cÚ¡ *
d©a
, 
Ën
)

1123 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1124 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1125 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1126 
ty³
, 
tmp
, 
»t
 = 0;

1127 
u16
 
publish_id
 = 0, 
Œª§ùiÚ_id
 = 0;

1128 cÚ¡ 
Æ©Œ
 *
™”
;

1129 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1131 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1132 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1133 
ex™
;

1135 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1136 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1137 
ty³
 = 
	`Æa_ty³
(
™”
);

1138 
ty³
) {

1139 
NAN_REQ_ATTR_PUBLISH_ID
:

1140 
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
publish_id
));

1142 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1143 
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
));

1147 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN…ublishÿnûÈ©Œibu‹ TYPE:%d\n", 
ty³
);

1151 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1152 ià(!
ndev_vif
->
aùiv©ed
) {

1153 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1154 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1155 
ex™_w™h_lock
;

1157 ià(!
publish_id
 || !
	`¦si_Çn_is_publish_id_aùive
(
ndev_vif
,…ublish_id)) {

1158 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1159 
	`SLSI_WARN
(
sdev
, "pubId(%d)‚ot‡ctive. map:%x\n",

1160 
publish_id
, 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1162 
»t
 = 
	`¦si_mlme_Çn_publish
(
sdev
, 
dev
, 
NULL
, 
publish_id
);

1163 ià(
»t
) {

1164 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1165 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d…ubId:%d faed\n", 
Œª§ùiÚ_id
, 
publish_id
);

1167 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d…ubId:%d\n", 
Œª§ùiÚ_id
, 
publish_id
);

1170 
ex™_w™h_lock
:

1171 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1172 
ex™
:

1173 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_PUBLISH_CANCEL
, 
publish_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

1174  
»t
;

1175 
	}
}

1177 
	$¦si_Çn_subsüibe_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
,

1178 cÚ¡ *
d©a
, 
Ën
)

1180 
ty³
, 
tmp
, 
r
;

1181 cÚ¡ 
Æ©Œ
 *
™”
;

1183 
	`mem£t
(
h®_»q
, 0, (*hal_req));

1184 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1185 
ty³
 = 
	`Æa_ty³
(
™”
);

1186 
ty³
) {

1187 
NAN_REQ_ATTR_SUBSCRIBE_ID
:

1188 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
subsüibe_id
);

1191 
NAN_REQ_ATTR_SUBSCRIBE_TTL
:

1192 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
‰l
);

1195 
NAN_REQ_ATTR_SUBSCRIBE_PERIOD
:

1196 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
³riod
);

1199 
NAN_REQ_ATTR_SUBSCRIBE_TYPE
:

1200 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
subsüibe_ty³
);

1203 
NAN_REQ_ATTR_SUBSCRIBE_RESP_FILTER_TYPE
:

1204 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
£rviû_»¥Ú£_f‹r
);

1207 
NAN_REQ_ATTR_SUBSCRIBE_RESP_INCLUDE
:

1208 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
£rviû_»¥Ú£_šşude
);

1211 
NAN_REQ_ATTR_SUBSCRIBE_USE_RESP_FILTER
:

1212 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
u£_£rviû_»¥Ú£_f‹r
);

1215 
NAN_REQ_ATTR_SUBSCRIBE_SSI_REQUIRED
:

1216 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ssi_»quœed_fÜ_m©ch_šdiÿtiÚ
);

1219 
NAN_REQ_ATTR_SUBSCRIBE_MATCH_INDICATOR
:

1220 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
subsüibe_m©ch_šdiÿtÜ
);

1223 
NAN_REQ_ATTR_SUBSCRIBE_COUNT
:

1224 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
subsüibe_couÁ
);

1227 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME_LEN
:

1228 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_Çme_Ën
);

1231 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME
:

1232 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

1235 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO_LEN
:

1236 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_¥ecific_šfo_Ën
);

1239 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO
:

1240 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

1241 
h®_»q
->
£rviû_¥ecific_šfo
);

1244 
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER_LEN
:

1245 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
rx_m©ch_f‹r_Ën
);

1248 
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER
:

1249 ià(
h®_»q
->
rx_m©ch_f‹r_Ën
 > 
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
)

1250  -
EINVAL
;

1251 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
);

1254 
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER_LEN
:

1255 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
tx_m©ch_f‹r_Ën
);

1258 
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER
:

1259 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
);

1262 
NAN_REQ_ATTR_SUBSCRIBE_RSSI_THRESHOLD_FLAG
:

1263 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_th»shŞd_æag
);

1266 
NAN_REQ_ATTR_SUBSCRIBE_CONN_MAP
:

1267 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚnm­
);

1270 
NAN_REQ_ATTR_SUBSCRIBE_NUM_INTF_ADDR_PRESENT
:

1271 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
num_štf_addr_´e£Á
);

1274 
NAN_REQ_ATTR_SUBSCRIBE_INTF_ADDR
:

1275 ià(
h®_»q
->
num_štf_addr_´e£Á
 > 
SLSI_HAL_NAN_MAX_SUBSCRIBE_MAX_ADDRESS
)

1276  -
EINVAL
;

1277 
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
num_štf_addr_´e£Á
 * 
ETH_ALEN
), h®_»q->
štf_addr
);

1280 
NAN_REQ_ATTR_SUBSCRIBE_RECV_IND_CFG
:

1281 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
»cv_šdiÿtiÚ_cfg
);

1284 
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
:

1285 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
);

1288 
NAN_REQ_ATTR_PUBLISH_SDEA
:

1289 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

1290 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

1294 
NAN_REQ_ATTR_RANGING_AUTO_RESPONSE
:

1295 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ngšg_auto_»¥Ú£
);

1298 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1299 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

1303 
r
 = 
	`¦si_Çn_g‘_sd—_·¿ms_Æ
(
sdev
, &
h®_»q
->
sd—_·¿ms
, 
™”
, 
ty³
);

1304 ià(
r
)

1305 
r
 = 
	`¦si_Çn_g‘_¿ngšg_cfg_Æ
(
sdev
, &
h®_»q
->
¿ngšg_cfg
, 
™”
, 
ty³
);

1306 ià(
r
)

1307 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
£c_šfo
, 
™”
, 
ty³
);

1308 ià(
r
)

1309 
r
 = 
	`¦si_Çn_g‘_¿nge_»¥_cfg_Æ
(
sdev
, &
h®_»q
->
¿nge_»¥Ú£_cfg
, 
™”
, 
ty³
);

1310 ià(
r
) {

1311 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN subsüib©Œibu‹ TYPE:%d\n", 
ty³
);

1312  
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1316  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1317 
	}
}

1319 
	$¦si_Çn_subsüibe
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1321 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1322 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1323 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1324 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
;

1325 
»t
;

1326 
u32
 
»¶y_¡©us
;

1327 
u32
 
subsüibe_id
 = 0;

1328 
u16
 
Œª§ùiÚ_id
 = 0;

1330 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1331 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1332 
ex™
;

1334 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

1335 ià(!
h®_»q
) {

1336 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc hal_req structure!!!\n");

1337 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

1338 
»t
 = -
ENOMEM
;

1339 
ex™
;

1342 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1343 
»¶y_¡©us
 = 
	`¦si_Çn_subsüibe_g‘_Æ_·¿ms
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

1344 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

1345 ià(
»¶y_¡©us
 !ğ
SLSI_HAL_NAN_STATUS_SUCCESS
) {

1346 
	`kä“
(
h®_»q
);

1347 
»t
 = -
EINVAL
;

1348 
ex™
;

1350 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1351 ià(!
ndev_vif
->
aùiv©ed
) {

1352 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

1353 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1354 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1355 
ex™_w™h_lock
;

1358 ià(!
h®_»q
->
subsüibe_id
) {

1359 
h®_»q
->
subsüibe_id
 = 
	`¦si_Çn_g‘_Ãw_subsüibe_id
(
ndev_vif
);

1360 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
 = (
h®_»q
->
subsüibe_id
 + 1è% (
SLSI_NAN_MAX_SERVICE_ID
 + 1);

1361 } ià(!
	`¦si_Çn_is_subsüibe_id_aùive
(
ndev_vif
, 
h®_»q
->
subsüibe_id
)) {

1362 
	`SLSI_WARN
(
sdev
, "subId %d‚Ù found. m­:%x\n", 
h®_»q
->
subsüibe_id
,

1363 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1364 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1365 
»t
 = -
EINVAL
;

1366 
ex™_w™h_lock
;

1369 
»t
 = 
	`¦si_mlme_Çn_subsüibe
(
sdev
, 
dev
, 
h®_»q
, h®_»q->
subsüibe_id
);

1370 ià(
»t
) {

1371 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1372 
	`SLSI_INFO
(
sdev
, "transId:%d subId:%dype:%d Failed\n",

1373 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
subsüibe_id
, h®_»q->
subsüibe_ty³
);

1375 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d subId:%dy³:%d\ÀÇme:%s", 
h®_»q
->
Œª§ùiÚ_id
,

1376 
h®_»q
->
subsüibe_id
, h®_»q->
subsüibe_ty³
, h®_»q->
£rviû_Çme
);

1377 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
)

1378 
	`SLSI_INFO_HEX
(
sdev
, 
h®_»q
->
£rviû_¥ecific_šfo
, h®_»q->
£rviû_¥ecific_šfo_Ën
,

1380 
subsüibe_id
 = 
h®_»q
->subscribe_id;

1383 
ex™_w™h_lock
:

1384 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1385 
	`kä“
(
h®_»q
);

1386 
ex™
:

1387 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_SUBSCRIBE
, 
subsüibe_id
, 
NULL
,

1388 
Œª§ùiÚ_id
, 
ndev_vif
);

1389  
»t
;

1390 
	}
}

1392 
	$¦si_Çn_subsüibe_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1394 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1395 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1396 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1397 
ty³
, 
tmp
, 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

1398 
u16
 
subsüibe_id
 = 0, 
Œª§ùiÚ_id
 = 0;

1399 cÚ¡ 
Æ©Œ
 *
™”
;

1400 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1402 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1403 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1404 
ex™
;

1406 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1408 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1409 
ty³
 = 
	`Æa_ty³
(
™”
);

1410 
ty³
) {

1411 
NAN_REQ_ATTR_SUBSCRIBE_ID
:

1412 
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
subsüibe_id
));

1414 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1415 
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
));

1418 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN subsüibeÿnûÈ©Œibu‹ TYPE:%d\n", 
ty³
);

1419 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1420 
ex™
;

1424 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1425 ià(
ndev_vif
->
aùiv©ed
) {

1426 ià(!
subsüibe_id
 || !
	`¦si_Çn_is_subsüibe_id_aùive
(
ndev_vif
, subscribe_id)) {

1427 
	`SLSI_WARN
(
sdev
, "subId(%d)‚ot‡ctive. map:%x\n",

1428 
subsüibe_id
, 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1429 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1431 
»t
 = 
	`¦si_mlme_Çn_subsüibe
(
sdev
, 
dev
, 
NULL
, 
subsüibe_id
);

1432 ià(
»t
) {

1433 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1434 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d subId:%d Faed\n", 
Œª§ùiÚ_id
, 
subsüibe_id
);

1436 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d subId:%d\n", 
Œª§ùiÚ_id
, 
subsüibe_id
);

1440 
	`SLSI_ERR
(
sdev
, "vif‚ot‡ctivated\n");

1441 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1442 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1444 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1445 
ex™
:

1446 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_SUBSCRIBE_CANCEL
, 
subsüibe_id
, 
NULL
,

1447 
Œª§ùiÚ_id
, 
ndev_vif
);

1448  
»t
;

1449 
	}
}

1451 
	$¦si_Çn_fŞlowup_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
,

1452 cÚ¡ *
d©a
, 
Ën
)

1454 
ty³
, 
tmp
;

1455 cÚ¡ 
Æ©Œ
 *
™”
;

1457 
	`mem£t
(
h®_»q
, 0, (*hal_req));

1458 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1459 
ty³
 = 
	`Æa_ty³
(
™”
);

1460 
ty³
) {

1461 
NAN_REQ_ATTR_FOLLOWUP_ID
:

1462 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
publish_subsüibe_id
);

1465 
NAN_REQ_ATTR_FOLLOWUP_REQUESTOR_ID
:

1466 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
»que¡Ü_š¡ªû_id
);

1469 
NAN_REQ_ATTR_FOLLOWUP_ADDR
:

1470 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, 
h®_»q
->
addr
);

1473 
NAN_REQ_ATTR_FOLLOWUP_PRIORITY
:

1474 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
´iÜ™y
);

1477 
NAN_REQ_ATTR_FOLLOWUP_TX_WINDOW
:

1478 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
dw_Ü_çw
);

1481 
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME_LEN
:

1482 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_¥ecific_šfo_Ën
);

1485 
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME
:

1486 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
 > 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
)

1487  -
EINVAL
;

1488 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

1489 
h®_»q
->
£rviû_¥ecific_šfo
);

1492 
NAN_REQ_ATTR_FOLLOWUP_RECV_IND_CFG
:

1493 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
»cv_šdiÿtiÚ_cfg
);

1496 
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
:

1497 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
);

1500 
NAN_REQ_ATTR_PUBLISH_SDEA
:

1501 ià(
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 > 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
)

1502  -
EINVAL
;

1503 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

1504 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

1507 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1508 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

1512 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN fŞlowu°©Œibu‹ TYPE:%d\n", 
ty³
);

1513  
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1516  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1517 
	}
}

1519 
	$¦si_Çn_Œªsm™_fŞlowup
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1521 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1522 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1523 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1524 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 
h®_»q
;

1525 
»t
 = 0;

1526 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1528 
h®_»q
.
Œª§ùiÚ_id
 = 0;

1529 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1530 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1531 
ex™
;

1533 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1534 
»¶y_¡©us
 = 
	`¦si_Çn_fŞlowup_g‘_Æ_·¿ms
(
sdev
, &
h®_»q
, 
d©a
, 
Ën
);

1535 ià(
»¶y_¡©us
) {

1536 
»t
 = -
EINVAL
;

1537 
ex™
;

1540 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1541 ià(!
ndev_vif
->
aùiv©ed
) {

1542 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

1543 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1544 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1545 
ex™_w™h_lock
;

1548 ià(!
h®_»q
.
publish_subsüibe_id
 ||

1549 !(
	`¦si_Çn_is_subsüibe_id_aùive
(
ndev_vif
, 
h®_»q
.
publish_subsüibe_id
) ||

1550 
	`¦si_Çn_is_publish_id_aùive
(
ndev_vif
, 
h®_»q
.
publish_subsüibe_id
))) {

1551 
	`SLSI_WARN
(
sdev
, "publish/Subsüibid %d‚Ù found. m­:%x\n", 
h®_»q
.
publish_subsüibe_id
,

1552 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1553 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1554 
»t
 = -
EINVAL
;

1555 
ex™_w™h_lock
;

1558 ià(!
	`¦si_Çn_g‘_fŞlowup_Œªs_id
(
ndev_vif
, 
h®_»q
.
»que¡Ü_š¡ªû_id
))

1559 
»t
 = 
	`¦si_mlme_Çn_tx_fŞlowup
(
sdev
, 
dev
, &
h®_»q
);

1561 
»t
 = 
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
;

1563 ià(
»t
) {

1564 ià(
»t
 =ğ
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
) {

1565 
»¶y_¡©us
 = 
»t
;

1566 
»t
 = 0;

1568 
»¶y_¡©us
 = 
»t
 =ğ
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1571 
	`SLSI_INFO
(
sdev
,

1573 
h®_»q
.
Œª§ùiÚ_id
, h®_»q.
publish_subsüibe_id
, h®_»q.
»que¡Ü_š¡ªû_id
);

1576 
ex™_w™h_lock
:

1577 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1578 
ex™
:

1579 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_TRANSMIT_FOLLOWUP
, 0, 
NULL
, 
h®_»q
.
Œª§ùiÚ_id
, 
ndev_vif
);

1580  
»t
;

1581 
	}
}

1583 
	$¦si_Çn_cÚfig_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
,

1584 cÚ¡ *
d©a
, 
Ën
)

1586 
ty³
, 
ty³1
, 
tmp
, 
tmp1
, 
disc_©Œ_idx
 = 0, 
çmchª_idx
 = 0;

1587 cÚ¡ 
Æ©Œ
 *
™”
, *
™”1
;

1588 
¦si_h®_Çn_po¡_discov”y_·¿m
 *
disc_©Œ
;

1589 
¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 *
çmchª
;

1590 #ifdeà
SCSC_SEP_VERSION


1591 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1592 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1594 
u8
 
v®
 = 0;

1595 
u32
 
¿ndom_š‹rv®
 = 0;

1597 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1598 
ty³
 = 
	`Æa_ty³
(
™”
);

1599 
ty³
) {

1600 
NAN_REQ_ATTR_SID_BEACON_VAL
:

1601 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sid_b—cÚ
);

1602 
h®_»q
->
cÚfig_sid_b—cÚ
 = 1;

1605 
NAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
:

1606 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_´oxim™y
);

1607 
h®_»q
->
cÚfig_rssi_´oxim™y
 = 1;

1610 
NAN_REQ_ATTR_MASTER_PREF
:

1611 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ma¡”_´ef
);

1612 
h®_»q
->
cÚfig_ma¡”_´ef
 = 1;

1615 
NAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
:

1616 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_´oxim™y_5g_v®
);

1617 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 = 1;

1620 
NAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
:

1621 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

1622 
h®_»q
->
rssi_wšdow_size_v®
 = (
u16
)
v®
;

1623 
h®_»q
->
cÚfig_rssi_wšdow_size
 = 1;

1626 
NAN_REQ_ATTR_CLUSTER_VAL
:

1627 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚfig_şu¡”_©Œibu‹_v®
);

1630 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
:

1631 
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
),

1632 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
);

1633 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

1636 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
:

1637 
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
),

1638 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
);

1639 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

1642 
NAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
:

1643 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ndom_çùÜ_fÜû_v®
);

1644 
h®_»q
->
cÚfig_¿ndom_çùÜ_fÜû
 = 1;

1647 
NAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
:

1648 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
hİ_couÁ_fÜû_v®
);

1649 
h®_»q
->
cÚfig_hİ_couÁ_fÜû
 = 1;

1652 
NAN_REQ_ATTR_CONN_CAPABILITY_PAYLOAD_TX
:

1653 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
·ylßd_Œªsm™_æag
);

1654 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1657 
NAN_REQ_ATTR_CONN_CAPABILITY_WFD
:

1658 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_wfd_suµÜ‹d
);

1659 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1662 
NAN_REQ_ATTR_CONN_CAPABILITY_WFDS
:

1663 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_wfds_suµÜ‹d
);

1664 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1667 
NAN_REQ_ATTR_CONN_CAPABILITY_TDLS
:

1668 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_tdls_suµÜ‹d
);

1669 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1672 
NAN_REQ_ATTR_CONN_CAPABILITY_MESH
:

1673 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_mesh_suµÜ‹d
);

1674 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1677 
NAN_REQ_ATTR_CONN_CAPABILITY_IBSS
:

1678 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_ibss_suµÜ‹d
);

1679 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1682 
NAN_REQ_ATTR_CONN_CAPABILITY_WLAN_INFRA
:

1683 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
wÏn_šäa_f›ld
);

1684 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1687 
NAN_REQ_ATTR_DISCOVERY_ATTR_NUM_ENTRIES
:

1688 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
num_cÚfig_discov”y_©Œ
);

1691 
NAN_REQ_ATTR_DISCOVERY_ATTR_VAL
:

1692 ià(
h®_»q
->
num_cÚfig_discov”y_©Œ
 > 
SLSI_HAL_NAN_MAX_POSTDISCOVERY_LEN
)

1693  -
EINVAL
;

1694 ià(
disc_©Œ_idx
 >ğ
h®_»q
->
num_cÚfig_discov”y_©Œ
) {

1695 
	`SLSI_ERR
(
sdev
,

1697 
disc_©Œ_idx
 + 1, 
h®_»q
->
num_cÚfig_discov”y_©Œ
);

1698  -
EINVAL
;

1700 
disc_©Œ
 = &
h®_»q
->
discov”y_©Œ_v®
[
disc_©Œ_idx
];

1701 
disc_©Œ_idx
++;

1702 
	`Æa_fÜ_—ch_Ã¡ed
(
™”1
, 
™”
, 
tmp1
) {

1703 
ty³1
 = 
	`Æa_ty³
(
™”1
);

1704 
ty³1
) {

1705 
NAN_REQ_ATTR_CONN_TYPE
:

1706 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
ty³
);

1709 
NAN_REQ_ATTR_NAN_ROLE
:

1710 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
rŞe
);

1713 
NAN_REQ_ATTR_TRANSMIT_FREQ
:

1714 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
Œªsm™_äeq
);

1717 
NAN_REQ_ATTR_AVAILABILITY_DURATION
:

1718 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
du¿tiÚ
);

1721 
NAN_REQ_ATTR_AVAILABILITY_INTERVAL
:

1722 
	`¦si_ut_Æa_g‘_u32
(
™”1
, &
disc_©Œ
->
ava_š‹rv®_b™m­
);

1725 
NAN_REQ_ATTR_MAC_ADDR_VAL
:

1726 
	`¦si_ut_Æa_g‘_d©a
(
™”1
, 
ETH_ALEN
, 
disc_©Œ
->
addr
);

1729 
NAN_REQ_ATTR_MESH_ID_LEN
:

1730 
	`¦si_ut_Æa_g‘_u16
(
™”1
, &
disc_©Œ
->
mesh_id_Ën
);

1733 
NAN_REQ_ATTR_MESH_ID
:

1734 ià(
disc_©Œ
->
mesh_id_Ën
 > 
SLSI_HAL_NAN_MAX_MESH_DATA_LEN
)

1735  -
EINVAL
;

1736 
	`¦si_ut_Æa_g‘_d©a
(
™”1
, 
disc_©Œ
->
mesh_id_Ën
, disc_©Œ->
mesh_id
);

1739 
NAN_REQ_ATTR_INFRASTRUCTURE_SSID_LEN
:

1740 
	`¦si_ut_Æa_g‘_u16
(
™”1
, &
disc_©Œ
->
šäa¡ruùu»_ssid_Ën
);

1743 
NAN_REQ_ATTR_INFRASTRUCTURE_SSID
:

1744 ià(
disc_©Œ
->
šäa¡ruùu»_ssid_Ën
 > 
SLSI_HAL_NAN_MAX_INFRA_DATA_LEN
)

1745  -
EINVAL
;

1746 
	`¦si_ut_Æa_g‘_d©a
(
™”1
, 
disc_©Œ
->
šäa¡ruùu»_ssid_Ën
,

1747 
disc_©Œ
->
šäa¡ruùu»_ssid_v®
);

1753 
NAN_REQ_ATTR_FURTHER_AVAIL_NUM_ENTRIES
:

1754 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
çm_v®
.
numchªs
);

1755 
h®_»q
->
cÚfig_çm
 = 1;

1758 
NAN_REQ_ATTR_FURTHER_AVAIL_VAL
:

1759 
h®_»q
->
cÚfig_çm
 = 1;

1760 ià(
h®_»q
->
çm_v®
.
numchªs
 > 
SLSI_HAL_NAN_MAX_FAM_CHANNELS
)

1761  -
EINVAL
;

1762 ià(
çmchª_idx
 >ğ
h®_»q
->
çm_v®
.
numchªs
) {

1763 
	`SLSI_ERR
(
sdev
,

1765 
çmchª_idx
 + 1, 
h®_»q
->
çm_v®
.
numchªs
);

1766  -
EINVAL
;

1768 
çmchª
 = &
h®_»q
->
çm_v®
.çmchª[
çmchª_idx
];

1769 
çmchª_idx
++;

1770 
	`Æa_fÜ_—ch_Ã¡ed
(
™”1
, 
™”
, 
tmp1
) {

1771 
ty³1
 = 
	`Æa_ty³
(
™”1
);

1772 
ty³1
) {

1773 
NAN_REQ_ATTR_FURTHER_AVAIL_ENTRY_CTRL
:

1774 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
’Œy_cÚŒŞ
);

1777 
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_CLASS
:

1778 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
şass_v®
);

1781 
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN
:

1782 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
chªÃl
);

1785 
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_MAPID
:

1786 
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
m­id
);

1789 
NAN_REQ_ATTR_FURTHER_AVAIL_INTERVAL_BITMAP
:

1790 
	`¦si_ut_Æa_g‘_u32
(
™”1
, &
çmchª
->
ava_š‹rv®_b™m­
);

1796 
NAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
:

1797 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

1798 
h®_»q
->
subsüibe_sid_b—cÚ_v®
 = (
u32
)
v®
;

1799 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 = 1;

1802 
NAN_REQ_ATTR_DW_2G4_INTERVAL
:

1803 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

1804 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 = (
u32
)
v®
;

1806 ià(
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 > 0 && hal_req->dw_2dot4g_interval_val < 6)

1807 
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
 = 1;

1810 
NAN_REQ_ATTR_DW_5G_INTERVAL
:

1811 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

1812 
h®_»q
->
dw_5g_š‹rv®_v®
 = (
u32
)
v®
;

1814 ià(
h®_»q
->
dw_5g_š‹rv®_v®
 < 6)

1815 
h®_»q
->
cÚfig_5g_dw_bªd
 = 1;

1817 
NAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
:

1818 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ndom_š‹rv®
);

1819 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

1820 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 
¿ndom_š‹rv®
;

1822 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 0;

1823 #ifdeà
SCSC_SEP_VERSION


1824 
¿ndom_š‹rv®
 =„ªdom_š‹rv® & 
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
;

1825 ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
) {

1826 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 0;

1827 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

1828 } ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_DISABLE_MASK
) {

1829 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 1;

1830 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

1834 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1835 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

1837 
NAN_REQ_ATTR_DISCOVERY_BEACON_INT
:

1838 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
);

1840 
NAN_REQ_ATTR_NSS
:

1841 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
nss_discov”y
);

1843 
NAN_REQ_ATTR_ENABLE_RANGING
:

1844 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_¿ngšg
);

1846 
NAN_REQ_ATTR_DW_EARLY_TERMINATION
:

1847 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_dw_—¾y_‹rmš©iÚ
);

1850 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN cÚfig‡‰ribu‹ TYPE:%d\n", 
ty³
);

1853  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1854 
	}
}

1856 
	$¦si_Çn_£t_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1858 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1859 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1860 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1861 
u16
 
Œª§ùiÚ_id
 = 0;

1862 
»t
;

1863 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1865 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1866 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1867 
ex™
;

1869 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1871 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1872 
»¶y_¡©us
 = 
	`¦si_Çn_cÚfig_g‘_Æ_·¿ms
(
sdev
, &
ndev_vif
->
Çn
.
cÚfig
, 
d©a
, 
Ën
);

1873 
Œª§ùiÚ_id
 = 
ndev_vif
->
Çn
.
cÚfig
.transaction_id;

1874 ià(
»¶y_¡©us
) {

1875 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1876 
»t
 = -
EINVAL
;

1877 
ex™
;

1879 ià(!
ndev_vif
->
aùiv©ed
) {

1880 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

1881 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1882 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1884 
»t
 = 
	`¦si_mlme_Çn_£t_cÚfig
(
sdev
, 
dev
, &
ndev_vif
->
Çn
.
cÚfig
);

1885 ià(
»t
) {

1886 ià(
»t
 =ğ
FAPI_RESULTCODE_INVALID_PARAMETERS
)

1887 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1889 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1891 ià(
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_ma¡”_´ef
)

1892 
ndev_vif
->
Çn
.
ma¡”_´ef_v®ue
 =‚dev_vif->Çn.
cÚfig
.
ma¡”_´ef
;

1893 
ndev_vif
->
Çn
.
¿ndom_mac_š‹rv®_£c
 =‚dev_vif->Çn.
cÚfig
.
disc_mac_addr_¿nd_š‹rv®_£c
;

1894 
	`SLSI_INFO
(
sdev
, "transId:%d masterPref:%d\n",

1895 
ndev_vif
->
Çn
.
cÚfig
.
Œª§ùiÚ_id
,‚dev_vif->Çn.cÚfig.
ma¡”_´ef
);

1898 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1899 
ex™
:

1900 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_CONFIG
, 0, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

1902 
	}
}

1904 
	$¦si_Çn_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1906 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1907 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1908 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1909 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1910 
¦si_h®_Çn_ÿ·b™›s
 
Çn_ÿ·b™›s
;

1911 
»t
 = 0, 
i
;

1912 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

1913 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

1914 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_CLUSTERS
, { 0, 0 } },

1915 { 
SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_PUBLISHES
, { 0, 0 } },

1916 { 
SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_SUBSCRIBES
, { 0, 0 } },

1917 { 
SLSI_PSID_UNIFI_NAN_MAX_SERVICE_NAME_LENGTH
, { 0, 0 } },

1918 { 
SLSI_PSID_UNIFI_NAN_MAX_MATCH_FILTER_LENGTH
, { 0, 0 } },

1919 { 
SLSI_PSID_UNIFI_NAN_MAX_TOTAL_MATCH_FILTER_LENGTH
, { 0, 0 } },

1920 { 
SLSI_PSID_UNIFI_NAN_MAX_SERVICE_SPECIFIC_INFO_LENGTH
, { 0, 0 } },

1921 { 
SLSI_PSID_UNIFI_NAN_MAX_NDP_SESSIONS
, { 0, 0 } },

1922 { 
SLSI_PSID_UNIFI_NAN_MAX_APP_INFO_LENGTH
, { 0, 0 } },

1923 { 
SLSI_PSID_UNIFI_NAN_MAX_QUEUED_FOLLOWUPS
, { 0, 0 } },

1924 { 
SLSI_PSID_UNIFI_NAN_MAX_SUBSCRIBE_INTERFACE_ADDRESSES
, { 0, 0 } },

1925 { 
SLSI_PSID_UNIFI_NAN_SUPPORTED_CIPHER_SUITES
, { 0, 0 }, },

1926 { 
SLSI_PSID_UNIFI_NAN_MAX_EXTENDED_SERVICE_SPECIFIC_INFO_LEN
, { 0, 0} } };

1927 
u32
 *
ÿ·b™›s_mib_v®
[] = { &
Çn_ÿ·b™›s
.
max_cÚcu¼’t_Çn_şu¡”s
,

1928 &
Çn_ÿ·b™›s
.
max_publishes
,

1929 &
Çn_ÿ·b™›s
.
max_subsüibes
,

1930 &
Çn_ÿ·b™›s
.
max_£rviû_Çme_Ën
,

1931 &
Çn_ÿ·b™›s
.
max_m©ch_f‹r_Ën
,

1932 &
Çn_ÿ·b™›s
.
max_tÙ®_m©ch_f‹r_Ën
,

1933 &
Çn_ÿ·b™›s
.
max_£rviû_¥ecific_šfo_Ën
,

1934 &
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
,

1935 &
Çn_ÿ·b™›s
.
max_­p_šfo_Ën
,

1936 &
Çn_ÿ·b™›s
.
max_queued_Œªsm™_fŞlowup_msgs
,

1937 &
Çn_ÿ·b™›s
.
max_subsüibe_add»ss
,

1938 &
Çn_ÿ·b™›s
.
ch”_su™es_suµÜ‹d
,

1939 &
Çn_ÿ·b™›s
.
max_sd—_£rviû_¥ecific_šfo_Ën
 };

1940 
ty³
, 
tmp
;

1941 cÚ¡ 
Æ©Œ
 *
™”
;

1942 
u16
 
Œª§ùiÚ_id
 = 0;

1944 
	`mem£t
(&
Çn_ÿ·b™›s
, 0, (nan_capabilities));

1945 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1946 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1947 
ex™
;

1949 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1950 
ty³
 = 
	`Æa_ty³
(
™”
);

1951 
ty³
) {

1952 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1953 
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
));

1960 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1963 
mibr¥
.
d©aL’gth
 = 11 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

1964 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

1965 ià(!
mibr¥
.
d©a
) {

1966 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

1967 
ex™
;

1970 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1972 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

1973 ià(!
v®ues
)

1974 
ex™_w™h_mibr¥
;

1976 
i
 = 0; i < ()
	`ARRAY_SIZE
(
g‘_v®ues
); i++) {

1977 ià(
v®ues
[
i
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

1978 *
ÿ·b™›s_mib_v®
[
i
] = 
v®ues
[i].
u
.
uštV®ue
;

1979 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "MIB v®uğ%u\n", *
ÿ·b™›s_mib_v®
[
i
]);

1981 
	`SLSI_ERR
(
sdev
, "šv®idy³(%d). i‹r:%d\n", 
v®ues
[
i
].
ty³
, i);

1982 *
ÿ·b™›s_mib_v®
[
i
] = 0;

1986 
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
 = 
	`¦si_g‘_Çn_max_ndi_içûs
();

1987 ià(!
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
)

1988 
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
 = 
	`¦si_g‘_Çn_max_ndp_š¡ªûs
();

1990 ià(
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
 > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

1991 
	`SLSI_ERR
(
sdev
, "max‚d°if's:%d buˆsuµÜ‹d:%d\n", 
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
,

1992 
SLSI_NAN_MAX_NDP_INSTANCES
);

1993 
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
 = 
SLSI_NAN_MAX_NDP_INSTANCES
;

1996 ià(
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
 > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

1997 
	`SLSI_ERR
(
sdev
, "max‚d°if's:%d buˆsuµÜ‹d:%d\n", 
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
,

1998 
SLSI_NAN_MAX_NDP_INSTANCES
);

1999 
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
 = 
SLSI_NAN_MAX_NDP_INSTANCES
;

2002 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d\n", 
Œª§ùiÚ_id
);

2004 
	`kä“
(
v®ues
);

2005 
ex™_w™h_mibr¥
:

2006 
	`kä“
(
mibr¥
.
d©a
);

2007 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2008 
ex™
:

2010 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
SLSI_HAL_NAN_STATUS_SUCCESS
, 0, 
NAN_RESPONSE_GET_CAPABILITIES
, 0, &
Çn_ÿ·b™›s
, 
Œª§ùiÚ_id
, 
ndev_vif
);

2012 
	}
}

2014 
	$¦si_v’dÜ_Çn_ev’t_ü—‹_d–‘e
(
¦si_dev
 *
sdev
, 
h®_ev’t
, 
Œª§ùiÚ_id
, 
»¶y_¡©us
)

2017 
sk_buff
 *
Æ_skb
 = 
NULL
;

2018 
»s
 = 0;

2020 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

2021 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
h®_ev’t
, 
GFP_KERNEL
);

2023 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
h®_ev’t
, 
GFP_KERNEL
);

2025 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_STATUS
, 
»¶y_¡©us
);

2026 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_HAL_TRANSACTION_ID
, 
Œª§ùiÚ_id
);

2027 ià(
»s
) {

2028 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

2030 
	`kä“_skb
(
Æ_skb
);

2033 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

2034 
	}
}

2036 #ià(
KERNEL_VERSION
(5, 12, 0è<ğ
LINUX_VERSION_CODE
)

2037 
	$¦si_Çn_d©a_içû_ü—‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2039 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2040 
u8
 
içû_Çme
[
IFNAMSIZ
] = {0};

2041 
»t
 = 0, 
»¶y_¡©us
, 
ty³
, 
tmp
;

2042 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2043 cÚ¡ 
Æ©Œ
 *
™”
;

2044 
u16
 
Œª§ùiÚ_id
 = 0;

2045 
¦si_Çn_d©a_š‹rçû_ü—‹_šfo
 *
štfd©a
 = 
NULL
;

2047 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2048 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2049 
ex™
;

2051 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2052 
ty³
 = 
	`Æa_ty³
(
™”
);

2053 ià(
ty³
 =ğ
NAN_REQ_ATTR_DATA_INTERFACE_NAME
) {

2057 ià(
	`Æa_Ën
(
™”
è> 
IFNAMSIZ
)

2058  -
EINVAL
;

2059 
	`memıy
(
içû_Çme
, 
	`Æa_d©a
(
™”
), 
	`Æa_Ën
(iter));

2060 
	`SLSI_ENSURE_NULL_TERMINATED
(
içû_Çme
, (iface_name));

2061 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
)

2062 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
Œª§ùiÚ_id
);

2065 ià(!
içû_Çme
[0]) {

2066 
	`SLSI_ERR
(
sdev
, "No NAN data interface‚ame\n");

2067 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2068 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2069 
ex™
;

2071 
štfd©a
 = 
	`kz®loc
((*štfd©a), 
GFP_KERNEL
);

2072 ià(!
štfd©a
) {

2073 
	`SLSI_NET_ERR
(
dev
, "Data Interface Create Failed");

2074  -
EINVAL
;

2076 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2077 
	`memıy
(
štfd©a
->
iâame
, 
içû_Çme
, 
	`¡¾’
(iface_name));

2078 
štfd©a
->
Œª§ùiÚ_id
 =ransaction_id;

2079 
	`li¡_add
(&
štfd©a
->
li¡
, &
sdev
->
Çn_d©a_š‹rçû_ü—‹_d©a
);

2080 
	`scheduË_wÜk
(&
sdev
->
Çn_d©a_š‹rçû_ü—‹_wÜk
);

2081 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2082 
ex™
:

2083 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2084 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
sdev
->
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INTERFACE_CREATE
, 0, 
NULL
, 
Œª§ùiÚ_id
, NULL);

2085  
»t
;

2086 
	}
}

2088 
	$¦si_Çn_d©a_içû_ü—‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2090 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2091 
u8
 
içû_Çme
[
IFNAMSIZ
] = {0};

2092 
»t
 = 0, 
if_idx
, 
ty³
, 
tmp
, 
”r
;

2093 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2094 
Ãt_deviû
 *
dev_ndp
 = 
NULL
;

2095 
Ãtdev_vif
 *
ndev_d©a_vif
 = 
NULL
;

2096 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2097 cÚ¡ 
Æ©Œ
 *
™”
;

2098 
u16
 
Œª§ùiÚ_id
 = 0;

2100 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2101 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2102 
ex™
;

2104 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2105 
ty³
 = 
	`Æa_ty³
(
™”
);

2106 ià(
ty³
 =ğ
NAN_REQ_ATTR_DATA_INTERFACE_NAME
) {

2110 ià(
	`Æa_Ën
(
™”
è> 
IFNAMSIZ
)

2111  -
EINVAL
;

2112 
	`memıy
(
içû_Çme
, 
	`Æa_d©a
(
™”
), 
	`Æa_Ën
(iter));

2113 
	`SLSI_ENSURE_NULL_TERMINATED
(
içû_Çme
, (iface_name));

2114 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
)

2115 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
Œª§ùiÚ_id
);

2117 ià(!
içû_Çme
[0]) {

2118 
	`SLSI_ERR
(
sdev
, "No NAN data interface‚ame\n");

2119 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2120 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2121 
ex™
;

2124 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2126 
if_idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; if_idx < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; if_idx++) {

2127 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2128 ià(!
dev_ndp
)

2132 ià(
if_idx
 >ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1) {

2133 
	`SLSI_ERR
(
sdev
, "NAN‚o free NAN data interfaces\n");

2134 
»t
 = 
WIFI_HAL_ERROR_TOO_MANY_REQUESTS
;

2135 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2136 
ex™_w™h_lock
;

2139 
”r
 = 
	`¦si_Ãtif_add_locked
(
sdev
, 
içû_Çme
, 
if_idx
);

2140 ià(
”r
) {

2141 
	`SLSI_ERR
(
sdev
, "NAN fa‚‘_if_add if_Çme:%s, if_idx:%d\n", 
içû_Çme
, 
if_idx
);

2142 
»t
 = 
WIFI_HAL_ERROR_OUT_OF_MEMORY
;

2143 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2144 
ex™_w™h_lock
;

2147 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2148 ià(!
dev_ndp
)

2149 
ex™_w™h_lock
;

2151 
”r
 = 
	`¦si_Ãtif_»gi¡”_locked
(
sdev
, 
dev_ndp
);

2152 ià(
”r
) {

2153 
	`SLSI_ERR
(
sdev
, "NAN fa‚‘devƒ¼:%d if_Çme:%s, if_idx:%d\n", 
”r
);

2154 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2155 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2157 
	`SLSI_INFO
(
sdev
, "Œªs_id:%d, if_Çme:%s, if_idx:%d\n", 
Œª§ùiÚ_id
, 
içû_Çme
, 
if_idx
);

2158 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
dev_ndp
);

2159 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

2160 
ndev_d©a_vif
->
vif_ty³
 = 
SLSI_NAN_VIF_TYPE_NDP
;

2161 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

2164 
ex™_w™h_lock
:

2165 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2166 
ex™
:

2167 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INTERFACE_CREATE
, 0, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_d©a_vif
);

2168  
»t
;

2169 
	}
}

2172 #ià(
KERNEL_VERSION
(5, 12, 0è<ğ
LINUX_VERSION_CODE
)

2173 
	$¦si_Çn_d©a_içû_d–‘e
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2175 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2176 
u8
 
içû_Çme
[
IFNAMSIZ
] = {0};

2177 
»t
 = 0, 
ty³
, 
tmp
;

2178 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2179 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2180 cÚ¡ 
Æ©Œ
 *
™”
;

2181 
u16
 
Œª§ùiÚ_id
 = 0;

2182 
¦si_Çn_d©a_š‹rçû_d–‘e_šfo
 *
štfd©a
 = 
NULL
;

2184 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2185 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2186 
ex™
;

2187 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2188 
ty³
 = 
	`Æa_ty³
(
™”
);

2189 ià(
ty³
 =ğ
NAN_REQ_ATTR_DATA_INTERFACE_NAME
) {

2193 ià(
	`Æa_Ën
(
™”
è> 
IFNAMSIZ
)

2194  -
EINVAL
;

2195 
	`memıy
(
içû_Çme
, 
	`Æa_d©a
(
™”
), 
	`Æa_Ën
(iter));

2196 
	`SLSI_ENSURE_NULL_TERMINATED
(
içû_Çme
, (iface_name));

2197 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
)

2198 
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
));

2200 ià(!
içû_Çme
[0]) {

2201 
	`SLSI_ERR
(
sdev
, "No NAN data interface‚ame\n");

2202 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2203 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2204 
ex™
;

2206 
štfd©a
 = 
	`kz®loc
((*štfd©a), 
GFP_KERNEL
);

2207 ià(!
štfd©a
) {

2208 
	`SLSI_NET_ERR
(
dev
, "Data Interface delete Failed");

2209  -
EINVAL
;

2212 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2213 
	`memıy
(
štfd©a
->
iâame
, 
içû_Çme
, 
	`¡¾’
(iface_name));

2214 
	`SLSI_ERR
(
sdev
, "NAN d–‘štàif_Çme:%s\n", 
içû_Çme
);

2215 
štfd©a
->
Œª§ùiÚ_id
 =ransaction_id;

2216 
	`li¡_add
(&
štfd©a
->
li¡
, &
sdev
->
Çn_d©a_š‹rçû_d–‘e_d©a
);

2217 
	`scheduË_wÜk
(&
sdev
->
Çn_d©a_š‹rçû_d–‘e_wÜk
);

2218 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2219 
ex™
:

2220 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2221 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
sdev
->
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INTERFACE_DELETE
, 0, 
NULL
, 
Œª§ùiÚ_id
, NULL);

2222  
»t
;

2223 
	}
}

2225 
	$¦si_Çn_d©a_içû_d–‘e
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2227 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2228 
u8
 
içû_Çme
[
IFNAMSIZ
] = {0};

2229 
»t
 = 0, 
if_idx
, 
ty³
, 
tmp
;

2230 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2231 
Ãt_deviû
 *
dev_ndp
 = 
NULL
;

2232 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2233 cÚ¡ 
Æ©Œ
 *
™”
;

2234 
u16
 
Œª§ùiÚ_id
 = 0;

2236 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2237 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2238 
ex™
;

2240 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2241 
ty³
 = 
	`Æa_ty³
(
™”
);

2242 ià(
ty³
 =ğ
NAN_REQ_ATTR_DATA_INTERFACE_NAME
) {

2246 ià(
	`Æa_Ën
(
™”
è> 
IFNAMSIZ
)

2247  -
EINVAL
;

2248 
	`memıy
(
içû_Çme
, 
	`Æa_d©a
(
™”
), 
	`Æa_Ën
(iter));

2249 
	`SLSI_ENSURE_NULL_TERMINATED
(
içû_Çme
, (iface_name));

2250 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
)

2251 
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
));

2253 ià(!
içû_Çme
[0]) {

2254 
	`SLSI_ERR
(
sdev
, "No NAN data interface‚ame\n");

2255 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2256 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2257 
ex™
;

2260 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2261 
if_idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; if_idx < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; if_idx++) {

2262 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2263 ià(
dev_ndp
 && 
	`¡rcmp
(
içû_Çme
, dev_ndp->
Çme
) == 0)

2265 
dev_ndp
 = 
NULL
;

2268 ià(
dev_ndp
) {

2269 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev_ndp
);

2270 
	`SLSI_INFO
(
sdev
, "Sucûs ŒªsId:%d içûName:%s\n", 
Œª§ùiÚ_id
, 
içû_Çme
);

2273 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2274 
ex™
:

2275 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INTERFACE_DELETE
, 0, 
NULL
, 
Œª§ùiÚ_id
, NULL);

2276  
»t
;

2277 
	}
}

2280 #ià(
KERNEL_VERSION
(5, 12, 0è<ğ
LINUX_VERSION_CODE
)

2281 
	$¦si_Çn_d©a_š‹rçû_ü—‹_wq
(
wÜk_¡ruù
 *
wÜk
)

2283 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
Çn_d©a_š‹rçû_ü—‹_wÜk
);

2284 
if_idx
;

2285 
Ãt_deviû
 *
dev_ndp
 = 
NULL
;

2286 
Ãtdev_vif
 *
ndev_d©a_vif
 = 
NULL
;

2287 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2288 
boŞ
 
is_cfg80211
 = 
Œue
;

2289 
»t
 = 0;

2290 
li¡_h—d
 *
d©a_štf_pos
, *
d©a_štf_q
;

2291 
Œª§ùiÚ_id
 = 0;

2292 
”r
;

2294 
	`¹Æ_lock
();

2295 
	`mu‹x_lock
(&
sdev
->
why
->
mtx
);

2296 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2297 
	`SLSI_ERR
(
sdev
, "In Data Interface create Work Queue\n");

2298 
	`li¡_fÜ_—ch_§ã
(
d©a_štf_pos
, 
d©a_štf_q
, &
sdev
->
Çn_d©a_š‹rçû_ü—‹_d©a
) {

2299 
¦si_Çn_d©a_š‹rçû_ü—‹_šfo
 *
aw¬e_štf_ü—‹
;

2301 
aw¬e_štf_ü—‹
 = 
	`li¡_’Œy
(
d©a_štf_pos
, 
¦si_Çn_d©a_š‹rçû_ü—‹_šfo
, 
li¡
);

2302 ià(!
aw¬e_štf_ü—‹
) {

2303 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2304 
	`mu‹x_uÆock
(&
sdev
->
why
->
mtx
);

2305 
	`¹Æ_uÆock
();

2308 
Œª§ùiÚ_id
 = 
aw¬e_štf_ü—‹
->transaction_id;

2311 
if_idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; if_idx < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; if_idx++) {

2312 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2313 ià(!
dev_ndp
)

2317 ià(
if_idx
 >ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1) {

2318 
	`SLSI_ERR
(
sdev
, "NAN‚o free NAN data interfaces\n");

2319 
»t
 = 
WIFI_HAL_ERROR_TOO_MANY_REQUESTS
;

2320 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2321 
ex™_w™h_lock
;

2324 
”r
 = 
	`¦si_Ãtif_add_locked
(
sdev
, 
aw¬e_štf_ü—‹
->
iâame
, 
if_idx
);

2325 ià(
”r
) {

2326 
	`SLSI_ERR
(
sdev
, "NAN fa‚‘_if_add if_Çme:%s, if_idx:%d\n", 
aw¬e_štf_ü—‹
->
iâame
, 
if_idx
);

2327 
»t
 = 
WIFI_HAL_ERROR_OUT_OF_MEMORY
;

2328 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2329 
ex™_w™h_lock
;

2332 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2333 ià(!
dev_ndp
)

2334 
ex™_w™h_lock
;

2336 
”r
 = 
	`¦si_Ãtif_»gi¡”_locked
(
sdev
, 
dev_ndp
);

2337 ià(
”r
) {

2338 
	`SLSI_ERR
(
sdev
, "NAN fa‚‘devƒ¼:%d if_Çme:%s, if_idx:%d\n", 
”r
);

2339 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2340 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2342 
	`SLSI_INFO
(
sdev
, "Œªs_id:%d, if_Çme:%s, if_idx:%d\n", 
Œª§ùiÚ_id
, 
aw¬e_štf_ü—‹
->
iâame
, 
if_idx
);

2343 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
dev_ndp
);

2344 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

2345 
ndev_d©a_vif
->
vif_ty³
 = 
SLSI_NAN_VIF_TYPE_NDP
;

2346 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

2348 
	`li¡_d–
(
d©a_štf_pos
);

2349 
	`kä“
(
aw¬e_štf_ü—‹
);

2350 
	`¦si_v’dÜ_Çn_ev’t_ü—‹_d–‘e
(
sdev
, 
SLSI_NL80211_NAN_INTERFACE_CREATED_EVENT
, 
Œª§ùiÚ_id
, 0);

2352 
	`INIT_LIST_HEAD
(&
sdev
->
Çn_d©a_š‹rçû_ü—‹_d©a
);

2354 
ex™_w™h_lock
:

2355 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2356 
	`mu‹x_uÆock
(&
sdev
->
why
->
mtx
);

2357 
	`¹Æ_uÆock
();

2358 
	}
}

2360 
	$¦si_Çn_d©a_š‹rçû_d–‘e_wq
(
wÜk_¡ruù
 *
wÜk
)

2362 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
Çn_d©a_š‹rçû_d–‘e_wÜk
);

2363 
Ãt_deviû
 *
dev_ndp
 = 
NULL
;

2364 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2365 
boŞ
 
is_cfg80211
 = 
Œue
;

2366 
if_idx
;

2367 
li¡_h—d
 *
d©a_štf_pos
, *
d©a_štf_q
;

2368 
Œª§ùiÚ_id
 = 0;

2370 
	`¹Æ_lock
();

2371 
	`mu‹x_lock
(&
sdev
->
why
->
mtx
);

2372 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2373 
	`SLSI_INFO
(
sdev
, "In Nan Interface Delete Work\n");

2374 
	`li¡_fÜ_—ch_§ã
(
d©a_štf_pos
, 
d©a_štf_q
, &
sdev
->
Çn_d©a_š‹rçû_d–‘e_d©a
) {

2375 
¦si_Çn_d©a_š‹rçû_d–‘e_šfo
 *
aw¬e_štf_d–‘e
;

2377 
aw¬e_štf_d–‘e
 = 
	`li¡_’Œy
(
d©a_štf_pos
, 
¦si_Çn_d©a_š‹rçû_d–‘e_šfo
, 
li¡
);

2378 ià(!
aw¬e_štf_d–‘e
) {

2379 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2380 
	`mu‹x_uÆock
(&
sdev
->
why
->
mtx
);

2381 
	`¹Æ_uÆock
();

2384 
Œª§ùiÚ_id
 = 
aw¬e_štf_d–‘e
->transaction_id;

2386 
if_idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; if_idx < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; if_idx++) {

2387 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2388 ià(
dev_ndp
 && 
	`¡rcmp
(
aw¬e_štf_d–‘e
->
iâame
, dev_ndp->
Çme
) == 0)

2390 
dev_ndp
 = 
NULL
;

2393 ià(
dev_ndp
) {

2394 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev_ndp
, 
is_cfg80211
);

2395 
	`SLSI_INFO
(
sdev
, "Sucûs ŒªsId:%d içûName:%s\n", 
Œª§ùiÚ_id
, 
aw¬e_štf_d–‘e
->
iâame
);

2397 
	`li¡_d–
(
d©a_štf_pos
);

2398 
	`kä“
(
aw¬e_štf_d–‘e
);

2400 
	`¦si_v’dÜ_Çn_ev’t_ü—‹_d–‘e
(
sdev
, 
SLSI_NL80211_NAN_INTERFACE_DELETED_EVENT
, 
Œª§ùiÚ_id
, 
»¶y_¡©us
);

2402 
	`INIT_LIST_HEAD
(&
sdev
->
Çn_d©a_š‹rçû_d–‘e_d©a
);

2403 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2404 
	`mu‹x_uÆock
(&
sdev
->
why
->
mtx
);

2405 
	`¹Æ_uÆock
();

2406 
	}
}

2409 
	$¦si_Çn_ndp_š™Ÿ‹_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
,

2410 cÚ¡ *
d©a
, 
Ën
)

2412 
ty³
, 
tmp
, 
r
;

2413 cÚ¡ 
Æ©Œ
 *
™”
;

2415 
	`mem£t
(
h®_»q
, 0, (*hal_req));

2416 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2417 
ty³
 = 
	`Æa_ty³
(
™”
);

2418 
ty³
) {

2419 
NAN_REQ_ATTR_REQ_INSTANCE_ID
:

2420 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
»que¡Ü_š¡ªû_id
);

2423 
NAN_REQ_ATTR_CHAN_REQ_TYPE
:

2424 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
chªÃl_»que¡_ty³
);

2427 
NAN_REQ_ATTR_CHAN
:

2428 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
chªÃl
);

2431 
NAN_REQ_ATTR_MAC_ADDR_VAL
:

2432 ià(
	`Æa_Ën
(
™”
è< 
ETH_ALEN
)

2433  -
EINVAL
;

2434 
	`‘h”_addr_cİy
(
h®_»q
->
³”_disc_mac_addr
, 
	`Æa_d©a
(
™”
));

2437 
NAN_REQ_ATTR_DATA_INTERFACE_NAME
:

2438 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
IFNAMSIZ
, 
h®_»q
->
ndp_içû
);

2441 
NAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
:

2444 
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
:

2445 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
£cur™y_cfg
);

2448 
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
:

2449 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
qos_cfg
);

2452 
NAN_REQ_ATTR_APP_INFO_LEN
:

2453 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
);

2456 
NAN_REQ_ATTR_APP_INFO
:

2457 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
 > 
SLSI_HAL_NAN_DP_MAX_APP_INFO_LEN
)

2458  -
EINVAL
;

2459 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
,

2460 
h®_»q
->
­p_šfo
.
ndp_­p_šfo
);

2463 
NAN_REQ_ATTR_SERVICE_NAME_LEN
:

2464 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
£rviû_Çme_Ën
);

2467 
NAN_REQ_ATTR_SERVICE_NAME
:

2468 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

2471 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

2472 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

2476 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
key_šfo
, 
™”
, 
ty³
);

2477 ià(
r
)

2478 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN‚d°©Œibu‹ TYPE:%d\n", 
ty³
);

2481  
SLSI_HAL_NAN_STATUS_SUCCESS
;

2482 
	}
}

2484 
	$¦si_Çn_ndp_š™Ÿ‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2486 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2487 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2488 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2489 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
 = 
NULL
;

2490 
»t
;

2491 
u32
 
ndp_š¡ªû_id
 = 0;

2492 
u16
 
ndl_vif_id
, 
Œª§ùiÚ_id
 = 0;

2493 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2495 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2496 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2497 
ex™
;

2499 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

2500 ià(!
h®_»q
) {

2501 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc hal_req structure!!!\n");

2502 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2503 
»t
 = 
WIFI_HAL_ERROR_OUT_OF_MEMORY
;

2504 
ex™
;

2507 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2508 
»¶y_¡©us
 = 
	`¦si_Çn_ndp_š™Ÿ‹_g‘_Æ_·¿ms
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

2509 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

2510 ià(
»¶y_¡©us
) {

2511 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2512 
ex™
;

2515 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2516 ià(!
ndev_vif
->
aùiv©ed
) {

2517 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

2518 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

2519 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

2520 
ex™_w™h_lock
;

2523 
ndp_š¡ªû_id
 = 
	`¦si_Çn_g‘_Ãw_ndp_š¡ªû_id
(
ndev_vif
);

2525 ià(!
ndp_š¡ªû_id
) {

2526 
	`SLSI_WARN
(
sdev
, "NAN‚o free‚dp slots\n");

2527 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2528 
»t
 = 
WIFI_HAL_ERROR_TOO_MANY_REQUESTS
;

2529 
ex™_w™h_lock
;

2532 
ndev_vif
->
Çn
.
Ãxt_ndp_š¡ªû_id
 = (
ndp_š¡ªû_id
 + 1è% (
SLSI_NAN_MAX_NDP_INSTANCES
 + 1);

2533 
ndl_vif_id
 = 
	`¦si_Çn_ndp_g‘_ndl_vif_id
(
h®_»q
->
³”_disc_mac_addr
, 
ndev_vif
->
Çn
.
ndl_li¡
);

2534 ià(
ndl_vif_id
 >ğ
SLSI_NAN_MAX_NDP_INSTANCES
 + 
SLSI_NAN_DATA_IFINDEX_START
) {

2535 
	`SLSI_WARN
(
sdev
, "NAN‚o free‚dl slots\n");

2536 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2537 
»t
 = 
WIFI_HAL_ERROR_TOO_MANY_REQUESTS
;

2538 
ex™_w™h_lock
;

2540 
»t
 = 
	`¦si_mlme_ndp_»que¡
(
sdev
, 
dev
, 
h®_»q
, 
ndp_š¡ªû_id
, 
ndl_vif_id
);

2541 ià(
»t
) {

2542 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2543 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2545 
	`SLSI_INFO
(
sdev
, "TId:%d‚dp_ins_id:%d‚dlVif:%d iface:%s\n",

2546 
h®_»q
->
Œª§ùiÚ_id
, 
ndp_š¡ªû_id
, 
ndl_vif_id
, h®_»q->
ndp_içû
);

2547 
ndev_vif
->
Çn
.
ndp_¡¬t_time
 = 
jiff›s
;

2548 
»t
 = 
WIFI_HAL_SUCCESS
;

2551 
ex™_w™h_lock
:

2552 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2553 
ex™
:

2554 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INITIATOR_RESPONSE
, (
u16
)
ndp_š¡ªû_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

2555 
	`kä“
(
h®_»q
);

2556  
»t
;

2557 
	}
}

2559 
	$¦si_Çn_ndp_»¥Úd_g‘_Æ_·¿m
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
,

2560 cÚ¡ *
d©a
, 
Ën
)

2562 
ty³
, 
tmp
, 
r
;

2563 cÚ¡ 
Æ©Œ
 *
™”
;

2564 
u8
 
v®
 = 0;

2565 
u32
 
v®ue
 = 0;

2567 
	`mem£t
(
h®_»q
, 0, (*hal_req));

2568 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2569 
ty³
 = 
	`Æa_ty³
(
™”
);

2570 
ty³
) {

2571 
NAN_REQ_ATTR_NDP_INSTANCE_ID
:

2572 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
ndp_š¡ªû_id
);

2575 
NAN_REQ_ATTR_DATA_INTERFACE_NAME
:

2576 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
IFNAMSIZ
, 
h®_»q
->
ndp_içû
);

2578 
NAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
:

2581 
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
:

2582 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
£cur™y_cfg
);

2585 
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
:

2586 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
qos_cfg
);

2589 
NAN_REQ_ATTR_APP_INFO_LEN
:

2590 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
);

2593 
NAN_REQ_ATTR_APP_INFO
:

2594 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
 > 
SLSI_HAL_NAN_DP_MAX_APP_INFO_LEN
)

2595  -
EINVAL
;

2596 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
,

2597 
h®_»q
->
­p_šfo
.
ndp_­p_šfo
);

2600 
NAN_REQ_ATTR_NDP_RESPONSE_CODE
:

2601 
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
);

2602 
h®_»q
->
r¥_code
 = (
u32
)
v®
;

2605 
NAN_REQ_ATTR_SERVICE_NAME_LEN
:

2606 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
v®ue
);

2607 
h®_»q
->
£rviû_Çme_Ën
 = (
u8
)
v®ue
;

2610 
NAN_REQ_ATTR_SERVICE_NAME
:

2611 
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

2614 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

2615 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

2619 
r
 = 0;

2620 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
key_šfo
, 
™”
, 
ty³
);

2621 ià(
r
)

2622 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN‚d°©Œibu‹ TYPE:%d\n", 
ty³
);

2625  
SLSI_HAL_NAN_STATUS_SUCCESS
;

2626 
	}
}

2628 
	$¦si_Çn_ndp_»¥Úd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2630 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2631 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2632 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2633 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
 = 
NULL
;

2634 
»t
;

2635 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2636 
u16
 
Œª§ùiÚ_id
 = 0, 
ndp_š¡ªû_id
 = 0, 
loÿl_ndp_š¡ªû_id
;

2638 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2639 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2640 
ex™
;

2642 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

2643 ià(!
h®_»q
) {

2644 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc hal_req structure!!!\n");

2645 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2646 
»t
 = 
WIFI_HAL_ERROR_OUT_OF_MEMORY
;

2647 
ex™
;

2650 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2651 
»¶y_¡©us
 = 
	`¦si_Çn_ndp_»¥Úd_g‘_Æ_·¿m
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

2652 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

2653 
ndp_š¡ªû_id
 = 
h®_»q
->ndp_instance_id;

2654 ià(
»¶y_¡©us
) {

2655 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2656 
ex™
;

2659 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2660 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2661 ià(!
ndev_vif
->
aùiv©ed
) {

2662 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

2663 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

2664 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

2665 
ex™_w™h_locks
;

2668 ià(
h®_»q
->
ndp_š¡ªû_id
 > 0 && h®_»q->ndp_š¡ªû_id <ğ
SLSI_NAN_MAX_NDP_INSTANCES
) {

2669 
loÿl_ndp_š¡ªû_id
 = 
ndev_vif
->
Çn
.
ndp_loÿl_ndp_š¡ªû_id
[
h®_»q
->
ndp_š¡ªû_id
 - 1];

2671 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2672 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2673 
ex™_w™h_locks
;

2675 
»t
 = 
	`¦si_mlme_ndp_»¥Ú£
(
sdev
, 
dev
, 
h®_»q
, 
loÿl_ndp_š¡ªû_id
);

2676 ià(
»t
) {

2677 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2678 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2680 
	`SLSI_INFO
(
sdev
, "transId:%d‚dpId:%d iface:%s\n",

2681 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
ndp_š¡ªû_id
, h®_»q->
ndp_içû
);

2682 
»t
 = 
WIFI_HAL_SUCCESS
;

2685 
ex™_w™h_locks
:

2686 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2687 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2688 
ex™
:

2689 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_RESPONDER_RESPONSE
,

2690 
ndp_š¡ªû_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

2691 
	`kä“
(
h®_»q
);

2692  
»t
;

2693 
	}
}

2695 
	$¦si_Çn_ndp_’d_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_d©a_’d
 *
h®_»q
,

2696 cÚ¡ *
d©a
, 
Ën
)

2698 
ty³
, 
tmp
;

2699 cÚ¡ 
Æ©Œ
 *
™”
;

2700 
u32
 
v®
 = 0;

2702 
	`mem£t
(
h®_»q
, 0, (*hal_req));

2703 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2704 
ty³
 = 
	`Æa_ty³
(
™”
);

2705 ià(
ty³
 =ğ
NAN_REQ_ATTR_NDP_INSTANCE_ID
 && 
h®_»q
->
num_ndp_š¡ªûs
 < 
SLSI_NAN_MAX_NDP_INSTANCES
) {

2706 
	`¦si_ut_Æa_g‘_u32
(
™”
, &
v®
);

2707 
h®_»q
->
ndp_š¡ªû_id
[h®_»q->
num_ndp_š¡ªûs
++] = 
v®
;

2708 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
) {

2709 
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
);

2712  
SLSI_HAL_NAN_STATUS_SUCCESS
;

2713 
	}
}

2715 
	$¦si_Çn_ndp_’d
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2717 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2718 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2719 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2720 
¦si_h®_Çn_d©a_’d
 
h®_»q
;

2721 
»t
, 
i
;

2722 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2724 
h®_»q
.
Œª§ùiÚ_id
 = 0;

2725 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2726 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2727 
ex™
;

2729 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2730 
»¶y_¡©us
 = 
	`¦si_Çn_ndp_’d_g‘_Æ_·¿ms
(
sdev
, &
h®_»q
, 
d©a
, 
Ën
);

2732 ià(
»¶y_¡©us
) {

2733 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2734 
ex™
;

2737 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2738 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2739 ià(!
ndev_vif
->
aùiv©ed
) {

2740 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

2741 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 0, 
NULL
);

2742 
»t
 = 
WIFI_HAL_SUCCESS
;

2743 
ex™_w™h_locks
;

2745 
i
 = 0; i < 
h®_»q
.
num_ndp_š¡ªûs
; i++)

2746 ià(
h®_»q
.
ndp_š¡ªû_id
[
i
] > 0 && h®_»q.ndp_š¡ªû_id[i] <ğ
SLSI_NAN_MAX_NDP_INSTANCES
) {

2747 
»t
 = 
	`¦si_mlme_ndp_‹rmš©e
(
sdev
, 
dev
, 
h®_»q
.
ndp_š¡ªû_id
[
i
], h®_»q.
Œª§ùiÚ_id
);

2748 
	`SLSI_INFO
(
sdev
,

2750 
h®_»q
.
Œª§ùiÚ_id
, h®_»q.
ndp_š¡ªû_id
[
i
], i + 1, h®_»q.
num_ndp_š¡ªûs
, 
»t
);

2751 ià(!
»t
)

2752 
ndev_vif
->
Çn
.
ndp_¡©e
[
h®_»q
.
ndp_š¡ªû_id
[
i
] - 1] = 
ndp_¦Ù_¡©us_‹rmš©šg
;

2754 
	`SLSI_ERR
(
sdev
, "IgnÜšv®id‚dp_š¡ªû_id:%d\n", 
h®_»q
.
ndp_š¡ªû_id
[
i
]);

2757 
ex™_w™h_locks
:

2758 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2759 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2760 
ex™
:

2761 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_END
, 0, 
NULL
, 
h®_»q
.
Œª§ùiÚ_id
, 
ndev_vif
);

2762  
»t
;

2763 
	}
}

2767 
	$¦si_Çn_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2769 
sk_buff
 *
Æ_skb
 = 
NULL
;

2770 
»s
 = 0;

2771 
u16
 
ev’t
, 
id’tif›r
, 
evt_»asÚ
, 
fŞlowup_Œªs_id
, 
m©ch_id
;

2772 
u8
 *
mac_addr
;

2773 
u16
 
h®_ev’t
, 
»asÚ_code
, 
š¡ªûid
;

2774 
Ãtdev_vif
 *
ndev_vif
;

2775 
¦si_Çn_disc_ev’t_ty³
 
disc_ev’t_ty³
 = 0;

2777 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2778 
ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.event);

2779 
id’tif›r
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.identifier);

2780 
mac_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.
add»ss_Ü_id’tif›r
);

2781 
»asÚ_code
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.reason_code);

2782 
š¡ªûid
 = 
mac_addr
[0] | (mac_addr[1] << 8);

2784 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2786 
	`SLSI_INFO
(
sdev
, "Event:%d, Identifier:%d, mac_addr:%pM,„eason_code:%d\n",

2787 
ev’t
, 
id’tif›r
, 
mac_addr
, 
»asÚ_code
);

2788 
»asÚ_code
) {

2789 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_TIMEOUT
:

2790 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_COUNT_REACHED
:

2791 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_DISCOVERY_SHUTDOWN
:

2792 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_USER_REQUEST
:

2793 
FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_SUCCESS
:

2794 
evt_»asÚ
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2796 
FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_FAILURE
:

2797 
evt_»asÚ
 = 
SLSI_HAL_NAN_STATUS_PROTOCOL_FAILURE
;

2800 
evt_»asÚ
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2804 
ev’t
) {

2805 
FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
:

2806 
FAPI_EVENT_WIFI_EVENT_NAN_SUBSCRIBE_TERMINATED
:

2807 ià(
id’tif›r
 > 
SLSI_NAN_MAX_SERVICE_ID
) {

2808 
	`SLSI_WARN
(
sdev
, "£rviûId(%dè> max(%d)\n", 
id’tif›r
, 
SLSI_NAN_MAX_SERVICE_ID
);

2809 
ex™
;

2811 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "map:%d sdf_flags:0x%x\n",

2812 
ndev_vif
->
Çn
.
£rviû_id_m­
,‚dev_vif->Çn.
Çn_sdf_æags
[
id’tif›r
]);

2813 ià(!(
ndev_vif
->
Çn
.
£rviû_id_m­
 & 
	`BIT
(
id’tif›r
)))

2814 
ex™
;

2815 
ndev_vif
->
Çn
.
£rviû_id_m­
 &ğ(
u32
)~
	`BIT
(
id’tif›r
);

2816 ià(
ev’t
 =ğ
FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
) {

2817 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] & 
FAPI_NANSDFCONTROL_PUBLISH_END_EVENT
) {

2818 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] = 0;

2819 
ex™
;

2822 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] & 
FAPI_NANSDFCONTROL_SUBSCRIBE_END_EVENT
) {

2823 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] = 0;

2824 
ex™
;

2827 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] = 0;

2828 
h®_ev’t
 = 
ev’t
 =ğ
FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
 ?

2829 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
 : 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
;

2831 
FAPI_EVENT_WIFI_EVENT_NAN_MATCH_EXPIRED
:

2832 ià(
id’tif›r
 > 
SLSI_NAN_MAX_SERVICE_ID
) {

2833 
	`SLSI_WARN
(
sdev
, "£rviûId(%dè> max(%d)\n", 
id’tif›r
, 
SLSI_NAN_MAX_SERVICE_ID
);

2834 
ex™
;

2836 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] & 
FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
)

2837 
ex™
;

2838 
h®_ev’t
 = 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
;

2840 
FAPI_EVENT_WIFI_EVENT_NAN_ADDRESS_CHANGED
:

2841 
disc_ev’t_ty³
 = 
NAN_EVENT_ID_DISC_MAC_ADDR
;

2842 
h®_ev’t
 = 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
;

2843 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
loÿl_nmi
, 
mac_addr
);

2845 
FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_STARTED
:

2846 
disc_ev’t_ty³
 = 
NAN_EVENT_ID_STARTED_CLUSTER
;

2847 
h®_ev’t
 = 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
;

2848 
	`‘h”_addr_cİy
(
sdev
->
Çn_şu¡”_id
, 
mac_addr
);

2850 
FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_JOINED
:

2851 
disc_ev’t_ty³
 = 
NAN_EVENT_ID_JOINED_CLUSTER
;

2852 
h®_ev’t
 = 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
;

2853 
	`‘h”_addr_cİy
(
sdev
->
Çn_şu¡”_id
, 
mac_addr
);

2855 
FAPI_EVENT_WIFI_EVENT_NAN_TRANSMIT_FOLLOWUP
:

2856 ià(
id’tif›r
 > 
SLSI_NAN_MAX_SERVICE_ID
) {

2857 
	`SLSI_WARN
(
sdev
, "£rviûId(%dè> max(%d)\n", 
id’tif›r
, 
SLSI_NAN_MAX_SERVICE_ID
);

2858 
ex™
;

2860 
m©ch_id
 = 
š¡ªûid
;

2861 
fŞlowup_Œªs_id
 = 
	`¦si_Çn_g‘_fŞlowup_Œªs_id
(
ndev_vif
, 
m©ch_id
);

2862 
	`¦si_Çn_pİ_fŞlowup_ids
(
sdev
, 
dev
, 
m©ch_id
);

2863 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] & 
FAPI_NANSDFCONTROL_FOLLOWUP_TRANSMIT_STATUS
)

2864 
ex™
;

2865 
h®_ev’t
 = 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
;

2866 
	`SLSI_INFO
(
sdev
, "m©ch_id:%d, fŞlowup_Œªs_id:%d\n", 
m©ch_id
, 
fŞlowup_Œªs_id
);

2869 
ex™
;

2872 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2873 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

2874 
	`¦si_´št_ev’t_Çme
(
h®_ev’t
), hal_event);

2877 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

2878 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
h®_ev’t
, 
GFP_KERNEL
);

2880 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
h®_ev’t
, 
GFP_KERNEL
);

2882 ià(!
Æ_skb
) {

2883 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

2884 
ex™
;

2887 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_STATUS
, 
evt_»asÚ
);

2888 
h®_ev’t
) {

2889 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
:

2890 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_PUBLISH_ID
, 
id’tif›r
);

2892 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
:

2893 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_PUBLISH_SUBSCRIBE_ID
, 
id’tif›r
);

2894 
»s
 |ğ
	`Æa_put_be32
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_REQUESTOR_INSTANCE_ID
, 
š¡ªûid
);

2896 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
:

2897 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_SUBSCRIBE_ID
, 
id’tif›r
);

2899 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
:

2900 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_EVT_TYPE
, 
disc_ev’t_ty³
);

2901 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
, 
ETH_ALEN
, 
mac_addr
);

2903 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
:

2904 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_HAL_TRANSACTION_ID
, 
fŞlowup_Œªs_id
);

2908 ià(
»s
) {

2909 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

2911 
	`kä“_skb
(
Æ_skb
);

2912 
ex™
;

2915 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

2917 
ex™
:

2918 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2919 
	`kä“_skb
(
skb
);

2920 
	}
}

2922 
	$¦si_Çn_£nd_di§bËd_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
»asÚ
)

2924 
sk_buff
 *
Æ_skb
 = 
NULL
;

2925 
»s
 = 0;

2926 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2928 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2929 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

2930 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_DISABLED_EVENT
,

2931 
GFP_KERNEL
);

2933 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_DISABLED_EVENT
,

2934 
GFP_KERNEL
);

2936 ià(!
Æ_skb
) {

2937 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

2940 
»s
 = 
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_DISABLED_REASON
, 
»asÚ
);

2941 ià(
»s
) {

2942 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

2943 
	`kä“_skb
(
Æ_skb
);

2946 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

2947 
	}
}

2949 
	$¦si_Çn_fŞlowup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2951 
u16
 
g_id
, 
g_Ën
;

2952 
u8
 *
±r
 = 
NULL
;

2953 
¦si_h®_Çn_fŞlowup_šd
 *
h®_evt
;

2954 
sk_buff
 *
Æ_skb
;

2955 
»s
;

2956 
sig_d©a_Ën
;

2957 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2958 *
šfo_¡ršg
 = 
NULL
;

2960 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2962 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2963 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

2965 
h®_evt
 = 
	`km®loc
((*h®_evt), 
GFP_KERNEL
);

2966 ià(!
h®_evt
) {

2967 
	`SLSI_ERR
(
sdev
, "No memory for followup_ind\n");

2968 
ex™
;

2970 
	`mem£t
(
h®_evt
, 0, (*hal_evt));

2972 
h®_evt
->
publish_subsüibe_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_fŞlowup_šd
.
£ssiÚ_id
);

2973 
h®_evt
->
»que¡Ü_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_fŞlowup_šd
.
m©ch_id
);

2974 
	`‘h”_addr_cİy
(
h®_evt
->
addr
,

2975 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_Çn_fŞlowup_šd
.
³”_Çn_mªagem’t_š‹rçû_add»ss
));

2977 
	`SLSI_INFO
(
sdev
, "pub_sub_id:%d,„eq_š¡ªû_id:%d,…“r_addr:" 
MACSTR
 "\n",

2978 
h®_evt
->
publish_subsüibe_id
,

2979 
h®_evt
->
»que¡Ü_š¡ªû_id
,

2980 
	`MAC2STR
(
h®_evt
->
addr
));

2982 ià(
sig_d©a_Ën
 > 4)

2983 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

2985 ià(
±r
) {

2986 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

2987 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

2989 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

2990 ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
) {

2991 
h®_evt
->
£rviû_¥ecific_šfo_Ën
 = 
g_Ën
 > 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 ?

2992 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 : 
g_Ën
;

2993 
	`memıy
(
h®_evt
->
£rviû_¥ecific_šfo
, 
±r
 + 4, h®_evt->
£rviû_¥ecific_šfo_Ën
);

2994 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

2995 
h®_evt
->
£rviû_¥ecific_šfo
);

2996 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "service_specific_info_len:%d, service_specific_info:%s\n",

2997 
h®_evt
->
£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

2998 } ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
) {

2999 ià(
g_Ën
 > 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
)

3000 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
;

3002 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
g_Ën
;

3003 
	`memıy
(
h®_evt
->
sd—_£rviû_¥ecific_šfo
, 
±r
 + 4,

3004 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

3005 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

3006 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

3007 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

3009 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

3011 
	`SLSI_WARN
(
sdev
, "Sk…roûssšg TLV %d\n", 
g_id
);

3013 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

3014 
±r
 +ğ
g_Ën
 + 4;

3015 ià(
sig_d©a_Ën
 > 4) {

3016 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3017 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3019 
g_id
 = 0;

3020 
g_Ën
 = 0;

3025 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3026 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3027 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_NAN_FOLLOWUP_EVENT
), SLSI_NL80211_NAN_FOLLOWUP_EVENT);

3029 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3030 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
,

3031 
GFP_KERNEL
);

3033 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
,

3034 
GFP_KERNEL
);

3037 ià(!
Æ_skb
) {

3038 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3039 
	`kä“
(
h®_evt
);

3040 
ex™
;

3043 
»s
 = 
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_PUBLISH_SUBSCRIBE_ID
,

3044 
	`ıu_to_Ë16
(
h®_evt
->
publish_subsüibe_id
));

3045 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_REQUESTOR_INSTANCE_ID
,

3046 
	`ıu_to_Ë16
(
h®_evt
->
»que¡Ü_š¡ªû_id
));

3047 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_ADDR
, 
ETH_ALEN
, 
h®_evt
->
addr
);

3048 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_DW_OR_FAW
, 
h®_evt
->
dw_Ü_çw
);

3049 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO_LEN
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
);

3050 ià(
h®_evt
->
£rviû_¥ecific_šfo_Ën
)

3051 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

3052 
h®_evt
->
£rviû_¥ecific_šfo
);

3053 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_LEN
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

3054 ià(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
)

3055 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

3056 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

3058 ià(
»s
) {

3059 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3060 
	`kä“
(
h®_evt
);

3062 
	`kä“_skb
(
Æ_skb
);

3063 
ex™
;

3066 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3067 
	`kä“
(
h®_evt
);

3068 
ex™
:

3069 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3070 
	`kä“_skb
(
skb
);

3071 
	}
}

3073 
	$¦si_Çn_£rviû_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3075 
u16
 
g_id
, 
g_Ën
;

3076 
u8
 *
±r
 = 
NULL
;

3077 cÚ¡ 
u8
 *
g_d©a_±r
;

3078 
sig_d©a_Ën
;

3079 
¦si_h®_Çn_m©ch_šd
 *
h®_evt
;

3080 
sk_buff
 *
Æ_skb
;

3081 
»s
;

3082 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3083 *
šfo_¡ršg
 = 
NULL
;

3085 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

3086 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3087 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3088 ià(
sig_d©a_Ën
 <= 4) {

3089 
	`SLSI_ERR
(
sdev
, "Inv®id d©¨Ën(%d)\n", 
sig_d©a_Ën
);

3090 
ex™
;

3093 
h®_evt
 = 
	`km®loc
((*h®_evt), 
GFP_KERNEL
);

3094 ià(!
h®_evt
) {

3095 
	`SLSI_ERR
(
sdev
, "No memory for service_ind\n");

3096 
ex™
;

3099 
	`mem£t
(
h®_evt
, 0, (*hal_evt));

3100 
h®_evt
->
publish_subsüibe_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_£rviû_šd
.
£ssiÚ_id
);

3101 
h®_evt
->
»que¡Ü_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_£rviû_šd
.
m©ch_id
);

3103 
	`SLSI_INFO
(
sdev
, "pub_sub_id:%d,„eq_instance_id:%d,„anging_event:%d,„ange_measurement_mm:%d\n",

3104 
h®_evt
->
publish_subsüibe_id
, h®_evt->
»que¡Ü_š¡ªû_id
, h®_evt->
¿ngšg_ev’t_ty³
,

3105 
h®_evt
->
¿nge_m—su»m’t_mm
);

3107 ià(
sig_d©a_Ën
 > 4)

3108 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

3110 ià(
±r
) {

3111 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3112 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3113 
g_d©a_±r
 = 
±r
 + 4;

3115 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

3116 
g_id
) {

3117 
SLSI_NAN_TLV_TAG_MATCH_IND
:

3118 ià(
g_Ën
 < 0x15) {

3119 
	`SLSI_WARN
(
sdev
, "Inv®idagËn(%dèfÜ SLSI_NAN_TLV_TAG_MATCH_IND\n", 
g_Ën
);

3122 
	`‘h”_addr_cİy
(
h®_evt
->
addr
, 
g_d©a_±r
);

3124 
	`¦si_add_Çn_discov”y_šfo
(
ndev_vif
, 
h®_evt
->
addr
, h®_evt->
publish_subsüibe_id
, h®_evt->
»que¡Ü_š¡ªû_id
);

3125 
g_d©a_±r
 +ğ
ETH_ALEN
;

3126 
h®_evt
->
m©ch_occu¼ed_æag
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

3127 
g_d©a_±r
 += 2;

3128 
h®_evt
->
out_of_»sourû_æag
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

3129 
g_d©a_±r
 += 2;

3130 
h®_evt
->
rssi_v®ue
 = *
g_d©a_±r
;

3131 
g_d©a_±r
++;

3132 
h®_evt
->
£c_šfo
.
ch”_ty³
 = *
g_d©a_±r
;

3133 
g_d©a_±r
++;

3134 
h®_evt
->
³”_sd—_·¿ms
.
£cur™y_cfg
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

3135 
g_d©a_±r
 += 2;

3136 
h®_evt
->
³”_sd—_·¿ms
.
¿ngšg_¡©e
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

3137 
g_d©a_±r
 += 2;

3138 
h®_evt
->
¿nge_m—su»m’t_mm
 = 
	`Ë32_to_ıu
(*(
u32
 *)
g_d©a_±r
) * 10;

3139 
g_d©a_±r
 += 4;

3140 
h®_evt
->
¿ngšg_ev’t_ty³
 = *
g_d©a_±r
;

3141 
g_d©a_±r
++;

3143 
SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
:

3144 
h®_evt
->
£rviû_¥ecific_šfo_Ën
 = 
g_Ën
 > 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 ?

3145 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 : 
g_Ën
;

3146 
	`memıy
(
h®_evt
->
£rviû_¥ecific_šfo
, 
g_d©a_±r
, h®_evt->
£rviû_¥ecific_šfo_Ën
);

3147 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

3148 
h®_evt
->
£rviû_¥ecific_šfo
);

3149 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "service_specific_info_len:%d, service_specific_info:%s\n",

3150 
h®_evt
->
£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

3152 
SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
:

3153 ià(
g_Ën
 > 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
)

3154 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
;

3156 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
g_Ën
;

3157 
	`memıy
(
h®_evt
->
sd—_£rviû_¥ecific_šfo
, 
g_d©a_±r
,

3158 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

3159 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

3160 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

3161 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

3163 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

3165 
SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY
:

3166 ià(
g_Ën
 < 7) {

3167 
	`SLSI_WARN
(
sdev
, "Inv®idagËn(%dèfÜ SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY\n", 
g_Ën
);

3170 
h®_evt
->
£c_šfo
.
key_šfo
.
key_ty³
 = *
g_d©a_±r
;

3171 
g_d©a_±r
++;

3172 
h®_evt
->
£c_šfo
.
ch”_ty³
 = *
g_d©a_±r
;

3173 
g_d©a_±r
++;

3175 
SLSI_NAN_TLV_TAG_MATCH_FILTER
:

3176 ià(
g_Ën
 > 
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
)

3177 
h®_evt
->
sdf_m©ch_f‹r_Ën
 = 
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
;

3179 
h®_evt
->
sdf_m©ch_f‹r_Ën
 = 
g_Ën
;

3180 
	`memıy
(
h®_evt
->
sdf_m©ch_f‹r
, 
g_d©a_±r
, h®_evt->
sdf_m©ch_f‹r_Ën
);

3181 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "sdf_match_filter_len:%d, sdf_match_filter:%*.s\n",

3182 
h®_evt
->
sdf_m©ch_f‹r_Ën
, hal_evt->sdf_match_filter_len > 20 ? 20

3183 : 
h®_evt
->
sdf_m©ch_f‹r_Ën
, h®_evt->
sdf_m©ch_f‹r
);

3186 
	`SLSI_WARN
(
sdev
, "Sk…roûssšg TLV %d\n", 
g_id
);

3190 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

3191 
±r
 +ğ
g_Ën
 + 4;

3192 ià(
sig_d©a_Ën
 > 4) {

3193 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3194 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3195 
g_d©a_±r
 = 
±r
 + 4;

3197 
g_id
 = 0;

3198 
g_Ën
 = 0;

3202 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

3204 
h®_evt
->
addr
, h®_evt->
m©ch_occu¼ed_æag
, h®_evt->
out_of_»sourû_æag
, h®_evt->
rssi_v®ue
,

3205 
h®_evt
->
£c_šfo
.
ch”_ty³
);

3206 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3207 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3208 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_NAN_MATCH_EVENT
), SLSI_NL80211_NAN_MATCH_EVENT);

3210 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3211 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_MATCH_EVENT
,

3212 
GFP_KERNEL
);

3214 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_MATCH_EVENT
, 
GFP_KERNEL
);

3216 ià(!
Æ_skb
) {

3217 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3218 
	`kä“
(
h®_evt
);

3219 
ex™
;

3221 
»s
 = 
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_PUBLISH_SUBSCRIBE_ID
, 
h®_evt
->
publish_subsüibe_id
);

3222 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_REQUESTOR_INSTANCE_ID
, 
h®_evt
->
»que¡Ü_š¡ªû_id
);

3223 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, 
h®_evt
->
addr
);

3224 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO_LEN
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
);

3225 ià(
h®_evt
->
£rviû_¥ecific_šfo_Ën
)

3226 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

3227 
h®_evt
->
£rviû_¥ecific_šfo
);

3228 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER_LEN
, 
h®_evt
->
sdf_m©ch_f‹r_Ën
);

3229 ià(
h®_evt
->
sdf_m©ch_f‹r_Ën
)

3230 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER
, 
h®_evt
->
sdf_m©ch_f‹r_Ën
,

3231 
h®_evt
->
sdf_m©ch_f‹r
);

3232 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_LEN
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

3233 ià(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
)

3234 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

3235 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

3237 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_MATCH_OCCURRED_FLAG
, 
h®_evt
->
m©ch_occu¼ed_æag
);

3238 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_OUT_OF_RESOURCE_FLAG
, 
h®_evt
->
out_of_»sourû_æag
);

3239 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_RSSI_VALUE
, 
h®_evt
->
rssi_v®ue
);

3240 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_PARAM_SECURITY_CONFIG
, 
h®_evt
->
³”_sd—_·¿ms
.
£cur™y_cfg
);

3241 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_PARAM_RANGE_STATE
, 
h®_evt
->
³”_sd—_·¿ms
.
¿ngšg_¡©e
);

3242 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_RANGE_MEASUREMENT_MM
, 
h®_evt
->
¿nge_m—su»m’t_mm
);

3243 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_RANGEING_EVENT_TYPE
, 
h®_evt
->
¿ngšg_ev’t_ty³
);

3244 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_SECURITY_CIPHER_TYPE
, 
h®_evt
->
£c_šfo
.
ch”_ty³
);

3246 ià(
»s
) {

3247 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3249 
	`kä“_skb
(
Æ_skb
);

3250 
	`kä“
(
h®_evt
);

3251 
ex™
;

3254 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3255 
	`kä“
(
h®_evt
);

3256 
ex™
:

3257 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3258 
	`kä“_skb
(
skb
);

3259 
	}
}

3261 
	$¦si_Çn_g‘_»¥_¡©us_code
(
u16
 
çpi_»suÉ_code
, u16 *
»¥_code
, u16 *
¡©us_code
)

3263 
çpi_»suÉ_code
) {

3264 
FAPI_RESULTCODE_SUCCESS
:

3265 *
»¥_code
 = 
NAN_DP_REQUEST_ACCEPT
;

3266 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

3268 
FAPI_RESULTCODE_NDP_REJECTED
:

3269 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3270 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

3272 
FAPI_RESULTCODE_NAN_NO_OTA_ACK
:

3273 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3274 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_NO_OTA_ACK
;

3276 
FAPI_RESULTCODE_NAN_INVALID_AVAILABILITY
:

3277 
FAPI_RESULTCODE_NAN_IMMUTABLE_UNACCEPTABLE
:

3278 
FAPI_RESULTCODE_NAN_REJECTED_SECURITY_POLICY
:

3279 
FAPI_RESULTCODE_NDL_UNACCEPTABLE
:

3280 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3281 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_PROTOCOL_FAILURE
;

3283 
FAPI_RESULTCODE_TRANSMISSION_FAILURE
:

3285 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3286 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

3288 
	}
}

3290 
u32
 
	$¦si_Çn_g‘_ndp_äom_ndl_loÿl_ndi
(
Ãt_deviû
 *
dev
, 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
)

3292 
j
;

3293 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3295 
j
 = 0; j < 
SLSI_NAN_MAX_NDP_INSTANCES
; j++) {

3296 ià(
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
j
] =ğ
ndl_vif_id
) {

3297 ià(
	`‘h”_addr_equ®
(
ndev_vif
->
Çn
.
ndp_ndi
[
j
], 
loÿl_ndi
))

3298  
j
 + 1;

3301  
SLSI_NAN_MAX_NDP_INSTANCES
 + 1;

3302 
	}
}

3304 
	$¦si_Çn_put_ndp_»q_šd_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

3305 
sk_buff
 *
Æ_skb
, 
u8
 **
³”_ndi
, 
u16
 *
»¥_code
, u16 *
ndp_š¡ªû_id
)

3307 
»s
;

3308 
u16
 
¡©us_code
;

3310 *
³”_ndi
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_ndp_»que¡_šd
.
³”_ndp_š‹rçû_add»ss
);

3311 
	`¦si_Çn_g‘_»¥_¡©us_code
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡_šd
.
»suÉ_code
), 
»¥_code
, &
¡©us_code
);

3312 *
ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡_šd
.ndp_instance_id);

3314 
»s
 = 
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, *
ndp_š¡ªû_id
);

3315 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, *
³”_ndi
);

3317 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_RSP_CODE
, *
»¥_code
);

3318 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_STATUS_CODE
, 
¡©us_code
);

3319  
»s
;

3320 
	}
}

3322 
	$¦si_Çn_put_ndp_»¥_šd_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

3323 
sk_buff
 *
Æ_skb
, 
u8
 **
³”_ndi
, 
u16
 *
»¥_code
, u16 *
ndp_š¡ªû_id
)

3325 
»s
;

3326 
u16
 
¡©us_code
;

3328 *
³”_ndi
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_ndp_»¥Ú£_šd
.
³”_ndp_š‹rçû_add»ss
);

3329 
	`¦si_Çn_g‘_»¥_¡©us_code
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»¥Ú£_šd
.
»suÉ_code
), 
»¥_code
, &
¡©us_code
);

3330 *
ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»¥Ú£_šd
.ndp_instance_id);

3332 
»s
 = 
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, *
ndp_š¡ªû_id
);

3333 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, *
³”_ndi
);

3335 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_RSP_CODE
, *
»¥_code
);

3336 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_STATUS_CODE
, 
¡©us_code
);

3338  
»s
;

3339 
	}
}

3341 
	$¦si_Çn_ndp_£tup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
is_»q_šd
)

3343 
u16
 
g_id
, 
g_Ën
;

3344 
u8
 *
±r
 = 
NULL
;

3345 cÚ¡ 
u8
 *
g_d©a_±r
;

3346 
sig_d©a_Ën
;

3347 
sk_buff
 *
Æ_skb
;

3348 
»s
;

3349 
u8
 *
³”_ndi
;

3350 
u16
 
ndp_£tup_»¥Ú£
, 
ndp_š¡ªû_id
;

3351 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3352 
d–ay_š_ms
 = 0;

3353 
ndp_£tup_time
 = 0;

3354 *
šfo_¡ršg
 = 
NULL
;

3355 
u16
 
æow_id
 = 0;

3356 
u16
 
ndl_vif_id
 = 0, 
ndl_id
 = 0;

3358 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

3359 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3360 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3361 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3363 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3364 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_CFM
,

3365 
GFP_KERNEL
);

3367 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_CFM
, 
GFP_KERNEL
);

3369 ià(!
Æ_skb
) {

3370 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3371 
ex™
;

3374 ià(
is_»q_šd
) {

3375 
»s
 = 
	`¦si_Çn_put_ndp_»q_šd_·¿ms
(
sdev
, 
dev
, 
skb
, 
Æ_skb
, &
³”_ndi
, &
ndp_£tup_»¥Ú£
, &
ndp_š¡ªû_id
);

3376 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡_šd
.flow_id);

3378 
»s
 = 
	`¦si_Çn_put_ndp_»¥_šd_·¿ms
(
sdev
, 
dev
, 
skb
, 
Æ_skb
, &
³”_ndi
, &
ndp_£tup_»¥Ú£
, &
ndp_š¡ªû_id
);

3379 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»¥Ú£_šd
.flow_id);

3382 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

3383 
	`SLSI_ERR
(
sdev
, "Inv®id‚dp_š¡ªû_id:%d\n", 
ndp_š¡ªû_id
);

3384 
	`kä“_skb
(
Æ_skb
);

3385 
ex™
;

3388 
	`SLSI_INFO
(
sdev
, "is_»q_šd:%d,…“r_ndi:" 
MACSTR
 ", setup_response:%d, instance_id:%d\n",

3389 
is_»q_šd
, 
	`MAC2STR
(
³”_ndi
), 
ndp_£tup_»¥Ú£
, 
ndp_š¡ªû_id
);

3390 ià(
ndp_£tup_»¥Ú£
 !ğ
NAN_DP_REQUEST_ACCEPT
) {

3391 
Ãt_deviû
 *
d©a_dev
;

3392 
Ãtdev_vif
 *
ndev_d©a_vif
;

3394 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr_locked
(
sdev
, 
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1],

3395 
SLSI_NAN_DATA_IFINDEX_START
);

3396 ià(
d©a_dev
) {

3397 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

3398 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3399 
ndev_d©a_vif
->
Çn
.
ndp_couÁ
--;

3400 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3402 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
çl£
);

3405 ià(
sig_d©a_Ën
 > 4)

3406 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

3408 ià(
±r
) {

3409 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3410 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3411 
g_d©a_±r
 = 
±r
 + 4;

3412 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

3413 ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_APP_INFO
) {

3414 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO_LEN
, 
g_Ën
);

3415 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO
, 
g_Ën
, 
g_d©a_±r
);

3416 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
g_Ën
, (
u8
 *)
g_d©a_±r
);

3417 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "­p_šfo_Ën:%d,‡µ_šfo:%s\n", 
g_Ën
, 
šfo_¡ršg
);

3419 } ià(
g_id
 =ğ
SLSI_NAN_TLV_WFA_SERVICE_INFO
) {

3420 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO_LEN
, 
g_Ën
 + 3);

3421 
±r
[1] =…tr[0];

3422 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO
, 
g_Ën
 + 3, &
±r
[1]);

3423 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
g_Ën
 + 3, &
±r
[1]);

3424 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "£rviû_­p_šfo_Ën:%d,‡µ_šfo:%s\n", 
g_Ën
 + 3,

3425 
šfo_¡ršg
);

3428 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

3429 
±r
 +ğ
g_Ën
 + 4;

3430 ià(
sig_d©a_Ën
 > 4) {

3431 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3432 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3433 
g_d©a_±r
 = 
±r
 + 4;

3435 
g_id
 = 0;

3436 
g_Ën
 = 0;

3441 ià(
»s
) {

3442 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3444 
	`kä“_skb
(
Æ_skb
);

3445 
ex™
;

3448 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3449 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3450 
	`¦si_´št_ev’t_Çme
(
SLSI_NAN_EVENT_NDP_CFM
), SLSI_NAN_EVENT_NDP_CFM);

3452 ià(
ndp_£tup_»¥Ú£
 =ğ
NAN_DP_REQUEST_ACCEPT
) {

3453 
Ãtdev_vif
 *
ndev_d©a_vif
;

3454 
Ãt_deviû
 *
d©a_dev
;

3455 
¦si_³”
 *
³”
 = 
NULL
;

3457 
ndev_vif
->
Çn
.
ndp_aùive_id_m­
 |ğ
	`BIT
(
ndp_š¡ªû_id
);

3458 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr_locked
(
sdev
, 
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1],

3459 
SLSI_NAN_DATA_IFINDEX_START
);

3461 ià(!
d©a_dev
) {

3462 
	`SLSI_ERR
(
sdev
, "nØd©a_dev fÜ‚dp_š¡ªû_id:%d‚di[" 
MACSTR
 "]\n", 
ndp_š¡ªû_id
, 
	`MAC2STR
(
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]));

3463 
	`kä“_skb
(
Æ_skb
);

3464 
ex™
;

3466 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

3467 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3474 
ndev_d©a_vif
->
aùiv©ed
 = 
Œue
;

3475 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
d©a_dev
, 
³”_ndi
);

3476 ià(
³”
) {

3477 
³”
->
ndp_couÁ
++;

3479 
ndl_vif_id
 = 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1];

3483 
ndl_id
 = 
ndl_vif_id
 - 
SLSI_NET_INDEX_NAN
;

3484 
³”
 = 
	`¦si_³”_add
(
sdev
, 
d©a_dev
, 
³”_ndi
, 
ndl_id
);

3485 ià(
³”
) {

3486 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

3487 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
d©a_dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3488 
³”
->
ndl_vif
 = 
ndl_vif_id
;

3489 
³”
->
qos_’abËd
 = 
Œue
;

3491 
	`SLSI_ERR
(
sdev
, "nØ³” fÜ‚dp_š¡ªû_id:%d‚di[%d]\n", 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

3494 ià(
³”
)

3495 
³”
->
æow_id
 = flow_id;

3496 ià(
ndev_d©a_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

3497 
dev
->
æags
 |ğ
IFF_NOARP
;

3498 
	`Ãtif_ÿ¼›r_Ú
(
d©a_dev
);

3499 
ndp_£tup_time
 = 
jiff›s
;

3500 ià(
ndp_£tup_time
 > 
ndev_vif
->
Çn
.
ndp_¡¬t_time
)

3501 
d–ay_š_ms
 = 
	`jiff›s_to_m£cs
(
ndp_£tup_time
 - 
ndev_vif
->
Çn
.
ndp_¡¬t_time
);

3503 
d–ay_š_ms
 = 
	`jiff›s_to_m£cs
(
MAX_JIFFY_OFFSET
 - 
ndev_vif
->
Çn
.
ndp_¡¬t_time
 + 
ndp_£tup_time
);

3504 ià(
d–ay_š_ms
 < 
	`¦si_g‘_Çn_ndp_d–ay
())

3505 
	`m¦“p
(
	`¦si_g‘_Çn_ndp_max_time
(è- 
d–ay_š_ms
);

3507 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3509 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3510 
ex™
:

3511 
	`¦si_Çn_dump_ndp_d©a
(
sdev
, 
dev
);

3512 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3513 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3514 
	`kä“_skb
(
skb
);

3515 
	}
}

3517 
	$¦si_Çn_ndp_»que¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3519 
u16
 
g_id
, 
g_Ën
 = 0, 
ndl_vif_id
, 
loÿl_ndp_š¡ªû_id
;

3520 
u8
 *
±r
 = 
NULL
, *
³”_nmi
;

3521 cÚ¡ 
u8
 *
g_d©a_±r
;

3522 
sig_d©a_Ën
, 
»s
;

3523 
sk_buff
 *
Æ_skb
;

3524 
u32
 
ndp_š¡ªû_id
;

3525 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3526 *
šfo_¡ršg
 = 
NULL
;

3528 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

3529 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3530 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3531 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3533 
ndev_vif
->
Çn
.
ndp_¡¬t_time
 = 
jiff›s
;

3535 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3536 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_REQ
,

3537 
GFP_KERNEL
);

3539 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_REQ
, 
GFP_KERNEL
);

3541 ià(!
Æ_skb
) {

3542 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3543 
ex™
;

3546 
loÿl_ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
»que¡_id
);

3547 
ndp_š¡ªû_id
 = 
	`¦si_Çn_g‘_Ãw_ndp_š¡ªû_id
(
ndev_vif
);

3548 
ndev_vif
->
Çn
.
Ãxt_ndp_š¡ªû_id
 = (
ndp_š¡ªû_id
 + 1è% (
SLSI_NAN_MAX_NDP_INSTANCES
 + 1);

3549 
³”_nmi
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
³”_Çn_mªagem’t_š‹rçû_add»ss
);

3550 
»s
 = 
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_SERVICE_INSTANCE_ID
,

3551 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£ssiÚ_id
));

3552 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, 
³”_nmi
);

3553 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, 
ndp_š¡ªû_id
);

3554 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_PARAM_SECURITY_CONFIG
,

3555 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£cur™y_»quœed
));

3557 
	`SLSI_INFO
(
sdev
, "session_id:%d,…eer_nmi:%pM,‚dp_instance_id:%d, security_req:%d\n",

3558 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£ssiÚ_id
), 
³”_nmi
, 
ndp_š¡ªû_id
,

3559 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£cur™y_»quœed
));

3561 ià(
sig_d©a_Ën
 > 4)

3562 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

3564 ià(
±r
) {

3565 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3566 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3567 
g_d©a_±r
 = 
±r
 + 4;

3569 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

3570 ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_APP_INFO
) {

3571 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO_LEN
, 
g_Ën
);

3572 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO
, 
g_Ën
, 
g_d©a_±r
);

3573 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
g_Ën
, (
u8
 *)
g_d©a_±r
);

3574 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "­p_šfo_Ën:%d,‡µ_šfo:%s\n", 
g_Ën
, 
šfo_¡ršg
);

3577 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

3578 
±r
 +ğ
g_Ën
 + 4;

3579 ià(
sig_d©a_Ën
 > 4) {

3580 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3581 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3582 
g_d©a_±r
 = 
±r
 + 4;

3584 
g_id
 = 0;

3585 
g_Ën
 = 0;

3590 ià(
»s
) {

3591 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3593 
	`kä“_skb
(
Æ_skb
);

3594 
ex™
;

3597 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3598 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3599 
	`¦si_´št_ev’t_Çme
(
SLSI_NAN_EVENT_NDP_REQ
), SLSI_NAN_EVENT_NDP_REQ);

3601 
ndl_vif_id
 = 
	`¦si_Çn_ndp_g‘_ndl_vif_id
(
³”_nmi
, 
ndev_vif
->
Çn
.
ndl_li¡
);

3602 ià(
	`¦si_Çn_ndp_Ãw_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndl_vif_id
, 
NULL
, 
³”_nmi
) == 0) {

3603 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3604 
ndev_vif
->
Çn
.
ndp_loÿl_ndp_š¡ªû_id
[
ndp_š¡ªû_id
 - 1] = 
loÿl_ndp_š¡ªû_id
;

3606 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 
»¥Ú£_»q
;

3608 
	`kä“_skb
(
Æ_skb
);

3609 
	`SLSI_ERR
(
sdev
, "šv®id‚dl_vifid:%d‚dp_š¡ªû_id:%d\n", 
ndl_vif_id
, 
ndp_š¡ªû_id
);

3610 
	`mem£t
(&
»¥Ú£_»q
, 0, (response_req));

3611 
»¥Ú£_»q
.
r¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3612 
	`¦si_mlme_ndp_»¥Ú£
(
sdev
, 
dev
, &
»¥Ú£_»q
, 
loÿl_ndp_š¡ªû_id
);

3615 
ex™
:

3616 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3617 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3618 
	`kä“_skb
(
skb
);

3619 
	}
}

3621 
	$¦si_Çn_d–_³”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
loÿl_ndi
, 
u16
 
ndp_š¡ªû_id
)

3623 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3624 
Ãt_deviû
 *
d©a_dev
;

3625 
Ãtdev_vif
 *
ndev_d©a_vif
;

3626 
¦si_³”
 *
³”
 = 
NULL
;

3627 
u16
 
ndl_vif_id
 = 0, 
ndl_id
 = 0;

3629 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3631 ià(!
loÿl_ndi
) {

3632 
	`SLSI_ERR
(
sdev
, "Invalid†ocal NDI in del…eer\n");

3636 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr_locked
(
sdev
, 
loÿl_ndi
, 
SLSI_NAN_DATA_IFINDEX_START
);

3637 ià(!
d©a_dev
) {

3638 
	`SLSI_ERR
(
sdev
, "Invalid Data Dev\n");

3642 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
)

3645 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

3646 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3647 
ndl_vif_id
 = 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1];

3648 
ndl_id
 = 
ndl_vif_id
 - 
SLSI_NAN_DATA_IFINDEX_START
;

3649 
³”
 = 
ndev_d©a_vif
->
³”_¡a_»cÜd
[
ndl_id
];

3650 ià(
³”
->
v®id
) {

3651 
³”
->
ndp_couÁ
--;

3652 ià(
³”
->
ndp_couÁ
 == 0) {

3653 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
d©a_dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

3654 
	`¦si_¥šlock_lock
(&
ndev_d©a_vif
->
³”_lock
);

3655 
	`¦si_³”_»move
(
sdev
, 
d©a_dev
, 
³”
);

3656 
	`¦si_¥šlock_uÆock
(&
ndev_d©a_vif
->
³”_lock
);

3659 
	`SLSI_ERR
(
sdev
, "nØ³” fÜ‚dp_š¡ªû_id:%d‚di[" 
MACSTR
 "]\n", 
ndp_š¡ªû_id
,

3660 
	`MAC2STR
(
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1]));

3662 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3663 
	}
}

3665 
	$¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, 
u8
 *
ndi
)

3667 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3668 
sk_buff
 *
Æ_skb
;

3669 
Ãtdev_vif
 *
ndev_d©a_vif
 = 
NULL
;

3670 
Ãt_deviû
 *
d©a_dev
 = 
NULL
;

3672 ià(
ndp_š¡ªû_id
)

3673 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr_locked
(
sdev
, 
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1],

3674 
SLSI_NAN_DATA_IFINDEX_START
);

3675 ià(
d©a_dev
) {

3676 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

3677 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3678 ià(
ndev_d©a_vif
->
Çn
.
ndp_couÁ
 > 0)

3679 
ndev_d©a_vif
->
Çn
.
ndp_couÁ
--;

3680 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3682 
ndev_vif
->
Çn
.
ndp_aùive_id_m­
 &ğ~
	`BIT
(
ndp_š¡ªû_id
);

3683 
	`¦si_Çn_d–_³”
(
sdev
, 
dev
, 
ndi
, 
ndp_š¡ªû_id
);

3684 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
çl£
);

3686 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3687 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_END
,

3688 
GFP_KERNEL
);

3690 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_END
, 
GFP_KERNEL
);

3692 ià(!
Æ_skb
) {

3693 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3697 ià(
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, 
ndp_š¡ªû_id
)) {

3698 
	`SLSI_ERR
(
sdev
, "Error in‚la_put_u32\n");

3700 
	`kä“_skb
(
Æ_skb
);

3703 
	`SLSI_INFO
(
sdev
, "ndp_š¡ªû_id:%d\n", 
ndp_š¡ªû_id
);

3704 
	`¦si_Çn_dump_ndp_d©a
(
sdev
, 
dev
);

3705 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3706 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3707 
	`¦si_´št_ev’t_Çme
(
SLSI_NAN_EVENT_NDP_END
), SLSI_NAN_EVENT_NDP_END);

3709 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3710 
	}
}

3712 
	$¦si_Çn_ndp_‹rmš©iÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3714 
u16
 
ndp_š¡ªû_id
;

3715 
u16
 
»asÚ
;

3716 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3718 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3719 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3721 
ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_‹rmš©ed_šd
.ndp_instance_id);

3722 
»asÚ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_‹rmš©ed_šd
.
»asÚ_code
);

3724 
	`SLSI_INFO
(
sdev
, "ndp_id:%d,„—sÚ:%d\n", 
ndp_š¡ªû_id
, 
»asÚ
);

3726 ià(
ndp_š¡ªû_id
 <ğ
SLSI_NAN_MAX_NDP_INSTANCES
)

3727 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

3729 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3730 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3731 
	`kä“_skb
(
skb
);

3732 
	}
}

3734 
	$¦si_£nd_Çn_¿nge_cÚfig
(
¦si_dev
 *
sdev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
, 
¹t_id
)

3736 
Ãt_deviû
 *
Çn_dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

3737 
Ãtdev_vif
 *
Çn_ndev_vif
;

3738 
r
 = 0;

3739 
boŞ
 
is_locked
 = 
çl£
;

3741 ià(!
	`¦si_dev_Çn_suµÜ‹d
(
sdev
)) {

3742 
	`SLSI_ERR
(
sdev
, "NAN‚Ù suµÜ‹d(mib:%d)\n", sdev->
Çn_’abËd
);

3743 
r
 = 
WIFI_HAL_ERROR_NOT_SUPPORTED
;

3744 
ex™
;

3746 ià(!
Çn_dev
) {

3747 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3748 
r
 = -
EINVAL
;

3749 
ex™
;

3751 
Çn_ndev_vif
 = 
	`Ãtdev_´iv
(
Çn_dev
);

3752 
	`SLSI_MUTEX_LOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3753 
is_locked
 = 
Œue
;

3754 #iâdeà
SLSI_TEST_DEV


3755 ià(!
Çn_ndev_vif
->
aùiv©ed
) {

3756 
	`SLSI_ERR
(
sdev
, "NAN vif‚ot‡ctivated\n");

3757 
r
 = -
EINVAL
;

3758 
ex™
;

3761 ià(
r
 == 0)

3762 
r
 = 
	`¦si_mlme_Çn_¿nge_»q
(
sdev
, 
Çn_dev
, 
couÁ
, 
Æ_¹t_·¿ms
);

3763 
ex™
:

3764 ià(
r
) {

3765 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]);

3766 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3767 
	`SLSI_ERR_NODEV
("Failedo set‚an„ange config\n");

3769 ià(
is_locked
)

3770 
	`SLSI_MUTEX_UNLOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3771  
r
;

3772 
	}
}

3774 
	$¦si_£nd_Çn_¿nge_ÿnûl
(
¦si_dev
 *
sdev
)

3776 
Ãt_deviû
 *
Çn_dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

3777 
Ãtdev_vif
 *
Çn_ndev_vif
;

3778 
r
 = -
EINVAL
;

3780 ià(!
	`¦si_dev_Çn_suµÜ‹d
(
sdev
)) {

3781 
	`SLSI_ERR
(
sdev
, "NAN‚Ù suµÜ‹d(mib:%d)\n", sdev->
Çn_’abËd
);

3782  
WIFI_HAL_ERROR_NOT_SUPPORTED
;

3784 ià(!
Çn_dev
) {

3785 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3786  
r
;

3788 
Çn_ndev_vif
 = 
	`Ãtdev_´iv
(
Çn_dev
);

3789 
	`SLSI_MUTEX_LOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3790 #iâdeà
SLSI_TEST_DEV


3791 ià(!
Çn_ndev_vif
->
aùiv©ed
) {

3792 
	`SLSI_ERR
(
sdev
, "NAN vif‚ot‡ctivated\n");

3793 
	`SLSI_MUTEX_UNLOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3794  
r
;

3797 
r
 = 
	`¦si_mlme_Çn_¿nge_ÿnûl_»q
(
sdev
, 
Çn_dev
);

3798 
	`SLSI_MUTEX_UNLOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3799  
r
;

3800 
	}
}

3802 
	$¦si_Çn_Œigg”_¹t_com¶‘e_ev’t
(
¦si_dev
 *
sdev
, 
u16
 
»que¡_id
, 
u8
 
¹t_id
)

3804 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3805 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3806 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_COMPLETE_EVENT
), SLSI_NL80211_RTT_COMPLETE_EVENT);

3808 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_RTT_COMPLETE_EVENT
, &
»que¡_id
, (request_id));

3810 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]);

3811 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3812 
	}
}

3814 
	$¦si_rx_Çn_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3816 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3817 
u32
 
tm
;

3818 
d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3819 
u32
 
tmac
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
mlme_Çn_¿nge_šd
.
time¡amp
);

3820 
u8
 *
_±r
;

3821 
sk_buff
 *
Æ_skb
;

3822 
»s
 = 0;

3823 
Æ©Œ
 *
Æ©Œ_Ã¡ed
;

3824 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3825 
time¥ec64
 
ts
;

3827 
time¥ec
 
ts
;

3829 
u64
 
tk”Ãl
;

3830 
u16
 
v®ue
;

3831 
u32
 
‹mp_v®ue
;

3832 
Ëngth
 = 0;

3833 
u8
 
¹t_id
 = 0;

3834 
u16
 
»que¡_id
 = 0;

3836 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3837 
¹t_id
 = 
SLSI_MIN_RTT_ID
;„‰_id <ğ
SLSI_MAX_RTT_ID
;„tt_id++)

3838 ià(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] && sdev->¹t_id_·¿ms[¹t_id - 1]->
³”_ty³
 =ğ
SLSI_RTT_PEER_NAN
)

3840 ià(
¹t_id
 > 
SLSI_MAX_RTT_ID
) {

3841 
	`kä“_skb
(
skb
);

3842 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3845 
»que¡_id
 = 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]->
h®_»que¡_id
;

3846 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

3847 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

3848 
SLSI_NL80211_RTT_RESULT_EVENT
, 
GFP_KERNEL
);

3850 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_RTT_RESULT_EVENT
,

3851 
GFP_KERNEL
);

3853 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3854 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3855 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_RESULT_EVENT
), SLSI_NL80211_RTT_RESULT_EVENT);

3858 ià(!
Æ_skb
) {

3859 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3860 
ex™
;

3863 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_TARGET_ID
, 
»que¡_id
);

3864 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULTS_PER_TARGET
, 1);

3865 
_±r
 = 
	`çpi_g‘_d©a
(
skb
);

3866 
Ëngth
 + 
SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
 + 4 <ğ
d©a_Ën
) {

3867 
Æ©Œ_Ã¡ed
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULT
);

3868 ià(!
Æ©Œ_Ã¡ed
) {

3869 
	`SLSI_ERR
(
sdev
, "Error in‚la_nest_start\n");

3871 
	`kä“_skb
(
Æ_skb
);

3872 
ex™
;

3875 
v®ue
 = 
	`SLSI_BUFF_LE_TO_U16
(
_±r
);

3876 
_±r
 += 2;

3878 ià(
v®ue
 !ğ
SLSI_NAN_TLV_NAN_RTT_RESULT
) {

3879 
	`SLSI_ERR
(
sdev
, "Inv®id TLVag:%x\n", 
v®ue
);

3881 
	`kä“_skb
(
Æ_skb
);

3882 
ex™
;

3885 
v®ue
 = 
	`SLSI_BUFF_LE_TO_U16
(
_±r
);

3886 
_±r
 += 2;

3888 ià(
v®ue
 !ğ
SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
) {

3889 
	`SLSI_ERR
(
sdev
, "Inv®id TLV†’:%d\n", 
v®ue
);

3891 
	`kä“_skb
(
Æ_skb
);

3892 
ex™
;

3895 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_ADDR
, 
ETH_ALEN
, 
_±r
);

3896 
_±r
 += 6;

3898 
v®ue
 = 
	`SLSI_BUFF_LE_TO_U16
(
_±r
);

3899 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_STATUS
, 
v®ue
);

3900 
_±r
 += 2;

3902 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NUM_PER_BURST_PEER
, *
_±r
);

3903 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_MEASUREMENT_NUM
, *
_±r
++);

3904 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_SUCCESS_NUM
, *
_±r
++);

3905 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_NUM
, 0);

3907 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RETRY_AFTER_DURATION
, 0);

3908 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TYPE
, 2);

3910 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI
, *
_±r
++);

3912 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI_SPREAD
, *
_±r
++);

3914 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)
_±r
);

3915 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT
, 
‹mp_v®ue
);

3916 
_±r
 += 4;

3918 
v®ue
 = 
	`SLSI_BUFF_LE_TO_U16
(
_±r
);

3919 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SD
, 
v®ue
);

3920 
_±r
 += 2;

3922 
v®ue
 = 
	`SLSI_BUFF_LE_TO_U16
(
_±r
);

3923 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SPREAD
, 
v®ue
);

3924 
_±r
 += 2;

3926 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3927 
ts
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

3928 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

3929 
ts
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

3931 
	`g‘_mÚÙÚic_boÙtime
(&
ts
);

3933 
tk”Ãl
 = (
u64
)
	`TIMESPEC_TO_US
(
ts
);

3934 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)
_±r
);

3935 
tm
 = 
‹mp_v®ue
;

3936 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TIMESTAMP_US
, 
tk”Ãl
 - (
tmac
 - 
tm
));

3937 
_±r
 += 4;

3939 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)
_±r
);

3940 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_MM
, 
‹mp_v®ue
);

3941 
_±r
 += 4;

3943 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)
_±r
);

3944 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_SD_MM
, 
‹mp_v®ue
);

3945 
_±r
 += 4;

3947 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_DURATION_MSN
, *
_±r
++);

3948 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NEGOTIATED_BURST_NUM
, 0);

3949 
	`Æa_Ã¡_’d
(
Æ_skb
, 
Æ©Œ_Ã¡ed
);

3950 
Ëngth
 +ğ
SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
 + 4;

3952 ià(
Ëngth
 !ğ
d©a_Ën
 || data_len == 0) {

3953 
	`SLSI_ERR
(
sdev
, "IncÜ»ù†’gth bulk d©¨Ëngth:%d\n", 
d©a_Ën
);

3954 
	`kä“_skb
(
Æ_skb
);

3955 
ex™
;

3957 
	`SLSI_DBG_HEX
(
sdev
, 
SLSI_GSCAN
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb), "nan_range indication skb buffer:\n");

3958 ià(
»s
) {

3959 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3960 
	`kä“_skb
(
Æ_skb
);

3961 
ex™
;

3963 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3964 
ex™
:

3965 
	`¦si_Çn_Œigg”_¹t_com¶‘e_ev’t
(
sdev
, 
»que¡_id
, 
¹t_id
);

3966 
	`kä“_skb
(
skb
);

3967 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3968 
	}
}

	@nl80211_vendor_nan.h

6 #iâdeà
__SLSI_NL80211_VENDOR_NAN_H_


7 
	#__SLSI_NL80211_VENDOR_NAN_H_


	)

9 
	#SLSI_NAN_VIF_TYPE_NDP
 0x00FF

	)

11 
	#SLSI_NAN_TLV_TAG_CONFIGURATION
 0x0101

	)

12 
	#SLSI_NAN_TLV_TAG_2G4_BAND_SPECIFIC_CONFIG
 0x0102

	)

13 
	#SLSI_NAN_TLV_TAG_5G_BAND_SPECIFIC_CONFIG
 0x0103

	)

14 
	#SLSI_NAN_TLV_TAG_SUBSCRIBE_SPECIFIC
 0x0104

	)

15 
	#SLSI_NAN_TLV_TAG_DISCOVERY_COMMON_SPECIFIC
 0x0105

	)

16 
	#SLSI_NAN_TLV_TAG_SERVICE_NAME
 0x0106

	)

17 
	#SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
 0x0107

	)

18 
	#SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
 0x0108

	)

19 
	#SLSI_NAN_TLV_TAG_RX_MATCH_FILTER
 0x0109

	)

20 
	#SLSI_NAN_TLV_TAG_TX_MATCH_FILTER
 0x010a

	)

21 
	#SLSI_NAN_TLV_TAG_MATCH_FILTER
 0x010b

	)

22 
	#SLSI_NAN_TLV_TAG_INTERFACE_ADDRESS_SET
 0x010c

	)

23 
	#SLSI_NAN_TLV_TAG_MATCH_IND
 0x010d

	)

24 
	#SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY
 0x010e

	)

25 
	#SLSI_NAN_TLV_TAG_APP_INFO
 0x010f

	)

26 
	#SLSI_NAN_TLV_TAG_RANGING
 0x0110

	)

27 
	#SLSI_NAN_TLV_TAG_CONFIG_SUPPLEMENTAL
 0x0111

	)

28 
	#SLSI_NAN_TLV_WFA_IPV6_LOCAL_LINK
 0x0000

	)

29 
	#SLSI_NAN_TLV_WFA_SERVICE_INFO
 0x0001

	)

30 
	#SLSI_NAN_TLV_NAN_RTT_CONFIG
 0x0112

	)

31 
	#SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
 0x0009

	)

32 
	#SLSI_NAN_TLV_NAN_RTT_RESULT
 0x0113

	)

33 
	#SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
 0x0021

	)

35 
	#SLSI_NAN_MAX_SERVICE_ID
 16

	)

36 
	#SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
 20

	)

37 
	#SLSI_NAN_MAX_NDP_INSTANCES
 8

	)

38 
	#SLSI_NAN_DATA_IFINDEX_START
 5

	)

39 
	#SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
 0xC0000000

	)

40 
	#SLSI_NAN_CLUSTER_MERGE_DISABLE_MASK
 0x80000000

	)

41 
	#SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
 0x3fffffff

	)

43 
	eSLSI_NAN_REPLY_ATTRIBUTES
 {

44 
	mNAN_REPLY_ATTR_STATUS_TYPE
,

45 
	mNAN_REPLY_ATTR_VALUE
,

46 
	mNAN_REPLY_ATTR_RESPONSE_TYPE
,

47 
	mNAN_REPLY_ATTR_PUBLISH_SUBSCRIBE_TYPE
,

48 
	mNAN_REPLY_ATTR_CAP_MAX_CONCURRENT_CLUSTER
,

49 
	mNAN_REPLY_ATTR_CAP_MAX_PUBLISHES
,

50 
	mNAN_REPLY_ATTR_CAP_MAX_SUBSCRIBES
,

51 
	mNAN_REPLY_ATTR_CAP_MAX_SERVICE_NAME_LEN
,

52 
	mNAN_REPLY_ATTR_CAP_MAX_MATCH_FILTER_LEN
,

53 
	mNAN_REPLY_ATTR_CAP_MAX_TOTAL_MATCH_FILTER_LEN
,

54 
	mNAN_REPLY_ATTR_CAP_MAX_SERVICE_SPECIFIC_INFO_LEN
,

55 
	mNAN_REPLY_ATTR_CAP_MAX_VSA_DATA_LEN
,

56 
	mNAN_REPLY_ATTR_CAP_MAX_MESH_DATA_LEN
,

57 
	mNAN_REPLY_ATTR_CAP_MAX_NDI_INTERFACES
,

58 
	mNAN_REPLY_ATTR_CAP_MAX_NDP_SESSIONS
,

59 
	mNAN_REPLY_ATTR_CAP_MAX_APP_INFO_LEN
,

60 
	mNAN_REPLY_ATTR_NDP_INSTANCE_ID
,

61 
	mNAN_REPLY_ATTR_CAP_MAX_QUEUED_TRANSMIT_FOLLOWUP_MGS
,

62 
	mNAN_REPLY_ATTR_CAP_MAX_NDP_SUPPORTED_BANDS
,

63 
	mNAN_REPLY_ATTR_CAP_MAX_CIPHER_SUITES_SUPPORTED
,

64 
	mNAN_REPLY_ATTR_CAP_MAX_SCID_LEN
,

65 
	mNAN_REPLY_ATTR_CAP_NDP_SECURITY_SUPPORTED
,

66 
	mNAN_REPLY_ATTR_CAP_MAX_SDEA_SERVICE_SPECIFIC_INFO_LEN
,

67 
	mNAN_REPLY_ATTR_CAP_MAX_SUBSCRIBE_ADDRESS
,

68 
	mNAN_REPLY_ATTR_CAP_NDPE_ATTR_SUPPORTED
,

69 
	mNAN_REPLY_ATTR_HAL_TRANSACTION_ID


72 
	eSLSI_NAN_REQ_ATTRIBUTES
 {

73 
	mNAN_REQ_ATTR_MASTER_PREF
 = 1,

74 
	mNAN_REQ_ATTR_CLUSTER_LOW
,

75 
	mNAN_REQ_ATTR_CLUSTER_HIGH
,

76 
	mNAN_REQ_ATTR_HOP_COUNT_LIMIT_VAL
,

77 
	mNAN_REQ_ATTR_SID_BEACON_VAL
,

78 
	mNAN_REQ_ATTR_SUPPORT_2G4_VAL
,

79 
	mNAN_REQ_ATTR_SUPPORT_5G_VAL
,

80 
	mNAN_REQ_ATTR_RSSI_CLOSE_2G4_VAL
,

81 
	mNAN_REQ_ATTR_RSSI_MIDDLE_2G4_VAL
,

82 
	mNAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
,

83 
	mNAN_REQ_ATTR_BEACONS_2G4_VAL
 = 11,

84 
	mNAN_REQ_ATTR_SDF_2G4_VAL
,

85 
	mNAN_REQ_ATTR_CHANNEL_2G4_MHZ_VAL
,

86 
	mNAN_REQ_ATTR_RSSI_PROXIMITY_VAL
,

87 
	mNAN_REQ_ATTR_RSSI_CLOSE_5G_VAL
,

88 
	mNAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
,

89 
	mNAN_REQ_ATTR_RSSI_MIDDLE_5G_VAL
,

90 
	mNAN_REQ_ATTR_RSSI_PROXIMITY_5G_VAL
,

91 
	mNAN_REQ_ATTR_BEACON_5G_VAL
,

92 
	mNAN_REQ_ATTR_SDF_5G_VAL
,

93 
	mNAN_REQ_ATTR_CHANNEL_5G_MHZ_VAL
 = 21,

94 
	mNAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
,

95 
	mNAN_REQ_ATTR_OUI_VAL
,

96 
	mNAN_REQ_ATTR_MAC_ADDR_VAL
,

97 
	mNAN_REQ_ATTR_CLUSTER_VAL
,

98 
	mNAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
,

99 
	mNAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
,

100 
	mNAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
,

101 
	mNAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
,

102 
	mNAN_REQ_ATTR_CONN_CAPABILITY_PAYLOAD_TX
,

103 
	mNAN_REQ_ATTR_CONN_CAPABILITY_IBSS
 = 31,

104 
	mNAN_REQ_ATTR_CONN_CAPABILITY_WFD
,

105 
	mNAN_REQ_ATTR_CONN_CAPABILITY_WFDS
,

106 
	mNAN_REQ_ATTR_CONN_CAPABILITY_TDLS
,

107 
	mNAN_REQ_ATTR_CONN_CAPABILITY_MESH
,

108 
	mNAN_REQ_ATTR_CONN_CAPABILITY_WLAN_INFRA
,

109 
	mNAN_REQ_ATTR_DISCOVERY_ATTR_NUM_ENTRIES
,

110 
	mNAN_REQ_ATTR_DISCOVERY_ATTR_VAL
,

111 
	mNAN_REQ_ATTR_CONN_TYPE
,

112 
	mNAN_REQ_ATTR_NAN_ROLE
,

113 
	mNAN_REQ_ATTR_TRANSMIT_FREQ
 = 41,

114 
	mNAN_REQ_ATTR_AVAILABILITY_DURATION
,

115 
	mNAN_REQ_ATTR_AVAILABILITY_INTERVAL
,

116 
	mNAN_REQ_ATTR_MESH_ID_LEN
,

117 
	mNAN_REQ_ATTR_MESH_ID
,

118 
	mNAN_REQ_ATTR_INFRASTRUCTURE_SSID_LEN
,

119 
	mNAN_REQ_ATTR_INFRASTRUCTURE_SSID
,

120 
	mNAN_REQ_ATTR_FURTHER_AVAIL_NUM_ENTRIES
,

121 
	mNAN_REQ_ATTR_FURTHER_AVAIL_VAL
,

122 
	mNAN_REQ_ATTR_FURTHER_AVAIL_ENTRY_CTRL
,

123 
	mNAN_REQ_ATTR_FURTHER_AVAIL_CHAN_CLASS
 = 51,

124 
	mNAN_REQ_ATTR_FURTHER_AVAIL_CHAN
,

125 
	mNAN_REQ_ATTR_FURTHER_AVAIL_CHAN_MAPID
,

126 
	mNAN_REQ_ATTR_FURTHER_AVAIL_INTERVAL_BITMAP
,

127 
	mNAN_REQ_ATTR_PUBLISH_ID
,

128 
	mNAN_REQ_ATTR_PUBLISH_TTL
,

129 
	mNAN_REQ_ATTR_PUBLISH_PERIOD
,

130 
	mNAN_REQ_ATTR_PUBLISH_TYPE
,

131 
	mNAN_REQ_ATTR_PUBLISH_TX_TYPE
,

132 
	mNAN_REQ_ATTR_PUBLISH_COUNT
,

133 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_NAME_LEN
 = 61,

134 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_NAME
,

135 
	mNAN_REQ_ATTR_PUBLISH_MATCH_ALGO
,

136 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_INFO_LEN
,

137 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_INFO
,

138 
	mNAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER_LEN
,

139 
	mNAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER
,

140 
	mNAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER_LEN
,

141 
	mNAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER
,

142 
	mNAN_REQ_ATTR_PUBLISH_RSSI_THRESHOLD_FLAG
,

143 
	mNAN_REQ_ATTR_PUBLISH_CONN_MAP
 = 71,

144 
	mNAN_REQ_ATTR_PUBLISH_RECV_IND_CFG
,

145 
	mNAN_REQ_ATTR_SUBSCRIBE_ID
,

146 
	mNAN_REQ_ATTR_SUBSCRIBE_TTL
,

147 
	mNAN_REQ_ATTR_SUBSCRIBE_PERIOD
,

148 
	mNAN_REQ_ATTR_SUBSCRIBE_TYPE
,

149 
	mNAN_REQ_ATTR_SUBSCRIBE_RESP_FILTER_TYPE
,

150 
	mNAN_REQ_ATTR_SUBSCRIBE_RESP_INCLUDE
,

151 
	mNAN_REQ_ATTR_SUBSCRIBE_USE_RESP_FILTER
,

152 
	mNAN_REQ_ATTR_SUBSCRIBE_SSI_REQUIRED
,

153 
	mNAN_REQ_ATTR_SUBSCRIBE_MATCH_INDICATOR
 = 81,

154 
	mNAN_REQ_ATTR_SUBSCRIBE_COUNT
,

155 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME_LEN
,

156 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME
,

157 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO_LEN
,

158 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO
,

159 
	mNAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER_LEN
,

160 
	mNAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER
,

161 
	mNAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER_LEN
,

162 
	mNAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER
,

163 
	mNAN_REQ_ATTR_SUBSCRIBE_RSSI_THRESHOLD_FLAG
 = 91,

164 
	mNAN_REQ_ATTR_SUBSCRIBE_CONN_MAP
,

165 
	mNAN_REQ_ATTR_SUBSCRIBE_NUM_INTF_ADDR_PRESENT
,

166 
	mNAN_REQ_ATTR_SUBSCRIBE_INTF_ADDR
,

167 
	mNAN_REQ_ATTR_SUBSCRIBE_RECV_IND_CFG
,

168 
	mNAN_REQ_ATTR_FOLLOWUP_ID
,

169 
	mNAN_REQ_ATTR_FOLLOWUP_REQUESTOR_ID
,

170 
	mNAN_REQ_ATTR_FOLLOWUP_ADDR
,

171 
	mNAN_REQ_ATTR_FOLLOWUP_PRIORITY
,

172 
	mNAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME_LEN
,

173 
	mNAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME
 = 101,

174 
	mNAN_REQ_ATTR_FOLLOWUP_TX_WINDOW
,

175 
	mNAN_REQ_ATTR_FOLLOWUP_RECV_IND_CFG
,

176 
	mNAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
,

177 
	mNAN_REQ_ATTR_DW_2G4_INTERVAL
,

178 
	mNAN_REQ_ATTR_DW_5G_INTERVAL
,

179 
	mNAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
,

180 
	mNAN_REQ_ATTR_PUBLISH_SDEA_LEN
,

181 
	mNAN_REQ_ATTR_PUBLISH_SDEA
,

182 
	mNAN_REQ_ATTR_RANGING_AUTO_RESPONSE
,

183 
	mNAN_REQ_ATTR_SDEA_PARAM_NDP_TYPE
 = 111,

184 
	mNAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
,

185 
	mNAN_REQ_ATTR_SDEA_PARAM_RANGING_STATE
,

186 
	mNAN_REQ_ATTR_SDEA_PARAM_RANGE_REPORT
,

187 
	mNAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
,

188 
	mNAN_REQ_ATTR_RANGING_CFG_INTERVAL
,

189 
	mNAN_REQ_ATTR_RANGING_CFG_INDICATION
,

190 
	mNAN_REQ_ATTR_RANGING_CFG_INGRESS_MM
,

191 
	mNAN_REQ_ATTR_RANGING_CFG_EGRESS_MM
,

192 
	mNAN_REQ_ATTR_CIPHER_TYPE
,

193 
	mNAN_REQ_ATTR_SCID_LEN
 = 121,

194 
	mNAN_REQ_ATTR_SCID
,

195 
	mNAN_REQ_ATTR_SECURITY_KEY_TYPE
,

196 
	mNAN_REQ_ATTR_SECURITY_PMK_LEN
,

197 
	mNAN_REQ_ATTR_SECURITY_PMK
,

198 
	mNAN_REQ_ATTR_SECURITY_PASSPHRASE_LEN
,

199 
	mNAN_REQ_ATTR_SECURITY_PASSPHRASE
,

200 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_PUBLISH_ID
,

201 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_REQUESTOR_ID
,

202 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_PEER_ADDR
,

203 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_RANGING_RESPONSE
 = 131,

204 
	mNAN_REQ_ATTR_REQ_INSTANCE_ID
,

205 
	mNAN_REQ_ATTR_NDP_INSTANCE_ID
,

206 
	mNAN_REQ_ATTR_CHAN_REQ_TYPE
,

207 
	mNAN_REQ_ATTR_CHAN
,

208 
	mNAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
,

209 
	mNAN_REQ_ATTR_DATA_INTERFACE_NAME
,

210 
	mNAN_REQ_ATTR_APP_INFO_LEN
,

211 
	mNAN_REQ_ATTR_APP_INFO
,

212 
	mNAN_REQ_ATTR_SERVICE_NAME_LEN
,

213 
	mNAN_REQ_ATTR_SERVICE_NAME
 = 141,

214 
	mNAN_REQ_ATTR_NDP_RESPONSE_CODE
,

215 
	mNAN_REQ_ATTR_USE_NDPE_ATTR
,

216 
	mNAN_REQ_ATTR_HAL_TRANSACTION_ID
,

217 
	mNAN_REQ_ATTR_CONFIG_DISC_MAC_ADDR_RANDOM
,

218 
	mNAN_REQ_ATTR_DISCOVERY_BEACON_INT
,

219 
	mNAN_REQ_ATTR_NSS
,

220 
	mNAN_REQ_ATTR_ENABLE_RANGING
,

221 
	mNAN_REQ_ATTR_DW_EARLY_TERMINATION
,

222 
	mNAN_REQ_ATTR_MAX


225 
	eSLSI_NAN_RESP_ATTRIBUTES
 {

226 
	mNAN_RESP_ATTR_MAX_CONCURRENT_NAN_CLUSTERS
,

227 
	mNAN_RESP_ATTR_MAX_PUBLISHES
,

228 
	mNAN_RESP_ATTR_MAX_SUBSCRIBES
,

229 
	mNAN_RESP_ATTR_MAX_SERVICE_NAME_LEN
,

230 
	mNAN_RESP_ATTR_MAX_MATCH_FILTER_LEN
,

231 
	mNAN_RESP_ATTR_MAX_TOTAL_MATCH_FILTER_LEN
,

232 
	mNAN_RESP_ATTR_MAX_SERVICE_SPECIFIC_INFO_LEN
,

233 
	mNAN_RESP_ATTR_MAX_VSA_DATA_LEN
,

234 
	mNAN_RESP_ATTR_MAX_MESH_DATA_LEN
,

235 
	mNAN_RESP_ATTR_MAX_NDI_INTERFACES
,

236 
	mNAN_RESP_ATTR_MAX_NDP_SESSIONS
,

237 
	mNAN_RESP_ATTR_MAX_APP_INFO_LEN
,

238 
	mNAN_RESP_ATTR_SUBSCRIBE_ID
,

239 
	mNAN_RESP_ATTR_PUBLISH_ID


242 
	eSLSI_NAN_EVT_ATTRIBUTES
 {

243 
	mNAN_EVT_ATTR_MATCH_PUBLISH_SUBSCRIBE_ID
,

244 
	mNAN_EVT_ATTR_MATCH_REQUESTOR_INSTANCE_ID
,

245 
	mNAN_EVT_ATTR_MATCH_ADDR
,

246 
	mNAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO_LEN
,

247 
	mNAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO
,

248 
	mNAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER_LEN
,

249 
	mNAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER
,

250 
	mNAN_EVT_ATTR_MATCH_MATCH_OCCURRED_FLAG
,

251 
	mNAN_EVT_ATTR_MATCH_OUT_OF_RESOURCE_FLAG
,

252 
	mNAN_EVT_ATTR_MATCH_RSSI_VALUE
,

253 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_WFD_SUPPORTED
 = 10,

254 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_WFDS_SUPPORTED
,

255 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_TDLS_SUPPORTED
,

256 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_IBSS_SUPPORTED
,

257 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_MESH_SUPPORTED
,

258 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_WLAN_INFRA_FIELD
,

259 
	mNAN_EVT_ATTR_MATCH_NUM_RX_DISCOVERY_ATTR
,

260 
	mNAN_EVT_ATTR_MATCH_RX_DISCOVERY_ATTR
,

261 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_TYPE
,

262 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_ROLE
,

263 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_DURATION
 = 20,

264 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_AVAIL_INTERVAL_BITMAP
,

265 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_MAPID
,

266 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_ADDR
,

267 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_MESH_ID_LEN
,

268 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_MESH_ID
,

269 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_INFRASTRUCTURE_SSID_LEN
,

270 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_INFRASTRUCTURE_SSID_VAL
,

271 
	mNAN_EVT_ATTR_MATCH_NUM_CHANS
,

272 
	mNAN_EVT_ATTR_MATCH_FAMCHAN
,

273 
	mNAN_EVT_ATTR_MATCH_FAM_ENTRY_CONTROL
 = 30,

274 
	mNAN_EVT_ATTR_MATCH_FAM_CLASS_VAL
,

275 
	mNAN_EVT_ATTR_MATCH_FAM_CHANNEL
,

276 
	mNAN_EVT_ATTR_MATCH_FAM_MAPID
,

277 
	mNAN_EVT_ATTR_MATCH_FAM_AVAIL_INTERVAL_BITMAP
,

278 
	mNAN_EVT_ATTR_MATCH_CLUSTER_ATTRIBUTE_LEN
,

279 
	mNAN_EVT_ATTR_MATCH_CLUSTER_ATTRIBUTE
,

280 
	mNAN_EVT_ATTR_PUBLISH_ID
,

281 
	mNAN_EVT_ATTR_PUBLISH_REASON
,

282 
	mNAN_EVT_ATTR_SUBSCRIBE_ID
,

283 
	mNAN_EVT_ATTR_SUBSCRIBE_REASON
 = 40,

284 
	mNAN_EVT_ATTR_DISABLED_REASON
,

285 
	mNAN_EVT_ATTR_FOLLOWUP_PUBLISH_SUBSCRIBE_ID
,

286 
	mNAN_EVT_ATTR_FOLLOWUP_REQUESTOR_INSTANCE_ID
,

287 
	mNAN_EVT_ATTR_FOLLOWUP_ADDR
,

288 
	mNAN_EVT_ATTR_FOLLOWUP_DW_OR_FAW
,

289 
	mNAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO_LEN
,

290 
	mNAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO
,

291 
	mNAN_EVT_ATTR_DISCOVERY_ENGINE_EVT_TYPE
,

292 
	mNAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
,

293 
	mNAN_EVT_ATTR_DISCOVERY_ENGINE_CLUSTER
 = 50,

294 
	mNAN_EVT_ATTR_SDEA
,

295 
	mNAN_EVT_ATTR_SDEA_LEN
,

296 
	mNAN_EVT_ATTR_SCID
,

297 
	mNAN_EVT_ATTR_SCID_LEN
,

298 
	mNAN_EVT_ATTR_SDEA_PARAM_CONFIG_NAN_DATA_PATH
,

299 
	mNAN_EVT_ATTR_SDEA_PARAM_NDP_TYPE
,

300 
	mNAN_EVT_ATTR_SDEA_PARAM_SECURITY_CONFIG
,

301 
	mNAN_EVT_ATTR_SDEA_PARAM_RANGE_STATE
,

302 
	mNAN_EVT_ATTR_SDEA_PARAM_RANGE_REPORT
,

303 
	mNAN_EVT_ATTR_SDEA_PARAM_QOS_CFG
 = 60,

304 
	mNAN_EVT_ATTR_RANGE_MEASUREMENT_MM
,

305 
	mNAN_EVT_ATTR_RANGEING_EVENT_TYPE
,

306 
	mNAN_EVT_ATTR_SECURITY_CIPHER_TYPE
,

307 
	mNAN_EVT_ATTR_STATUS
,

308 
	mNAN_EVT_ATTR_SERVICE_INSTANCE_ID
,

309 
	mNAN_EVT_ATTR_NDP_INSTANCE_ID
,

310 
	mNAN_EVT_ATTR_NDP_RSP_CODE
,

311 
	mNAN_EVT_ATTR_STATUS_CODE
,

312 
	mNAN_EVT_ATTR_CHANNEL_INFO
,

313 
	mNAN_EVT_ATTR_APP_INFO_LEN
 = 70,

314 
	mNAN_EVT_ATTR_APP_INFO
,

315 
	mNAN_EVT_ATTR_CHANNEL
,

316 
	mNAN_EVT_ATTR_CHANNEL_BW
,

317 
	mNAN_EVT_ATTR_CHANNEL_NSS
,

318 
	mNAN_EVT_ATTR_HAL_TRANSACTION_ID


321 
	#SLSI_FAPI_NAN_CONFIG_PARAM_SID_BEACON
 0X0003

	)

322 
	#SLSI_FAPI_NAN_CONFIG_PARAM_2_4_RSSI_CLOSE
 0X0004

	)

323 
	#SLSI_FAPI_NAN_CONFIG_PARAM_2_4_RSSI_MIDDLE
 0X0005

	)

324 
	#SLSI_FAPI_NAN_CONFIG_PARAM_2_4_RSSI_PROXIMITY
 0X0006

	)

325 
	#SLSI_FAPI_NAN_CONFIG_PARAM_BAND_USAGE
 0X0007

	)

326 
	#SLSI_FAPI_NAN_CONFIG_PARAM_5_RSSI_CLOSE
 0X0008

	)

327 
	#SLSI_FAPI_NAN_CONFIG_PARAM_5_RSSI_MIDDLE
 0X0009

	)

328 
	#SLSI_FAPI_NAN_CONFIG_PARAM_5_RSSI_PROXIMITY
 0X000A

	)

329 
	#SLSI_FAPI_NAN_CONFIG_PARAM_HOP_COUNT_LIMIT
 0X000B

	)

330 
	#SLSI_FAPI_NAN_CONFIG_PARAM_RSSI_WINDOW_SIZE
 0X000C

	)

331 
	#SLSI_FAPI_NAN_CONFIG_PARAM_SCAN_PARAMETER_2_4
 0X000D

	)

332 
	#SLSI_FAPI_NAN_CONFIG_PARAM_SCAN_PARAMETER_5
 0X000E

	)

333 
	#SLSI_FAPI_NAN_CONFIG_PARAM_MASTER_PREFERENCE
 0X000F

	)

334 
	#SLSI_FAPI_NAN_CONFIG_PARAM_CONNECTION_CAPAB
 0X0010

	)

335 
	#SLSI_FAPI_NAN_CONFIG_PARAM_POST_DISCOVER_PARAM
 0X0011

	)

336 
	#SLSI_FAPI_NAN_CONFIG_PARAM_FURTHER_AVAIL_CHANNEL_MAP
 0X0012

	)

337 
	#SLSI_FAPI_NAN_CONFIG_PARAM_ADDR_RANDOM_INTERVAL
 0X0013

	)

338 
	#SLSI_FAPI_NAN_SERVICE_NAME
 0X0020

	)

339 
	#SLSI_FAPI_NAN_SERVICE_SPECIFIC_INFO
 0X0021

	)

340 
	#SLSI_FAPI_NAN_RX_MATCH_FILTER
 0X0022

	)

341 
	#SLSI_FAPI_NAN_TX_MATCH_FILTER
 0X0023

	)

342 
	#SLSI_FAPI_NAN_SDF_MATCH_FILTER
 0X0024

	)

343 
	#SLSI_FAPI_NAN_CLUSTER_ATTRIBUTE
 0X0025

	)

344 
	#SLSI_FAPI_NAN_INTERFACE_ADDRESS_SET
 0X0026

	)

345 
	#SLSI_FAPI_NAN_SDEA
 0X0027

	)

347 
	#SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
 3

	)

348 
	#SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
 255

	)

349 
	#SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 1024

	)

350 
	#SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
 255

	)

351 
	#SLSI_HAL_NAN_MAX_SUBSCRIBE_MAX_ADDRESS
 42

	)

352 
	#SLSI_HAL_NAN_MAX_POSTDISCOVERY_LEN
 5

	)

353 
	#SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
 1024

	)

354 
	#SLSI_HAL_NAN_DP_MAX_APP_INFO_LEN
 512

	)

355 
	#SLSI_HAL_NAN_MAX_MESH_DATA_LEN
 32

	)

356 
	#SLSI_HAL_NAN_MAX_INFRA_DATA_LEN
 32

	)

357 
	#SLSI_HAL_NAN_MAX_FAM_CHANNELS
 32

	)

359 
	e¦si_wifi_h®_Çn_¡©us_ty³
 {

361 
	mSLSI_HAL_NAN_STATUS_SUCCESS
 = 0,

363 
	mSLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
 = 1,

365 
	mSLSI_HAL_NAN_STATUS_PROTOCOL_FAILURE
 = 2,

367 
	mSLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
 = 3,

369 
	mSLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
 = 4,

371 
	mSLSI_HAL_NAN_STATUS_INVALID_PARAM
 = 5,

373 
	mSLSI_HAL_NAN_STATUS_INVALID_REQUESTOR_INSTANCE_ID
 = 6,

375 
	mSLSI_HAL_NAN_STATUS_INVALID_NDP_ID
 = 7,

377 
	mSLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
 = 8,

379 
	mSLSI_HAL_NAN_STATUS_NO_OTA_ACK
 = 9,

381 
	mSLSI_HAL_NAN_STATUS_ALREADY_ENABLED
 = 10,

383 
	mSLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
 = 11,

385 
	mSLSI_HAL_NAN_STATUS_UNSUPPORTED_CONCURRENCY_NAN_DISABLED
 = 12

388 
	e¦si_Çn_¡©us_ty³
 {

390 
	mNAN_STATUS_SUCCESS
 = 0,

391 
	mNAN_STATUS_TIMEOUT
 = 1,

392 
	mNAN_STATUS_DE_FAILURE
 = 2,

393 
	mNAN_STATUS_INVALID_MSG_VERSION
 = 3,

394 
	mNAN_STATUS_INVALID_MSG_LEN
 = 4,

395 
	mNAN_STATUS_INVALID_MSG_ID
 = 5,

396 
	mNAN_STATUS_INVALID_HANDLE
 = 6,

397 
	mNAN_STATUS_NO_SPACE_AVAILABLE
 = 7,

398 
	mNAN_STATUS_INVALID_PUBLISH_TYPE
 = 8,

399 
	mNAN_STATUS_INVALID_TX_TYPE
 = 9,

400 
	mNAN_STATUS_INVALID_MATCH_ALGORITHM
 = 10,

401 
	mNAN_STATUS_DISABLE_IN_PROGRESS
 = 11,

402 
	mNAN_STATUS_INVALID_TLV_LEN
 = 12,

403 
	mNAN_STATUS_INVALID_TLV_TYPE
 = 13,

404 
	mNAN_STATUS_MISSING_TLV_TYPE
 = 14,

405 
	mNAN_STATUS_INVALID_TOTAL_TLVS_LEN
 = 15,

406 
	mNAN_STATUS_INVALID_MATCH_HANDLE
 = 16,

407 
	mNAN_STATUS_INVALID_TLV_VALUE
 = 17,

408 
	mNAN_STATUS_INVALID_TX_PRIORITY
 = 18,

409 
	mNAN_STATUS_INVALID_CONNECTION_MAP
 = 19,

410 
	mNAN_STATUS_INVALID_TCA_ID
 = 20,

411 
	mNAN_STATUS_INVALID_STATS_ID
 = 21,

412 
	mNAN_STATUS_NAN_NOT_ALLOWED
 = 22,

413 
	mNAN_STATUS_NO_OTA_ACK
 = 23,

414 
	mNAN_STATUS_TX_FAIL
 = 24,

417 
	mNAN_STATUS_INVALID_RSSI_CLOSE_VALUE
 = 4096,

418 
	mNAN_STATUS_INVALID_RSSI_MIDDLE_VALUE
 = 4097,

419 
	mNAN_STATUS_INVALID_HOP_COUNT_LIMIT
 = 4098,

420 
	mNAN_STATUS_INVALID_MASTER_PREFERENCE_VALUE
 = 4099,

421 
	mNAN_STATUS_INVALID_LOW_CLUSTER_ID_VALUE
 = 4100,

422 
	mNAN_STATUS_INVALID_HIGH_CLUSTER_ID_VALUE
 = 4101,

423 
	mNAN_STATUS_INVALID_BACKGROUND_SCAN_PERIOD
 = 4102,

424 
	mNAN_STATUS_INVALID_RSSI_PROXIMITY_VALUE
 = 4103,

425 
	mNAN_STATUS_INVALID_SCAN_CHANNEL
 = 4104,

426 
	mNAN_STATUS_INVALID_POST_NAN_CONNECTIVITY_CAPABILITIES_BITMAP
 = 4105,

427 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_NUMCHAN_VALUE
 = 4106,

428 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_DURATION_VALUE
 = 4107,

429 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_CLASS_VALUE
 = 4108,

430 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_CHANNEL_VALUE
 = 4109,

431 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_AVAILABILITY_INTERVAL_BITMAP_VALUE
 = 4110,

432 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_MAP_ID
 = 4111,

433 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_CONN_TYPE_VALUE
 = 4112,

434 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_DEVICE_ROLE_VALUE
 = 4113,

435 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_DURATION_VALUE
 = 4114,

436 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_BITMAP_VALUE
 = 4115,

437 
	mNAN_STATUS_MISSING_FUTHER_AVAILABILITY_MAP
 = 4116,

438 
	mNAN_STATUS_INVALID_BAND_CONFIG_FLAGS
 = 4117,

439 
	mNAN_STATUS_INVALID_RANDOM_FACTOR_UPDATE_TIME_VALUE
 = 4118,

440 
	mNAN_STATUS_INVALID_ONGOING_SCAN_PERIOD
 = 4119,

441 
	mNAN_STATUS_INVALID_DW_INTERVAL_VALUE
 = 4120,

442 
	mNAN_STATUS_INVALID_DB_INTERVAL_VALUE
 = 4121,

444 
	mNAN_TERMINATED_REASON_INVALID
 = 8192,

445 
	mNAN_TERMINATED_REASON_TIMEOUT
 = 8193,

446 
	mNAN_TERMINATED_REASON_USER_REQUEST
 = 8194,

447 
	mNAN_TERMINATED_REASON_FAILURE
 = 8195,

448 
	mNAN_TERMINATED_REASON_COUNT_REACHED
 = 8196,

449 
	mNAN_TERMINATED_REASON_DE_SHUTDOWN
 = 8197,

450 
	mNAN_TERMINATED_REASON_DISABLE_IN_PROGRESS
 = 8198,

451 
	mNAN_TERMINATED_REASON_POST_DISC_ATTR_EXPIRED
 = 8199,

452 
	mNAN_TERMINATED_REASON_POST_DISC_LEN_EXCEEDED
 = 8200,

453 
	mNAN_TERMINATED_REASON_FURTHER_AVAIL_MAP_EMPTY
 = 8201

456 
	e¦si_Çn_»¥Ú£_ty³
 {

457 
	mNAN_RESPONSE_ENABLED
 = 0,

458 
	mNAN_RESPONSE_DISABLED
 = 1,

459 
	mNAN_RESPONSE_PUBLISH
 = 2,

460 
	mNAN_RESPONSE_PUBLISH_CANCEL
 = 3,

461 
	mNAN_RESPONSE_TRANSMIT_FOLLOWUP
 = 4,

462 
	mNAN_RESPONSE_SUBSCRIBE
 = 5,

463 
	mNAN_RESPONSE_SUBSCRIBE_CANCEL
 = 6,

464 
	mNAN_RESPONSE_STATS
 = 7,

465 
	mNAN_RESPONSE_CONFIG
 = 8,

466 
	mNAN_RESPONSE_TCA
 = 9,

467 
	mNAN_RESPONSE_ERROR
 = 10,

468 
	mNAN_RESPONSE_BEACON_SDF_PAYLOAD
 = 11,

469 
	mNAN_RESPONSE_GET_CAPABILITIES
 = 12,

470 
	mNAN_DP_INTERFACE_CREATE
 = 13,

471 
	mNAN_DP_INTERFACE_DELETE
 = 14,

472 
	mNAN_DP_INITIATOR_RESPONSE
 = 15,

473 
	mNAN_DP_RESPONDER_RESPONSE
 = 16,

474 
	mNAN_DP_END
 = 17

477 
	e¦si_Çn_disc_ev’t_ty³
 {

478 
	mNAN_EVENT_ID_DISC_MAC_ADDR
 = 0,

479 
	mNAN_EVENT_ID_STARTED_CLUSTER
,

480 
	mNAN_EVENT_ID_JOINED_CLUSTER


483 
	e¦si_Çn_d©a_·th_»¥Ú£_code
 {

484 
	mNAN_DP_REQUEST_ACCEPT
 = 0,

485 
	mNAN_DP_REQUEST_REJECT


488 
	g¦si_¹t_cÚfig
;

490 
	s¦si_h®_Çn_socŸl_chªÃl_sÿn_·¿ms
 {

491 
u8
 
	mdw–l_time
[
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
];

492 
u16
 
	msÿn_³riod
[
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
];

495 
	s¦si_h®_Çn_cÚÃùiv™y_ÿ·b™y
 {

496 
u8
 
	m·ylßd_Œªsm™_æag
;

497 
u8
 
	mis_wfd_suµÜ‹d
;

498 
u8
 
	mis_wfds_suµÜ‹d
;

499 
u8
 
	mis_tdls_suµÜ‹d
;

500 
u8
 
	mis_ibss_suµÜ‹d
;

501 
u8
 
	mis_mesh_suµÜ‹d
;

502 
u8
 
	mwÏn_šäa_f›ld
;

505 
	s¦si_h®_Çn_po¡_discov”y_·¿m
 {

506 
u8
 
	mty³
;

507 
u8
 
	mrŞe
;

508 
u8
 
	mŒªsm™_äeq
;

509 
u8
 
	mdu¿tiÚ
;

510 
u32
 
	mava_š‹rv®_b™m­
;

511 
u8
 
	maddr
[
ETH_ALEN
];

512 
u16
 
	mmesh_id_Ën
;

513 
u8
 
	mmesh_id
[
SLSI_HAL_NAN_MAX_MESH_DATA_LEN
];

514 
u16
 
	mšäa¡ruùu»_ssid_Ën
;

515 
u8
 
	mšäa¡ruùu»_ssid_v®
[
SLSI_HAL_NAN_MAX_INFRA_DATA_LEN
];

518 
	s¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 {

520 
u8
 
	m’Œy_cÚŒŞ
;

521 
u8
 
	mşass_v®
;

522 
u8
 
	mchªÃl
;

523 
u8
 
	mm­id
;

524 
u32
 
	mava_š‹rv®_b™m­
;

527 
	s¦si_h®_Çn_fu¹h”_avaab™y_m­
 {

528 
u8
 
	mnumchªs
;

529 
¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 
	mçmchª
[
SLSI_HAL_NAN_MAX_FAM_CHANNELS
];

532 
	s¦si_h®_Çn_»ûive_po¡_discov”y
 {

533 
u8
 
	mty³
;

534 
u8
 
	mrŞe
;

535 
u8
 
	mdu¿tiÚ
;

536 
u32
 
	mava_š‹rv®_b™m­
;

537 
u8
 
	mm­id
;

538 
u8
 
	maddr
[
ETH_ALEN
];

539 
u16
 
	mmesh_id_Ën
;

540 
u8
 
	mmesh_id
[
SLSI_HAL_NAN_MAX_MESH_DATA_LEN
];

541 
u16
 
	mšäa¡ruùu»_ssid_Ën
;

542 
u8
 
	mšäa¡ruùu»_ssid_v®
[
SLSI_HAL_NAN_MAX_INFRA_DATA_LEN
];

545 
	s¦si_Çn_sd—_ù¾_·¿ms
 {

546 
u8
 
	mcÚfig_Çn_d©a_·th
;

547 
u8
 
	mndp_ty³
;

548 
u8
 
	m£cur™y_cfg
;

549 
u8
 
	m¿ngšg_¡©e
;

550 
u8
 
	m¿nge_»pÜt
;

551 
u8
 
	mqos_cfg
;

554 
	s¦si_Çn_¿ngšg_cfg
 {

555 
u32
 
	m¿ngšg_š‹rv®_m£c
;

556 
u32
 
	mcÚfig_¿ngšg_šdiÿtiÚs
;

557 
u32
 
	mdi¡ªû_šg»ss_mm
;

558 
u32
 
	mdi¡ªû_eg»ss_mm
;

561 
	s¦si_Çn_¿nge_»¥Ú£_cfg
 {

562 
u16
 
	mpublish_id
;

563 
u32
 
	m»que¡Ü_š¡ªû_id
;

564 
u8
 
	m³”_addr
[
ETH_ALEN
];

565 
u8
 
	m¿ngšg_»¥Ú£
;

568 
	#SLSI_NAN_PMK_INFO_LEN
 32

	)

569 
	#SLSI_NAN_SECURITY_MAX_PASSPHRASE_LEN
 63

	)

570 
	#SLSI_NAN_MAX_SCID_BUF_LEN
 1024

	)

571 
	s¦si_Çn_£cur™y_pmk
 {

572 
u32
 
	mpmk_Ën
;

573 
u8
 
	mpmk
[
SLSI_NAN_PMK_INFO_LEN
];

576 
	s¦si_Çn_£cur™y_·s¥h¿£
 {

577 
u32
 
	m·s¥h¿£_Ën
;

578 
u8
 
	m·s¥h¿£
[
SLSI_NAN_SECURITY_MAX_PASSPHRASE_LEN
];

581 
	s¦si_Çn_£cur™y_key_šfo
 {

582 
u8
 
	mkey_ty³
;

584 
¦si_Çn_£cur™y_pmk
 
	mpmk_šfo
;

585 
¦si_Çn_£cur™y_·s¥h¿£
 
	m·s¥h¿£_šfo
;

586 } 
	mbody
;

589 
	s¦si_Çn_£cur™y_šfo
 {

590 
u32
 
	mch”_ty³
;

591 
u32
 
	mscid_Ën
;

592 
u8
 
	mscid
[
SLSI_NAN_MAX_SCID_BUF_LEN
];

593 
¦si_Çn_£cur™y_key_šfo
 
	mkey_šfo
;

596 
	s¦si_h®_Çn_’abË_»q
 {

597 
u16
 
	mŒª§ùiÚ_id
;

599 
u8
 
	mma¡”_´ef
;

600 
u16
 
	mşu¡”_low
;

601 
u16
 
	mşu¡”_high
;

603 
u8
 
	mcÚfig_suµÜt_5g
;

604 
u8
 
	msuµÜt_5g_v®
;

605 
u8
 
	mcÚfig_sid_b—cÚ
;

606 
u8
 
	msid_b—cÚ_v®
;

607 
u8
 
	mcÚfig_2dÙ4g_rssi_şo£
;

608 
u8
 
	mrssi_şo£_2dÙ4g_v®
;

610 
u8
 
	mcÚfig_2dÙ4g_rssi_middË
;

611 
u8
 
	mrssi_middË_2dÙ4g_v®
;

613 
u8
 
	mcÚfig_2dÙ4g_rssi_´oxim™y
;

614 
u8
 
	mrssi_´oxim™y_2dÙ4g_v®
;

616 
u8
 
	mcÚfig_hİ_couÁ_lim™
;

617 
u8
 
	mhİ_couÁ_lim™_v®
;

619 
u8
 
	mcÚfig_2dÙ4g_suµÜt
;

620 
u8
 
	msuµÜt_2dÙ4g_v®
;

622 
u8
 
	mcÚfig_2dÙ4g_b—cÚs
;

623 
u8
 
	mb—cÚ_2dÙ4g_v®
;

624 
u8
 
	mcÚfig_2dÙ4g_sdf
;

625 
u8
 
	msdf_2dÙ4g_v®
;

626 
u8
 
	mcÚfig_5g_b—cÚs
;

627 
u8
 
	mb—cÚ_5g_v®
;

628 
u8
 
	mcÚfig_5g_sdf
;

629 
u8
 
	msdf_5g_v®
;

630 
u8
 
	mcÚfig_5g_rssi_şo£
;

631 
u8
 
	mrssi_şo£_5g_v®
;

632 
u8
 
	mcÚfig_5g_rssi_middË
;

633 
u8
 
	mrssi_middË_5g_v®
;

634 
u8
 
	mcÚfig_5g_rssi_şo£_´oxim™y
;

635 
u8
 
	mrssi_şo£_´oxim™y_5g_v®
;

636 
u8
 
	mcÚfig_rssi_wšdow_size
;

637 
u8
 
	mrssi_wšdow_size_v®
;

639 
u8
 
	mcÚfig_oui
;

640 
u32
 
	moui_v®
;

641 
u8
 
	mcÚfig_štf_addr
;

642 
u8
 
	mštf_addr_v®
[
ETH_ALEN
];

644 
u8
 
	mcÚfig_şu¡”_©Œibu‹_v®
;

645 
u8
 
	mcÚfig_sÿn_·¿ms
;

646 
¦si_h®_Çn_socŸl_chªÃl_sÿn_·¿ms
 
	msÿn_·¿ms_v®
;

647 
u8
 
	mcÚfig_¿ndom_çùÜ_fÜû
;

648 
u8
 
	m¿ndom_çùÜ_fÜû_v®
;

649 
u8
 
	mcÚfig_hİ_couÁ_fÜû
;

650 
u8
 
	mhİ_couÁ_fÜû_v®
;

653 
u8
 
	mcÚfig_24g_chªÃl
;

654 
u32
 
	mchªÃl_24g_v®
;

656 
u8
 
	mcÚfig_5g_chªÃl
;

657 
	mchªÃl_5g_v®
;

658 
u8
 
	mcÚfig_subsüibe_sid_b—cÚ
;

659 
u32
 
	msubsüibe_sid_b—cÚ_v®
;

662 
u8
 
	mcÚfig_2dÙ4g_dw_bªd
;

663 
u32
 
	mdw_2dÙ4g_š‹rv®_v®
;

664 
u8
 
	mcÚfig_5g_dw_bªd
;

665 
u32
 
	mdw_5g_š‹rv®_v®
;

666 
u32
 
	mdisc_mac_addr_¿nd_š‹rv®_£c
;

668 
u32
 
	mdiscov”y_b—cÚ_š‹rv®_ms
;

669 
u32
 
	mnss_discov”y
;

670 
u32
 
	m’abË_dw_—¾y_‹rmš©iÚ
;

671 
u32
 
	m’abË_¿ngšg
;

674 
	s¦si_h®_Çn_publish_»q
 {

675 
u16
 
	mŒª§ùiÚ_id
;

677 
u16
 
	mpublish_id
;

679 
u16
 
	m‰l
;

683 
u16
 
	m³riod
;

684 
u8
 
	mpublish_ty³
;

685 
u8
 
	mtx_ty³
;

687 
u8
 
	mpublish_couÁ
;

688 
u16
 
	m£rviû_Çme_Ën
;

689 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

690 
u8
 
	mpublish_m©ch_šdiÿtÜ
;

692 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

693 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

695 
u16
 
	mrx_m©ch_f‹r_Ën
;

696 
u8
 
	mrx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

698 
u16
 
	mtx_m©ch_f‹r_Ën
;

699 
u8
 
	mtx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

701 
u8
 
	mrssi_th»shŞd_æag
;

714 
u8
 
	mcÚnm­
;

721 
u8
 
	m»cv_šdiÿtiÚ_cfg
;

723 
u8
 
	m£rviû_»¥Úd”_pŞicy
;

724 
¦si_Çn_£cur™y_šfo
 
	m£c_šfo
;

725 
¦si_Çn_sd—_ù¾_·¿ms
 
	msd—_·¿ms
;

726 
¦si_Çn_¿ngšg_cfg
 
	m¿ngšg_cfg
;

727 
u8
 
	m¿ngšg_auto_»¥Ú£
;

728 
¦si_Çn_¿nge_»¥Ú£_cfg
 
	m¿nge_»¥Ú£_cfg
;

730 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

731 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

734 
	s¦si_h®_Çn_subsüibe_»q
 {

735 
u16
 
	mŒª§ùiÚ_id
;

737 
u16
 
	msubsüibe_id
;

739 
u16
 
	m‰l
;

743 
u16
 
	m³riod
;

746 
u8
 
	msubsüibe_ty³
;

751 
u8
 
	m£rviû_»¥Ú£_f‹r
;

757 
u8
 
	m£rviû_»¥Ú£_šşude
;

763 
u8
 
	mu£_£rviû_»¥Ú£_f‹r
;

768 
u8
 
	mssi_»quœed_fÜ_m©ch_šdiÿtiÚ
;

777 
u8
 
	msubsüibe_m©ch_šdiÿtÜ
;

783 
u8
 
	msubsüibe_couÁ
;

787 
u16
 
	m£rviû_Çme_Ën
;

788 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

793 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

794 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

800 
u16
 
	mrx_m©ch_f‹r_Ën
;

801 
u8
 
	mrx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

806 
u16
 
	mtx_m©ch_f‹r_Ën
;

807 
u8
 
	mtx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

808 
u8
 
	mrssi_th»shŞd_æag
;

810 
u8
 
	mcÚnm­
;

814 
u8
 
	mnum_štf_addr_´e£Á
;

815 
u8
 
	mštf_addr
[
SLSI_HAL_NAN_MAX_SUBSCRIBE_MAX_ADDRESS
][
ETH_ALEN
];

822 
u8
 
	m»cv_šdiÿtiÚ_cfg
;

824 
¦si_Çn_£cur™y_šfo
 
	m£c_šfo
;

825 
¦si_Çn_sd—_ù¾_·¿ms
 
	msd—_·¿ms
;

826 
¦si_Çn_¿ngšg_cfg
 
	m¿ngšg_cfg
;

827 
u8
 
	m¿ngšg_auto_»¥Ú£
;

828 
¦si_Çn_¿nge_»¥Ú£_cfg
 
	m¿nge_»¥Ú£_cfg
;

830 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

831 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

834 
	s¦si_h®_Çn_Œªsm™_fŞlowup_»q
 {

835 
u16
 
	mŒª§ùiÚ_id
;

837 
u16
 
	mpublish_subsüibe_id
;

842 
u32
 
	m»que¡Ü_š¡ªû_id
;

843 
u8
 
	maddr
[
ETH_ALEN
];

844 
u8
 
	m´iÜ™y
;

845 
u8
 
	mdw_Ü_çw
;

850 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

851 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

856 
u8
 
	m»cv_šdiÿtiÚ_cfg
;

858 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

859 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

862 
	s¦si_h®_Çn_cÚfig_»q
 {

863 
u16
 
	mŒª§ùiÚ_id
;

864 
u8
 
	mcÚfig_sid_b—cÚ
;

865 
u8
 
	msid_b—cÚ
;

866 
u8
 
	mcÚfig_rssi_´oxim™y
;

867 
u8
 
	mrssi_´oxim™y
;

868 
u8
 
	mcÚfig_ma¡”_´ef
;

869 
u8
 
	mma¡”_´ef
;

876 
u8
 
	mcÚfig_5g_rssi_şo£_´oxim™y
;

877 
u8
 
	mrssi_şo£_´oxim™y_5g_v®
;

878 
u8
 
	mcÚfig_rssi_wšdow_size
;

879 
u16
 
	mrssi_wšdow_size_v®
;

884 
u8
 
	mcÚfig_şu¡”_©Œibu‹_v®
;

885 
u8
 
	mcÚfig_sÿn_·¿ms
;

886 
¦si_h®_Çn_socŸl_chªÃl_sÿn_·¿ms
 
	msÿn_·¿ms_v®
;

890 
u8
 
	mcÚfig_¿ndom_çùÜ_fÜû
;

891 
u8
 
	m¿ndom_çùÜ_fÜû_v®
;

896 
u8
 
	mcÚfig_hİ_couÁ_fÜû
;

897 
u8
 
	mhİ_couÁ_fÜû_v®
;

899 
u8
 
	mcÚfig_cÚn_ÿ·b™y
;

900 
¦si_h®_Çn_cÚÃùiv™y_ÿ·b™y
 
	mcÚn_ÿ·b™y_v®
;

902 
u8
 
	mnum_cÚfig_discov”y_©Œ
;

903 
¦si_h®_Çn_po¡_discov”y_·¿m
 
	mdiscov”y_©Œ_v®
[
SLSI_HAL_NAN_MAX_POSTDISCOVERY_LEN
];

905 
u8
 
	mcÚfig_çm
;

906 
¦si_h®_Çn_fu¹h”_avaab™y_m­
 
	mçm_v®
;

908 
	mchªÃl_5g_v®
;

909 
u8
 
	mcÚfig_subsüibe_sid_b—cÚ
;

910 
u32
 
	msubsüibe_sid_b—cÚ_v®
;

913 
u8
 
	mcÚfig_2dÙ4g_dw_bªd
;

914 
u32
 
	mdw_2dÙ4g_š‹rv®_v®
;

915 
u8
 
	mcÚfig_5g_dw_bªd
;

916 
u32
 
	mdw_5g_š‹rv®_v®
;

917 
u32
 
	mdisc_mac_addr_¿nd_š‹rv®_£c
;

920 
u16
 
	mşu¡”_low
;

921 
u16
 
	mşu¡”_high
;

923 
u8
 
	mcÚfig_suµÜt_5g
;

924 
u8
 
	msuµÜt_5g_v®
;

926 
u8
 
	mcÚfig_2dÙ4g_rssi_şo£
;

927 
u8
 
	mrssi_şo£_2dÙ4g_v®
;

929 
u8
 
	mcÚfig_2dÙ4g_rssi_middË
;

930 
u8
 
	mrssi_middË_2dÙ4g_v®
;

931 
u8
 
	mcÚfig_hİ_couÁ_lim™
;

932 
u8
 
	mhİ_couÁ_lim™_v®
;

934 
u8
 
	mcÚfig_2dÙ4g_suµÜt
;

935 
u8
 
	msuµÜt_2dÙ4g_v®
;

937 
u8
 
	mcÚfig_2dÙ4g_b—cÚs
;

938 
u8
 
	mb—cÚ_2dÙ4g_v®
;

939 
u8
 
	mcÚfig_2dÙ4g_sdf
;

940 
u8
 
	msdf_2dÙ4g_v®
;

941 
u8
 
	mcÚfig_5g_b—cÚs
;

942 
u8
 
	mb—cÚ_5g_v®
;

943 
u8
 
	mcÚfig_5g_sdf
;

944 
u8
 
	msdf_5g_v®
;

945 
u8
 
	mcÚfig_5g_rssi_şo£
;

946 
u8
 
	mrssi_şo£_5g_v®
;

947 
u8
 
	mcÚfig_5g_rssi_middË
;

948 
u8
 
	mrssi_middË_5g_v®
;

951 
u8
 
	mcÚfig_oui
;

952 
u32
 
	moui_v®
;

953 
u8
 
	mcÚfig_štf_addr
;

954 
u8
 
	mštf_addr_v®
[
ETH_ALEN
];

957 
u8
 
	mcÚfig_24g_chªÃl
;

958 
u32
 
	mchªÃl_24g_v®
;

960 
u32
 
	mdiscov”y_b—cÚ_š‹rv®_ms
;

961 
u32
 
	mnss_discov”y
;

962 
u32
 
	m’abË_dw_—¾y_‹rmš©iÚ
;

963 
u32
 
	m’abË_¿ngšg
;

966 
	s¦si_h®_Çn_d©a_·th_cfg
 {

967 
u8
 
	m£cur™y_cfg
;

968 
u8
 
	mqos_cfg
;

971 
	s¦si_h®_Çn_d©a_·th_­p_šfo
 {

972 
u16
 
	mndp_­p_šfo_Ën
;

973 
u8
 
	mndp_­p_šfo
[
SLSI_HAL_NAN_DP_MAX_APP_INFO_LEN
];

976 
	s¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 {

977 
u16
 
	mŒª§ùiÚ_id
;

978 
u32
 
	m»que¡Ü_š¡ªû_id
;

979 
u8
 
	mchªÃl_»que¡_ty³
;

980 
u32
 
	mchªÃl
;

981 
u8
 
	m³”_disc_mac_addr
[
ETH_ALEN
];

982 
	mndp_içû
[
IFNAMSIZ
 + 1];

983 
¦si_h®_Çn_d©a_·th_cfg
 
	mndp_cfg
;

984 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

985 
¦si_Çn_£cur™y_šfo
 
	mkey_šfo
;

986 
u32
 
	m£rviû_Çme_Ën
;

987 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

990 
	s¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 {

991 
u16
 
	mŒª§ùiÚ_id
;

992 
u32
 
	mndp_š¡ªû_id
;

993 
	mndp_içû
[
IFNAMSIZ
 + 1];

994 
¦si_h®_Çn_d©a_·th_cfg
 
	mndp_cfg
;

995 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

996 
u32
 
	mr¥_code
;

997 
¦si_Çn_£cur™y_šfo
 
	mkey_šfo
;

998 
u8
 
	m£rviû_Çme_Ën
;

999 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

1002 
	s¦si_h®_Çn_d©a_’d
 {

1003 
u16
 
	mŒª§ùiÚ_id
;

1004 
u8
 
	mnum_ndp_š¡ªûs
;

1005 
u32
 
	mndp_š¡ªû_id
[
SLSI_NAN_MAX_NDP_INSTANCES
];

1008 
	s¦si_h®_Çn_ÿ·b™›s
 {

1009 
u32
 
	mmax_cÚcu¼’t_Çn_şu¡”s
;

1010 
u32
 
	mmax_publishes
;

1011 
u32
 
	mmax_subsüibes
;

1012 
u32
 
	mmax_£rviû_Çme_Ën
;

1013 
u32
 
	mmax_m©ch_f‹r_Ën
;

1014 
u32
 
	mmax_tÙ®_m©ch_f‹r_Ën
;

1015 
u32
 
	mmax_£rviû_¥ecific_šfo_Ën
;

1016 
u32
 
	mmax_v§_d©a_Ën
;

1017 
u32
 
	mmax_mesh_d©a_Ën
;

1018 
u32
 
	mmax_ndi_š‹rçûs
;

1019 
u32
 
	mmax_ndp_£ssiÚs
;

1020 
u32
 
	mmax_­p_šfo_Ën
;

1021 
u32
 
	mmax_queued_Œªsm™_fŞlowup_msgs
;

1022 
u32
 
	mndp_suµÜ‹d_bªds
;

1023 
u32
 
	mch”_su™es_suµÜ‹d
;

1024 
u32
 
	mmax_scid_Ën
;

1025 
boŞ
 
	mis_ndp_£cur™y_suµÜ‹d
;

1026 
u32
 
	mmax_sd—_£rviû_¥ecific_šfo_Ën
;

1027 
u32
 
	mmax_subsüibe_add»ss
;

1028 
u32
 
	mnd³_©Œ_suµÜ‹d
;

1031 
	s¦si_h®_Çn_fŞlowup_šd
 {

1032 
u16
 
	mpublish_subsüibe_id
;

1033 
u32
 
	m»que¡Ü_š¡ªû_id
;

1034 
u8
 
	maddr
[
ETH_ALEN
];

1035 
u8
 
	mdw_Ü_çw
;

1036 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

1037 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

1038 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

1039 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

1042 
	s¦si_h®_Çn_m©ch_šd
 {

1043 
u16
 
	mpublish_subsüibe_id
;

1044 
u32
 
	m»que¡Ü_š¡ªû_id
;

1045 
u8
 
	maddr
[
ETH_ALEN
];

1046 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

1047 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

1048 
u16
 
	msdf_m©ch_f‹r_Ën
;

1049 
u8
 
	msdf_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

1050 
u8
 
	mm©ch_occu¼ed_æag
;

1051 
u8
 
	mout_of_»sourû_æag
;

1052 
u8
 
	mrssi_v®ue
;

1053 
u8
 
	mis_cÚn_ÿ·b™y_v®id
;

1054 
¦si_h®_Çn_cÚÃùiv™y_ÿ·b™y
 
	mcÚn_ÿ·b™y
;

1055 
u8
 
	mnum_rx_discov”y_©Œ
;

1056 
¦si_h®_Çn_»ûive_po¡_discov”y
 
	mdiscov”y_©Œ
[
SLSI_HAL_NAN_MAX_POSTDISCOVERY_LEN
];

1057 
u8
 
	mnum_chªs
;

1058 
¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 
	mçmchª
[32];

1059 
u8
 
	mşu¡”_©Œibu‹_Ën
;

1060 
u8
 
	mşu¡”_©Œibu‹
[32];

1061 
¦si_Çn_£cur™y_šfo
 
	m£c_šfo
;

1062 
¦si_Çn_sd—_ù¾_·¿ms
 
	m³”_sd—_·¿ms
;

1063 
u32
 
	m¿nge_m—su»m’t_mm
;

1064 
u32
 
	m¿ngšg_ev’t_ty³
;

1065 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

1066 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

1069 
	s¦si_h®_Çn_chªÃl_šfo
 {

1070 
u32
 
	mchªÃl
;

1071 
u32
 
	mbªdwidth
;

1072 
u32
 
	mnss
;

1075 #ià(
KERNEL_VERSION
(5, 12, 0è<ğ
LINUX_VERSION_CODE
)

1076 
	s¦si_Çn_d©a_š‹rçû_ü—‹_šfo
 {

1077 
li¡_h—d
 
	mli¡
;

1078 
u8
 
	miâame
[
IFNAMSIZ
];

1079 
	mŒª§ùiÚ_id
;

1082 
	s¦si_Çn_d©a_š‹rçû_d–‘e_šfo
 {

1083 
li¡_h—d
 
	mli¡
;

1084 
u8
 
	miâame
[
IFNAMSIZ
];

1085 
	mŒª§ùiÚ_id
;

1089 
	s¦si_Çn_d©a_·th_»que¡_šd
 {

1090 
u16
 
	m£rviû_š¡ªû_id
;

1091 
u8
 
	m³”_disc_mac_addr
[
ETH_ALEN
];

1092 
u32
 
	mndp_š¡ªû_id
;

1093 
¦si_h®_Çn_d©a_·th_cfg
 
	mndp_cfg
;

1094 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

1097 
	#SLSI_HAL_NAN_MAX_CHANNEL_INFO_SUPPORTED
 4

	)

1098 
	s¦si_h®_Çn_d©a_·th_cÚfœm_šd
 {

1099 
u32
 
	mndp_š¡ªû_id
;

1100 
u8
 
	m³”_ndi_mac_addr
[
ETH_ALEN
];

1101 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

1102 
u32
 
	mr¥_code
;

1103 
u32
 
	m»asÚ_code
;

1104 
u32
 
	mnum_chªÃls
;

1105 
¦si_h®_Çn_chªÃl_šfo
 
	mchªÃl_šfo
[
SLSI_HAL_NAN_MAX_CHANNEL_INFO_SUPPORTED
];

1108 
	s¦si_h®_Çn_d©a_·th_’d_šd
 {

1109 
u8
 
	mnum_ndp_š¡ªûs
;

1110 
u32
 
	mndp_š¡ªû_id
[
SLSI_NAN_MAX_NDP_INSTANCES
];

1113 
¦si_Çn_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1114 
¦si_Çn_fŞlowup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1115 
¦si_Çn_£rviû_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1116 
¦si_Çn_g‘_mac
(
¦si_dev
 *
sdev
, *
Çn_mac_addr
);

1117 
Ãt_deviû
 *
¦si_Çn_g‘_Ãtdev
(
¦si_dev
 *
sdev
);

1118 
¦si_Çn_’abË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1119 
¦si_Çn_di§bË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1120 
¦si_Çn_publish
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1121 
¦si_Çn_publish_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

1122 cÚ¡ *
d©a
, 
Ën
);

1123 
¦si_Çn_subsüibe
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1124 
¦si_Çn_subsüibe_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1125 
¦si_Çn_Œªsm™_fŞlowup
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1126 
¦si_Çn_£t_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1127 
¦si_Çn_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1128 
¦si_Çn_£nd_di§bËd_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
»asÚ
);

1129 
¦si_Çn_d©a_içû_ü—‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1130 
¦si_Çn_d©a_içû_d–‘e
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1131 
¦si_Çn_ndp_š™Ÿ‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1132 
¦si_Çn_ndp_»¥Úd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1133 
¦si_Çn_ndp_’d
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1134 
¦si_Çn_ndp_Ãw_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
,

1135 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
, u8 *
³”_nmi
);

1136 
¦si_Çn_ndp_d–_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
, cÚ¡ 
boŞ
 
ndl_vif_locked
);

1137 
¦si_Çn_ndp_£tup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
is_»q_šd
);

1138 
¦si_Çn_ndp_»que¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1139 
¦si_Çn_ndp_‹rmš©iÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1140 
u32
 
¦si_Çn_g‘_ndp_äom_ndl_loÿl_ndi
(
Ãt_deviû
 *
dev
, 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
);

1141 
¦si_Çn_d–_³”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
loÿl_ndi
, 
u16
 
ndp_š¡ªû_id
);

1142 
¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, 
u8
 *
ndi
);

1143 
¦si_Çn_push_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
, u16 
Œªs_id
);

1144 
¦si_Çn_pİ_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
);

1145 
¦si_rx_Çn_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1146 
¦si_£nd_Çn_¿nge_ÿnûl
(
¦si_dev
 *
sdev
);

1147 
¦si_£nd_Çn_¿nge_cÚfig
(
¦si_dev
 *
sdev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
, 
¹t_id
);

1148 #ià(
KERNEL_VERSION
(5, 12, 0è<ğ
LINUX_VERSION_CODE
)

1149 
¦si_Çn_d©a_š‹rçû_ü—‹_wq
(
wÜk_¡ruù
 *
wÜk
);

1150 
¦si_Çn_d©a_š‹rçû_d–‘e_wq
(
wÜk_¡ruù
 *
wÜk
);

1152 
¦si_v’dÜ_Çn_ev’t_ü—‹_d–‘e
(
¦si_dev
 *
sdev
, 
h®_ev’t
, 
Œª§ùiÚ_id
,
»¶y_¡©us
);

	@porting_imx.h

9 #iâdeà
_PORTING_IMX__H__


10 
	#_PORTING_IMX__H__


	)

19 
šlše
 
	$‘h”_addr_cİy
(
u8
 *
d¡
, cÚ¡ u8 *
¤c
)

21 #ià
	`defšed
(
CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS
)

22 *(
u32
 *)
d¡
 = *(cÚ¡ u32 *)
¤c
;

23 *(
u16
 *)(
d¡
 + 4èğ*(cÚ¡ u16 *)(
¤c
 + 4);

25 
u16
 *
a
 = (u16 *)
d¡
;

26 cÚ¡ 
u16
 *
b
 = (cÚ¡ u16 *)
¤c
;

28 
a
[0] = 
b
[0];

29 
a
[1] = 
b
[1];

30 
a
[2] = 
b
[2];

32 
	}
}

34 
šlše
 
ktime_t
 
	$ktime_add_ms
(cÚ¡ 
ktime_t
 
kt
, cÚ¡ 
u64
 
m£c
)

36  
	`ktime_add_ns
(
kt
, 
m£c
 * 
NSEC_PER_MSEC
);

37 
	}
}

	@procfs.c

7 
	~"dev.h
"

8 
	~"´ocfs.h
"

9 
	~"debug.h
"

10 
	~"mlme.h
"

11 
	~"mgt.h
"

12 
	~"mib.h
"

13 
	~"ÿc.h
"

14 
	~"h.h
"

15 
	~"Ãtif.h
"

16 
	~"ioùl.h
"

17 
	~"Æ80211_v’dÜ.h
"

18 
	~"log2us.h
"

19 
	~"mib.h
"

21 
	$¦si_´ocfs_İ’_fe_g’”ic
(
šode
 *šode, 
fe
 *file)

23 
fe
->
´iv©e_d©a
 = 
	`SLSI_PDE_DATA
(
šode
);

25 
	}
}

27 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


28 
	$¦si_´štf_mu‹x_¡©s
(*
buf
, cÚ¡ 
size_t
 
bufsz
, cÚ¡ *
´štf_·ddšg
, 
¦si_mu‹x
 *
mu‹x_p
)

30 
pos
 = 0;

31 cÚ¡ *
f’ame
;

32 
boŞ
 
is_locked
;

34 ià(
mu‹x_p
->
v®id
) {

35 
is_locked
 = 
	`SLSI_MUTEX_IS_LOCKED
(*
mu‹x_p
);

36 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "INFO:†ock:%d\n", 
is_locked
);

37 ià(
is_locked
) {

38 
f’ame
 = 
	`¡¼chr
(
mu‹x_p
->
fe_Çme_befÜe
, '/');

39 ià(
f’ame
)

40 
f’ame
++;

42 
f’ame
 = 
mu‹x_p
->
fe_Çme_befÜe
;

43 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\t%sTryšgToAcquœe:%s:%d\n", 
´štf_·ddšg
,

44 
f’ame
, 
mu‹x_p
->
lše_no_befÜe
);

45 
f’ame
 = 
	`¡¼chr
(
mu‹x_p
->
fe_Çme_aá”
, '/');

46 ià(
f’ame
)

47 
f’ame
++;

49 
f’ame
 = 
mu‹x_p
->
fe_Çme_aá”
;

50 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\t%sAcquœed:%s:%d:%s\n", 
´štf_·ddšg
,

51 
f’ame
, 
mu‹x_p
->
lše_no_aá”
, mu‹x_p->
funùiÚ
);

52 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\t%sProûssName:%s\n", 
´štf_·ddšg
, 
mu‹x_p
->
owÃr
->
comm
);

55 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "NoInit\n");

57  
pos
;

58 
	}
}

60 
ssize_t
 
	$¦si_´ocfs_mu‹x_¡©s_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

62 
buf
[76 + (200 * 
CONFIG_SCSC_WLAN_MAX_INTERFACES
)];

63 
pos
 = 0;

64 
i
;

65 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

66 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

67 
Ãt_deviû
 *
dev
;

68 
Ãtdev_vif
 *
ndev_vif
;

70 
	`SLSI_UNUSED_PARAMETER
(
fe
);

72 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "sdev\n");

73 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tnetdev_add_remove_mutex ");

74 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
Ãtdev_add_»move_mu‹x
);

75 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tstart_stop_mutex ");

76 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
¡¬t_¡İ_mu‹x
);

77 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tdevice_config_mutex ");

78 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
deviû_cÚfig_mu‹x
);

79 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tsig_wait.mutex ");

80 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
sig_wa™
.
mu‹x
);

81 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


82 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tlogger_mutex ");

83 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
logg”_mu‹x
);

86 
i
 = 1; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

87 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "Ãtdevvià%d\n", 
i
);

88 
dev
 = 
sdev
->
Ãtdev
[
i
];

89 ià(!
dev
)

91 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

92 ià(
ndev_vif
->
is_avaabË
) {

93 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tvif_mutex ");

94 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t\t", &
ndev_vif
->
vif_mu‹x
);

95 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tsig_wait.mutex ");

96 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t\t", &
ndev_vif
->
sig_wa™
.
mu‹x
);

97 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tscan_mutex ");

98 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t\t", &
ndev_vif
->
sÿn_mu‹x
);

100 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tvif UNAVAILABLE\n");

103  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

104 
	}
}

107 
ssize_t
 
	$¦si_´ocfs_throughput_¡©s_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

109 
buf
[5 * 25];

110 
pos
 = 0;

111 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

112 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

113 
Ãt_deviû
 *
dev
;

114 
Ãtdev_vif
 *
ndev_vif
;

115 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

116 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

117 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 3, 0 } },

118 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 4, 0 } },

119 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 5, 0 } },

120 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 25, 0 } },

121 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 30, 0 } } };

123 
	`SLSI_UNUSED_PARAMETER
(
fe
);

125 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 1);

126 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

128 ià(
ndev_vif
->
aùiv©ed
) {

129 
mibr¥
.
d©aL’gth
 = 15 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

130 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

131 ià(!
mibr¥
.
d©a
)

132 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

133 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

134 ià(!
v®ues
) {

135 
	`kä“
(
mibr¥
.
d©a
);

136  -
EINVAL
;

138 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

139 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 0);

140 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

141 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 1);

142 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

143 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 2);

144 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

145 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 3);

146 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

147 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 4);

149 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "RX FCS: %d\n", 
v®ues
[0].
u
.
uštV®ue
);

150 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX bad SIG: %d\n", 
v®ues
[3].
u
.
uštV®ue
);

151 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX dÙ11ƒ¼Ü: %d\n", 
v®ues
[4].
u
.
uštV®ue
);

152 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX MPDU‚ØACK: %d\n", 
v®ues
[2].
u
.
uštV®ue
);

153 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX A-MPDU‚ØACK: %d\n", 
v®ues
[1].
u
.
uštV®ue
);

155 
	`kä“
(
v®ues
);

156 
	`kä“
(
mibr¥
.
d©a
);

158 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "RX FCS: %d\n", 0);

159 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX bad SIG: %d\n", 0);

160 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX dot11ƒrror: %d\n", 0);

161 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX MPDU‚o ACK: %d\n", 0);

162 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX A-MPDU‚o ACK: %d\n", 0);

165  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

166 
	}
}

168 
ssize_t
 
	$¦si_´ocfs_¡a_bss_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

170 
buf
[100];

171 
pos
;

172 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

173 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

174 
Ãt_deviû
 *
dev
;

175 
Ãtdev_vif
 *
ndev_vif
;

176 
cfg80211_bss
 *
¡a_bss
;

177 
chªÃl
 = 0, 
ûÁ”_äeq
 = 0;

178 
u8
 
no_mac
[] = {0, 0, 0, 0, 0, 0};

179 
u8
 *
mac_±r
;

180 
u8
 
ssid
[33];

181 
s32
 
sigÇl
 = 0;

183 
	`SLSI_UNUSED_PARAMETER
(
fe
);

185 
mac_±r
 = 
no_mac
;

186 
ssid
[0] = 0;

188 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 1);

189 ià(!
dev
)

190 
ex™
;

192 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

194 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

195 
¡a_bss
 = 
ndev_vif
->
¡a
.sta_bss;

196 ià(
¡a_bss
 && 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

197 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

198 cÚ¡ 
u8
 *
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
¡a_bss
->
›s
->
d©a
, s_bss->›s->
Ën
);

200 ià(
ssid_›
) {

201 
	`memıy
(
ssid
, &
ssid_›
[2], ssid_ie[1]);

202 
ssid
[
ssid_›
[1]] = 0;

205 ià(
¡a_bss
->
chªÃl
) {

206 
chªÃl
 = 
¡a_bss
->chªÃl->
hw_v®ue
;

207 
ûÁ”_äeq
 = 
¡a_bss
->
chªÃl
->center_freq;

209 
mac_±r
 = 
¡a_bss
->
bssid
;

210 
sigÇl
 = 
¡a_bss
->signal;

212 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

214 
ex™
:

215 
pos
 = 
	`sú´štf
(
buf
, 
bufsz
, "%pM,%s,%d,%d,%d", 
mac_±r
, 
ssid
, 
chªÃl
, 
ûÁ”_äeq
, 
sigÇl
);

216  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

217 
	}
}

219 #ifdeà
CONFIG_SCSC_WLAN_LOG_2_USER_SP


220 
ssize_t
 
	$¦si_´ocfs_cÚn_log_ev’t_bur¡_to_us_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

223 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

224 
bur¡
;

225 
off£t
 = 0;

226 *
»ad_¡ršg
;

228 ià(!
couÁ
)

229  -
EINVAL
;

231 
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

232 ià(!
»ad_¡ršg
) {

233 
	`SLSI_ERR
(
sdev
, "Malloc for„ead_string failed\n");

234  -
ENOMEM
;

236 
	`mem£t
(
»ad_¡ršg
, 0, (
couÁ
 + 1));

238 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

239 
»ad_¡ršg
[
couÁ
] = '\0';

241 
off£t
 = 
	`k¡¹ošt
(
»ad_¡ršg
, 10, &
bur¡
);

242 ià(
off£t
) {

243 
	`SLSI_ERR
(
sdev
, "conn_log_burst : failedo„ead‡‚umeric value");

244 
	`kä“
(
»ad_¡ršg
);

245  -
EINVAL
;

249 
	`¿‹lim™_¡©e_š™
(&
sdev
->
cÚn_log2us_ùx
.
rs
, 1 * 
HZ
, 
bur¡
);

250 
	`kä“
(
»ad_¡ršg
);

251  
couÁ
;

252 
	}
}

255 
ssize_t
 
	$¦si_´ocfs_big_d©a_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

257 
buf
[100];

258 
pos
;

259 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

260 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

261 
Ãt_deviû
 *
dev
;

263 
	`SLSI_UNUSED_PARAMETER
(
fe
);

264 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 1);

265 ià(!
dev
)

266 
ex™
;

268 
pos
 = 
	`¦si_g‘_¡a_šfo
(
dev
, 
buf
, 
bufsz
);

269 ià(
pos
 >= 0)

270  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

271 
ex™
:

273 
	}
}

275 
	$¦si_´ocfs_¡©us_show
(
£q_fe
 *
m
, *
v
)

277 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

278 cÚ¡ *
¡©e
;

279 
u32
 
cÚf_h4_v”
 = 0;

280 
i
;

282 
	`SLSI_UNUSED_PARAMETER
(
v
);

284 
sdev
->
deviû_¡©e
) {

285 
SLSI_DEVICE_STATE_ATTACHING
:

286 
¡©e
 = "Attaching";

288 
SLSI_DEVICE_STATE_STOPPED
:

289 
¡©e
 = "Stopped";

291 
SLSI_DEVICE_STATE_STARTING
:

292 
¡©e
 = "Starting";

294 
SLSI_DEVICE_STATE_STARTED
:

295 
¡©e
 = "Started";

297 
SLSI_DEVICE_STATE_STOPPING
:

298 
¡©e
 = "Stopping";

301 
¡©e
 = "UNKNOWN";

305 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: MA SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_DATA_SAP_VERSION
),

306 
	`FAPI_MINOR_VERSION
(
FAPI_DATA_SAP_VERSION
), 
FAPI_DATA_SAP_ENG_VERSION
);

307 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: MLME SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

308 
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
), 
FAPI_CONTROL_SAP_ENG_VERSION
);

309 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: DEBUG SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
),

310 
	`FAPI_MINOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
), 
FAPI_DEBUG_SAP_ENG_VERSION
);

311 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: TEST SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_TEST_SAP_VERSION
),

312 
	`FAPI_MINOR_VERSION
(
FAPI_TEST_SAP_VERSION
), 
FAPI_TEST_SAP_ENG_VERSION
);

314 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è=ğ
SLSI_HIP_STATE_STARTED
) {

315 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
š™
);

316 
	`£q_´štf
(
m
, "HIP4 V”siÚ : %d\n", 
cÚf_h4_v”
);

317 ià(
cÚf_h4_v”
 == 4) {

318 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): MA SAP : %d.%d\n",

319 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
)),

320 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
)));

321 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): MLME SAP : %d.%d\n",

322 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
)),

323 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
)));

324 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): DEBUG SAP : %d.%d\n",

325 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
)),

326 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
)));

327 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): TEST SAP : %d.%d\n",

328 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
)),

329 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
)));

330 } ià(
cÚf_h4_v”
 == 5) {

331 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): MA SAP : %d.%d\n",

332 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_ma_v”
)),

333 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_ma_v”
)));

334 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): MLME SAP : %d.%d\n",

335 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_mlme_v”
)),

336 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_mlme_v”
)));

337 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): DEBUG SAP : %d.%d\n",

338 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_debug_v”
)),

339 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_debug_v”
)));

340 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): TEST SAP : %d.%d\n",

341 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_‹¡_v”
)),

342 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_‹¡_v”
)));

346 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


347 
	`£q_puts
(
m
, "Driver Debug : Enabled\n");

349 
	`£q_puts
(
m
, "Driver Debug : Disabled\n");

351 
	`£q_´štf
(
m
, "Driv” S‹ : %s\n", 
¡©e
);

353 
	`£q_´štf
(
m
, "HW V”siÚ [MIB] : 0x%.4X (%u)\n", 
sdev
->
ch_šfo_mib
.
ch_v”siÚ
, sdev->chip_info_mib.chip_version);

354 
	`£q_´štf
(
m
, "PÏtfÜm Bud [MIB] : 0x%.4X (%u)\n", 
sdev
->
¶©_šfo_mib
.
¶©_bud
, sdev->plat_info_mib.plat_build);

355 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++) {

356 
	`£q_´štf
(
m
, "Hash [MIB%2d] : 0x%.4X (%u)\n", 
i
, 
sdev
->
mib
[i].
mib_hash
, sdev->mib[i].mib_hash);

357 
	`£q_´štf
(
m
, "PÏtfÜm: [MIB%2d] : %s\n", 
i
, 
sdev
->
mib
[i].
¶©fÜm
);

359 
	`£q_´štf
(
m
, "Hash [loÿl_MIB] : 0x%.4X (%u)\n", 
sdev
->
loÿl_mib
.
mib_hash
, sdev->local_mib.mib_hash);

360 
	`£q_´štf
(
m
, "PÏtfÜm: [loÿl_MIB] : %s\n", 
sdev
->
loÿl_mib
.
¶©fÜm
);

363 
	}
}

365 
	$¦si_´ocfs_bud_show
(
£q_fe
 *
m
, *
v
)

367 
	`SLSI_UNUSED_PARAMETER
(
v
);

368 
	`£q_´štf
(
m
, "FAPI_DATA_SAP_VERSION : %d.%d.%d\n",

369 
	`FAPI_MAJOR_VERSION
(
FAPI_DATA_SAP_VERSION
),

370 
	`FAPI_MINOR_VERSION
(
FAPI_DATA_SAP_VERSION
),

371 
FAPI_DATA_SAP_ENG_VERSION
);

372 
	`£q_´štf
(
m
, "FAPI_CONTROL_SAP_VERSION : %d.%d.%d\n",

373 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

374 
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

375 
FAPI_CONTROL_SAP_ENG_VERSION
);

376 
	`£q_´štf
(
m
, "FAPI_DEBUG_SAP_VERSION : %d.%d.%d\n",

377 
	`FAPI_MAJOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
),

378 
	`FAPI_MINOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
),

379 
FAPI_DEBUG_SAP_ENG_VERSION
);

380 
	`£q_´štf
(
m
, "FAPI_TEST_SAP_VERSION : %d.%d.%d\n",

381 
	`FAPI_MAJOR_VERSION
(
FAPI_TEST_SAP_VERSION
),

382 
	`FAPI_MINOR_VERSION
(
FAPI_TEST_SAP_VERSION
),

383 
FAPI_TEST_SAP_ENG_VERSION
);

384 
	`£q_´štf
(
m
, "CONFIG_SCSC_WLAN_MAX_INTERFACES : %d\n", 
CONFIG_SCSC_WLAN_MAX_INTERFACES
);

385 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


386 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI : y\n");

388 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI :‚\n");

390 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


391 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI_GRO : y\n");

393 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI_GRO :‚\n");

395 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


396 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ANDROID : y\n");

398 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ANDROID :‚\n");

400 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


401 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_GSCAN_ENABLE : y\n");

403 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_GSCAN_ENABLE :‚\n");

405 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


406 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD : y\n");

408 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD :‚\n");

410 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


411 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES : y\n");

413 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES :‚\n");

415 
	`£q_puts
(
m
, "-------------------------------------------------\n");

416 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


417 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DEBUG : y\n");

419 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DEBUG :‚\n");

421 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


422 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_MUTEX_DEBUG : y\n");

424 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_MUTEX_DEBUG :‚\n");

426 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


427 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ENHANCED_LOGGING : y\n");

429 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ENHANCED_LOGGING :‚\n");

431 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


432 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_WIFI_SHARING : y\n");

434 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_WIFI_SHARING :‚\n");

436 #ifdeà
CONFIG_SCSC_WLAN_SINGLE_ANTENNA


437 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SINGLE_ANTENNA : y\n");

439 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SINGLE_ANTENNA :‚\n");

441 #ifdeà
CONFIG_SCSC_AP_INTERFACE_NAME


442 
	`£q_´štf
(
m
, "CONFIG_SCSC_AP_INTERFACE_NAME : %s\n", 
CONFIG_SCSC_AP_INTERFACE_NAME
);

444 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


445 
	`£q_puts
(
m
, "CONFIG_SCSC_WIFI_NAN_ENABLE : y\n");

447 
	`£q_puts
(
m
, "CONFIG_SCSC_WIFI_NAN_ENABLE :‚\n");

449 #ifdeà
CONFIG_SCSC_WLAN_RTT


450 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RTT : y\n");

452 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RTT :‚\n");

454 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


455 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA : y\n");

457 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA :‚\n");

459 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

460 
	`£q_puts
(
m
, "CONFIG_SLSI_WLAN_STA_FWD_BEACON : y\n");

462 
	`£q_puts
(
m
, "CONFIG_SLSI_WLAN_STA_FWD_BEACON :‚\n");

464 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


465 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT : y\n");

467 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT :‚\n");

469 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


470 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DYNAMIC_ITO : y\n");

472 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DYNAMIC_ITO :‚\n");

474 #ifdeà
CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY


475 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY : y\n");

477 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY :‚\n");

482 
	}
}

484 cÚ¡ *
	$¦si_´ocfs_vif_ty³_to_¡r
(
u16
 
ty³
)

486 
ty³
) {

487 
FAPI_VIFTYPE_STATION
:

489 
FAPI_VIFTYPE_AP
:

491 
FAPI_VIFTYPE_DISCOVERY
:

493 
FAPI_VIFTYPE_PRECONNECT
:

498 
	}
}

500 
	$¦si_´ocfs_vifs_show
(
£q_fe
 *
m
, *
v
)

502 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

503 
u16
 
vif
;

504 
u16
 
³”_šdex
;

506 
	`SLSI_UNUSED_PARAMETER
(
v
);

508 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

509 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

510 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

511 
Ãtdev_vif
 *
ndev_vif
;

513 ià(!
dev
)

516 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

517 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

519 ià(!
ndev_vif
->
aùiv©ed
) {

520 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

523 
	`£q_´štf
(
m
, "vif:%d %pM %s\n", 
vif
, 
dev
->
dev_addr
, 
	`¦si_´ocfs_vif_ty³_to_¡r
(
ndev_vif
->
vif_ty³
));

524 
³”_šdex
 = 0;…“r_šdex < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
;…eer_index++) {

525 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
³”_šdex
];

527 ià(
³”
 &&…“r->
v®id
)

528 
	`£q_´štf
(
m
, "vif:%d %pM…“r[%d] %pM \n", 
vif
, 
dev
->
dev_addr
, 
³”_šdex
, 
³”
->
add»ss
);

530 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

532 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

535 
	}
}

537 
ssize_t
 
	$¦si_´ocfs_»ad_št
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
, 
v®ue
, cÚ¡ *
exŒa
)

539 
buf
[128];

540 
pos
 = 0;

541 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

543 
	`SLSI_UNUSED_PARAMETER
(
fe
);

545 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
v®ue
);

546 ià(
exŒa
)

547 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%s", 
exŒa
);

548 
	`SLSI_INFO
((
¦si_dev
 *)
fe
->
´iv©e_d©a
, "%s", 
buf
);

549  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

550 
	}
}

552 
ssize_t
 
	$¦si_´ocfs_u­sd_wr™e
(
fe
 *file,

553 cÚ¡ 
__u£r
 *
u£r_buf
,

554 
size_t
 
couÁ
, 
loff_t
 *
µos
)

556 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

557 
Ãt_deviû
 *
dev
 = 
NULL
;

558 
qos_šfo
 = 0;

559 
off£t
 = 0;

560 *
»ad_¡ršg
;

562 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

564 ià(!
dev
) {

565 
	`SLSI_ERR
(
sdev
, "Dev‚ot found\n");

566  -
EINVAL
;

569 ià(!
couÁ
)

570  -
EINVAL
;

572 
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

573 ià(!
»ad_¡ršg
) {

574 
	`SLSI_ERR
(
sdev
, "Malloc for„ead_string failed\n");

575  -
ENOMEM
;

577 
	`mem£t
(
»ad_¡ršg
, 0, (
couÁ
 + 1));

579 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

580 
»ad_¡ršg
[
couÁ
] = '\0';

582 
off£t
 = 
	`k¡¹ošt
(
»ad_¡ršg
, 10, &
qos_šfo
);

583 ià(
off£t
) {

584 
	`SLSI_ERR
(
sdev
, "qos info : failedo„ead‡‚umeric value");

585 
	`kä“
(
»ad_¡ršg
);

586  -
EINVAL
;

590 
sdev
->
deviû_cÚfig
.
qos_šfo
 = qos_info;

591 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "£ˆqos_šfo:%d\n", sdev->
deviû_cÚfig
.
qos_šfo
);

593 
	`kä“
(
»ad_¡ršg
);

594  
couÁ
;

595 
	}
}

597 
ssize_t
 
	$¦si_´ocfs_­_û¹_di§bË_ht_vht_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
,

598 
size_t
 
couÁ
, 
loff_t
 *
µos
)

600 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

601 
off£t
 = 0;

602 
width
 = 0;

603 *
»ad_¡ršg
;

605 ià(!
couÁ
)

606  -
EINVAL
;

608 
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

609 ià(!
»ad_¡ršg
) {

610 
	`SLSI_ERR
(
sdev
, "Malloc for„ead_string failed\n");

611  -
ENOMEM
;

613 
	`mem£t
(
»ad_¡ršg
, 0, (
couÁ
 + 1));

615 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

616 
»ad_¡ršg
[
couÁ
] = '\0';

618 
off£t
 = 
	`k¡¹ošt
(
»ad_¡ršg
, 10, &
width
);

619 ià(
off£t
) {

620 
	`SLSI_ERR
(
sdev
, "Failedo„ead‡‚umeric value");

621 
	`kä“
(
»ad_¡ršg
);

622  -
EINVAL
;

626 ià(
width
 == 80)

627 
sdev
->
®low_sw™ch_80_mhz
 = 
çl£
;

628 ià(
width
 == 40)

629 
sdev
->
®low_sw™ch_40_mhz
 = 
çl£
;

631 
	`kä“
(
»ad_¡ršg
);

632  
couÁ
;

633 
	}
}

635 
ssize_t
 
	$¦si_´ocfs_p2p_û¹if_wr™e
(
fe
 *file,

636 cÚ¡ 
__u£r
 *
u£r_buf
,

637 
size_t
 
couÁ
, 
loff_t
 *
µos
)

639 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

640 *
»ad_¡ršg
;

641 
û¹_šfo
 = 0;

642 
off£t
 = 0;

644 
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

645 ià(!
»ad_¡ršg
) {

646 
	`SLSI_ERR
(
sdev
, "Malloc for„ead_string failed\n");

647  -
ENOMEM
;

649 
	`mem£t
(
»ad_¡ršg
, 0, (
couÁ
 + 1));

651 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

652 
»ad_¡ršg
[
couÁ
] = '\0';

654 
off£t
 = 
	`k¡¹ošt
(
»ad_¡ršg
, 10, &
û¹_šfo
);

655 ià(
off£t
) {

656 
	`SLSI_ERR
(
sdev
, "qos info : failedo„ead‡‚umeric value");

657 
	`kä“
(
»ad_¡ršg
);

658  -
EINVAL
;

660 
sdev
->
p2p_û¹if
 = 
û¹_šfo
;

661 
	`kä“
(
»ad_¡ršg
);

662  
couÁ
;

663 
	}
}

665 
ssize_t
 
	$¦si_´ocfs_p2p_û¹if_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

667 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

668 
buf
[128];

669 
pos
 = 0;

670 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

672 
	`SLSI_UNUSED_PARAMETER
(
fe
);

674 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
sdev
->
p2p_û¹if
);

676  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

677 
	}
}

679 
	$¦si_´ocfs_mac_addr_show
(
£q_fe
 *
m
, *
v
)

681 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

683 
	`SLSI_UNUSED_PARAMETER
(
v
);

685 
	`£q_´štf
(
m
, "%pM", 
sdev
->
hw_addr
);

687 
	}
}

689 
ssize_t
 
	$¦si_´ocfs_ü—‹_t¥ec_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

691 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

692 cÚ¡ *
exŒa_šfo
 = "";

694  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
sdev
->
cu¼’t_t¥ec_id
, 
exŒa_šfo
);

695 
	}
}

697 
ssize_t
 
	$¦si_´ocfs_ü—‹_t¥ec_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

699 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

700 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

702 ià(!
»ad_¡ršg
) {

703 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

704  -
ENOMEM
;

707 ià(!
couÁ
) {

708 
	`kä“
(
»ad_¡ršg
);

712 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

713 
»ad_¡ršg
[
couÁ
] = '\0';

715 
sfdev
->
cu¼’t_t¥ec_id
 = 
	`ÿc_ù¾_ü—‹_t¥ec
(sfdev, 
»ad_¡ršg
);

716 ià(
sfdev
->
cu¼’t_t¥ec_id
 < 0) {

717 
	`SLSI_ERR
(
sfdev
, "createspec: No…arameters or‚ot valid…arameters\n");

718 
	`kä“
(
»ad_¡ršg
);

719  -
EINVAL
;

721 
	`kä“
(
»ad_¡ršg
);

723  
couÁ
;

724 
	}
}

726 
ssize_t
 
	$¦si_´ocfs_cÚfg_t¥ec_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

728 cÚ¡ *
exŒa_šfo
 = "Not implemented yet";

729 
v®ue
 = 10;

731  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
v®ue
, 
exŒa_šfo
);

732 
	}
}

734 
ssize_t
 
	$¦si_´ocfs_cÚfg_t¥ec_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

736 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

737 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

739 ià(!
»ad_¡ršg
) {

740 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

741  -
ENOMEM
;

744 ià(!
couÁ
) {

745 
	`kä“
(
»ad_¡ršg
);

749 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

750 
»ad_¡ršg
[
couÁ
] = '\0';

753 ià(
	`ÿc_ù¾_cÚfig_t¥ec
(
sfdev
, 
»ad_¡ršg
) < 0) {

754 
	`SLSI_ERR
(
sfdev
, "configspecƒrror\n");

755 
	`kä“
(
»ad_¡ršg
);

756  -
EINVAL
;

759 
	`kä“
(
»ad_¡ršg
);

761  
couÁ
;

762 
	}
}

764 
ssize_t
 
	$¦si_´ocfs_£nd_addts_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

766 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

767 cÚ¡ *
exŒa_šfo
 = "";

769  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
sdev
->
t¥ec_”rÜ_code
, 
exŒa_šfo
);

770 
	}
}

772 
ssize_t
 
	$¦si_´ocfs_£nd_addts_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

774 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

775 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

777 ià(!
»ad_¡ršg
) {

778 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

779  -
ENOMEM
;

782 
sfdev
->
t¥ec_”rÜ_code
 = -1;

783 ià(!
couÁ
) {

784 
	`kä“
(
»ad_¡ršg
);

788 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

789 
»ad_¡ršg
[
couÁ
] = '\0';

792 ià(
	`ÿc_ù¾_£nd_addts
(
sfdev
, 
»ad_¡ršg
) < 0) {

793 
	`SLSI_ERR
(
sfdev
, "send‡ddtsƒrror\n");

794 
	`kä“
(
»ad_¡ršg
);

795  -
EINVAL
;

797 
	`kä“
(
»ad_¡ršg
);

798  
couÁ
;

799 
	}
}

801 
ssize_t
 
	$¦si_´ocfs_£nd_d–ts_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

803 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

804 cÚ¡ *
exŒa_šfo
 = "";

806  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
sdev
->
t¥ec_”rÜ_code
, 
exŒa_šfo
);

807 
	}
}

809 
ssize_t
 
	$¦si_´ocfs_£nd_d–ts_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

811 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

812 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

814 ià(!
»ad_¡ršg
) {

815 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

816  -
ENOMEM
;

819 
sfdev
->
t¥ec_”rÜ_code
 = -1;

821 ià(!
couÁ
) {

822 
	`kä“
(
»ad_¡ršg
);

826 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

827 
»ad_¡ršg
[
couÁ
] = '\0';

830 ià(
	`ÿc_ù¾_£nd_d–ts
(
sfdev
, 
»ad_¡ršg
) < 0) {

831 
	`SLSI_ERR
(
sfdev
, "send deltsƒrror\n");

832 
	`kä“
(
»ad_¡ršg
);

833  -
EINVAL
;

835 
	`kä“
(
»ad_¡ršg
);

836  
couÁ
;

837 
	}
}

839 
ssize_t
 
	$¦si_´ocfs_d–_t¥ec_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

841 cÚ¡ *
exŒa_šfo
 = "Not implemented yet";

842 
v®ue
 = 10;

844  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
v®ue
, 
exŒa_šfo
);

845 
	}
}

847 
ssize_t
 
	$¦si_´ocfs_d–_t¥ec_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

849 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

850 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

852 ià(!
»ad_¡ršg
) {

853 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

854  -
ENOMEM
;

857 ià(!
couÁ
) {

858 
	`kä“
(
»ad_¡ršg
);

862 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

863 
»ad_¡ršg
[
couÁ
] = '\0';

866 ià(
	`ÿc_ù¾_d–‘e_t¥ec
(
sfdev
, 
»ad_¡ršg
) < 0) {

867 
	`SLSI_ERR
(
sfdev
, "configspecƒrror\n");

868 
	`kä“
(
»ad_¡ršg
);

869  -
EINVAL
;

871 
	`kä“
(
»ad_¡ršg
);

872  
couÁ
;

873 
	}
}

875 
ssize_t
 
	$¦si_´ocfs_ut_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

877 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

878 
Ãt_deviû
 *
dev
;

879 
Ãtdev_vif
 *
ndev_vif
;

880 
i
;

881 
buf
[256];

882 
pos
 = 0;

883 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

885 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

886 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

887 
dev
 = 
sdev
->
Ãtdev
[
i
];

888 ià(
dev
) {

889 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

890 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%s:\t", 
dev
->
Çme
);

891 ià(
ndev_vif
->
throughput_tx_bps
 < 1000)

892 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX:%u bps\t", 
ndev_vif
->
throughput_tx_bps
);

893 ià((
ndev_vif
->
throughput_tx_bps
 >= 1000) && (ndev_vif->throughput_tx_bps < (1000 * 1000)))

894 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX:%u Kbps\t", (
ndev_vif
->
throughput_tx_bps
 / 1000));

896 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX:%u Mbps\t", (
ndev_vif
->
throughput_tx_bps
 / (1000 * 1000)));

898 ià(
ndev_vif
->
throughput_rx_bps
 < 1000)

899 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX:%u bps\n", 
ndev_vif
->
throughput_rx_bps
);

900 ià((
ndev_vif
->
throughput_rx_bps
 >= 1000) && (ndev_vif->throughput_rx_bps < (1000 * 1000)))

901 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX:%u Kbps\n", (
ndev_vif
->
throughput_rx_bps
 / 1000));

903 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX:%u Mbps\n", (
ndev_vif
->
throughput_rx_bps
 / (1000 * 1000)));

906 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

907  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

908 
	}
}

910 
ssize_t
 
	$¦si_´ocfs_ut_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
Ën
, 
loff_t
 *
µos
)

912 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

913 
»ad_buf
[2];

915 ià(!
sdev
) {

916 
	`SLSI_ERR
(
sdev
, "invalid sdev\n");

917  -
ENOMEM
;

920 ià(!
Ën
 || (ËÀ> (
»ad_buf
))) {

921 
	`SLSI_ERR
(
sdev
, "invalid†en\n");

922  -
EINVAL
;

925 
	`sim¶e_wr™e_to_bufãr
(
»ad_buf
, 
Ën
, 
µos
, 
u£r_buf
,†en);

927 
»ad_buf
[0]) {

929 ià(!
	`¦si_Œaffic_mÚ_is_ruÂšg
(
sdev
)) {

930 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "start Traffic monitor\n");

931 
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, sdev, 0, 0, 0, 
NULL
);

935 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "stop Traffic monitor\n");

936 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, sdev);

939 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "šv®id v®u%c\n", 
»ad_buf
[0]);

940  -
EINVAL
;

942  
Ën
;

943 
	}
}

945 
©omic_t
 
	gfd_İ’ed_couÁ
;

947 
	$¦si_´ocfs_šc_node
()

949 
	`©omic_šc
(&
fd_İ’ed_couÁ
);

950 
	}
}

952 
	$¦si_´ocfs_dec_node
()

954 ià(0 =ğ
	`©omic_»ad
(&
fd_İ’ed_couÁ
)) {

955 
	`WARN_ON
(1);

958 
	`©omic_dec
(&
fd_İ’ed_couÁ
);

959 
	}
}

961 
ssize_t
 
	$¦si_´ocfs_fd_İ’ed_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

963 
buf
[128];

964 
pos
 = 0;

965 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

967 
	`SLSI_UNUSED_PARAMETER
(
fe
);

969 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
	`©omic_»ad
(&
fd_İ’ed_couÁ
));

971  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

972 
	}
}

974 #iâdeà
CONFIG_SCSC_WLAN_TX_API


975 
	$¦si_´ocfs_fcq_show
(
£q_fe
 *
m
, *
v
)

977 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

978 
ac
;

979 
s32
 
vif
, 
i
;

981 
	`SLSI_UNUSED_PARAMETER
(
v
);

983 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

984 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

985 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

986 
Ãtdev_vif
 *
ndev_vif
;

988 ià(!
dev
)

991 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

992 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

995 
i
 = 0; i < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; i++) {

996 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

997 
smod
 = 0, 
scod
 = 0, 
qmod
 = 0, 
qcod
 = 0;

998 
scsc_wifi_fcq_q_¡©
 
queue_¡©
;

999 
u32
 
³”_ps_¡©e_Œªs™iÚs
 = 0;

1000 
scsc_wifi_fcq_8021x_¡©e
 
ı_¡©e
;

1002 ià(!
³”
 || !³”->
v®id
)

1005 ià(
	`scsc_wifi_fcq_¡©_queue£t
(&
³”
->
d©a_qs
, &
queue_¡©
, &
smod
, &
scod
, &
ı_¡©e
, &
³”_ps_¡©e_Œªs™iÚs
) != 0)

1008 
	`£q_´štf
(
m
, "Interface: %-12s (vif: %d,ype: %s)\n#%d\t|peer: %pM, qs: %2d, smod: %u, scod: %u,‚et_q_stops:%u,‚et_q_resumes:%u, PSransitions: %u, Controlled…ort: %s\n",

1009 
	`Ãtdev_Çme
(
dev
),

1010 
vif
,

1012 
i
 + 1,

1013 
³”
->
add»ss
,

1014 
³”
->
queue£t
,

1015 
smod
,

1016 
scod
,

1017 
queue_¡©
.
Ãtq_¡İs
,

1018 
queue_¡©
.
Ãtq_»sumes
,

1019 
³”_ps_¡©e_Œªs™iÚs
,

1020 
ı_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
 ? "Blocked" : "Opened");

1022 
	`£q_´štf
(
m
, "\t|%8s|%8s|%8s|%8s|%8s|%8s|%8s|\n",

1027 
ac
 = 0;‡ø< 
SLSI_NETIF_Q_PER_PEER
;‡c++) {

1028 ià(
	`scsc_wifi_fcq_¡©_queue
(&
³”
->
d©a_qs
.
ac_q
[
ac
].
h—d
,

1029 &
queue_¡©
,

1030 &
qmod
, &
qcod
) == 0)

1031 
	`£q_´štf
(
m
, "\t|%8d|%8u|%8u|%8u|%8u|%8u|%8u%%\n",

1032 
ac
,

1033 
qcod
,

1034 
qmod
,

1035 
queue_¡©
.
Ãtq_¡©e
,

1036 
queue_¡©
.
Ãtq_¡İs
,

1037 
queue_¡©
.
Ãtq_»sumes
,

1038 
queue_¡©
.
Ãtq_¡İ_³rûÁ
);

1045 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

1046 
smod
 = 0, 
scod
 = 0, 
qmod
 = 0, 
qcod
 = 0;

1047 
scsc_wifi_fcq_q_¡©
 
queue_¡©
;

1048 
u32
 
³”_ps_¡©e_Œªs™iÚs
 = 0;

1049 
scsc_wifi_fcq_8021x_¡©e
 
ı_¡©e
;

1051 ià(
	`scsc_wifi_fcq_¡©_queue£t
(&
ndev_vif
->
­
.
group_d©a_qs
, &
queue_¡©
, &
smod
, &
scod
, &
ı_¡©e
, &
³”_ps_¡©e_Œªs™iÚs
) != 0) {

1052 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1056 
	`£q_´štf
(
m
, "|%-12s|%-6d|%-6s|\n%d). smod:%u, scod:%u,‚etq stops :%u,‚etq„esumes :%u, PSransitions :%u Controlled…ort :%s\n",

1057 
	`Ãtdev_Çme
(
dev
),

1058 
vif
,

1060 
i
 + 1,

1061 
smod
,

1062 
scod
,

1063 
queue_¡©
.
Ãtq_¡İs
,

1064 
queue_¡©
.
Ãtq_»sumes
,

1065 
³”_ps_¡©e_Œªs™iÚs
,

1066 
ı_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
 ? "Blocked" : "Opened");

1068 
	`£q_´štf
(
m
, " |%-12s|%4s|%8s|%8s|%8s|%8s|%10s|%8s|\n",

1074 
ac
 = 0;‡ø< 
SLSI_NETIF_Q_PER_PEER
;‡c++) {

1075 ià(
	`scsc_wifi_fcq_¡©_queue
(&
ndev_vif
->
­
.
group_d©a_qs
.
ac_q
[
ac
].
h—d
,

1076 &
queue_¡©
,

1077 &
qmod
, &
qcod
) == 0)

1078 
	`£q_´štf
(
m
, " |%-12s|%4d|%8u|%8u|%8u|%8u\n",

1079 
	`Ãtdev_Çme
(
dev
),

1080 
ac
,

1081 
qcod
,

1082 
qmod
,

1083 
queue_¡©
.
Ãtq_¡İs
,

1084 
queue_¡©
.
Ãtq_»sumes
);

1089 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1092 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1095 
	}
}

1098 
	$¦si_´ocfs_ba_¡©s_show
(
£q_fe
 *
m
, *
v
)

1100 
¦si_dev
 *
sdev
 = (¦si_dev *è
m
->
´iv©e
;

1101 
Ãt_deviû
 *
dev
;

1102 
Ãtdev_vif
 *
ndev_vif
;

1103 
u8
 
i
, 
j
, 
k
;

1105 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1106 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

1107 
dev
 = 
sdev
->
Ãtdev
[
i
];

1108 ià(
dev
) {

1109 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1110 
j
 = 0; j < (
SLSI_ADHOC_PEER_CONNECTIONS_MAX
); j++) {

1111 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
j
];

1113 ià(
³”
 &&…“r->
v®id
) {

1114 
k
 = 0; k < 
NUM_BA_SESSIONS_PER_PEER
; k++)

1115 ià(
³”
->
ba_£ssiÚ_rx
[
k
] &&…“r->ba_£ssiÚ_rx[k]->
aùive
) {

1116 
	`£q_´štf
(
m
, "%s:…“r=%pm,id=%d\n", 
dev
->
Çme
, 
³”
->
add»ss
,…“r->
ba_£ssiÚ_rx
[
k
]->
tid
);

1117 
	`£q_´štf
(
m
, "ba_timeouts=%d, ba_drops_old=%d, ba_drops_replay=%d\n",

1118 
³”
->
ba_£ssiÚ_rx
[
k
]->
ba_timeouts
,

1119 
³”
->
ba_£ssiÚ_rx
[
k
]->
ba_drİs_Şd
,

1120 
³”
->
ba_£ssiÚ_rx
[
k
]->
ba_drİs_»¶ay
);

1126 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1128 
	}
}

1130 
	$¦si_´ocfs_tı_ack_suµ»ssiÚ_show
(
£q_fe
 *
m
, *
v
)

1132 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

1133 
Ãt_deviû
 *
dev
;

1134 
Ãtdev_vif
 *
ndev_vif
;

1135 
i
;

1137 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1138 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

1139 
dev
 = 
sdev
->
Ãtdev
[
i
];

1140 ià(
dev
) {

1141 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1143 
	`£q_´štf
(
m
, "%s:ack_acks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_acks
);

1144 
	`£q_´štf
(
m
, "%s:ack_suµ»s£d=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_suµ»s£d
);

1145 
	`£q_´štf
(
m
, "%s:ack_£Á=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
);

1146 
	`£q_´štf
(
m
, "%s:ack_max=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_max
);

1147 
	`£q_´štf
(
m
, "%s:ack_timeout=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_timeout
);

1148 
	`£q_´štf
(
m
, "%s:ack_aged=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_ktime
);

1149 
	`£q_´štf
(
m
, "%s:ack_dacks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_dacks
);

1150 
	`£q_´štf
(
m
, "%s:ack_§cks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_§cks
);

1151 
	`£q_´štf
(
m
, "%s:ack_d–ay_acks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_d–ay_acks
);

1152 
	`£q_´štf
(
m
, "%s:ack_low_wšdow=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_low_wšdow
);

1153 
	`£q_´štf
(
m
, "%s:ack_eû=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_eû
);

1154 
	`£q_´štf
(
m
, "%s:ack_noÿche=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_noÿche
);

1155 
	`£q_´štf
(
m
, "%s:ack_nÜecÜd=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_nÜecÜd
);

1156 
	`£q_´štf
(
m
, "%s:ack_Ï¡»cÜd=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_Ï¡»cÜd
);

1157 
	`£q_´štf
(
m
, "%s:ack_£¬ch»cÜd=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_£¬ch»cÜd
);

1158 
	`£q_´štf
(
m
, "%s:ack_hasd©a=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_hasd©a
);

1159 
	`£q_´štf
(
m
, "%s:ack_psh=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_psh
);

1160 
	`£q_´štf
(
m
, "%s:ack_drİ³d=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_drİ³d
);

1163 
	`mem£t
(&
ndev_vif
->
tı_ack_¡©s
, 0, (
¦si_tı_ack_¡©s
));

1166 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1168 
	}
}

1170 
ssize_t
 
	$¦si_´ocfs_Çn_mac_addr_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1172 
buf
[20];

1173 
Çn_mac
[
ETH_ALEN
];

1174 
pos
 = 0;

1175 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1176 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1178 
	`¦si_Çn_g‘_mac
(
sdev
, 
Çn_mac
);

1181 
	`SLSI_UNUSED_PARAMETER
(
fe
);

1182 
	`mem£t
(
Çn_mac
, 0, 
ETH_ALEN
);

1184 
pos
 = 
	`sú´štf
(
buf
, (buf), "%pM", 
Çn_mac
);

1185  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

1186 
	}
}

1188 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1189 
ssize_t
 
	$¦si_´ocfs_Çn_šfo_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1191 
buf
[300];

1192 
pos
 = 0;

1193 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

1194 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1195 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1196 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1197 
¦si_vif_Çn
 *
Çn_d©a
;

1199 
	`SLSI_UNUSED_PARAMETER
(
fe
);

1201 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1202 
Çn_d©a
 = &
ndev_vif
->
Çn
;

1203 
	`mem£t
(
buf
, 0, (buf));

1205 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "NANMACADDRESS,");

1206 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%pM", 
Çn_d©a
->
loÿl_nmi
);

1207 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, ",CLUSTERID,");

1208 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%pM", 
sdev
->
Çn_şu¡”_id
);

1209 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, ",OPERATINGCHANNEL,");

1210 ià(
Çn_d©a
->
İ”©šg_chªÃl
[0])

1211 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d ", 
Çn_d©a
->
İ”©šg_chªÃl
[0]);

1212 ià(
Çn_d©a
->
İ”©šg_chªÃl
[1])

1213 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
İ”©šg_chªÃl
[1]);

1214 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",ROLE,");

1215 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
rŞe
);

1216 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",STATE,");

1217 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
¡©e
);

1218 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",MASTERPREFVAL,");

1219 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
ma¡”_´ef_v®ue
);

1220 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",AMR,");

1221 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "0x%08x%08x", 
Çn_d©a
->
amr_high”
,

1222 
Çn_d©a
->
amr_low”
);

1223 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",HOPCOUNT,");

1224 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
hİcouÁ
);

1225 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",NMIRANDOMINTERVAL,");

1226 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
¿ndom_mac_š‹rv®_£c
);

1228 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1229  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

1230 
	}
}

1232 
ssize_t
 
	$¦si_´ocfs_Çn_di§bË_şu¡”_m”ge_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
Ën
,

1233 
loff_t
 *
µos
)

1235 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1236 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1237 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1238 
»ad_¡ršg
[3];

1239 
v®
, 
»t
;

1241 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, Ô—d_¡ršg), 
µos
, 
u£r_buf
, (read_string) - 1);

1242 
»ad_¡ršg
[(read_string) - 1] = '\0';

1244 ià(
	`¡¹ošt
(
»ad_¡ršg
, &
v®
)) {

1245 
	`SLSI_ERR
(
sdev
, "šv®id iÅuˆ%s\n", 
»ad_¡ršg
);

1246 
»t
 = -
EINVAL
;

1248 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 
v®
 ? 1 : 0;

1249 
»t
 = (
»ad_¡ršg
) - 1;

1252  
»t
;

1253 
	}
}

1255 
ssize_t
 
	$¦si_´ocfs_Çn_discov”y_d©a_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1257 
buf
[500];

1258 
pos
 = 0;

1259 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

1260 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1261 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1262 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1263 
¦si_vif_Çn
 *
Çn_d©a
;

1264 
¦si_Çn_discov”y_šfo
 *
Œav”£
;

1266 
	`SLSI_UNUSED_PARAMETER
(
fe
);

1268 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1269 
Çn_d©a
 = &
ndev_vif
->
Çn
;

1270 
	`mem£t
(
buf
, 0, (buf));

1271 
Œav”£
 = 
Çn_d©a
->
disc_šfo
;

1273 
Œav”£
) {

1274 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%pM,", 
Çn_d©a
->
disc_šfo
->
³”_addr
);

1275 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
Çn_d©a
->
disc_šfo
->
m©ch_id
);

1276 
Œav”£
 =¿v”£->
Ãxt
;

1278 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1279  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

1280 
	}
}

1284 
ssize_t
 
	$¦si_´ocfs_dsı_m­pšg_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1286 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

1287 
	#DSCP_MAP
 "0,8,40,56"

	)

1289 
	#DSCP_MAP
 "24,8,40,56"

	)

1291  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
DSCP_MAP
, 
	`¡¾’
(DSCP_MAP));

1292 
	}
}

1294 
SLSI_PROCFS_SEQ_FILE_OPS
(
vifs
);

1295 
SLSI_PROCFS_SEQ_FILE_OPS
(
mac_addr
);

1296 
SLSI_PROCFS_WRITE_FILE_OPS
(
u­sd
);

1297 
SLSI_PROCFS_WRITE_FILE_OPS
(
­_û¹_di§bË_ht_vht
);

1298 #ifdeà
CONFIG_SCSC_WLAN_LOG_2_USER_SP


1299 
SLSI_PROCFS_WRITE_FILE_OPS
(
cÚn_log_ev’t_bur¡_to_us
);

1301 
SLSI_PROCFS_RW_FILE_OPS
(
p2p_û¹if
);

1302 
SLSI_PROCFS_RW_FILE_OPS
(
ü—‹_t¥ec
);

1303 
SLSI_PROCFS_RW_FILE_OPS
(
cÚfg_t¥ec
);

1304 
SLSI_PROCFS_RW_FILE_OPS
(
£nd_addts
);

1305 
SLSI_PROCFS_RW_FILE_OPS
(
£nd_d–ts
);

1306 
SLSI_PROCFS_RW_FILE_OPS
(
d–_t¥ec
);

1307 
SLSI_PROCFS_RW_FILE_OPS
(
ut
);

1308 
SLSI_PROCFS_READ_FILE_OPS
(
fd_İ’ed
);

1309 
SLSI_PROCFS_SEQ_FILE_OPS
(
bud
);

1310 
SLSI_PROCFS_SEQ_FILE_OPS
(
¡©us
);

1311 #iâdeà
CONFIG_SCSC_WLAN_TX_API


1312 
SLSI_PROCFS_SEQ_FILE_OPS
(
fcq
);

1314 
SLSI_PROCFS_SEQ_FILE_OPS
(
ba_¡©s
);

1315 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1316 
SLSI_PROCFS_READ_FILE_OPS
(
mu‹x_¡©s
);

1318 
SLSI_PROCFS_READ_FILE_OPS
(
¡a_bss
);

1319 
SLSI_PROCFS_READ_FILE_OPS
(
big_d©a
);

1320 
SLSI_PROCFS_READ_FILE_OPS
(
throughput_¡©s
);

1321 
SLSI_PROCFS_SEQ_FILE_OPS
(
tı_ack_suµ»ssiÚ
);

1322 
SLSI_PROCFS_READ_FILE_OPS
(
Çn_mac_addr
);

1323 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1324 
SLSI_PROCFS_READ_FILE_OPS
(
Çn_šfo
);

1325 
SLSI_PROCFS_WRITE_FILE_OPS
(
Çn_di§bË_şu¡”_m”ge
);

1326 
SLSI_PROCFS_READ_FILE_OPS
(
Çn_discov”y_d©a
);

1329 
SLSI_PROCFS_READ_FILE_OPS
(
dsı_m­pšg
);

1331 
	$¦si_ü—‹_´oc_dœ
(
¦si_dev
 *
sdev
)

1333 
dœ
[16];

1334 
´oc_dœ_’Œy
 *
·»Á
;

1336 ()
	`¢´štf
(
dœ
, (dœ), "driv”/unifi%d", 
sdev
->
´ocfs_š¡ªû
);

1337 
·»Á
 = 
	`´oc_mkdœ
(
dœ
, 
NULL
);

1338 ià(
·»Á
) {

1339 
sdev
->
´ocfs_dœ
 = 
·»Á
;

1341 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
bud
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1342 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
¡©us
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1343 #iâdeà
CONFIG_SCSC_WLAN_TX_API


1344 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
fcq
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1346 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
ba_¡©s
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1347 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
vifs
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
);

1348 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
mac_addr
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1349 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
u­sd
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1350 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
­_û¹_di§bË_ht_vht
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1351 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
p2p_û¹if
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1352 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
ü—‹_t¥ec
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1353 #ifdeà
CONFIG_SCSC_WLAN_LOG_2_USER_SP


1354 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
cÚn_log_ev’t_bur¡_to_us
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1356 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
cÚfg_t¥ec
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1357 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
£nd_addts
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1358 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
£nd_d–ts
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1359 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
d–_t¥ec
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1360 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
ut
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1361 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
fd_İ’ed
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1362 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1363 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
mu‹x_¡©s
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1365 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
¡a_bss
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1366 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
big_d©a
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1367 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
throughput_¡©s
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1368 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
tı_ack_suµ»ssiÚ
, sdev->
´ocfs_dœ
, 
S_IRUSR
 | 
S_IRGRP
);

1369 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_mac_addr
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1370 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1371 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_šfo
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1372 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_di§bË_şu¡”_m”ge
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1373 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_discov”y_d©a
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1375 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
dsı_m­pšg
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1379 
”r
:

1380 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "Failure in creation of…roc directories\n");

1381  -
EINVAL
;

1382 
	}
}

1384 
	$¦si_»move_´oc_dœ
(
¦si_dev
 *
sdev
)

1386 ià(
sdev
->
´ocfs_dœ
) {

1387 
dœ
[32];

1389 
	`SLSI_PROCFS_REMOVE_FILE
(
bud
, 
sdev
->
´ocfs_dœ
);

1390 
	`SLSI_PROCFS_REMOVE_FILE
(
¡©us
, 
sdev
->
´ocfs_dœ
);

1391 
	`SLSI_PROCFS_REMOVE_FILE
(
vifs
, 
sdev
->
´ocfs_dœ
);

1392 
	`SLSI_PROCFS_REMOVE_FILE
(
mac_addr
, 
sdev
->
´ocfs_dœ
);

1393 
	`SLSI_PROCFS_REMOVE_FILE
(
fcq
, 
sdev
->
´ocfs_dœ
);

1394 
	`SLSI_PROCFS_REMOVE_FILE
(
ba_¡©s
, 
sdev
->
´ocfs_dœ
);

1395 
	`SLSI_PROCFS_REMOVE_FILE
(
u­sd
, 
sdev
->
´ocfs_dœ
);

1396 
	`SLSI_PROCFS_REMOVE_FILE
(
­_û¹_di§bË_ht_vht
, 
sdev
->
´ocfs_dœ
);

1397 
	`SLSI_PROCFS_REMOVE_FILE
(
p2p_û¹if
, 
sdev
->
´ocfs_dœ
);

1398 
	`SLSI_PROCFS_REMOVE_FILE
(
ü—‹_t¥ec
, 
sdev
->
´ocfs_dœ
);

1399 #ifdeà
CONFIG_SCSC_WLAN_LOG_2_USER_SP


1400 
	`SLSI_PROCFS_REMOVE_FILE
(
cÚn_log_ev’t_bur¡_to_us
, 
sdev
->
´ocfs_dœ
);

1402 
	`SLSI_PROCFS_REMOVE_FILE
(
cÚfg_t¥ec
, 
sdev
->
´ocfs_dœ
);

1403 
	`SLSI_PROCFS_REMOVE_FILE
(
£nd_addts
, 
sdev
->
´ocfs_dœ
);

1404 
	`SLSI_PROCFS_REMOVE_FILE
(
£nd_d–ts
, 
sdev
->
´ocfs_dœ
);

1405 
	`SLSI_PROCFS_REMOVE_FILE
(
d–_t¥ec
, 
sdev
->
´ocfs_dœ
);

1406 
	`SLSI_PROCFS_REMOVE_FILE
(
ut
, 
sdev
->
´ocfs_dœ
);

1407 
	`SLSI_PROCFS_REMOVE_FILE
(
fd_İ’ed
, 
sdev
->
´ocfs_dœ
);

1408 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1409 
	`SLSI_PROCFS_REMOVE_FILE
(
mu‹x_¡©s
, 
sdev
->
´ocfs_dœ
);

1411 
	`SLSI_PROCFS_REMOVE_FILE
(
¡a_bss
, 
sdev
->
´ocfs_dœ
);

1412 
	`SLSI_PROCFS_REMOVE_FILE
(
big_d©a
, 
sdev
->
´ocfs_dœ
);

1413 
	`SLSI_PROCFS_REMOVE_FILE
(
throughput_¡©s
, 
sdev
->
´ocfs_dœ
);

1414 
	`SLSI_PROCFS_REMOVE_FILE
(
tı_ack_suµ»ssiÚ
, 
sdev
->
´ocfs_dœ
);

1415 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_mac_addr
, 
sdev
->
´ocfs_dœ
);

1416 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1417 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_šfo
, 
sdev
->
´ocfs_dœ
);

1418 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_di§bË_şu¡”_m”ge
, 
sdev
->
´ocfs_dœ
);

1419 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_discov”y_d©a
, 
sdev
->
´ocfs_dœ
);

1421 
	`SLSI_PROCFS_REMOVE_FILE
(
dsı_m­pšg
, 
sdev
->
´ocfs_dœ
);

1422 ()
	`¢´štf
(
dœ
, (dœ), "driv”/unifi%d", 
sdev
->
´ocfs_š¡ªû
);

1423 
	`»move_´oc_’Œy
(
dœ
, 
NULL
);

1424 
sdev
->
´ocfs_dœ
 = 
NULL
;

1426 
	}
}

	@procfs.h

7 #iâdeà
__SLSI_PROCFS_H__


8 
	#__SLSI_PROCFS_H__


	)

10 
	~<lšux/v”siÚ.h
>

11 
	~<lšux/´oc_fs.h
>

12 
	~<lšux/£q_fe.h
>

13 
	~<lšux/”ºo.h
>

15 
	g¦si_dev
;

16 
	g¦si_vif
;

18 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


19 #iâdeà
AID_WIFI


20 
	#AID_WIFI
 1010

	)

23 
	#SLSI_PROCFS_SET_UID_GID
(
_’Œy
) \

25 
kuid_t
 
´oc_kuid
 = 
	`KUIDT_INIT
(
AID_WIFI
); \

26 
kgid_t
 
´oc_kgid
 = 
	`KGIDT_INIT
(
AID_WIFI
); \

27 
	`´oc_£t_u£r
(
_’Œy
, 
´oc_kuid
, 
´oc_kgid
); \

28 } 0)

	)

30 
	#SLSI_PROCFS_SET_UID_GID
(
’Œy
)

	)

33 
	#SLSI_PDE_DATA
(
šode
è
	`PDE_DATA
(šode)

	)

36 
¦si_ü—‹_´oc_dœ
(
¦si_dev
 *
sdev
);

37 
¦si_»move_´oc_dœ
(
¦si_dev
 *
sdev
);

39 
¦si_´ocfs_İ’_fe_g’”ic
(
šode
 *šode, 
fe
 *file);

41 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 6, 0))

42 
	#SLSI_PROCFS_SEQ_FILE_OPS
(
Çme
) \

43 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_show
(
£q_fe
 *
m
, *
v
); \

44 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_İ’
(
šode
 *šode, 
fe
 *file) \

46  
	`sšgË_İ’
(
fe
, 
¦si_´ocfs_
 ## 
Çme
 ## 
_show
, 
	`SLSI_PDE_DATA
(
šode
)); \

48 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

49 .
´oc_İ’
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_İ’
, \

50 .
´oc_»ad
 = 
£q_»ad
, \

51 .
´oc_l£ek
 = 
£q_l£ek
, \

52 .
´oc_»Ëa£
 = 
sšgË_»Ëa£
, \

53 }

	)

55 
	#SLSI_PROCFS_SEQ_FILE_OPS
(
Çme
) \

56 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_show
(
£q_fe
 *
m
, *
v
); \

57 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_İ’
(
šode
 *šode, 
fe
 *file) \

59  
	`sšgË_İ’
(
fe
, 
¦si_´ocfs_
 ## 
Çme
 ## 
_show
, 
	`SLSI_PDE_DATA
(
šode
)); \

61 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

62 .
İ’
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_İ’
, \

63 .
»ad
 = 
£q_»ad
, \

64 .
Î£ek
 = 
£q_l£ek
, \

65 .
»Ëa£
 = 
sšgË_»Ëa£
, \

66 }

	)

68 
	#SLSI_PROCFS_SEQ_ADD_FILE
(
_sdev
, 
Çme
, 
·»Á
, 
mode
) \

70 
´oc_dœ_’Œy
 *
’Œy
; \

71 
’Œy
 = 
	`´oc_ü—‹_d©a
(#Çme, 
mode
, 
·»Á
, &
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
, 
_sdev
); \

72 ià(!
’Œy
) { \

73 
”r
; \

75 
	`SLSI_PROCFS_SET_UID_GID
(
’Œy
); \

76 } 0)

	)

78 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 6, 0))

79 
	#SLSI_PROCFS_READ_FILE_OPS
(
Çme
) \

80 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

81 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

82 .
´oc_»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

83 .
´oc_İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

84 .
´oc_l£ek
 = 
g’”ic_fe_Î£ek
 \

85 }

	)

87 
	#SLSI_PROCFS_WRITE_FILE_OPS
(
Çme
) \

88 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

89 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

90 .
´oc_wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

91 .
´oc_İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

92 .
´oc_l£ek
 = 
g’”ic_fe_Î£ek
 \

93 }

	)

95 
	#SLSI_PROCFS_RW_FILE_OPS
(
Çme
) \

96 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

97 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

98 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

99 .
´oc_»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

100 .
´oc_wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

101 .
´oc_İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

102 .
´oc_l£ek
 = 
g’”ic_fe_Î£ek
 \

103 }

	)

105 
	#SLSI_PROCFS_READ_FILE_OPS
(
Çme
) \

106 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

107 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

108 .
»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

109 .
İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

110 .
Î£ek
 = 
g’”ic_fe_Î£ek
 \

111 }

	)

113 
	#SLSI_PROCFS_WRITE_FILE_OPS
(
Çme
) \

114 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

115 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

116 .
wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

117 .
İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

118 .
Î£ek
 = 
g’”ic_fe_Î£ek
 \

119 }

	)

121 
	#SLSI_PROCFS_RW_FILE_OPS
(
Çme
) \

122 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

123 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

124 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

125 .
»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

126 .
wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

127 .
İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

128 .
Î£ek
 = 
g’”ic_fe_Î£ek
 \

129 }

	)

131 
	#SLSI_PROCFS_ADD_FILE
(
_sdev
, 
Çme
, 
·»Á
, 
mode
) \

133 
´oc_dœ_’Œy
 *
’Œy
 = 
	`´oc_ü—‹_d©a
(#Çme, 
mode
, 
·»Á
, &
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
, 
_sdev
); \

134 
	`SLSI_PROCFS_SET_UID_GID
(
’Œy
); \

135 } 0)

	)

136 
	#SLSI_PROCFS_REMOVE_FILE
(
Çme
, 
·»Á
è
	`»move_´oc_’Œy
(#Çme,…¬’t)

	)

138 
¦si_´ocfs_šc_node
();

139 
¦si_´ocfs_dec_node
();

	@qsfs.c

7 
	~<lšux/fs.h
>

9 
	~"mgt.h
"

10 
	~"dev.h
"

11 
	~"debug.h
"

12 
	~"qsfs.h
"

13 
	~"mib.h
"

14 
	~"mlme.h
"

16 *
	gsŞ_Çme
 = "SLS";

17 
moduË_·¿m
(
sŞ_Çme
, 
ch¬p
, 0444);

18 
MODULE_PARM_DESC
(
sŞ_Çme
, "Solution Provider Name");

20 
ssize_t
 
sysfs_show_qsf
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
, *
buf
);

21 
kobj_©Œibu‹
 
	gqsf_©Œ
 = 
__ATTR
(
ã©u»
, 0400, 
sysfs_show_qsf
, 
NULL
);

22 
kobjeù
 *
	gwifi_kobj_»f
;

24 
	$¦si_qsf_g‘_wifi_fw_ã©u»_v”siÚ
(
¦si_dev
 *
sdev
, 
u32
 *
fw_v”
)

26 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

27 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

28 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_QSFS_VERION
, { 0, 0 } },};

29 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

30 
r
 = 0;

32 
r
 = 
	`mx140_fe_»que¡_cÚf
(
sdev
->
maxw–l_cÜe
, &
e
, "wÏn", 
SLSI_QSF_WIFI_HCF_FILE_NAME
);

33 ià(
r
 || !
e
) {

34 
	`SLSI_ERR
(
sdev
, "HCF f»ad faed‡ f% i NOT found\n", 
SLSI_QSF_WIFI_HCF_FILE_NAME
);

37 
mibr¥
.
d©aL’gth
 = 
e
->
size
 - 
SLSI_HCF_HEADER_LEN
;

38 
mibr¥
.
d©a
 = (
u8
 *)
e
->d©¨+ 
SLSI_HCF_HEADER_LEN
;

39 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
, 
	`ARRAY_SIZE
(
g‘_v®ues
), get_values);

40 ià(!
v®ues
) {

41 
	`SLSI_ERR
(
sdev
, "QSFS mib decode failed„eturned values‡s NULL\n");

42 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

46 *
fw_v”
 = 
v®ues
[0].
u
.
uštV®ue
;

47 
	`kä“
(
v®ues
);

48 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

50 
	}
}

52 
	$¦si_qsf_š™
(
¦si_dev
 *
sdev
)

54 
r
 = 0;

56 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

57 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

59 ià(!
wifi_kobj_»f
)

62 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
qsf_©Œ
.
©Œ
);

63 ià(
r
) {

64 
	`´_”r
("Can't create /sys/wifi/feature\n");

65 
	`mxmª_wifi_kobjeù_»f_put
();

67 
	}
}

69 
	$¦si_qsf_deš™
()

71 ià(!
wifi_kobj_»f
)

74 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
qsf_©Œ
.
©Œ
);

75 
	`mxmª_wifi_kobjeù_»f_put
();

76 
	}
}

78 
u8
 
	$¦si_g‘_wifi_¡ªd¬d
(
¦si_dev
 *
sdev
)

80 ià(
sdev
->
fw_vht_’abËd
)

81  
SLSI_WIFI_5
;

83 ià(
sdev
->
fw_ht_’abËd
)

84  
SLSI_WIFI_4
;

86 
	}
}

88 
u32
 
	$¦si_g‘_ª‹Âa_äom_ht_ÿps
(
u8
 *
ÿps
)

90 
u8
 
max_nss
 = 0;

92 ià(
	`SLSI_SUPPORTED_TX_MCS_PRESENT_AND_TXRX_MCS_NOT_EQUAL
(
ÿps
) == 3)

93 
max_nss
 = 
	`SLSI_GET_NSS_FROM_HT_CAPS
(
ÿps
);

97 
max_nss
) {

109 
	}
}

111 
u8
 
	$¦si_g‘_nss_äom_mcs_nss_m­
(
u16
 
mcs_m­
)

113 ià(
	`SLSI_MAX_MCS_8NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

115 ià(
	`SLSI_MAX_MCS_7NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

117 ià(
	`SLSI_MAX_MCS_6NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

119 ià(
	`SLSI_MAX_MCS_5NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

121 ià(
	`SLSI_MAX_MCS_4NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

123 ià(
	`SLSI_MAX_MCS_3NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

125 ià(
	`SLSI_MAX_MCS_2NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

127 ià(
	`SLSI_MAX_MCS_1NSS
(
mcs_m­
è!ğ
SLSI_MAX_NSS_NOT_SUPPORTED
)

131 
	}
}

133 
u32
 
	$¦si_g‘_ª‹Âa_äom_vht_ÿps
(
u8
 *
ÿps
)

135 
u16
 
rx_vht_mcs_m­
 = 0, 
tx_vht_mcs_m­
 = 0;

136 
u8
 
tx_max_nss
 = 0, 
rx_max_nss
 = 0;

138 
rx_vht_mcs_m­
 = 
	`SLSI_GET_VHT_RX_MCS_MAP
(
ÿps
);

139 
tx_vht_mcs_m­
 = 
	`SLSI_GET_VHT_TX_MCS_MAP
(
ÿps
);

141 
tx_max_nss
 = 
	`¦si_g‘_nss_äom_mcs_nss_m­
(
tx_vht_mcs_m­
);

142 
rx_max_nss
 = 
	`¦si_g‘_nss_äom_mcs_nss_m­
(
rx_vht_mcs_m­
);

144 ià(
tx_max_nss
 =ğ0 && 
rx_max_nss
 == 0)

146  
	`max
(
tx_max_nss
, 
rx_max_nss
);

147 
	}
}

149 
u32
 
	$¦si_qsf_’code_hw_ã©u»
(
¦si_dev
 *
sdev
, 
u8
 *
misc_ã©u»s_aùiv©ed
,

150 
boŞ
 
he_aùive
, *
buf
, 
u32
 
by‹s
, u32 
buf_size
,

151 
u8
 *
he_ÿps
, u8 *
vht_ÿps
, u8 *
ht_ÿps
)

153 
u8
 
wifi_¡ªd¬d
 = 0;

154 
u32
 
hw_ã©u»
 = 0;

155 
u8
 
low_rx_cÜe
 = 0;

156 
u32
 
maš_cÜes
 = 0;

157 
u32
 
ª‹Âa
 = 0;

158 
u32
 
hw_ã©u»_Ën
 = 4;

160 
wifi_¡ªd¬d
 = 
	`¦si_g‘_wifi_¡ªd¬d
(
sdev
);

161 ià(
wifi_¡ªd¬d
 <ğ
SLSI_WIFI_5
) {

162 
	`SLSI_QSF_SET_WIFI_STANDARD
(
hw_ã©u»
, 
wifi_¡ªd¬d
);

164 
	`SLSI_ERR
(
sdev
, "E¼Ü whg‘tšg wifi_¡ªd¬d, %d\n", 
wifi_¡ªd¬d
);

165  
by‹s
;

167 
low_rx_cÜe
 = 
misc_ã©u»s_aùiv©ed
[0] & 
SLSI_QSF_LOW_RX_CORE_GET_MASK
;

168 ià(
low_rx_cÜe
 <= 1) {

169 
	`SLSI_QSF_SET_LOW_PWR_RX_CORE
(
hw_ã©u»
, 
low_rx_cÜe
);

171 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀg‘tšg†ow_rx_cÜe, %d\n", 
low_rx_cÜe
);

172  
by‹s
;

174 
maš_cÜes
 = (
misc_ã©u»s_aùiv©ed
[0] & 
SLSI_QSF_MAIN_CORES_GET_MASK
è>> 
SLSI_QSF_MAIN_CORES_SHIFT
;

175 ià(
maš_cÜes
 <= 2) {

176 
	`SLSI_QSF_SET_NUMBER_OF_CORES
(
hw_ã©u»
, 
maš_cÜes
);

178 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀg‘tšg maš_cÜes, %d\n", 
maš_cÜes
);

179  
by‹s
;

182 
wifi_¡ªd¬d
) {

183 
SLSI_WIFI_5
:

184 
ª‹Âa
 = 
	`¦si_g‘_ª‹Âa_äom_vht_ÿps
(
vht_ÿps
);

186 
SLSI_WIFI_4
:

187 
ª‹Âa
 = 
	`¦si_g‘_ª‹Âa_äom_ht_ÿps
(
ht_ÿps
);

190 
ª‹Âa
 = 1;

192 ià(
ª‹Âa
 <ğ
SLSI_QSF_NUM_ANTENNA_MAX
) {

193 
	`SLSI_QSF_SET_NUM_ANTENNA
(
hw_ã©u»
, 
ª‹Âa
);

195 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀg‘tšg‡Á’Ç, %d\n", 
ª‹Âa
);

196  
by‹s
;

199 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%04X", 
hw_ã©u»_Ën
, 
	`ıu_to_Ë16
(
hw_ã©u»
));

200  
by‹s
;

201 
	}
}

203 
u32
 
	$¦si_qsf_’code_sw_ã©u»_1
(
¦si_dev
 *
sdev
, 
u8
 *
misc_ã©u»s_aùiv©ed
,

204 
u32
 
twt_cÚŒŞ
, 
boŞ
 
twt_aùive
,

205 *
buf
, 
u32
 
by‹s
, u32 
buf_size
)

207 
u8
 
wifi_İtimiz”
 = 0, 
scheduËd_pm
 = 0, 
d–ayed_wakeup
 = 0, 
rfc_8325
 = 0, 
²o
 = 0;

208 
u32
 
²o_’abËd
 = 1, 
²o_š_un_assococŸ‹d
 = 1, 
twt
 = 0;

210 
u32
 
twt_brßdÿ¡
 = 
	`SLSI_GET_TWT_BROADCAST
(
twt_cÚŒŞ
);

211 
u32
 
twt_»q
 = 
	`SLSI_GET_TWT_REQ
(
twt_cÚŒŞ
);

212 
u32
 
twt_æexibË
 = 
	`SLSI_GET_TWT_FLEXIBLE
(
twt_cÚŒŞ
);

213 
u32
 
mš_£rviû_³riod
 = 
	`SLSI_GET_TWT_MIN_SERVICE_PERIOD
(
misc_ã©u»s_aùiv©ed
);

214 
u32
 
mš_¦“p_³riod
 = 
	`SLSI_GET_TWT_mš_¦“p_³riod
(
misc_ã©u»s_aùiv©ed
);

215 
u32
 
²o_š_assocŸ‹d
 = 
	`SLSI_GET_PNO_STATE_IN_ASSOC
(
misc_ã©u»s_aùiv©ed
);

216 
u32
 
wifi_İtimiz”_suµÜt
 = 
	`SLSI_GET_WIFI_OPTIMIZER_SUPPORT
(
misc_ã©u»s_aùiv©ed
);

217 
u32
 
dyÇmic_dw–l_cÚŒŞ
 = 
	`SLSI_GET_DYNAMIC_DWELL_CONTROL
(
misc_ã©u»s_aùiv©ed
);

218 
u32
 
’hªûd_·ssive_sÿn
 = 
	`SLSI_GET_ENHANCED_PASSIVE_SCAN
(
misc_ã©u»s_aùiv©ed
);

219 
u32
 
sched_pm_suµÜt
 = 
	`SLSI_GET_SCHED_PM_SUPPORT
(
misc_ã©u»s_aùiv©ed
);

220 
u32
 
d–ayed_wakeup_suµ
 = 
	`SLSI_GET_DELAYED_WAKEUP_SUPPORT
(
misc_ã©u»s_aùiv©ed
);

222 ià(
²o_’abËd
)

223 
²o
 |ğ
SLSI_PNO_ENABLED
;

224 ià(
²o_š_un_assococŸ‹d
)

225 
²o
 |ğ
SLSI_PNO_UNASSOIATED_ENABED
;

226 ià(
²o_š_assocŸ‹d
)

227 
²o
 |ğ
SLSI_PNO_ASSOIATED_ENABED
;

228 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_PNO_ID
,

229 
SLSI_QSF_SW_FEATURE_PNO_LEN
, 
²o
);

231 ià(
twt_aùive
)

232 
twt
 |ğ
SLSI_TWT_ENABLED
;

234 ià(
twt_»q
)

235 
twt
 |ğ
SLSI_TWT_REQ_SUPPORTED
;

236 ià(
twt_brßdÿ¡
)

237 
twt
 |ğ
SLSI_TWT_BROADCAST_SUPPORTED
;

238 ià(
twt_æexibË
)

239 
twt
 |ğ
SLSI_TWT_FLEXIBLE_SUPPORTED
;

240 
	`SLSI_SET_TWT_MIN_SERVICE_PERIOD
(
twt
, 
mš_£rviû_³riod
);

241 
	`SLSI_SET_TWTMIN_SLEEP_PERIOD
(
twt
, 
mš_¦“p_³riod
);

242 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%04X", 
SLSI_QSF_SW_FEATURE_TWT_ID
,

243 
SLSI_QSF_SW_FEATURE_TWT_LEN
, 
	`ıu_to_Ë16
(
twt
));

245 ià(
wifi_İtimiz”_suµÜt
)

246 
wifi_İtimiz”
 |ğ
SLSI_WIFI_OPTIMIZER_SUPPORTED
;

247 ià(
dyÇmic_dw–l_cÚŒŞ
)

248 
wifi_İtimiz”
 |ğ
SLSI_DYNAMIC_DWELL_CONTROL_SUPPORTED
;

249 ià(
’hªûd_·ssive_sÿn
)

250 
wifi_İtimiz”
 |ğ
SLSI_ENHANCED_PASSIVE_SCAN_SUPPORDED
;

251 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_WIFI_OPTIMIZER_ID
,

252 
SLSI_QSF_SW_FEATURE_WIFI_OPTIMIZER_LEN
, 
wifi_İtimiz”
);

254 ià(
sched_pm_suµÜt
)

255 
scheduËd_pm
 = 
SLSI_SCHED_PM_ENABLED
;

256 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_SCHEDULED_PM_ID
,

257 
SLSI_QSF_SW_FEATURE_SCHEDULED_PM_LEN
, 
scheduËd_pm
);

258 ià(
d–ayed_wakeup_suµ
)

259 
d–ayed_wakeup
 = 
SLSI_DELAYED_WAKEUP_ENABLED
;

260 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_DELAYED_WAKEUP_ID
,

261 
SLSI_QSF_SW_FEATURE_DELAYED_WAKEUP_LEN
, 
d–ayed_wakeup
);

262 #iâdeà
CONFIG_SCSC_USE_WMM_TOS


263 
rfc_8325
 |= 0x01;

265 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_RFC_8325_ID
,

266 
SLSI_QSF_SW_FEATURE_RFC_8325_LEN
, 
rfc_8325
);

267  
by‹s
;

268 
	}
}

270 
u32
 
	$¦si_qsf_’code_sw_ã©u»_2
(
¦si_dev
 *
sdev
, 
u8
 *
misc_ã©u»s_aùiv©ed
,

271 
boŞ
 
he_soá­_aùive
, boŞ 
w·3_aùive
, 
u32
 
­³ndix_v”siÚs
,

272 *
buf
, 
u32
 
by‹s
, u32 
buf_size
)

274 #ifdeà
SCSC_SEP_VERSION


275 
u16
 
max_şi
 = 
sdev
->
soá­_max_ş›Á
;

277 
u32
 
mhs
 = 0, 
rßmšg
 = 0, 
couÁry_code_£t_h®_­i
 = 1, 
g‘_v®id_chª_h®_­i
 = 1;

279 
u32
 
du®_š‹rçû
 = 
	`SLSI_GET_DUAL_IFACE_SUPPORT
(
misc_ã©u»s_aùiv©ed
);

280 
u32
 
suµÜt_5g
 = 
	`SLSI_GET_SUPPORT_5G
(
misc_ã©u»s_aùiv©ed
);

281 
u32
 
suµÜt_6g
 = 
	`SLSI_GET_SUPPORT_6G
(
misc_ã©u»s_aùiv©ed
);

282 
u32
 
high_chª_utiz©iÚ_Œigg”
 = 
	`SLSI_GET_HIGH_CHAN_UTILIZATON_TRIGGER
(
misc_ã©u»s_aùiv©ed
);

283 
u32
 
em”g’cy_rßmšg_Œigg”
 = 
	`SLSI_GET_EMERGENCY_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
);

284 
u32
 
btm_rßmšg_Œigg”
 = 
	`SLSI_GET_BTM_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
);

285 
u32
 
rßmšg_majÜ_numb”
 = 
	`SLSI_GET_ROAMING_MAJOR_NUMBER
(
­³ndix_v”siÚs
);

286 
u32
 
rßmšg_mšÜ_numb”
 = 
	`SLSI_GET_ROAMING_MINOR_NUMBER
(
­³ndix_v”siÚs
);

287 
u32
 
idË_rßmšg_Œogg”
 = 
	`SLSI_GET_IDLE_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
);

288 
u32
 
wtc_rßmšg_Œigg”
 = 
	`SLSI_GET_WTC_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
);

289 
u32
 
bt_cÛx_rßmšg_Œigg”
 = 
	`SLSI_GET_BT_COEX_ROAMING
(
misc_ã©u»s_aùiv©ed
);

290 
u32
 
rßmšg_bwtw“n_w·_ªd_w·2
 = 
	`SLSI_GET_ROAMING_BETWEEN_WPA_AND_WPA2
(
misc_ã©u»s_aùiv©ed
);

291 
u32
 
rßmšg_ù¾_­i_1_2
 = 
	`SLSI_GET_ROAMING_CTRL_API_1_2
(
misc_ã©u»s_aùiv©ed
);

292 
u32
 
rßmšg_ù¾_­i_3_4
 = 
	`SLSI_GET_ROAMING_CTRL_API_3_4
(
misc_ã©u»s_aùiv©ed
);

293 
u32
 
rßmšg_ù¾_­i_5
 = 
	`SLSI_GET_ROAMING_CTRL_API_5
(
misc_ã©u»s_aùiv©ed
);

294 
u32
 
mªage_chª_li¡_­i
 = 
	`SLSI_GET_MANAGE_CHAN_LIST_API
(
misc_ã©u»s_aùiv©ed
);

295 
u32
 
ad­tive_11r
 = 
	`SLSI_GET_ADAPTIVE_11R
(
misc_ã©u»s_aùiv©ed
);

297 ià(
du®_š‹rçû
)

298 
mhs
 |ğ
SLSI_DUAL_IFACE_ENABLED
;

299 ià(
suµÜt_5g
)

300 
mhs
 |ğ
SLSI_5G_SUPPORT
;

301 ià(
suµÜt_6g
)

302 
mhs
 |ğ
SLSI_6G_SUPPORT
;

303 #ifdeà
SCSC_SEP_VERSION


304 ià(
max_şi
)

305 
mhs
 |ğ
	`SLSI_SET_MAX_CLIENT
(
max_şi
);

307 ià(
couÁry_code_£t_h®_­i
)

308 
mhs
 |ğ
SLSI_COUNTRY_CODE_SET_API_SUPPORTED
;

309 ià(
g‘_v®id_chª_h®_­i
)

310 
mhs
 |ğ
SLSI_QSF_VALID_CHAN_API_SUPPORTED
;

311 ià(
he_soá­_aùive
)

312 
mhs
 |ğ
SLSI_HE_ENABLED
;

313 ià(
w·3_aùive
)

314 
mhs
 |ğ
SLSI_WPA3_ENABLED
;

315 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%04X", 
SLSI_QSF_SW_FEATURE_MHS_ID
,

316 
SLSI_QSF_SW_FEATURE_MHS_LEN
, 
	`ıu_to_Ë16
(
mhs
));

318 
rßmšg
 |ğ
rßmšg_majÜ_numb”
;

319 
rßmšg
 |ğ
rßmšg_mšÜ_numb”
 << 8;

321 ià(
high_chª_utiz©iÚ_Œigg”
)

322 
rßmšg
 |ğ
SLSI_HIGH_CHAN_UTILIZATON_TRIGGER
;

323 ià(
em”g’cy_rßmšg_Œigg”
)

324 
rßmšg
 |ğ
SLSI_EMERGENCY_ROAMING_TRIGGER
;

325 ià(
btm_rßmšg_Œigg”
)

326 
rßmšg
 |ğ
SLSI_BTM_ROAMING_TRIGGER
;

327 ià(
idË_rßmšg_Œogg”
)

328 
rßmšg
 |ğ
SLSI_IDLE_ROAMING_TRIGGER
;

329 ià(
wtc_rßmšg_Œigg”
)

330 
rßmšg
 |ğ
SLSI_WTC_ROAMING_TRIGGER
;

331 ià(
bt_cÛx_rßmšg_Œigg”
)

332 
rßmšg
 |ğ
SLSI_BT_COEX_ROAMING
;

333 ià(
rßmšg_bwtw“n_w·_ªd_w·2
)

334 
rßmšg
 |ğ
SLSI_ROAMING_BETWEEN_WPA_AND_WPA2
;

335 ià(
mªage_chª_li¡_­i
)

336 
rßmšg
 |ğ
SLSI_MANAGE_CHAN_LIST_API
;

337 ià(
ad­tive_11r
)

338 
rßmšg
 |ğ
SLSI_ADAPTIVE_11R
;

339 ià(
rßmšg_ù¾_­i_1_2
)

340 
rßmšg
 |ğ
SLSI_ROAMING_CTRL_API_1_2
;

341 ià(
rßmšg_ù¾_­i_3_4
)

342 
rßmšg
 |ğ
SLSI_ROAMING_CTRL_API_3_4
;

343 ià(
rßmšg_ù¾_­i_5
)

344 
rßmšg
 |ğ
SLSI_ROAMING_CTRL_API_5
;

346 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%08X", 
SLSI_QSF_SW_FEATURE_ROAMING_ID
,

347 
SLSI_QSF_SW_FEATURE_ROAMING_LEN
, 
	`ıu_to_be32
(
rßmšg
));

348  
by‹s
;

349 
	}
}

351 
u32
 
	$¦si_qsf_’code_sw_ã©u»_3
(
¦si_dev
 *
sdev
, 
u8
 *
misc_ã©u»s_aùiv©ed
,

352 
u32
 
­³ndix_v”siÚs
,

353 *
buf
, 
u32
 
by‹s
, u32 
buf_size
)

355 
u32
 
ncho
 = 0;

356 
u32
 
ncho_majÜ
 = 0;

357 
u32
 
ncho_mšÜ
 = 0;

358 
u8
 
pÿp_äame_loggšg
 = 0;

359 
u16
 
£cur™y
 = 0;

361 
u32
 
mgmt_äame
 = 
	`SLSI_GET_SUPPORT_MGMT_FRAMES
(
misc_ã©u»s_aùiv©ed
);

362 
u32
 
ù¾_äame
 = 
	`SLSI_GET_SUPPORT_CTRL_FRAMES
(
misc_ã©u»s_aùiv©ed
);

363 
u32
 
d©a_äame
 = 
	`SLSI_GET_SUPPORT_DATA_FRAMES
(
misc_ã©u»s_aùiv©ed
);

364 
u8
 
assu¿nû
 = 
misc_ã©u»s_aùiv©ed
[9] & 
SLSI_QSF_SW_FEATURE_ASSURANCE_MASK
;

366 
ncho_majÜ
 = 
	`SLSI_GET_NCHO_MAJOR_NUMBER
(
­³ndix_v”siÚs
);

367 
ncho_mšÜ
 = 
	`SLSI_GET_NCHO_MINOR_NUMBER
(
­³ndix_v”siÚs
);

369 
ncho
 |ğ
ncho_majÜ
;

370 
ncho
 |ğ
ncho_mšÜ
 << 8;

372 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%04X", 
SLSI_QSF_SW_FEATURE_NCHO_ID
,

373 
SLSI_QSF_SW_FEATURE_NCHO_LEN
, 
	`ıu_to_be16
(
ncho
));

374 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_ASSURANCE_ID
,

375 
SLSI_QSF_SW_FEATURE_ASSURANCELEN
, 
assu¿nû
);

376 ià(
mgmt_äame
)

377 
pÿp_äame_loggšg
 |ğ
SLSI_MGMT_FRAME_ENABLED
;

378 ià(
ù¾_äame
)

379 
pÿp_äame_loggšg
 |ğ
SLSI_CTRL_FRAME_ENABLED
;

380 ià(
d©a_äame
)

381 
pÿp_äame_loggšg
 |ğ
SLSI_DATA_FRAME_ENABLED
;

382 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_PCAP_FRAME_LOGGING_ID
,

383 
SLSI_QSF_SW_FEATURE_PCAP_FRAME_LOGGING_LEN
, 
pÿp_äame_loggšg
);

385 
£cur™y
 = (
	`SLSI_BUFF_LE_TO_U16
(
misc_ã©u»s_aùiv©ed
 + 11è& 
SLSI_QSF_SECURITY_FEATURE_MASK
);

387 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%04X", 
SLSI_QSF_SW_FEATURE_SECURITY_ID
,

388 
SLSI_QSF_SW_FEATURE_SECURITY_LEN
, 
	`ıu_to_be16
(
£cur™y
));

389  
by‹s
;

390 
	}
}

392 
u32
 
	$¦si_qsf_’code_sw_ã©u»_4
(
¦si_dev
 *
sdev
, 
u8
 *
misc_ã©u»s_aùiv©ed
,

393 
boŞ
 
tdls_aùive
, 
u16
 
max_tdls_şi
,

394 
boŞ
 
tdls_³”_u­sd_aùive
, boŞ 
Çn_ç¡_cÚÃù
,

395 *
buf
, 
u32
 
by‹s
, u32 
buf_size
)

397 
u32
 
g‘_bssi_šfo_­i_suµ
 = 1, 
g‘_assoc_»jeù_šfo_­i_suµ
 = 1;

398 
u32
 
g‘_¡a_šfo_­i_suµ
 = 1;

399 
u8
 
p2p
[6] = {0};

400 
u8
 
big_d©a
 = 0;

402 
u32
 
max_Çn_ndps
 = 
	`SLSI_GET_MAX_NAN_NDPS
(
misc_ã©u»s_aùiv©ed
);

404 
u32
 
¡ªd¬d_Çn_6e
 = 
	`SLSI_GET_STANDARD_NAN_6E_SUPPORT
(
misc_ã©u»s_aùiv©ed
);

405 
u32
 
§msung_Çn_6e
 = 
	`SLSI_GET_SAMSUNG_NAN_6E_SUPPORT
(
misc_ã©u»s_aùiv©ed
);

406 
u32
 
Çn_v”siÚ
 = 
	`SLSI_GET_NAN_VERSION
(
misc_ã©u»s_aùiv©ed
);

408 ià(
sdev
->
Çn_’abËd
)

409 
p2p
[0] |ğ
SLSI_QSF_NAN_SUPPORTED
;

410 ià(
tdls_aùive
)

411 
p2p
[0] |ğ
SLSI_QSF_TDLS_SUPPORTED
;

412 #ifdeà
CONFIG_SCSC_WLAN_SUPPORT_6G


413 ià(
sdev
->
bªd_6g_suµÜ‹d
)

414 
p2p
[0] |ğ
SLSI_QSF_6E_SUPPORTED
;

416 ià(
tdls_³”_u­sd_aùive
)

417 
p2p
[0] |ğ
SLSI_QSF_TDLS_PEER_UAPSD_SUPPORTED
;

418 
p2p
[0] |ğ
misc_ã©u»s_aùiv©ed
[13] & 
SLSI_QSF_P2P_FEATURE_1ST_BYTE_MASK
;

420 ià(
max_tdls_şi
)

421 
p2p
[1] |ğ
max_tdls_şi
 & 0xF;

422 ià(
max_Çn_ndps
)

423 
p2p
[1] |ğ
max_Çn_ndps
;

425 
p2p
[2] = 
misc_ã©u»s_aùiv©ed
[15] & (
SLSI_QSF_P2P_FEATURE_3RD_BYTE_MASK
);

427 
p2p
[3] = 
misc_ã©u»s_aùiv©ed
[16] & 
SLSI_QSF_P2P_FEATURE_4TH_BYTE_MASK
;

428 ià(
¡ªd¬d_Çn_6e
)

429 
p2p
[5] |ğ
SLSI_QSF_STANDARD_NAN_6E_SUPPORTED
;

430 ià(
§msung_Çn_6e
)

431 
p2p
[5] |ğ
SLSI_QSF_SAMSUNG_NAN_6E_SUPPORTED
;

432 ià(
Çn_ç¡_cÚÃù
)

433 
p2p
[5] |ğ
SLSI_QSF_NAN_FAST_CONNECT_SUPPORTED
;

434 ià(
Çn_v”siÚ
)

435 
p2p
[5] |ğ
	`SLSI_QSF_NAN_VERSION_SET
(
Çn_v”siÚ
);

437 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - bytes, "%02X%02X%02X%02X%02X%02X%02X%02X",

438 
SLSI_QSF_SW_FEATURE_P2P_ID
, 
SLSI_QSF_SW_FEATURE_P2P_LEN
, 
p2p
[0],

439 
p2p
[1],…2p[2],…2p[3],…2p[4],…2p[5]);

441 ià(
g‘_bssi_šfo_­i_suµ
)

442 
big_d©a
 |ğ
SLSI_QSF_BSSI_INFO_API_SUPP_ENABLED
;

443 ià(
g‘_assoc_»jeù_šfo_­i_suµ
)

444 
big_d©a
 |ğ
SLSI_QSF_ASSOC_REJECT_INFO_API_ENABLED
;

445 ià(
g‘_¡a_šfo_­i_suµ
)

446 
big_d©a
 |ğ
SLSI_QSF_STA_INFO_API_SUPP_ENABLED
;

447 
by‹s
 +ğ
	`sú´štf
(
buf
 + by‹s, 
buf_size
 - by‹s, "%02X%02X%02X", 
SLSI_QSF_SW_FEATURE_BIG_DATA_ID
,

448 
SLSI_QSF_SW_FEATURE_BIG_DATA_LEN
, 
big_d©a
);

449  
by‹s
;

450 
	}
}

452 
šlše
 
	$¦si_qsf_exŒaù_boŞ_d©a
(
¦si_dev
 *
sdev
, 
¦si_mib_v®ue
 *
v®ues
,

453 
šdex
, 
boŞ
 *
v®
)

455 ià(
v®ues
[
šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
 || v®ues[šdex].ty³ =ğ
SLSI_MIB_TYPE_BOOL
)

456 *
v®
 = 
v®ues
[
šdex
].
u
.
boŞV®ue
;

458 
	`SLSI_ERR
(
sdev
, "Ty³ mism©ch fÜ index: %d\n", 
šdex
);

459 
	}
}

461 
	$¦si_g‘_qsf_mib_d©a
(
¦si_dev
 *
sdev
, 
¦si_qsf_mib_d©a
 *
qsf_d©a
)

463 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

464 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

465 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_HE_ACTIVATED
, { 0, 0 } },

466 { 
SLSI_PSID_UNIFI_TWT_ACTIVATED
, {0, 0} },

467 { 
SLSI_PSID_UNIFI_WP_A3_ACTIVATED
, {0, 0} },

468 { 
SLSI_PSID_UNIFI_TDLS_ACTIVATED
, {0, 0} },

469 { 
SLSI_PSID_DOT11_TDLS_PEER_UAPSD_BUFFER_STA_ACTIVATED
, {0, 0} },

470 { 
SLSI_PSID_UNIFI_HT_CAPABILITIES
, {0, 0} },

471 { 
SLSI_PSID_UNIFI_VHT_CAPABILITIES
, {0, 0} },

472 { 
SLSI_PSID_UNIFI_HE_CAPABILITIES
, {0, 0} },

473 { 
SLSI_PSID_UNIFI_MISC_FEATURES_ACTIVATED
, {0, 0} },

474 { 
SLSI_PSID_UNIFI_APPENDIX_VERSIONS
, {0, 0} },

475 { 
SLSI_PSID_UNIFI_TWT_CONTROL_FLAGS
, {0, 0} },

478 
mibr¥
.
d©aL’gth
 = 32 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

479 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

480 ià(!
mibr¥
.
d©a
) {

481 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

482  -
ENOMEM
;

485 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

486 ià(!
v®ues
) {

487 
	`kä“
(
mibr¥
.
d©a
);

488 
	`SLSI_ERR
(
sdev
, "Error in slsi_read_mibs\n");

492 
qsf_d©a
->
max_tdls_şi
 = 
SLSI_MAX_TDLS_LINK
;

493 
	`¦si_qsf_exŒaù_boŞ_d©a
(
sdev
, 
v®ues
, 0, &
qsf_d©a
->
he_aùive
);

494 
	`¦si_qsf_exŒaù_boŞ_d©a
(
sdev
, 
v®ues
, 1, &
qsf_d©a
->
twt_aùive
);

495 
	`¦si_qsf_exŒaù_boŞ_d©a
(
sdev
, 
v®ues
, 2, &
qsf_d©a
->
w·3_aùive
);

496 
	`¦si_qsf_exŒaù_boŞ_d©a
(
sdev
, 
v®ues
, 3, &
qsf_d©a
->
tdls_aùive
);

497 
	`¦si_qsf_exŒaù_boŞ_d©a
(
sdev
, 
v®ues
, 4, &
qsf_d©a
->
tdls_³”_u­sd_aùive
);

499 ià(
v®ues
[5].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 && v®ues[5].
u
.
où‘V®ue
.
d©aL’gth
 >= 21)

500 
	`memıy
(
qsf_d©a
->
ht_ÿps
, 
v®ues
[5].
u
.
où‘V®ue
.
d©a
, 21);

502 
	`SLSI_ERR
(
sdev
, "invalidype or†en for index: %d†en:%d\n", 5,

503 
v®ues
[5].
u
.
où‘V®ue
.
d©aL’gth
);

504 ià(
v®ues
[6].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 && v®ues[6].
u
.
où‘V®ue
.
d©aL’gth
 >= 12)

505 
	`memıy
(
qsf_d©a
->
vht_ÿps
, 
v®ues
[6].
u
.
où‘V®ue
.
d©a
, 12);

507 
	`SLSI_ERR
(
sdev
, "invalidype or†en for index: %d†en: %d\n", 6,

508 
v®ues
[6].
u
.
où‘V®ue
.
d©aL’gth
);

509 ià(
v®ues
[7].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 && v®ues[7].
u
.
où‘V®ue
.
d©aL’gth
 >= 28)

510 
	`memıy
(
qsf_d©a
->
he_ÿps
, 
v®ues
[7].
u
.
où‘V®ue
.
d©a
, v®ues[7].u.où‘V®ue.
d©aL’gth
);

512 
	`SLSI_ERR
(
sdev
, "invalidype or†en for index: %d†en: %d\n", 7,

513 
v®ues
[7].
u
.
où‘V®ue
.
d©aL’gth
);

514 ià(
v®ues
[8].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 && v®ues[8].
u
.
où‘V®ue
.
d©aL’gth
 >= 18)

515 
	`memıy
(
qsf_d©a
->
misc_ã©u»s_aùiv©ed
, 
v®ues
[8].
u
.
où‘V®ue
.
d©a
, 18);

517 
	`SLSI_ERR
(
sdev
, "invalidype or†en for index: %d†en: %d\n", 8,

518 
v®ues
[8].
u
.
où‘V®ue
.
d©aL’gth
);

519 ià(
v®ues
[9].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 && v®ues[9].
u
.
où‘V®ue
.
d©aL’gth
 >= 4)

520 
	`memıy
(&
qsf_d©a
->
­³ndix_v”siÚs
, 
v®ues
[9].
u
.
où‘V®ue
.
d©a
, 4);

522 
	`SLSI_ERR
(
sdev
, "invalidype or†en for index: %d†en: %d\n", 9,

523 
v®ues
[9].
u
.
où‘V®ue
.
d©aL’gth
);

525 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[10].
ty³
, 
SLSI_MIB_TYPE_UINT
);

526 
qsf_d©a
->
twt_cÚŒŞ
 = 
v®ues
[10].
u
.
uštV®ue
;

527 
	`kä“
(
mibr¥
.
d©a
);

528 
	`kä“
(
v®ues
);

530 
	}
}

532 
	$¦si_g‘_qsfs_ã©u»_£t
(
¦si_dev
 *
sdev
)

534 
sw_ã©u»_Ën
 = 0;

535 
sw_ã©u»_Ën_off£t
 = 0;

536 
u32
 
pos
 = 
sdev
->
qsf_ã©u»_£t_Ën
;

537 
»t
 = 0;

538 
u32
 
buf_size
 = 128;

539 
¦si_qsf_mib_d©a
 
qsf_d©a
 = {0};

540 
u8
 *
buf
 = 
sdev
->
qsfs_ã©u»_£t
;

541 
tmp_buf
[5] = {0};

543 
»t
 = 
	`¦si_g‘_qsf_mib_d©a
(
sdev
, &
qsf_d©a
);

544 ià(
»t
) {

545 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀg‘tšgh¸mib d©¨E¼Ü:%d\n", 
»t
);

549 
pos
 = 
	`¦si_qsf_’code_hw_ã©u»
(
sdev
, 
qsf_d©a
.
misc_ã©u»s_aùiv©ed
, qsf_d©a.
he_aùive
,

550 
buf
, 
pos
, 
buf_size
, 
qsf_d©a
.
he_ÿps
,

551 
qsf_d©a
.
vht_ÿps
, qsf_d©a.
ht_ÿps
);

552 
sw_ã©u»_Ën_off£t
 = 
pos
;

553 
pos
 +ğ
SLSI_QSF_SW_FEATURE_CHAR_LEN
;

554 
pos
 = 
	`¦si_qsf_’code_sw_ã©u»_1
(
sdev
, 
qsf_d©a
.
misc_ã©u»s_aùiv©ed
, qsf_d©a.
twt_cÚŒŞ
,

555 
qsf_d©a
.
twt_aùive
, 
buf
, 
pos
, 
buf_size
);

556 
pos
 = 
	`¦si_qsf_’code_sw_ã©u»_2
(
sdev
, 
qsf_d©a
.
misc_ã©u»s_aùiv©ed
, qsf_d©a.
he_soá­_aùive
,

557 
qsf_d©a
.
w·3_aùive
, qsf_d©a.
­³ndix_v”siÚs
,

558 
buf
, 
pos
, 
buf_size
);

559 
pos
 = 
	`¦si_qsf_’code_sw_ã©u»_3
(
sdev
, 
qsf_d©a
.
misc_ã©u»s_aùiv©ed
, qsf_d©a.
­³ndix_v”siÚs
,

560 
buf
, 
pos
, 
buf_size
);

561 
pos
 = 
	`¦si_qsf_’code_sw_ã©u»_4
(
sdev
, 
qsf_d©a
.
misc_ã©u»s_aùiv©ed
, qsf_d©a.
tdls_aùive
,

562 
qsf_d©a
.
max_tdls_şi
, qsf_d©a.
tdls_³”_u­sd_aùive
,

563 
qsf_d©a
.
Çn_ç¡_cÚÃù
, 
buf
, 
pos
, 
buf_size
);

564 
sw_ã©u»_Ën
 = 
pos
 - (
sw_ã©u»_Ën_off£t
 + 
SLSI_QSF_SW_FEATURE_CHAR_LEN
);

565 
	`sú´štf
(
tmp_buf
, 5, "%04X", 
sw_ã©u»_Ën
);

566 
	`memıy
(
buf
 + 
sw_ã©u»_Ën_off£t
, 
tmp_buf
, 
SLSI_QSF_SW_FEATURE_CHAR_LEN
);

567 
sdev
->
qsf_ã©u»_£t_Ën
 = 
pos
;

568 
	}
}

570 
ssize_t
 
	$sysfs_show_qsf
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
, *
buf
)

572 
¦si_dev
 *
sdev
 = 
	`¦si_g‘_sdev
();

573 
r
 = 0;

574 
u32
 
fw_ã©u»_v”
 = 0;

575 
u32
 
wifi_ã©u»_v”
 = 0;

576 
u32
 
pos
 = 0;

577 
u32
 
buf_size
 = (
sdev
->
qsfs_ã©u»_£t
);

579 ià(!
sdev
->
qsf_ã©u»_£t_Ën
) {

580 
r
 = 
	`¦si_qsf_g‘_wifi_fw_ã©u»_v”siÚ
(
sdev
, &
fw_ã©u»_v”
);

581 
	`SLSI_INFO
(
sdev
, "fw_ã©u»_v”: %d\n", 
fw_ã©u»_v”
);

582 ià(
r
 < 0)

583 
	`SLSI_ERR
(
sdev
, "QSFS Wifi FW feature version couldn't be identified\n");

584 ià(
fw_ã©u»_v”
)

585 
wifi_ã©u»_v”
 = 
fw_ã©u»_v”
 + 
SLSI_QSF_WIFI_FEATURE_VERSION
;

587 
pos
 +ğ
	`sú´štf
(
sdev
->
qsfs_ã©u»_£t
, 
buf_size
, "%04X", 
wifi_ã©u»_v”
);

588 
pos
 +ğ
	`sú´štf
(
sdev
->
qsfs_ã©u»_£t
 +…os, 
buf_size
 -…os, "%.3s", 
sŞ_Çme
);

589 
sdev
->
qsf_ã©u»_£t_Ën
 = 
pos
;

591 
	`SLSI_INFO
(
sdev
, "sysfs‚ode for QSF is being„ead\n");

592 
	`memıy
(
buf
, 
sdev
->
qsfs_ã©u»_£t
, sdev->
qsf_ã©u»_£t_Ën
);

593  
sdev
->
qsf_ã©u»_£t_Ën
;

594 
	}
}

	@qsfs.h

7 #iâdeà
__SLSI_QSFS_H__


8 
	#__SLSI_QSFS_H__


	)

10 
	#SLSI_QSF_LOW_RX_CORE_GET_MASK
 1

	)

11 
	#SLSI_QSF_MAIN_CORES_GET_MASK
 0x0E

	)

12 
	#SLSI_QSF_MAIN_CORES_SHIFT
 1

	)

13 
	#SLSI_QSF_SW_FEATURE_PNO_ID
 1

	)

14 
	#SLSI_QSF_SW_FEATURE_PNO_LEN
 1

	)

15 
	#SLSI_QSF_SW_FEATURE_TWT_ID
 2

	)

16 
	#SLSI_QSF_SW_FEATURE_TWT_LEN
 2

	)

17 
	#SLSI_QSF_SW_FEATURE_WIFI_OPTIMIZER_ID
 3

	)

18 
	#SLSI_QSF_SW_FEATURE_WIFI_OPTIMIZER_LEN
 1

	)

19 
	#SLSI_QSF_SW_FEATURE_SCHEDULED_PM_ID
 4

	)

20 
	#SLSI_QSF_SW_FEATURE_SCHEDULED_PM_LEN
 1

	)

21 
	#SLSI_QSF_SW_FEATURE_DELAYED_WAKEUP_ID
 5

	)

22 
	#SLSI_QSF_SW_FEATURE_DELAYED_WAKEUP_LEN
 1

	)

23 
	#SLSI_QSF_SW_FEATURE_RFC_8325_ID
 6

	)

24 
	#SLSI_QSF_SW_FEATURE_RFC_8325_LEN
 1

	)

25 
	#SLSI_QSF_NUM_ANTENNA_MAX
 2

	)

26 
	#SLSI_QSF_SW_FEATURE_MHS_ID
 7

	)

27 
	#SLSI_QSF_SW_FEATURE_MHS_LEN
 2

	)

28 
	#SLSI_QSF_SW_FEATURE_ROAMING_LEN
 4

	)

29 
	#SLSI_QSF_SW_FEATURE_NCHO_ID
 9

	)

30 
	#SLSI_QSF_SW_FEATURE_ROAMING_ID
 8

	)

31 
	#SLSI_QSF_SW_FEATURE_NCHO_LEN
 2

	)

32 
	#SLSI_QSF_SW_FEATURE_ASSURANCE_ID
 10

	)

33 
	#SLSI_QSF_SW_FEATURE_ASSURANCELEN
 1

	)

34 
	#SLSI_QSF_SW_FEATURE_PCAP_FRAME_LOGGING_ID
 11

	)

35 
	#SLSI_QSF_SW_FEATURE_PCAP_FRAME_LOGGING_LEN
 1

	)

36 
	#SLSI_QSF_SW_FEATURE_SECURITY_ID
 12

	)

37 
	#SLSI_QSF_SW_FEATURE_SECURITY_LEN
 2

	)

38 
	#SLSI_QSF_SW_FEATURE_P2P_ID
 13

	)

39 
	#SLSI_QSF_SW_FEATURE_P2P_LEN
 6

	)

40 
	#SLSI_QSF_SW_FEATURE_BIG_DATA_ID
 14

	)

41 
	#SLSI_QSF_SW_FEATURE_BIG_DATA_LEN
 1

	)

42 
	#SLSI_QSF_SW_FEATURE_ASSURANCE_MASK
 0x01

	)

44 
	#DUAL_BAND_CONCURRANCY_WITH_6G
 2

	)

45 
	#DUAL_BAND_CONCURRANCY
 1

	)

46 
	#SLSI_QSF_WIFI_STANDARD_MASK
 (
	`BIT
(0è| BIT(1è| BIT(2è| BIT(3))

	)

47 
	#SLSI_QSF_WIFI_STANDARD_POS
 0

	)

48 
	#SLSI_QSF_SET_WIFI_STANDARD
(
hw_ã©u»
, 
wifi_¡ªd¬d
) ((hw_feature) |= \

49 ((
wifi_¡ªd¬d
è<< 
SLSI_QSF_WIFI_STANDARD_POS
) & \

50 
SLSI_QSF_WIFI_STANDARD_MASK
)

	)

52 
	#SLSI_QSF_LOW_RX_CORE_POS
 4

	)

53 
	#SLSI_QSF_LOW_RX_CORE_MASK
 
	`BIT
(4)

	)

54 
	#SLSI_QSF_SET_LOW_PWR_RX_CORE
(
hw_ã©u»
, 
low_rx_cÜe
) ((hw_feature) |= \

55 ((
low_rx_cÜe
è<< 
SLSI_QSF_LOW_RX_CORE_POS
) & \

56 
SLSI_QSF_LOW_RX_CORE_MASK
)

	)

58 
	#SLSI_QSF_MAIN_CORES_POS
 5

	)

59 
	#SLSI_QSF_MAIN_CORES_MASK
 (
	`BIT
(5è| BIT(6è| BIT(7))

	)

60 
	#SLSI_QSF_SET_NUMBER_OF_CORES
(
hw_ã©u»
, 
maš_cÜes
) ((hw_feature) |= \

61 ((
maš_cÜes
è<< 
SLSI_QSF_MAIN_CORES_POS
) & \

62 
SLSI_QSF_MAIN_CORES_MASK
)

	)

64 
	#SLSI_QSF_SUPP_CONC_MODE_POS
 8

	)

65 
	#SLSI_QSF_SUPP_CONC_MODE_MASK
 (
	`BIT
(8è| BIT(9è| BIT(10))

	)

66 
	#SLSI_QSF_SET_CONCURRENCY_MODES
(
hw_ã©u»
, 
suµ_cÚc_mode
) ((hw_feature) |= \

67 ((
suµ_cÚc_mode
è<< 
SLSI_QSF_SUPP_CONC_MODE_POS
) & \

68 
SLSI_QSF_SUPP_CONC_MODE_MASK
)

	)

70 
	#SLSI_QSF_ANTENNA_POS
 11

	)

71 
	#SLSI_QSF_ANTENNA_MASK
 (
	`BIT
(11è| BIT(12è| BIT(13))

	)

72 
	#SLSI_QSF_SET_NUM_ANTENNA
(
hw_ã©u»
, 
ª‹Âa
) ((hw_feature) |= \

73 ((
ª‹Âa
è<< 
SLSI_QSF_ANTENNA_POS
è& 
SLSI_QSF_ANTENNA_MASK
)

	)

75 
	#SLSI_QSF_HW_FEATURE_LEN_POS
 16

	)

76 
	#SLSI_QSF_HW_FEATURE_LEN_MASK
 0xFFFF0000

	)

78 
	#SLSI_SUPPORTED_TX_MCS_PRESENT_AND_TXRX_MCS_NOT_EQUAL
(
ÿps
è(ÿps[12] & (
	`BIT
(0è| BIT(1)))

	)

79 
	#SLSI_GET_NSS_FROM_HT_CAPS
(
ÿps
è((ÿps[12] & (
	`BIT
(2è| BIT(3))è>> 2)

	)

81 
	#SLSI_MAX_NSS_NOT_SUPPORTED
 3

	)

82 
	#SLSI_MAX_MCS_8NSS
(
mcs_m­
è(((mcs_m­è& 0xC000è>> 14)

	)

83 
	#SLSI_MAX_MCS_7NSS
(
mcs_m­
è(((mcs_m­è& 0x3000è>> 12)

	)

84 
	#SLSI_MAX_MCS_6NSS
(
mcs_m­
è(((mcs_m­è& 0x0C00è>> 10)

	)

85 
	#SLSI_MAX_MCS_5NSS
(
mcs_m­
è(((mcs_m­è& 0x0300è>> 8)

	)

86 
	#SLSI_MAX_MCS_4NSS
(
mcs_m­
è(((mcs_m­è& 0x00C0è>> 6)

	)

87 
	#SLSI_MAX_MCS_3NSS
(
mcs_m­
è(((mcs_m­è& 0x0030è>> 4)

	)

88 
	#SLSI_MAX_MCS_2NSS
(
mcs_m­
è(((mcs_m­è& 0x000Cè>> 2)

	)

89 
	#SLSI_MAX_MCS_1NSS
(
mcs_m­
è((mcs_m­è& 0x0003)

	)

91 
	#SLSI_GET_HE_RX_80MHZ_MCS_MAP
(
ÿps
è
	`SLSI_BUFF_LE_TO_U16
((ÿpsè+ 17)

	)

92 
	#SLSI_GET_HE_TX_80MHZ_MCS_MAP
(
ÿps
è
	`SLSI_BUFF_LE_TO_U16
((ÿpsè+ 19)

	)

93 
	#SLSI_GET_HE_RX_160MHZ_MCS_MAP
(
ÿps
è
	`SLSI_BUFF_LE_TO_U16
((ÿpsè+ 21)

	)

94 
	#SLSI_GET_HE_TX_160MHZ_MCS_MAP
(
ÿps
è
	`SLSI_BUFF_LE_TO_U16
((ÿpsè+ 23)

	)

95 
	#SLSI_GET_VHT_RX_MCS_MAP
(
ÿps
è
	`SLSI_BUFF_LE_TO_U16
((ÿpsè+ 4)

	)

96 
	#SLSI_GET_VHT_TX_MCS_MAP
(
ÿps
è
	`SLSI_BUFF_LE_TO_U16
((ÿpsè+ 8)

	)

98 
	#SLSI_GET_PNO_STATE_IN_ASSOC
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[1] & 
	`BIT
(2)è>> 2)

	)

99 
	#SLSI_PNO_ENABLED
 
	`BIT
(0)

	)

100 
	#SLSI_PNO_UNASSOIATED_ENABED
 
	`BIT
(1)

	)

101 
	#SLSI_PNO_ASSOIATED_ENABED
 
	`BIT
(2)

	)

102 
	#SLSI_TWT_ENABLED
 
	`BIT
(0)

	)

103 
	#SLSI_GET_TWT_REQ
(
twt_cÚŒŞ
è((Ñwt_cÚŒŞè& 
	`BIT
(2)è>> 2)

	)

104 
	#SLSI_GET_TWT_BROADCAST
(
twt_cÚŒŞ
è(Ñwt_cÚŒŞè& 
	`BIT
(0))

	)

105 
	#SLSI_GET_TWT_FLEXIBLE
(
twt_cÚŒŞ
è((Ñwt_cÚŒŞè& 
	`BIT
(3)è>> 3)

	)

106 
	#SLSI_GET_TWT_MIN_SERVICE_PERIOD
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[2] & (
	`BIT
(0è| BIT(1)))

	)

107 
	#SLSI_GET_TWT_mš_¦“p_³riod
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[2] & (
	`BIT
(2è| BIT(3))è>> 2)

	)

108 
	#SLSI_TWT_REQ_SUPPORTED
 
	`BIT
(1)

	)

109 
	#SLSI_TWT_BROADCAST_SUPPORTED
 
	`BIT
(2)

	)

110 
	#SLSI_TWT_FLEXIBLE_SUPPORTED
 
	`BIT
(3)

	)

111 
	#SLSI_SET_TWT_MIN_SERVICE_PERIOD
(
twt
, 
mš_£rviû_³riod
è(Ñwtè|ğ((mš_£rviû_³riodè<< 4))

	)

112 
	#SLSI_SET_TWTMIN_SLEEP_PERIOD
(
twt
, 
mš_¦“p_³riod
è(Ñwtè|ğ((mš_¦“p_³riodè<< 6))

	)

113 
	#SLSI_GET_WIFI_OPTIMIZER_SUPPORT
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[3] & 
	`BIT
(0))

	)

114 
	#SLSI_GET_DYNAMIC_DWELL_CONTROL
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[3] & 
	`BIT
(1)è>> 1)

	)

115 
	#SLSI_GET_ENHANCED_PASSIVE_SCAN
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[3] & 
	`BIT
(2)è>> 2)

	)

117 
	#SLSI_WIFI_OPTIMIZER_SUPPORTED
 
	`BIT
(0)

	)

118 
	#SLSI_DYNAMIC_DWELL_CONTROL_SUPPORTED
 
	`BIT
(1)

	)

119 
	#SLSI_ENHANCED_PASSIVE_SCAN_SUPPORDED
 
	`BIT
(2)

	)

120 
	#SLSI_GET_SCHED_PM_SUPPORT
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[4] & 
	`BIT
(0))

	)

121 
	#SLSI_SCHED_PM_ENABLED
 
	`BIT
(0)

	)

122 
	#SLSI_GET_DELAYED_WAKEUP_SUPPORT
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[5] & 
	`BIT
(0))

	)

123 
	#SLSI_DELAYED_WAKEUP_ENABLED
 
	`BIT
(0)

	)

124 
	#SLSI_GET_DUAL_IFACE_SUPPORT
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[6] & 
	`BIT
(0))

	)

125 
	#SLSI_GET_SUPPORT_5G
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[6] & 
	`BIT
(1)è>> 1)

	)

126 
	#SLSI_GET_SUPPORT_6G
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[6] & 
	`BIT
(2)è>> 2)

	)

127 
	#SLSI_DUAL_IFACE_ENABLED
 
	`BIT
(0)

	)

128 
	#SLSI_5G_SUPPORT
 
	`BIT
(1)

	)

129 
	#SLSI_6G_SUPPORT
 
	`BIT
(2)

	)

130 
	#SLSI_SET_MAX_CLIENT
(
max_şi
è((max_şiè<< 3)

	)

131 
	#SLSI_COUNTRY_CODE_SET_API_SUPPORTED
 
	`BIT
(7)

	)

132 
	#SLSI_QSF_VALID_CHAN_API_SUPPORTED
 
	`BIT
(8)

	)

133 
	#SLSI_HE_ENABLED
 
	`BIT
(9)

	)

134 
	#SLSI_WPA3_ENABLED
 
	`BIT
(10)

	)

135 
	#SLSI_GET_ROAMING_MAJOR_NUMBER
(
­³ndix_v”siÚs
è(×µ’dix_v”siÚsè& 0x000000FF)

	)

136 
	#SLSI_GET_ROAMING_MINOR_NUMBER
(
­³ndix_v”siÚs
è((×µ’dix_v”siÚsè& 0x0000FF00è>> 8)

	)

137 
	#SLSI_GET_HIGH_CHAN_UTILIZATON_TRIGGER
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(0))

	)

138 
	#SLSI_GET_EMERGENCY_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(1)è>> 1)

	)

139 
	#SLSI_GET_BTM_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(2)è>> 2)

	)

140 
	#SLSI_GET_IDLE_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(3)è>> 3)

	)

141 
	#SLSI_GET_WTC_ROAMING_TRIGGER
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(4)è>> 4)

	)

142 
	#SLSI_GET_BT_COEX_ROAMING
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(5)è>> 5)

	)

143 
	#SLSI_GET_ROAMING_BETWEEN_WPA_AND_WPA2
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(6)è>> 6)

	)

144 
	#SLSI_GET_MANAGE_CHAN_LIST_API
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[7] & 
	`BIT
(7)è>> 7)

	)

145 
	#SLSI_GET_ADAPTIVE_11R
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[8] & 
	`BIT
(0))

	)

146 
	#SLSI_GET_ROAMING_CTRL_API_1_2
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[8] & 
	`BIT
(1)è>> 1)

	)

147 
	#SLSI_GET_ROAMING_CTRL_API_3_4
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[8] & 
	`BIT
(2)è>> 2)

	)

148 
	#SLSI_GET_ROAMING_CTRL_API_5
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[8] & 
	`BIT
(3)è>> 3)

	)

149 
	#SLSI_HIGH_CHAN_UTILIZATON_TRIGGER
 
	`BIT
(16)

	)

150 
	#SLSI_EMERGENCY_ROAMING_TRIGGER
 
	`BIT
(17)

	)

151 
	#SLSI_BTM_ROAMING_TRIGGER
 
	`BIT
(18)

	)

152 
	#SLSI_IDLE_ROAMING_TRIGGER
 
	`BIT
(19)

	)

153 
	#SLSI_WTC_ROAMING_TRIGGER
 
	`BIT
(20)

	)

154 
	#SLSI_BT_COEX_ROAMING
 
	`BIT
(21)

	)

155 
	#SLSI_ROAMING_BETWEEN_WPA_AND_WPA2
 
	`BIT
(22)

	)

156 
	#SLSI_MANAGE_CHAN_LIST_API
 
	`BIT
(23)

	)

158 
	#SLSI_ADAPTIVE_11R
 
	`BIT
(24)

	)

159 
	#SLSI_ROAMING_CTRL_API_1_2
 
	`BIT
(25)

	)

160 
	#SLSI_ROAMING_CTRL_API_3_4
 
	`BIT
(26)

	)

161 
	#SLSI_ROAMING_CTRL_API_5
 
	`BIT
(27)

	)

162 
	#SLSI_GET_NCHO_MAJOR_NUMBER
(
­³ndix_v”siÚs
è((×µ’dix_v”siÚsè& 0x00FF0000è>> 16)

	)

163 
	#SLSI_GET_NCHO_MINOR_NUMBER
(
­³ndix_v”siÚs
è((×µ’dix_v”siÚsè& 0xFF000000è>> 24)

	)

164 
	#SLSI_GET_SUPPORT_MGMT_FRAMES
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[10] & 
	`BIT
(0))

	)

165 
	#SLSI_GET_SUPPORT_CTRL_FRAMES
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[10] & 
	`BIT
(1)è>> 1)

	)

166 
	#SLSI_GET_SUPPORT_DATA_FRAMES
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[10] & 
	`BIT
(2)è>> 2)

	)

167 
	#SLSI_MGMT_FRAME_ENABLED
 
	`BIT
(0)

	)

168 
	#SLSI_CTRL_FRAME_ENABLED
 
	`BIT
(1)

	)

169 
	#SLSI_DATA_FRAME_ENABLED
 
	`BIT
(2)

	)

170 
	#SLSI_SUPPORT_SAE_H2E
 
	`BIT
(0)

	)

171 
	#SLSI_SUPPORT_SAE_FT
 
	`BIT
(1)

	)

172 
	#SLSI_SUPPORT_SUITE_B
 
	`BIT
(2)

	)

173 
	#SLSI_SUPPORT_SUITE_B_192
 
	`BIT
(3)

	)

174 
	#SLSI_SUPPORT_SHA_256
 
	`BIT
(4)

	)

175 
	#SLSI_SUPPORT_SHA_384
 
	`BIT
(5)

	)

176 
	#SLSI_SUPPORT_SHA_256_FT
 
	`BIT
(6)

	)

177 
	#SLSI_SUPPORT_SHA_384_FT
 
	`BIT
(7)

	)

178 
	#SLSI_SUPPORT_OWE
 
	`BIT
(8)

	)

179 
	#SLSI_QSF_NAN_SUPPORTED
 
	`BIT
(0)

	)

180 
	#SLSI_QSF_TDLS_SUPPORTED
 
	`BIT
(1)

	)

181 
	#SLSI_QSF_6E_SUPPORTED
 
	`BIT
(2)

	)

182 
	#SLSI_QSF_P2P_LISTEN_OFFLOADING_SUPPORTED
 
	`BIT
(3)

	)

183 
	#SLSI_QSF_NOA_PS_P2P_SUPPORTED
 
	`BIT
(4)

	)

184 
	#SLSI_QSF_TDLS_OFFCHANNEL_SUPPORTED
 
	`BIT
(5)

	)

185 
	#SLSI_QSF_TDLS_CAPA_ENHANCE_SUPPORTED
 
	`BIT
(6)

	)

186 
	#SLSI_QSF_TDLS_PEER_UAPSD_SUPPORTED
 
	`BIT
(7)

	)

187 
	#SLSI_GET_MAX_NAN_NDPS
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[14] & 0xF0)

	)

188 
	#SLSI_QSF_STA_P2P_SUPPORTED
 
	`BIT
(0)

	)

189 
	#SLSI_QSF_STA_SOFTAP_SUPPORTED
 
	`BIT
(1)

	)

190 
	#SLSI_QSF_STA_NAN_SUPPORTED
 
	`BIT
(2)

	)

191 
	#SLSI_QSF_STA_TDLS_SUPPORTED
 
	`BIT
(3)

	)

192 
	#SLSI_QSF_STA_SOFTAP_P2P_SUPPORTED
 
	`BIT
(4)

	)

193 
	#SLSI_QSF_STA_SOFTAP_NAN_SUPPORTED
 
	`BIT
(5)

	)

194 
	#SLSI_QSF_STA_P2P_P2P_SUPPORTED
 
	`BIT
(6)

	)

195 
	#SLSI_QSF_STA_P2P_NAN_SUPPORTED
 
	`BIT
(7)

	)

196 
	#SLSI_QSF_STA_P2P_TDLS_SUPPORTED
 
	`BIT
(0)

	)

197 
	#SLSI_QSF_STA_SOFTAP_TDLS_SUPPORTED
 
	`BIT
(1)

	)

198 
	#SLSI_QSF_STA_NAN_TDLS_SUPPORTED
 
	`BIT
(2)

	)

199 
	#SLSI_QSF_STA_SOFTAP_P2P_TDLS_SUPPORTED
 
	`BIT
(3)

	)

200 
	#SLSI_QSF_STA_SOFTAP_NAN_TDLS_SUPPORTED
 
	`BIT
(4)

	)

201 
	#SLSI_QSF_STA_P2P_P2P_TDLS_SUPPORTED
 
	`BIT
(5)

	)

202 
	#SLSI_QSF_STA_P2P_NAN_TDLS_SUPPORTED
 
	`BIT
(6)

	)

203 
	#SLSI_GET_STANDARD_NAN_6E_SUPPORT
(
misc_ã©u»s_aùiv©ed
è(misc_ã©u»s_aùiv©ed[17] & 
	`BIT
(0))

	)

204 
	#SLSI_GET_SAMSUNG_NAN_6E_SUPPORT
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[17] & 
	`BIT
(1)è>> 1)

	)

205 
	#SLSI_GET_NAN_VERSION
(
misc_ã©u»s_aùiv©ed
è((misc_ã©u»s_aùiv©ed[17] & (
	`BIT
(3) |\

206 
	`BIT
(4è| BIT(5))è>> 3)

	)

207 
	#SLSI_QSF_STANDARD_NAN_6E_SUPPORTED
 
	`BIT
(0)

	)

208 
	#SLSI_QSF_SAMSUNG_NAN_6E_SUPPORTED
 
	`BIT
(1)

	)

209 
	#SLSI_QSF_NAN_FAST_CONNECT_SUPPORTED
 
	`BIT
(2)

	)

210 
	#SLSI_QSF_NAN_VERSION_SET
(
Çn_v”siÚ
è(Òª_v”siÚè<< 3)

	)

211 
	#SLSI_QSF_BSSI_INFO_API_SUPP_ENABLED
 
	`BIT
(0)

	)

212 
	#SLSI_QSF_ASSOC_REJECT_INFO_API_ENABLED
 
	`BIT
(1)

	)

213 
	#SLSI_QSF_STA_INFO_API_SUPP_ENABLED
 
	`BIT
(2)

	)

215 
	#SLSI_QSF_SECURITY_FEATURE_MASK
 (
SLSI_SUPPORT_SAE_H2E
 | 
SLSI_SUPPORT_SAE_FT
 | 
SLSI_SUPPORT_SUITE_B
 |\

216 
SLSI_SUPPORT_SUITE_B_192
 | 
SLSI_SUPPORT_SHA_256
 |\

217 
SLSI_SUPPORT_SHA_384
 | 
SLSI_SUPPORT_SHA_256_FT
 |\

218 
SLSI_SUPPORT_SHA_384_FT
 | 
SLSI_SUPPORT_OWE
)

	)

219 
	#SLSI_QSF_P2P_FEATURE_1ST_BYTE_MASK
 (
SLSI_QSF_P2P_LISTEN_OFFLOADING_SUPPORTED
 |\

220 
SLSI_QSF_NOA_PS_P2P_SUPPORTED
 |\

221 
SLSI_QSF_TDLS_OFFCHANNEL_SUPPORTED
 |\

222 
SLSI_QSF_TDLS_CAPA_ENHANCE_SUPPORTED
)

	)

223 
	#SLSI_QSF_P2P_FEATURE_3RD_BYTE_MASK
 (
SLSI_QSF_STA_P2P_SUPPORTED
 | 
SLSI_QSF_STA_SOFTAP_SUPPORTED
 |\

224 
SLSI_QSF_STA_NAN_SUPPORTED
 | 
SLSI_QSF_STA_TDLS_SUPPORTED
 |\

225 
SLSI_QSF_STA_SOFTAP_P2P_SUPPORTED
 |\

226 
SLSI_QSF_STA_SOFTAP_NAN_SUPPORTED
 |\

227 
SLSI_QSF_STA_P2P_P2P_SUPPORTED
 |\

228 
SLSI_QSF_STA_P2P_NAN_SUPPORTED
)

	)

229 
	#SLSI_QSF_P2P_FEATURE_4TH_BYTE_MASK
 (
SLSI_QSF_STA_P2P_TDLS_SUPPORTED
 |\

230 
SLSI_QSF_STA_SOFTAP_TDLS_SUPPORTED
 |\

231 
SLSI_QSF_STA_NAN_TDLS_SUPPORTED
 |\

232 
SLSI_QSF_STA_SOFTAP_P2P_TDLS_SUPPORTED
 |\

233 
SLSI_QSF_STA_SOFTAP_NAN_TDLS_SUPPORTED
 |\

234 
SLSI_QSF_STA_P2P_P2P_TDLS_SUPPORTED
 |\

235 
SLSI_QSF_STA_P2P_NAN_TDLS_SUPPORTED
)

	)

236 
	#SLSI_MAX_TDLS_LINK
 (4)

	)

237 
	#SLSI_WIFI_5
 1

	)

238 
	#SLSI_WIFI_4
 0

	)

239 
	#SLSI_QSF_FEATURE_VER_LEN
 4

	)

240 
	#SLSI_QSF_SOLUTION_PROVIDER
 3

	)

241 
	#SLSI_QSF_SW_FEATURE_CHAR_LEN
 4

	)

242 
	#SLSI_QSF_WIFI_FEATURE_VERSION
 1

	)

243 
	#SLSI_QSF_WIFI_HCF_FILE_NAME
 "wÏn_sw.hcf"

	)

244 
	#SLSI_HCF_HEADER_LEN
 8

	)

246 
	s¦si_qsf_mib_d©a
 {

247 
boŞ
 
	mhe_aùive
;

248 
boŞ
 
	mtwt_aùive
;

249 
boŞ
 
	mhe_soá­_aùive
;

250 
boŞ
 
	mw·3_aùive
;

251 
boŞ
 
	mtdls_aùive
;

252 
boŞ
 
	mtdls_³”_u­sd_aùive
;

253 
boŞ
 
	mÇn_ç¡_cÚÃù
;

254 
u16
 
	mmax_tdls_şi
;

255 
u8
 
	mht_ÿps
[21];

256 
u8
 
	mvht_ÿps
[12];

257 
u8
 
	mhe_ÿps
[32];

258 
u8
 
	mmisc_ã©u»s_aùiv©ed
[18];

259 
u32
 
	m­³ndix_v”siÚs
;

260 
u32
 
	mtwt_cÚŒŞ
;

263 
¦si_qsf_š™
(
¦si_dev
 *
sdev
);

264 
¦si_qsf_deš™
();

265 
¦si_g‘_qsfs_ã©u»_£t
(
¦si_dev
 *
sdev
);

	@reg_info.c

6 
	~"dev.h
"

7 
	~"»g_šfo.h
"

8 
	~"debug.h
"

9 
	~"uts.h
"

10 
	~<lšux/fs.h
>

12 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

13 
MODULE_IMPORT_NS
(
VFS_š‹º®_I_am_»®ly_a_fesy¡em_ªd_am_NOT_a_driv”
);

16 
	#SLSI_REG_INFO_BUILD_REG_DOM_VER
(
majÜ
, 
mšÜ
, 
mšÜ2
) \

17 ((
majÜ
 & 0xFFè<< 16è| ((
mšÜ
 & 0xFFè<< 8è| (
mšÜ2
 & 0xFF)

	)

19 
	$¦si_»gd_š™
(
¦si_dev
 *
sdev
)

21 
›“80211_»gdomaš
 *
¦si_wÜld_»gdom_cu¡om
 = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
;

22 
›“80211_»g_ruË
 
»g_ruËs
[] = {

24 
	`REG_RULE
(2412 - 10, 2462 + 10, 40, 0, 20, 0),

26 
	`REG_RULE
(2467 - 10, 2472 + 10, 40, 0, 20, 
NL80211_RRF_NO_IR
),

28 
	`REG_RULE
(5180 - 10, 5240 + 10, 80, 0, 20, 0),

30 
	`REG_RULE
(5260 - 10, 5320 + 10, 80, 0, 20, 
NL80211_RRF_DFS
),

32 
	`REG_RULE
(5500 - 10, 5720 + 10, 80, 0, 20, 
NL80211_RRF_DFS
),

34 
	`REG_RULE
(5745 - 10, 5825 + 10, 80, 0, 20, 0),

37 
i
;

39 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "regulatory init\n");

40 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_NOT_SET
;

41 
¦si_wÜld_»gdom_cu¡om
->
n_»g_ruËs
 = ((
»g_ruËs
)) / (reg_rules[0]);

42 
i
 = 0; i < 
¦si_wÜld_»gdom_cu¡om
->
n_»g_ruËs
; i++)

43 
¦si_wÜld_»gdom_cu¡om
->
»g_ruËs
[
i
] =„eg_rules[i];

46 
¦si_wÜld_»gdom_cu¡om
->
®pha2
[0] = '0';

47 
¦si_wÜld_»gdom_cu¡om
->
®pha2
[1] = '0';

49 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, 
¦si_wÜld_»gdom_cu¡om
);

50 
	}
}

52 
	$¦si_»gd_deš™
(
¦si_dev
 *
sdev
)

54 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "slsi_regd_deinit\n");

56 
	`kä“
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
);

57 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
 = 
NULL
;

58 
	`kä“
(
sdev
->
»gdb
.
äeq_¿nges
);

59 
sdev
->
»gdb
.
äeq_¿nges
 = 
NULL
;

60 
	`kä“
(
sdev
->
»gdb
.
»g_ruËs
);

61 
sdev
->
»gdb
.
»g_ruËs
 = 
NULL
;

62 
	`kä“
(
sdev
->
»gdb
.
ruËs_cŞËùiÚ
);

63 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
 = 
NULL
;

64 
	`kä“
(
sdev
->
»gdb
.
couÁry
);

65 
sdev
->
»gdb
.
couÁry
 = 
NULL
;

66 
	}
}

68 
	$¦si_»ad_»guÏtÜy
(
¦si_dev
 *
sdev
)

70 #ià
	`IS_ENABLED
(
CONFIG_SCSC_PCIE
)

71 *
»g_fe_t
 = "slsi_reg_database.bin";

73 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(5, 4, 0))

74 *
»g_fe_t
 = "/vendor/etc/wifi/slsi_reg_database.bin";

76 *
»g_fe_t
 = "../etc/wifi/slsi_reg_database.bin";

79 
i
 = 0, 
j
 = 0, 
šdex
 = 0;

80 
ušt32_t
 
num_äeqbªds
 = 0, 
num_ruËs
 = 0, 
num_cŞËùiÚs
 = 0;

81 
süt_v”siÚ
 = 0;

82 
r
 = 0, 
off£t
 = 0;

83 cÚ¡ 
fœmw¬e
 *
fœm
;

85 ià(
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_SET
) {

86 
	`SLSI_INFO
(
sdev
, "DB V”:%d.%d.%d, Num CouÁr›s:%d\n", sdev->
»gdb
.
db_majÜ_v”siÚ
,

87 
sdev
->
»gdb
.
db_mšÜ_v”siÚ
, sdev->»gdb.
db_2nd_mšÜ_v”siÚ
, sdev->»gdb.
num_couÁr›s
);

88 
sdev
->
»g_dom_v”siÚ
 = 
	`SLSI_REG_INFO_BUILD_REG_DOM_VER
(sdev->
»gdb
.
db_majÜ_v”siÚ
,

89 
sdev
->
»gdb
.
db_mšÜ_v”siÚ
,

90 
sdev
->
»gdb
.
db_2nd_mšÜ_v”siÚ
);

94 
r
 = 
	`mx140_»que¡_fe
(
sdev
->
maxw–l_cÜe
, 
»g_fe_t
, &
fœm
);

95 ià(
r
) {

96 
	`SLSI_INFO
(
sdev
, "E¼Ü Lßdšg % f%d\n", 
»g_fe_t
, 
r
);

97 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_ERROR
;

98  -
EINVAL
;

101 ià(
	`fœmw¬e_»ad
(
fœm
, &
süt_v”siÚ
, (
ušt32_t
), &
off£t
) < 0) {

102 
	`SLSI_INFO
(
sdev
, "Failedo„ead script version\n");

103 
ex™
;

106 ià(
süt_v”siÚ
 > 3) {

107 
	`SLSI_INFO
(
sdev
, "DB unknowÀsüˆv”siÚ:%d. AbÜˆDB f»ad\n", 
süt_v”siÚ
);

108 
ex™
;

111 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
db_majÜ_v”siÚ
, (
ušt32_t
), &
off£t
) < 0) {

112 
	`SLSI_INFO
(
sdev
, "FaedØ»ad„egdb majÜ v”siÚ %u\n", sdev->
»gdb
.
db_majÜ_v”siÚ
);

113 
ex™
;

115 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
db_mšÜ_v”siÚ
, (
ušt32_t
), &
off£t
) < 0) {

116 
	`SLSI_INFO
(
sdev
, "FaedØ»ad„egdb mšÜ v”siÚ %u\n", sdev->
»gdb
.
db_mšÜ_v”siÚ
);

117 
ex™
;

121 
sdev
->
»gdb
.
db_2nd_mšÜ_v”siÚ
 = 0;

122 ià(
süt_v”siÚ
 >= 3) {

123 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
db_2nd_mšÜ_v”siÚ
, (
ušt32_t
), &
off£t
) < 0) {

124 
	`SLSI_INFO
(
sdev
, "FaedØ»ad„egdb 2nd mšÜ v”siÚ %u\n", sdev->
»gdb
.
db_mšÜ_v”siÚ
);

125 
ex™
;

128 ià(
	`fœmw¬e_»ad
(
fœm
, &
num_äeqbªds
, (
ušt32_t
), &
off£t
) < 0) {

129 
	`SLSI_INFO
(
sdev
, "FaedØ»ad Numb” oàF»qu’cy bªd %u\n", 
num_äeqbªds
);

130 
ex™
;

133 
sdev
->
»gdb
.
äeq_¿nges
 = 
	`km®loc
((*sdev->»gdb.äeq_¿ngesè* 
num_äeqbªds
, 
GFP_KERNEL
);

134 ià(!
sdev
->
»gdb
.
äeq_¿nges
) {

135 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->freq_ranges failed\n");

136 
ex™
;

138 
i
 = 0; i < 
num_äeqbªds
; i++) {

139 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
äeq_¿nges
[
i
], (
»gdb_fe_äeq_¿nge
), &
off£t
) < 0) {

140 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb freq_ranges\n");

141 
ex™_äeq_¿nges
;

145 ià(
	`fœmw¬e_»ad
(
fœm
, &
num_ruËs
, (
ušt32_t
), &
off£t
) < 0) {

146 
	`SLSI_ERR
(
sdev
, "Failedo„ead‚um_rules\n");

147 
ex™_äeq_¿nges
;

150 
sdev
->
»gdb
.
»g_ruËs
 = 
	`km®loc
((*sdev->»gdb.»g_ruËsè* 
num_ruËs
, 
GFP_KERNEL
);

151 ià(!
sdev
->
»gdb
.
»g_ruËs
) {

152 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->reg_rules failed\n");

153 
ex™_äeq_¿nges
;

155 
i
 = 0; i < 
num_ruËs
; i++) {

156 ià(
	`fœmw¬e_»ad
(
fœm
, &
šdex
, (
ušt32_t
), &
off£t
) < 0) {

157 
	`SLSI_ERR
(
sdev
, "Failedo„ead index\n");

158 
ex™_»g_ruËs
;

160 
sdev
->
»gdb
.
»g_ruËs
[
i
].
äeq_¿nge
 = &sdev->»gdb.
äeq_¿nges
[
šdex
];

161 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
»g_ruËs
[
i
].
max_eœp
, (
ušt32_t
), &
off£t
) < 0) {

162 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb„eg_rules\n");

163 
ex™_»g_ruËs
;

165 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
»g_ruËs
[
i
].
æags
, (
ušt32_t
), &
off£t
) < 0) {

166 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb flags\n");

167 
ex™_»g_ruËs
;

171 ià(
	`fœmw¬e_»ad
(
fœm
, &
num_cŞËùiÚs
, (
ušt32_t
), &
off£t
) < 0) {

172 
	`SLSI_ERR
(
sdev
, "Failedo„ead‚um_collections\n");

173 
ex™_»g_ruËs
;

176 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
 = 
	`km®loc
((*sdev->»gdb.ruËs_cŞËùiÚè* 
num_cŞËùiÚs
, 
GFP_KERNEL
);

177 ià(!
sdev
->
»gdb
.
ruËs_cŞËùiÚ
) {

178 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->rules_collection failed\n");

179 
ex™_»g_ruËs
;

181 
i
 = 0; i < 
num_cŞËùiÚs
; i++) {

182 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
ruËs_cŞËùiÚ
[
i
].
»g_ruË_num
, (
ušt32_t
), &
off£t
) < 0) {

183 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb„ules_collection„eg_rule_num\n");

184 
ex™_ruËs_cŞËùiÚ
;

186 
j
 = 0; j < 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
[
i
].
»g_ruË_num
; j++) {

187 ià(
	`fœmw¬e_»ad
(
fœm
, &
šdex
, (
ušt32_t
), &
off£t
) < 0) {

188 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb„ules collections index\n");

189 
ex™_ruËs_cŞËùiÚ
;

191 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
[
i
].
»g_ruË
[
j
] = &sdev->»gdb.
»g_ruËs
[
šdex
];

195 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
num_couÁr›s
, (
ušt32_t
), &
off£t
) < 0) {

196 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb‚umber of countries\n");

197 
ex™_ruËs_cŞËùiÚ
;

200 
	`SLSI_INFO
(
sdev
, "DB V”:%d.%d.%d, SüˆV”:%d, Num CouÁr›s:%d\n", sdev->
»gdb
.
db_majÜ_v”siÚ
,

201 
sdev
->
»gdb
.
db_mšÜ_v”siÚ
, sdev->»gdb.
db_2nd_mšÜ_v”siÚ
, 
süt_v”siÚ
,

202 
sdev
->
»gdb
.
num_couÁr›s
);

204 
sdev
->
»gdb
.
couÁry
 = 
	`km®loc
((*sdev->»gdb.couÁryè* sdev->»gdb.
num_couÁr›s
, 
GFP_KERNEL
);

205 ià(!
sdev
->
»gdb
.
couÁry
) {

206 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->country failed\n");

207 
ex™_ruËs_cŞËùiÚ
;

209 
i
 = 0; i < 
sdev
->
»gdb
.
num_couÁr›s
; i++) {

210 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
, 2 * (
ušt8_t
), &
off£t
) < 0) {

211 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country‡lpha2\n");

212 
ex™_couÁry
;

214 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
couÁry
[
i
].
·d_by‹
, (
ušt8_t
), &
off£t
) < 0) {

215 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country…ad_byte\n");

216 
ex™_couÁry
;

218 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
couÁry
[
i
].
İ”©šg_şass_£t
, (
ušt8_t
), &
off£t
) < 0) {

219 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country operating_class_set\n");

220 
ex™_couÁry
;

222 ià(
	`fœmw¬e_»ad
(
fœm
, &
šdex
, (
ušt32_t
), &
off£t
) < 0) {

223 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country index\n");

224 
ex™_couÁry
;

226 
sdev
->
»gdb
.
couÁry
[
i
].
cŞËùiÚ
 = &sdev->»gdb.
ruËs_cŞËùiÚ
[
šdex
];

229 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
fœm
);

230 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_SET
;

231 
sdev
->
»g_dom_v”siÚ
 = 
	`SLSI_REG_INFO_BUILD_REG_DOM_VER
(sdev->
»gdb
.
db_majÜ_v”siÚ
,

232 
sdev
->
»gdb
.
db_mšÜ_v”siÚ
,

233 
sdev
->
»gdb
.
db_2nd_mšÜ_v”siÚ
);

236 
ex™_couÁry
:

237 
	`kä“
(
sdev
->
»gdb
.
couÁry
);

238 
sdev
->
»gdb
.
couÁry
 = 
NULL
;

240 
ex™_ruËs_cŞËùiÚ
:

241 
	`kä“
(
sdev
->
»gdb
.
ruËs_cŞËùiÚ
);

242 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
 = 
NULL
;

244 
ex™_»g_ruËs
:

245 
	`kä“
(
sdev
->
»gdb
.
»g_ruËs
);

246 
sdev
->
»gdb
.
»g_ruËs
 = 
NULL
;

248 
ex™_äeq_¿nges
:

249 
	`kä“
(
sdev
->
»gdb
.
äeq_¿nges
);

250 
sdev
->
»gdb
.
äeq_¿nges
 = 
NULL
;

251 
ex™
:

252 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_ERROR
;

253 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
fœm
);

254  -
EINVAL
;

255 
	}
}

	@reg_info.h

6 #iâdeà
__SLSI_REGINFO_H__


7 
	#__SLSI_REGINFO_H__


	)

9 
¦si_»ad_»guÏtÜy
(
¦si_dev
 *
sdev
);

10 
¦si_»gd_deš™
(
¦si_dev
 *
sdev
);

11 
¦si_»gd_š™
(
¦si_dev
 *
sdev
);

13 
	e¦si_»gdb_¡©e
 {

14 
	mSLSI_REG_DB_NOT_SET
,

15 
	mSLSI_REG_DB_ERROR
,

16 
	mSLSI_REG_DB_SET
,

19 
	s»g_d©aba£
 {

20 
¦si_»gdb_¡©e
 
	m»gdb_¡©e
;

21 
ušt32_t
 
	mdb_majÜ_v”siÚ
;

22 
ušt32_t
 
	mdb_mšÜ_v”siÚ
;

23 
ušt32_t
 
	mdb_2nd_mšÜ_v”siÚ
;

24 
ušt32_t
 
	mnum_couÁr›s
;

25 
»gdb_fe_»g_ruË
 *
	m»g_ruËs
;

26 
»gdb_fe_äeq_¿nge
 *
	mäeq_¿nges
;

27 
»gdb_fe_»g_ruËs_cŞËùiÚ
 *
	mruËs_cŞËùiÚ
;

28 
»gdb_fe_»g_couÁry
 *
	mcouÁry
;

31 
	s»gdb_fe_äeq_¿nge
 {

32 
ušt32_t
 
	m¡¬t_äeq
;

33 
ušt32_t
 
	m’d_äeq
;

34 
ušt32_t
 
	mmax_bªdwidth
;

37 
	s»gdb_fe_»g_ruË
 {

38 
»gdb_fe_äeq_¿nge
 *
	mäeq_¿nge
;

39 
ušt32_t
 
	mmax_eœp
;

40 
ušt32_t
 
	mæags
;

43 
	s»gdb_fe_»g_ruËs_cŞËùiÚ
 {

44 
ušt32_t
 
	m»g_ruË_num
;

46 
»gdb_fe_»g_ruË
 *
	m»g_ruË
[12];

49 
	s»gdb_fe_»g_couÁry
 {

50 
ušt8_t
 
	m®pha2
[2];

51 
ušt8_t
 
	m·d_by‹
;

52 
ušt8_t
 
	mİ”©šg_şass_£t
;

54 
»gdb_fe_»g_ruËs_cŞËùiÚ
 *
	mcŞËùiÚ
;

	@rx.c

6 
	~<lšux/‘h”deviû.h
>

7 
	~<lšux/time.h
>

8 
	~<lšux/š‹¼u±.h
>

10 
	~"debug.h
"

11 
	~"dev.h
"

12 
	~"mgt.h
"

13 
	~"mlme.h
"

14 
	~"¤c_sšk.h
"

15 
	~"cÚ¡.h
"

16 
	~"ba.h
"

17 
	~"mib.h
"

18 
	~"ÿc.h
"

19 
	~"Æ80211_v’dÜ.h
"

20 
	~"§p.h
"

21 
	~"scsc_wifogg”_ršg_wak–ock_­i.h
"

22 
	~"log2us.h
"

24 #ifdeà
CONFIG_SCSC_WLAN_TX_API


25 
	~"tx_­i.h
"

28 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


29 
	~"scsc_wifogg”_ršgs.h
"

32 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

33 
	~<scsc/scsc_log_cŞËùÜ.h
>

36 
	$¦si_äeq_to_bªd
(
u32
 
äeq
)

38 
¦si_bªd
 = 
SLSI_FREQ_BAND_2GHZ
;

40 ià(
äeq
 < 
SLSI_5GHZ_MIN_FREQ
)

41 
¦si_bªd
 = 
SLSI_FREQ_BAND_2GHZ
;

42 ià(
äeq
 >ğ
SLSI_5GHZ_MIN_FREQ
 && f»q <ğ
SLSI_5GHZ_MAX_FREQ
)

43 
¦si_bªd
 = 
SLSI_FREQ_BAND_5GHZ
;

45 
¦si_bªd
 = 
SLSI_FREQ_BAND_6GHZ
;

46  
¦si_bªd
;

47 
	}
}

49 
›“80211_chªÃl
 *
	$¦si_fšd_sÿn_chªÃl
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
size_t
 
mgmt_Ën
, 
u16
 
äeq
)

51 
›Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

52 cÚ¡ 
u8
 *
sÿn_ds
 = 
	`cfg80211_fšd_›
(
WLAN_EID_DS_PARAMS
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

53 cÚ¡ 
u8
 *
sÿn_ht
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

54 
u8
 
chª
 = 0;

56 ià(
äeq
 < 
SLSI_5GHZ_MIN_FREQ
) {

58 ià(
sÿn_ds
)

59 
chª
 = 
sÿn_ds
[2];

60 ià(
sÿn_ht
)

61 
chª
 = 
sÿn_ht
[2];

63 ià(
chª
)

64 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
NL80211_BAND_2GHZ
);

66 ià(!
äeq
)

67  
NULL
;

69  
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

70 
	}
}

72 
›“80211_mgmt
 *
	$¦si_rx_sÿn_upd©e_ssid
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

73 
›“80211_mgmt
 *
mgmt
, 
size_t
 
mgmt_Ën
, size_ˆ*
Ãw_Ën
,

74 
u16
 
äeq
)

76 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

77 
u8
 *
Ãw_mgmt
;

78 
size_t
 
off£t
;

79 cÚ¡ 
u8
 *
mgmt_pos
;

80 cÚ¡ 
u8
 *
ssid
;

81 
i
;

82 
bªd
;

84 ià(!
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

85  
NULL
;

88 ià(!
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

89  
NULL
;

91 
ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

92 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt));

93 ià(!
ssid
) {

94 
	`SLSI_WARN
(
sdev
, "beacon with NO SSID IE\n");

95  
NULL
;

98 ià(
ssid
[1] > 0 && ssid[2] != '\0')

99  
NULL
;

101 
bªd
 = 
	`¦si_äeq_to_bªd
(
äeq
);

104 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

105 ià(
	`SLSI_ETHER_EQUAL
(
sdev
->
ssid_m­
[
i
].
bssid
, 
mgmt
->bssidè&& sdev->ssid_m­[i].
bªd
 == band) {

106 
Ãw_mgmt
 = 
	`km®loc
(
mgmt_Ën
 + 34, 
GFP_KERNEL
);

107 ià(!
Ãw_mgmt
) {

108 
	`SLSI_ERR_NODEV
("m®loøçedÖ’:%ld)\n", 
mgmt_Ën
 + 34);

109  
NULL
;

113 
	`memıy
(
Ãw_mgmt
, 
mgmt
, 
ssid
 - (
u8
 *)mgmt);

114 
off£t
 = 
ssid
 - (
u8
 *)
mgmt
;

116 
Ãw_mgmt
[
off£t
++] = 
WLAN_EID_SSID
;

117 
Ãw_mgmt
[
off£t
++] = 
sdev
->
ssid_m­
[
i
].
ssid_Ën
;

118 
	`memıy
(
Ãw_mgmt
 + 
off£t
, 
sdev
->
ssid_m­
[
i
].
ssid
, sdev->ssid_m­[i].
ssid_Ën
);

119 
off£t
 +ğ
sdev
->
ssid_m­
[
i
].
ssid_Ën
;

121 
mgmt_pos
 = 
ssid
 + ssid[1] + 2;

122 
	`memıy
(
Ãw_mgmt
 + 
off£t
, 
mgmt_pos
, 
mgmt_Ën
 - (mgmt_po - (
u8
 *)
mgmt
));

123 
off£t
 +ğ
mgmt_Ën
 - (
mgmt_pos
 - (
u8
 *)
mgmt
);

124 *
Ãw_Ën
 = 
off£t
;

126  (
›“80211_mgmt
 *)
Ãw_mgmt
;

129  
NULL
;

130 
	}
}

132 
›“80211_chªÃl
 *
	$¦si_rx_sÿn_·ss_to_cfg80211
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

133 
sk_buff
 *
skb
, 
boŞ
 
»Ëa£_skb
) {

134 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

135 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

136 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

137 
s32
 
sigÇl
;

138 
u16
 
äeq
 = 0;

139 
›“80211_chªÃl
 *
chªÃl
;

140 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

141 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

142 
time¥ec64
 
u±ime
;

144 
time¥ec
 
u±ime
;

146 ià(
id
 =ğ
MLME_SYNCHRONISED_IND
) {

147 
sigÇl
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_synchrÚi£d_šd
.
rssi
) * 100;

148 
ndev_vif
->
¡a
.
bss_cf
 = 
	`SLSI_FREQ_FW_TO_HOST
(
	`çpi_g‘_low16_u32
(
skb
, 
u
.
mlme_synchrÚi£d_šd
.
¥¬e_1
));

149 
ndev_vif
->
¡a
.
ch_width
 = 
	`çpi_g‘_low16_u32
(
skb
, 
u
.
mlme_synchrÚi£d_šd
.
¥¬e_2
) & 0x00FF;

150 
ndev_vif
->
¡a
.
´im¬y_chª_pos
 = (
	`çpi_g‘_low16_u32
(
skb
, 
u
.
mlme_synchrÚi£d_šd
.
¥¬e_2
)

153 ià(
ndev_vif
->
¡a
.
´im¬y_chª_pos
 >ğÒdev_vif->¡a.
ch_width
 / 20)) {

154 
	`SLSI_ERR_NODEV
("Invalid…rimary chan…osition %d for chan_width %d\n",

155 
ndev_vif
->
¡a
.
´im¬y_chª_pos
,‚dev_vif->¡a.
ch_width
);

156 
do_no_ÿlc
;

159 ià(
ndev_vif
->
¡a
.
ch_width
 == 20)

160 
äeq
 = 
ndev_vif
->
¡a
.
bss_cf
;

161 ià(
ndev_vif
->
¡a
.
ch_width
 == 40)

162 
äeq
 = 
ndev_vif
->
¡a
.
bss_cf
 + (ndev_vif->¡a.
´im¬y_chª_pos
 * 20) - 10;

163 ià(
ndev_vif
->
¡a
.
ch_width
 == 80)

164 
äeq
 = 
ndev_vif
->
¡a
.
bss_cf
 + (ndev_vif->¡a.
´im¬y_chª_pos
 * 20) - 30;

165 ià(
ndev_vif
->
¡a
.
ch_width
 == 160)

166 
äeq
 = 
ndev_vif
->
¡a
.
bss_cf
 + (ndev_vif->¡a.
´im¬y_chª_pos
 * 20) - 70;

169 
sigÇl
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
) * 100;

170 
äeq
 = 
	`SLSI_FREQ_FW_TO_HOST
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
));

172 
do_no_ÿlc
:

173 
chªÃl
 = 
	`¦si_fšd_sÿn_chªÃl
(
sdev
, 
mgmt
, 
mgmt_Ën
, 
äeq
);

174 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

175 
u±ime
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

176 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

177 
u±ime
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

179 
	`g‘_mÚÙÚic_boÙtime
(&
u±ime
);

181 
	`SLSI_UNUSED_PARAMETER
(
dev
);

184 
mgmt
->
u
.
b—cÚ
.
time¡amp
 = (
u±ime
.
tv_£c
 * 1000000è+ (u±ime.
tv_n£c
 / 1000);

186 ià(
chªÃl
) {

187 
cfg80211_bss
 *
bss
;

188 
›“80211_mgmt
 *
mgmt_Ãw
;

189 
size_t
 
mgmt_Ãw_Ën
 = 0;

191 
mgmt_Ãw
 = 
	`¦si_rx_sÿn_upd©e_ssid
(
sdev
, 
dev
, 
mgmt
, 
mgmt_Ën
, &
mgmt_Ãw_Ën
, 
äeq
);

192 ià(
mgmt_Ãw
)

193 
bss
 = 
	`cfg80211_šfÜm_bss_äame
(
sdev
->
why
, 
chªÃl
, 
mgmt_Ãw
, 
mgmt_Ãw_Ën
, 
sigÇl
, 
GFP_KERNEL
);

195 
bss
 = 
	`cfg80211_šfÜm_bss_äame
(
sdev
->
why
, 
chªÃl
, 
mgmt
, 
mgmt_Ën
, 
sigÇl
, 
GFP_KERNEL
);

197 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
bss
);

198 
	`kä“
(
mgmt_Ãw
);

200 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "NØChªÃÈšfØfound fÜ f»q:%d\n", 
äeq
);

203 ià(
»Ëa£_skb
)

204 
	`kä“_skb
(
skb
);

205  
chªÃl
;

206 
	}
}

208 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

209 
	$¦si_pİuÏ‹_bssid_šfo
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

210 
sk_buff
 *
skb
, 
li¡_h—d
 *
bssid_li¡
)

212 
li¡_h—d
 *
pos
;

213 
¦si_bssid_šfo
 *
cu¼’t_»suÉ
;

214 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

215 
cu¼’t_rssi
;

216 
u16
 
cu¼’t_äeq
;

218 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

219 
cu¼’t_äeq
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
);

221 
	`li¡_fÜ_—ch
(
pos
, 
bssid_li¡
) {

222 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_bssid_šfo, 
li¡
);

224 ià(
	`SLSI_ETHER_EQUAL
(
bssid_šfo
->
bssid
, 
mgmt
->bssid)) {

226 
bssid_šfo
->
rssi
 = 
cu¼’t_rssi
;

227 
bssid_šfo
->
äeq
 = 
cu¼’t_äeq
;

232 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

233 ià(!
cu¼’t_»suÉ
) {

234 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for bssid info\n");

237 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, 
mgmt
->bssid);

238 
cu¼’t_»suÉ
->
rssi
 = 
cu¼’t_rssi
;

239 
cu¼’t_»suÉ
->
äeq
 = 
cu¼’t_äeq
;

240 
cu¼’t_»suÉ
->
cÚÃù_©‹m±ed
 = 
çl£
;

241 
	`li¡_add_
(&
cu¼’t_»suÉ
->
li¡
, 
bssid_li¡
);

244 
	}
}

246 
šlše
 
	$¦si_g’_Ãw_bssid
(cÚ¡ 
u8
 *
bssid
, u8 
max_bssid
,

247 
u8
 
mbssid_šdex
, u8 *
Ãw_bssid
)

249 
u64
 
bssid_u64
 = 
	`‘h”_addr_to_u64
(
bssid
);

250 
u64
 
mask
 = 
	`GENMASK_ULL
(
max_bssid
 - 1, 0);

251 
u64
 
Ãw_bssid_u64
;

253 
Ãw_bssid_u64
 = 
bssid_u64
 & ~
mask
;

255 
Ãw_bssid_u64
 |ğ((
bssid_u64
 & 
mask
è+ 
mbssid_šdex
) & mask;

257 
	`u64_to_‘h”_addr
(
Ãw_bssid_u64
, 
Ãw_bssid
);

258 
	}
}

260 
	$¦si_mbssid_to_ssid_li¡
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

261 
u8
 *
sÿn_ssid
, 
ssid_Ën
,

262 
u8
 *
bssid
, 
äeq
, 
rssi
, u8 
akm_ty³
)

264 
li¡_h—d
 *
pos
;

265 
found
 = 0;

267 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

268 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

269 
li¡_h—d
 *
pos_bssid
;

270 
¦si_bssid_šfo
 *
cu¼’t_»suÉ
;

272 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 == ssid_len &&

273 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, 
sÿn_ssid
, 
ssid_Ën
) == 0 &&

274 
ssid_šfo
->
akm_ty³
 &‡km_type) {

275 
found
 = 1;

277 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

278 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

280 ià(
	`SLSI_ETHER_EQUAL
(
bssid_šfo
->
bssid
, bssid)) {

282 
bssid_šfo
->
rssi
 =„ssi;

283 
bssid_šfo
->
äeq
 = freq;

287 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

288 ià(!
cu¼’t_»suÉ
) {

289 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for bssid info\n");

292 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, bssid);

293 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "BSSID EÁry : %pM\n", 
bssid
);

294 
cu¼’t_»suÉ
->
rssi
 =„ssi;

295 
cu¼’t_»suÉ
->
äeq
 = freq;

296 
cu¼’t_»suÉ
->
cÚÃù_©‹m±ed
 = 
çl£
;

297 
	`li¡_add_
(&
cu¼’t_»suÉ
->
li¡
, &
ssid_šfo
->
bssid_li¡
);

301 ià(!
found
) {

302 
¦si_ssid_šfo
 *
ssid_šfo
;

303 
¦si_bssid_šfo
 *
cu¼’t_»suÉ
;

305 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "SSID EÁry : %.*s\n", 
ssid_Ën
, 
sÿn_ssid
);

306 
ssid_šfo
 = 
	`km®loc
((*ssid_šfo), 
GFP_KERNEL
);

307 ià(
ssid_šfo
) {

308 
ssid_šfo
->
ssid
.
ssid_Ën
 = ssid_len;

309 
	`memıy
(
ssid_šfo
->
ssid
.ssid, 
sÿn_ssid
, 
ssid_Ën
);

310 
ssid_šfo
->
akm_ty³
 =‡km_type;

311 
	`INIT_LIST_HEAD
(&
ssid_šfo
->
bssid_li¡
);

312 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

313 ià(!
cu¼’t_»suÉ
) {

314 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for bssid info\n");

317 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, bssid);

318 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "New BSSID EÁry : %pM\n", 
bssid
);

319 
cu¼’t_»suÉ
->
rssi
 =„ssi;

320 
cu¼’t_»suÉ
->
äeq
 = freq;

321 
cu¼’t_»suÉ
->
cÚÃù_©‹m±ed
 = 
çl£
;

322 
	`li¡_add_
(&
cu¼’t_»suÉ
->
li¡
, &
ssid_šfo
->
bssid_li¡
);

323 
	`li¡_add
(&
ssid_šfo
->
li¡
, &
ndev_vif
->
¡a
.ssid_info);

325 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for ssid info\n");

330 
	}
}

332 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 1, 0))

333 
	$¦si_exŒaù_mbssids
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

334 cÚ¡ 
›“80211_mgmt
 *
mgmt
,

335 
sk_buff
 *
skb
, 
u8
 
akm_ty³
)

337 
u8
 *
Œªsm™‹r_bssid
;

338 cÚ¡ 
u8
 *
´obe_b—cÚ
;

339 cÚ¡ 
u8
 *
›
;

340 
›_Ën
;

341 
cu¼’t_rssi
;

342 
u16
 
cu¼’t_äeq
;

343 
size_t
 
mgmt_Ën
;

344 cÚ¡ 
–em’t
 *
–em
, *
sub_–em
;

346 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

347 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

348 
cu¼’t_äeq
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
);

350 
Œªsm™‹r_bssid
 = (
u8
 *)
mgmt
->
bssid
;

351 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

352 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
;

353 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

355 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
;

356 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

358 
›
 = 
´obe_b—cÚ
;

360 
	`fÜ_—ch_–em’t_id
(
–em
, 
WLAN_EID_MULTIPLE_BSSID
, 
›
, 
›_Ën
) {

361 ià((
–em
->
d©a
 - 
›
è+ƒËm->
d©®’
 > 
›_Ën
) {

362 
	`SLSI_WARN
(
sdev
, "Invalid ie†ength found\n");

366 ià(
–em
->
d©®’
 < 4)

369 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "MBSSID IE Found\n");

370 
	`fÜ_—ch_–em’t
(
sub_–em
, 
–em
->
d©a
 + 1,ƒËm->
d©®’
 - 1) {

371 
u8
 
Ãw_bssid
[
ETH_ALEN
];

372 cÚ¡ 
u8
 *
sÿn_ssid
;

373 cÚ¡ 
u8
 *
šdex
;

374 cÚ¡ 
u8
 *
ssid_›
;

375 
ssid_Ën
 = 0;

377 ià((
sub_–em
->
d©a
 - (
u8
 *)
–em
è+ sub_–em->
d©®’
 >ƒlem->datalen) {

378 
	`SLSI_WARN
(
sdev
, "Invalid mbssid set†ength found\n");

383 ià(
sub_–em
->
id
 !ğ0 || sub_–em->
d©®’
 < 4) {

388 ià(
sub_–em
->
d©a
[0] !ğ
WLAN_EID_NON_TX_BSSID_CAP
 ||

389 
sub_–em
->
d©a
[1] != 2) {

399 
šdex
 = 
	`cfg80211_fšd_›
(
WLAN_EID_MULTI_BSSID_IDX
,

400 
sub_–em
->
d©a
, sub_–em->
d©®’
);

401 ià(!
šdex
 || index[1] < 1 || index[2] == 0) {

405 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
sub_–em
->
d©a
, sub_–em->
d©®’
);

406 ià(!
ssid_›
 || ssid_›[1] >ğ
IEEE80211_MAX_SSID_LEN
)

408 
ssid_Ën
 = 
ssid_›
[1];

409 
sÿn_ssid
 = &
ssid_›
[2];

410 
	`¦si_g’_Ãw_bssid
(
Œªsm™‹r_bssid
,

411 
–em
->
d©a
[0], 
šdex
[2], 
Ãw_bssid
);

412 
	`¦si_mbssid_to_ssid_li¡
(
sdev
, 
ndev_vif
, (
u8
 *)
sÿn_ssid
, 
ssid_Ën
, 
Ãw_bssid
, 
cu¼’t_äeq
,

413 
cu¼’t_rssi
, 
akm_ty³
);

418 
	}
}

420 
	$¦si_exŒaù_mbssids
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

421 cÚ¡ 
›“80211_mgmt
 *
mgmt
,

422 
sk_buff
 *
skb
, 
u8
 
akm_ty³
)

424 
u8
 *
Œªsm™‹r_bssid
;

425 cÚ¡ 
u8
 *
sub_–em
;

426 
–’
;

427 cÚ¡ 
u8
 *
pos
;

428 cÚ¡ 
u8
 *
´obe_b—cÚ
;

429 cÚ¡ 
u8
 *
›
;

430 
›_Ën
;

431 
cu¼’t_rssi
;

432 
u16
 
cu¼’t_äeq
;

433 
size_t
 
mgmt_Ën
;

434 
couÁ
 = 0;

436 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

437 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

438 
cu¼’t_äeq
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
);

440 
Œªsm™‹r_bssid
 = (
u8
 *)
mgmt
->
bssid
;

441 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

442 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
;

443 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

445 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
;

446 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

448 
›
 = 
´obe_b—cÚ
;

450 
›
 && (
›_Ën
 > i- 
´obe_b—cÚ
)) {

451 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_MULTIPLE_BSSID
, ie, 
›_Ën
 - (› - 
´obe_b—cÚ
));

452 ià(!
›
)

455 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "MBSSID IE Found\n");

456 
pos
 = &
›
[2];

457 
–’
 = 
›
[1];

458 
sub_–em
 = 
pos
 + 1; sub_–em <…o + 
–’
 - 1;

459 
sub_–em
 += 2 + sub_elem[1]) {

460 
u8
 
sub_Ën
 = 
sub_–em
[1];

461 
u8
 
Ãw_bssid
[
ETH_ALEN
];

462 cÚ¡ 
u8
 *
sÿn_ssid
;

463 cÚ¡ 
u8
 *
šdex
;

464 cÚ¡ 
u8
 *
ssid_›
;

465 
ssid_Ën
 = 0;

467 
couÁ
++;

468 ià(
couÁ
 > 127) {

469 
	`SLSI_INFO_NODEV
("Infinite Loop\n");

472 ià(
sub_–em
[0] != 0 || sub_elem[1] < 4) {

477 ià(
sub_–em
[2] !ğ
WLAN_EID_NON_TX_BSSID_CAP
 ||

478 
sub_–em
[3] != 2) {

488 
šdex
 = 
	`cfg80211_fšd_›
(
WLAN_EID_MULTI_BSSID_IDX
,

489 
sub_–em
 + 2, 
sub_Ën
);

490 ià(!
šdex
 || index[1] < 1 || index[2] == 0) {

494 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
sub_–em
 + 2, 
sub_Ën
);

495 ià(!
ssid_›
 || ssid_›[1] >ğ
IEEE80211_MAX_SSID_LEN
)

497 
ssid_Ën
 = 
ssid_›
[1];

498 
sÿn_ssid
 = &
ssid_›
[2];

499 
	`¦si_g’_Ãw_bssid
(
Œªsm™‹r_bssid
,

500 
pos
[0], 
šdex
[2], 
Ãw_bssid
);

501 
	`¦si_mbssid_to_ssid_li¡
(
sdev
, 
ndev_vif
, (
u8
 *)
sÿn_ssid
, 
ssid_Ën
, 
Ãw_bssid
, 
cu¼’t_äeq
,

502 
cu¼’t_rssi
, 
akm_ty³
);

504 
›
 += ie[1] + 2;

507 
	}
}

510 
	$¦si_»move_assoc_di§Îowed_bssid
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

511 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
)

513 
li¡_h—d
 *
pos
;

515 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

516 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

517 
li¡_h—d
 *
pos_bssid
;

519 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
sÿn_»suÉ
->
ssid_Ëngth
 ||

520 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
sÿn_»suÉ
->ssid, sÿn_»suÉ->
ssid_Ëngth
) != 0 ||

521 !(
ssid_šfo
->
akm_ty³
 & 
sÿn_»suÉ
->akm_type))

524 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

525 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

527 ià(!
	`SLSI_ETHER_EQUAL
(
bssid_šfo
->
bssid
, 
sÿn_»suÉ
->bssid))

529 
	`li¡_d–
(
pos_bssid
);

530 
	`kä“
(
bssid_šfo
);

534 
	}
}

536 
	$¦si_»jeù_­_fÜ_sÿn_šfo
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

537 cÚ¡ 
›“80211_mgmt
 *
mgmt
,

538 
size_t
 
mgmt_Ën
, 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
)

540 cÚ¡ 
u8
 *
v’dÜ_›
;

541 
u8
 
›_Ëngth
;

542 
boŞ
 
di§ssoc_©Œ
 = 
çl£
;

544 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

545 
v’dÜ_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_MBO
,

546 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

547 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt));

549 
v’dÜ_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_MBO
,

550 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
,

551 
mgmt_Ën
 - (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt));

553 ià(
v’dÜ_›
)

554 
›_Ëngth
 = 
v’dÜ_›
[1];

557 
di§ssoc_©Œ
 = 
	`cfg80211_fšd_›
(
SLSI_MBO_ASSOC_DISALLOWED_ATTR_ID
, 
v’dÜ_›
 + 6, 
›_Ëngth
 - 2);

558 ià(
di§ssoc_©Œ
) {

559 
	`¦si_»move_assoc_di§Îowed_bssid
(
sdev
, 
ndev_vif
, 
sÿn_»suÉ
);

563 
	}
}

565 
	$¦si_pİuÏ‹_ssid_šfo
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

567 
li¡_h—d
 *
pos
;

568 
found
 = 0;

569 
sk_buff
 *
b—cÚ_´obe_skb
 = 
NULL
;

570 
›“80211_mgmt
 *
mgmt
 = 
NULL
;

571 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

572 
¦si_ssid_šfo
 *
ssid_šfo
;

573 
max_couÁ
, 
sÿÄesuÉcouÁ
 = 0;

575 
max_couÁ
 = 
	`¦si_dev_g‘_sÿn_»suÉ_couÁ
();

577 
sÿn_»suÉ
) {

578 
sÿÄesuÉcouÁ
++;

579 ià(
sÿÄesuÉcouÁ
 >ğ
max_couÁ
) {

580 
	`SLSI_ERR_NODEV
("Scan Result Morehan Max Scan Result Count!!\n");

583 ià(
sÿn_»suÉ
->
b—cÚ
) {

584 
b—cÚ_´obe_skb
 = 
sÿn_»suÉ
->
b—cÚ
;

585 } ià(
sÿn_»suÉ
->
´obe_»¥
) {

586 
b—cÚ_´obe_skb
 = 
sÿn_»suÉ
->
´obe_»¥
;

588 
	`SLSI_ERR_NODEV
("Scanƒntry with‚o beacon /probe„esp!!\n");

589 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

593 
mgmt
 = 
	`çpi_g‘_mgmt
(
b—cÚ_´obe_skb
);

594 ià(!
sÿn_»suÉ
->
ssid_Ëngth
 ||

595 
	`¦si_»jeù_­_fÜ_sÿn_šfo
(
sdev
, 
ndev_vif
, 
mgmt
, 
	`çpi_g‘_mgm’
(
b—cÚ_´obe_skb
), 
sÿn_»suÉ
)) {

596 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

599 
found
 = 0;

600 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

601 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

603 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
sÿn_»suÉ
->
ssid_Ëngth
 ||

604 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
sÿn_»suÉ
->ssid, sÿn_»suÉ->
ssid_Ëngth
) != 0 ||

605 !(
ssid_šfo
->
akm_ty³
 & 
sÿn_»suÉ
->akm_type))

607 
found
 = 1;

608 
	`¦si_pİuÏ‹_bssid_šfo
(
sdev
, 
ndev_vif
, 
b—cÚ_´obe_skb
, &
ssid_šfo
->
bssid_li¡
);

611 ià(
found
) {

612 
	`¦si_exŒaù_mbssids
(
sdev
, 
ndev_vif
, 
mgmt
, 
b—cÚ_´obe_skb
, 
sÿn_»suÉ
->
akm_ty³
);

613 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

617 
ssid_šfo
 = 
	`km®loc
((*ssid_šfo), 
GFP_ATOMIC
);

618 ià(
ssid_šfo
) {

619 
ssid_šfo
->
ssid
.
ssid_Ën
 = 
sÿn_»suÉ
->
ssid_Ëngth
;

620 
	`memıy
(
ssid_šfo
->
ssid
.ssid, &
sÿn_»suÉ
->ssid, sÿn_»suÉ->
ssid_Ëngth
);

621 
ssid_šfo
->
akm_ty³
 = 
sÿn_»suÉ
->akm_type;

622 
	`INIT_LIST_HEAD
(&
ssid_šfo
->
bssid_li¡
);

623 
	`¦si_pİuÏ‹_bssid_šfo
(
sdev
, 
ndev_vif
, 
b—cÚ_´obe_skb
, &
ssid_šfo
->
bssid_li¡
);

624 
	`li¡_add
(&
ssid_šfo
->
li¡
, &
ndev_vif
->
¡a
.ssid_info);

626 
	`SLSI_ERR
(
sdev
, "FaedØ®loÿ‹ƒÁry : %.* km®loc(èçed\n", 
sÿn_»suÉ
->
ssid_Ëngth
, sÿn_»suÉ->
ssid
);

628 
	`¦si_exŒaù_mbssids
(
sdev
, 
ndev_vif
, 
mgmt
, 
b—cÚ_´obe_skb
, 
sÿn_»suÉ
->
akm_ty³
);

629 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

633 
	}
}

636 
	$¦si_add_to_sÿn_li¡
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

637 
sk_buff
 *
skb
, cÚ¡ 
u8
 *
sÿn_ssid
, 
u16
 
sÿn_id
)

639 
¦si_sÿn_»suÉ
 *
h—d
;

640 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
, *
cu¼’t_»suÉ
, *
´ev
 = 
NULL
;

641 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

642 
boŞ
 
found
 = 0, 
skb_¡Üed
 = 0;

643 
cu¼’t_rssi
, 
cu¼’t_bªd
;

644 
boŞ
 
is_hidd’
 = 0, 
ssid_m©ched
 = 0;

646 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

647 
h—d
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

648 
sÿn_»suÉ
 = 
h—d
;

649 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

650 
cu¼’t_bªd
 = 
	`¦si_äeq_to_bªd
(
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2);

652 
sÿn_»suÉ
) {

653 
is_hidd’
 = 
sÿn_»suÉ
->
hidd’
 && (!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[2] == '\0');

654 
ssid_m©ched
 = 
sÿn_ssid
 && sÿn_ssid[1] && 
sÿn_»suÉ
->
ssid_Ëngth
 &&

655 (
sÿn_ssid
[1] =ğ
sÿn_»suÉ
->
ssid_Ëngth
) &&

656 !
	`memcmp
(&
sÿn_ssid
[2], 
sÿn_»suÉ
->
ssid
, scan_ssid[1]);

657 ià((
	`SLSI_ETHER_EQUAL
(
sÿn_»suÉ
->
bssid
, 
mgmt
->bssidè&& sÿn_»suÉ->
bªd
 =ğ
cu¼’t_bªd
) &&

658 (
is_hidd’
 || 
ssid_m©ched
)) {

660 ià(!
sÿn_»suÉ
->
´obe_»¥
 && 
	`›“80211_is_´obe_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

661 
sÿn_»suÉ
->
´obe_»¥
 = 
skb
;

662 
skb_¡Üed
 = 1;

663 } ià(!
sÿn_»suÉ
->
b—cÚ
 && 
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

664 
sÿn_»suÉ
->
b—cÚ
 = 
skb
;

665 
skb_¡Üed
 = 1;

666 ià(!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[2] == '\0')

667 
sÿn_»suÉ
->
hidd’
 = 1;

673 ià(
cu¼’t_rssi
 < 
sÿn_»suÉ
->
rssi
) {

674 ià(!
skb_¡Üed
)

675 
	`kä“_skb
(
skb
);

676 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

680 
sÿn_»suÉ
->
rssi
 = 
cu¼’t_rssi
;

681 ià(!
skb_¡Üed
) {

682 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

683 
	`kä“_skb
(
sÿn_»suÉ
->
b—cÚ
);

684 
sÿn_»suÉ
->
b—cÚ
 = 
skb
;

686 
	`kä“_skb
(
sÿn_»suÉ
->
´obe_»¥
);

687 
sÿn_»suÉ
->
´obe_»¥
 = 
skb
;

692 ià(!
´ev
 ||…»v->
rssi
 > 
cu¼’t_rssi
) {

693 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

698 
found
 = 1;

699 
´ev
->
Ãxt
 = 
sÿn_»suÉ
->next;

700 
sÿn_»suÉ
->
Ãxt
 = 
NULL
;

701 
cu¼’t_»suÉ
 = 
sÿn_»suÉ
;

706 
´ev
 = 
sÿn_»suÉ
;

707 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

710 ià(!
found
) {

712 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

713 ià(!
cu¼’t_»suÉ
) {

714 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for scan„esult\n");

715 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

718 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, 
mgmt
->bssid);

720 
cu¼’t_»suÉ
->
rssi
 = 
cu¼’t_rssi
;

721 
cu¼’t_»suÉ
->
bªd
 = 
cu¼’t_bªd
;

722 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

723 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

724 
cu¼’t_»suÉ
->
akm_ty³
 = 
	`¦si_bss_cÚÃù_ty³_g‘
(
sdev
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

725 
	`çpi_g‘_mgm’
(
skb
è- (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt));

727 
cu¼’t_»suÉ
->
akm_ty³
 = 
	`¦si_bss_cÚÃù_ty³_g‘
(
sdev
, 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
,

728 
	`çpi_g‘_mgm’
(
skb
è- (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt));

730 ià(
sÿn_ssid
 && scan_ssid[1]) {

731 
	`memıy
(
cu¼’t_»suÉ
->
ssid
, &
sÿn_ssid
[2], scan_ssid[1]);

732 
cu¼’t_»suÉ
->
ssid_Ëngth
 = 
sÿn_ssid
[1];

734 
cu¼’t_»suÉ
->
ssid_Ëngth
 = 0;

736 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

737 
cu¼’t_»suÉ
->
b—cÚ
 = 
skb
;

738 ià(!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[2] == '\0')

739 
cu¼’t_»suÉ
->
hidd’
 = 1;

741 
cu¼’t_»suÉ
->
´obe_»¥
 = 
skb
;

743 
cu¼’t_»suÉ
->
Ãxt
 = 
NULL
;

745 ià(!
h—d
) {

746 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

747 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

752 
sÿn_»suÉ
 = 
h—d
;

753 
´ev
 = 
NULL
;

755 
sÿn_»suÉ
) {

756 ià(
cu¼’t_»suÉ
->
rssi
 > 
sÿn_»suÉ
->rssi) {

757 
cu¼’t_»suÉ
->
Ãxt
 = 
sÿn_»suÉ
;

758 ià(
´ev
)

759 
´ev
->
Ãxt
 = 
cu¼’t_»suÉ
;

761 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

764 
´ev
 = 
sÿn_»suÉ
;

765 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

767 ià(!
sÿn_»suÉ
) {

769 
´ev
->
Ãxt
 = 
cu¼’t_»suÉ
;

770 
cu¼’t_»suÉ
->
Ãxt
 = 
NULL
;

773 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

775 
	}
}

777 
	$¦si_add_to_p2p_sÿn_li¡
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

778 
sk_buff
 *
skb
, 
u16
 
sÿn_id
)

780 
¦si_sÿn_»suÉ
 *
cu¼’t_»suÉ
;

781 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

782 
¦si_sÿn
 *
sÿn
;

785 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

786 ià(!
cu¼’t_»suÉ
) {

787 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for scan„esult\n");

790 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, 
mgmt
->bssid);

792 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

793 
sÿn
 = &
ndev_vif
->sÿn[
sÿn_id
];

794 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

795 
cu¼’t_»suÉ
->
b—cÚ
 = 
skb
;

797 
cu¼’t_»suÉ
->
´obe_»¥
 = 
skb
;

799 ià(!
sÿn
->
sÿn_»suÉs
) {

800 
sÿn
->
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

801 
cu¼’t_»suÉ
->
Ãxt
 = 
NULL
;

803 
cu¼’t_»suÉ
->
Ãxt
 = 
sÿn
->
sÿn_»suÉs
;

804 
sÿn
->
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

806 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

809 
	}
}

811 
	$¦si_rx_sÿn_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

813 
u16
 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.scan_id);

814 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

815 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

816 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

817 
size_t
 
›_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
´obe_»¥
.
v¬ŸbË
);

818 cÚ¡ 
u8
 *
sÿn_ssid
 = 
NULL
;

820 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


821 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
)) {

822 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "sÿn_id:%#x bssid:%pM\n", 
sÿn_id
, 
	`çpi_g‘_mgmt
(
skb
)->
bssid
);

823 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

824 
	`¦si_gsÿn_hªdË_sÿn_»suÉ
(
sdev
, 
dev
, 
skb
, 
sÿn_id
, 
çl£
);

825 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

830 
sÿn_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
, 
›_Ën
);

832 ià(
sÿn_ssid
 && sÿn_ssid[1] > 
IEEE80211_MAX_SSID_LEN
) {

833 
	`SLSI_NET_ERR
(
dev
, "Drİpšg sÿÀ»suÉ dutØuÃx³ùed ssid†’gth(%d)\n", 
sÿn_ssid
[1]);

834 
	`kä“_skb
(
skb
);

838 ià(
sÿn_ssid
 && sÿn_ssid[1] && ((
›_Ën
 - (sÿn_ssid - 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
) + 2) < scan_ssid[1])) {

839 
	`SLSI_NET_ERR
(
dev
, "Drİpšg sÿÀ»suÉ dutØskb d©¨i Ës thª ssid†’(%d)\n", 
sÿn_ssid
[1]);

840 
	`kä“_skb
(
skb
);

844 ià(
sdev
->
p2p_û¹if
 && 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
 &&

845 (
sÿn_id
 =ğ(
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
))) {

851 ià(
sÿn_ssid
 && scan_ssid[1] > 7) {

852 cÚ¡ 
u8
 *
p2p_›
 = 
NULL
;

854 
p2p_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
WLAN_OUI_TYPE_WFA_P2P
, 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
, 
›_Ën
);

855 
	#P2P_GROUP_CAPAB_PERSISTENT_GROUP
 
	`BIT
(1)

	)

856 ià(
p2p_›
 && !Õ2p_›[10] & 
P2P_GROUP_CAPAB_PERSISTENT_GROUP
)) {

857 
	`SLSI_NET_INFO
(
dev
, "Ignoring‡…eer GO…robe„esponse with group_capab‡s 0\n");

858 
	`kä“_skb
(
skb
);

864 
sÿn_id
 = (scan_id & 0xFF);

866 ià(
	`WARN_ON
(
sÿn_id
 >ğ
SLSI_SCAN_MAX
)) {

867 
	`kä“_skb
(
skb
);

874 ià(!
ndev_vif
->
sÿn
[
sÿn_id
].
is_blockšg_sÿn
)

875 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

877 ià(
	`çpi_g‘_vif
(
skb
è!ğ0 && 
	`çpi_g‘_u16
(skb, 
u
.
mlme_sÿn_šd
.
sÿn_id
) == 0) {

878 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "SÿÀšdiÿtiÚ„eûived w™h ID:0, bssid:%pM\n", 
	`çpi_g‘_mgmt
(
skb
)->
bssid
);

879 } ià(
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
 ||‚dev_vif->sÿn[sÿn_id].
sched_»q
 ||

880 
ndev_vif
->
sÿn
[
sÿn_id
].
acs_»que¡
 ||

881 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
) {

882 
	`¦si_rßm_chªÃl_ÿche_add
(
sdev
, 
dev
, 
skb
);

883 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

884 
	`¦si_add_to_sÿn_li¡
(
sdev
, 
ndev_vif
, 
skb
, 
sÿn_ssid
, 
sÿn_id
);

886 
	`¦si_add_to_p2p_sÿn_li¡
(
sdev
, 
ndev_vif
, 
skb
, 
sÿn_id
);

889 ià(!
ndev_vif
->
sÿn
[
sÿn_id
].
is_blockšg_sÿn
)

890 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

891 
	}
}

893 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

894 
	$¦si_rx_b—cÚ_»pÜtšg_ev’t_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

896 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

897 
u16
 
»asÚ_code
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_b—cÚ_»pÜtšg_ev’t_šd
.
abÜt_»asÚ
) -

898 
SLSI_FORWARD_BEACON_ABORT_REASON_OFFSET
;

899 
»t
 = 0;

901 ià(!
ndev_vif
->
aùiv©ed
) {

902 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

903 
	`kä“_skb
(
skb
);

906 ià(!
ndev_vif
->
is_ws_ruÂšg
) {

907 
	`SLSI_ERR
(
sdev
, "WIPS i nÙ„uÂšg. IgnÜb—cÚ_»pÜtšg_ev’t_šd(%u)\n", 
»asÚ_code
);

908 
	`kä“_skb
(
skb
);

912 
ndev_vif
->
is_ws_ruÂšg
 = 
çl£
;

914 ià(
»asÚ_code
 <ğ
SLSI_FORWARD_BEACON_ABORT_REASON_SUSPENDED
)

915 
	`SLSI_INFO
(
sdev
, "»ûived‡bÜt_ev’ˆäom FW w™h„—sÚ(%u)\n", 
»asÚ_code
);

917 
	`SLSI_ERR
(
sdev
, "»ûived‡bÜt_ev’ˆunsuµÜtšg„—sÚ(%u)\n", 
»asÚ_code
);

919 
»t
 = 
	`¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
sdev
, 
dev
, 
»asÚ_code
);

920 ià(
»t
)

921 
	`SLSI_ERR
(
sdev
, "FaedØ£nd fÜw¬d_b—cÚ_abÜt_ev’tÓ¼=%d)\n", 
»t
);

922 
	`kä“_skb
(
skb
);

923 
	}
}

925 
	$¦si_hªdË_ws_b—cÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

926 
›“80211_mgmt
 *
mgmt
, 
mgmt_Ën
)

928 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

929 
size_t
 
›_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
b—cÚ
.
v¬ŸbË
);

930 cÚ¡ 
u8
 *
ssid_›
 = 
NULL
;

931 cÚ¡ 
u8
 *
sÿn_ssid
 = 
NULL
;

932 cÚ¡ 
u8
 *
sÿn_bssid
 = 
NULL
;

933 
u16
 
b—cÚ_št
 = 0;

934 
u64
 
time¡amp
 = 0;

935 
ssid_Ën
 = 0;

936 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

937 
time¥ec64
 
sys_time
;

939 
time¥ec
 
sys_time
;

941 
»t
 = 0;

943 
u8
 
chªÃl
 = (
ndev_vif
->
chª
è? (u8)Òdev_vif->chª->
hw_v®ue
) : 0;

945 ià(!
chªÃl
) {

946 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl(0èÜ‚dev.chª(%p)\n", 
ndev_vif
->
chª
);

949 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

950 
sys_time
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

951 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

952 
sys_time
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

954 
	`g‘_mÚÙÚic_boÙtime
(&
sys_time
);

956 
sÿn_bssid
 = 
	`çpi_g‘_mgmt
(
skb
)->
bssid
;

958 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›_Ën
);

959 
ssid_Ën
 = 
ssid_›
[1];

960 
sÿn_ssid
 = &
ssid_›
[2];

961 
b—cÚ_št
 = 
mgmt
->
u
.
b—cÚ
.beacon_int;

962 
time¡amp
 = 
mgmt
->
u
.
b—cÚ
.timestamp;

964 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
,

966 
	`çpi_g‘_mgmt
(
skb
)->
bssid
, 
b—cÚ_št
, 
time¡amp
,

967 (
u64
)
	`TIMESPEC_TO_US
(
sys_time
));

969 
»t
 = 
	`¦si_£nd_fÜw¬d_b—cÚ_v’dÜ_ev’t
(
sdev
, 
dev
, 
sÿn_ssid
, 
ssid_Ën
, 
sÿn_bssid
,

970 
chªÃl
, 
b—cÚ_št
, 
time¡amp
, (
u64
)
	`TIMESPEC_TO_US
(
sys_time
));

971 ià(
»t
)

972 
	`SLSI_ERR
(
sdev
, "Failedo forward beacon_event\n");

973 
	}
}

976 
	$¦si_rx_rş_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

978 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

979 
u32
 
chªÃl_couÁ
 = 0;

980 
u16
 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

981 
i
 = 7;

982 
›_Ën
 = 0, 
sig_d©a_Ën
 = 0;

983 
u8
 *
±r
;

984 
u16
 
chªÃl_v®
 = 0;

985 
»t
 = 0;

986 
__Ë16
 *
Ë16_±r
 = 
NULL
;

988 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "RCL Channel List Indication„eceived\n");

989 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

991 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

992 ià(
sig_d©a_Ën
 >= 2) {

993 
›_Ën
 = 
±r
[1];

995 
	`SLSI_ERR
(
sdev
, "ERR: Failedo get Fapi data\n");

996 
ex™
;

999 
i
 < 
›_Ën
) {

1000 
Ë16_±r
 = (
__Ë16
 *)&
±r
[
i
];

1001 
chªÃl_v®
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

1002 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12)

1003 
chªÃl_li¡
[
chªÃl_couÁ
] = 
chªÃl_v®
 / 2;

1005 
chªÃl_li¡
[
chªÃl_couÁ
] = 
	`›“80211_äequ’cy_to_chªÃl
(
chªÃl_v®
 / 2);

1006 ià(
chªÃl_li¡
[
chªÃl_couÁ
] < 1 || channel_list[channel_count] > 196) {

1007 
	`SLSI_ERR
(
sdev
, "ERR: Inv®id chªÃÈ»ûived %d\n", 
chªÃl_li¡
[
chªÃl_couÁ
]);

1011 
i
 +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1012 
chªÃl_couÁ
 += 1;

1013 ià(
chªÃl_couÁ
 >ğ
MAX_CHANNEL_COUNT
) {

1014 
	`SLSI_ERR
(
sdev
, "ERR: ChªÃÈli¡„eûived >ğ%d\n", 
MAX_CHANNEL_COUNT
);

1018 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1019 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
[ndev_vif->¡a.Ï¡_cÚÃùed_bss.
ssid_Ën
] = '\0';

1020 
»t
 = 
	`¦si_£nd_rş_ev’t
(
sdev
, 
chªÃl_couÁ
, 
chªÃl_li¡
, 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
,

1021 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid_Ën
 + 1);

1022 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1023 ià(
»t
)

1024 
	`SLSI_ERR
(
sdev
, "ERR: Failedo send RCL channel†ist\n");

1025 
ex™
:

1026 
	`kä“_skb
(
skb
);

1027 
	}
}

1029 
	$¦si_rx_¡¬t_d‘eù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1031 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1032 
pow”_v®ue
 = 0;

1034 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1035 
pow”_v®ue
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_¡¬t_d‘eù_šd
.
»suÉ
);

1036 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "S¹ D‘eù IndiÿtiÚ„eûived w™h…ow” : %d\n", 
pow”_v®ue
);

1037 
	`¦si_£nd_pow”_m—su»m’t_v’dÜ_ev’t
(
sdev
, 
pow”_v®ue
);

1039 ià(
	`¦si_mlme_d–_d‘eù_vif
(
sdev
, 
dev
) != 0)

1040 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed for detect vif\n");

1041 
sdev
->
d‘eù_vif_aùive
 = 
çl£
;

1043 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1044 
	`kä“_skb
(
skb
);

1045 
	}
}

1047 
	$¦si_sÿn_upd©e_ssid_m­
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
)

1049 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1050 
›“80211_mgmt
 *
mgmt
;

1051 cÚ¡ 
u8
 *
ssid_›
 = 
NULL
, *
cÚÃùed_ssid
 = NULL;

1052 
i
, 
found
 = 0, 
is_cÚÃùed
 = 0;

1053 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
 = 
NULL
;

1054 
bªd
;

1056 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1057 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_»suÉ_mu‹x
));

1059 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
¡a_bss
) {

1060 
bªd
 = 
	`¦si_äeq_to_bªd
(
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
->
ûÁ”_äeq
);

1061 
is_cÚÃùed
 = 1;

1062 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

1066 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

1067 
found
 = 0;

1068 ià(!
sdev
->
ssid_m­
[
i
].
ssid_Ën
)

1072 ià(
is_cÚÃùed
 && 
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
sdev
->
ssid_m­
[
i
].bssid) &&

1073 
sdev
->
ssid_m­
[
i
].
bªd
 == band)

1077 
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

1078 
sÿn_»suÉ
) {

1079 ià(
	`SLSI_ETHER_EQUAL
(
sdev
->
ssid_m­
[
i
].
bssid
, 
sÿn_»suÉ
->bssid) &&

1080 
sdev
->
ssid_m­
[
i
].
bªd
 =ğ
sÿn_»suÉ
->band) {

1084 ià(!
sÿn_»suÉ
->
hidd’
 || (sÿn_»suÉ->hidd’ && !sÿn_»suÉ->
´obe_»¥
))

1085 
sdev
->
ssid_m­
[
i
].
age
 = 
SLSI_SCAN_SSID_MAP_EXPIRY_AGE
;

1087 
found
 = 1;

1090 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

1093 ià(!
found
) {

1094 
sdev
->
ssid_m­
[
i
].
age
++;

1095 ià(
sdev
->
ssid_m­
[
i
].
age
 > 
SLSI_SCAN_SSID_MAP_EXPIRY_AGE
) {

1096 
sdev
->
ssid_m­
[
i
].
ssid_Ën
 = 0;

1097 
sdev
->
ssid_m­
[
i
].
age
 = 0;

1102 
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

1104 
sÿn_»suÉ
) {

1105 
ssid_›
 = 
NULL
;

1107 ià(
sÿn_»suÉ
->
hidd’
) {

1108 ià(
is_cÚÃùed
 && 
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
sÿn_»suÉ
->bssid) &&

1109 
sÿn_»suÉ
->
bªd
 == band) {

1110 
ssid_›
 = 
cÚÃùed_ssid
;

1111 } ià(
sÿn_»suÉ
->
´obe_»¥
) {

1112 
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn_»suÉ
->
´obe_»¥
);

1113 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
	`çpi_g‘_mgm’
(
sÿn_»suÉ
->
´obe_»¥
è- (mgmt->u.b—cÚ.v¬ŸbË - (
u8
 *)mgmt));

1117 ià(!
ssid_›
) {

1118 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

1122 
found
 = 0;

1124 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

1125 ià(!
sdev
->
ssid_m­
[
i
].
ssid_Ën
)

1127 ià(
	`SLSI_ETHER_EQUAL
(
sÿn_»suÉ
->
bssid
, 
sdev
->
ssid_m­
[
i
].bssid) &&

1128 
sÿn_»suÉ
->
bªd
 =ğ
sdev
->
ssid_m­
[
i
].band) {

1129 
sdev
->
ssid_m­
[
i
].
ssid_Ën
 = 
ssid_›
[1];

1130 
	`memıy
(
sdev
->
ssid_m­
[
i
].
ssid
, &
ssid_›
[2], ssid_ie[1]);

1131 
found
 = 1;

1135 ià(!
found
) {

1137 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

1138 ià(
sdev
->
ssid_m­
[
i
].
ssid_Ën
)

1140 
	`SLSI_ETHER_COPY
(
sdev
->
ssid_m­
[
i
].
bssid
, 
sÿn_»suÉ
->bssid);

1141 
sdev
->
ssid_m­
[
i
].
age
 = 0;

1142 
sdev
->
ssid_m­
[
i
].
ssid_Ën
 = 
ssid_›
[1];

1143 
sdev
->
ssid_m­
[
i
].
bªd
 = 
sÿn_»suÉ
->band;

1144 
	`memıy
(
sdev
->
ssid_m­
[
i
].
ssid
, &
ssid_›
[2], ssid_ie[1]);

1148 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

1150 
	}
}

1152 
	$¦si_sÿn_com¶‘e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
abÜ‹d
,

1153 
boŞ
 
æush_sÿn_»suÉs
)

1155 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1156 
sk_buff
 *
sÿn
;

1157 
couÁ
 = 0;

1158 *
»suÉ_couÁ
 = 
NULL
, 
max_couÁ
 = 0;

1159 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 =‡borted};

1160 
sÿn_»suÉs_couÁ
 = 0;

1161 
mÜe_thª_max_couÁ
 = 0;

1162 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1163 
li¡_h—d
 *
pos
, *
q
, *
bÏckli¡_pos
, *
bÏckli¡_q
;

1166 ià(
	`WARN_ON
(
sÿn_id
 >ğ
SLSI_SCAN_MAX
))

1169 ià(
sÿn_id
 =ğ
SLSI_SCAN_HW_ID
 && !
ndev_vif
->
sÿn
[sÿn_id].
sÿn_»q
)

1172 ià(
	`WARN_ON
(
sÿn_id
 =ğ
SLSI_SCAN_SCHED_ID
 && !
ndev_vif
->
sÿn
[sÿn_id].
sched_»q
))

1175 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1176 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1177 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1178 ià(
æush_sÿn_»suÉs
) {

1179 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

1180 
¦si_ssid_šfo
 *
ssid_šfo
;

1181 
li¡_h—d
 *
bssid_pos
, *
p
;

1183 
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, 
¦si_ssid_šfo
, 
li¡
);

1184 
	`li¡_fÜ_—ch_§ã
(
bssid_pos
, 
p
, &
ssid_šfo
->
bssid_li¡
) {

1185 
¦si_bssid_šfo
 *
bssid_šfo
;

1187 
bssid_šfo
 = 
	`li¡_’Œy
(
bssid_pos
, 
¦si_bssid_šfo
, 
li¡
);

1188 
	`li¡_d–
(
bssid_pos
);

1189 
	`kä“
(
bssid_šfo
);

1191 
	`li¡_d–
(
pos
);

1192 
	`kä“
(
ssid_šfo
);

1194 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
ssid_šfo
);

1196 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
¡a
.
bÏckli¡_h—d
) {

1197 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

1199 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

1200 ià(
bÏckli¡_šfo
 && (
	`jiff›s_to_m£cs
(
jiff›s
è> bÏckli¡_šfo->
’d_time
)) {

1201 
	`li¡_d–
(
bÏckli¡_pos
);

1202 
	`kä“
(
bÏckli¡_šfo
);

1205 
	`¦si_pİuÏ‹_ssid_šfo
(
sdev
, 
ndev_vif
, 
sÿn_id
);

1207 
	`¦si_sÿn_upd©e_ssid_m­
(
sdev
, 
dev
, 
sÿn_id
);

1208 
max_couÁ
 = 
	`¦si_dev_g‘_sÿn_»suÉ_couÁ
();

1211 
»suÉ_couÁ
 = &
couÁ
;

1212 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
sÿn_id
], 
»suÉ_couÁ
);

1213 
sÿn
) {

1214 
sÿn_»suÉs_couÁ
++;

1216 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
sÿn
, 
Œue
);

1218 ià((
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)è&& (*
»suÉ_couÁ
 >ğ
max_couÁ
)) {

1219 
mÜe_thª_max_couÁ
 = 1;

1220 
	`¦si_purge_sÿn_»suÉs_locked
(
ndev_vif
, 
sÿn_id
);

1223 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
sÿn_id
], 
»suÉ_couÁ
);

1225 
	`SLSI_INFO
(
sdev
, "SÿÀcouÁ:%d APs\n", 
sÿn_»suÉs_couÁ
);

1226 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "š‹rçû:%d, sÿn_id:%d,%s\n", 
ndev_vif
->
iâum
, 
sÿn_id
,

1227 
mÜe_thª_max_couÁ
 ? "Scan„esults overflow" : "");

1228 
	`¦si_rßm_chªÃl_ÿche_´uÃ
(
dev
, 
SLSI_ROAMING_CHANNEL_CACHE_TIMEOUT
, 
NULL
);

1230 ià(
sÿn_id
 =ğ
SLSI_SCAN_HW_ID
) {

1231 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&& (!
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
))) {

1235 ià(
ndev_vif
->
aùiv©ed
)

1236 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

1238 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

1240 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

1241 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
, &
šfo
);

1243 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
, 
abÜ‹d
);

1246 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
 = 
NULL
;

1247 
ndev_vif
->
sÿn
[
sÿn_id
].
»queue_timeout_wÜk
 = 
çl£
;

1250 ià(
sÿn_id
 =ğ
SLSI_SCAN_SCHED_ID
 && 
sÿn_»suÉs_couÁ
 > 0)

1251 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

1252 
	`cfg80211_sched_sÿn_»suÉs
(
sdev
->
why
, 
ndev_vif
->
sÿn
[
sÿn_id
].
sched_»q
->
»qid
);

1254 
	`cfg80211_sched_sÿn_»suÉs
(
sdev
->
why
);

1256 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1257 
	}
}

1259 
	$¦si_£t_2g_auto_chªÃl
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1260 
¦si_acs_£Ëùed_chªÃls
 *
acs_£Ëùed_chªÃls
,

1261 
¦si_acs_chª_šfo
 *
ch_šfo
)

1263 
i
 = 0, 
j
 = 0, 
avg_lßd
, 
tÙ®_num_­
, 
tÙ®_rssi
, 
adjaûÁ_rssi
;

1264 
boŞ
 
®l_bss_lßd
 = 
Œue
;

1265 
mš_avg_chª_utiz©iÚ
 = 
INT_MAX
, 
mš_adjaûÁ_rssi
 = INT_MAX;

1266 
ch_idx_mš_lßd
 = 0, 
ch_idx_mš_rssi
 = 0;

1267 
mš_avg_chª_utiz©iÚ_20
 = 
INT_MAX
, 
mš_adjaûÁ_rssi_20
 = INT_MAX;

1268 
ch_idx_mš_lßd_20
 = 0, 
ch_idx_mš_rssi_20
 = 0;

1269 
»t
 = 0;

1270 
ch_li¡_Ën
 = 
MAX_24G_CHANNELS
;

1272 
acs_£Ëùed_chªÃls
->
ch_width
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->ch_width;

1273 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->hw_mode;

1275 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_lis_Ën:%d\n", 
ch_li¡_Ën
);

1276 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1277 ià(!
ch_šfo
[
i
].
chª
)

1279 
adjaûÁ_rssi
 = 0;

1280 
j
 = -2; j <= 2; j++)

1281 ià(
i
 + 
j
 >ğ0 && i + j < 
ch_li¡_Ën
)

1282 
adjaûÁ_rssi
 +ğ
ch_šfo
[
i
 + 
j
].
rssi_çùÜ
;

1283 
ch_šfo
[
i
].
adj_rssi_çùÜ
 = 
adjaûÁ_rssi
;

1284 ià(
ch_šfo
[
i
].
num_bss_lßd_­
 != 0) {

1285 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 = ch_šfo[i].
tÙ®_chª_utiz©iÚ
 /

1286 
ch_šfo
[
i
].
num_bss_lßd_­
;

1287 ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 < 
mš_avg_chª_utiz©iÚ_20
) {

1288 
mš_avg_chª_utiz©iÚ_20
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
;

1289 
ch_idx_mš_lßd_20
 = 
i
;

1290 } ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 =ğ
mš_avg_chª_utiz©iÚ_20
 &&

1291 
ch_šfo
[
i
].
num_­
 < ch_šfo[
ch_idx_mš_lßd_20
].num_ap) {

1292 
ch_idx_mš_lßd_20
 = 
i
;

1295 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "BSS†oad IE‚ot found\n");

1296 
®l_bss_lßd
 = 
çl£
;

1298 ià(
adjaûÁ_rssi
 < 
mš_adjaûÁ_rssi_20
) {

1299 
mš_adjaûÁ_rssi_20
 = 
adjaûÁ_rssi
;

1300 
ch_idx_mš_rssi_20
 = 
i
;

1301 } ià(
adjaûÁ_rssi
 =ğ
mš_adjaûÁ_rssi_20
 &&

1302 
ch_šfo
[
i
].
num_­
 < ch_šfo[
ch_idx_mš_rssi_20
].num_ap) {

1303 
ch_idx_mš_rssi_20
 = 
i
;

1305 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "mš„ssi:%d mš_rssi_idx:%d\n", 
mš_adjaûÁ_rssi_20
, 
ch_idx_mš_rssi_20
);

1306 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "num_ap:%d,chan:%d,total_util:%d,avg_util:%d,rssi_fac:%d,adj_rssi_fac:%d,"

1307 "bss_­:%d\n", 
ch_šfo
[
i
].
num_­
, ch_šfo[i].
chª
, ch_šfo[i].
tÙ®_chª_utiz©iÚ
,

1308 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
, ch_šfo[i].
rssi_çùÜ
, ch_šfo[i].
adj_rssi_çùÜ
,

1309 
ch_šfo
[
i
].
num_bss_lßd_­
);

1312 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 40) {

1313 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1314 ià(
i
 + 4 >ğ
ch_li¡_Ën
 || !
ch_šfo
[˜+ 4].
chª
 || !ch_info[i].chan)

1316 
avg_lßd
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 + ch_info[i + 4].avg_chan_utilization;

1317 
tÙ®_num_­
 = 
ch_šfo
[
i
].
num_­
 + ch_info[i + 4].num_ap;

1318 
tÙ®_rssi
 = 
ch_šfo
[
i
].
adj_rssi_çùÜ
 + ch_info[i + 4].adj_rssi_factor;

1320 ià(
avg_lßd
 < 
mš_avg_chª_utiz©iÚ
) {

1321 
mš_avg_chª_utiz©iÚ
 = 
avg_lßd
;

1322 
ch_idx_mš_lßd
 = 
i
;

1323 } ià(
avg_lßd
 =ğ
mš_avg_chª_utiz©iÚ
 &&

1324 
tÙ®_num_­
 < 
ch_šfo
[
ch_idx_mš_lßd
].
num_­
 +

1325 
ch_šfo
[
ch_idx_mš_lßd
 + 4].
num_­
) {

1326 
ch_idx_mš_lßd
 = 
i
;

1328 ià(
tÙ®_rssi
 < 
mš_adjaûÁ_rssi
) {

1329 
mš_adjaûÁ_rssi
 = 
tÙ®_rssi
;

1330 
ch_idx_mš_rssi
 = 
i
;

1331 } ià(
tÙ®_rssi
 =ğ
mš_adjaûÁ_rssi
 &&

1332 
tÙ®_num_­
 < 
ch_šfo
[
ch_idx_mš_rssi
].
num_­
 +

1333 
ch_šfo
[
ch_idx_mš_rssi
 + 4].
num_­
) {

1334 
ch_idx_mš_rssi
 = 
i
;

1337 ià(
®l_bss_lßd
) {

1338 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
;

1339 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
 + 4;

1341 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_rssi
].
chª
;

1342 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_rssi
].
chª
 + 4;

1345 ià(!
acs_£Ëùed_chªÃls
->
´i_chªÃl
)

1346 
acs_£Ëùed_chªÃls
->
ch_width
 = 20;

1349 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 20) {

1350 ià(
®l_bss_lßd
)

1351 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd_20
].
chª
;

1353 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_rssi_20
].
chª
;

1355  
»t
;

1356 
	}
}

1358 
	$¦si_is_40mhz_5gchª
(
u8
 
´i_chªÃl
, u8 
£c_chªÃl
)

1360 
¦si_40mhz_chª
[12] = {38, 46, 54, 62, 102, 110, 118, 126, 134, 142, 151, 159};

1361 
i
;

1363 
i
 = 0; i < 12; i++) {

1364 ià(
´i_chªÃl
 =ğ
¦si_40mhz_chª
[
i
] - 2 && 
£c_chªÃl
 == slsi_40mhz_chan[i] + 2)

1366 ià(
´i_chªÃl
 < 
¦si_40mhz_chª
[
i
])

1370 
	}
}

1372 
	$¦si_is_80mhz_5gchª
(
u8
 
´i_chªÃl
, u8 
Ï¡_chªÃl
)

1374 
¦si_80mhz_chª
[6] = {42, 58, 106, 122, 138, 155};

1375 
i
;

1377 
i
 = 0; i < 6; i++) {

1378 ià(
´i_chªÃl
 =ğ
¦si_80mhz_chª
[
i
] - 6 && 
Ï¡_chªÃl
 == slsi_80mhz_chan[i] + 6)

1380 ià(
´i_chªÃl
 < 
¦si_80mhz_chª
[
i
])

1384 
	}
}

1386 
	$¦si_£t_5g_auto_chªÃl
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1387 
¦si_acs_£Ëùed_chªÃls
 *
acs_£Ëùed_chªÃls
,

1388 
¦si_acs_chª_šfo
 *
ch_šfo
)

1390 
i
 = 0, 
avg_lßd
, 
tÙ®_num_­
;

1391 
boŞ
 
®l_bss_lßd
 = 
Œue
, 
nÚe_bss_lßd
 =rue;

1392 
mš_num_­
 = 
INT_MAX
, 
mš_avg_chª_utiz©iÚ
 = INT_MAX;

1393 
ch_idx_mš_lßd
 = 0, 
ch_idx_mš_­
 = 0;

1394 
mš_avg_chª_utiz©iÚ_20
 = 
INT_MAX
, 
mš_num_­_20
 = INT_MAX;

1395 
ch_idx_mš_lßd_20
 = 0, 
ch_idx_mš_­_20
 = 0;

1396 
»t
 = 0;

1397 
ch_li¡_Ën
 = 
MAX_5G_CHANNELS
;

1399 
acs_£Ëùed_chªÃls
->
ch_width
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->ch_width;

1400 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->hw_mode;

1402 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_lis_Ën:%d\n", 
ch_li¡_Ën
);

1403 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1404 ià(!
ch_šfo
[
i
].
chª
)

1406 ià(
ch_šfo
[
i
].
num_bss_lßd_­
 != 0) {

1407 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 = ch_šfo[i].
tÙ®_chª_utiz©iÚ
 /

1408 
ch_šfo
[
i
].
num_bss_lßd_­
;

1409 ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 < 
mš_avg_chª_utiz©iÚ_20
) {

1410 
mš_avg_chª_utiz©iÚ_20
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
;

1411 
ch_idx_mš_lßd_20
 = 
i
;

1412 } ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 =ğ
mš_avg_chª_utiz©iÚ_20
 &&

1413 
ch_šfo
[
i
].
num_­
 < ch_šfo[
ch_idx_mš_lßd_20
].num_ap) {

1414 
ch_idx_mš_lßd_20
 = 
i
;

1416 
nÚe_bss_lßd
 = 
çl£
;

1418 ià(
ch_šfo
[
i
].
num_­
 < 
mš_num_­_20
) {

1419 
mš_num_­_20
 = 
ch_šfo
[
i
].
num_­
;

1420 
ch_idx_mš_­_20
 = 
i
;

1422 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "BSS†oad IE‚ot found\n");

1423 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 = 128;

1424 
®l_bss_lßd
 = 
çl£
;

1426 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "num_ap:%d chan:%d,otal_chan_util:%d,‡vg_chan_util:%d, bss_load_ap:%d\n",

1427 
ch_šfo
[
i
].
num_­
, ch_šfo[i].
chª
, ch_šfo[i].
tÙ®_chª_utiz©iÚ
,

1428 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
, ch_šfo[i].
num_bss_lßd_­
);

1431 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 80) {

1432 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1433 ià(
i
 + 3 >ğ
ch_li¡_Ën
)

1435 ià(!
ch_šfo
[
i
].
chª
 || !ch_info[i + 1].chan || !ch_info[i + 2].chan || !ch_info[i + 3].chan)

1437 ià(
	`¦si_is_80mhz_5gchª
(
ch_šfo
[
i
].
chª
, ch_info[i + 3].chan)) {

1438 
avg_lßd
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 + ch_info[i + 1].avg_chan_utilization +

1439 
ch_šfo
[
i
 + 2].
avg_chª_utiz©iÚ
 + ch_info[i + 3].avg_chan_utilization;

1440 
tÙ®_num_­
 = 
ch_šfo
[
i
].
num_­
 + ch_info[i + 1].num_ap + ch_info[i + 2].num_ap +

1441 
ch_šfo
[
i
 + 3].
num_­
;

1442 ià(
avg_lßd
 < 
mš_avg_chª_utiz©iÚ
) {

1443 
mš_avg_chª_utiz©iÚ
 = 
avg_lßd
;

1444 
ch_idx_mš_lßd
 = 
i
;

1445 } ià(
avg_lßd
 =ğ
mš_avg_chª_utiz©iÚ
 && 
tÙ®_num_­
 <

1446 (
ch_šfo
[
ch_idx_mš_lßd
].
num_­
 + ch_info[ch_idx_min_load + 1].num_ap +

1447 
ch_šfo
[
ch_idx_mš_lßd
 + 2].
num_­
 +

1448 
ch_šfo
[
ch_idx_mš_lßd
 + 3].
num_­
)) {

1449 
ch_idx_mš_lßd
 = 
i
;

1451 ià(
tÙ®_num_­
 < 
mš_num_­
) {

1452 
mš_num_­
 = 
tÙ®_num_­
;

1453 
ch_idx_mš_­
 = 
i
;

1457 ià(
®l_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 <= 512) {

1458 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
;

1459 
acs_£Ëùed_chªÃls
->
vht_£g0_ûÁ”_ch
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
 + 6;

1460 } ià(
nÚe_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 > 512) {

1461 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­
].
chª
;

1462 
acs_£Ëùed_chªÃls
->
vht_£g0_ûÁ”_ch
 = 
ch_šfo
[
ch_idx_mš_­
].
chª
 + 6;

1465 ià(!
acs_£Ëùed_chªÃls
->
´i_chªÃl
)

1466 
acs_£Ëùed_chªÃls
->
ch_width
 = 40;

1469 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 40) {

1470 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1471 ià(!
ch_šfo
[
i
].
chª
 || i + 1 >ğ
ch_li¡_Ën
 || !ch_info[i + 1].chan)

1473 ià(
	`¦si_is_40mhz_5gchª
(
ch_šfo
[
i
].
chª
, ch_info[i + 1].chan)) {

1474 
avg_lßd
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 + ch_info[i + 1].avg_chan_utilization;

1475 
tÙ®_num_­
 = 
ch_šfo
[
i
].
num_­
 + ch_info[i + 1].num_ap;

1476 ià(
avg_lßd
 < 
mš_avg_chª_utiz©iÚ
) {

1477 
mš_avg_chª_utiz©iÚ
 = 
avg_lßd
;

1478 
ch_idx_mš_lßd
 = 
i
;

1479 } ià(
avg_lßd
 =ğ
mš_avg_chª_utiz©iÚ
 && 
tÙ®_num_­
 <

1480 
ch_šfo
[
ch_idx_mš_lßd
].
num_­
 + ch_info[ch_idx_min_load + 1].num_ap) {

1481 
ch_idx_mš_lßd
 = 
i
;

1483 ià(
tÙ®_num_­
 < 
mš_num_­
) {

1484 
mš_num_­
 = 
tÙ®_num_­
;

1485 
ch_idx_mš_­
 = 
i
;

1489 ià(
®l_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 <= 256) {

1490 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
;

1491 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
 + 1].
chª
;

1492 } ià(
nÚe_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 > 256) {

1493 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­
].
chª
;

1494 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­
 + 1].
chª
;

1497 ià(!
acs_£Ëùed_chªÃls
->
´i_chªÃl
)

1498 
acs_£Ëùed_chªÃls
->
ch_width
 = 20;

1501 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 20) {

1502 ià(
®l_bss_lßd
 || 
mš_avg_chª_utiz©iÚ_20
 < 128)

1503 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd_20
].
chª
;

1504 ià(
nÚe_bss_lßd
 || 
mš_avg_chª_utiz©iÚ_20
 >= 128)

1505 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­_20
].
chª
;

1507  
»t
;

1508 
	}
}

1510 
	$¦si_£t_bªd_ªy_auto_chªÃl
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1511 
¦si_acs_£Ëùed_chªÃls
 *
acs_£Ëùed_chªÃls
,

1512 
¦si_acs_chª_šfo
 *
ch_šfo
)

1514 
¦si_acs_chª_šfo
 
ch_šfo_2g
[
MAX_24G_CHANNELS
];

1515 
¦si_acs_chª_šfo
 
ch_šfo_5g
[
MAX_5G_CHANNELS
];

1516 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls_5g
;

1517 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls_2g
;

1518 
be¡_chªÃl_5g
 = -1;

1519 
be¡_chªÃl_5g_num_­
 = 0;

1520 
be¡_chªÃl_2g
 = -1;

1521 
be¡_chªÃl_2g_num_­
 = 0;

1522 
i
, 
»t
 = 0;

1523 
j
 = 0;

1525 
	`mem£t
(&
acs_£Ëùed_chªÃls_5g
, 0, (acs_selected_channels_5g));

1526 
	`mem£t
(&
acs_£Ëùed_chªÃls_2g
, 0, (acs_selected_channels_2g));

1527 
	`mem£t
(&
ch_šfo_5g
, 0, (ch_info_5g));

1528 
	`mem£t
(&
ch_šfo_2g
, 0, (ch_info_2g));

1530 
i
 = 
MAX_24G_CHANNELS
; i < 
MAX_CHAN_VALUE_ACS
; i++) {

1531 
ch_šfo_5g
[
j
] = 
ch_šfo
[
i
];

1532 
j
++;

1534 
»t
 = 
	`¦si_£t_5g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls_5g
, 
ch_šfo_5g
);

1536 ià(
»t
 == 0) {

1537 
be¡_chªÃl_5g
 = 
acs_£Ëùed_chªÃls_5g
.
´i_chªÃl
;

1538 
i
 = 0; i < 
MAX_5G_CHANNELS
; i++) {

1539 ià(
ch_šfo_5g
[
i
].
chª
 =ğ
be¡_chªÃl_5g
) {

1540 
be¡_chªÃl_5g_num_­
 = 
ch_šfo_5g
[
i
].
num_­
;

1544 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Be¡ 5G chªÃÈğ%d,‚um_­ = %d\n", 
be¡_chªÃl_5g
,

1545 
be¡_chªÃl_5g_num_­
);

1547 ià(
be¡_chªÃl_5g_num_­
 < 
MAX_AP_THRESHOLD
) {

1548 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_5g
;

1549 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211A
;

1550  
»t
;

1554 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "5G APhresholdƒxceed,ryingo select from 2G band\n");

1556 
i
 = 0; i < 
MAX_24G_CHANNELS
; i++)

1557 
ch_šfo_2g
[
i
] = 
ch_šfo
[i];

1558 
»t
 = 
	`¦si_£t_2g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls_2g
, 
ch_šfo_2g
);

1560 ià(
»t
 == 0) {

1561 
be¡_chªÃl_2g
 = 
acs_£Ëùed_chªÃls_2g
.
´i_chªÃl
;

1562 
i
 = 0; i < 
MAX_24G_CHANNELS
; i++) {

1563 ià(
ch_šfo_2g
[
i
].
chª
 =ğ
be¡_chªÃl_2g
) {

1564 
be¡_chªÃl_2g_num_­
 = 
ch_šfo_2g
[
i
].
num_­
;

1568 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Be¡ 2G chªÃÈğ%d,‚um_­ = %d\n", 
be¡_chªÃl_2g
,

1569 
be¡_chªÃl_2g_num_­
);

1570 ià(
be¡_chªÃl_5g
 == -1) {

1571 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_2g
;

1572 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211G
;

1573  
»t
;

1577 ià(
be¡_chªÃl_5g_num_­
 > 
be¡_chªÃl_2g_num_­
) {

1578 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_2g
;

1579 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211G
;

1581 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_5g
;

1582 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211A
;

1585  
»t
;

1586 
	}
}

1588 
	$¦si_acs_g‘_rssi_çùÜ
(
¦si_dev
 *
sdev
, 
rssi
, 
u8
 
ch_ut
)

1590 
äac_pow_v®
[10] = {10, 12, 15, 19, 25, 31, 39, 50, 63, 79};

1591 
»s
 = 1;

1592 
i
;

1594 ià(
rssi
 < 0)

1595 
rssi
 = 0 -„ssi;

1597  
INT_MAX
;

1598 
i
 = 0; i < 
rssi
 / 10; i++)

1599 
»s
 *= 10;

1600 
»s
 = (10000000 * 
ch_ut
 /„esè/ 
äac_pow_v®
[
rssi
 % 10];

1602 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_ut:%d\n", 
ch_ut
);

1603  
»s
;

1604 
	}
}

1606 
¦si_acs_chª_šfo
 *
	$¦si_acs_sÿn_»suÉs
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

1608 
sk_buff
 *
sÿn_»s
;

1609 
sk_buff
 *
unique_sÿn
;

1610 
sk_buff_h—d
 
unique_sÿn_»suÉs
;

1611 
¦si_acs_chª_šfo
 *
ch_šfo
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
acs_chª_šfo
;

1613 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Received‡cs_results\n");

1614 
	`skb_queue_h—d_š™
(&
unique_sÿn_»suÉs
);

1615 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1616 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

1618 
sÿn_»s
) {

1619 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn_»s
);

1620 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
sÿn_»s
);

1621 
›“80211_chªÃl
 *
sÿn_chªÃl
;

1622 
idx
 = 0;

1623 cÚ¡ 
u8
 *
›_d©a
;

1624 cÚ¡ 
u8
 *
›
;

1625 
›_Ën
;

1626 
u8
 
ch_ut
 = 128;

1628 
size_t
 
›s_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
b—cÚ
.
v¬ŸbË
);

1630 
	`skb_queue_w®k
(&
unique_sÿn_»suÉs
, 
unique_sÿn
) {

1631 
›“80211_mgmt
 *
unique_mgmt
 = 
	`çpi_g‘_mgmt
(
unique_sÿn
);

1633 ià(
	`com·»_‘h”_addr
(
mgmt
->
bssid
, 
unique_mgmt
->bssid) == 0)

1634 
Ãxt_sÿn
;

1636 
	`skb_queue_h—d
(&
unique_sÿn_»suÉs
, 
sÿn_»s
);

1637 
sÿn_chªÃl
 = 
	`¦si_fšd_sÿn_chªÃl
(
sdev
, 
mgmt
, 
mgmt_Ën
,

1638 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2);

1639 ià(!
sÿn_chªÃl
)

1640 
Ãxt_sÿn
;

1641 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "scan„esult (scan_id:%d, %pM, channel:%d,„ssi:%d, ie_len = %zu)\n",

1642 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
sÿn_id
),

1643 
	`çpi_g‘_mgmt
(
sÿn_»s
)->
bssid
, 
sÿn_chªÃl
->
hw_v®ue
,

1644 
	`çpi_g‘_s16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
rssi
),

1645 
›s_Ën
);

1647 
idx
 = 
	`¦si_fšd_chª_idx
(
sÿn_chªÃl
->
hw_v®ue
, 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
);

1648 ià(
idx
 < 0) {

1649 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "idx i nÙ iÀ¿ngidx=%d\n", 
idx
);

1650 
Ãxt_sÿn
;

1652 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "chª_idx:%d chª_v®ue: %d\n", 
idx
, 
ch_šfo
[idx].
chª
);

1654 ià(
ch_šfo
[
idx
].
chª
) {

1655 
ch_šfo
[
idx
].
num_­
 += 1;

1656 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_QBSS_LOAD
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›s_Ën
);

1657 ià(
›
) {

1658 
›_Ën
 = 
›
[1];

1659 
›_d©a
 = &
›
[2];

1660 ià(
›_Ën
 >= 3) {

1661 
ch_ut
 = 
›_d©a
[2];

1662 
ch_šfo
[
idx
].
num_bss_lßd_­
 += 1;

1663 
ch_šfo
[
idx
].
tÙ®_chª_utiz©iÚ
 +ğ
ch_ut
;

1666 ià(
idx
 =ğ
sÿn_chªÃl
->
hw_v®ue
 - 1) {

1667 
»s
 = 0;

1669 
»s
 = 
	`¦si_acs_g‘_rssi_çùÜ
(
sdev
, 
	`çpi_g‘_s16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
rssi
),

1670 
ch_ut
);

1671 
ch_šfo
[
idx
].
rssi_çùÜ
 +ğ
»s
;

1672 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_šfo[idx].rssi_çùÜ:%d\n", 
ch_šfo
[
idx
].
rssi_çùÜ
);

1675 
Ãxt_sÿn
;

1677 
Ãxt_sÿn
:

1678 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
sÿn_id
], 
NULL
);

1680 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1681 
	`skb_queue_purge
(&
unique_sÿn_»suÉs
);

1682  
ch_šfo
;

1683 
	}
}

1685 
	$¦si_acs_sÿn_com¶‘e
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

1687 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
;

1688 
¦si_acs_chª_šfo
 *
ch_šfo
;

1689 
r
 = 0;

1691 
	`mem£t
(&
acs_£Ëùed_chªÃls
, 0, (acs_selected_channels));

1692 
ch_šfo
 = 
	`¦si_acs_sÿn_»suÉs
(
sdev
, 
ndev_vif
, 
sÿn_id
);

1693 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211A
)

1694 
r
 = 
	`¦si_£t_5g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls
, 
ch_šfo
);

1695 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211B
 ||

1696 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211G
)

1697 
r
 = 
	`¦si_£t_2g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls
, 
ch_šfo
);

1698 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211ANY
)

1699 
r
 = 
	`¦si_£t_bªd_ªy_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls
, 
ch_šfo
);

1701 
r
 = -
EINVAL
;

1702 ià(!
r
) {

1703 
r
 = 
	`¦si_£nd_acs_ev’t
(
sdev
, 
acs_£Ëùed_chªÃls
);

1704 ià(
r
 != 0)

1705 
	`SLSI_ERR
(
sdev
, "Could‚ot send ACS vendorƒvent up\n");

1707 
	`SLSI_ERR
(
sdev
, "£t_auto_chªÃÈçed: %d\n", 
r
);

1709 
sdev
->
acs_chªÃl_sw™ched
 = 
Œue
;

1710 
	`kä“
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
);

1711 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
 = 
NULL
;

1712 
	}
}

1714 
	$¦si_rx_sÿn_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1716 
u16
 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_dÚe_šd
.scan_id);

1717 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1719 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1720 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1721 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "Reûived sÿn_id:%#x\n", 
sÿn_id
);

1723 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1724 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
)) {

1725 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "sÿn_id:%#x\n", 
sÿn_id
);

1727 
	`¦si_gsÿn_hªdË_sÿn_»suÉ
(
sdev
, 
dev
, 
skb
, 
sÿn_id
, 
Œue
);

1729 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1730 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1734 
sÿn_id
 = (scan_id & 0xFF);

1736 ià(
sÿn_id
 =ğ
SLSI_SCAN_HW_ID
 && (
ndev_vif
->
sÿn
[SLSI_SCAN_HW_ID].
sÿn_»q
 ||

1737 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
))

1738 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

1739 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
)

1740 
	`¦si_acs_sÿn_com¶‘e
(
sdev
, 
ndev_vif
, 
sÿn_id
);

1742 
	`¦si_sÿn_com¶‘e
(
sdev
, 
dev
, 
sÿn_id
, 
çl£
, 
Œue
);

1747 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
 &&

1748 
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1749 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

1750 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

1751 
u32
 
chªÃls_couÁ
 = 0;

1752 
u8
 
chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

1753 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

1754 
u32
 
m”ge_chª_couÁ
 = 0;

1756 
	`mem£t
(
m”ged_chªÃls
, 0, (merged_channels));

1757 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

1758 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

1759 
ÃtwÜk_m­
 = 
	`¦si_rßm_chªÃl_ÿche_g‘
(
dev
, 
cÚÃùed_ssid
);

1760 ià(
ÃtwÜk_m­
) {

1761 
ndev_vif
->
¡a
.
chªÃls_24_ghz
 = 
ÃtwÜk_m­
->channels_24_ghz;

1762 
ndev_vif
->
¡a
.
chªÃls_5_ghz
 = 
ÃtwÜk_m­
->channels_5_ghz;

1764 
chªÃls_couÁ
 = 
	`¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
dev
, 
ÃtwÜk_m­
, 
chªÃls
);

1765 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1766 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
chªÃls
, 
chªÃls_couÁ
,

1767 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
,

1768 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
,

1769 
m”ged_chªÃls
);

1770 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1771 ià(
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
) != 0)

1772 
	`SLSI_NET_ERR
(
dev
, "MLME-SET-CACHED-CHANNELS.req failed\n");

1776 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1777 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1778 
	`kä“_skb
(
skb
);

1779 
	}
}

1781 
	$¦si_rx_chªÃl_sw™ched_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1783 
u16
 
äeq
 = 0;

1784 
width
;

1785 
´im¬y_chª_pos
;

1786 
u16
 
‹mp_chª_šfo
;

1787 
cfg80211_chª_def
 
chªdef
 = {};

1788 
u16
 
cf1
 = 0;

1789 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1791 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1792 ià(!
ndev_vif
->
aùiv©ed
) {

1793 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

1794 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1795 
	`kä“_skb
(
skb
);

1799 
‹mp_chª_šfo
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_chªÃl_sw™ched_šd
.
chªÃl_šfÜm©iÚ
);

1800 
cf1
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_chªÃl_sw™ched_šd
.
chªÃl_äequ’cy
);

1801 
cf1
 = cf1 / 2;

1803 
´im¬y_chª_pos
 = (
‹mp_chª_šfo
 >> 8);

1804 
width
 = (
‹mp_chª_šfo
 & 0x00FF);

1807 ià(
width
 == 40)

1808 
äeq
 = 
cf1
 + (
´im¬y_chª_pos
 * 20) - 10;

1809 ià(
width
 == 80)

1810 
äeq
 = 
cf1
 + (
´im¬y_chª_pos
 * 20) - 30;

1812 
äeq
 = 
cf1
;

1814 ià(
width
 == 20)

1815 
width
 = 
NL80211_CHAN_WIDTH_20
;

1816 ià(
width
 == 40)

1817 
width
 = 
NL80211_CHAN_WIDTH_40
;

1818 ià(
width
 == 80)

1819 
width
 = 
NL80211_CHAN_WIDTH_80
;

1820 ià(
width
 == 160)

1821 
width
 = 
NL80211_CHAN_WIDTH_160
;

1823 
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

1824 ià(!
chªdef
.
chª
) {

1825 
	`SLSI_NET_WARN
(
dev
, "invalid freq„eceived (cf1=%d,emp_chan_info=%d, freq=%d)\n",

1826 ()
cf1
, ()
‹mp_chª_šfo
, ()
äeq
);

1827 
ex™
;

1829 
chªdef
.
width
 = width;

1830 
chªdef
.
ûÁ”_äeq1
 = 
cf1
;

1831 
chªdef
.
ûÁ”_äeq2
 = 0;

1833 
ndev_vif
->
­
.
chªÃl_äeq
 = 
äeq
;

1834 
ndev_vif
->
chª
 = 
chªdef
.chan;

1835 
ndev_vif
->
chªdef_§ved
 = 
chªdef
;

1836 
	`cfg80211_ch_sw™ch_nÙify
(
dev
, &
chªdef
);

1838 
ex™
:

1839 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1840 
	`kä“_skb
(
skb
);

1841 
	}
}

1843 
	$__¦si_rx_blockack_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1845 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1846 
›“80211_mgmt
 *
mgmt
;

1847 
›“80211_b¬
 *
b¬
 = 
NULL
;

1848 
¦si_³”
 *
³”
 = 
NULL
;

1849 
u16
 
·¿ms
;

1850 
u16
 
»asÚ_code
;

1851 
u16
 
´iÜ™y
;

1852 
u16
 
bufãr_size
;

1853 
u16
 
£qu’û_num
;

1855 
	`çpi_g‘_sigid
(
skb
)) {

1856 
MA_BLOCKACKREQ_IND
:

1857 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
,

1859 
	`çpi_g‘_vif
(
skb
),

1860 
	`çpi_g‘_buff
(
skb
, 
u
.
ma_blockack»q_šd
.
time¡amp
));

1862 ià(
	`çpi_g‘_d©®’
(
skb
è>ğ(
›“80211_b¬
)) {

1863 
b¬
 = (
›“80211_b¬
 *)
	`çpi_g‘_d©a
(
skb
);

1865 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "invalid fapidata†ength.\n");

1866 
šv®id
;

1869 ià(!
b¬
) {

1870 
	`WARN
(1, "invalid bulkdata for BAR frame\n");

1871 
šv®id
;

1874 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
b¬
->

);

1875 
bufãr_size
 = 0;

1876 
´iÜ™y
 = (
b¬
->
cÚŒŞ
 & 
IEEE80211_BAR_CTRL_TID_INFO_MASK
è>> 
IEEE80211_BAR_CTRL_TID_INFO_SHIFT
;

1877 
£qu’û_num
 = 
	`Ë16_to_ıu
(
b¬
->
¡¬t_£q_num
) >> 4;

1878 
»asÚ_code
 = 
FAPI_REASONCODE_UNSPECIFIED_REASON
;

1880 
MLME_BLOCKACK_ACTION_IND
:

1881 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
,

1883 
	`çpi_g‘_vif
(
skb
),

1884 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_blockack_aùiÚ_šd
.
³”_¡a_add»ss
),

1885 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_blockack_aùiÚ_šd
.
tid
),

1886 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_blockack_aùiÚ_šd
.
time¡amp
));

1888 
mgmt
 = (
	`çpi_g‘_mgm’
(
skb
)è? 
	`çpi_g‘_mgmt
(skbè: 
NULL
;

1889 ià(!
mgmt
) {

1890 
šv®id
;

1893 ià(
	`›“80211_is_aùiÚ
(
mgmt
->
äame_cÚŒŞ
) &&

1894 
mgmt
->
u
.
aùiÚ
.
ÿ‹gÜy
 =ğ
WLAN_CATEGORY_BACK
) {

1895 
mgmt
->
u
.
aùiÚ
.u.
addba_»q
.
aùiÚ_code
) {

1896 
WLAN_ACTION_ADDBA_REQ
:

1897 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_blockack_aùiÚ_šd
.
³”_¡a_add»ss
));

1898 
£qu’û_num
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
aùiÚ
.u.
addba_»q
.
¡¬t_£q_num
) >> 4;

1899 
·¿ms
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
aùiÚ
.u.
addba_»q
.
ÿ·b
);

1900 
´iÜ™y
 = (
·¿ms
 & 
IEEE80211_ADDBA_PARAM_TID_MASK
) >> 2;

1901 
bufãr_size
 = (
·¿ms
 & 
IEEE80211_ADDBA_PARAM_BUF_SIZE_MASK
) >> 6;

1902 
»asÚ_code
 = 
FAPI_REASONCODE_START
;

1904 
WLAN_ACTION_DELBA
:

1905 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_blockack_aùiÚ_šd
.
³”_¡a_add»ss
));

1906 
·¿ms
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
aùiÚ
.u.
d–ba
.params);

1907 
´iÜ™y
 = (
·¿ms
 & 
IEEE80211_DELBA_PARAM_TID_MASK
) >> 12;

1908 
»asÚ_code
 = 
FAPI_REASONCODE_END
;

1911 
	`SLSI_NET_WARN
(
dev
, "invalid‡ction frame\n");

1915 
	`SLSI_NET_WARN
(
dev
, "invalid frame,‚ot‡n‡ction frame or‚ot BA category\n");

1919 
	`SLSI_NET_WARN
(
dev
, "invalid signal ID\n");

1922 
	`WARN_ON
(!
³”
);

1924 ià(
³”
) {

1926 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTING
) {

1927 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "buffering blockack indication\n");

1928 
	`skb_queue_
(&
³”
->
bufã»d_äames
, 
skb
);

1931 
	`¦si_hªdË_blockack
(

1932 
dev
,

1933 
³”
,

1934 
»asÚ_code
,

1935 
´iÜ™y
,

1936 
bufãr_size
,

1937 
£qu’û_num


1940 
šv®id
:

1941 
	`kä“_skb
(
skb
);

1942 
	}
}

1944 
	$¦si_rx_blockack_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1946 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1948 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1949 ià(!
ndev_vif
->
aùiv©ed
) {

1950 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

1951 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1952 
	`kä“_skb
(
skb
);

1955 
	`__¦si_rx_blockack_šd
(
sdev
, 
dev
, 
skb
);

1956 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1957 
	}
}

1959 
	$¦si_rx_ma_to_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1961 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1962 
§p_drv_ma_to_mlme_d–ba_»q
 *
d–ba_»q
 = (§p_drv_ma_to_mlme_d–ba_»q *)(
skb
->
d©a
);

1964 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1965 ià(!
ndev_vif
->
aùiv©ed
) {

1966 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

1967 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1968 
	`kä“_skb
(
skb
);

1972 
	`¦si_mlme_d–ba_»q
(
sdev
,

1973 
dev
,

1974 
d–ba_»q
->
³”_q¡a_add»ss
,

1975 
d–ba_»q
->
u£r_´iÜ™y
,

1976 
d–ba_»q
->
dœeùiÚ
,

1977 
d–ba_»q
->
£qu’û_numb”
,

1978 
d–ba_»q
->
»asÚ
);

1980 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1981 
	`kä“_skb
(
skb
);

1982 
	}
}

1984 
boŞ
 
	$g‘_wmm_›_äom_»¥_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
»¥_›
, 
size_t
 
»¥_›_Ën
, cÚ¡ u8 **
wmm_–em
, 
u16
 *
wmm_–em_Ën
)

1986 
›“80211_v’dÜ_›
 *
›
;

1988 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1990 ià(!
»¥_›
) {

1991 
	`SLSI_NET_ERR
(
dev
, "Received invalid…ointerohe ie's ofhe‡ssociation„esponse\n");

1992  
çl£
;

1995 *
wmm_–em
 = 
»¥_›
;

1996 *
wmm_–em
 && (*wmm_–em - 
»¥_›
 < 
»¥_›_Ën
)) {

1998 *
wmm_–em
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, *wmm_elem,

1999 
»¥_›_Ën
 - (*
wmm_–em
 - 
»¥_›
));

2003 ià(*
wmm_–em
 && (*wmm_–em)[1] > 6 && (*wmm_–em)[6] =ğ
WMM_OUI_SUBTYPE_PARAMETER_ELEMENT
)

2005 ià(*
wmm_–em
)

2006 *
wmm_–em
 += (*wmm_elem)[1];

2009 ià(!(*
wmm_–em
)) {

2010 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "No WMM IE\n");

2011  
çl£
;

2013 
›
 = (
›“80211_v’dÜ_›
 *)*
wmm_–em
;

2014 *
wmm_–em_Ën
 = 
›
->
Ën
 + 2;

2016 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "WMM IE„eceived‡nd…arsed successfully\n");

2017  
Œue
;

2018 
	}
}

2020 
boŞ
 
	$¡a_wmm_upd©e_u­sd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
u8
 *
assoc_»q_›
, 
size_t
 
assoc_»q_›_Ën
)

2022 cÚ¡ 
u8
 *
wmm_šfÜm©iÚ_›
;

2024 ià(!
assoc_»q_›
) {

2025 
	`SLSI_NET_ERR
(
dev
, "null„eferenceo IE\n");

2026  
çl£
;

2029 
wmm_šfÜm©iÚ_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, 
assoc_»q_›
, 
assoc_»q_›_Ën
);

2030 ià(!
wmm_šfÜm©iÚ_›
) {

2031 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "no WMM IE\n");

2032  
çl£
;

2035 
³”
->
u­sd
 = 
wmm_šfÜm©iÚ_›
[8];

2036 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "³”->u­sd = 0x%x\n", 
³”
->
u­sd
);

2037  
Œue
;

2038 
	}
}

2040 
boŞ
 
	$¡a_wmm_upd©e_wmm_ac_›s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

2041 
u8
 *
assoc_r¥_›
, 
size_t
 
assoc_r¥_›_Ën
)

2043 
u16
 
Ëá
;

2044 cÚ¡ 
u8
 *
pos
;

2045 cÚ¡ 
u8
 *
wmm_–em
 = 
NULL
;

2046 
u16
 
wmm_–em_Ën
 = 0;

2047 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2048 
¦si_wmm_ac
 *
wmm_ac
 = &
ndev_vif
->
¡a
.wmm_ac[0];

2050 ià(!
	`g‘_wmm_›_äom_»¥_›
(
sdev
, 
dev
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
, &
wmm_–em
, &
wmm_–em_Ën
)) {

2051 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "No WMM IE„eceived\n");

2052  
çl£
;

2055 ià(
wmm_–em_Ën
 < 10 || 
wmm_–em
[7] != 1) {

2056 
	`SLSI_NET_WARN
(
dev
, "Inv®id WMM IE: wmm_–em_Ën=%lu, wmm_–em[7]=%d\n", ()
wmm_–em_Ën
, ()
wmm_–em
[7]);

2057  
çl£
;

2060 
pos
 = 
wmm_–em
 + 10;

2061 
Ëá
 = 
wmm_–em_Ën
 - 10;

2063 ; 
Ëá
 >ğ4;†eá -ğ4, 
pos
 += 4) {

2064 
aci
 = (
pos
[0] >> 5) & 0x03;

2065 
acm
 = (
pos
[0] >> 4) & 0x01;

2067 
	`memıy
(
wmm_ac
, 
pos
, (
¦si_wmm_ac
));

2069 
aci
) {

2071 ià(
acm
)

2072 
³”
->
wmm_acm
 |ğ
	`BIT
(1) | BIT(2);

2075 ià(
acm
)

2076 
³”
->
wmm_acm
 |ğ
	`BIT
(4) | BIT(5);

2079 ià(
acm
)

2080 
³”
->
wmm_acm
 |ğ
	`BIT
(6) | BIT(7);

2084 ià(
acm
)

2085 
³”
->
wmm_acm
 |ğ
	`BIT
(0) | BIT(3);

2088 
wmm_ac
++;

2091 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "WMM ies have been updated successfully\n");

2092  
Œue
;

2093 
	}
}

2095 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


2096 
	e¦si_wÏn_v’dÜ_©Œ_rßm_auth
 {

2097 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_INVALID
 = 0,

2098 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_BSSID
,

2099 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_REQ_IE
,

2100 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_RESP_IE
,

2101 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AUTHORIZED
,

2102 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_KEY_REPLAY_CTR
,

2103 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_PTK_KCK
,

2104 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_PTK_KEK
,

2105 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_BEACON_IE
,

2107 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AFTER_LAST
,

2108 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_MAX
 =

2109 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AFTER_LAST
 - 1

2112 
	$¦si_£nd_rßm_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
bssid
,

2113 cÚ¡ 
u8
 *
»q_›
, 
u32
 
»q_›_Ën
, cÚ¡ u8 *
»¥_›
, u32 
»¥_›_Ën
,

2114 cÚ¡ 
u8
 *
b—cÚ_›
, 
u32
 
b—cÚ_›_Ën
, 
boŞ
 
authÜized
)

2116 
boŞ
 
is_£cu»d_bss
;

2117 
sk_buff
 *
skb
 = 
NULL
;

2118 
u8
 
”r
 = 0;

2120 
is_£cu»d_bss
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
»q_›
, 
»q_›_Ën
) ||

2121 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
»q_›
, 
»q_›_Ën
);

2123 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "authÜized:%d, is_£cu»d_bss:%d\n", 
authÜized
, 
is_£cu»d_bss
);

2125 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2126 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

2127 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
, 
GFP_KERNEL
);

2129 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

2130 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
, 
GFP_KERNEL
);

2132 ià(!
skb
) {

2133 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for VENDOR Roamƒvent\n");

2134  -
ENOMEM
;

2137 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_BSSID
, 
ETH_ALEN
, 
bssid
è? 
	`BIT
(1) : 0;

2138 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AUTHORIZED
, 1, &
authÜized
è? 
	`BIT
(2) : 0;

2139 
”r
 |ğ(
»q_›
 && 
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_REQ_IE
, 
»q_›_Ën
,„eq_›)è? 
	`BIT
(3) : 0;

2140 
”r
 |ğ(
»¥_›
 && 
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_RESP_IE
, 
»¥_›_Ën
,„e¥_›)è? 
	`BIT
(4) : 0;

2141 
”r
 |ğ(
b—cÚ_›
 && 
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_BEACON_IE
, 
b—cÚ_›_Ën
, b—cÚ_›)è? 
	`BIT
(5) : 0;

2142 ià(
”r
) {

2143 
	`SLSI_ERR_NODEV
("Failed‚la_put ,req_ie_len=%d,resp_ie_len=%d,beacon_ie_len=%d,condition_failed=%d\n",

2144 
»q_›_Ën
, 
»¥_›_Ën
, 
b—cÚ_›_Ën
, 
”r
);

2145 
	`kä“_skb
(
skb
);

2146  -
EINVAL
;

2148 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "Ev’t: KEY_MGMT_ROAM_AUTH(%d)\n", 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
);

2149 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2151 
	}
}

2154 
	$¦si_rx_rßmed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2156 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2157 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2158 
¦si_³”
 *
³”
;

2159 
u16
 
‹mpÜ®_keys_»quœed
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_rßmed_šd
.temporal_keys_required);

2160 
u16
 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_rßmed_šd
.flow_id);

2161 
›“80211_chªÃl
 *
cur_chªÃl
 = 
NULL
;

2162 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2163 
›“80211_´ivacy
 
bss_´ivacy
;

2165 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

2166 
cfg80211_rßm_šfo
 
rßm_šfo
 = {};

2169 
	`¹Æ_lock
();

2170 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

2171 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

2172 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2174 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_rßmed_šd(vif:%d)\n", 
	`çpi_g‘_vif
(
skb
));

2175 ià(!
ndev_vif
->
aùiv©ed
) {

2176 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2177 
ex™
;

2180 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

2181 ià(
	`WARN_ON
(!
³”
))

2182 
ex™
;

2184 ià(
	`WARN_ON
(!
ndev_vif
->
¡a
.
¡a_bss
))

2185 
ex™
;

2187 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

2189 ià(
	`çpi_g‘_mgm’
(
skb
è>ğ(
	`off£tof
(
›“80211_mgmt
, 
bssid
è+ 
ETH_ALEN
)) {

2190 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_rßmed_šd : RßmšgØ" 
MACSTR
 "\n",

2191 
	`MAC2STR
(
mgmt
->
bssid
));

2192 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
mgmt
->
bssid
);

2194 
	`SLSI_NET_ERR
(
dev
, "invalid fapi mgmt†ength.\n");

2195 
ex™
;

2198 ià(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
) {

2200 
cur_chªÃl
 = 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
, 
Œue
);

2201 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
 = 
NULL
;

2203 
	`SLSI_NET_ERR
(
dev
, "mlme_scan_ind_skb is‚ot‡vailable, mlme_synchronised_ind‚ot„eceived");

2206 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2207 ià(
ndev_vif
->
¡a
.
¡a_bss
->
ÿ·b™y
 & 
WLAN_CAPABILITY_PRIVACY
)

2208 
bss_´ivacy
 = 
IEEE80211_PRIVACY_ON
;

2210 
bss_´ivacy
 = 
IEEE80211_PRIVACY_OFF
;

2213 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

2215 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2216 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
, 
NULL
, 0,

2217 
IEEE80211_BSS_TYPE_ANY
, 
bss_´ivacy
);

2219 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
, 
NULL
, 0, 0, 0);

2222 ià(!
ndev_vif
->
¡a
.
¡a_bss
 || !ndev_vif->¡a.
rßm_mlme_´oûdu»_¡¬‹d_šd
) {

2223 ià(!
ndev_vif
->
¡a
.
¡a_bss
)

2224 
	`SLSI_INFO
(
sdev
, "BSS‚ot updated in cfg80211\n");

2225 ià(!
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
)

2226 
	`SLSI_INFO
(
sdev
, "procedure-started-ind‚ot„eceived before„oamed-ind\n");

2227 
	`Ãtif_ÿ¼›r_off
(
dev
);

2228 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 0, 
Œue
);

2229 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 0, 
NULL
, 0);

2231 
u8
 *
assoc_›
 = 
NULL
;

2232 
size_t
 
assoc_›_Ën
 = 0;

2233 
u8
 *
assoc_r¥_›
 = 
NULL
;

2234 
size_t
 
assoc_r¥_›_Ën
 = 0;

2236 
	`¦si_³”_»£t_¡©s
(
sdev
, 
dev
, 
³”
);

2237 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
);

2238 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
skb
);

2241 
skb
 = 
NULL
;

2243 ià(
³”
->
assoc_›
) {

2244 
assoc_›
 = 
³”
->assoc_›->
d©a
;

2245 
assoc_›_Ën
 = 
³”
->
assoc_›
->
Ën
;

2248 ià(
³”
->
assoc_»¥_›
) {

2249 
assoc_r¥_›
 = 
³”
->
assoc_»¥_›
->
d©a
;

2250 
assoc_r¥_›_Ën
 = 
³”
->
assoc_»¥_›
->
Ën
;

2256 
³”
->
wmm_acm
 = 0;

2257 
³”
->
t¥ec_e¡ablished
 = 0;

2258 
³”
->
u­sd
 = 0;

2259 
³”
->
æow_id
 = flow_id;

2264 ià(!
	`¡a_wmm_upd©e_u­sd
(
sdev
, 
dev
, 
³”
, 
assoc_›
, 
assoc_›_Ën
))

2265 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM uapsd\n");

2270 ià(!
	`¡a_wmm_upd©e_wmm_ac_›s
(
sdev
, 
dev
, 
³”
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
))

2271 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM AC ies\n");

2273 
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
 = 
NULL
;

2275 ià(
‹mpÜ®_keys_»quœed
) {

2276 
³”
->
·œwi£_key_£t
 = 0;

2277 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

2280 
	`WARN_ON
(
assoc_›_Ën
 && !
assoc_›
);

2281 
	`WARN_ON
(
assoc_r¥_›_Ën
 && !
assoc_r¥_›
);

2283 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "cfg80211_roamed()\n");

2285 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

2290 
rßm_šfo
.
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

2291 
rßm_šfo
.
bssid
 = 
³”
->
add»ss
;

2292 
rßm_šfo
.
»q_›
 = 
assoc_›
;

2293 
rßm_šfo
.
»q_›_Ën
 = 
assoc_›_Ën
;

2294 
rßm_šfo
.
»¥_›
 = 
assoc_r¥_›
;

2295 
rßm_šfo
.
»¥_›_Ën
 = 
assoc_r¥_›_Ën
;

2296 
	`cfg80211_rßmed
(
dev
, &
rßm_šfo
, 
GFP_KERNEL
);

2298 
	`cfg80211_rßmed
(
dev
,

2299 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
,

2300 
³”
->
add»ss
,

2301 
assoc_›
,

2302 
assoc_›_Ën
,

2303 
assoc_r¥_›
,

2304 
assoc_r¥_›_Ën
,

2305 
GFP_KERNEL
);

2307 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


2308 ià(
	`¦si_£nd_rßm_v’dÜ_ev’t
(
sdev
, 
³”
->
add»ss
, 
assoc_›
, 
assoc_›_Ën
,

2309 
assoc_r¥_›
, 
assoc_r¥_›_Ën
,

2310 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
,

2311 !
‹mpÜ®_keys_»quœed
) != 0) {

2312 
	`SLSI_NET_ERR
(
dev
, "Couldnt send Roam vendorƒvent");

2315 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "cfg80211_roamed() Done\n");

2317 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 = 
çl£
;

2318 
ndev_vif
->
chª
 =‚dev_vif->
¡a
.
¡a_bss
->
chªÃl
;

2319 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
bssid
, 
³”
->
add»ss
);

2321 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Taking‡ wakelock for DHCPo finish‡fter„oaming\n");

2322 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_rßm
, 
	`m£cs_to_jiff›s
(10 * 1000));

2323 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

2324 
	`SCSC_WLOG_WAKELOCK
(
WLOG_NORMAL
, 
WL_TAKEN
, "wÏn_wl_rßm", 
WL_REASON_ROAM
);

2327 ià(!
‹mpÜ®_keys_»quœed
) {

2328 
	`¦si_mlme_rßmed_»¥
(
sdev
, 
dev
);

2329 
	`ÿc_upd©e_rßm_Œaffic_·¿ms
(
sdev
, 
dev
);

2331 
ndev_vif
->
¡a
.
»¥_id
 = 
MLME_ROAMED_RES
;

2335 
ex™
:

2336 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2337 
	`¹Æ_uÆock
();

2338 
	`kä“_skb
(
skb
);

2339 
	}
}

2341 
	$¦si_rx_rßm_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2343 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2345 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2347 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_roam_ind(vif:%d,‡id:0,„esult:0x%04x )\n",

2348 
	`çpi_g‘_vif
(
skb
),

2349 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_rßm_šd
.
»suÉ_code
));

2351 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2353 ià(!
ndev_vif
->
aùiv©ed
) {

2354 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2355 
ex™_w™h_lock
;

2358 
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not‡ Station VIF\n");

2360 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_rßm_šd
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2361 
	`SLSI_NET_ERR
(
dev
, "mlme_roam_ind(result:0x%04x) ERROR\n",

2362 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_rßm_šd
.
»suÉ_code
));

2363 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 = 
çl£
;

2366 
ex™_w™h_lock
:

2367 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2368 
	`kä“_skb
(
skb
);

2369 
	}
}

2371 
	$¦si_tdls_ev’t_discov”ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2373 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2374 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2375 
Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

2377 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2379 
	`SLSI_INFO
(
sdev
, "\n");

2381 ià(
Ën
 != 0) {

2382 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
,‚dev_vif->
chª
->
ûÁ”_äeq
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
Ën
, 
GFP_ATOMIC
);

2385 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2387 
	`kä“_skb
(
skb
);

2388 
	}
}

2390 
	$¦si_tdls_ev’t_cÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2392 
¦si_³”
 *
³”
 = 
NULL
;

2393 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2394 
u16
 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.flow_id);

2396 
u16
 
³”_šdex
 = (
æow_id
 >> 8);

2398 
	`¹Æ_lock
();

2399 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2401 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
Œue
;

2403 
	`SLSI_INFO
(
sdev
, "(vif:%d,…“r_šdex:%d mac[" 
MACSTR
 "])\n",

2404 
	`çpi_g‘_vif
(
skb
), 
³”_šdex
, 
	`MAC2STR
(
	`çpi_g‘_buff
(skb, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
)));

2406 ià(!
ndev_vif
->
aùiv©ed
) {

2407 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2408 
ex™_w™h_lock
;

2411 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "STA VIF"))

2412 
ex™_w™h_lock
;

2414 ià(
³”_šdex
 < 
SLSI_TDLS_PEER_INDEX_MIN
 ||…“r_šdex > 
SLSI_TDLS_PEER_INDEX_MAX
) {

2415 
	`SLSI_NET_ERR
(
dev
, "Reûived incÜ»ù…“r_šdex: %d\n", 
³”_šdex
);

2416 
ex™_w™h_lock
;

2424 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2425 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

2427 ià(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
 + 1 > 
SLSI_TDLS_PEER_CONNECTIONS_MAX
) {

2428 
	`SLSI_NET_ERR
(
dev
, "MAX TDLS…“¸lim™„—ched. IgnÜšd fÜ…“r_šdex:%d\n", 
³”_šdex
);

2429 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2430 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2431 
ex™_w™h_lock
;

2434 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
), 
³”_šdex
);

2436 ià(!
³”
) {

2437 
	`SLSI_NET_ERR
(
dev
, "Peer NOT Created\n");

2438 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2439 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2440 
ex™_w™h_lock
;

2444 
³”
->
qos_’abËd
 = 
Œue
;

2446 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

2448 #ifdeà
CONFIG_SCSC_WLAN_TX_API


2449 
	`¦si_tx_tdls_upd©e
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
Œue
);

2452 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
Œue
);

2454 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2455 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2457 
ex™_w™h_lock
:

2458 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2459 
	`¹Æ_uÆock
();

2460 
	`kä“_skb
(
skb
);

2461 
	}
}

2463 
	$¦si_tdls_ev’t_discÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2465 
¦si_³”
 *
³”
 = 
NULL
;

2466 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2469 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2471 ià(
	`WARN_ON
(!
dev
))

2472 
ex™
;

2474 
	`SLSI_INFO
(
sdev
, "(vif:%d, MAC:" 
MACSTR
 ")\n", 
ndev_vif
->
iâum
,

2475 
	`MAC2STR
(
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
)));

2477 ià(!
ndev_vif
->
aùiv©ed
) {

2478 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2479 
ex™
;

2487 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2488 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

2489 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

2491 ià(!
³”
 ||…“r->
aid
 == 0) {

2492 
	`WARN_ON
(!
³”
 || (³”->
aid
 == 0));

2493 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "peer NOT found by MAC‡ddress\n");

2494 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2495 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2496 
ex™
;

2499 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

2501 #ifdeà
CONFIG_SCSC_WLAN_TX_API


2502 
	`¦si_tx_tdls_upd©e
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
çl£
);

2505 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
çl£
);

2511 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2512 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2515 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

2516 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

2517 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2519 
ex™
:

2520 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2521 
	`kä“_skb
(
skb
);

2522 
	}
}

2526 
	$¦si_tdls_³”_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2528 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2529 
u16
 
tdls_ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.tdls_event);

2531 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_tdls_³”_šddls_ev’t: %d\n", 
tdls_ev’t
);

2532 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2533 ià(!
ndev_vif
->
aùiv©ed
) {

2534 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2535 
	`kä“_skb
(
skb
);

2536 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2539 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2541 
tdls_ev’t
) {

2542 
FAPI_TDLSEVENT_CONNECTED
:

2543 
	`¦si_tdls_ev’t_cÚÃùed
(
sdev
, 
dev
, 
skb
);

2545 
FAPI_TDLSEVENT_DISCONNECTED
:

2546 
	`¦si_tdls_ev’t_discÚÃùed
(
sdev
, 
dev
, 
skb
);

2548 
FAPI_TDLSEVENT_DISCOVERED
:

2549 
	`¦si_tdls_ev’t_discov”ed
(
sdev
, 
dev
, 
skb
);

2552 
	`WARN_ON
((
tdls_ev’t
 == 0) || (tdls_event > 4));

2553 
	`kä“_skb
(
skb
);

2556 
	}
}

2559 
	$¦si_rx_bufã»d_äames
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

2561 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2562 
sk_buff
 *
buff_äame
 = 
NULL
;

2564 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2565 ià(
	`WARN
(!
³”
, "Peer is NULL"))

2567 
	`WARN
(
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTING
, "Wrong state");

2569 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

2571 
ndev_vif
->
iâum
, 
³”
->
aid
);

2572 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

2573 
buff_äame
) {

2574 
	`¦si_debug_äame
(
sdev
, 
dev
, 
buff_äame
, "RX_BUFFERED");

2575 
	`çpi_g‘_sigid
(
buff_äame
)) {

2576 
MA_BLOCKACKREQ_IND
:

2577 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Transferring buffered MA_BLOCKACK_IND frame");

2578 
	`__¦si_rx_blockack_šd
(
sdev
, 
dev
, 
buff_äame
);

2581 
	`SLSI_NET_WARN
(
dev
, "UÃx³ùed D©a: 0x%.4x\n", 
	`çpi_g‘_sigid
(
buff_äame
));

2582 
	`kä“_skb
(
buff_äame
);

2585 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

2587 
	}
}

2589 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


2590 
	$¦si_rx_synchrÚi£d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2592 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2593 
cfg80211_ex‹º®_auth_·¿ms
 
auth_»que¡
;

2594 
r
, 
synch_šd_time
 = 0;

2595 
u16
 
§e_auth
 = 0;

2596 
u8
 
bssid
[
ETH_ALEN
] = {0};

2598 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2599 ià(!
ndev_vif
->
aùiv©ed
) {

2600 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2601 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2602 
	`kä“_skb
(
skb
);

2605 
	`SLSI_ETHER_COPY
(
bssid
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_synchrÚi£d_šd
.bssid));

2606 
§e_auth
 = 
	`çpi_g‘_high16_u32
(
skb
, 
u
.
mlme_synchrÚi£d_šd
.
¥¬e_1
) & 0x00FF;

2608 ià(
§e_auth
 > 1) {

2609 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Inv®id v®u»ûived fÜ SAE Auth Reque¡ğ%d\n", 
§e_auth
);

2610 
ex™
;

2613 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Reûived synchrÚi£d_šd, bssid:%pM SAE Auth Reque¡ = %d\n", 
bssid
, 
§e_auth
);

2614 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 =ğ3 && !
§e_auth
) {

2615 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
skb
, 
çl£
);

2616 
synch_šd_time
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

2617 ià(
synch_šd_time
 < 
ndev_vif
->
¡a
.
cÚÃù_úf_time
 + 
SLSI_RX_SYNCH_IND_DELAY
)

2618 
	`ud–ay
(((
ndev_vif
->
¡a
.
cÚÃù_úf_time
 + 50è- 
synch_šd_time
) * 1000);

2620 
auth_»que¡
.
aùiÚ
 = 
NL80211_EXTERNAL_AUTH_START
;

2621 
	`memıy
(
auth_»que¡
.
bssid
, bssid, 
ETH_ALEN
);

2622 
	`memıy
(
auth_»que¡
.
ssid
.ssid, 
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
);

2623 
auth_»que¡
.
ssid
.
ssid_Ën
 = 
ndev_vif
->
¡a
.ssid_len;

2624 
auth_»que¡
.
key_mgmt_su™e
 = 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0];

2626 
r
 = 
	`cfg80211_ex‹º®_auth_»que¡
(
dev
, &
auth_»que¡
, 
GFP_KERNEL
);

2627 ià(
r
)

2628 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "cfg80211_external_auth_request failed");

2630 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2631 
ndev_vif
->
¡a
.
w·3_auth_¡©e
 = 
SLSI_WPA3_AUTHENTICATING
;

2635 
	`kä“_skb
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

2636 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
 = 
skb
;

2637 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)

2638 
sdev
->
cÚn_log2us_ùx
.
cÚn_æag
 = 
Œue
;

2639 
ex™
:

2640 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2641 
	}
}

2644 
	$¦si_add_bÏckli¡_šfo
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
addr
, 
u32
 
»‹ÁiÚ_time
)

2646 
¦si_bssid_bÏckli¡_šfo
 *
d©a
;

2647 
bÏckli¡_»ûived_time
;

2648 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

2653 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2654 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

2656 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

2657 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, 
addr
)) {

2658 
bÏckli¡_»ûived_time
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

2659 
bÏckli¡_šfo
->
’d_time
 = 
bÏckli¡_»ûived_time
 + 
»‹ÁiÚ_time
 * 1000;

2664 
d©a
 = 
	`kz®loc
((*d©a), 
GFP_KERNEL
);

2666 ià(!
d©a
) {

2667 
	`SLSI_NET_ERR
(
dev
, "BÏckli¡_add: UÇbËØadd bÏckli¡ MAC:" 
MACSTR
 "\n", 
	`MAC2STR
(
addr
));

2670 
	`‘h”_addr_cİy
(
d©a
->
bssid
, 
addr
);

2671 
bÏckli¡_»ûived_time
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

2672 
d©a
->
’d_time
 = 
bÏckli¡_»ûived_time
 + 
»‹ÁiÚ_time
 * 1000;

2673 
	`li¡_add
(&
d©a
->
li¡
, &
ndev_vif
->
aş_d©a_fw_li¡
);

2676 
	`¦si_£t_aş
(
sdev
, 
dev
);

2677 
	}
}

2679 
	$¦si_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2681 
cfg80211_aş_d©a
 *
aş_d©a_tÙ®
 = 
NULL
;

2682 
fw_aş_’Œ›s_couÁ
 = 0;

2683 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2684 
»t
 = 0;

2685 
num_bssid_tÙ®
 = 0;

2686 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

2687 
ioùl_aş_’Œ›s_couÁ
 = 0;

2690 ià(!
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

2691  -
EINVAL
;

2693 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2694 
fw_aş_’Œ›s_couÁ
++;

2697 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

2698 
ioùl_aş_’Œ›s_couÁ
++;

2701 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
)

2702 
num_bssid_tÙ®
 +ğ
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
;

2703 ià(
ndev_vif
->
aş_d©a_h®
)

2704 
num_bssid_tÙ®
 +ğ
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
;

2705 
num_bssid_tÙ®
 +ğ
fw_aş_’Œ›s_couÁ
;

2706 
num_bssid_tÙ®
 +ğ
ioùl_aş_’Œ›s_couÁ
;

2708 
aş_d©a_tÙ®
 = 
	`km®loc
((*aş_d©a_tÙ®è+ ((
mac_add»ss
è* 
num_bssid_tÙ®
), 
GFP_KERNEL
);

2710 ià(!
aş_d©a_tÙ®
) {

2711 
	`SLSI_ERR
(
sdev
, "Blacklist: Failedo‡llocate memory\n");

2712  -
ENOMEM
;

2714 
aş_d©a_tÙ®
->
n_aş_’Œ›s
 = 0;

2715 
aş_d©a_tÙ®
->
aş_pŞicy
 = 
FAPI_ACLPOLICY_BLACKLIST
;

2716 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
 &&‚dev_vif->aş_d©a_suµliÿÁ->
n_aş_’Œ›s
) {

2717 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
,

2718 
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[0].
addr
,

2719 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
 * 
ETH_ALEN
);

2720 
aş_d©a_tÙ®
->
n_aş_’Œ›s
 +ğ
ndev_vif
->
aş_d©a_suµliÿÁ
->n_acl_entries;

2722 ià(
ndev_vif
->
aş_d©a_h®
 &&‚dev_vif->aş_d©a_h®->
n_aş_’Œ›s
) {

2723 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
,

2724 
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[0].
addr
,

2725 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
 * 
ETH_ALEN
);

2726 
aş_d©a_tÙ®
->
n_aş_’Œ›s
 +ğ
ndev_vif
->
aş_d©a_h®
->n_acl_entries;

2729 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2730 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

2732 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

2733 ià(
bÏckli¡_šfo
) {

2734 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
, 
bÏckli¡_šfo
->
bssid
, 
ETH_ALEN
);

2735 
aş_d©a_tÙ®
->
n_aş_’Œ›s
++;

2739 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

2740 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

2742 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

2743 ià(
bÏckli¡_šfo
) {

2744 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
, 
bÏckli¡_šfo
->
bssid
, 
ETH_ALEN
);

2745 
aş_d©a_tÙ®
->
n_aş_’Œ›s
++;

2749 
»t
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 0, 
aş_d©a_tÙ®
->
aş_pŞicy
,‡ş_d©a_tÙ®->
n_aş_’Œ›s
,

2750 
aş_d©a_tÙ®
->
mac_addrs
);

2751 
	`kä“
(
aş_d©a_tÙ®
);

2752  
»t
;

2753 
	}
}

2755 
	$¦si_rx_bÏckli¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2757 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2758 
u8
 *
mac_addr
;

2759 
u32
 
»‹ÁiÚ_time
;

2761 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_bÏckli¡ed_šd(vif:%d, MAC:" 
MACSTR
 " )\n",

2762 
	`çpi_g‘_vif
(
skb
),

2763 
	`MAC2STR
(
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_bÏckli¡ed_šd
.
bssid
)));

2765 
	`ÿnûl_d–ayed_wÜk_sync
(&
ndev_vif
->
bÏckli¡_d–_wÜk
);

2767 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2768 
mac_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_bÏckli¡ed_šd
.
bssid
);

2769 
»‹ÁiÚ_time
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
mlme_bÏckli¡ed_šd
.
»assocŸtiÚ_»Œy_d–ay
);

2770 
	`¦si_add_bÏckli¡_šfo
(
sdev
, 
dev
, 
ndev_vif
, 
mac_addr
, 
»‹ÁiÚ_time
);

2771 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2773 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
bÏckli¡_d–_wÜk
, 0);

2774 
	`kä“_skb
(
skb
);

2775 
	}
}

2777 
	$¦si_rx_cÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2779 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2780 
¦si_³”
 *
³”
 = 
NULL
;

2781 
u16
 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃùed_šd
.flow_id);

2782 
u16
 
aid
 = (
æow_id
 >> 8);

2786 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2788 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_connected_ind(vif:%d,…eer_index:%d)\n",

2789 
	`çpi_g‘_vif
(
skb
),

2790 
aid
);

2791 
	`SLSI_INFO
(
sdev
, "Received Association Response\n");

2793 ià(!
ndev_vif
->
aùiv©ed
) {

2794 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2795 
ex™_w™h_lock
;

2798 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
, "STA VIF‡nd Not Roaming"))

2799 
ex™_w™h_lock
;

2801 
ndev_vif
->
vif_ty³
) {

2802 
FAPI_VIFTYPE_AP
:

2804 ià(
aid
 < 
SLSI_PEER_INDEX_MIN
 ||‡id > 
SLSI_PEER_INDEX_MAX
) {

2805 
	`SLSI_NET_ERR
(
dev
, "Reûived incÜ»ù…“r_šdex: %d\n", 
aid
);

2806 
ex™_w™h_lock
;

2809 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
aid
 - 1);

2810 ià(!
³”
) {

2811 
	`SLSI_NET_ERR
(
dev
, "P“¸×id:%dèNÙ Found - DiscÚÃù…“r\n", 
aid
);

2812 
ex™_w™h_lock
;

2815 
³”
->
æow_id
 = flow_id;

2816 
	`cfg80211_Ãw_¡a
(
dev
, 
³”
->
add»ss
, &³”->
sšfo
, 
GFP_KERNEL
);

2818 ià(
ndev_vif
->
­
.
´ivacy
) {

2819 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
;

2820 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

2822 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

2823 
	`¦si_mlme_cÚÃùed_»¥
(
sdev
, 
dev
, 
aid
);

2824 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

2826 
	`¦si_rx_bufã»d_äames
(
sdev
, 
dev
, 
³”
);

2831 
	`SLSI_NET_WARN
(
dev
, "mlme_cÚÃùed_šd(vif:%d, uÃx³ùed viàty³:%d)\n", 
	`çpi_g‘_vif
(
skb
), 
ndev_vif
->
vif_ty³
);

2834 
ex™_w™h_lock
:

2835 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2836 
	`kä“_skb
(
skb
);

2837 
	}
}

2839 
	$¦si_rx_»assoc_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2841 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2842 
›“80211_¡©uscode
 
¡©us
 = 
WLAN_STATUS_SUCCESS
;

2843 
¦si_³”
 *
³”
 = 
NULL
;

2844 
u8
 *
assoc_›
 = 
NULL
;

2845 
size_t
 
assoc_›_Ën
 = 0;

2846 
u8
 *
»assoc_r¥_›
 = 
NULL
;

2847 
size_t
 
»assoc_r¥_›_Ën
 = 0;

2849 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_reassoc_ind(vif:%d,„esult:0x%04x)\n",

2850 
	`çpi_g‘_vif
(
skb
),

2851 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»assocŸ‹_šd
.
»suÉ_code
));

2853 
	`¹Æ_lock
();

2854 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2856 ià(!
ndev_vif
->
aùiv©ed
) {

2857 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2858 
ex™_w™h_lock
;

2861 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not‡ Station VIF\n"))

2862 
ex™_w™h_lock
;

2864 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 0);

2865 ià(
	`WARN_ON
(!
³”
)) {

2866 
	`SLSI_NET_ERR
(
dev
, "PEER Not found\n");

2867 
ex™_w™h_lock
;

2870 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»assocŸ‹_šd
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2871 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

2872 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

2874 
³”
->
·œwi£_key_£t
 = 0;

2876 ià(
³”
->
assoc_›
) {

2877 
assoc_›
 = 
³”
->assoc_›->
d©a
;

2878 
assoc_›_Ën
 = 
³”
->
assoc_›
->
Ën
;

2879 
	`WARN_ON
(
assoc_›_Ën
 && !
assoc_›
);

2882 
	`¦si_³”_»£t_¡©s
(
sdev
, 
dev
, 
³”
);

2884 
³”
->
sšfo
.
assoc_»q_›s
 = 
assoc_›
;

2885 
³”
->
sšfo
.
assoc_»q_›s_Ën
 = 
assoc_›_Ën
;

2886 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(4, 0, 0))

2887 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_ASSOC_REQ_IES
;

2889 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
skb
);

2891 
skb
 = 
NULL
;

2892 ià(
³”
->
assoc_»¥_›
) {

2893 
»assoc_r¥_›
 = 
³”
->
assoc_»¥_›
->
d©a
;

2894 
»assoc_r¥_›_Ën
 = 
³”
->
assoc_»¥_›
->
Ën
;

2895 
	`WARN_ON
(
»assoc_r¥_›_Ën
 && !
»assoc_r¥_›
);

2901 ià(!
	`¡a_wmm_upd©e_u­sd
(
sdev
, 
dev
, 
³”
, 
assoc_›
, 
assoc_›_Ën
))

2902 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM uapsd\n");

2907 ià(!
	`¡a_wmm_upd©e_wmm_ac_›s
(
sdev
, 
dev
, 
³”
, 
»assoc_r¥_›
, 
»assoc_r¥_›_Ën
))

2908 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM AC ies\n");

2912 
	`cfg80211_cÚÃù_»suÉ
(
dev
,

2913 
³”
->
add»ss
,

2914 
assoc_›
, 
assoc_›_Ën
,

2915 
»assoc_r¥_›
, 
»assoc_r¥_›_Ën
,

2916 
¡©us
,

2917 
GFP_KERNEL
);

2919 ià(
¡©us
 =ğ
WLAN_STATUS_SUCCESS
) {

2920 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTED
;

2925 ià((
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) &&

2926 (
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
assoc_›
, 
assoc_›_Ën
) ||

2927 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_WAPI
, 
assoc_›
, 
assoc_›_Ën
) ||

2928 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
assoc_›
, 
assoc_›_Ën
))) {

2930 
ndev_vif
->
¡a
.
»¥_id
 = 
MLME_REASSOCIATE_RES
;

2931 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

2932 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
;

2935 
	`¦si_mlme_»assocŸ‹_»¥
(
sdev
, 
dev
);

2936 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

2937 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

2940 
	`Ãtif_ÿ¼›r_off
(
dev
);

2941 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

2942 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

2943 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

2946 
ex™_w™h_lock
:

2947 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2948 
	`¹Æ_uÆock
();

2949 
	`kä“_skb
(
skb
);

2950 
	}
}

2952 
	$¦si_cÚÃù_»suÉ_code
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
fw_»suÉ_code
, *
¡©us
, 
Æ80211_timeout_»asÚ
 *
timeout_»asÚ
)

2954 *
¡©us
 = 
fw_»suÉ_code
;

2955 
fw_»suÉ_code
) {

2956 
FAPI_RESULTCODE_PROBE_TIMEOUT
:

2957 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_SCAN
;

2958 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2959 *
¡©us
 = 
SLSI_CONNECT_NO_NETWORK_FOUND
;

2962 
FAPI_RESULTCODE_AUTH_TIMEOUT
:

2963 *
¡©us
 = 
WLAN_STATUS_AUTH_TIMEOUT
;

2964 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_AUTH
;

2965 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2966 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

2967 *
¡©us
 = 
SLSI_CONNECT_AUTH_SAE_NO_RESP
;

2969 *
¡©us
 = 
SLSI_CONNECT_AUTH_NO_RESP
;

2972 
FAPI_RESULTCODE_AUTH_NO_ACK
:

2973 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_AUTH
;

2974 *
¡©us
 = 
WLAN_STATUS_AUTH_TIMEOUT
;

2975 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2976 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

2977 *
¡©us
 = 
SLSI_CONNECT_AUTH_SAE_NO_ACK
;

2979 *
¡©us
 = 
SLSI_CONNECT_AUTH_NO_ACK
;

2982 
FAPI_RESULTCODE_AUTH_TX_FAIL
:

2983 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_AUTH
;

2984 *
¡©us
 = 
WLAN_STATUS_AUTH_TIMEOUT
;

2985 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2986 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

2987 *
¡©us
 = 
SLSI_CONNECT_AUTH_SAE_TX_FAIL
;

2989 *
¡©us
 = 
SLSI_CONNECT_AUTH_TX_FAIL
;

2992 
FAPI_RESULTCODE_ASSOC_TIMEOUT
:

2993 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_ASSOC
;

2994 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2995 *
¡©us
 = 
SLSI_CONNECT_ASSOC_NO_RESP
;

2998 
FAPI_RESULTCODE_ASSOC_ABORT
:

2999 *
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

3001 
FAPI_RESULTCODE_ASSOC_NO_ACK
:

3002 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_ASSOC
;

3003 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

3004 *
¡©us
 = 
SLSI_CONNECT_ASSOC_NO_ACK
;

3007 
FAPI_RESULTCODE_ASSOC_TX_FAIL
:

3008 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_ASSOC
;

3009 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

3010 *
¡©us
 = 
SLSI_CONNECT_ASSOC_TX_FAIL
;

3014 *
¡©us
 = 
fw_»suÉ_code
;

3016 
	}
}

3018 
	$¦si_rx_cÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3020 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3021 
¡©us
 = 
WLAN_STATUS_SUCCESS
;

3022 
¦si_³”
 *
³”
 = 
NULL
;

3023 
u8
 *
assoc_›
 = 
NULL
;

3024 
assoc_›_Ën
 = 0;

3025 
u8
 *
assoc_r¥_›
 = 
NULL
;

3026 
assoc_r¥_›_Ën
 = 0;

3027 
u8
 
bssid
[
ETH_ALEN
];

3028 
u16
 
fw_»suÉ_code
;

3029 
u16
 
æow_id
;

3030 
›“80211_chªÃl
 *
cur_chªÃl
 = 
NULL
;

3031 
Æ80211_timeout_»asÚ
 
timeout_»asÚ
 = 
NL80211_TIMEOUT_UNSPECIFIED
;

3032 
cÚn_ç_»asÚ
 = 3;

3034 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

3035 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

3036 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3038 
fw_»suÉ_code
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃù_šd
.
»suÉ_code
);

3039 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃù_šd
.flow_id);

3041 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_connect_ind(vif:%d,„esult:0x%04x)\n",

3042 
	`çpi_g‘_vif
(
skb
), 
fw_»suÉ_code
);

3044 ià(!
ndev_vif
->
aùiv©ed
) {

3045 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3046 
ex™_w™h_lock
;

3049 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not‡ Station VIF\n"))

3050 
ex™_w™h_lock
;

3052 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTING
) {

3053 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot in connecting state\n");

3054 
ex™_w™h_lock
;

3057 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3058 ià(
³”
) {

3059 
	`SLSI_ETHER_COPY
(
bssid
, 
³”
->
add»ss
);

3061 
	`SLSI_NET_ERR
(
dev
, "!!NO…eer„ecord for AP\n");

3062 
	`‘h_z”o_addr
(
bssid
);

3065 ià(!
sdev
->
cÚn_log2us_ùx
.
cÚn_æag
) {

3066 ià(!
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
) {

3067 
cÚn_ç_»asÚ
 = 1;

3068 
	`¦si_cÚn_log2us_cÚÃùšg_ç
(
sdev
, 
dev
, 
bssid
,

3069 
ndev_vif
->
chª
 ?‚dev_vif->chª->
ûÁ”_äeq
 : 0,

3070 
cÚn_ç_»asÚ
);

3072 
	`¦si_cÚn_log2us_cÚÃùšg_ç
(
sdev
, 
dev
, 
bssid
,

3073 
ndev_vif
->
chª
 ?‚dev_vif->chª->
ûÁ”_äeq
 : 0,

3074 
cÚn_ç_»asÚ
);

3078 
sdev
->
assoc_»suÉ_code
 = 
fw_»suÉ_code
;

3079 ià(
fw_»suÉ_code
 !ğ
FAPI_RESULTCODE_SUCCESS
) {

3080 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3081 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3082 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 =ğ3 &&‚dev_vif->¡a.
w·3_auth_¡©e
 =ğ
SLSI_WPA3_AUTHENTICATING
 &&

3083 (
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TIMEOUT
 || fw_»suÉ_cod=ğ
FAPI_RESULTCODE_AUTH_NO_ACK
 ||

3084 
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TX_FAIL
)) {

3085 
r
;

3086 
cfg80211_ex‹º®_auth_·¿ms
 
auth_»que¡
;

3088 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3089 
auth_»que¡
.
aùiÚ
 = 
NL80211_EXTERNAL_AUTH_ABORT
;

3090 
	`memıy
(
auth_»que¡
.
bssid
, 
ndev_vif
->
¡a
.bssid, 
ETH_ALEN
);

3091 
	`memıy
(
auth_»que¡
.
ssid
.ssid, 
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
);

3092 
auth_»que¡
.
ssid
.
ssid_Ën
 = 
ndev_vif
->
¡a
.ssid_len;

3093 
auth_»que¡
.
key_mgmt_su™e
 = 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0];

3094 
r
 = 
	`cfg80211_ex‹º®_auth_»que¡
(
dev
, &
auth_»que¡
, 
GFP_KERNEL
);

3095 ià(
r
)

3096 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "cfg80211_external_auth_request Abort failed");

3099 ià(
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 && 
	`¦si_»Œy_cÚÃùiÚ
(
sdev
, 
dev
)) {

3100 
	`SLSI_INFO
(
sdev
, "Connect ind :„etrying connection\n");

3101 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3102 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

3103 
ndev_vif
->
¡a
.
w·3_§e_»cÚÃùiÚ
 = 
Œue
;

3105 
ex™_w™h_lock
;

3107 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
çl£
;

3108 
	`¦si_ä“_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
);

3111 ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TIMEOUT
) {

3112 
	`SLSI_INFO
(
sdev
, "Connect failed,Result code: Auth Timeout\n");

3113 } ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_ASSOC_TIMEOUT
) {

3114 
	`SLSI_INFO
(
sdev
, "Connect failed,Result code: Assoc Timeout\n");

3115 } ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_PROBE_TIMEOUT
) {

3116 
	`SLSI_INFO
(
sdev
, "Connect failed,Result code: Probe Timeout\n");

3117 } ià(
fw_»suÉ_code
 >ğ
FAPI_RESULTCODE_AUTH_FAILED_CODE
 && fw_result_code <= 0x81FF) {

3118 ià(
fw_»suÉ_code
 !ğ
FAPI_RESULTCODE_AUTH_FAILED_CODE
)

3119 
fw_»suÉ_code
 = fw_result_code & 0x00FF;

3120 
	`SLSI_INFO
(
sdev
, "CÚÃù faed(Auth fau»), ResuÉ code:0x%04x\n", 
fw_»suÉ_code
);

3121 } ià(
fw_»suÉ_code
 >ğ
FAPI_RESULTCODE_ASSOC_FAILED_CODE
 && fw_result_code <= 0x82FF) {

3122 ià(
fw_»suÉ_code
 !ğ
FAPI_RESULTCODE_ASSOC_FAILED_CODE
)

3123 
fw_»suÉ_code
 = fw_result_code & 0x00FF;

3124 
	`SLSI_INFO
(
sdev
, "CÚÃù faed(AssoøFau»), ResuÉ code:0x%04x\n", 
fw_»suÉ_code
);

3126 ià(
	`çpi_g‘_d©®’
(
skb
)) {

3127 
mgmt_hdr_Ën
;

3128 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

3130 ià(
	`›“80211_is_assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

3131 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

3132 } ià(
	`›“80211_is_»assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

3133 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
»assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

3135 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Assoc/Reassoc„esponse‚ot found!\n");

3136 
ex™_w™h_lock
;

3139 
assoc_r¥_›
 = (*)
mgmt
 + 
mgmt_hdr_Ën
;

3140 
assoc_r¥_›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
è- 
mgmt_hdr_Ën
;

3143 
	`SLSI_INFO
(
sdev
, "CÚÃù faed,ResuÉ code:0x%04x\n", 
fw_»suÉ_code
);

3145 ià(
fw_»suÉ_code
 <ğ
FAPI_RESULTCODE_ASSOC_FAILED_CODE
)

3146 
	`¦si_cÚÃù_»suÉ_code
(
ndev_vif
, 
fw_»suÉ_code
, &
¡©us
, &
timeout_»asÚ
);

3147 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

3149 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_CONNECT_ERR
);

3151 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3152 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3153 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3) {

3154 ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TIMEOUT
 ||

3155 
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_NO_ACK
 ||

3156 
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TX_FAIL
) {

3157 
r
;

3158 
cfg80211_ex‹º®_auth_·¿ms
 
auth_»que¡
;

3160 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3161 
auth_»que¡
.
aùiÚ
 = 
NL80211_EXTERNAL_AUTH_ABORT
;

3162 
	`memıy
(
auth_»que¡
.
bssid
, 
ndev_vif
->
¡a
.bssid, 
ETH_ALEN
);

3163 
	`memıy
(
auth_»que¡
.
ssid
.ssid, 
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
);

3164 
auth_»que¡
.
ssid
.
ssid_Ën
 = 
ndev_vif
->
¡a
.ssid_len;

3165 
auth_»que¡
.
key_mgmt_su™e
 = 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0];

3166 
r
 = 
	`cfg80211_ex‹º®_auth_»que¡
(
dev
, &
auth_»que¡
, 
GFP_KERNEL
);

3167 ià(
r
)

3168 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "cfg80211_external_auth_request Abort failed");

3174 
	`SLSI_INFO
(
sdev
, "Received Association Response\n");

3175 ià(!
³”
 || !³”->
assoc_›
) {

3176 ià(
³”
)

3177 
	`WARN
(!
³”
->
assoc_›
, "proc-started-ind‚ot„eceived before connect-ind");

3178 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

3180 
³”
->
æow_id
 = flow_id;

3181 ià(
³”
->
assoc_›
) {

3182 
assoc_›
 = 
³”
->assoc_›->
d©a
;

3183 
assoc_›_Ën
 = 
³”
->
assoc_›
->
Ën
;

3186 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
skb
);

3188 
skb
 = 
NULL
;

3190 ià(
³”
->
assoc_»¥_›
) {

3191 
assoc_r¥_›
 = 
³”
->
assoc_»¥_›
->
d©a
;

3192 
assoc_r¥_›_Ën
 = 
³”
->
assoc_»¥_›
->
Ën
;

3198 
³”
->
wmm_acm
 = 0;

3199 
³”
->
t¥ec_e¡ablished
 = 0;

3200 
³”
->
u­sd
 = 0;

3205 ià(!
	`¡a_wmm_upd©e_u­sd
(
sdev
, 
dev
, 
³”
, 
assoc_›
, 
assoc_›_Ën
))

3206 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM uapsd\n");

3211 ià(!
	`¡a_wmm_upd©e_wmm_ac_›s
(
sdev
, 
dev
, 
³”
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
))

3212 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM AC ies\n");

3214 
	`WARN_ON
(!
assoc_r¥_›_Ën
 && !
assoc_r¥_›
);

3217 
	`WARN
(!
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
, "mlme_scan.ind‚ot„eceived before connect-ind");

3219 ià(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
) {

3220 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3221 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

3223 
ndev_vif
->
¡a
.
b—cÚ_št
 = 
mgmt
->
u
.
b—cÚ
.beacon_int;

3225 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "S’dšg sÿÀšdiÿtiÚØcfg80211, bssid: %pM\n", 
	`çpi_g‘_mgmt
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
)->
bssid
);

3227 
cur_chªÃl
 = 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
, 
Œue
);

3228 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
 = 
NULL
;

3230 
	`SLSI_NET_ERR
(
dev
, "mlme_scan_ind_skb is‚ot‡vailable, mlme_synchronised_ind‚ot„eceived");

3233 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

3234 ià(
³”
)

3235 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

3236 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
,

3237 
NULL
, 0, 
IEEE80211_BSS_TYPE_ANY
,

3238 
IEEE80211_PRIVACY_ANY
);

3240 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
,

3241 
NULL
, 0, 0, 0);

3243 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

3244 
	`SLSI_NET_ERR
(
dev
, "¡a_bs i nÙ‡vaabË,”mš©šghcÚÃùiÚ (³”: %p)\n", 
³”
);

3245 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

3250 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3251 
ndev_vif
->
¡a
.
w·3_§e_»cÚÃùiÚ
 = 
çl£
;

3254 ià(!
³”
 && 
¡©us
 =ğ
WLAN_STATUS_SUCCESS
)

3255 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

3257 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

3258 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

3259 ià(
fw_»suÉ_code
 >ğ
FAPI_RESULTCODE_PROBE_TIMEOUT
 && fw_»suÉ_cod<ğ
FAPI_RESULTCODE_ASSOC_TIMEOUT
) {

3260 
	`cfg80211_cÚÃù_timeout
(
dev
, 
bssid
, 
assoc_›
, 
assoc_›_Ën
,

3261 
GFP_KERNEL
, 
timeout_»asÚ
);

3263 ià(!
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 || 
¡©us
 !ğ
WLAN_STATUS_SUCCESS
) {

3264 
	`cfg80211_»f_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

3265 
	`cfg80211_cÚÃù_bss
(
dev
, 
bssid
, 
ndev_vif
->
¡a
.
¡a_bss
, 
assoc_›
, 
assoc_›_Ën
, 
assoc_r¥_›
,

3266 
assoc_r¥_›_Ën
, 
¡©us
, 
GFP_KERNEL
, 
timeout_»asÚ
);

3268 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

3269 
cfg80211_rßm_šfo
 
rßm_šfo
 = {};

3275 
rßm_šfo
.
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

3276 
rßm_šfo
.
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

3277 
rßm_šfo
.
»q_›
 = 
assoc_›
;

3278 
rßm_šfo
.
»q_›_Ën
 = 
assoc_›_Ën
;

3279 
rßm_šfo
.
»¥_›
 = 
assoc_r¥_›
;

3280 
rßm_šfo
.
»¥_›_Ën
 = 
assoc_r¥_›_Ën
;

3281 
	`cfg80211_rßmed
(
dev
, &
rßm_šfo
, 
GFP_KERNEL
);

3283 
	`cfg80211_rßmed
(
dev
,

3284 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
,

3285 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
,

3286 
assoc_›
,

3287 
assoc_›_Ën
,

3288 
assoc_r¥_›
,

3289 
assoc_r¥_›_Ën
,

3290 
GFP_KERNEL
);

3292 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


3293 ià(
	`¦si_£nd_rßm_v’dÜ_ev’t
(
sdev
, 
³”
->
add»ss
, 
assoc_›
, 
assoc_›_Ën
,

3294 
assoc_r¥_›
, 
assoc_r¥_›_Ën
,

3295 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
,

3296 
çl£
) != 0) {

3297 
	`SLSI_NET_ERR
(
dev
, "Couldnt send Roamƒvent");

3300 
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 = 
çl£
;

3304 
	`cfg80211_»f_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

3305 
	`cfg80211_cÚÃù_bss
(
dev
, 
bssid
, 
ndev_vif
->
¡a
.
¡a_bss
, 
assoc_›
, 
assoc_›_Ën
, 
assoc_r¥_›
,

3306 
assoc_r¥_›_Ën
, 
¡©us
, 
GFP_KERNEL
, 
timeout_»asÚ
);

3312 
	`cfg80211_cÚÃù_»suÉ
(
dev
,

3313 
bssid
,

3314 
assoc_›
, 
assoc_›_Ën
,

3315 
assoc_r¥_›
, 
assoc_r¥_›_Ën
,

3316 (
u16
)
¡©us
,

3317 
GFP_KERNEL
);

3319 ià(
¡©us
 =ğ
WLAN_STATUS_SUCCESS
) {

3320 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTED
;

3326 ià((
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) &&

3327 (
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
assoc_›
, 
assoc_›_Ën
) ||

3328 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_WAPI
, 
assoc_›
, 
assoc_›_Ën
) ||

3329 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
assoc_›
, 
assoc_›_Ën
))) {

3331 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

3332 
ndev_vif
->
¡a
.
»¥_id
 = 
MLME_CONNECT_RES
;

3335 
	`¦si_mlme_cÚÃù_»¥
(
sdev
, 
dev
);

3336 ià(
ndev_vif
->
add»ss
)

3337 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

3339 
	`¦si_£t_aş
(
sdev
, 
dev
);

3340 
	`¦si_£t_·ck‘_f‹rs
(
sdev
, 
dev
);

3342 ià(
ndev_vif
->
add»ss
)

3343 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

3344 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3350 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
)

3351 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_GROUP_FORMED_CLI
);

3354 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3355 ià(!
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 && 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
aùiv©ed
 &&‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_CLIENT
) {

3357 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
aùiv©ed
 &&‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_CLIENT
) {

3359 cÚ¡ 
u8
 *
ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
assoc_›
, 
assoc_›_Ën
);

3360 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

3361 
u8
 
chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

3362 
u32
 
chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
ssid
, 
chªÃls
);

3363 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

3364 
u32
 
m”ge_chª_couÁ
 = 0;

3366 
	`mem£t
(
m”ged_chªÃls
, 0, (merged_channels));

3368 
ÃtwÜk_m­
 = 
	`¦si_rßm_chªÃl_ÿche_g‘
(
dev
, 
ssid
);

3369 ià(
ÃtwÜk_m­
) {

3370 
ndev_vif
->
¡a
.
chªÃls_24_ghz
 = 
ÃtwÜk_m­
->channels_24_ghz;

3371 
ndev_vif
->
¡a
.
chªÃls_5_ghz
 = 
ÃtwÜk_m­
->channels_5_ghz;

3374 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3375 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
chªÃls
, 
chªÃls_couÁ
,

3376 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
,

3377 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
,

3378 
m”ged_chªÃls
);

3379 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3380 ià(
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
) != 0)

3381 
	`SLSI_NET_ERR
(
dev
, "MLME-SET-CACHED-CHANNELS.req failed\n");

3387 ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_SUCCESS
 && 
³”
) {

3388 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
Œue
);

3389 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
NULL
, 0);

3391 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
NULL
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, NULL, 0);

3395 
ex™_w™h_lock
:

3396 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3397 
	`kä“_skb
(
skb
);

3398 
	}
}

3400 
	$¦si_rx_discÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3402 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3403 
u16
 
»asÚ
;

3404 
u8
 *
di§ssoc_r¥_›
 = 
NULL
;

3405 
u32
 
di§ssoc_r¥_›_Ën
 = 0;

3407 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

3408 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

3409 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3410 ià(!
ndev_vif
->
aùiv©ed
) {

3411 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3412 
ex™
;

3414 
»asÚ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
);

3415 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_disconnected_ind(vif:%d,„eason:%d, MAC:%pM)\n",

3416 
	`çpi_g‘_vif
(
skb
),

3417 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
),

3418 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
));

3419 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

3420 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_DISCONNECTED_IND
);

3422 #iâdeà
SLSI_TEST_DEV


3423 #ià
	`IS_ENABLED
(
CONFIG_SCSC_INDEPENDENT_SUBSYSTEM
)

3424 
	`SLSI_NET_INFO
(
dev
, "SCSC_LOG_COLLECTION‚otƒnabled. Sable will‚ot beriggered\n");

3426 
	`mx140_log_dump
();

3430 ià(
»asÚ
 <= 0xFF) {

3431 
	`SLSI_INFO
(
sdev
, "Reûived DEAUTH,„—sÚ = %d\n", 
»asÚ
);

3432 } ià(
»asÚ
 >= 0x8100 &&„eason <= 0x81FF) {

3433 
»asÚ
 =„eason & 0x00FF;

3434 
	`SLSI_INFO
(
sdev
, "Reûived DEAUTH,„—sÚ = %d\n", 
»asÚ
);

3435 } ià(
»asÚ
 >= 0x8200 &&„eason <= 0x82FF) {

3436 
»asÚ
 =„eason & 0x00FF;

3437 
	`SLSI_INFO
(
sdev
, "Reûived DISASSOC,„—sÚ = %d\n", 
»asÚ
);

3439 
	`SLSI_INFO
(
sdev
, "Reûived DEAUTH,„—sÚ = LoÿÈDiscÚÃù <%d>\n", 
»asÚ
);

3442 ià(
	`çpi_g‘_d©®’
(
skb
)) {

3443 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

3445 ià(
	`›“80211_is_d—uth
(
mgmt
->
äame_cÚŒŞ
)) {

3446 
di§ssoc_r¥_›
 = (*)&
mgmt
->
u
.
d—uth
.
»asÚ_code
 + 2;

3447 
di§ssoc_r¥_›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
) -

3448 (
u32
)(
di§ssoc_r¥_›
 - (
u8
 *)
	`çpi_g‘_d©a
(
skb
));

3449 } ià(
	`›“80211_is_di§ssoc
(
mgmt
->
äame_cÚŒŞ
)) {

3450 
di§ssoc_r¥_›
 = (*)&
mgmt
->
u
.
di§ssoc
.
»asÚ_code
 + 2;

3451 
di§ssoc_r¥_›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
) -

3452 (
u32
)(
di§ssoc_r¥_›
 - (
u8
 *)
	`çpi_g‘_d©a
(
skb
));

3454 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Not‡ disassoc/deauth…acket\n");

3458 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

3459 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
) ==

3460 
FAPI_REASONCODE_HOTSPOT_MAX_CLIENT_REACHED
) {

3461 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
,

3463 
	`cfg80211_cÚn_çed
(
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
),

3464 
NL80211_CONN_FAIL_MAX_CLIENTS
, 
GFP_KERNEL
);

3465 
ex™
;

3469 
	`¦si_hªdË_discÚÃù
(
sdev
,

3470 
dev
,

3471 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
),

3472 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
),

3473 
di§ssoc_r¥_›
,

3474 
di§ssoc_r¥_›_Ën
);

3476 
ex™
:

3477 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3478 
	`kä“_skb
(
skb
);

3479 
	}
}

3482 
	$¦si_rx_p2p_deviû_discov”ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3484 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3485 
mgmt_Ën
;

3487 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

3489 ià(
ndev_vif
->
chª
) {

3490 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "F»q = %d\n", 
ndev_vif
->
chª
->
ûÁ”_äeq
);

3492 
	`SLSI_NET_ERR
(
dev
, "ndev_vif->chan is NULL\n");

3497 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

3498 ià(
mgmt_Ën
) {

3499 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

3501 ià(
	`›“80211_is_mgmt
(
mgmt
->
äame_cÚŒŞ
)) {

3502 ià(
	`›“80211_is_´obe_»q
(
mgmt
->
äame_cÚŒŞ
)) {

3503 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Received Probe Request\n");

3504 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
,‚dev_vif->
chª
->
ûÁ”_äeq
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
mgmt_Ën
, 
GFP_ATOMIC
);

3506 
	`SLSI_NET_ERR
(
dev
, "Ignore Indication - Not Probe Request frame\n");

3509 
	`SLSI_NET_ERR
(
dev
, "Ignore Indication - Not Management frame\n");

3512 
	}
}

3514 
	$¦si_rx_´oûdu»_¡¬‹d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3516 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3517 
¦si_³”
 *
³”
 = 
NULL
;

3519 
	`¹Æ_lock
();

3520 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3521 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_procedure_started_ind(vif:%d,ype:%d, flow_id:%d)\n",

3522 
	`çpi_g‘_vif
(
skb
),

3523 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
),

3524 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
æow_id
));

3525 ià(!
ndev_vif
->
aùiv©ed
) {

3526 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3527 
ex™_w™h_lock
;

3529 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
è!ğ
FAPI_PROCEDURETYPE_DEVICE_DISCOVERED
)

3530 
	`SLSI_INFO
(
sdev
, "Send Association Request\n");

3532 ià(!
ndev_vif
->
aùiv©ed
) {

3533 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3534 
ex™_w™h_lock
;

3537 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
)) {

3538 
FAPI_PROCEDURETYPE_CONNECTION_STARTED
:

3539 
ndev_vif
->
vif_ty³
) {

3540 
FAPI_VIFTYPE_AP
:

3542 
u16
 
æow_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.flow_id);

3543 
u16
 
aid
 = (
æow_id
 >> 8);

3546 ià((
ndev_vif
->
³”_¡a_»cÜds
 + 1è> 
SLSI_AP_PEER_CONNECTIONS_MAX
) {

3547 
	`SLSI_NET_ERR
(
dev
, "MAX StiÚ†im™„—ched. IgnÜšd fÜ‡id:%d\n", 
aid
);

3548 
ex™_w™h_lock
;

3551 ià(
aid
 < 
SLSI_PEER_INDEX_MIN
 ||‡id > 
SLSI_PEER_INDEX_MAX
) {

3552 
	`SLSI_NET_ERR
(
dev
, "Reûived incÜ»ù‡id: %d\n", 
aid
);

3553 
ex™_w™h_lock
;

3556 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, (
	`çpi_g‘_mgmt
(
skb
))->
§
, 
aid
);

3557 ià(!
³”
) {

3558 
	`SLSI_NET_ERR
(
dev
, "Peer NOT Created\n");

3559 
ex™_w™h_lock
;

3561 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
skb
);

3563 
skb
 = 
NULL
;

3564 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTING
;

3566 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
 &&

3567 
³”
->
assoc_›
 &&

3568 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
³”
->
assoc_›
->
d©a
,…“r->assoc_›->
Ën
)) {

3569 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "WPS IE is…resent. Setting…eer->is_wpso TRUE\n");

3570 
³”
->
is_wps
 = 
Œue
;

3576 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_mlme
, 
	`m£cs_to_jiff›s
(
SLSI_WAKELOCK_TIME_MSEC_EAPOL
));

3579 
FAPI_VIFTYPE_STATION
:

3581 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3582 ià(
	`WARN_ON
(!
³”
)) {

3583 
	`SLSI_NET_ERR
(
dev
, "Peer NOT FOUND\n");

3584 
ex™_w™h_lock
;

3587 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
skb
);

3589 
skb
 = 
NULL
;

3593 
	`SLSI_NET_ERR
(
dev
, "Incorrect vifype for…roceduretype_connection_started\n");

3597 
FAPI_PROCEDURETYPE_DEVICE_DISCOVERED
:

3599 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&&‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
) {

3600 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "PROCEDURETYPE_DEVICE_DISCOVERED„ecd in‚on P2P„ole\n");

3601 
ex™_w™h_lock
;

3607 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
 || 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
)

3608 
	`¦si_rx_p2p_deviû_discov”ed_šd
(
sdev
, 
dev
, 
skb
);

3610 
FAPI_PROCEDURETYPE_ROAMING_STARTED
:

3612 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Rßmšg Proûdu» S¹šg w™h %pM\n", (
	`çpi_g‘_mgmt
(
skb
))->
bssid
);

3613 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

3614 
ex™_w™h_lock
;

3615 ià(
	`WARN_ON
(!
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
] || !ndev_vif->³”_¡a_»cÜd[SLSI_STA_PEER_QUEUESET]->
v®id
))

3616 
ex™_w™h_lock
;

3617 
	`kä“_skb
(
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
);

3618 
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
 = 
skb
;

3620 
skb
 = 
NULL
;

3624 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "UnknowÀProûdu»: %d\n", 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
));

3625 
ex™_w™h_lock
;

3628 
ex™_w™h_lock
:

3629 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3630 
	`¹Æ_uÆock
();

3631 
	`kä“_skb
(
skb
);

3632 
	}
}

3634 
	$¦si_rx_äame_ŒªsmissiÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3636 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3637 
¦si_³”
 *
³”
;

3638 
u16
 
ho¡_g
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_äame_ŒªsmissiÚ_šd
.host_tag);

3639 
u16
 
tx_¡©us
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_äame_ŒªsmissiÚ_šd
.
ŒªsmissiÚ_¡©us
);

3640 
boŞ
 
ack
 = 
Œue
;

3642 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3644 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

3646 
	`çpi_g‘_vif
(
skb
), 
ho¡_g
, 
tx_¡©us
);

3647 ià(!
ndev_vif
->
aùiv©ed
) {

3648 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3649 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3650 
	`kä“_skb
(
skb
);

3654 #ià
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è|| defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

3655 #ià
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
)

3656 
	`¦si_tx_mlme_šd
(
sdev
, 
dev
, 
skb
);

3658 ià(
ho¡_g
 & 
SLSI_HOST_TAG_ARP_MASK
) {

3659 ià(
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
) > 0)

3660 
	`©omic_dec
(&
sdev
->
¬p_tx_couÁ
);

3662 
	`SLSI_INFO
(
sdev
, "Unableo decrement sdev‡rp_tx_count\n");

3663 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
) > 0)

3664 
	`©omic_dec
(&
ndev_vif
->
¬p_tx_couÁ
);

3666 
	`SLSI_INFO
(
sdev
, "Unableo decrement‚dev‡rp_tx_count\n");

3668 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
) &&

3669 
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è< (sdev->
fw_max_¬p_couÁ
 - 
SLSI_ARP_UNPAUSE_THRESHOLD
))

3670 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

3675 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
 == host_tag) {

3676 
Ãtdev_vif
 *
ndev_vif_to_cfg
 = 
ndev_vif
;

3681 ià(
tx_¡©us
 !ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
) {

3682 
ack
 = 
çl£
;

3683 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

3684 ià(
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_VIF_TX
)

3685 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

3687 ià(
sdev
->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
)

3688 
	`¦si_ş—r_offchªÃl_d©a
(
sdev
, 
çl£
);

3689 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

3690 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3691 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3696 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&&‚dev_vif->
mgmt_tx_d©a
.
exp_äame
 =ğ
SLSI_PA_INVALID
) {

3697 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
))

3698 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

3700 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

3701 } ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
)) {

3702 cÚ¡ 
›“80211_mgmt
 *
mgmt
 = (cÚ¡ ›“80211_mgmˆ*)
ndev_vif
->
mgmt_tx_d©a
.
buf
;

3707 ià((
mgmt
è&& (
	`memcmp
(mgmt->
§
, 
dev
->
dev_addr
, 
ETH_ALEN
) != 0)) {

3708 
Ãt_deviû
 *
ndev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

3710 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

3714 
ndev_vif_to_cfg
 = 
	`Ãtdev_´iv
(
ndev
);

3715 ià(!
ndev_vif_to_cfg
) {

3716 
	`SLSI_NET_ERR
(
dev
, "Getting P2P Index‚etdev failed\n");

3717 
ndev_vif_to_cfg
 = 
ndev_vif
;

3721 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3722 ià(!
sdev
->
deviû_cÚfig
.
wes_mode
) {

3724 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif_to_cfg
->
wdev
, 
ndev_vif
->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
ack
, 
GFP_KERNEL
);

3725 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3728 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

3731 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
 ||x_¡©u =ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
) {

3732 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3733 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3734 
i
 = 0;

3736 
i
 = 0; i < 
SLSI_MAX_ARP_SEND_FRAME
; i++) {

3737 ià(
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
] =ğ
ho¡_g
) {

3738 
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
] = 0;

3739 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_rx_couÁ_by_low”_mac
++;

3740 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
)

3741 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_tx_sucûss
++;

3747 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

3748 
ndev_vif
->
¡a
.
m4_ho¡_g
 =ğ
ho¡_g
) {

3749 
ndev_vif
->
¡a
.
»¥_id
) {

3750 
MLME_ROAMED_RES
:

3751 
	`¦si_mlme_rßmed_»¥
(
sdev
, 
dev
);

3752 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3753 ià(
	`WARN_ON
(!
³”
))

3755 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3756 
	`ÿc_upd©e_rßm_Œaffic_·¿ms
(
sdev
, 
dev
);

3758 
MLME_CONNECT_RES
:

3759 
	`¦si_mlme_cÚÃù_»¥
(
sdev
, 
dev
);

3760 ià(
ndev_vif
->
add»ss
)

3761 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

3762 
	`¦si_£t_aş
(
sdev
, 
dev
);

3763 
	`¦si_£t_·ck‘_f‹rs
(
sdev
, 
dev
);

3764 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3765 ià(
	`WARN_ON
(!
³”
))

3767 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3769 
MLME_REASSOCIATE_RES
:

3770 
	`¦si_mlme_»assocŸ‹_»¥
(
sdev
, 
dev
);

3775 
ndev_vif
->
¡a
.
m4_ho¡_g
 = 0;

3776 
ndev_vif
->
¡a
.
»¥_id
 = 0;

3778 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
) {

3779 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&

3780 
ndev_vif
->
¡a
.
—p_ho¡g
 =ğ
ho¡_g
) {

3781 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

3782 
	`SLSI_NET_WARN
(
dev
, "Disconnect‡s EAP frameransmission failed\n");

3783 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
çl£
);

3785 
	`SLSI_NET_WARN
(
dev
, "EAP frameransmission failed, sta_bss‚ot‡vailable\n");

3788 
ndev_vif
->
¡©s
.
tx_”rÜs
++;

3791 
ndev_vif
->
¡©s
.
tx_”rÜs
++;

3793 
	`¦si_—pŞ_—p_hªdË_tx_¡©us
(
sdev
, 
ndev_vif
, 
ho¡_g
, 
tx_¡©us
);

3794 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3795 
	`kä“_skb
(
skb
);

3796 
	}
}

3798 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


3799 
	$by·ss_backlog
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3801 
·ck‘_ty³
 *
±y³
, *
±_´ev
;

3802 
li¡_h—d
 
±y³_®l
;

3803 
li¡_h—d
 
±y³_ba£
[
PTYPE_HASH_SIZE
];

3804 
sk_buff
 *
tskb
;

3806 
	`skb_»£t_ÃtwÜk_h—d”
(
skb
);

3807 ià(!
	`skb_Œª¥Üt_h—d”_was_£t
(
skb
))

3808 
	`skb_»£t_Œª¥Üt_h—d”
(
skb
);

3809 
	`skb_»£t_mac_Ën
(
skb
);

3811 
±_´ev
 = 
NULL
;

3812 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
±y³_®l
, 
li¡
) {

3813 ià(
±_´ev
) {

3814 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3815 ià(
tskb
)

3816 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3818 
±_´ev
 = 
±y³
;

3820 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
dev
->
±y³_®l
, 
li¡
) {

3821 ià(
±_´ev
) {

3822 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3823 ià(
tskb
)

3824 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3826 
±_´ev
 = 
±y³
;

3828 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
±y³_ba£
[
	`Áohs
(
skb
->
´ÙocŞ
è& 
PTYPE_HASH_MASK
], 
li¡
) {

3829 ià(
±y³
->
ty³
 !ğ
skb
->
´ÙocŞ
)

3831 ià(
±_´ev
) {

3832 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3833 ià(
tskb
)

3834 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3836 
±_´ev
 = 
±y³
;

3838 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
dev
->
±y³_¥ecific
, 
li¡
) {

3839 ià(
±y³
->
ty³
 !ğ
skb
->
´ÙocŞ
)

3841 ià(
±_´ev
) {

3842 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3843 ià(
tskb
)

3844 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3846 
±_´ev
 = 
±y³
;

3848 ià(
±_´ev
)

3849 
±_´ev
->
	`func
(
skb
, 
dev
,…t_prev, dev);

3851 
	`kä“_skb
(
skb
);

3852 
	}
}

3854 
boŞ
 
	$¦si_rx_»ûived_äame_loggšg
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, *
log_¡r_bufãr
, 
bufãr_size
)

3856 
u16
 
´ÙocŞ
 = 0;

3857 
u8
 *
—pŞ
 = 
NULL
;

3858 
u8
 *
—p
 = 
NULL
;

3859 
u16
 
—p_Ëngth
 = 0;

3860 
u32
 
dhı_mes§ge_ty³
 = 
SLSI_DHCP_MESSAGE_TYPE_INVALID
;

3861 
boŞ
 
is_—pŞ_dhı
 = 
çl£
;

3862 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3863 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3865 ià((
skb
->
Ën
 - (
‘hhdr
)) >= 99)

3866 
—pŞ
 = 
skb
->
d©a
 + (
‘hhdr
);

3868 ià((
skb
->
Ën
 - (
‘hhdr
)) >= 8) {

3869 
—p_Ëngth
 = (
skb
->
Ën
 - (
‘hhdr
)) - 4;

3870 
—p
 = 
skb
->
d©a
 + (
‘hhdr
);

3872 ià(
skb
->
Ën
 >ğ285 && 
	`¦si_is_dhı_·ck‘
(skb->
d©a
è!ğ
SLSI_TX_IS_NOT_DHCP
)

3873 
dhı_mes§ge_ty³
 = 
skb
->
d©a
[284];

3875 
skb
->
´ÙocŞ
 = 
	`‘h_ty³_Œªs
(skb, 
dev
);

3876 
´ÙocŞ
 = 
	`Áohs
(
skb
->protocol);

3878 ià(
´ÙocŞ
 =ğ
ETH_P_PAE
) {

3879 ià(
—pŞ
 &&ƒ­Ş[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] =ğ
SLSI_IEEE8021X_TYPE_EAPOL_KEY
 &&

3880 (
—pŞ
[
SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
] & 
SLSI_EAPOL_KEY_INFO_KEY_TYPE_BIT_IN_LOWER_BYTE
)) {

3881 ià((
—pŞ
[
SLSI_EAPOL_TYPE_POS
] =ğ
SLSI_EAPOL_TYPE_RSN_KEY
 ||

3882 
—pŞ
[
SLSI_EAPOL_TYPE_POS
] =ğ
SLSI_EAPOL_TYPE_WPA_KEY
) &&

3883 (
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] &

3884 
SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
) &&

3885 
—pŞ
[
SLSI_EAPOL_KEY_DATA_LENGTH_HIGHER_BYTE_POS
] == 0 &&

3886 
—pŞ
[
SLSI_EAPOL_KEY_DATA_LENGTH_LOWER_BYTE_POS
] == 0) {

3887 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M4");

3888 } ià(!(
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] &

3889 
SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
)) {

3890 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M1");

3891 
	`¦si_cÚn_log2us_—pŞ_±k
(
sdev
, 
dev
, 1);

3892 
is_—pŞ_dhı
 = 
Œue
;

3893 } ià((
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] &

3894 
SLSI_EAPOL_KEY_INFO_SECURE_BIT_IN_HIGHER_BYTE
)) {

3895 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M3");

3896 
	`¦si_cÚn_log2us_—pŞ_±k
(
sdev
, 
dev
, 3);

3897 
is_—pŞ_dhı
 = 
Œue
;

3899 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M2");

3901 } ià(
—pŞ
 &&ƒ­Ş[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] =ğ
SLSI_IEEE8021X_TYPE_EAPOL_KEY
 &&

3902 !(
—pŞ
[
SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
] &

3903 
SLSI_EAPOL_KEY_INFO_KEY_TYPE_BIT_IN_LOWER_BYTE
)) {

3904 ià((
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] &

3905 
SLSI_EAPOL_KEY_INFO_SECURE_BIT_IN_HIGHER_BYTE
) &&

3906 (
—pŞ
[
SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
] &

3907 
SLSI_EAPOL_KEY_INFO_ACK_BIT_IN_LOWER_BYTE
)) {

3908 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "GTK-H/S, M1");

3909 
	`¦si_cÚn_log2us_—pŞ_gtk
(
sdev
, 
dev
, 1);

3910 
is_—pŞ_dhı
 = 
Œue
;

3912 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "GTK-H/S, M2");

3914 } ià(
—p
 &&ƒ­[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] =ğ
SLSI_IEEE8021X_TYPE_EAP_PACKET
) {

3915 
—p
[
SLSI_EAP_CODE_POS
]) {

3916 
SLSI_EAP_PACKET_REQUEST
:

3917 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Reque¡ (%d)", 
—p_Ëngth
);

3918 
	`¦si_cÚn_log2us_—p_w™h_Ën
(
sdev
, 
dev
, 
—p
, 
—p_Ëngth
);

3920 
SLSI_EAP_PACKET_RESPONSE
:

3921 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Re¥Ú£ (%d)", 
—p_Ëngth
);

3923 
SLSI_EAP_PACKET_SUCCESS
:

3924 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Sucûs (%d)", 
—p_Ëngth
);

3925 
	`¦si_cÚn_log2us_—p
(
sdev
, 
dev
, 
—p
);

3927 
SLSI_EAP_PACKET_FAILURE
:

3928 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Fau» (%d)", 
—p_Ëngth
);

3929 
	`¦si_cÚn_log2us_—p
(
sdev
, 
dev
, 
—p
);

3933 } ià(
´ÙocŞ
 =ğ
ETH_P_IP
) {

3934 
dhı_mes§ge_ty³
) {

3935 
SLSI_DHCP_MESSAGE_TYPE_DISCOVER
:

3936 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [DISCOVER]");

3938 
SLSI_DHCP_MESSAGE_TYPE_OFFER
:

3939 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [OFFER]");

3940 
	`¦si_cÚn_log2us_dhı
(
sdev
, 
dev
, "OFFER");

3941 
is_—pŞ_dhı
 = 
Œue
;

3943 
SLSI_DHCP_MESSAGE_TYPE_REQUEST
:

3944 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [REQUEST]");

3946 
SLSI_DHCP_MESSAGE_TYPE_DECLINE
:

3947 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [DECLINE]");

3949 
SLSI_DHCP_MESSAGE_TYPE_ACK
:

3950 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [ACK]");

3951 
	`¦si_cÚn_log2us_dhı
(
sdev
, 
dev
, "ACK");

3952 
is_—pŞ_dhı
 = 
Œue
;

3954 
SLSI_DHCP_MESSAGE_TYPE_NAK
:

3955 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [NAK]");

3956 
	`¦si_cÚn_log2us_dhı
(
sdev
, 
dev
, "NAK");

3958 
SLSI_DHCP_MESSAGE_TYPE_RELEASE
:

3959 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [RELEASE]");

3961 
SLSI_DHCP_MESSAGE_TYPE_INFORM
:

3962 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [INFORM]");

3964 
SLSI_DHCP_MESSAGE_TYPE_FORCERENEW
:

3965 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [FORCERENEW]");

3968 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [INVALID]");

3972  
is_—pŞ_dhı
;

3973 
	}
}

3975 
	$¦si_rx_»ûived_äame_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3977 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3978 
u16
 
d©a_un™_desütÜ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.data_unit_descriptor);

3979 
u16
 
äequ’cy
 = 
	`SLSI_FREQ_FW_TO_HOST
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
chªÃl_äequ’cy
));

3980 
subty³
 = 
SLSI_PA_INVALID
;

3981 
log_¡r_bufãr
[128] = {0};

3982 
sk_buff
 *
log_skb
 = 
NULL
;

3983 
boŞ
 
is_drİ³d
 = 
çl£
;

3984 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


3985 
boŞ
 
is_—pŞ_dhı
 = 
çl£
;

3988 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_received_frame_ind(vif:%d, data descriptor:%d, freq:%d)\n",

3989 
	`çpi_g‘_vif
(
skb
),

3990 
d©a_un™_desütÜ
,

3991 
äequ’cy
);

3993 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3994 ià(
d©a_un™_desütÜ
 =ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
) {

3995 
›“80211_mgmt
 *
mgmt
;

3996 
mgmt_Ën
;

3998 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

3999 ià(
mgmt_Ën
 < 
	`off£tof
(
›“80211_mgmt
, 
äame_cÚŒŞ
) + 2) {

4000 
	`SLSI_NET_ERR
(
dev
, "invalid fapi mgmt data\n");

4001 
ex™
;

4003 
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

4004 ià(
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
)) {

4005 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
, 
äequ’cy
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
mgmt_Ën
, 
GFP_ATOMIC
);

4007 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
)

4008 ià(
mgmt
->
u
.
auth
.
auth_Œª§ùiÚ
 =ğ
ndev_vif
->
¡a
.
§e_auth_ty³
)

4009 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

4011 
	`SLSI_INFO
(
sdev
, "Received Auth Frame\n");

4012 
ex™
;

4014 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

4015 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

4016 ià(!
ndev_vif
->
is_ws_ruÂšg
) {

4017 
	`SLSI_NET_WARN
(
dev
, "Unwanted beacon is forwarded");

4018 
	`¦si_mlme_£t_fÜw¬d_b—cÚ
(
sdev
, 
dev
, 
çl£
);

4019 } ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

4020 
	`¦si_hªdË_ws_b—cÚ
(
sdev
, 
dev
, 
skb
, 
mgmt
, 
mgmt_Ën
);

4023 
ex™
;

4026 ià(!(
	`›“80211_is_aùiÚ
(
mgmt
->
äame_cÚŒŞ
))) {

4027 
	`SLSI_NET_ERR
(
dev
, "Expected‡n Action Frame\n");

4028 
ex™
;

4031 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

4032 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

4033 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


4034 ià(
	`¦si_is_wes_aùiÚ_äame
(
mgmt
)) {

4035 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Received NCHO WES VS‡ction frame\n");

4036 ià(!
sdev
->
deviû_cÚfig
.
wes_mode
)

4037 
ex™
;

4040 ià(
mgmt
->
u
.
aùiÚ
.
ÿ‹gÜy
 =ğ
WLAN_CATEGORY_WMM
) {

4041 
	`ÿc_rx_wmm_aùiÚ
(
sdev
, 
dev
, 
mgmt
, 
mgmt_Ën
);

4043 
	`¦si_wÏn_dump_public_aùiÚ_subty³
(
sdev
, 
mgmt
, 
çl£
);

4044 ià(
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_VIF_TX
)

4045 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

4046 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
 && 
subty³
 ==‚dev_vif->mgmt_tx_data.exp_frame) {

4047 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

4048 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

4051 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


4055 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Reûived‡ùiÚ f¿m(%s)\n", 
	`¦si_·_subty³_‹xt
(
subty³
));

4057 ià(
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
è&&‚dev_vif->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
 &&

4058 
subty³
 =ğ
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
) {

4059 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
)

4060 
	`SLSI_NET_WARN
(
dev
, "Driver in incorrect P2P state (P2P_LISTENING)");

4062 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

4073 ià(
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_CFM
 || subty³ =ğ
SLSI_P2P_PA_PROV_DISC_RSP
) {

4074 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

4075 ià(!
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)) {

4076 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

4077 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

4078 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
unsync
.
un£t_chªÃl_expœy_wÜk
,

4079 
	`m£cs_to_jiff›s
(
SLSI_P2P_DELAY_UNSET_CHANNEL_AFTER_P2P_PROCEDURE
));

4081 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

4087 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

4090 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

4091 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)) {

4092 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

4094 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
d–_vif_wÜk
,

4095 
	`m£cs_to_jiff›s
(
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
));

4096 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

4105 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
) {

4106 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
Œue
, 
GFP_KERNEL
);

4107 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

4109 } ià((
sdev
->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
è&& (sdev->p2p_group_exp_äam=ğ
subty³
)) {

4110 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Ex³ùed‡ùiÚ f¿m(%sè»ûived oÀGrou°VIF\n", 
	`¦si_·_subty³_‹xt
(
subty³
));

4111 
	`¦si_ş—r_offchªÃl_d©a
(
sdev
,

4112 (!
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
,

4113 
ndev_vif
)è? 
Œue
 : 
çl£
);

4121 } ià(
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
è&& (ndev_vif->
mgmt_tx_d©a
.
exp_äame
 =ğ
SLSI_PA_INVALID
è&& (
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_REQ
)) {

4122 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
) {

4123 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
))

4124 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

4126 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

4127 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
Œue
, 
GFP_KERNEL
);

4128 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

4133 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
, 
äequ’cy
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
mgmt_Ën
, 
GFP_ATOMIC
);

4134 } ià(
d©a_un™_desütÜ
 =ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
) {

4135 
¦si_³”
 *
³”
 = 
NULL
;

4136 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
	`çpi_g‘_d©a
(
skb
);

4139 ià(
	`uÆik–y
(
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
)) {

4140 
skb
->
m¬k
 = 
SLSI_WAKEUP_PKT_MARK
;

4141 
	`¦si_rx_upd©e_wake_¡©s
(
sdev
, 
ehdr
, 
skb
->
Ën
 - 
	`çpi_g‘_sigËn
(skb));

4144 ià(
	`çpi_g‘_d©®’
(
skb
è< (
‘hhdr
)) {

4145 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "invalid fapi data†ength.\n");

4146 
ex™
;

4149 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
ehdr
->
h_sourû
);

4150 ià(!
³”
) {

4151 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "drop…acket‡s No…eer found\n");

4152 
ex™
;

4156 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && (
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
))) {

4157 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "multicast/broadcast…acket„eceived in STA mode skip BA\n");

4159 
ba_check_dÚe
;

4169 ià((
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
) >= 0x0e) &&

4170 (
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
) >= 0x06) &&

4171 (
FAPI_CONTROL_SAP_ENG_VERSION
 >= 0x0d)) {

4172 
u16
 
£q_num
;

4173 
u16
 
´iÜ™y
;

4175 
£q_num
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
£qu’û_numb”
);

4176 
´iÜ™y
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
u£r_´iÜ™y
);

4178 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "mlme_received_frame_ind(vif:%d, dest:%pM, src:%pM,…riority:%d, s:%d)\n",

4179 
	`çpi_g‘_vif
(
skb
),

4180 
ehdr
->
h_de¡
,

4181 
ehdr
->
h_sourû
,

4182 
´iÜ™y
,

4183 
£q_num
);

4185 ià(
	`¦si_ba_check
(
³”
, 
´iÜ™y
)) {

4186 
	`¦si_ba_upd©e_wšdow
(
dev
, 
³”
->
ba_£ssiÚ_rx
[
´iÜ™y
], ((
£q_num
 + 1) & 0xFFF));

4190 
ba_check_dÚe
:

4192 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

4194 
skb
->
dev
 = dev;

4195 
skb
->
_summed
 = 
CHECKSUM_NONE
;

4197 
ndev_vif
->
¡©s
.
rx_·ck‘s
++;

4198 
ndev_vif
->
¡©s
.
rx_by‹s
 +ğ
skb
->
Ën
;

4199 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 10, 0))

4200 
dev
->
Ï¡_rx
 = 
jiff›s
;

4203 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


4204 
is_—pŞ_dhı
 = 
	`¦si_rx_»ûived_äame_loggšg
(
dev
, 
skb
, 
log_¡r_bufãr
, (log_str_buffer));

4206 
	`¦si_rx_»ûived_äame_loggšg
(
dev
, 
skb
, 
log_¡r_bufãr
, (log_str_buffer));

4208 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4209 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "·s %u by‹ u°ÕrÙo:%d)\n", 
skb
->
Ën
, 
	`Áohs
(skb->
´ÙocŞ
));

4210 
	`¦si_skb_cb_š™
(
skb
);

4211 
log_skb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

4213 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


4214 ià(
is_—pŞ_dhı
) {

4218 
	`loÿl_bh_di§bË
();

4219 
	`by·ss_backlog
(
sdev
, 
dev
, 
skb
);

4220 
	`loÿl_bh_’abË
();

4224 
is_drİ³d
 = (
NET_RX_DROP
 =ğ
	`Ãtif_rx_ni
(
skb
));

4225 ià(
log_¡r_bufãr
[0])

4226 
	`SLSI_INFO
(
sdev
, "% %s\n", (
is_drİ³d
 ? "Drİ³d" : "Reûived"), 
log_¡r_bufãr
);

4227 ià(
log_skb
) {

4228 ià(
is_drİ³d
)

4229 
	`SLSI_INFO_HEX_NODEV
(
log_skb
->
d©a
,

4230 (
log_skb
->
Ën
 < 128 ?†og_skb->len : 128), "HEX Dump:\n");

4231 
	`kä“_skb
(
log_skb
);

4233 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_mlme
, 
	`m£cs_to_jiff›s
(
SLSI_WAKELOCK_TIME_MSEC_EAPOL
));

4236 
ex™
:

4237 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4238 
	`kä“_skb
(
skb
);

4239 
	}
}

4241 
	$¦si_rx_mic_çu»_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4243 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4244 
u8
 *
mac_addr
;

4245 
u16
 
key_ty³
, 
key_id
;

4246 
Æ80211_key_ty³
 
Æ_key_ty³
;

4248 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

4250 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4251 ià(!
ndev_vif
->
aùiv©ed
) {

4252 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

4253 
ex™
;

4256 
mac_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
);

4257 
key_ty³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_mic_çu»_šd
.key_type);

4258 
key_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_mic_çu»_šd
.key_id);

4260 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_mic_failure_ind(vif:%d, MAC:%pM, key_type:%d, key_id:%d)\n",

4261 
	`çpi_g‘_vif
(
skb
), 
mac_addr
, 
key_ty³
, 
key_id
);

4263 ià(
	`WARN_ON
(
key_ty³
 !ğ
FAPI_KEYTYPE_GROUP
 && key_ty³ !ğ
FAPI_KEYTYPE_PAIRWISE
))

4264 
ex™
;

4266 
Æ_key_ty³
 = (
key_ty³
 =ğ
FAPI_KEYTYPE_GROUP
è? 
NL80211_KEYTYPE_GROUP
 : 
NL80211_KEYTYPE_PAIRWISE
;

4268 
	`cfg80211_mich«l_mic_çu»
(
dev
, 
mac_addr
, 
Æ_key_ty³
, 
key_id
, 
NULL
, 
GFP_KERNEL
);

4270 
ex™
:

4271 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4272 
	`kä“_skb
(
skb
);

4273 
	}
}

4281 
	$¦si_rx_li¡’_’d_šd
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4283 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4285 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4287 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Inform completion of P2P Listen Offloading\n");

4288 ià(!
ndev_vif
->
aùiv©ed
) {

4289 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

4290 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4291 
	`kä“_skb
(
skb
);

4295 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
, 0xffff,‚dev_vif->
chª
, 
GFP_KERNEL
);

4297 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

4299 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

4301 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

4303 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4304 
	`kä“_skb
(
skb
);

4305 
	}
}

4307 
	$¦si_rx_wa™_šd_m©ch
(
u16
 
»cv_id
, u16 
wa™_id
)

4309 ià(
»cv_id
 =ğ
wa™_id
)

4312 
	}
}

4314 
	$¦si_rx_blockšg_sigÇls
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

4316 
u16
 
pid
, 
id
;

4317 
¦si_sig_£nd
 *
sig_wa™
;

4318 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

4320 
sig_wa™
 = &
sdev
->sig_wait;

4321 
id
 = 
	`çpi_g‘_sigid
(
skb
);

4322 
pid
 = 
	`çpi_g‘_u16
(
skb
, 
»ûiv”_pid
);

4325 ià(
	`çpi_is_cfm
(
skb
)) {

4326 
Ãt_deviû
 *
dev
;

4327 
Ãtdev_vif
 *
ndev_vif
;

4329 
	`rcu_»ad_lock
();

4330 ià(
vif
 =ğ
SLSI_NET_INDEX_DETECT
 &&

4331 (
id
 =ğ
MLME_ADD_VIF_CFM
 ||

4332 
id
 =ğ
MLME_START_DETECT_CFM
 ||

4333 
id
 =ğ
MLME_DEL_VIF_CFM
))

4334 
vif
 = 1;

4335 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

4336 ià(
dev
) {

4337 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4338 
sig_wa™
 = &
ndev_vif
->sig_wait;

4340 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4341 ià(
id
 =ğ
sig_wa™
->
cfm_id
 && 
pid
 =ğsig_wa™->
´oûss_id
) {

4342 ià(
	`WARN_ON
(
sig_wa™
->
cfm
))

4343 
	`kä“_skb
(
sig_wa™
->
cfm
);

4344 
sig_wa™
->
cfm
 = 
skb
;

4345 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4346 
	`com¶‘e
(&
sig_wa™
->
com¶‘iÚ
);

4347 
	`rcu_»ad_uÆock
();

4357 ià(
id
 !ğ
MLME_SEND_FRAME_CFM
)

4358 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "UÃx³ùed cfm(0x%.4x,…id:0x%.4x, vif:%d)\n", 
id
, 
pid
, 
vif
);

4359 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4360 
	`rcu_»ad_uÆock
();

4361  -
EINVAL
;

4364 ià(
	`çpi_is_šd
(
skb
)) {

4365 
Ãt_deviû
 *
dev
;

4366 
Ãtdev_vif
 *
ndev_vif
;

4368 
	`rcu_»ad_lock
();

4369 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

4370 ià(
dev
) {

4371 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4372 
sig_wa™
 = &
ndev_vif
->sig_wait;

4374 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4375 ià(
	`¦si_rx_wa™_šd_m©ch
(
id
, 
sig_wa™
->
šd_id
è&& 
pid
 =ğsig_wa™->
´oûss_id
) {

4376 ià(
	`WARN_ON
(
sig_wa™
->
šd
))

4377 
	`kä“_skb
(
sig_wa™
->
šd
);

4378 
sig_wa™
->
šd
 = 
skb
;

4379 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4380 
	`com¶‘e
(&
sig_wa™
->
com¶‘iÚ
);

4381 
	`rcu_»ad_uÆock
();

4384 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4385 
	`rcu_»ad_uÆock
();

4387  -
EINVAL
;

4388 
	}
}

4390 #ià!
defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

4391 
	$¦si_rx_£nd_äame_cfm_async
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4393 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4394 
u16
 
ho¡_g
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_£nd_äame_cfm
.host_tag);

4395 
u16
 
»q_¡©us
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_£nd_äame_cfm
.
»suÉ_code
);

4397 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4398 ià(
ho¡_g
 & 
SLSI_HOST_TAG_ARP_MASK
 && 
»q_¡©us
 !ğ
FAPI_RESULTCODE_SUCCESS
) {

4399 ià(
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
) > 0)

4400 
	`©omic_dec
(&
sdev
->
¬p_tx_couÁ
);

4402 
	`SLSI_INFO
(
sdev
, "Unableo decrement sdev‡rp_tx_count\n");

4403 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
) > 0)

4404 
	`©omic_dec
(&
ndev_vif
->
¬p_tx_couÁ
);

4406 
	`SLSI_INFO
(
sdev
, "Unableo decrement‚dev‡rp_tx_count\n");

4407 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
) &&

4408 
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è< (sdev->
fw_max_¬p_couÁ
 - 
SLSI_ARP_UNPAUSE_THRESHOLD
))

4409 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

4410 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

4412 
	`çpi_g‘_vif
(
skb
), 
ho¡_g
, 
»q_¡©us
);

4414 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4415 
	`kä“_skb
(
skb
);

4416 
	}
}

	@sap.h

7 #iâdeà
__SAP_H__


8 
	#__SAP_H__


	)

11 
	#SAP_TOTAL
 4

	)

13 
	#SAP_MLME
 0

	)

14 
	#SAP_MA
 1

	)

15 
	#SAP_DBG
 2

	)

16 
	#SAP_TST
 3

	)

19 
	#SAP_MAX_VER
 2

	)

21 
	#SAP_MAJOR
(
v”siÚ
è((v”siÚ & 0xff00è>> 8)

	)

22 
	#SAP_MINOR
(
v”siÚ
è(v”siÚ & 0xff)

	)

24 
	#SAP_DRV_SIGNAL_BASE
 0xA000

	)

25 
	#SAP_DRV_MA_TO_MLME_DELBA_REQ
 (
SAP_DRV_SIGNAL_BASE
 + 1)

	)

27 
	s§p_drv_ma_to_mlme_d–ba_»q
 {

28 
çpi_sigÇl_h—d”
 
	mh—d”
;

29 
__Ë16
 
	mvif
;

30 
u8
 
	m³”_q¡a_add»ss
[
ETH_ALEN
];

31 
__Ë16
 
	m£qu’û_numb”
;

32 
__Ë16
 
	mu£r_´iÜ™y
;

33 
__Ë16
 
	m»asÚ
;

34 
__Ë16
 
	mdœeùiÚ
;

35 } 
__©Œibu‹__
((
·cked
));

37 
	g¦si_dev
;

38 
	gsk_buff
;

40 
	s§p_­i
 {

41 
u8
 
	m§p_şass
;

42 
u16
 
	m§p_v”siÚs
[
SAP_MAX_VER
];

43 (*
	m§p_v”siÚ_suµÜ‹d
)(
u16
 
	mv”siÚ
);

44 (*
	m§p_hªdËr
)(
¦si_dev
 *
	msdev
, 
sk_buff
 *
	mskb
);

45 #ifdeà
CONFIG_SCSC_WLAN_TX_API


46 (*
	m§p_txdÚe
)(
¦si_dev
 *
	msdev
, 
u32
 
	mcŞour
, 
boŞ
 
	mmÜe
);

48 (*
	m§p_txdÚe
)(
¦si_dev
 *
	msdev
, 
u8
 
	mvif
, u8 
	m³”_šdex
, u8 
	mac
);

50 (*
	m§p_nÙif›r
)(
¦si_dev
 *
	msdev
, 
	mev’t
);

	@sap_dbg.c

6 
	~<lšux/ty³s.h
>

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"§p.h
"

10 
	~"§p_dbg.h
"

11 
	~"h.h
"

13 
	#SUPPORTED_OLD_VERSION
 0

	)

15 
§p_dbg_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

16 
§p_dbg_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

18 
§p_­i
 
	g§p_dbg
 = {

19 .
§p_şass
 = 
SAP_DBG
,

20 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_dbg_v”siÚ_suµÜ‹d
,

21 .
	g§p_hªdËr
 = 
§p_dbg_rx_hªdËr
,

22 .
	g§p_v”siÚs
 = { 
FAPI_DEBUG_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

25 
	$§p_dbg_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

27 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

28 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

29 
u8
 
i
 = 0;

31 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

33 
i
 = 0; i < 
SAP_MAX_VER
; i++)

34 ià(
	`SAP_MAJOR
(
§p_dbg
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

37 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

39  -
EINVAL
;

40 
	}
}

42 
	$¦si_rx_debug
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

44 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

46 
	`SLSI_UNUSED_PARAMETER
(
dev
);

48 
id
) {

49 
DEBUG_FAULT_IND
:

50 
	`SLSI_WARN
(
sdev
, "WF_FW_INFO: |cpu %s|id 0x%04X|arg 0x%08X|count %d|timestamp %10u|\n",

51 ((
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
ıu
) == 0x8000) ? "MAC" :

52 (
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
ıu
) == 0x4000) ? "PHY" : "???"),

53 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
çuÉid
),

54 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_çuÉ_šd
.
¬g
),

55 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
couÁ
),

56 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_çuÉ_šd
.
time¡amp
));

58 
DEBUG_WORD12IND
:

59 
	`©omic_šc
(&
sdev
->
debug_šds
);

60 
	`SLSI_DBG4
(
sdev
, 
SLSI_FW_TEST
, "FW DEBUG(id:%d, subid:%d, vif:%d,ime:%u) %04X %04X %04X %04X %04X %04X %04X %04X %04X %04X %04X %04X\n",

61 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
moduË_id
),

62 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
moduË_sub_id
),

63 
	`çpi_g‘_vif
(
skb
),

64 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_wÜd12_šd
.
time¡amp
),

65 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[0]),

66 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[1]),

67 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[2]),

68 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[3]),

69 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[4]),

70 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[5]),

71 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[6]),

72 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[7]),

73 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[8]),

74 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[9]),

75 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[10]),

76 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[11]));

79 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "UnhªdËd Debug Ind: 0x%.4x\n", 
id
);

82 
	`kä“_skb
(
skb
);

83 
	}
}

85 
	$¦si_rx_dbg_§p
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

87 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

88 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

89 
Ãt_deviû
 *
dev
;

91 
id
) {

92 
DEBUG_FAULT_IND
:

93 
DEBUG_WORD12IND
:

94 
DEBUG_GENERIC_IND
:

95 
	`¦si_rx_debug
(
sdev
, 
NULL
, 
skb
);

97 
DEBUG_PKT_SINK_REPORT_IND
:

99 
	`rcu_»ad_lock
();

100 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

101 ià(!
dev
) {

102 
	`rcu_»ad_uÆock
();

103 
	`kä“_skb
(
skb
);

106 
	`¦si_rx_sšk_»pÜt
(
sdev
, 
dev
, 
skb
);

107 
	`rcu_»ad_uÆock
();

110 
DEBUG_PKT_GEN_REPORT_IND
:

112 
	`rcu_»ad_lock
();

113 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

114 ià(!
dev
) {

115 
	`rcu_»ad_uÆock
();

116 
	`kä“_skb
(
skb
);

119 
	`¦si_rx_g’_»pÜt
(
sdev
, 
dev
, 
skb
);

120 
	`rcu_»ad_uÆock
();

124 
	`kä“_skb
(
skb
);

125 
	`SLSI_ERR
(
sdev
, "UnhªdËd Ind: 0x%.4x\n", 
id
);

130 
	}
}

132 
	$¦si_rx_dbg_§p_wÜk
(
wÜk_¡ruù
 *
wÜk
)

134 
¦si_skb_wÜk
 *
w
 = 
	`cÚš”_of
(
wÜk
, slsi_skb_work, work);

135 
¦si_dev
 *
sdev
 = 
w
->sdev;

136 
sk_buff
 *
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

138 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

139 
skb
) {

140 
	`¦si_debug_äame
(
sdev
, 
NULL
, 
skb
, "RX");

141 
	`¦si_rx_dbg_§p
(
sdev
, 
skb
);

142 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

144 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

145 
	}
}

147 
	$§p_dbg_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

152 ià(
	`¦si_rx_blockšg_sigÇls
(
sdev
, 
skb
) == 0)

155 
	`¦si_skb_wÜk_’queue
(&
sdev
->
rx_dbg_§p
, 
skb
);

157 
	}
}

159 
	$§p_dbg_š™
()

161 
	`SLSI_INFO_NODEV
("Registering SAP\n");

163 
	`¦si_h_§p_»gi¡”
(&
§p_dbg
);

166 
	}
}

168 
	$§p_dbg_deš™
()

170 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

171 
	`¦si_h_§p_uÄegi¡”
(&
§p_dbg
);

173 
	}
}

	@sap_dbg.h

8 #iâdeà
__SAP_DBG_H__


9 
	#__SAP_DBG_H__


	)

11 
§p_dbg_š™
();

12 
§p_dbg_deš™
();

	@sap_ma.c

6 
	~<lšux/ty³s.h
>

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"§p.h
"

10 
	~"§p_ma.h
"

11 
	~"h.h
"

12 
	~"ba.h
"

13 
	~"mgt.h
"

14 
	~"Æ80211_v’dÜ.h
"

15 
	~"h4_§m¶”.h
"

16 
	~"Œaffic_mÚ™Ü.h
"

18 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


19 
	~"scsc_wifogg”_ršgs.h
"

22 #ifdeà
CONFIG_SCSC_WLAN_TX_API


23 
	~"tx_­i.h
"

26 
	#SUPPORTED_OLD_VERSION
 0

	)

28 
§p_ma_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

29 
§p_ma_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

30 #ifdeà
CONFIG_SCSC_WLAN_TX_API


31 
§p_ma_txdÚe
(
¦si_dev
 *
sdev
, 
u32
 
cŞour
, 
boŞ
 
mÜe
);

33 
§p_ma_txdÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
);

35 
§p_ma_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
);

37 
§p_­i
 
	g§p_ma
 = {

38 .
§p_şass
 = 
SAP_MA
,

39 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_ma_v”siÚ_suµÜ‹d
,

40 .
	g§p_hªdËr
 = 
§p_ma_rx_hªdËr
,

41 .
	g§p_v”siÚs
 = { 
FAPI_DATA_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

42 .
	g§p_txdÚe
 = 
§p_ma_txdÚe
,

43 .
	g§p_nÙif›r
 = 
§p_ma_nÙif›r
,

46 
	$§p_ma_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
)

48 
ušt
 
vif
;

50 
	`SLSI_INFO_NODEV
("NÙif›¸ev’ˆ»ûived: %lu\n", 
ev’t
);

51 ià(
ev’t
 >ğ
SCSC_MAX_NOTIFIER
)

52  -
EIO
;

54 
ev’t
) {

55 
SCSC_WIFI_STOP
:

56 
	`SLSI_INFO_NODEV
("Stop‚etdev queues\n");

57 
	`rcu_»ad_lock
();

58 
vif
 = 
SLSI_NET_INDEX_WLAN
;

59 
vif
 <ğ
SLSI_NET_INDEX_P2PX_SWLAN
; vif++) {

60 
Ãt_deviû
 *
ndev
 =

61 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

62 ià(
ndev
 && !
	`Ãtif_queue_¡İ³d
(ndev))

63 
	`Ãtif_tx_¡İ_®l_queues
(
ndev
);

65 
	`rcu_»ad_uÆock
();

68 
SCSC_WIFI_FAILURE_RESET
:

69 
	`SLSI_DBG1_NODEV
(
SLSI_NETDEV
, "Netdevs queues will‚ot be„estarted -„ecovery willake care of it\n");

72 
SCSC_WIFI_SUSPEND
:

75 
SCSC_WIFI_RESUME
:

77 
SCSC_WIFI_CHIP_READY
:

79 
SCSC_WIFI_SUBSYSTEM_RESET
:

82 
	`SLSI_INFO_NODEV
("UnknowÀev’ˆcod%lu\n", 
ev’t
);

87 
	}
}

89 
	$§p_ma_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

91 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

92 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

93 
u8
 
i
 = 0;

95 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

97 
i
 = 0; i < 
SAP_MAX_VER
; i++)

98 ià(
	`SAP_MAJOR
(
§p_ma
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

101 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

103  -
EINVAL
;

104 
	}
}

106 
boŞ
 
	$¦si_rx_check_mc_addr_»gd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
‘hhdr
 *
ehdr
)

108 
i
;

109 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

111 
	`¦si_¥šlock_lock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

113 
i
 = 0 ; i < 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
; i++)

114 ià(
	`memcmp
(
ehdr
->
h_de¡
, 
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
], 
ETH_ALEN
) == 0) {

115 
	`SLSI_INFO
(
sdev
, "Wakeu°by„egd møadd¸" 
MACSTR
 "\n", 
	`MAC2STR
(
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
]));

116 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

117  
Œue
;

120 
	`SLSI_ERR
(
sdev
, "Wakeup by unregistered mc‡ddress\n");

121 
	`SLSI_INFO
(
sdev
, "Reûived…ack‘ sourû : " 
MACSTR
 ", de¡ : " MACSTR "\n", 
	`MAC2STR
(
ehdr
->
h_sourû
), MAC2STRÓhdr->
h_de¡
));

122 
	`SLSI_INFO
(
sdev
, "Regd mc‡ddr : \n");

123 
i
 = 0 ; i < 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
; i++)

124 
	`SLSI_INFO
(
sdev
, " " 
MACSTR
 "\n", 
	`MAC2STR
(
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
]));

126 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

127  
çl£
;

128 
	}
}

130 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


131 
	$¦si_rx_amsdu_d—gg»g©e
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
sk_buff_h—d
 *
msdu_li¡
)

133 
¦si_skb_cb
 *
skb_cb
 = 
	`¦si_skb_cb_g‘
(
skb
);

134 
d©a_Ën
 = 0;

135 
subäame_Ën
 = 0;

136 
·ddšg
 = 0;

137 
sk_buff
 *
subäame
 = 
NULL
;

138 cÚ¡ 
mac_0
[
ETH_ALEN
] = { 0 };

139 
‘hhdr
 *
mh
 = 
NULL
;

140 
boŞ
 
disÿrd
;

142 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "A-MSDU„eûived (Ën:%d)\n", 
skb
->
Ën
);

143 
skb
->
Ën
) {

156 ià(
	`uÆik–y
((
ETH_ALEN
 * 2 + 2è> 
skb
->
Ën
)) {

157 
	`SLSI_NET_ERR
(
dev
, "šv®id SKB†’gth %d < %d\n", 
skb
->
Ën
, (
ETH_ALEN
 * 2 + 2));

158 
	`__skb_queue_purge
(
msdu_li¡
);

159 
	`kä“_skb
(
skb
);

160  -
EINVAL
;

163 
d©a_Ën
 = (
skb
->
d©a
[
ETH_ALEN
 * 2] << 8) | skb->data[(ETH_ALEN * 2) + 1];

164 ià(
	`uÆik–y
(
d©a_Ën
 <ğ
LLC_SNAP_HDR_LEN
)) {

165 
	`SLSI_NET_ERR
(
dev
, "šv®id d©¨Ëngth %d < %d\n", 
d©a_Ën
, 
LLC_SNAP_HDR_LEN
);

166 
	`__skb_queue_purge
(
msdu_li¡
);

167 
	`kä“_skb
(
skb
);

168  -
EINVAL
;

170 
d©a_Ën
 -ğ
LLC_SNAP_HDR_LEN
;

178 ià(
	`uÆik–y
(
ETH_ALEN
 * 2 + 2 + 
LLC_SNAP_HDR_LEN
 + 
d©a_Ën
 > 
skb
->
Ën
)) {

179 
	`SLSI_NET_ERR
(
dev
, "šv®id MSDU d©¨Ëngth %d, SKB†’gth = %d\n", 
d©a_Ën
, 
skb
->
Ën
);

180 
	`__skb_queue_purge
(
msdu_li¡
);

181 
	`kä“_skb
(
skb
);

182  -
EINVAL
;

192 
subäame_Ën
 = (
‘hhdr
è+ 
d©a_Ën
;

194 
disÿrd
 = (
skb_cb
->disÿrd & 0x1 ? 
Œue
 : 
çl£
);

195 
skb_cb
->
disÿrd
 = skb_cb->discard >> 1;

197 ià(
skb
->
Ën
 =ğ
subäame_Ën
 + 
LLC_SNAP_HDR_LEN
) {

198 ià(
disÿrd
) {

199 
	`kä“_skb
(
skb
);

203 
	`SLSI_ETHER_COPY
(&
skb
->
d©a
[14], &skb->data[6]);

204 
	`SLSI_ETHER_COPY
(&
skb
->
d©a
[8], &skb->data[0]);

206 
	`skb_puÎ
(
skb
, 
LLC_SNAP_HDR_LEN
);

208 
	`skb_£t_mac_h—d”
(
skb
, 0);

209 
mh
 = 
	`‘h_hdr
(
skb
);

210 ià(
	`SLSI_ETHER_EQUAL
(
mh
->
h_de¡
, 
mac_0
)) {

211 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX
, "msdu subäamf‹»d out: MAC de¡š©iÚ‡dd»s %pM\n", 
mh
->
h_de¡
);

212 
	`kä“_skb
(
skb
);

214 
	`__skb_queue_
(
msdu_li¡
, 
skb
);

220 
·ddšg
 = (4 - (
subäame_Ën
 % 4)) & 0x3;

221 ià(
disÿrd
) {

222 
	`skb_puÎ
(
skb
, 
LLC_SNAP_HDR_LEN
 + 
subäame_Ën
 + 
·ddšg
);

226 
subäame
 = 
	`®loc_skb
(
subäame_Ën
, 
GFP_ATOMIC
);

227 ià(
	`uÆik–y
(!
subäame
)) {

228 
	`SLSI_NET_ERR
(
dev
, "failedo‡lloche SKB for A-MSDU subframe\n");

229 
	`__skb_queue_purge
(
msdu_li¡
);

230 
	`kä“_skb
(
skb
);

231  -
ENOMEM
;

247 
	`skb_put_d©a
(
subäame
, 
skb
->
d©a
, 
ETH_ALEN
 * 2);

248 
	`skb_puÎ
(
skb
, 
ETH_ALEN
 * 2);

257 
	`skb_puÎ
(
skb
, 8);

272 
	`skb_put_d©a
(
subäame
, 
skb
->
d©a
, 2);

273 
	`skb_puÎ
(
skb
, 2);

288 
	`skb_put_d©a
(
subäame
, 
skb
->
d©a
, 
d©a_Ën
);

289 
	`skb_puÎ
(
skb
, 
d©a_Ën
);

299 ià(
	`uÆik–y
(!
	`skb_puÎ
(
skb
, 
·ddšg
))) {

300 
	`kä“_skb
(
subäame
);

301 
	`SLSI_NET_ERR
(
dev
, "Invalid A-MSDU Padding\n");

302 
	`__skb_queue_purge
(
msdu_li¡
);

303 
	`kä“_skb
(
skb
);

304  -
EINVAL
;

309 
	`skb_£t_mac_h—d”
(
subäame
, 0);

310 
mh
 = 
	`‘h_hdr
(
subäame
);

311 ià(
	`uÆik–y
(
	`SLSI_ETHER_EQUAL
(
mh
->
h_de¡
, 
mac_0
))) {

312 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX
, "msdu subäamf‹»d out: MAC de¡š©iÚ‡dd»s %pM\n", 
mh
->
h_de¡
);

313 
	`kä“_skb
(
subäame
);

316 
	`__skb_queue_
(
msdu_li¡
, 
subäame
);

319 
	}
}

321 
	$¦si_rx_amsdu_d—gg»g©e
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
sk_buff_h—d
 *
msdu_li¡
)

323 
¦si_skb_cb
 *
skb_cb
 = 
	`¦si_skb_cb_g‘
(
skb
);

324 
d©a_Ën
 = 0;

325 
subäame_Ën
 = 0;

326 
·ddšg
 = 0;

327 
sk_buff
 *
subäame
 = 
NULL
;

328 cÚ¡ 
mac_0
[
ETH_ALEN
] = { 0 };

329 
‘hhdr
 *
mh
 = 
NULL
;

330 
boŞ
 
disÿrd
;

331 
boŞ
 
is_Ï¡
 = 
çl£
;

333 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "A-MSDU„eûived (Ën:%d)\n", 
skb
->
Ën
);

334 
skb
->
Ën
) {

347 ià(
	`uÆik–y
((
ETH_ALEN
 * 2 + 2è> 
skb
->
Ën
)) {

348 
	`SLSI_NET_ERR
(
dev
, "šv®id SKB†’gth %d < %d\n", 
skb
->
Ën
, (
ETH_ALEN
 * 2 + 2));

349 
	`__skb_queue_purge
(
msdu_li¡
);

350 
	`kä“_skb
(
skb
);

351  -
EINVAL
;

354 
d©a_Ën
 = (
skb
->
d©a
[
ETH_ALEN
 * 2] << 8) | skb->data[(ETH_ALEN * 2) + 1];

355 ià(
	`uÆik–y
(
d©a_Ën
 <ğ
LLC_SNAP_HDR_LEN
)) {

356 
	`SLSI_NET_ERR
(
dev
, "šv®id d©¨Ëngth %d < %d\n", 
d©a_Ën
, 
LLC_SNAP_HDR_LEN
);

357 
	`__skb_queue_purge
(
msdu_li¡
);

358 
	`kä“_skb
(
skb
);

359  -
EINVAL
;

361 
d©a_Ën
 -ğ
LLC_SNAP_HDR_LEN
;

369 ià(
	`uÆik–y
(
ETH_ALEN
 * 2 + 2 + 
LLC_SNAP_HDR_LEN
 + 
d©a_Ën
 > 
skb
->
Ën
)) {

370 
	`SLSI_NET_ERR
(
dev
, "šv®id MSDU d©¨Ëngth %d, SKB†’gth = %d\n", 
d©a_Ën
, 
skb
->
Ën
);

371 
	`__skb_queue_purge
(
msdu_li¡
);

372 
	`kä“_skb
(
skb
);

373  -
EINVAL
;

384 
subäame_Ën
 = (
‘hhdr
è+ 
d©a_Ën
;

385 
disÿrd
 = (
skb_cb
->disÿrd & 0x1 ? 
Œue
 : 
çl£
);

386 
skb_cb
->
disÿrd
 = skb_cb->discard >> 1;

389 ià(
skb
->
Ën
 =ğ
subäame_Ën
 + 
LLC_SNAP_HDR_LEN
) {

390 ià(
disÿrd
) {

391 
	`kä“_skb
(
skb
);

395 
subäame
 = 
skb
;

396 
·ddšg
 = 0;

397 
is_Ï¡
 = 
Œue
;

399 
·ddšg
 = (4 - (
subäame_Ën
 % 4)) & 0x3;

400 ià(
disÿrd
) {

401 
	`skb_puÎ
(
skb
, 
LLC_SNAP_HDR_LEN
 + 
subäame_Ën
 + 
·ddšg
);

405 
subäame
 = 
	`skb_şÚe
(
skb
, 
GFP_ATOMIC
);

406 ià(
	`uÆik–y
(!
subäame
)) {

407 
	`SLSI_NET_ERR
(
dev
, "failedo clone SKB for A-MSDU subframe\n");

408 
	`__skb_queue_purge
(
msdu_li¡
);

409 
	`kä“_skb
(
skb
);

410  -
ENOMEM
;

422 
	`skb_Œim
(
subäame
, 
subäame_Ën
 + 
LLC_SNAP_HDR_LEN
);

437 
	`SLSI_ETHER_COPY
(&
subäame
->
d©a
[14], &subframe->data[6]);

438 
	`SLSI_ETHER_COPY
(&
subäame
->
d©a
[8], &subframe->data[0]);

439 
	`skb_puÎ
(
subäame
, 
LLC_SNAP_HDR_LEN
);

444 
	`skb_£t_mac_h—d”
(
subäame
, 0);

445 
mh
 = 
	`‘h_hdr
(
subäame
);

446 ià(
	`uÆik–y
(
	`SLSI_ETHER_EQUAL
(
mh
->
h_de¡
, 
mac_0
))) {

447 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX
, "msdu subäamf‹»d out: MAC de¡š©iÚ‡dd»s %pM\n", 
mh
->
h_de¡
);

448 
	`skb_puÎ
(
skb
, 
LLC_SNAP_HDR_LEN
 + 
subäame_Ën
 + 
·ddšg
);

449 
	`kä“_skb
(
subäame
);

450 ià(!
is_Ï¡
)

453 
	`__skb_queue_
(
msdu_li¡
, 
subäame
);

456 ià(
is_Ï¡
)

467 ià(
	`uÆik–y
(!
	`skb_puÎ
(
skb
, 
LLC_SNAP_HDR_LEN
 + 
subäame_Ën
 + 
·ddšg
))) {

468 
	`SLSI_NET_ERR
(
dev
, "Invalid A-MSDU Padding\n");

469 
	`__skb_queue_purge
(
msdu_li¡
);

470 
	`kä“_skb
(
skb
);

471  -
EINVAL
;

475 
	}
}

478 
	$¦si_rx_check_İt_out_·ck‘
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

480 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

481 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
skb
->
d©a
);

483 
ndev_vif
->
is_İt_out_·ck‘
 = 
çl£
;

485 ià(
	`is_brßdÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

486 
ndev_vif
->
is_İt_out_·ck‘
 = 
Œue
;

487 
	`SLSI_NET_ERR
(
dev
, "Wakeup by Broadcast…acket\n");

488 } ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

489 
ndev_vif
->
is_İt_out_·ck‘
 = !
	`¦si_rx_check_mc_addr_»gd
(
sdev
, 
dev
, 
ehdr
);

490 } ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_ARP
) {

491 
u8
 *
äame
;

492 
u16
 
¬p_İcode
;

494 
äame
 = 
skb
->
d©a
 + (
‘hhdr
);

495 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

501 ià(
¬p_İcode
 =ğ
SLSI_ARP_REQUEST_OPCODE
)

502 
ndev_vif
->
is_İt_out_·ck‘
 = 
Œue
;

503 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


505 
ndev_vif
->
is_İt_out_·ck‘
 = 
sdev
->
’hªûd_pkt_f‹r_’abËd
;

507 
	`SLSI_NET_ERR
(
dev
, "Wakeu°by ARP…ack‘,‡½_İcod: %d\n", 
¬p_İcode
);

508 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


509 } ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

510 ià(
	`is_uniÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

512 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IP
) {

513 
hdr
 *

 = (hd¸*)(
skb
->
d©a
 + (
‘hhdr
));

515 
ndev_vif
->
is_İt_out_·ck‘
 = !(

->
´ÙocŞ
 =ğ
IPPROTO_TCP
);

516 
	`SLSI_NET_INFO
(
dev
, "Wakeu°by IPV4 , ip->´ÙocŞ = %d\n", 

->
´ÙocŞ
);

517 } ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IPV6
) {

518 
v6hdr
 *

 = (v6hd¸*)(
skb
->
d©a
 + (
‘hhdr
));

520 
ndev_vif
->
is_İt_out_·ck‘
 = !(

->
Ãxthdr
 =ğ
IPPROTO_TCP
);

521 
	`SLSI_NET_INFO
(
dev
, "Wakeu°by IPV6 , ip->Ãxthd¸ğ%d\n", 

->
Ãxthdr
);

523 
ndev_vif
->
is_İt_out_·ck‘
 = 
Œue
;

524 
	`SLSI_NET_ERR
(
dev
, "Wakeu°by h_´ÙØ: 0x%.4X\n", 
	`be16_to_ıu
(
ehdr
->
h_´Ùo
));

527 
	`SLSI_NET_ERR
(
dev
, "Wakeup by Not Unicast -he…acket must be checking in Multicast condition\n");

531 
	`SLSI_NET_INFO
(
dev
, "Wakeup by Opt in…acket\n");

533 
	}
}

535 
sk_buff
 *
	$¦si_·r£_ªd_puÎ_ma_un™d©a_šd_sigÇl
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

537 
¦si_skb_cb
 *
skb_cb
;

538 
boŞ
 
is_ch”ed
, 
is_wakeup
;

539 
u8
 
disÿrd
;

545 
is_ch”ed
 = (
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
cÚfigu¿tiÚ_İtiÚ
è& 
FAPI_OPTION_KEYRSC
) >> 3;

546 
disÿrd
 = (
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
cÚfigu¿tiÚ_İtiÚ
è& 
FAPI_OPTION_DISCARD
) >> 8;

547 
is_wakeup
 = ((
¦si_skb_cb
 *)
skb
->
cb
)->
wakeup
;

548 #ifdeà
CONFIG_SCSC_SMAPPER


550 ià(
	`¦si_skb_cb_g‘
(
skb
)->
sm­³r_lšked
) {

551 
skb
 = 
	`¦si_h_g‘_skb_äom_sm­³r
(
sdev
, skb);

552 ià(!
skb
) {

553 
	`SLSI_WARN
(
sdev
, "SKB from SMAPPER is NULL\n");

554  
NULL
;

557 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

560 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

562 
skb_cb
 = (
¦si_skb_cb
 *)
skb
->
cb
;

563 
skb_cb
->
is_amsdu
 = 
çl£
;

564 
skb_cb
->
is_ch”ed
 = is_ciphered;

565 
skb_cb
->
disÿrd
 = discard;

566 
skb_cb
->
wakeup
 = 
is_wakeup
;

568  
skb
;

569 
	}
}

571 
	$¦si_g‘_msdu_äame
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

573 
¦si_skb_cb
 *
skb_cb
 = (¦si_skb_cb *)
skb
->
cb
;

574 
›“80211_hdr
 *
hdr
;

575 
off£t
 = 0;

576 
u8
 *
qc
 = 
NULL
;

578 
hdr
 = (
›“80211_hdr
 *)
skb
->
d©a
;

580 ià(!
	`›“80211_is_d©a
(
hdr
->
äame_cÚŒŞ
)) {

581 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX
, "Ignorehis…acket. It is‚ot data\n");

582  -
EINVAL
;

585 ià(
	`›“80211_has_äomds
(
hdr
->
äame_cÚŒŞ
è|| 
	`›“80211_has_tods
(hdr->frame_control))

586 
skb_cb
->
is_tdls
 = 
çl£
;

588 
skb_cb
->
is_tdls
 = 
Œue
;

591 
skb_cb
->
£q_num
 = (
	`Ë16_to_ıu
(
hdr
->
£q_ù¾
è& 
IEEE80211_SCTL_SEQ
) >> 4;

594 ià(
	`›“80211_has_a4
(
hdr
->
äame_cÚŒŞ
)) {

595 
off£t
 +ğ(
›“80211_hdr
);

596 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "80211 h—d” ha 4add¸off£t:%d\n", 
off£t
);

598 
off£t
 +ğ(
›“80211_hdr_3addr
);

601 ià(
	`›“80211_is_d©a_qos
(
hdr
->
äame_cÚŒŞ
)) {

602 
qc
 = 
	`›“80211_g‘_qos_ùl
(
hdr
);

603 
off£t
 +ğ
IEEE80211_QOS_CTL_LEN
;

604 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "80211 h—d” ha QoS_CTL off£t:%d\n", 
off£t
);

606 
skb_cb
->
tid
 = 
qc
[0] & 
IEEE80211_QOS_CTL_TID_MASK
;

609 
skb_cb
->
tid
 = 
FAPI_PRIORITY_CONTENTION
;

612 ià(
	`›“80211_has_Üd”
(
hdr
->
äame_cÚŒŞ
)) {

613 
off£t
 +ğ
IEEE80211_HT_CTL_LEN
;

614 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "80211 h—d” ha HT_CTL off£t:%d\n", 
off£t
);

618 ià(
skb_cb
->
is_ch”ed
) {

619 
	`memıy
(
skb_cb
->
keyrsc
, 
skb
->
d©a
 + 
off£t
, 
SLSI_EAPOL_KEY_RSC_LENGTH
);

620 
off£t
 +ğ
SLSI_EAPOL_KEY_RSC_LENGTH
;

621 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "key-RSC i cÚšed off£t:%d\n", 
off£t
);

624 ià(
qc
 && (*qø& 
IEEE80211_QOS_CTL_A_MSDU_PRESENT
)) {

626 
skb_cb
->
is_amsdu
 = 
Œue
;

627 
	`skb_puÎ
(
skb
, 
off£t
);

628 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "Pack‘ i A-MSDU off£t:%d\n", 
off£t
);

631 
	`SLSI_ETHER_COPY
(&
skb
->
d©a
[
off£t
], 
	`›“80211_g‘_SA
(
hdr
));

639 
	`memmove
(&
skb
->
d©a
[
off£t
 - 
ETH_ALEN
], 
	`›“80211_g‘_DA
(
hdr
), ETH_ALEN);

640 
	`skb_puÎ
(
skb
, 
off£t
 - 
ETH_ALEN
);

641 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "Pack‘ i MSDU off£t:%d\n", 
off£t
);

645 
	}
}

647 
	$¦si_rx_d©a_d–iv”_skb
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
ùx_Çpi
)

649 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

650 
sk_buff_h—d
 
msdu_li¡
;

651 
¦si_skb_cb
 *
skb_cb
 = (¦si_skb_cb *)
skb
->
cb
;

652 
¦si_³”
 *
³”
 = 
NULL
;

653 
‘hhdr
 *
‘h_hdr
;

654 
boŞ
 
is_amsdu
 = 
skb_cb
->is_amsdu;

655 
u8
 
Œafic_q
 = 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb_cb
->
tid
);

657 
	`__skb_queue_h—d_š™
(&
msdu_li¡
);

659 
‘h_hdr
 = (
‘hhdr
 *)
skb
->
d©a
;

660 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
‘h_hdr
->
h_sourû
);

661 ià(!
³”
) {

662 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (no…eer„ecords)\n");

663 
	`kä“_skb
(
skb
);

668 ià(
is_amsdu
) {

669 ià(
	`¦si_rx_amsdu_d—gg»g©e
(
dev
, 
skb
, &
msdu_li¡
)) {

670 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (A-MSDUƒrror)\n");

671 
ndev_vif
->
¡©s
.
rx_drİ³d
++;

672 ià(
³”
)

673 
³”
->
sšfo
.
rx_drİ³d_misc
++;

677 ià(
skb_cb
->
disÿrd
) {

678 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (discard flag set)\n");

683 
	`cÚsume_skb
(
skb
);

686 
	`__skb_queue_
(&
msdu_li¡
, 
skb
);

689 !
	`skb_queue_em±y
(&
msdu_li¡
)) {

690 
sk_buff
 *
rx_skb
;

691 #ià
	`defšed
(
CONFIG_SCSC_WLAN_RX_NAPI
è&& defšed(
CONFIG_SCSC_WLAN_RX_NAPI_GRO
)

692 
u16
 
drİ_´Ùo
;

695 
rx_skb
 = 
	`__skb_dequeue
(&
msdu_li¡
);

701 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

702 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
rx_skb
->
d©a
);

704 ià(
	`uÆik–y
(
	`¦si_skb_cb_g‘
(
rx_skb
)->
wakeup
)) {

705 
	`¦si_rx_check_İt_out_·ck‘
(
sdev
, 
dev
, 
rx_skb
);

706 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

707 
	`scheduË_wÜk
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

720 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
è&& !
	`com·»_‘h”_addr
Óhdr->
h_sourû
, 
dev
->
dev_addr
)) {

721 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "drop†ocally generated multicast frame„elayed back by AP\n");

722 
	`cÚsume_skb
(
rx_skb
);

728 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 &&‚dev_vif->
³”_¡a_»cÜds
) {

729 
¦si_³”
 *
³”
 = 
NULL
;

730 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
rx_skb
->
d©a
);

732 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

734 
sk_buff
 *
»brßdÿ¡_skb
 = 
	`skb_cİy
(
rx_skb
, 
GFP_ATOMIC
);

735 ià(!
»brßdÿ¡_skb
) {

736 
	`SLSI_WARN
(
sdev
, "Intra BSS: failedo‡lloc‚ew SKB for broadcast\n");

738 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "IÁ¿ BSS: muÉiÿ¡ %pM\n", 
ehdr
->
h_de¡
);

739 
»brßdÿ¡_skb
->
dev
 = dev;

740 
»brßdÿ¡_skb
->
´ÙocŞ
 = 
	`ıu_to_be16
(
ETH_P_802_3
);

741 
	`skb_»£t_ÃtwÜk_h—d”
(
»brßdÿ¡_skb
);

742 
	`skb_»£t_mac_h—d”
(
»brßdÿ¡_skb
);

743 
	`dev_queue_xm™
(
»brßdÿ¡_skb
);

746 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
ehdr
->
h_de¡
);

747 ià(
³”
 &&…“r->
authÜized
) {

748 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "IÁ¿ BSS: uniÿ¡ %pM\n", 
ehdr
->
h_de¡
);

749 
rx_skb
->
dev
 = dev;

750 
rx_skb
->
´ÙocŞ
 = 
	`ıu_to_be16
(
ETH_P_802_3
);

751 
	`skb_»£t_ÃtwÜk_h—d”
(
rx_skb
);

752 
	`skb_»£t_mac_h—d”
(
rx_skb
);

753 
	`dev_queue_xm™
(
rx_skb
);

759 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


761 ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

762 
Ãt_deviû
 *
Ùh”_dev
;

763 
Ãtdev_vif
 *
Ùh”_ndev_vif
;

764 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
rx_skb
->
d©a
);

765 
u8
 
i
, 
j
;

767 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

777 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "NAN: muÉiÿ¡ (sourû‡dd»ss: %pM)\n", 
ehdr
->
h_sourû
);

778 (
i
 = 
ndev_vif
->
iâum
 + 1); i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

779 
Ùh”_dev
 = (
Ãt_deviû
 *è
sdev
->
Ãtdev
[
i
];

780 ià(!
Ùh”_dev
)

782 
Ùh”_ndev_vif
 = (
Ãtdev_vif
 *)
	`Ãtdev_´iv
(
Ùh”_dev
);

783 ià(!
Ùh”_ndev_vif
)

785 
j
 = 0; j < 
SLSI_PEER_INDEX_MAX
; j++) {

786 ià(
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
] &&

787 
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
v®id
 &&

788 
	`‘h”_addr_equ®
(
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
add»ss
, 
ehdr
->
h_sourû
)) {

790 
sk_buff
 *
du¶iÿ‹_skb
 = 
	`skb_cİy
(
rx_skb
, 
GFP_ATOMIC
);

791 
	`SLSI_NET_DBG2
(
Ùh”_dev
, 
SLSI_RX
, "NAN: sourû‡dd»s m©ch %pM\n", 
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
add»ss
);

792 ià(!
du¶iÿ‹_skb
) {

793 
	`SLSI_NET_WARN
(
Ùh”_dev
, "NAN: multicast: failedo‡lloc‚ew SKB\n");

797 
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
sšfo
.
rx_by‹s
 +ğ
du¶iÿ‹_skb
->
Ën
;

798 
Ùh”_ndev_vif
->
¡©s
.
rx_·ck‘s
++;

799 
Ùh”_ndev_vif
->
¡©s
.
rx_by‹s
 +ğ
du¶iÿ‹_skb
->
Ën
;

800 
Ùh”_ndev_vif
->
rx_·ck‘s
[
Œafic_q
]++;

802 
du¶iÿ‹_skb
->
dev
 = 
Ùh”_dev
;

803 
du¶iÿ‹_skb
->
_summed
 = 
CHECKSUM_NONE
;

804 
du¶iÿ‹_skb
->
´ÙocŞ
 = 
	`‘h_ty³_Œªs
(du¶iÿ‹_skb, 
Ùh”_dev
);

806 
	`SLSI_NET_DBG4
(
Ùh”_dev
, 
SLSI_RX
, "·s %u by‹ tØloÿÈ¡ack\n", 
du¶iÿ‹_skb
->
Ën
);

807 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


808 
	`Ãtif_»ûive_skb
(
du¶iÿ‹_skb
);

810 
	`Ãtif_rx_ni
(
du¶iÿ‹_skb
);

818 ià(
³”
) {

819 
³”
->
sšfo
.
rx_by‹s
 +ğ
rx_skb
->
Ën
;

821 
ndev_vif
->
¡©s
.
rx_·ck‘s
++;

822 
ndev_vif
->
¡©s
.
rx_by‹s
 +ğ
rx_skb
->
Ën
;

823 
ndev_vif
->
rx_·ck‘s
[
Œafic_q
]++;

825 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


826 ià(!
ndev_vif
->
’hªûd_¬p_¡©s
.
is_du¶iÿ‹_addr_d‘eùed
) {

827 
u8
 *
äame
 = 
rx_skb
->
d©a
 + 12;

828 
u16
 
·ck‘_ty³
 = 
äame
[0] << 8 | frame[1];

830 ià(
·ck‘_ty³
 =ğ
ETH_P_ARP
) {

831 
äame
 = frame + 2;

833 ià((
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
] =ğ(
ndev_vif
->
add»ss
 & 255)) &&

834 (
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
 + 1] =ğ((
ndev_vif
->
add»ss
 >> 8U) & 255)) &&

835 (
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
 + 2] =ğ((
ndev_vif
->
add»ss
 >> 16U) & 255)) &&

836 (
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
 + 3] =ğ((
ndev_vif
->
add»ss
 >> 24U) & 255)) &&

837 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

838 !
	`SLSI_ETHER_EQUAL
(
dev
->
dev_addr
, 
äame
 + 8))

839 
ndev_vif
->
’hªûd_¬p_¡©s
.
is_du¶iÿ‹_addr_d‘eùed
 = 1;

843 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 && (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
)) {

844 
u8
 *
äame
 = 
rx_skb
->
d©a
 + 12;

845 
u16
 
·ck‘_ty³
 = 
äame
[0] << 8 | frame[1];

846 
u16
 
¬p_İcode
;

848 ià(
·ck‘_ty³
 =ğ
ETH_P_ARP
) {

849 
äame
 = frame + 2;

850 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

852 ià((
¬p_İcode
 =ğ
SLSI_ARP_REPLY_OPCODE
) &&

853 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

854 !
	`memcmp
(&
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4)) {

855 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_to_Ãtdev
++;

856 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_uµ”_mac
++;

862 
rx_skb
->
dev
 = dev;

863 
rx_skb
->
_summed
 = 
CHECKSUM_NONE
;

864 
rx_skb
->
´ÙocŞ
 = 
	`‘h_ty³_Œªs
Ôx_skb, 
dev
);

866 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
rx_skb
->
d©a
, 
Œue
);

867 
	`¦si_Œaffic_mÚ_ev’t_rx
(
sdev
, 
dev
, 
rx_skb
);

869 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "·s %u by‹ tØloÿÈ¡ack\n", 
rx_skb
->
Ën
);

870 
	`¦si_skb_cb_š™
(
rx_skb
);

871 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


872 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


873 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


877 ià(
rx_skb
->
´ÙocŞ
 =ğ
	`htÚs
(
ETH_P_ARP
)) {

878 
	`by·ss_backlog
(
sdev
, 
dev
, 
rx_skb
);

882 
drİ_´Ùo
 = 
rx_skb
->
´ÙocŞ
;

883 ià(
ùx_Çpi
) {

884 ià(
GRO_DROP
 =ğ
	`Çpi_gro_»ûive
(&
sdev
->
h4_š¡
.
h_´iv
->
Çpi
, 
rx_skb
))

885 
	`SLSI_NET_WARN
(
dev
, "Pack‘ i drİ³d. PrÙocŞ=%hx\n", 
	`Áohs
(
drİ_´Ùo
));

887 ià(
NET_RX_DROP
 =ğ
	`Ãtif_»ûive_skb
(
rx_skb
))

888 
	`SLSI_NET_WARN
(
dev
, "Pack‘ i drİ³d. PrÙocŞ=%hx\n", 
	`Áohs
(
drİ_´Ùo
));

891 
	`Ãtif_»ûive_skb
(
rx_skb
);

894 
	`Ãtif_rx_ni
(
rx_skb
);

896 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_ma
, 
	`m£cs_to_jiff›s
(
SLSI_RX_WAKELOCK_TIME
));

898 
	}
}

900 
	$¦si_rx_d©a_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

902 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

903 
¦si_skb_cb
 *
skb_cb
;

904 
¦si_³”
 *
³”
 = 
NULL
;

905 
‘hhdr
 *
‘h_hdr
;

907 
skb
 = 
	`¦si_·r£_ªd_puÎ_ma_un™d©a_šd_sigÇl
(
sdev
, skb);

908 ià(!
skb
)

911 
skb_cb
 = (
¦si_skb_cb
 *)
skb
->
cb
;

913 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_MONITOR
) {

914 
	`skb_»£t_mac_h—d”
(
skb
);

915 
skb
->
dev
 = dev;

916 
skb
->
_summed
 = 
CHECKSUM_UNNECESSARY
;

917 
skb
->
pkt_ty³
 = 
PACKET_OTHERHOST
;

918 
	`Ãtif_rx_ni
(
skb
);

922 ià(
	`¦si_g‘_msdu_äame
(
dev
, 
skb
)) {

923 
	`WARN_ON
(1);

924 
	`kä“_skb
(
skb
);

927 
‘h_hdr
 = (
‘hhdr
 *)
skb
->
d©a
;

930 ià(
	`uÆik–y
(
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
)) {

931 
skb
->
m¬k
 = 
SLSI_WAKEUP_PKT_MARK
;

932 
	`¦si_rx_upd©e_wake_¡©s
(
sdev
, 
‘h_hdr
, 
skb
->
Ën
);

935 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "ma_unitdata_ind(vif:%d, dest:%pM, src:%pM,id:%d, seq:%d, cipher:%d, discard:%X, is_amsdu:%d, is_tdls:%d)\n",

936 
ndev_vif
->
iâum
,

937 
‘h_hdr
->
h_de¡
,

938 
‘h_hdr
->
h_sourû
,

939 
skb_cb
->
tid
,

940 
skb_cb
->
£q_num
,

941 
skb_cb
->
is_ch”ed
,

942 
skb_cb
->
disÿrd
,

943 
skb_cb
->
is_amsdu
,

944 
skb_cb
->
is_tdls
);

946 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
‘h_hdr
->
h_sourû
);

947 ià(!
³”
) {

948 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (no…eer„ecords)\n");

950 
	`kä“_skb
(
skb
);

955 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
³”
->
cÚÃùed_¡©e
 !ğ
SLSI_STA_CONN_STATE_CONNECTED
) {

956 
	`SLSI_NET_WARN
(
dev
, "Pack‘ drİ³d (³” cÚÃùiÚ‚Ù com¶‘(¡©e:%u))\n", 
³”
->
cÚÃùed_¡©e
);

957 
	`kä“_skb
(
skb
);

962 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && (
	`is_muÉiÿ¡_‘h”_addr
(
‘h_hdr
->
h_de¡
))) {

964 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "MuÉiÿ¡/Brßdÿ¡…ack‘„eûived iÀSTA mode(£q: %dèsk BA\n", 
skb_cb
->
£q_num
);

965 
	`¦si_rx_d©a_d–iv”_skb
(
sdev
, 
dev
, 
skb
, 
çl£
);

973 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && 
³”
->
aid
 < 
SLSI_TDLS_PEER_INDEX_MIN
 && 
skb_cb
->
is_tdls
) {

974 ià(
	`´štk_¿‹lim™
())

975 
	`SLSI_NET_WARN
(
dev
, "Pack‘„eûived from TDLS buˆnØTDLSƒxi¡ (£q: %xèSk BA\n", 
skb_cb
->
£q_num
);

978 
	`¦si_rx_d©a_d–iv”_skb
(
sdev
, 
dev
, 
skb
, 
çl£
);

983 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && 
³”
->
aid
 >ğ
SLSI_TDLS_PEER_INDEX_MIN
 && !
skb_cb
->
is_tdls
) {

984 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "Pack‘„eûived from TDLS…“¸throughhAP(£q: %x)\n", 
skb_cb
->
£q_num
);

985 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

986 ià(!
³”
) {

987 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (AP…eer‚ot found)\n");

988 
	`kä“_skb
(
skb
);

994 ià(
	`¦si_ba_check
(
³”
, 
skb_cb
->
tid
))

995 ià(!
	`¦si_ba_´oûss_äame
(
dev
, 
³”
, 
skb
, 
skb_cb
->
£q_num
, skb_cb->
tid
))

999 
	`¦si_ba_»¶ay_¡Üe_²
(
dev
, 
³”
, 
skb
);

1002 
	`¦si_rx_d©a_d–iv”_skb
(
sdev
, 
dev
, 
skb
, 
çl£
);

1003 
	}
}

1005 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1006 
	$¦si_rx_Çpi_´oûss
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

1008 
Ãt_deviû
 *
dev
;

1009 
Ãtdev_vif
 *
ndev_vif
;

1010 
u16
 
vif
;

1012 
vif
 = 
	`çpi_g‘_vif
(
skb
);

1014 
	`rcu_»ad_lock
();

1015 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1016 ià((
vif
 >ğ
SLSI_NAN_DATA_IFINDEX_START
è&& 
	`çpi_g‘_sigid
(
skb
è=ğ
MA_UNITDATA_IND
) {

1017 
dev
 = 
	`¦si_Çn_g‘_Ãtdev_rcu
(
sdev
, 
skb
);

1019 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

1022 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

1024 ià(!
dev
) {

1025 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

1026 
	`rcu_»ad_uÆock
();

1027  -
EINVAL
;

1029 
	`rcu_»ad_uÆock
();

1031 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1033 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "RX");

1034 
	`çpi_g‘_u16
(
skb
, 
id
)) {

1035 
MA_UNITDATA_IND
:

1036 
	`¦si_rx_d©a_šd
(
sdev
, 
dev
, 
skb
);

1039 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

1040 ià(
	`©omic_»ad
(&
ndev_vif
->
ba_æush
)) {

1041 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 0);

1042 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
Œue
);

1044 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

1047 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "UÃx³ùed D©a: 0x%.4x\n", 
	`çpi_g‘_sigid
(
skb
));

1048 
	`kä“_skb
(
skb
);

1052 
	}
}

1054 
	$¦si_rx_Ãtdev_d©a_wÜk
(
wÜk_¡ruù
 *
wÜk
)

1056 
¦si_skb_wÜk
 *
w
 = 
	`cÚš”_of
(
wÜk
, slsi_skb_work, work);

1057 
¦si_dev
 *
sdev
 = 
w
->sdev;

1058 
Ãt_deviû
 *
dev
 = 
w
->dev;

1059 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1060 
sk_buff
 *
skb
;

1062 ià(
	`WARN_ON
(!
dev
))

1065 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

1068 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1069 ià(!
ndev_vif
->
aùiv©ed
) {

1070 
	`skb_queue_purge
(&
w
->
queue
);

1071 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1075 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

1076 ià(
	`©omic_»ad
(&
ndev_vif
->
ba_æush
)) {

1077 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 0);

1078 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

1080 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

1082 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

1083 ià(!
skb
) {

1084 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1088 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "RX");

1089 
	`çpi_g‘_u16
(
skb
, 
id
)) {

1090 
MA_UNITDATA_IND
:

1091 #ifdeà
CONFIG_SCSC_SMAPPER


1092 ià(
	`¦si_skb_cb_g‘
(
skb
)->
sm­³r_lšked
) {

1093 
u8
 *
äame
 = (u8 *)
	`¦si_h_g‘_skb_d©a_äom_sm­³r
(
sdev
, 
skb
);

1095 ià(
äame
)

1096 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
äame
, 
çl£
);

1098 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
skb
->
d©a
 + 
	`çpi_g‘_sigËn
(skb), 
çl£
);

1101 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
skb
->
d©a
 + 
	`çpi_g‘_sigËn
(skb), 
çl£
);

1103 
	`¦si_rx_d©a_šd
(
sdev
, 
dev
, 
skb
);

1106 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "UÃx³ùed D©a: 0x%.4x\n", 
	`çpi_g‘_sigid
(
skb
));

1107 
	`kä“_skb
(
skb
);

1110 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1112 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1114 
	`¦si_h_»´oûss_sk³d_d©a_bh
(
sdev
);

1116 
	}
}

1118 
	$¦si_rx_queue_d©a
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

1120 
Ãt_deviû
 *
dev
;

1121 
Ãtdev_vif
 *
ndev_vif
;

1122 
vif
;

1124 
vif
 = 
	`çpi_g‘_vif
(
skb
);

1126 
	`rcu_»ad_lock
();

1127 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1128 ià(
vif
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 && 
	`çpi_g‘_sigid
(
skb
è=ğ
MA_UNITDATA_IND
) {

1129 
dev
 = 
	`¦si_Çn_g‘_Ãtdev_rcu
(
sdev
, 
skb
);

1131 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

1134 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

1137 ià(!
dev
) {

1138 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

1139 
	`rcu_»ad_uÆock
();

1140 
”r
;

1142 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1144 
	`¦si_skb_wÜk_’queue
(&
ndev_vif
->
rx_d©a
, 
skb
);

1145 
	`rcu_»ad_uÆock
();

1147 
”r
:

1148  -
EINVAL
;

1149 
	}
}

1152 
	$§p_ma_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

1154 #ifdeà
CONFIG_SCSC_SMAPPER


1155 
u16
 
sig_Ën
;

1156 
u32
 
”r
;

1159 
	`çpi_g‘_sigid
(
skb
)) {

1160 
MA_UNITDATA_IND
:

1161 #ifdeà
CONFIG_SCSC_SMAPPER


1163 ià(
	`¦si_skb_cb_g‘
(
skb
)->
sm­³r_lšked
) {

1164 
sig_Ën
 = 
	`çpi_g‘_sigËn
(
skb
);

1165 
	`skb_puÎ
(
skb
, 
sig_Ën
);

1166 
”r
 = 
	`¦si_h_cÚsume_sm­³r_’Œy
(
sdev
, 
skb
);

1167 
	`skb_push
(
skb
, 
sig_Ën
);

1168 ià(
”r
)

1169  
”r
;

1172 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1173  
	`¦si_rx_Çpi_´oûss
(
sdev
, 
skb
);

1175  
	`¦si_rx_queue_d©a
(
sdev
, 
skb
);

1180 
	`SLSI_ERR_NODEV
("Shouldn't be getting here!\n");

1181  -
EINVAL
;

1182 
	}
}

1185 #ifdeà
CONFIG_SCSC_WLAN_TX_API


1186 
	$§p_ma_txdÚe
(
¦si_dev
 *
sdev
, 
u32
 
cŞour
, 
boŞ
 
mÜe
)

1188  
	`¦si_tx_dÚe
(
sdev
, 
cŞour
, 
mÜe
);

1189 
	}
}

1191 
	$§p_ma_txdÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
)

1193 
Ãt_deviû
 *
dev
;

1194 
¦si_³”
 *
³”
;

1196 
	`rcu_»ad_lock
();

1197 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

1199 ià(!
dev
) {

1200 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

1201 
	`rcu_»ad_uÆock
();

1202  -
EINVAL
;

1204 
	`rcu_»ad_uÆock
();

1206 ià(
³”_šdex
 <ğ
SLSI_PEER_INDEX_MAX
) {

1208 ià(
³”_šdex
 == 0) {

1209 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1211  
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
ac
, 
sdev
, 
vif
, 
³”_šdex
);

1213 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
	`MAP_AID_TO_QS
(
³”_šdex
));

1214 ià(
³”
)

1215  
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
³”
->
d©a_qs
, 
ac
, 
sdev
, 
vif
, 
³”_šdex
);

1217 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "³”„ecÜd NOT found fÜ vif=%d…“r_šdex=%d\n", 
vif
, 
³”_šdex
);

1221  
	`scsc_wifi_fcq_»ûive_d©a_no_³”
(
dev
, 
ac
, 
sdev
, 
vif
, 
³”_šdex
);

1223 
	`SLSI_ERR
(
sdev
, "Ëg®…“r_šdex vif=%d…“r_šdex=%d\n", 
vif
, 
³”_šdex
);

1224  -
EINVAL
;

1225 
	}
}

1228 
	$§p_ma_š™
()

1230 
	`SLSI_INFO_NODEV
("Registering SAP\n");

1231 
	`¦si_h_§p_»gi¡”
(&
§p_ma
);

1233 
	}
}

1235 
	$§p_ma_deš™
()

1237 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

1238 
	`¦si_h_§p_uÄegi¡”
(&
§p_ma
);

1240 
	}
}

	@sap_ma.h

8 #iâdeà
__SAP_MA_H__


9 
	#__SAP_MA_H__


	)

11 
§p_ma_š™
();

12 
§p_ma_deš™
();

	@sap_mlme.c

6 
	~<lšux/ty³s.h
>

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"§p.h
"

10 
	~"§p_mlme.h
"

11 
	~"h.h
"

12 
	~"mgt.h
"

13 
	~"scsc_wifogg”_ršg_pktç‹_­i.h
"

14 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


15 
	~"scsc_wifogg”_ršgs.h
"

17 
	~"Æ80211_v’dÜ.h
"

18 
	~"mlme.h
"

20 #ifdeà
CONFIG_SCSC_WLAN_TX_API


21 
	~"tx_­i.h
"

24 
	#SUPPORTED_OLD_VERSION
 0

	)

26 
§p_mlme_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

27 
§p_mlme_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

29 
§p_mlme_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
);

31 
§p_­i
 
	g§p_mlme
 = {

32 .
§p_şass
 = 
SAP_MLME
,

33 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_mlme_v”siÚ_suµÜ‹d
,

34 .
	g§p_hªdËr
 = 
§p_mlme_rx_hªdËr
,

35 .
	g§p_v”siÚs
 = { 
FAPI_CONTROL_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

36 .
	g§p_nÙif›r
 = 
§p_mlme_nÙif›r
,

39 
	$§p_mlme_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
)

41 
i
;

42 
Ãt_deviû
 *
dev
;

43 
Ëv–
;

44 
Ãtdev_vif
 *
ndev_vif
;

45 
boŞ
 
is_»cov”y
 = 
çl£
;

47 
	`SLSI_INFO_NODEV
("NÙif›¸ev’ˆ»ûived: %lu\n", 
ev’t
);

48 ià(
ev’t
 >ğ
SCSC_MAX_NOTIFIER
)

49  -
EIO
;

51 
ev’t
) {

52 
SCSC_WIFI_STOP
:

54 
sdev
->
mlme_blocked
 = 
Œue
;

55 
sdev
->
d‘eù_vif_aùive
 = 
çl£
;

57 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

58 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

59 
	`SLSI_INFO_NODEV
("MLME BLOCKED sy¡emƒ¼Ü†ev–:%d\n", 
Ëv–
);

60 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

61 
is_»cov”y
 = 
Œue
;

62 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

64 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

65 ià(
sdev
->
Ãtdev
[
i
]) {

66 
boŞ
 
vif_ty³_­
 = 
çl£
;

67 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

68 
	`com¶‘e_®l
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

69 
	`¦si_sÿn_ş—nup
(
sdev
, sdev->
Ãtdev
[
i
]);

70 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

71 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

73 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 && 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

74 
vif_ty³_­
 = 
Œue
;

75 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

76 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

77 
	`¦si_vif_ş—nup
(
sdev
, sdev->
Ãtdev
[
i
], 0, 
is_»cov”y
);

78 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 && 
vif_ty³_­
)

79 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_AP
;

80 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

81 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
è&&‡tomic_»ad(&
sdev
->
ù¾_·u£_¡©e
))

82 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

83 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

85 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

87 #ià!
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è&& defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

88 ià(
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è&&‡tomic_»ad(&sdev->
ù¾_·u£_¡©e
))

89 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

90 
	`©omic_£t
(&
sdev
->
¬p_tx_couÁ
, 0);

92 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

93 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPING
;

94 ià(
sdev
->
Ãtdev_up_couÁ
 == 0)

95 
sdev
->
mlme_blocked
 = 
çl£
;

96 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

97 
	`SLSI_INFO_NODEV
("Force cleaned‡ll VIFs\n");

100 
SCSC_WIFI_FAILURE_RESET
:

101 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

102 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 || 
sdev
->
»quœe_£rviû_şo£
) {

103 
	`SLSI_INFO
(
sdev
, "E¼Ü Lev–:%d, s¹„ecov”y_wÜk_Ú_¡İ queue!!\n", 
Ëv–
);

104 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
»cov”y_wÜk_Ú_¡İ
);

108 
SCSC_WIFI_SUSPEND
:

109 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

110 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

111 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

112 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
)

113 
	`SLSI_NET_INFO
(
dev
, "SUSPEND PS MODE‚dev_vif->pow”_mode:%d\n", 
ndev_vif
->
pow”_mode
);

114 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

116 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

117 ià(!(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
è|| (sdev->deviû_cÚfig.
ho¡_¡©e
 & 
SLSI_HOSTSTATE_LCD_ACTIVE
)) {

118 
	`SLSI_WARN
(
sdev
, "SUSPEND but‚o SETSUSPENDMODE\n");

119 
	`SLSI_INFO
(
sdev
, "UserSuspendMode:%d HostState:%0.2x\n",

120 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
, sdev->deviû_cÚfig.
ho¡_¡©e
);

122 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

125 
SCSC_WIFI_RESUME
:

126 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

127 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

128 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

129 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
)

130 
	`SLSI_NET_INFO
(
dev
, "RESUME PS MODE‚dev_vif->pow”_mode:%d\n", 
ndev_vif
->
pow”_mode
);

131 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

132 ià(
ndev_vif
->
is_ws_ruÂšg
 &&‚dev_vif->
aùiv©ed
 &&

133 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

134 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

135 
ndev_vif
->
is_ws_ruÂšg
 = 
çl£
;

137 
	`¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
sdev
, 
dev
,

138 
SLSI_FORWARD_BEACON_ABORT_REASON_SUSPENDED
);

139 
	`SLSI_INFO_NODEV
("FORWARD_BEACON: SUSPEND_RESUMED!! send‡bortƒvent\n");

142 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

144 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

145 ià(!(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
è|| (sdev->deviû_cÚfig.
ho¡_¡©e
 & 
SLSI_HOSTSTATE_LCD_ACTIVE
)) {

146 
	`SLSI_WARN
(
sdev
, "RESUME but‚o SETSUSPENDMODE\n");

147 
	`SLSI_INFO
(
sdev
, "UserSuspendMode:%d HostState:%0.2x\n",

148 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
, sdev->deviû_cÚfig.
ho¡_¡©e
);

150 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

152 
SCSC_WIFI_SUBSYSTEM_RESET
:

154 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
»cov”y_wÜk
);

156 
SCSC_WIFI_CHIP_READY
:

157 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

158 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 && 
sdev
->
Ãtdev_up_couÁ
 != 0)

159 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
»cov”y_wÜk_Ú_¡¬t
);

162 
	`SLSI_INFO_NODEV
("UnknowÀev’ˆcod%lu\n", 
ev’t
);

167 
	}
}

169 
	$§p_mlme_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

171 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

172 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

173 
u8
 
i
 = 0;

175 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

177 
i
 = 0; i < 
SAP_MAX_VER
; i++)

178 ià(
	`SAP_MAJOR
(
§p_mlme
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

181 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

183  -
EINVAL
;

184 
	}
}

186 
	$¦si_rx_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

188 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

192 
id
) {

193 
MLME_SCAN_IND
:

194 
	`¦si_rx_sÿn_šd
(
sdev
, 
dev
, 
skb
);

196 
MLME_SCAN_DONE_IND
:

197 
	`¦si_rx_sÿn_dÚe_šd
(
sdev
, 
dev
, 
skb
);

199 
MLME_CONNECT_IND
:

200 
	`¦si_rx_cÚÃù_šd
(
sdev
, 
dev
, 
skb
);

202 
MLME_CONNECTED_IND
:

203 
	`¦si_rx_cÚÃùed_šd
(
sdev
, 
dev
, 
skb
);

205 
MLME_RECEIVED_FRAME_IND
:

206 
	`¦si_rx_»ûived_äame_šd
(
sdev
, 
dev
, 
skb
);

208 
MLME_DISCONNECTED_IND
:

209 
	`¦si_rx_discÚÃùed_šd
(
sdev
, 
dev
, 
skb
);

211 
MLME_PROCEDURE_STARTED_IND
:

212 
	`¦si_rx_´oûdu»_¡¬‹d_šd
(
sdev
, 
dev
, 
skb
);

214 
MLME_FRAME_TRANSMISSION_IND
:

215 
	`¦si_rx_äame_ŒªsmissiÚ_šd
(
sdev
, 
dev
, 
skb
);

217 
MLME_BLOCKACK_ACTION_IND
:

218 
MA_BLOCKACKREQ_IND
:

219 
	`¦si_rx_blockack_šd
(
sdev
, 
dev
, 
skb
);

221 
MLME_ROAMED_IND
:

222 
	`¦si_rx_rßmed_šd
(
sdev
, 
dev
, 
skb
);

224 
MLME_ROAM_IND
:

225 
	`¦si_rx_rßm_šd
(
sdev
, 
dev
, 
skb
);

227 
MLME_MIC_FAILURE_IND
:

228 
	`¦si_rx_mic_çu»_šd
(
sdev
, 
dev
, 
skb
);

230 
MLME_REASSOCIATE_IND
:

231 
	`¦si_rx_»assoc_šd
(
sdev
, 
dev
, 
skb
);

233 
MLME_TDLS_PEER_IND
:

234 
	`¦si_tdls_³”_šd
(
sdev
, 
dev
, 
skb
);

236 
MLME_LISTEN_END_IND
:

237 
	`¦si_rx_li¡’_’d_šd
(
dev
, 
skb
);

239 
MLME_CHANNEL_SWITCHED_IND
:

240 
	`¦si_rx_chªÃl_sw™ched_šd
(
sdev
, 
dev
, 
skb
);

242 
MLME_AC_PRIORITY_UPDATE_IND
:

243 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
,

245 
	`kä“_skb
(
skb
);

247 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


248 
MLME_RSSI_REPORT_IND
:

249 
	`¦si_rx_rssi_»pÜt_šd
(
sdev
, 
dev
, 
skb
);

251 
MLME_RANGE_IND
:

252 
	`¦si_rx_¿nge_šd
(
sdev
, 
dev
, 
skb
);

254 
MLME_RANGE_DONE_IND
:

255 
	`¦si_rx_¿nge_dÚe_šd
(
sdev
, 
dev
, 
skb
);

257 
MLME_EVENT_LOG_IND
:

258 
	`¦si_rx_ev’t_log_šdiÿtiÚ
(
sdev
, 
dev
, 
skb
);

261 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


262 
MLME_NAN_EVENT_IND
:

263 
	`¦si_Çn_ev’t
(
sdev
, 
dev
, 
skb
);

265 
MLME_NAN_FOLLOWUP_IND
:

266 
	`¦si_Çn_fŞlowup_šd
(
sdev
, 
dev
, 
skb
);

268 
MLME_NAN_SERVICE_IND
:

269 
	`¦si_Çn_£rviû_šd
(
sdev
, 
dev
, 
skb
);

271 
MLME_NDP_REQUEST_IND
:

272 
	`¦si_Çn_ndp_£tup_šd
(
sdev
, 
dev
, 
skb
, 
Œue
);

274 
MLME_NDP_REQUESTED_IND
:

275 
	`¦si_Çn_ndp_»que¡ed_šd
(
sdev
, 
dev
, 
skb
);

277 
MLME_NDP_RESPONSE_IND
:

278 
	`¦si_Çn_ndp_£tup_šd
(
sdev
, 
dev
, 
skb
, 
çl£
);

280 
MLME_NDP_TERMINATED_IND
:

281 
	`¦si_Çn_ndp_‹rmš©iÚ_šd
(
sdev
, 
dev
, 
skb
);

283 
MLME_NAN_RANGE_IND
:

284 
	`¦si_rx_Çn_¿nge_šd
(
sdev
, 
dev
, 
skb
);

287 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


288 
MLME_SYNCHRONISED_IND
:

289 
	`¦si_rx_synchrÚi£d_šd
(
sdev
, 
dev
, 
skb
);

292 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

293 
MLME_BEACON_REPORTING_EVENT_IND
:

294 
	`¦si_rx_b—cÚ_»pÜtšg_ev’t_šd
(
sdev
, 
dev
, 
skb
);

297 
MLME_BLACKLISTED_IND
:

298 
	`¦si_rx_bÏckli¡ed_šd
(
sdev
, 
dev
, 
skb
);

300 
MLME_ROAMING_CHANNEL_LIST_IND
:

301 
	`¦si_rx_rş_šd
(
sdev
, 
dev
, 
skb
);

303 #ià
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è|| defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

304 
MLME_SEND_FRAME_CFM
:

305 #ià
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
)

306 
	`¦si_tx_mlme_cfm
(
sdev
, 
dev
, 
skb
);

307 
	`kä“
(
skb
);

309 
	`¦si_rx_£nd_äame_cfm_async
(
sdev
, 
dev
, 
skb
);

313 
MLME_START_DETECT_IND
:

314 
	`¦si_rx_¡¬t_d‘eù_šd
(
sdev
, 
dev
, 
skb
);

316 
SAP_DRV_MA_TO_MLME_DELBA_REQ
:

317 
	`¦si_rx_ma_to_mlme_d–ba_»q
(
sdev
, 
dev
, 
skb
);

320 
	`kä“_skb
(
skb
);

321 
	`SLSI_NET_ERR
(
dev
, "UnhªdËd Ind/Cfm: 0x%.4x\n", 
id
);

325 
	}
}

327 
	$¦si_rx_Ãtdev_mlme_wÜk
(
wÜk_¡ruù
 *
wÜk
)

329 
¦si_skb_wÜk
 *
w
 = 
	`cÚš”_of
(
wÜk
, slsi_skb_work, work);

330 
¦si_dev
 *
sdev
 = 
w
->sdev;

331 
Ãt_deviû
 *
dev
 = 
w
->dev;

332 
sk_buff
 *
skb
 = 
NULL
;

333 #ifdeà
CONFIG_SCSC_WLAN_DEBUG_MLME_WORK_STRUCT


334 
¦si_dev
 *
Üg_sdev
 = 
	`¦si_g‘_sdev
();

335 
¥šlock_t
 *
w_lock
 = &
w
->
queue
.
lock
;

336 vŞ©
¥šlock_t
 *
lock
 = 
NULL
;

338 ià(
w
->
sdev
 !ğ
Üg_sdev
) {

339 
	`SLSI_INFO_NODEV
("Deliberately…aniche kernel dueo corrupted worker struct\n");

340 
	`SLSI_INFO_NODEV
("calling BUG_ON(1)\n");

341 
	`BUG_ON
(1);

344 ià(
	`WARN_ON
(!
dev
))

346 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

348 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl_mlme_evt
);

349 
skb
) {

350 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "RX");

351 
	`¦si_rx_Ãtdev_mlme
(
sdev
, 
dev
, 
skb
);

352 #ifdeà
CONFIG_SCSC_WLAN_DEBUG_MLME_WORK_STRUCT


353 
lock
 = &
w
->
queue
.lock;

354 ià(
w_lock
 !ğ
lock
) {

355 
	`SLSI_INFO_NODEV
("Deliberately…aniche kernel dueo corrupted†ock‡ddress\n");

356 
	`SLSI_INFO_NODEV
("calling BUG_ON(1)\n");

357 
	`BUG_ON
(1);

360 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

362 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_mlme_evt
);

363 
	}
}

365 
	$¦si_rx_’queue_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 
vif
)

367 
Ãt_deviû
 *
dev
;

368 
Ãtdev_vif
 *
ndev_vif
;

369 #ifdeà
CONFIG_SCSC_WLAN_DEBUG_MLME_WORK_STRUCT


370 
¦si_dev
 *
Üg_sdev
 = 
	`¦si_g‘_sdev
();

372 ià(
sdev
 !ğ
Üg_sdev
) {

373 
	`SLSI_INFO_NODEV
("Deliberately…aniche kernel dueo memory corruption\n");

374 
	`SLSI_INFO_NODEV
("calling BUG_ON(1)\n");

375 
	`BUG_ON
(1);

379 
	`rcu_»ad_lock
();

380 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


381 ià(
vif
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 &&

382 (
	`çpi_g‘_sigid
(
skb
è=ğ
MA_BLOCKACKREQ_IND
 || f­i_g‘_sigid(skbè=ğ
MLME_BLOCKACK_ACTION_IND
))

383 
dev
 = 
	`¦si_Çn_g‘_Ãtdev_rcu
(
sdev
, 
skb
);

385 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

387 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

391 ià(!
dev
) {

392 ià(
vif
 <ğ
SLSI_NAN_DATA_IFINDEX_START
)

393 
	`SLSI_WARN
(
sdev
, "dev is NULL");

394 
	`kä“_skb
(
skb
);

395 
	`rcu_»ad_uÆock
();

399 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

401 ià(
	`uÆik–y
(
ndev_vif
->
is_fw_‹¡
)) {

402 
	`kä“_skb
(
skb
);

403 
	`rcu_»ad_uÆock
();

407 
	`¦si_skb_wÜk_’queue
(&
ndev_vif
->
rx_mlme
, 
skb
);

408 
	`rcu_»ad_uÆock
();

410 
	}
}

412 
	$¦si_rx_aùiÚ_’queue_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 
vif
)

414 
Ãt_deviû
 *
dev
;

415 
Ãtdev_vif
 *
ndev_vif
;

417 
	`rcu_»ad_lock
();

418 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

419 ià(
	`WARN_ON
(!
dev
)) {

420 
	`rcu_»ad_uÆock
();

421  -
ENODEV
;

424 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

426 ià(
	`uÆik–y
(
ndev_vif
->
is_fw_‹¡
)) {

427 
	`rcu_»ad_uÆock
();

431 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
 ||‚dev_vif->iáy³ =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

432 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

434 ià(
	`memcmp
(
mgmt
->
da
, 
dev
->
dev_addr
, 
ETH_ALEN
) != 0) {

435 
Ãt_deviû
 *
p2pdev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
SLSI_NET_INDEX_P2P
);

437 ià(
	`WARN_ON
(!
p2pdev
)) {

438 
	`rcu_»ad_uÆock
();

439  -
ENODEV
;

441 ià(
	`memcmp
(
mgmt
->
da
, 
p2pdev
->
dev_addr
, 
ETH_ALEN
) == 0) {

446 
ndev_vif
 = 
	`Ãtdev_´iv
(
p2pdev
);

448 ià(
	`uÆik–y
(
ndev_vif
->
is_fw_‹¡
)) {

449 
	`kä“_skb
(
skb
);

450 
	`rcu_»ad_uÆock
();

457 
	`¦si_skb_wÜk_’queue
(&
ndev_vif
->
rx_mlme
, 
skb
);

459 
	`rcu_»ad_uÆock
();

461 
	}
}

463 
	$§p_mlme_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

465 
u16
 
sÿn_id
;

466 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

468 ià(
	`¦si_rx_blockšg_sigÇls
(
sdev
, 
skb
) == 0)

471 ià(
	`çpi_is_šd
(
skb
)) {

472 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

473 
	`SCSC_WLOG_PKTFATE_LOG_RX_CTRL_FRAME
(
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb));

476 
	`çpi_g‘_sigid
(
skb
)) {

477 
MLME_SCAN_DONE_IND
:

478 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_dÚe_šd
.scan_id);

479 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


480 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
))

481  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

483  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, (
sÿn_id
 >> 8));

484 
MLME_SCAN_IND
:

485 ià(
vif
)

486  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

487 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.scan_id);

488 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


489 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
))

490  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

492  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, (
sÿn_id
 >> 8));

493 
MLME_RECEIVED_FRAME_IND
:

494 ià(
vif
 == 0) {

495 
	`SLSI_WARN
(
sdev
, "MLME_RECEIVED_FRAME_IND VIF 0\n");

496 
”r
;

498  
	`¦si_rx_aùiÚ_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

499 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


500 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


501 
MLME_NAN_EVENT_IND
:

502 
MLME_NAN_FOLLOWUP_IND
:

503 
MLME_NAN_SERVICE_IND
:

504 
MLME_NDP_REQUEST_IND
:

505 
MLME_NDP_REQUESTED_IND
:

506 
MLME_NDP_RESPONSE_IND
:

507 
MLME_NDP_TERMINATED_IND
:

508 
MLME_NAN_RANGE_IND
:

509  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

511 
MLME_RANGE_IND
:

512 
MLME_RANGE_DONE_IND
:

513 ià(
vif
 == 0)

514  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

516  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

518 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


519 
MLME_EVENT_LOG_IND
:

520  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

522 
MLME_START_DETECT_IND
:

523  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

524 
MLME_ROAMED_IND
:

525 ià(
vif
 == 0) {

526 
	`SLSI_WARN
(
sdev
, "MLME_ROAMED_IND VIF 0\n");

527 
”r
;

529 
Ãt_deviû
 *
dev
;

530 
Ãtdev_vif
 *
ndev_vif
;

532 
	`rcu_»ad_lock
();

533 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

534 ià(
	`WARN_ON
(!
dev
)) {

535 
	`rcu_»ad_uÆock
();

536  -
ENODEV
;

538 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

539 ià(
	`©omic_»ad
(&
ndev_vif
->
¡a
.
drİ_rßmed_šd
)) {

543 
	`kä“_skb
(
skb
);

544 
	`rcu_»ad_uÆock
();

547 
	`rcu_»ad_uÆock
();

548  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

551 ià(
vif
 == 0) {

552 
	`SLSI_WARN
(
sdev
, "Reûived sigÇÈ0x%04x oÀVIF 0,„‘uºƒ¼Ü\n", 
	`çpi_g‘_sigid
(
skb
));

553 
”r
;

555  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

560 ià(
	`çpi_is_cfm
(
skb
è&& 
	`çpi_g‘_sigid
(skbè=ğ
MLME_SEND_FRAME_CFM
 && 
vif
 != 0) {

561 #ià
	`defšed
(
CONFIG_SCSC_WLAN_TX_API
è|| defšed(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

562 
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

564 
	`kä“_skb
(
skb
);

569 ià(
	`WARN_ON
(
	`çpi_is_»q
(
skb
)))

570 
”r
;

572 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

573 
	`kä“_skb
(
skb
);

577 
	`WARN_ON
(1);

579 
”r
:

580  -
EINVAL
;

581 
	}
}

583 
	$¦si_g‘_çpi_v”siÚ_¡ršg
(*
»s
)

585 
couÁ
 = 0;

587 
couÁ
 = 
	`¢´štf
(
»s
, 100, "FAPI_CONTROL_SAP_VERSION : %d.%d.%d\n",

588 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

589 
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

590 
FAPI_CONTROL_SAP_ENG_VERSION
);

591 
»s
[
couÁ
] = '\0';

592 
	}
}

594 
	$§p_mlme_š™
()

596 
	`SLSI_INFO_NODEV
("Registering SAP\n");

597 
	`¦si_h_§p_»gi¡”
(&
§p_mlme
);

599 
	}
}

601 
	$§p_mlme_deš™
()

603 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

604 
	`¦si_h_§p_uÄegi¡”
(&
§p_mlme
);

606 
	}
}

	@sap_mlme.h

8 #iâdeà
__SAP_MLME_H__


9 
	#__SAP_MLME_H__


	)

11 
§p_mlme_š™
();

12 
§p_mlme_deš™
();

15 
¦si_rx_sÿn_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

16 #ià
defšed
 
CONFIG_SLSI_WLAN_STA_FWD_BEACON
 && (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

17 
¦si_rx_b—cÚ_»pÜtšg_ev’t_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

19 
¦si_rx_sÿn_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

20 
¦si_rx_chªÃl_sw™ched_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

21 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


22 
¦si_rx_synchrÚi£d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

24 
¦si_rx_bÏckli¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

25 
¦si_rx_cÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

26 
¦si_rx_cÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

27 
¦si_rx_»ûived_äame_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

28 
¦si_rx_discÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

29 
¦si_rx_discÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

30 
¦si_rx_´oûdu»_¡¬‹d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

31 
¦si_rx_äame_ŒªsmissiÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

32 
¦si_rx_rßmed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

33 
¦si_rx_rßm_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

34 
¦si_rx_mic_çu»_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

35 
¦si_rx_»assoc_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

36 
¦si_tdls_³”_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

37 
¦si_rx_li¡’_’d_šd
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

38 
¦si_rx_blockack_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

39 
¦si_rx_ma_to_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

40 
¦si_rx_¡¬t_d‘eù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

41 
¦si_rx_rş_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

42 
¦si_g‘_çpi_v”siÚ_¡ršg
(*
»s
);

	@sap_test.c

6 
	~<lšux/ty³s.h
>

7 
	~"dev.h
"

8 
	~"§p.h
"

9 
	~"§p_‹¡.h
"

10 
	~"h.h
"

12 
	~"debug.h
"

14 
	#SUPPORTED_OLD_VERSION
 0

	)

16 
§p_‹¡_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

17 
§p_‹¡_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

19 
§p_­i
 
	g§p_‹¡
 = {

20 .
§p_şass
 = 
SAP_TST
,

21 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_‹¡_v”siÚ_suµÜ‹d
,

22 .
	g§p_hªdËr
 = 
§p_‹¡_rx_hªdËr
,

23 .
	g§p_v”siÚs
 = { 
FAPI_TEST_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

26 
	$§p_‹¡_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

28 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

29 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

30 
u8
 
i
 = 0;

32 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

34 
i
 = 0; i < 
SAP_MAX_VER
; i++)

35 ià(
	`SAP_MAJOR
(
§p_‹¡
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

38 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

40  -
EINVAL
;

41 
	}
}

43 
	$§p_‹¡_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

45 ià(
	`¦si_rx_blockšg_sigÇls
(
sdev
, 
skb
) == 0)

48 
	`SLSI_INFO_NODEV
("TEST SAP‚ot implemented\n");

50 
	`kä“_skb
(
skb
);

53 
	}
}

55 
	$§p_‹¡_š™
()

57 
	`SLSI_INFO_NODEV
("Registering SAP\n");

58 
	`¦si_h_§p_»gi¡”
(&
§p_‹¡
);

60 
	}
}

62 
	$§p_‹¡_deš™
()

64 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

65 
	`¦si_h_§p_uÄegi¡”
(&
§p_‹¡
);

67 
	}
}

	@sap_test.h

8 #iâdeà
__SAP_TEST_H__


9 
	#__SAP_TEST_H__


	)

11 
§p_‹¡_š™
();

12 
§p_‹¡_deš™
();

	@scsc_wifi_cm_if.h

7 #iâdeà
__SCSC_WIFI_CM_IF_H__


8 
	#__SCSC_WIFI_CM_IF_H__


	)

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/deviû.h
>

12 
	~<lšux/k»f.h
>

14 
	~<scsc/scsc_mx.h
>

16 
	#SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 8

	)

18 
	g¦si_dev
;

32 
	escsc_wifi_cm_if_¡©e
 {

33 
	mSCSC_WIFI_CM_IF_STATE_STOPPED
,

34 
	mSCSC_WIFI_CM_IF_STATE_PROBING
,

35 
	mSCSC_WIFI_CM_IF_STATE_PROBED
,

36 
	mSCSC_WIFI_CM_IF_STATE_STARTING
,

37 
	mSCSC_WIFI_CM_IF_STATE_STARTED
,

38 
	mSCSC_WIFI_CM_IF_STATE_STOPPING
,

39 
	mSCSC_WIFI_CM_IF_STATE_REMOVING
,

40 
	mSCSC_WIFI_CM_IF_STATE_REMOVED
,

41 
	mSCSC_WIFI_CM_IF_STATE_BLOCKED


51 
	escsc_wifi_cm_if_nÙif›r
 {

52 
	mSCSC_WIFI_STOP
,

53 
	mSCSC_WIFI_FAILURE_RESET
,

54 
	mSCSC_WIFI_SUSPEND
,

55 
	mSCSC_WIFI_RESUME
,

56 
	mSCSC_WIFI_SUBSYSTEM_RESET
,

57 
	mSCSC_WIFI_CHIP_READY
,

58 
	mSCSC_MAX_NOTIFIER


61 
	sscsc_wifi_cm_if
 {

62 
¦si_dev
 *
	msdev
;

64 
mu‹x
 
	mcm_if_mu‹x
;

66 
k»f
 
	mk»f
;

69 
©omic_t
 
	mcm_if_¡©e
;

71 
	m»cov”y_¡©e
;

73 
©omic_t
 
	m»£t_Ëv–
;

81 
¦si_dev
 *
¦si_dev_©ch
(
deviû
 *
dev
, 
scsc_mx
 *
cÜe
, 
scsc_£rviû_ş›Á
 *
mx_wÏn_ş›Á
);

82 
¦si_dev_d‘ach
(
¦si_dev
 *
sdev
);

87 
¦si_sm_£rviû_driv”_»gi¡”
();

88 
¦si_sm_£rviû_driv”_uÄegi¡”
();

89 
¦si_sm_£rviû_çed
(
¦si_dev
 *
sdev
, cÚ¡ *
»asÚ
, 
boŞ
 
is_wÜk
);

90 
¦si_sm_wÏn_£rviû_İ’
(
¦si_dev
 *
sdev
);

91 
¦si_sm_wÏn_£rviû_¡¬t
(
¦si_dev
 *
sdev
);

92 
¦si_sm_wÏn_£rviû_¡İ
(
¦si_dev
 *
sdev
);

93 
¦si_sm_wÏn_£rviû_şo£
(
¦si_dev
 *
sdev
);

94 
¦si_wÏn_£rviû_nÙif›r_»gi¡”
(
nÙif›r_block
 *
nb
);

95 
¦si_wÏn_£rviû_nÙif›r_uÄegi¡”
(
nÙif›r_block
 *
nb
);

96 
¦si_sm_»cov”y_£rviû_¡İ
(
¦si_dev
 *
sdev
);

97 
¦si_sm_»cov”y_£rviû_şo£
(
¦si_dev
 *
sdev
);

98 
¦si_sm_»cov”y_£rviû_İ’
(
¦si_dev
 *
sdev
);

99 
¦si_sm_»cov”y_£rviû_¡¬t
(
¦si_dev
 *
sdev
);

	@scsc_wifi_fcq.c

7 
	~"scsc_wifi_fcq.h
"

8 
	~"debug.h
"

9 
	~"dev.h
"

10 
	~"h4_§m¶”.h
"

38 
ušt
 
	gscsc_wifi_fcq_smod
 = 512;

39 
moduË_·¿m
(
scsc_wifi_fcq_smod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

40 
MODULE_PARM_DESC
(
scsc_wifi_fcq_smod
, "Initial value of unicast smod -…eer‚ormal (default = 500)");

42 
ušt
 
	gscsc_wifi_fcq_mÿ¡_smod
 = 100;

43 
moduË_·¿m
(
scsc_wifi_fcq_mÿ¡_smod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

44 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mÿ¡_smod
, "Initial value of multicast smod -…eer‚ormal (default = 100)");

46 
ušt
 
	gscsc_wifi_fcq_smod_pow”
 = 4;

47 
moduË_·¿m
(
scsc_wifi_fcq_smod_pow”
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

48 
MODULE_PARM_DESC
(
scsc_wifi_fcq_smod_pow”
, "Initial…owersave SMOD value -…eer…owersave (default = 4)");

50 
ušt
 
	gscsc_wifi_fcq_mÿ¡_smod_pow”
 = 4;

51 
moduË_·¿m
(
scsc_wifi_fcq_mÿ¡_smod_pow”
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

52 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mÿ¡_smod_pow”
, "Initial value of…owersave multicast smod -…eer‚ormal (default = 4)");

54 
ušt
 
	gscsc_wifi_fcq_qmod
 = 512;

55 
moduË_·¿m
(
scsc_wifi_fcq_qmod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

56 
MODULE_PARM_DESC
(
scsc_wifi_fcq_qmod
, "Initial value of unicast qmod -…eer‚ormal (default = 500)");

58 
ušt
 
	gscsc_wifi_fcq_mÿ¡_qmod
 = 100;

59 
moduË_·¿m
(
scsc_wifi_fcq_mÿ¡_qmod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

60 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mÿ¡_qmod
, "Initial value of multicast qmod -…eer‚ormal (default = 100)");

62 
ušt
 
	gscsc_wifi_fcq_mšimum_smod
 = 50;

63 
moduË_·¿m
(
scsc_wifi_fcq_mšimum_smod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

64 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mšimum_smod
, "Initial value of minimum smod -…eer‚ormal (default = 50)");

66 
ušt
 
	gscsc_wifi_fcq_di¡ributiÚ_d–ay_ms
;

67 
moduË_·¿m
(
scsc_wifi_fcq_di¡ributiÚ_d–ay_ms
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

68 
MODULE_PARM_DESC
(
scsc_wifi_fcq_di¡ributiÚ_d–ay_ms
, "Distributionime in ms (default = 0)");

70 
	#SCSC_WIFI_FCQ_SMOD_RESUME_HYSTERESIS
 10

	)

71 
	#SCSC_WIFI_FCQ_QMOD_RESUME_HYSTERESIS
 10

	)

72 
	#SCSC_WIFI_FCQ_GMOD_RESUME_HYSTERESIS
 30

	)

75 
	#STOP_GUARD_GMOD
 10

	)

76 
	#STOP_GUARD_SMOD
 1

	)

77 
	#STOP_GUARD_QMOD
 2

	)

84 
	s³”s_ÿche
 {

85 
li¡_h—d
 
	mli¡
;

86 
Ãt_deviû
 *
	mdev
;

87 
	mvif
;

88 
	m³”_šdex
;

89 
scsc_wifi_fcq_d©a_q£t
 *
	mqs
;

90 
boŞ
 
	mis_uniÿ¡
;

93 
LIST_HEAD
(
³”s_ÿche_li¡
);

94 
DEFINE_SPINLOCK
(
³”s_ÿche_lock
);

99 
u32
 
	gac_q_Ïyout
[8][4] = {

113 
	#ENABLE_QCOD
 1

	)

114 #ià
IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

116 
	#DOMAINS
 3

	)

117 
	#DOMAIN_G
 0

	)

118 
	#DOMAIN_S
 1

	)

119 
	#DOMAIN_Q
 2

	)

121 
	#DIREC
 2

	)

122 
	#DIREC_TX
 0

	)

123 
	#DIREC_RX
 1

	)

125 
	#AC_Q
 4

	)

127 
	gtd
[
DIREC
][
DOMAINS
][
AC_Q
];

129 
šlše
 
	$fcq_upd©e_couÁ”s
(
dœeùiÚ
, 
domaš
, 
ac
)

131 
td
[
dœeùiÚ
][
domaš
][
ac
] =d[direction][domain][ac] + 1;

132 
	}
}

140 
	gtÙ®
;

142 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


144 
	gtÙ®_š_¦“p
;

147 
šlše
 
boŞ
 
	$is_gmod_aùive
(
¦si_dev
 *
sdev
)

149  
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
);

150 
	}
}

152 
šlše
 
boŞ
 
	$is_smod_aùive
(
scsc_wifi_fcq_d©a_q£t
 *
qs
)

154  
	`©omic_»ad
(&
qs
->
aùive
);

155 
	}
}

157 
šlše
 
boŞ
 
	$is_qmod_aùive
(
scsc_wifi_fcq_d©a_q
 *
queue
)

159  
	`©omic_»ad
(&
queue
->
h—d
.
aùive
);

160 
	}
}

162 
šlše
 
boŞ
 
	$is_š_·u£
(
¦si_dev
 *
sdev
)

164  
	`©omic_»ad
(&
sdev
->
š_·u£_¡©e
);

165 
	}
}

167 
šlše
 
	$fcq_Ãtq_¡¬t_¡İ_§m¶e
(
scsc_wifi_fcq_q_h—d”
 *
queue
, 
boŞ
 
Ãw_¡©e
)

169 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
;

170 
u32
 
d–_š_ms
 = 0;

172 ià(
	`WARN_ON
(!
queue
))

175 
queue_¡©
 = &
queue
->
¡©s
;

177 ià(
	`ktime_to_ms
(
queue_¡©
->
Ï¡_§m¶e_time
) == 0)

178 
queue_¡©
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

181 ià(
queue_¡©
->
Ãtq_¡©e
 =ğ
Ãw_¡©e
)

184 
queue_¡©
->
Ãtq_¡©e
 = 
Ãw_¡©e
;

190 ià(
Ãw_¡©e
)

191 
queue_¡©
->
Ãtq_¡İ_time_š_ms
 +ğ
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), queue_¡©->
Ï¡_¡İ_time
));

193 
queue_¡©
->
Ï¡_¡İ_time
 = 
	`ktime_g‘
();

196 ià(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
queue_¡©
->
Ï¡_§m¶e_time
)) > 1000) {

198 
d–_š_ms
 = 
	`ktime_ms_d–
(
	`ktime_g‘
(), 
queue_¡©
->
Ï¡_§m¶e_time
);

201 ià(
d–_š_ms
 < 2000)

202 
queue_¡©
->
Ãtq_¡İ_³rûÁ
 = ((queue_¡©->
Ãtq_¡İ_time_š_ms
 * 100è/ 
d–_š_ms
);

204 
queue_¡©
->
Ãtq_¡İ_³rûÁ
 = 0;

206 
queue_¡©
->
Ãtq_¡İ_time_š_ms
 = 0;

207 
queue_¡©
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

209 
	}
}

212 
šlše
 
	$fcq_¡İ_®l_queues
(
¦si_dev
 *
sdev
)

214 
i
;

215 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

216 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

217 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

219 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

220 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "fcq_¡İ_®l_queue vià%d…“r_šdex %d‡ø%d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
, 
i
);

221 
	`Ãtif_¡İ_subqueue
(
pc_node
->
dev
,…c_node->
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

224 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

225 
	}
}

228 
šlše
 
	$fcq_wake_®l_queues
(
¦si_dev
 *
sdev
)

230 
i
;

231 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

233 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

234 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

236 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

237 ià(
	`is_gmod_aùive
(
sdev
è&& 
	`is_smod_aùive
(
pc_node
->
qs
è&& 
	`is_qmod_aùive
(&pc_node->qs->
ac_q
[
i
]è&& !
	`is_š_·u£
(sdev)) {

238 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "fcq_wake_®l_queue vià%d…“r_šdex %d‡ø%d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
, 
i
);

239 
	`Ãtif_wake_subqueue
(
pc_node
->
dev
,…c_node->
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

241 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "fcq_wake_®l_queue vià%d…“r_šdex %d‡ø%d‚Ù wok’ up!\n", 
pc_node
->
vif
,…c_node->
³”_šdex
, 
i
);

245 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

246 
	}
}

248 
	$scsc_wifi_fcq_·u£_queues
(
¦si_dev
 *
sdev
)

250 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Pause queues\n");

251 
	`©omic_£t
(&
sdev
->
š_·u£_¡©e
, 1);

252 
	`fcq_¡İ_®l_queues
(
sdev
);

253 
	}
}

255 
	$scsc_wifi_fcq_uÅau£_queues
(
¦si_dev
 *
sdev
)

257 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Unpause queues\n");

258 
	`©omic_£t
(&
sdev
->
š_·u£_¡©e
, 0);

259 
	`fcq_wake_®l_queues
(
sdev
);

260 
	}
}

262 #ià
defšed
(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

263 
šlše
 
	$fcq_¡İ_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

265 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

267 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

268 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

269 
	`Ãtif_¡İ_subqueue
(
pc_node
->
dev
, 
SLSI_NETIF_Q_ARP
);

270 
	`SLSI_INFO
(
sdev
, "ARP_q stop for %s,‡rp_tx_count = %d\n",

271 
pc_node
->
dev
->
Çme
, 
sdev
->
¬p_tx_couÁ
);

273 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

274 
	}
}

276 
šlše
 
	$fcq_wake_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

278 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

280 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

281 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

282 
	`Ãtif_wake_subqueue
(
pc_node
->
dev
, 
SLSI_NETIF_Q_ARP
);

283 
	`SLSI_INFO
(
sdev
, "ARP_q wake for %s,‡rp_tx_count = %d\n",

284 
pc_node
->
dev
->
Çme
, 
sdev
->
¬p_tx_couÁ
);

286 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

287 
	}
}

289 
	$scsc_wifi_·u£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

291 ià(!
sdev
)

294 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Pause ARP queues\n");

295 
	`©omic_£t
(&
sdev
->
ù¾_·u£_¡©e
, 1);

296 
	`fcq_¡İ_¬p_q_®l_vif
(
sdev
);

297 
	}
}

299 
	$scsc_wifi_uÅau£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

301 ià(!
sdev
)

304 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Unpause ARP queues\n");

305 
	`©omic_£t
(&
sdev
->
ù¾_·u£_¡©e
, 0);

306 ià(
	`d–ayed_wÜk_³ndšg
(&
sdev
->
uÅau£_¬p_q_wÜk
))

307 
	`ÿnûl_d–ayed_wÜk
(&
sdev
->
uÅau£_¬p_q_wÜk
);

308 
	`fcq_wake_¬p_q_®l_vif
(
sdev
);

309 
	}
}

312 #ifdeà
ENABLE_QCOD


317 
boŞ
 
	$fcq_»di¡ribu‹_qmod_befÜe_¡İpšg
(
scsc_wifi_fcq_d©a_q£t
 *
qs
)

319 
scsc_wifi_fcq_q_h—d”
 *
queue
;

320 
i
, 
j
;

321 
u32
 *
qmod_bË
;

322 
u32
 
v®
;

325 ià(
qs
->
ac_šu£
 == 1)

326  
çl£
;

329 
i
 = 1; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

330 
queue
 = &
qs
->
ac_q
[
i
].
h—d
;

331 ià(
queue
->
ÿn_be_di¡ribu‹d
 &&

332 (
	`ktime_com·»
(
	`ktime_g‘
(), 
	`ktime_add_ms
(
queue
->
em±y_t
, 
scsc_wifi_fcq_di¡ributiÚ_d–ay_ms
)) > 0)) {

334 
qs
->
ac_šu£
 &ğ~(1 << 
i
);

336 
queue
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

337 
qmod_bË
 = &
ac_q_Ïyout
[
qs
->
ac_šu£
 >> 1][0];

338 
j
 = 0; j < 
SLSI_NETIF_Q_PER_PEER
; j++) {

339 
queue
 = &
qs
->
ac_q
[
j
].
h—d
;

340 
v®
 = (
	`©omic_»ad
(&
qs
->
smod
è* 
qmod_bË
[
SLSI_NETIF_Q_PER_PEER
 - 1 - 
j
]) / 1000;

341 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "D‘eùed‚Ú-aùivaøqueu(%d). Redi¡ribu‹ qmod[%d] %d qcod %d\n", 
i
, 
j
, 
v®
, 
	`©omic_»ad
(&
queue
->
qcod
));

342 
	`©omic_£t
(&
queue
->
qmod
, 
v®
);

344  
Œue
;

348  
çl£
;

349 
	}
}

351 
	$fcq_»di¡ribu‹_qmod
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
³”_šdex
, u8 
vif
)

353 
i
;

354 
scsc_wifi_fcq_q_h—d”
 *
queue_»dis
;

355 
u32
 *
qmod_bË
;

356 
u32
 
v®
;

358 
qmod_bË
 = &
ac_q_Ïyout
[
qs
->
ac_šu£
 >> 1][0];

359 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

360 
queue_»dis
 = &
qs
->
ac_q
[
i
].
h—d
;

361 
v®
 = (
	`©omic_»ad
(&
qs
->
smod
è* 
qmod_bË
[
SLSI_NETIF_Q_PER_PEER
 - 1 - 
i
]) / 1000;

362 
	`©omic_£t
(&
queue_»dis
->
qmod
, 
v®
);

363 #ifdeà
CLOSE_IN_OVERSHOOT


364 ià(
v®
 > 0) {

366 ià(
	`©omic_»ad
(&
queue_»dis
->
aùive
è&& (©omic_»ad(&queue_»dis->
qcod
è>ğ×tomic_»ad(&queue_»dis->
qmod
è- 
STOP_GUARD_QMOD
))) {

367 
	`Ãtif_¡İ_subqueue
(
dev
, 
queue_»dis
->
Ãtif_queue_id
);

368 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Closšg ov”shoÙ queufÜ vif: %d…“r: %d‡c: %d qcod (%dèqmod (%d)\n", 
vif
, 
³”_šdex
, 
i
, 
	`©omic_»ad
(&
queue_»dis
->
qcod
),‡tomic_»ad(&queue_»dis->
qmod
));

369 
	`©omic_£t
(&
queue_»dis
->
aùive
, 0);

373 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Redi¡ribu‹‚ew v®u%d: qmod[%d] %d qcod %d‡ùiv%d\n", 
v®
, 
i
, 
	`©omic_»ad
(&
queue_»dis
->
qmod
),‡tomic_»ad(&queue_»dis->
qcod
),‡tomic_»ad(&queue_»dis->
aùive
));

375 
	}
}

378 
	$fcq_»di¡ribu‹_smod
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
tÙ®_to_di¡ribu‹
)

380 #ifdeà
CLOSE_IN_OVERSHOOT


381 
i
;

383 
u32
 
Ãw_smod
;

384 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


385 
g‘_tÙ®
 = 0;

387 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

388 
scsc_wifi_fcq_d©a_q£t
 *
qs_»dis
;

393 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


394 
g‘_tÙ®
 = 
tÙ®_to_di¡ribu‹
 - 
tÙ®_š_¦“p
;

395 ià(
g‘_tÙ®
 > 0)

396 
Ãw_smod
 = 
scsc_wifi_fcq_smod
 / 
g‘_tÙ®
;

399 
Ãw_smod
 = 
scsc_wifi_fcq_smod
 / 
tÙ®
;

401 
Ãw_smod
 = 
scsc_wifi_fcq_smod
 / 
tÙ®_to_di¡ribu‹
;

404 ià(
Ãw_smod
 < 
scsc_wifi_fcq_mšimum_smod
)

405 
Ãw_smod
 = 
scsc_wifi_fcq_mšimum_smod
;

406 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

407 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

408 ià(
pc_node
->
is_uniÿ¡
) {

409 
qs_»dis
 = 
pc_node
->
qs
;

410 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


411 ià(
qs_»dis
->
š_¦“p
)

412 
	`©omic_£t
(&
qs_»dis
->
smod
, 0);

414 
	`©omic_£t
(&
qs_»dis
->
smod
, 
Ãw_smod
);

416 
	`©omic_£t
(&
qs_»dis
->
smod
, 
Ãw_smod
);

418 #ifdeà
CLOSE_IN_OVERSHOOT


420 ià(
	`is_smod_aùive
(
qs_»dis
è&& 
	`©omic_»ad
(&qs_»dis->
scod
è>ğ×tomic_»ad(&qs_»dis->
smod
è- 
STOP_GUARD_SMOD
)) {

422 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

423 
	`Ãtif_¡İ_subqueue
(
dev
, 
qs_»dis
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

424 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Closšg ov”shoÙ q fÜ vià%d…“r_šdex %d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
);

425 
	`©omic_£t
(&
qs_»dis
->
aùive
, 0);

428 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


429 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Redi¡ribu‹d smod = %d fÜ vià%d…“r_šdex %dÙ® %dÙ®_š_¦“°%d\n", 
Ãw_smod
, 
pc_node
->
vif
,…c_node->
³”_šdex
, 
tÙ®_to_di¡ribu‹
, 
tÙ®_š_¦“p
);

431 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Redi¡ribu‹d smod = %d fÜ vià%d…“r_šdex %dÙ® %d\n", 
Ãw_smod
, 
pc_node
->
vif
,…c_node->
³”_šdex
, 
tÙ®_to_di¡ribu‹
);

434 
	`fcq_»di¡ribu‹_qmod
(
pc_node
->
dev
,…c_node->
qs
, 
sdev
,…c_node->
³”_šdex
,…c_node->
vif
);

437 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

438 
	}
}

440 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


441 
	$fcq_»di¡ribu‹_smod_befÜe_¡İpšg
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
tÙ®_to_di¡ribu‹
)

443 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

446 ià(
tÙ®_to_di¡ribu‹
 == 1)

447  
çl£
;

450 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

451 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

452 ià(
pc_node
->
is_uniÿ¡
) {

453 ià(
pc_node
->
qs
->
ÿn_be_di¡ribu‹d
 &&

454 (
	`ktime_com·»
(
	`ktime_g‘
(), 
	`ktime_add_ms
(
pc_node
->
qs
->
em±y_t
, 5000)) > 0)) {

455 
pc_node
->
qs
->
š_¦“p
 = 
Œue
;

456 
tÙ®_š_¦“p
 += 1;

457 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Smod q em±y. Cª b»di¡ribu‹d fÜ vià%d…“r_šdex %d qs->ÿn_be_di¡ribu‹d %d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
,…c_node->
qs
->
ÿn_be_di¡ribu‹d
);

458 
pc_node
->
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

459 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

460 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®_to_di¡ribu‹
);

461  
Œue
;

465 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

466  
çl£
;

467 
	}
}

470 
	$fcq_Œªsm™_gmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

472 
gcod
;

473 
gmod
;

475 
	`¥š_lock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

478 ià(
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
) {

479 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

480 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Global domain. No space.‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

481 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gcod
),‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gmod
),

482 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3]);

483 
	`fcq_¡İ_®l_queues
(
sdev
);

485 
	`¥š_uÆock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

486  -
ENOSPC
;

489 ià(!
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
è&& sdev->h4_š¡.h_´iv->
gu¬d
-- == 0) {

490 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

491 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Global domain. Saturating Gmod.‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

492 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gcod
),‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gmod
),

493 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3]);

495 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
Œue
;

498 
gmod
 = 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->gmod);

499 
gcod
 = 
	`©omic_šc_»tuº
(&
sdev
->
h4_š¡
.
h_´iv
->gcod);

500 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

501 
	`fcq_upd©e_couÁ”s
(
DIREC_TX
, 
DOMAIN_G
, 
´iÜ™y
);

502 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "tx:‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

503 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
, 
gcod
, 
gmod
,

504 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3]);

506 ià(
gcod
 >ğ(
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gmod
è- 
STOP_GUARD_GMOD
)) {

507 
	`fcq_¡İ_®l_queues
(
sdev
);

508 ià(
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
)) {

509 
sdev
->
h4_š¡
.
h_´iv
->
gu¬d
 = 
STOP_GUARD_GMOD
;

511 ià(
sdev
->
h4_š¡
.
h_´iv
->
gu¬d
 == 0)

512 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
Œue
;

514 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
, 0);

515 
	`SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
);

516 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Glob® Queue Stİ³d. gcod (%dè>ğgmod (%dègaùive(%d)\n", 
gcod
, 
gmod
, 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
));

518 
	`¥š_uÆock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

521 
	}
}

524 
	$fcq_Œªsm™_smod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

526 
scod
;

528 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


529 ià(
qs
->
š_¦“p
) {

531 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Detected‡ctivity in sleep Qs‡ctive %d vif: %d…eer: %d‡c: %d\n",

532 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
);

534 
qs
->
š_¦“p
 = 
çl£
;

535 ià(
tÙ®_š_¦“p
)

536 
tÙ®_š_¦“p
 -= 1;

537 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®
);

540 
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

543 ià(
qs
->
§tu¿‹d
) {

544 
i
;

546 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

547 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Smod domain. No space.‡ctive %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

548 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

549 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

553 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

554 
	`Ãtif_¡İ_subqueue
(
dev
, 
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

556  -
ENOSPC
;

559 ià(!
	`©omic_»ad
(&
qs
->
aùive
è&& (qs->
gu¬d
-- == 0)) {

560 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

561 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Smod domain. Going into Saturation.‡ctive %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

562 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

563 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

565 
qs
->
§tu¿‹d
 = 
Œue
;

567 
scod
 = 
	`©omic_šc_»tuº
(&
qs
->scod);

568 
	`SCSC_HIP4_SAMPLER_BOT_TX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (
scod
 & 0xFFFF));

569 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

570 
	`fcq_upd©e_couÁ”s
(
DIREC_TX
, 
DOMAIN_S
, 
´iÜ™y
);

571 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "tx:‡ctive: %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

572 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

573 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

575 ià(
scod
 >ğ(
	`©omic_»ad
(&
qs
->
smod
è- 
STOP_GUARD_SMOD
)) {

576 
i
;

577 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


579 ià(
	`fcq_»di¡ribu‹_smod_befÜe_¡İpšg
(
dev
, 
sdev
, 
tÙ®
)) {

580 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Sk³d Stİ vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

584 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

585 
	`Ãtif_¡İ_subqueue
(
dev
, 
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

587 ià(
	`©omic_»ad
(&
qs
->
aùive
)) {

588 
qs
->
gu¬d
 = 
STOP_GUARD_SMOD
;

590 ià(
qs
->
gu¬d
 == 0)

591 
qs
->
§tu¿‹d
 = 
Œue
;

593 
	`©omic_£t
(&
qs
->
aùive
, 0);

594 
qs
->
¡©s
.
Ãtq_¡İs
++;

595 
	`SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
);

596 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Smod Queue Stİ³d vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

599 
	}
}

601 #ià
defšed
(
ENABLE_CTRL_FCQ
è|| defšed(
ENABLE_QCOD
)

603 
	$fcq_Œªsm™_qmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

605 
scsc_wifi_fcq_q_h—d”
 *
queue
;

606 
qcod
;

608 
queue
 = &
qs
->
ac_q
[
´iÜ™y
].
h—d
;

610 ià(!(
qs
->
ac_šu£
 & (1 << 
´iÜ™y
))) {

611 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "New AC d‘eùed: %d\n", 
´iÜ™y
);

612 
qs
->
ac_šu£
 |ğ(1 << 
´iÜ™y
);

613 
	`fcq_»di¡ribu‹_qmod
(
dev
, 
qs
, 
sdev
, 
³”_šdex
, 
vif
);

614 
queue
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

617 ià(
queue
->
§tu¿‹d
) {

618 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx NØ¥aû iÀac: %d\n", 
´iÜ™y
);

620 
	`Ãtif_¡İ_subqueue
(
dev
, 
queue
->
Ãtif_queue_id
);

621  -
ENOSPC
;

625 ià(!
	`©omic_»ad
(&
queue
->
aùive
è&& (queue->
gu¬d
-- == 0)) {

626 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx NØ¥aû iÀac: %d S©u¿‹d\n", 
´iÜ™y
);

627 
queue
->
§tu¿‹d
 = 
Œue
;

630 
qcod
 = 
	`©omic_šc_»tuº
(&
queue
->qcod);

631 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_TX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
queue
->
qmod
è<< 16è| (
qcod
 & 0xFFFF));

632 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

633 
	`fcq_upd©e_couÁ”s
(
DIREC_TX
, 
DOMAIN_Q
, 
´iÜ™y
);

634 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "tx:‡ctive: %d vif: %d…eer: %d‡c: %d qcod (%d) qmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

635 
	`©omic_»ad
(&
queue
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&queue->
qcod
),‡tomic_»ad(&queue->
qmod
),

636 
td
[
DIREC_TX
][
DOMAIN_Q
][0],d[
DIREC_RX
][DOMAIN_Q][0],d[DIREC_TX][DOMAIN_Q][2],d[DIREC_RX][DOMAIN_Q][2],d[DIREC_TX][DOMAIN_Q][3],d[DIREC_RX][DOMAIN_Q][3]);

638 ià(
	`©omic_»ad
(&
queue
->
aùive
è&& 
qcod
 >ğ×tomic_»ad(&queue->
qmod
è- 
STOP_GUARD_QMOD
)) {

640 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


641 ià(
	`fcq_»di¡ribu‹_smod_befÜe_¡İpšg
(
dev
, 
sdev
, 
tÙ®
)) {

642 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Sk³d Stİ vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

643 
sk_¡İ
;

646 ià(
	`fcq_»di¡ribu‹_qmod_befÜe_¡İpšg
(
qs
))

647 
sk_¡İ
;

648 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_STOP
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
);

649 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Stİ subqueuvif: %d…“r: %d‡c: %d qcod (%dèqmod (%d)\n", 
vif
, 
³”_šdex
, 
´iÜ™y
, 
	`©omic_»ad
(&
queue
->
qcod
),‡tomic_»ad(&queue->
qmod
));

650 ià(
	`©omic_»ad
(&
queue
->
aùive
)) {

651 
queue
->
gu¬d
 = 
STOP_GUARD_QMOD
;

653 ià(
queue
->
gu¬d
 == 0)

654 
queue
->
§tu¿‹d
 = 
Œue
;

656 
	`©omic_£t
(&
queue
->
aùive
, 0);

657 
	`Ãtif_¡İ_subqueue
(
dev
, 
queue
->
Ãtif_queue_id
);

658 
queue
->
¡©s
.
Ãtq_¡İs
++;

659 
	`fcq_Ãtq_¡¬t_¡İ_§m¶e
(
queue
, 0);

661 
sk_¡İ
:

663 
	}
}

666 
	$scsc_wifi_fcq_Œªsm™_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

668 
rc
 = 0;

670 #ifdeà
ENABLE_CTRL_FCQ


671 ià(
	`WARN_ON
(!
dev
))

672  -
EINVAL
;

674 ià(
	`WARN_ON
(!
queue
))

675  -
EINVAL
;

677 
rc
 = 
	`fcq_Œªsm™_qmod_domaš
(
dev
, &
queue
->
h—d
);

679  
rc
;

680 
	}
}

682 
	$scsc_wifi_fcq_Œªsm™_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

684 
rc
;

685 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

687 ià(
	`WARN_ON
(!
dev
))

688  -
EINVAL
;

690 ià(
	`WARN_ON
(!
qs
))

691  -
EINVAL
;

693 ià(
	`WARN_ON
(
´iÜ™y
 >ğ
	`ARRAY_SIZE
(
qs
->
ac_q
)))

694  -
EINVAL
;

696 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

698 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

699 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

700 ià(
pc_node
->
qs
 =ğq &&…c_node->
³”_šdex
 ==…eer_index &&

701 
pc_node
->
vif
 =ğvià&&…c_node->
dev
 == dev) {

702 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

703 
found
;

706 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

707 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Packet dropped. Detected incorrect…eer„ecord\n");

708 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

709  -
EINVAL
;

710 
found
:

712 ià(
qs
->
cÚŒŞËd_pÜt_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
) {

713 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "8021x_STATE_BLOCKED\n");

714 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

715  -
EPERM
;

717 
rc
 = 
	`fcq_Œªsm™_gmod_domaš
(
dev
, 
qs
, 
´iÜ™y
, 
sdev
, 
vif
, 
³”_šdex
);

718 ià(
rc
) {

719 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

720  
rc
;

723 
rc
 = 
	`fcq_Œªsm™_smod_domaš
(
dev
, 
qs
, 
´iÜ™y
, 
sdev
, 
vif
, 
³”_šdex
);

724 ià(
rc
) {

730 
	`©omic_dec
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
);

731 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

732  
rc
;

735 #ifdeà
ENABLE_QCOD


736 
rc
 = 
	`fcq_Œªsm™_qmod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

737 ià(
rc
) {

743 
	`©omic_dec
(&
qs
->
scod
);

744 
	`©omic_dec
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
);

745 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

746 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx scsc_wifi_fcq_transmit_data: Flow control‚ot„espected. Packet will be dropped.\n");

747  
rc
;

751 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

753 
	}
}

755 
	$fcq_»ûive_gmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

757 
gcod
;

758 
gmod
;

759 
gaùive
;

761 
	`¥š_lock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

763 
gmod
 = 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->gmod);

764 
gcod
 = 
	`©omic_dec_»tuº
(&
sdev
->
h4_š¡
.
h_´iv
->gcod);

765 
gaùive
 = 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->gactive);

766 ià(
	`uÆik–y
(
gcod
 < 0)) {

767 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
, 0);

768 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx scsc_wifi_fcq_receive: gcod is‚egative. Has been fixed\n");

771 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

772 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_G
, 
´iÜ™y
);

773 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "rx:‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d %s\n",

774 
gaùive
, 
vif
, 
³”_šdex
, 
´iÜ™y
, 
gcod
, 
gmod
,

775 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3], 
qs
 ? "" : "NO PEER");

778 ià(!
	`is_gmod_aùive
(
sdev
è&& (
gcod
 + 
SCSC_WIFI_FCQ_GMOD_RESUME_HYSTERESIS
 / 
tÙ®
 < 
gmod
)) {

779 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Glob® Queue S¹ed. gcod (%dè< gmod (%d)\n", 
gcod
, 
gmod
);

780 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
çl£
;

781 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
, 1);

782 
	`fcq_wake_®l_queues
(
sdev
);

784 
	`¥š_uÆock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

787 
	}
}

789 
	$fcq_»ûive_smod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

791 
scod
;

793 
scod
 = 
	`©omic_dec_»tuº
(&
qs
->scod);

794 ià(
	`uÆik–y
(
scod
 < 0)) {

795 
	`©omic_£t
(&
qs
->
scod
, 0);

796 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx scsc_wifi_fcq_receive: scod is‚egative. Has been fixed\n");

799 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

800 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_S
, 
´iÜ™y
);

801 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "rx:‡ctive: %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

802 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

803 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

805 
	`SCSC_HIP4_SAMPLER_BOT_RX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (
scod
 & 0xFFFF));

806 ià(!
	`is_smod_aùive
(
qs
è&& (
scod
 + 
SCSC_WIFI_FCQ_SMOD_RESUME_HYSTERESIS
 / 
tÙ®
 < 
	`©omic_»ad
(&qs->
smod
))) {

807 
i
;

809 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

810 ià(
	`is_gmod_aùive
(
sdev
è&& 
	`is_qmod_aùive
(&
qs
->
ac_q
[
i
]è&& !
	`is_š_·u£
(sdev))

811 
	`Ãtif_wake_subqueue
(
dev
, 
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

813 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "smod wakvià%d…“r_šdex %d‡ø%d‚Ù wok’ up!\n", 
vif
, 
³”_šdex
, 
i
);

816 
	`SCSC_HIP4_SAMPLER_BOT_START_Q
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
);

817 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Smod Queue S¹ed vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

819 
qs
->
§tu¿‹d
 = 
çl£
;

820 
	`©omic_£t
(&
qs
->
aùive
, 1);

821 
qs
->
¡©s
.
Ãtq_»sumes
++;

824 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


825 ià(
scod
 == 0) {

827 
qs
->
em±y_t
 = 
	`ktime_g‘
();

828 
qs
->
ÿn_be_di¡ribu‹d
 = 
Œue
;

829 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Q em±y vif: %d…“r: %d\n", 
vif
, 
³”_šdex
);

831 
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

835 
	}
}

837 #ifdeà
ENABLE_QCOD


838 
	$fcq_»ûive_qmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

840 
scsc_wifi_fcq_q_h—d”
 *
queue
;

841 
qcod
;

843 
queue
 = &
qs
->
ac_q
[
´iÜ™y
].
h—d
;

845 
qcod
 = 
	`©omic_dec_»tuº
(&
queue
->qcod);

846 ià(
	`uÆik–y
(
qcod
 < 0)) {

847 
	`©omic_£t
(&
queue
->
qcod
, 0);

848 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx fcq_receive_qmod_domain: qcod is‚egative. Has been fixed\n");

851 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

852 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_Q
, 
´iÜ™y
);

853 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "rx:‡ctive: %d vif: %d…eer: %d‡c: %d qcod (%d) qmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

854 
	`©omic_»ad
(&
queue
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&queue->
qcod
),‡tomic_»ad(&queue->
qmod
),

855 
td
[
DIREC_TX
][
DOMAIN_Q
][0],d[
DIREC_RX
][DOMAIN_Q][0],d[DIREC_TX][DOMAIN_Q][2],d[DIREC_RX][DOMAIN_Q][2],d[DIREC_TX][DOMAIN_Q][3],d[DIREC_RX][DOMAIN_Q][3]);

857 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_RX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
queue
->
qmod
è<< 16è| (
qcod
 & 0xFFFF));

859 ià(!
	`is_qmod_aùive
(&
qs
->
ac_q
[
´iÜ™y
]è&& ((
qcod
 + 
SCSC_WIFI_FCQ_QMOD_RESUME_HYSTERESIS
 / 
tÙ®
è< 
	`©omic_»ad
(&
queue
->
qmod
))) {

861 ià(
	`is_gmod_aùive
(
sdev
è&& 
	`is_smod_aùive
(
qs
è&& !
	`is_š_·u£
(sdev))

862 
	`Ãtif_wake_subqueue
(
dev
, 
queue
->
Ãtif_queue_id
);

864 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_START
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
);

865 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "S¹ subqueuvif: %d…“r: %d‡c: %d qcod (%dèqmod (%d)\n", 
vif
, 
³”_šdex
, 
´iÜ™y
, 
	`©omic_»ad
(&
queue
->
qcod
),‡tomic_»ad(&queue->
qmod
));

866 
queue
->
¡©s
.
Ãtq_»sumes
++;

868 
queue
->
§tu¿‹d
 = 
çl£
;

869 
	`©omic_£t
(&
queue
->
aùive
, 1);

870 
	`fcq_Ãtq_¡¬t_¡İ_§m¶e
(
queue
, 1);

874 ià(
qcod
 =ğ0 && 
´iÜ™y
 !ğ
SLSI_TRAFFIC_Q_BE
) {

876 
queue
->
em±y_t
 = 
	`ktime_g‘
();

877 
queue
->
ÿn_be_di¡ribu‹d
 = 
Œue
;

879 
queue
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

882 
	}
}

885 
	$scsc_wifi_fcq_»ûive_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

887 ià(
	`WARN_ON
(!
dev
))

888  -
EINVAL
;

890 ià(
	`WARN_ON
(!
queue
))

891  -
EINVAL
;

893 #ifdeà
ENABLE_CTRL_FCQ


897 
	}
}

900 
	$scsc_wifi_fcq_»ûive_d©a_no_³”
(
Ãt_deviû
 *
dev
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

902 
	`fcq_»ûive_gmod_domaš
(
dev
, 
NULL
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

903 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

905 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_S
, 
´iÜ™y
);

906 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_Q
, 
´iÜ™y
);

909 
	}
}

911 
	$scsc_wifi_fcq_»ûive_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

913 
rc
 = 0;

915 ià(
	`WARN_ON
(!
dev
))

916  -
EINVAL
;

918 ià(
	`WARN_ON
(!
qs
))

919  -
EINVAL
;

921 ià(
	`WARN_ON
(
´iÜ™y
 >ğ
	`ARRAY_SIZE
(
qs
->
ac_q
)))

922  -
EINVAL
;

925 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

927 
rc
 = 
	`fcq_»ûive_gmod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

928 ià(
rc
)

929 
’d
;

931 
rc
 = 
	`fcq_»ûive_smod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

932 ià(
rc
)

933 
’d
;

935 #ifdeà
ENABLE_QCOD


936 
rc
 = 
	`fcq_»ûive_qmod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

938 
’d
:

939 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

940  
rc
;

941 
	}
}

943 
	$scsc_wifi_fcq_upd©e_smod
(
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_ps_¡©e
 
³”_ps_¡©e
,

944 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
)

946 ià(
	`WARN_ON
(!
qs
))

947  -
EINVAL
;

949 ià(
³”_ps_¡©e
 =ğ
SCSC_WIFI_FCQ_PS_STATE_POWERSAVE
) {

950 
	`©omic_£t
(&
qs
->
smod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_smod_pow”
 : 
scsc_wifi_fcq_mÿ¡_smod_pow”
);

951 
qs
->
³”_ps_¡©e
 =…eer_ps_state;

952 
qs
->
³”_ps_¡©e_Œªs™iÚs
++;

953 } ià(
³”_ps_¡©e
 =ğ
SCSC_WIFI_FCQ_PS_STATE_ACTIVE
) {

954 
	`©omic_£t
(&
qs
->
smod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_smod
 : 
scsc_wifi_fcq_mÿ¡_smod
);

955 
qs
->
³”_ps_¡©e
 =…eer_ps_state;

956 
qs
->
³”_ps_¡©e_Œªs™iÚs
++;

958 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Unknown sta_state %d\n",

959 
³”_ps_¡©e
);

962 
	}
}

964 
	$scsc_wifi_fcq_8021x_pÜt_¡©e
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_8021x_¡©e
 
¡©e
)

966 ià(
	`WARN_ON
(!
dev
))

967  -
EINTR
;

969 ià(
	`WARN_ON
(!
qs
))

970  -
EINVAL
;

972 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

973 
qs
->
cÚŒŞËd_pÜt_¡©e
 = 
¡©e
;

974 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

975 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_WIFI_FCQ
, "802.1x: Queu£ˆ0x%°i %s\n", 
qs
,

976 
¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_OPEN
 ? "Open" : "Blocked");

978 
	}
}

983 
	$scsc_wifi_fcq_¡©_queue
(
scsc_wifi_fcq_q_h—d”
 *
queue
,

984 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

985 *
qmod
, *
qcod
)

987 ià(
	`WARN_ON
(!
queue
è|| WARN_ON(!
queue_¡©
è|| WARN_ON(!
qmod
) || WARN_ON(!qmod))

988  -
EINTR
;

995 if(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
queue
->
¡©s
.
Ï¡_§m¶e_time
)) > 2000)

996 
queue
->
¡©s
.
Ãtq_¡İ_³rûÁ
 = 0;

998 
	`memıy
(
queue_¡©
, &
queue
->
¡©s
, (
scsc_wifi_fcq_q_¡©
));

999 *
qmod
 = 
	`©omic_»ad
(&
queue
->qmod);

1000 *
qcod
 = 
	`©omic_»ad
(&
queue
->qcod);

1002 
	}
}

1004 
	$scsc_wifi_fcq_¡©_queue£t
(
scsc_wifi_fcq_d©a_q£t
 *
queue_£t
,

1005 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

1006 *
smod
, *
scod
, 
scsc_wifi_fcq_8021x_¡©e
 *
ı_¡©e
,

1007 
u32
 *
³”_ps_¡©e_Œªs™iÚs
)

1009 ià(
	`WARN_ON
(!
queue_£t
è|| WARN_ON(!
queue_¡©
è|| WARN_ON(!
smod
è|| WARN_ON(!
scod
) ||

1010 
	`WARN_ON
(!
ı_¡©e
è|| WARN_ON(!
³”_ps_¡©e_Œªs™iÚs
))

1011  -
EINTR
;

1013 
	`memıy
(
queue_¡©
, &
queue_£t
->
¡©s
, (
scsc_wifi_fcq_q_¡©
));

1014 *
³”_ps_¡©e_Œªs™iÚs
 = 
queue_£t
->peer_ps_state_transitions;

1015 *
ı_¡©e
 = 
queue_£t
->
cÚŒŞËd_pÜt_¡©e
;

1016 *
smod
 = 
	`©omic_»ad
(&
queue_£t
->smod);

1017 *
scod
 = 
	`©omic_»ad
(&
queue_£t
->scod);

1019 
	}
}

1024 
	$scsc_wifi_fcq_ù¾_q_š™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

1026 ià(
	`WARN_ON
(!
queue
))

1027  -
EINVAL
;

1030 ià(
	`WARN_ON
(
scsc_wifi_fcq_qmod
 >= 0x1000000))

1031  -
EINVAL
;

1033 
	`©omic_£t
(&
queue
->
h—d
.
qmod
, 
scsc_wifi_fcq_qmod
);

1034 
	`©omic_£t
(&
queue
->
h—d
.
qcod
, 0);

1035 
queue
->
h—d
.
Ãtif_queue_id
 = 0;

1036 
queue
->
h—d
.
¡©s
.
Ãtq_¡İs
 = 0;

1037 
queue
->
h—d
.
¡©s
.
Ãtq_»sumes
 = 0;

1038 
	`©omic_£t
(&
queue
->
h—d
.
aùive
, 1);

1041 
	}
}

1043 
	$scsc_wifi_fcq_ù¾_q_deš™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

1045 
qcod
;

1047 
	`WARN_ON
(!
queue
);

1049 
qcod
 = 
	`©omic_»ad
(&
queue
->
h—d
.qcod);

1050 ià(
qcod
 != 0)

1051 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Ctrl queue (0x%p) deinit: qcod is %d,‚etif queue %d\n",

1052 
queue
, 
qcod
, queue->
h—d
.
Ãtif_queue_id
);

1053 
	}
}

1055 
	$fcq_d©a_q_š™
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
, 
scsc_wifi_fcq_d©a_q
 *
queue
,

1056 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
s16
 
ac
)

1058 ià(
	`WARN_ON
(!
queue
))

1059  -
EINVAL
;

1061 ià(
	`WARN_ON
(!
qs
))

1062  -
EINVAL
;

1065 ià(
	`WARN_ON
(
scsc_wifi_fcq_qmod
 >ğ0x1000000è|| WARN_ON(
scsc_wifi_fcq_mÿ¡_qmod
 >= 0x1000000))

1066  -
EINVAL
;

1068 
	`©omic_£t
(&
queue
->
h—d
.
qmod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_qmod
 : 
scsc_wifi_fcq_mÿ¡_qmod
);

1070 
	`©omic_£t
(&
queue
->
h—d
.
qcod
, 0);

1071 
queue
->
qs
 = qs;

1072 
queue
->
h—d
.
Ãtif_queue_id
 = 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ?

1073 
	`¦si_Ãtif_g‘_³”_queue
(
qs_num
, 
ac
è: 
	`¦si_Ãtif_g‘_muÉiÿ¡_queue
(ac);

1075 
queue
->
h—d
.
¡©s
.
Ãtq_¡İs
 = 0;

1076 
queue
->
h—d
.
¡©s
.
Ãtq_»sumes
 = 0;

1079 ià(!
	`©omic_»ad
(&
sdev
->
š_·u£_¡©e
))

1080 
	`Ãtif_wake_subqueue
(
dev
, 
queue
->
h—d
.
Ãtif_queue_id
);

1082 
queue
->
h—d
.
§tu¿‹d
 = 
çl£
;

1083 
	`©omic_£t
(&
queue
->
h—d
.
aùive
, 1);

1084 
queue
->
h—d
.
¡©s
.
Ãtq_¡©e
 = 1;

1085 
queue
->
h—d
.
¡©s
.
Ãtq_¡İ_time_š_ms
 = 0;

1086 
queue
->
h—d
.
¡©s
.
Ãtq_¡İ_³rûÁ
 = 0;

1089 
	}
}

1091 
	$fcq_d©a_q_deš™
(
scsc_wifi_fcq_d©a_q
 *
queue
)

1093 
qcod
;

1095 
	`WARN_ON
(!
queue
);

1097 
qcod
 = 
	`©omic_»ad
(&
queue
->
h—d
.qcod);

1098 ià(
qcod
 != 0)

1099 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Data queue (0x%p) deinit: qcod is %d,‚etif queue %d\n",

1100 
queue
, 
qcod
, queue->
h—d
.
Ãtif_queue_id
);

1101 
	}
}

1103 
	$fcq_q£t_š™
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
)

1105 
i
;

1106 
scsc_wifi_fcq_d©a_q
 *
queue
;

1108 
	`mem£t
(
qs
, 0, (
scsc_wifi_fcq_d©a_q£t
));

1109 
	`¥š_lock_š™
(&
qs
->
ı_lock
);

1110 
	`©omic_£t
(&
qs
->
smod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_smod
 : 
scsc_wifi_fcq_mÿ¡_smod
);

1111 
	`©omic_£t
(&
qs
->
scod
, 0);

1113 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

1114 
qs
->
³”_ps_¡©e
 = 
SCSC_WIFI_FCQ_PS_STATE_ACTIVE
;

1115 
qs
->
§tu¿‹d
 = 
çl£
;

1116 
	`©omic_£t
(&
qs
->
aùive
, 1);

1117 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


1118 
qs
->
š_¦“p
 = 
çl£
;

1119 
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

1121 
qs
->
cÚŒŞËd_pÜt_¡©e
 = 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
;

1124 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

1126 
qs
->
ac_šu£
 &ğ~(1 << 
i
);

1127 
queue
 = &
qs
->
ac_q
[
i
];

1128 
	`fcq_d©a_q_š™
(
dev
, 
sdev
, 
ty³
, 
queue
, 
qs
, 
qs_num
, 
i
);

1131 
qs
->
ac_šu£
 = 1;

1132 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

1133 
	}
}

1135 
	$scsc_wifi_fcq_uniÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
¦si_dev
 *
sdev
, u8 
vif
, 
¦si_³”
 *
³”
)

1137 
³”s_ÿche
 *
pc_Ãw_node
;

1139 ià(
	`WARN_ON
(!
qs
))

1140  -
EINVAL
;

1143 ià(
	`WARN_ON
(
scsc_wifi_fcq_smod
 >= 0x1000000))

1144  -
EINVAL
;

1146 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "In™ uniÿ¡ queu£ˆ0x%°vià%d…“r_šdex %d\n", 
qs
, 
vif
, 
³”
->
aid
);

1147 
	`fcq_q£t_š™
(
dev
, 
sdev
, 
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
, 
qs
, 
qs_num
);

1148 
	`SCSC_HIP4_SAMPLER_BOT_ADD
Ğ
sdev
->
mšÜ_´of
,

1149 
vif
,

1150 
³”
->
aid
,

1151 (
³”
->
add»ss
[3] << 24) | (peer->address[2] << 16) | (peer->address[1] << 8) | (peer->address[0]));

1152 
	`SCSC_HIP4_SAMPLER_BOT_TX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”
->
aid
, 0, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (©omic_»ad(&qs->
scod
) & 0xFFFF));

1154 
pc_Ãw_node
 = 
	`kz®loc
((*pc_Ãw_node), 
GFP_ATOMIC
);

1155 ià(!
pc_Ãw_node
)

1156  -
ENOMEM
;

1157 
pc_Ãw_node
->
dev
 = dev;

1158 
pc_Ãw_node
->
qs
 = qs;

1159 
pc_Ãw_node
->
³”_šdex
 = 
³”
->
aid
;

1160 
pc_Ãw_node
->
vif
 = vif;

1161 
pc_Ãw_node
->
is_uniÿ¡
 = 
Œue
;

1163 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Add‚ew…“¸q %°vià%d…“r->aid %d\n", 
qs
, 
vif
, 
³”
->
aid
);

1164 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

1165 
	`li¡_add_
(&
pc_Ãw_node
->
li¡
, &
³”s_ÿche_li¡
);

1166 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

1168 ià(
tÙ®
 == 0) {

1170 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


1171 
tÙ®_š_¦“p
 = 0;

1173 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "First…eer. Reset gcod.\n");

1174 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
, 0);

1175 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
, 1);

1176 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
çl£
;

1179 
tÙ®
++;

1180 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Add New…“r. TÙ® %d\n", 
tÙ®
);

1181 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®
);

1184 
	}
}

1186 
	$scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
)

1188 
³”s_ÿche
 *
pc_node
;

1190 ià(
	`WARN_ON
(!
qs
))

1191  -
EINVAL
;

1194 ià(
	`WARN_ON
(
scsc_wifi_fcq_mÿ¡_smod
 >= 0x1000000))

1195  -
EINVAL
;

1197 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "In™ muÉiÿ¡ queu£ˆ0x%p\n", 
qs
);

1198 
	`fcq_q£t_š™
(
dev
, 
sdev
, 
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_MULTICAST
, 
qs
, 0);

1199 
	`SCSC_HIP4_SAMPLER_BOT_ADD
(
sdev
->
mšÜ_´of
, 
vif
, 0, 0);

1200 
	`SCSC_HIP4_SAMPLER_BOT_TX
(
sdev
->
mšÜ_´of
, 
vif
, 0, 0, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (©omic_»ad(&qs->
scod
) & 0xFFFF));

1203 
pc_node
 = 
	`kz®loc
((*pc_node), 
GFP_ATOMIC
);

1204 ià(!
pc_node
)

1205  -
ENOMEM
;

1206 
pc_node
->
dev
 = dev;

1207 
pc_node
->
qs
 = qs;

1208 
pc_node
->
³”_šdex
 = 0;

1209 
pc_node
->
vif
 = vif;

1210 
pc_node
->
is_uniÿ¡
 = 
çl£
;

1212 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Add MuÉiÿ¡ Q£ˆ%°vià%d…“r->aid 0\n", 
qs
, 
vif
);

1213 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

1214 
	`li¡_add_
(&
pc_node
->
li¡
, &
³”s_ÿche_li¡
);

1215 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

1217 
	`fcq_»di¡ribu‹_qmod
(
pc_node
->
dev
,…c_node->
qs
, 
sdev
,…c_node->
³”_šdex
,…c_node->
vif
);

1220 
	}
}

1222 
	$scsc_wifi_fcq_q£t_deš™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, 
¦si_³”
 *
³”
)

1224 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

1225 
i
, 
scod
;

1226 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1227 
aid
 = 0;

1229 ià(
³”
)

1230 
aid
 = 
³”
->aid;

1233 
	`WARN_ON
(!
qs
);

1235 ià(!
qs
)

1238 
scod
 = 
	`©omic_»ad
(&
qs
->scod);

1239 ià(
scod
 != 0)

1240 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "D©¨£ˆ(0x%pèdeš™: scod i %d\n", 
qs
, 
scod
);

1242 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

1243 
	`fcq_d©a_q_deš™
(&
qs
->
ac_q
[
i
]);

1245 
qs
->
ac_šu£
 = 0;

1246 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


1248 ià(
qs
->
š_¦“p
 && 
tÙ®_š_¦“p
)

1249 
tÙ®_š_¦“p
 -= 1;

1251 
	`SCSC_HIP4_SAMPLER_BOT_RX
(
sdev
->
mšÜ_´of
, 
vif
, 
aid
, 0, 0);

1252 
	`SCSC_HIP4_SAMPLER_BOT_REMOVE
(
sdev
->
mšÜ_´of
, 
vif
, 
aid
);

1254 ià(
³”
)

1255 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "D–‘q %°vià%d…“r->aid %d\n", 
qs
, 
vif
, 
³”
->
aid
);

1257 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "D–‘q %°vià%d MuÉiÿ¡\n", 
qs
, 
vif
);

1259 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

1260 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

1261 ià(
pc_node
->
qs
 == qs) {

1262 
	`li¡_d–
(&
pc_node
->
li¡
);

1263 
	`kä“
(
pc_node
);

1266 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

1268 ià(
tÙ®
 > 0 && 
³”
)

1269 
tÙ®
--;

1271 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "D–…“r. TÙ® %d\n", 
tÙ®
);

1273 ià(
tÙ®
 == 0)

1276 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®
);

1277 
	}
}

	@scsc_wifi_fcq.h

7 
	~<lšux/¥šlock.h
>

8 
	~<asm/©omic.h
>

9 
	~"Ãtif.h
"

11 #iâdeà
__SCSC_WIFI_FCQ_H


12 
	#__SCSC_WIFI_FCQ_H


	)

14 
	escsc_wifi_fcq_8021x_¡©e
 {

15 
	mSCSC_WIFI_FCQ_8021x_STATE_BLOCKED
 = 0,

16 
	mSCSC_WIFI_FCQ_8021x_STATE_OPEN
 = 1

19 
	escsc_wifi_fcq_ps_¡©e
 {

20 
	mSCSC_WIFI_FCQ_PS_STATE_POWERSAVE
 = 1,

21 
	mSCSC_WIFI_FCQ_PS_STATE_ACTIVE
 = 2

24 
	sscsc_wifi_fcq_q_¡©
 {

25 
u32
 
	mÃtq_¡İs
;

26 
u32
 
	mÃtq_»sumes
;

27 
u32
 
	mÃtq_¡İ_³rûÁ
;

28 
u32
 
	mÃtq_¡İ_time_š_ms
;

29 
ktime_t
 
	mÏ¡_§m¶e_time
;

30 
ktime_t
 
	mÏ¡_¡İ_time
;

31 
boŞ
 
	mÃtq_¡©e
;

34 
	sscsc_wifi_fcq_q_h—d”
 {

35 
©omic_t
 
	mqmod
;

36 
©omic_t
 
	mqcod
;

37 
u16
 
	mÃtif_queue_id
;

38 
©omic_t
 
	maùive
;

39 
scsc_wifi_fcq_q_¡©
 
	m¡©s
;

40 
ktime_t
 
	mem±y_t
;

41 
boŞ
 
	mÿn_be_di¡ribu‹d
;

42 
boŞ
 
	m§tu¿‹d
;

43 
	mgu¬d
;

46 
	sscsc_wifi_fcq_d©a_q
 {

47 
scsc_wifi_fcq_q_h—d”
 
	mh—d
;

48 
scsc_wifi_fcq_d©a_q£t
 *
	mqs
;

51 
	sscsc_wifi_fcq_ù¾_q
 {

52 
scsc_wifi_fcq_q_h—d”
 
	mh—d
;

55 
	escsc_wifi_fcq_queue_£t_ty³
 {

56 
	mSCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 = 0,

57 
	mSCSC_WIFI_FCQ_QUEUE_SET_TYPE_MULTICAST
 = 1

60 
	#EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION
 1

	)

62 
	sscsc_wifi_fcq_d©a_q£t
 {

63 
©omic_t
 
	maùive
;

64 
scsc_wifi_fcq_8021x_¡©e
 
	mcÚŒŞËd_pÜt_¡©e
;

66 
¥šlock_t
 
	mı_lock
;

68 
scsc_wifi_fcq_d©a_q
 
	mac_q
[
SLSI_NETIF_Q_PER_PEER
];

70 
u8
 
	mac_šu£
;

71 
©omic_t
 
	msmod
;

72 
©omic_t
 
	mscod
;

74 
scsc_wifi_fcq_q_¡©
 
	m¡©s
;

75 
scsc_wifi_fcq_ps_¡©e
 
	m³”_ps_¡©e
;

76 
u32
 
	m³”_ps_¡©e_Œªs™iÚs
;

78 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


79 
ktime_t
 
	mem±y_t
;

80 
boŞ
 
	mÿn_be_di¡ribu‹d
;

81 
boŞ
 
	mš_¦“p
;

83 
boŞ
 
	m§tu¿‹d
;

84 
	mgu¬d
;

88 
scsc_wifi_fcq_ù¾_q_š™
(
scsc_wifi_fcq_ù¾_q
 *
queue
);

89 
scsc_wifi_fcq_ù¾_q_deš™
(
scsc_wifi_fcq_ù¾_q
 *
queue
);

91 
scsc_wifi_fcq_uniÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
¦si_dev
 *
sdev
, u8 
vif
, 
¦si_³”
 *
³”
);

92 
scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
);

93 
scsc_wifi_fcq_q£t_deš™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, 
¦si_³”
 *
³”
);

96 
scsc_wifi_fcq_Œªsm™_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
);

97 
scsc_wifi_fcq_»ûive_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
);

98 
scsc_wifi_fcq_»ûive_d©a_no_³”
(
Ãt_deviû
 *
dev
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
);

100 
scsc_wifi_fcq_·u£_queues
(
¦si_dev
 *
sdev
);

101 #ià
defšed
(
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL
)

102 
scsc_wifi_·u£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
);

103 
scsc_wifi_uÅau£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
);

106 
scsc_wifi_fcq_uÅau£_queues
(
¦si_dev
 *
sdev
);

108 
scsc_wifi_fcq_Œªsm™_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
);

109 
scsc_wifi_fcq_»ûive_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
);

111 
scsc_wifi_fcq_upd©e_smod
(
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_ps_¡©e
 
³”_ps_¡©e
,

112 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
);

113 
scsc_wifi_fcq_8021x_pÜt_¡©e
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_8021x_¡©e
 
¡©e
);

116 
scsc_wifi_fcq_¡©_queue
(
scsc_wifi_fcq_q_h—d”
 *
queue
,

117 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

118 *
qmod
, *
qcod
);

120 
scsc_wifi_fcq_¡©_queue£t
(
scsc_wifi_fcq_d©a_q£t
 *
queue_£t
,

121 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

122 *
smod
, *
scod
, 
scsc_wifi_fcq_8021x_¡©e
 *
ı_¡©e
,

123 
u32
 *
³”_ps_¡©e_Œªs™iÚs
);

	@scsc_wifilogger.h

6 #iâdeà
_SCSC_WIFILOGGER_H_


7 
	#_SCSC_WIFILOGGER_H_


	)

49 
	~"scsc_wifogg”_ty³s.h
"

57 
wifi_”rÜ
 
scsc_wifi_g‘_fœmw¬e_v”siÚ
(*
bufãr
, 
bufãr_size
);

65 
wifi_”rÜ
 
scsc_wifi_g‘_driv”_v”siÚ
(*
bufãr
, 
bufãr_size
);

72 
wifi_”rÜ
 
scsc_wifi_g‘_ršg_bufãrs_¡©us
(
u32
 *
num_ršgs
,

73 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
);

79 
wifi_”rÜ
 
scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
(*
suµÜt
);

87 
wifi_”rÜ
 
scsc_wifi_£t_log_hªdËr
(
Ú_ršg_bufãr_d©a
 
hªdËr
, *
ùx
);

88 
wifi_”rÜ
 
scsc_wifi_»£t_log_hªdËr
();

94 
wifi_”rÜ
 
scsc_wifi_£t_®”t_hªdËr
(
Ú_®”t
 
hªdËr
, *
ùx
);

95 
wifi_”rÜ
 
scsc_wifi_»£t_®”t_hªdËr
();

100 
wifi_”rÜ
 
scsc_wifi_g‘_ršg_d©a
(*
ršg_Çme
);

126 
wifi_”rÜ
 
scsc_wifi_¡¬t_loggšg
(
u32
 
v”bo£_Ëv–
, u32 
æags
, u32 
max_š‹rv®_£c
,

127 
u32
 
mš_d©a_size
, *
ršg_Çme
);

135 
wifi_”rÜ
 
scsc_wifi_g‘_fœmw¬e_memÜy_dump
(
Ú_fœmw¬e_memÜy_dump
 
hªdËr
, *
ùx
);

152 
wifi_”rÜ
 
scsc_wifi_g‘_driv”_memÜy_dump
(
Ú_driv”_memÜy_dump
 
hªdËr
, *
ùx
);

159 
wifi_”rÜ
 
scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
();

177 
wifi_”rÜ
 
scsc_wifi_g‘_tx_pkt_ç‹s
(
wifi_tx_»pÜt
 *
tx_»pÜt_bufs
,

178 
size_t
 
n_»que¡ed_ç‹s
,

179 
size_t
 *
n_´ovided_ç‹s
,

180 
boŞ
 
is_u£r
);

198 
wifi_”rÜ
 
scsc_wifi_g‘_rx_pkt_ç‹s
(
wifi_rx_»pÜt
 *
rx_»pÜt_bufs
,

199 
size_t
 
n_»que¡ed_ç‹s
,

200 
size_t
 *
n_´ovided_ç‹s
,

201 
boŞ
 
is_u£r
);

	@scsc_wifilogger_api.c

6 
	~<scsc/scsc_mx.h
>

7 
	~<scsc/scsc_logršg.h
>

9 
	~"scsc_wifogg”.h
"

10 
	~"scsc_wifogg”_cÜe.h
"

11 
	~"scsc_wifogg”_š‹º®.h
"

12 
	~"scsc_wifogg”_ršg_pktç‹.h
"

14 
wifi_”rÜ
 
	$scsc_wifi_g‘_fœmw¬e_v”siÚ
(*
bufãr
, 
bufãr_size
)

16 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

17 
	`mxmª_g‘_fw_v”siÚ
(
bufãr
, 
bufãr_size
);

18  
WIFI_SUCCESS
;

19 
	}
}

20 
EXPORT_SYMBOL
(
scsc_wifi_g‘_fœmw¬e_v”siÚ
);

22 
wifi_”rÜ
 
	$scsc_wifi_g‘_driv”_v”siÚ
(*
bufãr
, 
bufãr_size
)

24 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

25 
	`mxmª_g‘_driv”_v”siÚ
(
bufãr
, 
bufãr_size
);

26  
WIFI_SUCCESS
;

27 
	}
}

28 
EXPORT_SYMBOL
(
scsc_wifi_g‘_driv”_v”siÚ
);

30 
wifi_”rÜ
 
	$scsc_wifi_g‘_ršg_bufãrs_¡©us
(
u32
 *
num_ršgs
,

31 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

33 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

34 ià(!
	`scsc_wifogg”_g‘_ršgs_¡©us
(
num_ršgs
, 
¡©us
))

35  
WIFI_ERROR_UNINITIALIZED
;

37  
WIFI_SUCCESS
;

38 
	}
}

39 
EXPORT_SYMBOL
(
scsc_wifi_g‘_ršg_bufãrs_¡©us
);

41 
wifi_”rÜ
 
	$scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
(*
suµÜt
)

43 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

44 ià(!
suµÜt
)

45  
WIFI_ERROR_INVALID_ARGS
;

46 *
suµÜt
 = 
	`scsc_wifogg”_g‘_ã©u»s
();

48  
WIFI_SUCCESS
;

49 
	}
}

50 
EXPORT_SYMBOL
(
scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
);

52 
wifi_”rÜ
 
	$scsc_wifi_£t_log_hªdËr
(
Ú_ršg_bufãr_d©a
 
hªdËr
, *
ùx
)

54 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

56 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

57 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

58 ià(!
wl
 || !wl->
š™Ÿlized
) {

59 
	`SCSC_TAG_ERR
(
WLOG
,

61  
WIFI_ERROR_UNINITIALIZED
;

63 ià(!
hªdËr
) {

64 
	`SCSC_TAG_ERR
(
WLOG
,

66  
WIFI_ERROR_INVALID_ARGS
;

69 
	`mu‹x_lock
(&
wl
->
lock
);

70 ià(
wl
->
Ú_ršg_bufãr_d©a_cb
) {

71 
	`SCSC_TAG_ERR
(
WLOG
,

73 
	`mu‹x_uÆock
(&
wl
->
lock
);

74  
WIFI_SUCCESS
;

76 
wl
->
Ú_ršg_bufãr_d©a_cb
 = 
hªdËr
;

77 
wl
->
Ú_ršg_bufãr_ùx
 = 
ùx
;

78 
	`mu‹x_uÆock
(&
wl
->
lock
);

80  
WIFI_SUCCESS
;

81 
	}
}

82 
EXPORT_SYMBOL
(
scsc_wifi_£t_log_hªdËr
);

84 
wifi_”rÜ
 
	$scsc_wifi_»£t_log_hªdËr
()

86 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

88 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

89 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

90 ià(!
wl
 || !wl->
š™Ÿlized
) {

91 
	`SCSC_TAG_ERR
(
WLOG
,

93  
WIFI_ERROR_UNINITIALIZED
;

95 
	`mu‹x_lock
(&
wl
->
lock
);

96 
wl
->
Ú_ršg_bufãr_d©a_cb
 = 
NULL
;

97 
wl
->
Ú_ršg_bufãr_ùx
 = 
NULL
;

98 
	`mu‹x_uÆock
(&
wl
->
lock
);

100  
WIFI_SUCCESS
;

101 
	}
}

102 
EXPORT_SYMBOL
(
scsc_wifi_»£t_log_hªdËr
);

104 
wifi_”rÜ
 
	$scsc_wifi_£t_®”t_hªdËr
(
Ú_®”t
 
hªdËr
, *
ùx
)

106 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

108 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

109 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

110 ià(!
wl
 || !wl->
š™Ÿlized
) {

111 
	`SCSC_TAG_ERR
(
WLOG
,

113  
WIFI_ERROR_UNINITIALIZED
;

115 ià(!
hªdËr
) {

116 
	`SCSC_TAG_ERR
(
WLOG
,

118  
WIFI_ERROR_INVALID_ARGS
;

121 
	`mu‹x_lock
(&
wl
->
lock
);

122 ià(
wl
->
Ú_®”t_cb
) {

123 
	`SCSC_TAG_ERR
(
WLOG
,

125 
	`mu‹x_uÆock
(&
wl
->
lock
);

126  
WIFI_SUCCESS
;

128 
wl
->
Ú_®”t_cb
 = 
hªdËr
;

129 
wl
->
Ú_®”t_ùx
 = 
ùx
;

130 
	`mu‹x_uÆock
(&
wl
->
lock
);

132  
WIFI_SUCCESS
;

133 
	}
}

134 
EXPORT_SYMBOL
(
scsc_wifi_£t_®”t_hªdËr
);

136 
wifi_”rÜ
 
	$scsc_wifi_»£t_®”t_hªdËr
()

138 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

140 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

141 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

142 ià(!
wl
 || !wl->
š™Ÿlized
) {

143 
	`SCSC_TAG_ERR
(
WLOG
,

145  
WIFI_ERROR_UNINITIALIZED
;

147 
	`mu‹x_lock
(&
wl
->
lock
);

148 
wl
->
Ú_®”t_cb
 = 
NULL
;

149 
wl
->
Ú_®”t_ùx
 = 
NULL
;

150 
	`mu‹x_uÆock
(&
wl
->
lock
);

152  
WIFI_SUCCESS
;

153 
	}
}

154 
EXPORT_SYMBOL
(
scsc_wifi_»£t_®”t_hªdËr
);

156 
wifi_”rÜ
 
	$scsc_wifi_g‘_ršg_d©a
(*
ršg_Çme
)

158 
scsc_wlog_ršg
 *
r
;

159 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

161 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

162 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

163 ià(!
wl
 || !wl->
š™Ÿlized
) {

164 
	`SCSC_TAG_ERR
(
WLOG
,

166 
ršg_Çme
);

167  
WIFI_ERROR_UNINITIALIZED
;

170 
	`mu‹x_lock
(&
wl
->
lock
);

171 ià(!
wl
->
Ú_ršg_bufãr_d©a_cb
)

172 
	`SCSC_TAG_WARNING
(
WLOG
,

174 
ršg_Çme
);

175 
	`mu‹x_uÆock
(&
wl
->
lock
);

177 
r
 = 
	`scsc_wifogg”_g‘_ršg_äom_Çme
(
ršg_Çme
);

178 ià(!
r
) {

179 
	`SCSC_TAG_ERR
(
WLOG
,

181 
ršg_Çme
);

182  
WIFI_ERROR_NOT_AVAILABLE
;

185 
	`scsc_wlog_d¿š_whŞe_ršg
(
r
);

187  
WIFI_SUCCESS
;

188 
	}
}

189 
EXPORT_SYMBOL
(
scsc_wifi_g‘_ršg_d©a
);

191 
wifi_”rÜ
 
	$scsc_wifi_¡¬t_loggšg
(
u32
 
v”bo£_Ëv–
, u32 
æags
, u32 
max_š‹rv®_£c
,

192 
u32
 
mš_d©a_size
, *
ršg_Çme
)

194 
scsc_wlog_ršg
 *
r
;

196 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

197 
r
 = 
	`scsc_wifogg”_g‘_ršg_äom_Çme
(
ršg_Çme
);

198 ià(!
r
) {

199 
	`SCSC_TAG_ERR
(
WLOG
,

201 
ršg_Çme
);

202  
WIFI_ERROR_NOT_AVAILABLE
;

205  
	`scsc_wlog_¡¬t_loggšg
(
r
, 
v”bo£_Ëv–
, 
æags
,

206 
max_š‹rv®_£c
, 
mš_d©a_size
);

207 
	}
}

208 
EXPORT_SYMBOL
(
scsc_wifi_¡¬t_loggšg
);

210 
wifi_”rÜ
 
	$scsc_wifi_g‘_fœmw¬e_memÜy_dump
(
Ú_fœmw¬e_memÜy_dump
 
hªdËr
, *
ùx
)

212 
buf
[] = "Full FW memory dump NOT‡vailable.\n";

214 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

215 
	`hªdËr
(
buf
, (buf), 
ùx
);

217  
WIFI_SUCCESS
;

218 
	}
}

219 
EXPORT_SYMBOL
(
scsc_wifi_g‘_fœmw¬e_memÜy_dump
);

221 
wifi_”rÜ
 
	$scsc_wifi_g‘_driv”_memÜy_dump
(
Ú_driv”_memÜy_dump
 
hªdËr
, *
ùx
)

223 
buf
[] = "Full DRIVER memory dump NOT‡vailable.\n";

225 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

226 
	`hªdËr
(
buf
, (buf), 
ùx
);

228  
WIFI_SUCCESS
;

229 
	}
}

230 
EXPORT_SYMBOL
(
scsc_wifi_g‘_driv”_memÜy_dump
);

232 
wifi_”rÜ
 
	$scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
()

234 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

235 
	`scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
();

237  
WIFI_SUCCESS
;

238 
	}
}

239 
EXPORT_SYMBOL
(
scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
);

241 
wifi_”rÜ
 
	$scsc_wifi_g‘_tx_pkt_ç‹s
(
wifi_tx_»pÜt
 *
tx_»pÜt_bufs
,

242 
size_t
 
n_»que¡ed_ç‹s
,

243 
size_t
 *
n_´ovided_ç‹s
, 
boŞ
 
is_u£r
)

245 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

246 
	`scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
TX_FATE
, 
tx_»pÜt_bufs
,

247 
n_»que¡ed_ç‹s
, 
n_´ovided_ç‹s
, 
is_u£r
);

248  
WIFI_SUCCESS
;

249 
	}
}

250 
EXPORT_SYMBOL
(
scsc_wifi_g‘_tx_pkt_ç‹s
);

252 
wifi_”rÜ
 
	$scsc_wifi_g‘_rx_pkt_ç‹s
(
wifi_rx_»pÜt
 *
rx_»pÜt_bufs
,

253 
size_t
 
n_»que¡ed_ç‹s
,

254 
size_t
 *
n_´ovided_ç‹s
, 
boŞ
 
is_u£r
)

256 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

257 
	`scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
RX_FATE
, 
rx_»pÜt_bufs
,

258 
n_»que¡ed_ç‹s
, 
n_´ovided_ç‹s
, 
is_u£r
);

259  
WIFI_SUCCESS
;

260 
	}
}

261 
EXPORT_SYMBOL
(
scsc_wifi_g‘_rx_pkt_ç‹s
);

	@scsc_wifilogger_core.c

7 
	~<lšux/k”Ãl.h
>

8 
	~<lšux/ty³s.h
>

9 
	~<lšux/mu‹x.h
>

10 
	~<lšux/¦ab.h
>

11 
	~<lšux/sched.h
>

12 
	~<lšux/time.h
>

13 
	~<lšux/wÜkqueue.h
>

14 
	~<lšux/¥šlock.h
>

15 
	~<scsc/scsc_logršg.h
>

16 
	~<lšux/tim”.h
>

17 
	~<lšux/uacûss.h
>

20 
	~"scsc_wifogg”_cÜe.h
"

22 
©omic_t
 
	gÃxt_ršg_id
;

24 
	$wlog_d¿š_wÜk”
(
wÜk_¡ruù
 *
wÜk
)

26 
scsc_wlog_ršg
 *
r
;

28 
r
 = 
	`cÚš”_of
(
wÜk
, 
scsc_wlog_ršg
, 
d¿š_wÜk
);

30 ià(
r
 &&„->
İs
.
d¿š_ršg
)

31 
r
->
İs
.
	`d¿š_ršg
Ô,„->
æushšg
 ?„->
¡
.
rb_by‹_size
 : 
	`DEFAULT_DRAIN_CHUNK_SZ
(r));

32 
	}
}

34 #ià
KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE


35 
	$d¿š_tim”_ÿÎback
(
tim”_li¡
 *
t
)

37 
	$d¿š_tim”_ÿÎback
(
d©a
)

40 #ià
	`KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE


41 
scsc_wlog_ršg
 *
r
 = 
	`äom_tim”
Ô, 
t
, 
d¿š_tim”
);

43 
scsc_wlog_ršg
 *
r
 = (scsc_wlog_ršg *)
d©a
;

45 
	`SCSC_TAG_DBG4
(
WLOG
, "TIMER DRAIN : %p\n", 
r
);

47 
	`queue_wÜk
(
r
->
d¿š_wÜkq
, &r->
d¿š_wÜk
);

49 ià(
r
->
¡
.
v”bo£_Ëv–
 &&„->
max_š‹rv®_£c
) {

50 
	`mod_tim”
(&
r
->
d¿š_tim”
,

51 
jiff›s
 + 
	`m£cs_to_jiff›s
(
r
->
max_š‹rv®_£c
 * 1000));

52 
	`SCSC_TAG_DBG4
(
WLOG
, "TIMER RELOADED !!!\n");

54 
	}
}

56 
	$wlog_ršg_š™
(
scsc_wlog_ršg
 *
r
)

59 
r
->
buf
 = 
	`kz®loc
Ô->
¡
.
rb_by‹_size
 + 
MAX_RECORD_SZ
, 
GFP_KERNEL
);

60 ià(!
r
->
buf
)

61  -
ENOMEM
;

62 
r
->
d¿š_sz
 = 
DRAIN_BUF_SZ
;

63 
r
->
d¿š_buf
 = 
	`kz®loc
Ô->
d¿š_sz
, 
GFP_KERNEL
);

64 ià(!
r
->
d¿š_buf
) {

65 
	`kä“
(
r
->
buf
);

66  -
ENOMEM
;

68 
	`mu‹x_š™
(&
r
->
d¿š_lock
);

70 
r
->
d¿š_wÜkq
 = 
	`ü—‹_wÜkqueue
("wifilogger");

71 
	`INIT_WORK
(&
r
->
d¿š_wÜk
, 
wlog_d¿š_wÜk”
);

72 #ià
	`KERNEL_VERSION
(4,19,0è<ğ
LINUX_VERSION_CODE


73 
	`tim”_£tup
(&
r
->
d¿š_tim”
, 
d¿š_tim”_ÿÎback
, 0);

75 
	`£tup_tim”
(&
r
->
d¿š_tim”
, 
d¿š_tim”_ÿÎback
, ()r);

77 
r
->
¡
.
ršg_id
 = 
	`©omic_»ad
(&
Ãxt_ršg_id
);

78 
	`©omic_šc
(&
Ãxt_ršg_id
);

80 
	`SCSC_TAG_DBG3
(
WLOG
, "Workers initialized for„ing[%p]: %s\n",

81 
r
,„->
¡
.
Çme
);

84 
	}
}

86 
	$wlog_ršg_fš®ize
(
scsc_wlog_ršg
 *
r
)

88 ià(!
r
)

91 
	`ÿnûl_wÜk_sync
(&
r
->
d¿š_wÜk
);

92 
	`d–_tim”_sync
(&
r
->
d¿š_tim”
);

93 
	`de¡roy_wÜkqueue
(
r
->
d¿š_wÜkq
);

95 
r
->
š™Ÿlized
 = 
çl£
;

96 
	`kä“
(
r
->
d¿š_buf
);

97 
	`kä“
(
r
->
buf
);

98 
r
->
buf
 = 
NULL
;

99 
	}
}

101 
wifi_”rÜ
 
	$wlog_g‘_ršg_¡©us
(
scsc_wlog_ršg
 *
r
,

102 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

104 ià(!
r
 || !
¡©us
)

105  
WIFI_ERROR_INVALID_ARGS
;

107 *
¡©us
 = 
r
->
¡
;

109  
WIFI_SUCCESS
;

110 
	}
}

112 
	$wlog_»ad_»cÜds
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
,

113 
size_t
 
bËn
, 
u32
 *
»cÜds
,

114 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
,

115 
boŞ
 
is_u£r
)

117 
u16
 
»ad_by‹s
 = 0, 
»c_sz
 = 0;

118 
u32
 
gÙ_»cÜds
 = 0, 
»q_»cÜds
 = -1;

119 
»t_ignÜe
 = 0;

121 ià(
	`scsc_wlog_ršg_is_æushšg
(
r
))

129 ià(
»cÜds
)

130 
»q_»cÜds
 = *
»cÜds
;

144 
	`¿w_¥š_lock
(&
r
->
¾ock
);

145 !
	`scsc_wlog_is_ršg_em±y
(
r
è&& 
gÙ_»cÜds
 < 
»q_»cÜds
) {

146 
»c_sz
 = 
	`REC_SZ
(
r
, 
	`RPOS
(r));

147 ià(
»ad_by‹s
 + 
»c_sz
 > 
bËn
)

153 ià(
is_u£r
)

155 
»t_ignÜe
 = 
	`cİy_to_u£r
(
buf
 + 
»ad_by‹s
, 
	`REC_START
(
r
, 
	`RPOS
Ô)), 
»c_sz
);

158 
	`memıy
(
buf
 + 
»ad_by‹s
, 
	`REC_START
(
r
, 
	`RPOS
Ô)), 
»c_sz
);

160 
»ad_by‹s
 +ğ
»c_sz
;

161 
r
->
¡
.
»ad_by‹s
 +ğ
»c_sz
;

162 
gÙ_»cÜds
++;

164 ià(
¡©us
)

165 *
¡©us
 = 
r
->
¡
;

166 
	`¿w_¥š_uÆock
(&
r
->
¾ock
);

168 ià(
»cÜds
)

169 *
»cÜds
 = 
gÙ_»cÜds
;

170 
	`SCSC_TAG_DBG4
(
WLOG
, "BytesRead:%d -- RecordsRead:%d\n",

171 
»ad_by‹s
, 
gÙ_»cÜds
);

173  
»ad_by‹s
;

174 
	}
}

176 
	$wlog_deçuÉ_ršg_d¿š”
(
scsc_wlog_ršg
 *
r
, 
size_t
 
d¿š_sz
)

178 
rv®
 = 0, 
d¿šed_by‹s
 = 0;

179 
size_t
 
chunk_sz
 = 
d¿š_sz
 <ğ
r
->drain_sz ? drain_sz :„->drain_sz;

180 
scsc_wifi_ršg_bufãr_¡©us
 
ršg_¡©us
 = {};

183 
	`mu‹x_lock
(&
r
->
d¿š_lock
);

186 
rv®
 = 
r
->
İs
.
	`»ad_»cÜds
Ô,„->
d¿š_buf
, 
chunk_sz
, 
NULL
, &
ršg_¡©us
, 
çl£
);

188 ià(!
r
->
æushšg
) {

189 
	`mu‹x_lock
(&
r
->
wl
->
lock
);

190 ià(
rv®
 > 0 && 
r
->
wl
->
Ú_ršg_bufãr_d©a_cb
) {

191 
	`SCSC_TAG_DEBUG
(
WLOG
,

193 
r
->
wl
->
Ú_ršg_bufãr_d©a_cb
, 
rv®
);

194 
r
->
wl
->
	`Ú_ršg_bufãr_d©a_cb
Ô->
¡
.
Çme
,„->
d¿š_buf
, 
rv®
,

195 &
ršg_¡©us
, 
r
->
wl
->
Ú_ršg_bufãr_ùx
);

196 
	`SCSC_TAG_DBG4
(
WLOG
, "C®lback…roûs£d %d by‹s\n", 
rv®
);

198 
	`mu‹x_uÆock
(&
r
->
wl
->
lock
);

200 
d¿šed_by‹s
 +ğ
rv®
;

201 } 
rv®
 && 
d¿šed_by‹s
 <ğ
d¿š_sz
);

202 
	`SCSC_TAG_DBG3
(
WLOG
, "% %d by‹s\n", (
r
->
æushšg
) ? "Flushed" : "Drained",

203 
d¿šed_by‹s
);

206 ià(
r
->
æushšg
) {

207 
æags
;

210 
	`¿w_¥š_lock_œq§ve
(&
r
->
wlock
, 
æags
);

211 
r
->
drİ³d
 = 0;

212 
r
->
¡
.
wr™‹n_»cÜds
 = 0;

213 
r
->
¡
.
»ad_by‹s
 =„->¡.
wr™‹n_by‹s
 = 0;

214 
r
->
æushšg
 = 
çl£
;

215 
	`¿w_¥š_uÆock_œq»¡Üe
(&
r
->
wlock
, 
æags
);

216 
	`SCSC_TAG_INFO
(
WLOG
, "Ršg '%s' flushed.\n", 
r
->
¡
.
Çme
);

218 
	`mu‹x_uÆock
(&
r
->
d¿š_lock
);

220  
d¿šed_by‹s
;

221 
	}
}

267 
	$wlog_wr™e_»cÜd
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

268 *
ršg_hdr
, 
size_t
 
hËn
, 
u32
 
v”bo£_Ëv–
, 
u64
 
time¡amp
)

270 
u8
 *
¡¬t
 = 
NULL
;

271 
u16
 
chunk_sz
;

272 
æags
;

274 ià(
	`scsc_wlog_ršg_is_æushšg
(
r
))

278 ià(!
	`scsc_wlog_is_mes§ge_®lowed
(
r
, 
v”bo£_Ëv–
))

282 
chunk_sz
 = (
scsc_wifi_ršg_bufãr_’Œy
è+ 
hËn
 + 
bËn
;

283 ià(
chunk_sz
 > 
MAX_RECORD_SZ
) {

284 
	`SCSC_TAG_WARNING
(
WLOG
, "Dropping„ecordƒxceeding %d bytes\n",

285 
chunk_sz
);

289 
	`¿w_¥š_lock_œq§ve
(&
r
->
wlock
, 
æags
);

295 ià(!
r
->
drİ_Ú_fuÎ
 &&„->
mš_d©a_size
 &&

296 
	`AVAIL_BYTES
(
r
è>ğr->
mš_d©a_size
)

297 
	`queue_wÜk
(
r
->
d¿š_wÜkq
, &r->
d¿š_wÜk
);

305 ià(!
	`CAN_FIT
(
r
, 
chunk_sz
)) {

306 
	`SCSC_TAG_DBG4
(
WLOG
, "[%s]:: dropped %zd bytes\n",

307 
r
->
¡
.
Çme
, 
bËn
 + 
hËn
);

308 
r
->
drİ³d
 +ğ
bËn
 + 
hËn
;

309 
	`¿w_¥š_uÆock_œq»¡Üe
(&
r
->
wlock
, 
æags
);

313 
¡¬t
 = 
	`REC_START
(
r
, 
	`WPOS
(r));

314 
	`REC_HEADER_FILL
(
¡¬t
, 
hËn
 + 
bËn
, 
time¡amp
, (
u8
)
r
->
¡
.
æags
,„->
ty³
);

315 
¡¬t
 +ğ(
scsc_wifi_ršg_bufãr_’Œy
);

316 ià(
hËn
) {

317 
	`memıy
(
¡¬t
, 
ršg_hdr
, 
hËn
);

318 
¡¬t
 +ğ
hËn
;

320 ià(
bËn
)

321 
	`memıy
(
¡¬t
, 
buf
, 
bËn
);

323 ià(
¡¬t
 + 
bËn
 > 
	`BUF_END
(
r
))

324 
	`memıy
(
	`BUF_START
(
r
), 
	`BUF_END
Ô), 
¡¬t
 + 
bËn
 - BUF_END(r));

325 
r
->
¡
.
wr™‹n_by‹s
 +ğ
chunk_sz
;

326 
r
->
¡
.
wr™‹n_»cÜds
++;

327 
	`¿w_¥š_uÆock_œq»¡Üe
(&
r
->
wlock
, 
æags
);

329  
chunk_sz
;

330 
	}
}

332 
	$wlog_deçuÉ_ršg_cÚfig_chªge
(
scsc_wlog_ršg
 *
r
,

333 
u32
 
v”bo£_Ëv–
, u32 
æags
,

334 
u32
 
max_š‹rv®_£c
,

335 
u32
 
mš_d©a_size
)

337 
u32
 
Şd_š‹rv®_£c
;

339 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring: %s -- configuration change.\n",

340 
r
->
¡
.
Çme
);

342 
r
->
mš_d©a_size
 = min_data_size;

343 
Şd_š‹rv®_£c
 = 
r
->
max_š‹rv®_£c
;

344 
r
->
max_š‹rv®_£c
 = max_interval_sec;

346 ià(
r
->
¡©e
 =ğ
RING_STATE_SUSPEND
 &&„->
¡
.
v”bo£_Ëv–
) {

350 ià(
r
->
max_š‹rv®_£c
)

351 
	`mod_tim”
(&
r
->
d¿š_tim”
,

352 
jiff›s
 + 
	`m£cs_to_jiff›s
(
r
->
max_š‹rv®_£c
 * 1000));

353 
r
->
¡©e
 = 
RING_STATE_ACTIVE
;

354 
	`SCSC_TAG_INFO
(
WLOG
, "ACTIVATED„šg: %s\n", 
r
->
¡
.
Çme
);

355 } ià(
r
->
¡©e
 =ğ
RING_STATE_ACTIVE
 && !r->
¡
.
v”bo£_Ëv–
) {

357 
	`d–_tim”_sync
(&
r
->
d¿š_tim”
);

358 
	`ÿnûl_wÜk_sync
(&
r
->
d¿š_wÜk
);

359 
r
->
¡©e
 = 
RING_STATE_SUSPEND
;

360 
	`SCSC_TAG_INFO
(
WLOG
, "SUSPENDED„šg: %s\n", 
r
->
¡
.
Çme
);

361 } ià(
r
->
¡©e
 =ğ
RING_STATE_ACTIVE
) {

362 ià(
Şd_š‹rv®_£c
 !ğ
r
->
max_š‹rv®_£c
) {

363 ià(!
r
->
max_š‹rv®_£c
)

364 
	`d–_tim”_sync
(&
r
->
d¿š_tim”
);

366 
	`mod_tim”
(&
r
->
d¿š_tim”
,

367 
jiff›s
 + 
	`m£cs_to_jiff›s
(
r
->
max_š‹rv®_£c
 * 1000));

369 
	`SCSC_TAG_INFO
(
WLOG
, "RECONFIGURED„šg: %s\n", 
r
->
¡
.
Çme
);

373 
	}
}

375 
wifi_”rÜ
 
	$wlog_¡¬t_loggšg
(
scsc_wlog_ršg
 *
r
,

376 
u32
 
v”bo£_Ëv–
, u32 
æags
,

377 
u32
 
max_š‹rv®_£c
,

378 
u32
 
mš_d©a_size
)

380 ià(!
r
)

381  
WIFI_ERROR_INVALID_ARGS
;

383 
	`scsc_wlog_ršg_chªge_v”bos™y
(
r
, 
v”bo£_Ëv–
);

384 
	`wlog_deçuÉ_ršg_cÚfig_chªge
(
r
, 
v”bo£_Ëv–
, 
æags
,

385 
max_š‹rv®_£c
, 
mš_d©a_size
);

387  
WIFI_SUCCESS
;

388 
	}
}

390 
scsc_wlog_ršg_İs
 
	gdeçuÉ_ršg_İs
 = {

391 .
š™
 = 
NULL
,

392 .
	gfš®ize
 = 
NULL
,

393 .
	gg‘_ršg_¡©us
 = 
wlog_g‘_ršg_¡©us
,

394 .
	g»ad_»cÜds
 = 
wlog_»ad_»cÜds
,

395 .
	gwr™e_»cÜd
 = 
wlog_wr™e_»cÜd
,

396 .
	glogËv–_chªge
 = 
NULL
,

397 .
	gd¿š_ršg
 = 
wlog_deçuÉ_ršg_d¿š”
,

398 .
	g¡¬t_loggšg
 = 
wlog_¡¬t_loggšg
,

401 
	$scsc_wlog_ršg_de¡roy
(
scsc_wlog_ršg
 *
r
)

403 ià(!
r
 ||„->
»gi¡”ed
) {

404 
	`SCSC_TAG_ERR
(
WLOG
, "CªnÙ de¡roy„šg„:%p\n", 
r
);

408 ià(
r
->
š™Ÿlized
 &&„->
İs
.
fš®ize
)

409 
r
->
İs
.
	`fš®ize
(r);

410 
	`wlog_ršg_fš®ize
(
r
);

411 
	`kä“
(
r
);

412 
	}
}

414 
scsc_wlog_ršg
 *
	$scsc_wlog_ršg_ü—‹
(*
ršg_Çme
, 
u32
 
æags
,

415 
u8
 
ty³
, 
u32
 
size
,

416 
ã©u»s_mask
,

417 
š™_cb
 
š™
, 
fš®ize_cb
 
fši
,

418 *
´iv
)

420 
scsc_wlog_ršg
 *
r
 = 
NULL
;

422 
	`WARN_ON
(!
ršg_Çme
 || !
size
);

424 
r
 = 
	`kz®loc
((*r), 
GFP_KERNEL
);

425 ià(!
r
)

426  
r
;

427 
r
->
ty³
 =ype;

428 
r
->
¡
.
æags
 = flags;

429 
r
->
¡
.
rb_by‹_size
 = 
size
;

430 ià(
	`¢´štf
(
r
->
¡
.
Çme
, 
RING_NAME_SZ
 - 1, "%s", 
ršg_Çme
) >= RING_NAME_SZ)

431 
	`SCSC_TAG_WARNING
(
WLOG
, "Ring‚ameoo†ong...truncatedo: %s\n",

432 
r
->
¡
.
Çme
);

434 
	`memıy
(&
r
->
İs
, &
deçuÉ_ršg_İs
, (
scsc_wlog_ršg_İs
));

435 
r
->
İs
.
š™
 = init;

436 
r
->
İs
.
fš®ize
 = 
fši
;

437 
r
->
´iv
 =…riv;

439 ià(
	`wlog_ršg_š™
(
r
)) {

440 
	`SCSC_TAG_ERR
(
WLOG
,

442 
r
->
¡
.
Çme
);

443 
	`kä“
(
r
);

444  
NULL
;

446 ià(
r
->
İs
.
š™
) {

447 ià(
r
->
İs
.
	`š™
(r)) {

448 
	`SCSC_TAG_DBG4
(
WLOG
,

450 
r
->
¡
.
Çme
);

452 
	`SCSC_TAG_ERR
(
WLOG
,

454 
r
->
¡
.
Çme
);

455 
	`scsc_wlog_ršg_de¡roy
(
r
);

456  
NULL
;

459 
r
->
ã©u»s_mask
 = features_mask;

460 
	`¿w_¥š_lock_š™
(&
r
->
¾ock
);

461 
	`¿w_¥š_lock_š™
(&
r
->
wlock
);

462 
r
->
š™Ÿlized
 = 
Œue
;

463 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ršg '%s' in™Ÿlized.\n", 
r
->
¡
.
Çme
);

465  
r
;

466 
	}
}

468 
	$scsc_wlog_»gi¡”_logËv–_chªge_cb
(
scsc_wlog_ršg
 *
r
,

469 (*
ÿÎback
)(
scsc_wlog_ršg
 *
r
, 
u32
 
Ãw_logËv–
))

471 ià(!
ÿÎback
)

472 
r
->
İs
.
logËv–_chªge
 = 
NULL
;

474 
r
->
İs
.
logËv–_chªge
 = 
ÿÎback
;

477 
	}
}

479 
	$scsc_wlog_d¿š_whŞe_ršg
(
scsc_wlog_ršg
 *
r
)

481 
	`SCSC_TAG_INFO
(
WLOG
, "D¿ššg whŞršg %s\n", 
r
->
¡
.
Çme
);

482  
r
->
İs
.
	`d¿š_ršg
Ô,„->
¡
.
rb_by‹_size
);

483 
	}
}

485 
	$scsc_wlog_æush_ršg
(
scsc_wlog_ršg
 *
r
)

487 
r
->
æushšg
 = 
Œue
;

489 
	`queue_wÜk
(
r
->
d¿š_wÜkq
, &r->
d¿š_wÜk
);

490 
	}
}

	@scsc_wifilogger_core.h

6 #iâdeà
_SCSC_WIFILOGGER_CORE_H_


7 
	#_SCSC_WIFILOGGER_CORE_H_


	)

64 
	~"scsc_wifogg”_ty³s.h
"

65 
	~"scsc_wifogg”_š‹º®.h
"

67 
	#DRAIN_BUF_SZ
 4096

	)

69 
	#BUF_SZ
(
r
è(Ô)->
¡
.
rb_by‹_size
)

	)

70 
	#BUF_START
(
r
è(Ô)->
buf
)

	)

71 
	#BUF_END
(
r
è(Ô)->
buf
 + 
	`BUF_SZ
Ô))

	)

72 
	#AVAIL_BYTES
(
r
è(Ô)->
¡
.
wr™‹n_by‹s
 - (r)->¡.
»ad_by‹s
)

	)

79 
	#RPOS
(
r
) \

80 ((
r
)->
¡
.
»ad_by‹s
 & (
	`BUF_SZ
Ôè- 1))

	)

82 
	#WPOS
(
r
) \

83 ((
r
)->
¡
.
wr™‹n_by‹s
 & (
	`BUF_SZ
Ôè- 1))

	)

85 
	#WPOS_INC
(
r
, 
by‹s
) \

86 (((
r
)->
¡
.
wr™‹n_by‹s
 + (
by‹s
)è& (
	`BUF_SZ
Ôè- 1))

	)

88 
	#REC_PAYLOAD_SZ
(
r
, 
pos
) \

89 (*((
u16
 *)((
r
)->
buf
 + (
pos
))))

	)

91 
	#REC_SZ
(
r
, 
pos
) \

92 (
	`REC_PAYLOAD_SZ
(
r
, 
pos
è+ (
scsc_wifi_ršg_bufãr_’Œy
))

	)

94 
	#REC_START
(
r
, 
pos
è(Ô)->
buf
 + (pos))

	)

96 
	#IS_EMPTY
(
r
) \

97 ((
r
)->
¡
.
»ad_by‹s
 =ğÔ)->¡.
wr™‹n_by‹s
)

	)

99 
	#CAN_FIT
(
r
, 
by‹s
) \

100 (
by‹s
 < 
	`BUF_SZ
(
r
) && \

101 (
	`IS_EMPTY
(
r
) || \

102 (
	`WPOS
(
r
è< 
	`RPOS
Ôè&& WPOSÔè+ (
by‹s
) < RPOS(r)) || \

103 (
	`WPOS
(
r
è> 
	`RPOS
Ôè&& (WPOSÔè+ (
by‹s
è< 
	`BUF_SZ
Ôè|| 
	`WPOS_INC
Ô, by‹sè< RPOSÔ)))))

	)

105 
	#REC_HEADER_FILL
(
±r
, 
·ylßd_sz
, 
¹ime¡amp
, 
ræags
, 
¹y³
) \

107 
scsc_wifi_ršg_bufãr_’Œy
 *
h
 = \

108 (
scsc_wifi_ršg_bufãr_’Œy
 *)(
±r
); \

110 
h
->
’Œy_size
 = (
·ylßd_sz
); \

111 
h
->
æags
 |ğ(
ræags
è| 
RING_BUFFER_ENTRY_FLAGS_HAS_TIMESTAMP
; \

112 
h
->
ty³
 = (
¹y³
); \

113 
h
->
time¡amp
 = (
¹ime¡amp
è?: 
	`loÿl_şock
();\

114 } 0)

	)

116 
	#MINIMUM_DRAIN_CHUNK_BYTES
 1024

	)

117 
	#DEFAULT_DRAIN_CHUNK_SZ
(
r
è(Ô)->
¡
.
rb_by‹_size
 / 2)

	)

118 
	#FORCE_DRAIN_CHUNK_SZ
(
r
è(Ô)->
¡
.
rb_by‹_size
 / 4)

	)

119 
	#MAX_RECORD_SZ
 8192

	)

122 
	mRING_STATE_SUSPEND
,

123 
	mRING_STATE_ACTIVE


126 
	gscsc_wlog_ršg
;

128 
	$boŞ
 (*
	tš™_cb
)(
	tscsc_wlog_ršg
 *
	tr
);

129 
	$boŞ
 (*
	tfš®ize_cb
)(
	tscsc_wlog_ršg
 *
	tr
);

131 
	sscsc_wlog_ršg_İs
 {

132 
š™_cb
 
š™
;

133 
fš®ize_cb
 
fš®ize
;

135 
	`wifi_”rÜ
 (*
g‘_ršg_¡©us
)(
scsc_wlog_ršg
 *
r
,

136 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
);

137 (*
»ad_»cÜds
)(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

138 
u32
 *
»cÜds
, 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
, 
boŞ
 
is_u£r
);

139 (*
wr™e_»cÜd
)(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

140 *
hdr
, 
size_t
 
hËn
, 
u32
 
v”bo£_Ëv–
, 
u64
 
time¡amp
);

141 (*
logËv–_chªge
)(
scsc_wlog_ršg
 *
r
, 
u32
 
Ãw_logËv–
);

142 (*
d¿š_ršg
)(
scsc_wlog_ršg
 *
r
, 
size_t
 
d¿š_sz
);

143 
	`wifi_”rÜ
 (*
¡¬t_loggšg
)(
scsc_wlog_ršg
 *
r
, 
u32
 
v”bo£_Ëv–
,

144 
u32
 
æags
, u32 
max_š‹rv®_£c
,

145 
u32
 
mš_d©a_size
);

148 
	sscsc_wlog_ršg
 {

149 
boŞ
 
š™Ÿlized
;

150 
boŞ
 
»gi¡”ed
;

151 
boŞ
 
æushšg
;

152 
boŞ
 
drİ_Ú_fuÎ
;

153 
u8
 
¡©e
;

155 
u8
 *
buf
;

156 
ã©u»s_mask
;

157 
u8
 
ty³
;

158 
u32
 
mš_d©a_size
;

159 
u32
 
max_š‹rv®_£c
;

160 
u32
 
drİ³d
;

161 
u32
 *
v”bos™y
;

162 
¿w_¥šlock_t
 
¾ock
, 
wlock
;

163 
scsc_wifi_ršg_bufãr_¡©us
 
¡
;

165 
u8
 *
d¿š_buf
;

166 
size_t
 
d¿š_sz
;

167 
mu‹x
 
d¿š_lock
;

168 
tim”_li¡
 
d¿š_tim”
;

169 
wÜk_¡ruù
 
d¿š_wÜk
;

170 
wÜkqueue_¡ruù
 *
d¿š_wÜkq
;

172 
scsc_wlog_ršg_İs
 
İs
;

174 *
´iv
;

176 
scsc_wifi_logg”
 *
wl
;

179 
scsc_wlog_ršg
 *
	`scsc_wlog_ršg_ü—‹
(*
ršg_Çme
, 
u32
 
æags
,

180 
u8
 
ty³
, 
u32
 
size
,

181 
ã©u»s_mask
,

182 
š™_cb
 
š™
, 
fš®ize_cb
 
fši
,

183 *
´iv
);

185 
	`scsc_wlog_ršg_de¡roy
(
scsc_wlog_ršg
 *
r
);

187 
	`scsc_wlog_»gi¡”_logËv–_chªge_cb
(
scsc_wlog_ršg
 *
r
,

188 (*
ÿÎback
)(
scsc_wlog_ršg
 *
r
,

189 
u32
 
Ãw_logËv–
));

191 
	`scsc_wlog_d¿š_whŞe_ršg
(
scsc_wlog_ršg
 *
r
);

193 
šlše
 
boŞ
 
	$scsc_wlog_is_ršg_em±y
(
scsc_wlog_ršg
 *
r
)

195  
r
->
¡
.
wr™‹n_by‹s
 =ğr->¡.
»ad_by‹s
;

196 
	}
}

198 
šlše
 
wifi_”rÜ
 
	$scsc_wlog_g‘_ršg_¡©us
(
scsc_wlog_ršg
 *
r
,

199 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

201 ià(!
r
)

202  
WIFI_ERROR_INVALID_ARGS
;

204  
r
->
İs
.
	`g‘_ršg_¡©us
Ô, 
¡©us
);

205 
	}
}

207 
šlše
 
boŞ
 
	$scsc_wlog_is_mes§ge_®lowed
(
scsc_wlog_ršg
 *
r
, 
u32
 
v”bo£_Ëv–
)

209  
r
->
¡
.
v”bo£_Ëv–
 && verbose_level <=„->st.verbose_level;

210 
	}
}

212 
šlše
 
	$scsc_wlog_»ad_»cÜds
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
, 
boŞ
 
is_u£r
)

214  
r
->
İs
.
	`»ad_»cÜds
Ô, 
buf
, 
bËn
, 
NULL
, NULL, 
çl£
);

215 
	}
}

217 
šlše
 
	$scsc_wlog_»ad_max_»cÜds
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
,

218 
size_t
 
bËn
, 
u32
 *
max_»cÜds
, 
boŞ
 
is_u£r
)

220  
r
->
İs
.
	`»ad_»cÜds
Ô, 
buf
, 
bËn
, 
max_»cÜds
, 
NULL
, 
is_u£r
);

221 
	}
}

223 
šlše
 
	$scsc_wlog_wr™e_»cÜd
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

224 *
hdr
, 
size_t
 
hËn
, 
u32
 
v”bo£_Ëv–
, 
u64
 
time¡amp
)

226  
r
->
İs
.
	`wr™e_»cÜd
Ô, 
buf
, 
bËn
, 
hdr
, 
hËn
, 
v”bo£_Ëv–
, 
time¡amp
);

227 
	}
}

229 
šlše
 
wifi_”rÜ
 
	$scsc_wlog_¡¬t_loggšg
(
scsc_wlog_ršg
 *
r
,

230 
u32
 
v”bo£_Ëv–
, u32 
æags
,

231 
u32
 
max_š‹rv®_£c
, u32 
mš_d©a_size
)

233  
r
->
İs
.
	`¡¬t_loggšg
Ô, 
v”bo£_Ëv–
, 
æags
, 
max_š‹rv®_£c
, 
mš_d©a_size
);

234 
	}
}

236 
šlše
 
	$scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
scsc_wlog_ršg
 *
r
)

238 
r
->
drİ_Ú_fuÎ
 = 
Œue
;

239 
	}
}

241 
šlše
 
	$scsc_wlog_»gi¡”_v”bos™y_»ã»nû
(
scsc_wlog_ršg
 *
r
, 
u32
 *
v”bo£_»f
)

243 
r
->
v”bos™y
 = 
v”bo£_»f
;

244 
	}
}

246 
šlše
 
boŞ
 
	$scsc_wlog_ršg_is_æushšg
(
scsc_wlog_ršg
 *
r
)

248 ià(!
r
->
æushšg
)

249  
çl£
;

251 
	`SCSC_TAG_DBG4
(
WLOG
, "Ring is flushing..abort…ending„ead/write\n");

252  
Œue
;

253 
	}
}

255 
šlše
 
	$scsc_wlog_ršg_chªge_v”bos™y
(
scsc_wlog_ršg
 *
r
, 
u32
 
v”bo£_Ëv–
)

257 ià(
r
->
¡
.
v”bo£_Ëv–
 != verbose_level) {

258 ià(
r
->
İs
.
logËv–_chªge
)

259 
r
->
İs
.
	`logËv–_chªge
Ô, 
v”bo£_Ëv–
);

260 
r
->
¡
.
v”bo£_Ëv–
 = verbose_level;

261 ià(
r
->
v”bos™y
)

262 *
r
->
v”bos™y
 =„->
¡
.
v”bo£_Ëv–
;

263 
	`SCSC_TAG_INFO
(
WLOG
, "Ring: %s -- verbose_level changedo: %d\n",

264 
r
->
¡
.
Çme
,„->¡.
v”bo£_Ëv–
);

266 
	}
}

268 
scsc_wlog_æush_ršg
(
scsc_wlog_ršg
 *
r
);

	@scsc_wifilogger_debugfs.c

6 
	~<lšux/uacûss.h
>

7 
	~"scsc_wifogg”_debugfs.h
"

8 
	~"scsc_wifogg”_ršg_pktç‹.h
"

10 
d’Œy
 *
	gscsc_wlog_debugfs_glob®_roÙ
;

12 
	$dfs_İ’
(
šode
 *
šo
, 
fe
 *
fp
)

14 ià(!
fp
->
´iv©e_d©a
) {

15 
fp
->
´iv©e_d©a
 = 
šo
->
i_´iv©e
;

16 ià(!
fp
->
´iv©e_d©a
)

17  -
EFAULT
;

20 
	}
}

22 
	$dfs_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
)

25 
	}
}

27 
	#SCSC_RING_TEST_STAT_SZ
 512

	)

29 
ssize_t
 
	$dfs_¡©s_»ad
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

30 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

32 
¦’
 = 0;

33 
¡©¡r
[
SCSC_RING_TEST_STAT_SZ
] = {};

34 
scsc_ršg_‹¡_objeù
 *
¹o
 = 
fp
->
´iv©e_d©a
;

36 
¦’
 = 
	`¢´štf
(
¡©¡r
, 
SCSC_RING_TEST_STAT_SZ
,

39 
¹o
->
r
->
¡
.
Çme
,„to->r->¡.
rb_by‹_size
,„to->r->
¡©e
,

40 
¹o
->
r
->
¡
.
v”bo£_Ëv–
,„to->r->
mš_d©a_size
,

41 
¹o
->
r
->
max_š‹rv®_£c
,„to->r->
drİ_Ú_fuÎ
,

42 
¹o
->
r
->
¡
.
wr™‹n_by‹s
 -„to->r->¡.
»ad_by‹s
,

43 
¹o
->
r
->
¡
.
wr™‹n_by‹s
,„to->r->¡.
»ad_by‹s
,

44 
¹o
->
r
->
¡
.
wr™‹n_»cÜds
,„to->r->
drİ³d
,„to->r->
buf
);

45 ià(
¦’
 >ğ0 && *
f_pos
 < slen) {

46 
couÁ
 = (couÁ <ğ
¦’
 - *
f_pos
) ? count : (slen - *f_pos);

47 ià(
	`cİy_to_u£r
(
ubuf
, 
¡©¡r
 + *
f_pos
, 
couÁ
))

48  -
EFAULT
;

49 *
f_pos
 +ğ
couÁ
;

51 
couÁ
 = 0;

53  
couÁ
;

54 
	}
}

56 cÚ¡ 
fe_İ”©iÚs
 
	g¡©s_fİs
 = {

57 .
owÃr
 = 
THIS_MODULE
,

58 .
	gİ’
 = 
dfs_İ’
,

59 .
	g»ad
 = 
dfs_¡©s_»ad
,

60 .
	g»Ëa£
 = 
dfs_»Ëa£
,

63 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


64 
	$dfs_»ad_»cÜd_İ’
(
šode
 *
šo
, 
fe
 *
fp
)

66 
»t
;

67 
scsc_ršg_‹¡_objeù
 *
¹o
;

69 
»t
 = 
	`dfs_İ’
(
šo
, 
fp
);

70 ià(
»t
)

71  
»t
;

73 
¹o
 = 
fp
->
´iv©e_d©a
;

74 ià(!
	`mu‹x_Œylock
(&
¹o
->
»ad”s_lock
)) {

75 
	`SCSC_TAG_ERR
(
WLOG
,

77 
	`dfs_»Ëa£
(
šo
, 
fp
);

78  -
EPERM
;

81 
	`scsc_wifi_¡¬t_loggšg
(1, 0x00, 0, 8192, 
¹o
->
r
->
¡
.
Çme
);

83  
»t
;

84 
	}
}

86 
	$dfs_»ad_»cÜd_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
)

88 
scsc_ršg_‹¡_objeù
 *
¹o
 = 
fp
->
´iv©e_d©a
;

91 
	`scsc_wifi_¡¬t_loggšg
(0, 0x00, 0, 8192, 
¹o
->
r
->
¡
.
Çme
);

92 
	`mu‹x_uÆock
(&
¹o
->
»ad”s_lock
);

93 
	`SCSC_TAG_DEBUG
(
WLOG
, "Readers mutex„eleased.\n");

95  
	`dfs_»Ëa£
(
šo
, 
fp
);

96 
	}
}

98 
ssize_t
 
	$dfs_»ad_»cÜd
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

99 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

101 
»t
;

102 
scsc_ršg_‹¡_objeù
 *
¹o
;

104 ià(!
fp
->
´iv©e_d©a
)

105  -
EINVAL
;

106 
¹o
 = 
fp
->
´iv©e_d©a
;

108 
	`scsc_wlog_is_ršg_em±y
(
¹o
->
r
)) {

109 ià(
	`wa™_ev’t_š‹¼u±ibË
(
¹o
->
rw_wq
,

110 !
	`scsc_wlog_is_ršg_em±y
(
¹o
->
r
)))

111  -
ERESTARTSYS
;

113 
»t
 = 
	`scsc_wlog_»ad_»cÜds
(
¹o
->
r
,„to->
rbuf
,„to->
bsz
, 
çl£
);

114 
couÁ
 = 
»t
 <= count ?„et : count;

115 ià(
	`cİy_to_u£r
(
ubuf
, 
¹o
->
rbuf
, 
couÁ
))

116  -
EFAULT
;

117 *
f_pos
 +ğ
couÁ
;

119  
couÁ
;

120 
	}
}

122 cÚ¡ 
fe_İ”©iÚs
 
	g»ad_»cÜd_fİs
 = {

123 .
owÃr
 = 
THIS_MODULE
,

124 .
	gİ’
 = 
dfs_»ad_»cÜd_İ’
,

125 .
	g»ad
 = 
dfs_»ad_»cÜd
,

126 .
	g»Ëa£
 = 
dfs_»ad_»cÜd_»Ëa£
,

129 
	$Ú_ršg_‹¡_d©a_cb
(*
ršg_Çme
, *
buf
, 
bsz
,

130 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
,

131 *
ùx
)

133 
scsc_ršg_‹¡_objeù
 *
a_¹o
, *
h—d_¹o
 = 
ùx
;

135 
a_¹o
 = 
	`kz®loc
((*a_¹o), 
GFP_KERNEL
);

136 ià(!
a_¹o
)

138 
a_¹o
->
rbuf
 = 
	`km®loc
(
bsz
, 
GFP_KERNEL
);

139 ià(!
a_¹o
->
rbuf
) {

140 
	`kä“
(
a_¹o
);

144 
	`memıy
(
a_¹o
->
rbuf
, 
buf
, 
bsz
);

145 
a_¹o
->
bsz
 = bsz;

146 
	`li¡_add_
(&
a_¹o
->
–em
, &
h—d_¹o
->elem);

147 
	`wake_up_š‹¼u±ibË
(&
h—d_¹o
->
d¿š_wq
);

148 
	}
}

150 
	$dfs_»ad_İ’
(
šode
 *
šo
, 
fe
 *
fp
)

152 
»t
;

153 
scsc_ršg_‹¡_objeù
 *
¹o
;

155 
»t
 = 
	`dfs_İ’
(
šo
, 
fp
);

156 ià(
»t
)

157  
»t
;

160 
¹o
 = 
fp
->
´iv©e_d©a
;

161 ià(!
	`mu‹x_Œylock
(&
¹o
->
»ad”s_lock
)) {

162 
	`SCSC_TAG_ERR
(
WLOG
,

164 
	`dfs_»Ëa£
(
šo
, 
fp
);

165  -
EPERM
;

168 
	`SCSC_TAG_DEBUG
(
WLOG
,

170 
¹o
->
r
->
¡
.
Çme
);

171 
	`scsc_wifi_£t_log_hªdËr
(
Ú_ršg_‹¡_d©a_cb
, 
¹o
);

172 
	`scsc_wifi_¡¬t_loggšg
(1, 0x00, 2, 8192, 
¹o
->
r
->
¡
.
Çme
);

174  
»t
;

175 
	}
}

177 
ssize_t
 
	$dfs_»ad
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

178 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

180 
size_t
 
»t_couÁ
 = 0;

181 
li¡_h—d
 *
pos
 = 
NULL
, *
i¡
 = NULL;

182 
scsc_ršg_‹¡_objeù
 *
h—d_¹o
, *
a_¹o
;

184 ià(!
fp
->
´iv©e_d©a
)

185  -
EINVAL
;

186 
h—d_¹o
 = 
fp
->
´iv©e_d©a
;

188 
	`li¡_em±y
(&
h—d_¹o
->
–em
)) {

189 ià(
	`wa™_ev’t_š‹¼u±ibË
(
h—d_¹o
->
d¿š_wq
, !
	`li¡_em±y
(&h—d_¹o->
–em
)))

190  -
ERESTARTSYS
;

193 
	`li¡_fÜ_—ch_§ã
(
pos
, 
i¡
, &
h—d_¹o
->
–em
) {

194 
a_¹o
 = 
	`li¡_’Œy
(
pos
, 
scsc_ršg_‹¡_objeù
, 
–em
);

195 
	`SCSC_TAG_DEBUG
(
WLOG
, "Proûssšg†i¡ i‹m: %p\n", 
a_¹o
);

196 ià(!
a_¹o
 || 
»t_couÁ
 +‡_¹o->
bsz
 >ğ
couÁ
) {

197 
	`SCSC_TAG_DEBUG
(
WLOG
, "BREAK OUT on:%p\n", 
a_¹o
);

198 
	`li¡_d–
(
pos
);

199 ià(
a_¹o
) {

200 
	`kä“
(
a_¹o
->
rbuf
);

201 
	`kä“
(
a_¹o
);

205 ià(
	`cİy_to_u£r
(
ubuf
 + 
»t_couÁ
, 
a_¹o
->
rbuf
,‡_¹o->
bsz
))

206  -
EFAULT
;

207 
»t_couÁ
 +ğ
a_¹o
->
bsz
;

208 
	`li¡_d–
(
pos
);

209 
	`kä“
(
a_¹o
->
rbuf
);

210 
	`kä“
(
a_¹o
);

212 *
f_pos
 +ğ
»t_couÁ
;

214  
couÁ
;

215 
	}
}

217 
	$dfs_»ad_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
)

219 
»t
;

220 
scsc_ršg_‹¡_objeù
 *
h—d_¹o
, *
a_¹o
;

222 
h—d_¹o
 = 
fp
->
´iv©e_d©a
;

223 ià(
h—d_¹o
) {

224 
li¡_h—d
 *
pos
 = 
NULL
, *
i¡
 = NULL;

226 
	`li¡_fÜ_—ch_§ã
(
pos
, 
i¡
, &
h—d_¹o
->
–em
) {

227 
a_¹o
 = 
	`li¡_’Œy
(
pos
, 
scsc_ršg_‹¡_objeù
, 
–em
);

228 
	`li¡_d–
(
pos
);

229 ià(
a_¹o
) {

230 
	`kä“
(
a_¹o
->
rbuf
);

231 
	`kä“
(
a_¹o
);

232 
a_¹o
 = 
NULL
;

237 
»t
 = 
	`dfs_»ad_»cÜd_»Ëa£
(
šo
, 
fp
);

238 
	`scsc_wifi_»£t_log_hªdËr
();

240  
»t
;

241 
	}
}

243 cÚ¡ 
fe_İ”©iÚs
 
	g»ad_fİs
 = {

244 .
owÃr
 = 
THIS_MODULE
,

245 .
	gİ’
 = 
dfs_»ad_İ’
,

246 .
	g»ad
 = 
dfs_»ad
,

247 .
	g»Ëa£
 = 
dfs_»ad_»Ëa£
,

250 
	#BUF_LEN
 16

	)

251 
ssize_t
 
	$dfs_v”bo£_»ad
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

252 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

254 
buf
[
BUF_LEN
] = {};

255 
scsc_ršg_‹¡_objeù
 *
¹o
;

257 ià(!
fp
->
´iv©e_d©a
)

258  -
EINVAL
;

259 
¹o
 = 
fp
->
´iv©e_d©a
;

261 
couÁ
 = 
	`¢´štf
(
buf
, 
BUF_LEN
, "%d\n", 
¹o
->
r
->
¡
.
v”bo£_Ëv–
);

262 ià(
	`cİy_to_u£r
(
ubuf
, 
buf
, 
couÁ
))

263  -
EFAULT
;

265 
couÁ
 = !*
f_pos
 ? count : 0;

266 *
f_pos
 +ğ
couÁ
;

268  
couÁ
;

269 
	}
}

271 
ssize_t
 
	$dfs_v”bo£_wr™e
(
fe
 *
fp
, cÚ¡ 
__u£r
 *
ubuf
,

272 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

274 
buf
[
BUF_LEN
] = {};

275 
size_t
 
wr™‹n
;

276 
v”b
;

277 
scsc_ršg_‹¡_objeù
 *
¹o
;

279 ià(!
fp
->
´iv©e_d©a
)

280  -
EINVAL
;

281 
¹o
 = 
fp
->
´iv©e_d©a
;

283 
couÁ
 = couÁ < 
BUF_LEN
 ? count : BUF_LEN - 1;

284 ià(
	`cİy_äom_u£r
(
buf
, 
ubuf
, 
couÁ
))

285  -
EINVAL
;

286 ià(!
	`k¡¹oul
((cÚ¡ *)
buf
, 10, &
v”b
))

287 
	`scsc_wlog_ršg_chªge_v”bos™y
(
¹o
->
r
, 
v”b
);

288 
wr™‹n
 = 
	`¡¾’
(
buf
);

289 *
f_pos
 +ğ
wr™‹n
;

291 
	`SCSC_TAG_DEBUG
(
WLOG
, "Changed verbosity on„ing %so %d\n",

292 
¹o
->
r
->
¡
.
Çme
,„to->r->¡.
v”bo£_Ëv–
);

294 
¹o
->
r
->
¡
.
v”bo£_Ëv–
) {

296 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s' -- RING FULL DRAIN !\n",

297 
¹o
->
r
->
¡
.
Çme
);

298 
	`scsc_wifi_g‘_ršg_d©a
(
¹o
->
r
->
¡
.
Çme
);

301 
	`scsc_wlog_æush_ršg
(
¹o
->
r
);

302 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s' -- RING FLUSH !\n",

303 
¹o
->
r
->
¡
.
Çme
);

306 
	`scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
¹o
->
r
);

307 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s' -- RING SET DROP ON FULL !\n",

308 
¹o
->
r
->
¡
.
Çme
);

311 ià(
¹o
->
r
->
ã©u»s_mask
 & 
WIFI_LOGGER_PACKET_FATE_SUPPORTED
) {

312 
	`scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
();

313 
	`SCSC_TAG_DEBUG
(
WLOG
, "PKTFATE MONITORING STARTED !\n");

318 
i
, 
num_ršgs
 = 10;

319 
scsc_wifi_ršg_bufãr_¡©us
 
¡©us
[10];

321 
	`scsc_wifogg”_g‘_ršgs_¡©us
(&
num_ršgs
, 
¡©us
);

322 
	`SCSC_TAG_INFO
(
WLOG
, "R‘uºed„šgs: %d\n", 
num_ršgs
);

323 
i
 = 0; i < 
num_ršgs
; i++)

324 
	`SCSC_TAG_INFO
(
WLOG
, "R‘r›ved„šg: %s\n", 
¡©us
[
i
].
Çme
);

331  
wr™‹n
;

332 
	}
}

334 cÚ¡ 
fe_İ”©iÚs
 
	gv”bos™y_fİs
 = {

335 .
owÃr
 = 
THIS_MODULE
,

336 .
	gİ’
 = 
dfs_İ’
,

337 .
	g»ad
 = 
dfs_v”bo£_»ad
,

338 .
	gwr™e
 = 
dfs_v”bo£_wr™e
,

339 .
	g»Ëa£
 = 
dfs_»Ëa£
,

346 
scsc_ršg_‹¡_objeù
 *
	$š™_ršg_‹¡_objeù
(
scsc_wlog_ršg
 *
r
)

348 
scsc_ršg_‹¡_objeù
 *
¹o
;

350 
¹o
 = 
	`kz®loc
((*¹o), 
GFP_KERNEL
);

351 ià(!
¹o
)

352  
¹o
;

354 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


355 
¹o
->
bsz
 = 
MAX_RECORD_SZ
;

356 
¹o
->
rbuf
 = 
	`kz®loc
Ôto->
bsz
, 
GFP_KERNEL
);

357 ià(!
¹o
->
rbuf
) {

358 
	`kä“
(
¹o
);

359  
NULL
;

361 
¹o
->
wbuf
 = 
	`kz®loc
Ôto->
bsz
, 
GFP_KERNEL
);

362 ià(!
¹o
->
wbuf
) {

363 
	`kä“
(
¹o
->
rbuf
);

364 
	`kä“
(
¹o
);

365  
NULL
;

368 
	`INIT_LIST_HEAD
(&
¹o
->
–em
);

369 
	`š™_wa™queue_h—d
(&
¹o
->
d¿š_wq
);

370 
	`š™_wa™queue_h—d
(&
¹o
->
rw_wq
);

371 
	`mu‹x_š™
(&
¹o
->
»ad”s_lock
);

373 
¹o
->
r
 =„;

375  
¹o
;

376 
	}
}

378 *
	$scsc_wlog_»gi¡”_debugfs_’Œy
(cÚ¡ *
ršg_Çme
,

379 cÚ¡ *
âame
,

380 cÚ¡ 
fe_İ”©iÚs
 *
fİs
,

381 *
¹o
,

382 
scsc_wlog_debugfs_šfo
 *
di
)

384 ià(!
ršg_Çme
 || !
âame
 || !
fİs
 || !
¹o
 || !
di
)

385  
NULL
;

388 ià(!
di
->
roÙdœ
) {

389 ià(
scsc_wlog_debugfs_glob®_roÙ
) {

390 
di
->
roÙdœ
 = 
scsc_wlog_debugfs_glob®_roÙ
;

392 
di
->
roÙdœ
 = 
	`debugfs_ü—‹_dœ
(
SCSC_DEBUGFS_ROOT_DIRNAME
, 
NULL
);

393 
scsc_wlog_debugfs_glob®_roÙ
 = 
di
->
roÙdœ
;

395 ià(!
di
->
roÙdœ
)

396 
no_roÙdœ
;

399 ià(!
di
->
ršgdœ
) {

400 
di
->
ršgdœ
 = 
	`debugfs_ü—‹_dœ
(
ršg_Çme
, di->
roÙdœ
);

401 ià(!
di
->
ršgdœ
)

402 
no_ršgdœ
;

406 
	`debugfs_ü—‹_fe
(
âame
, 0664, 
di
->
ršgdœ
, 
¹o
, 
fİs
);

408  
di
;

410 
no_ršgdœ
:

411 
no_roÙdœ
:

412 
	`SCSC_TAG_ERR
(
WLOG
, "Failed WiFiLogger Debugfs basic initialization\n");

413  
NULL
;

414 
	}
}

416 
	$scsc_wifogg”_debugfs_»move_tİ_dœ_»cursive
()

418 ià(!
scsc_wlog_debugfs_glob®_roÙ
)

421 
	`debugfs_»move_»cursive
(
scsc_wlog_debugfs_glob®_roÙ
);

423 
	`SCSC_TAG_INFO
(
WLOG
, "Wi-Fi Logger Debugfs Cleaned Up\n");

424 
	}
}

426 
	$scsc_»gi¡”_commÚ_debugfs_’Œ›s
(*
ršg_Çme
, *
¹o
,

427 
scsc_wlog_debugfs_šfo
 *
di
)

429 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "stats",

430 &
¡©s_fİs
, 
¹o
, 
di
);

431 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


432 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "verbose_level",

433 &
v”bos™y_fİs
, 
¹o
, 
di
);

434 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "read_record",

435 &
»ad_»cÜd_fİs
, 
¹o
, 
di
);

436 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "read",

437 &
»ad_fİs
, 
¹o
, 
di
);

439 
	}
}

	@scsc_wifilogger_debugfs.h

6 #iâdeà
_SCSC_WIFILOGGER_DEBUGFS_H_


7 
	#_SCSC_WIFILOGGER_DEBUGFS_H_


	)

9 
	~<lšux/k”Ãl.h
>

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/moduË.h
>

12 
	~<lšux/debugfs.h
>

13 
	~<lšux/v”siÚ.h
>

14 
	~<lšux/mu‹x.h
>

15 
	~<lšux/wa™.h
>

16 
	~<lšux/¦ab.h
>

17 
	~<lšux/fs.h
>

18 
	~<lšux/vm®loc.h
>

19 
	~<asm/uacûss.h
>

21 
	~<scsc/scsc_logršg.h
>

23 
	~"scsc_wifogg”_cÜe.h
"

24 
	~"scsc_wifogg”.h
"

26 
	#SCSC_DEBUGFS_ROOT
 "/sys/k”Ãl/debug/wifogg”"

	)

27 
	#SCSC_DEBUGFS_ROOT_DIRNAME
 "wifogg”"

	)

29 
	sscsc_wlog_debugfs_šfo
 {

30 
d’Œy
 *
	mroÙdœ
;

31 
d’Œy
 *
	mršgdœ
;

34 
	sscsc_ršg_‹¡_objeù
 {

35 
scsc_wlog_ršg
 *
	mr
;

36 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


37 *
	mrbuf
;

38 *
	mwbuf
;

39 
size_t
 
	mbsz
;

40 
li¡_h—d
 
	m–em
;

41 
wa™_queue_h—d_t
 
	md¿š_wq
;

42 
wa™_queue_h—d_t
 
	mrw_wq
;

43 
mu‹x
 
	m»ad”s_lock
;

47 *
scsc_wlog_»gi¡”_debugfs_’Œy
(cÚ¡ *
ršg_Çme
,

48 cÚ¡ *
âame
,

49 cÚ¡ 
fe_İ”©iÚs
 *
fİs
,

50 *
¹o
,

51 
scsc_wlog_debugfs_šfo
 *
di
);

53 
scsc_ršg_‹¡_objeù
 *
š™_ršg_‹¡_objeù
(
scsc_wlog_ršg
 *
r
);

55 
scsc_wifogg”_debugfs_»move_tİ_dœ_»cursive
();

57 
scsc_»gi¡”_commÚ_debugfs_’Œ›s
(*
ršg_Çme
, *
¹o
,

58 
scsc_wlog_debugfs_šfo
 *
di
);

60 
dfs_İ’
(
šode
 *
šo
, 
fe
 *
fp
);

62 
dfs_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
);

	@scsc_wifilogger_internal.c

6 
	~<lšux/k”Ãl.h
>

7 
	~<lšux/ty³s.h
>

8 
	~<lšux/mu‹x.h
>

9 
	~<lšux/nÙif›r.h
>

10 
	~<lšux/¦ab.h
>

11 
	~<scsc/scsc_logršg.h
>

12 
	~<scsc/scsc_mx.h
>

14 
	~"scsc_wifogg”_š‹º®.h
"

16 
scsc_wifi_logg”
 *
	gwifi_logg”
;

18 
scsc_wifi_logg”
 *
	$scsc_wifogg”_g‘_hªdË
()

20  
wifi_logg”
;

21 
	}
}

23 
boŞ
 
	$scsc_wifogg”_š™
()

25 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

27 
wl
 = 
	`kz®loc
((*wl), 
GFP_KERNEL
);

28 ià(!
wl
) {

29 
	`SCSC_TAG_ERR
(
WLOG
,

31  
çl£
;

34 
	`mu‹x_š™
(&
wl
->
lock
);

35 
wl
->
š™Ÿlized
 = 
Œue
;

36 
wifi_logg”
 = 
wl
;

38  
Œue
;

39 
	}
}

41 
	$scsc_wifogg”_nÙif›r
(
nÙif›r_block
 *
nb
,

42 
ev’t
, *
d©a
)

44 
»t
 = 
NOTIFY_DONE
;

45 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

47 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

48 ià(!
wl
 || !wl->
š™Ÿlized
) {

49 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

50  
NOTIFY_BAD
;

53 
ev’t
) {

54 
SCSC_FW_EVENT_FAILURE
:

56 
SCSC_FW_EVENT_MOREDUMP_COMPLETE
:

58 *
·nic_»cÜd_dump
 = 
d©a
;

60 
	`SCSC_TAG_INFO
(
WLOG
, "Notification„eceived: MOREDUMP COMPLETED.\n");

61 
	`SCSC_TAG_DEBUG
(
WLOG
, "PANIC DUMP RX\n-------------------------\n\n%s\n",

62 
·nic_»cÜd_dump
);

63 ià(
wl
->
Ú_®”t_cb
) {

64 
wl
->
	`Ú_®”t_cb
(
·nic_»cÜd_dump
,

65 
PANIC_RECORD_DUMP_BUFFER_SZ
, 0, 
wl
->
Ú_®”t_ùx
);

66 
	`SCSC_TAG_DEBUG
(
WLOG
, "Alert handler --…rocessed %d bytes @%p\n",

67 
PANIC_RECORD_DUMP_BUFFER_SZ
, 
·nic_»cÜd_dump
);

69 
»t
 = 
NOTIFY_OK
;

73 
»t
 = 
NOTIFY_BAD
;

77  
»t
;

78 
	}
}

80 
nÙif›r_block
 
	gfœmw¬e_nb
 = {

81 .
nÙif›r_ÿÎ
 = 
scsc_wifogg”_nÙif›r
,

84 
boŞ
 
	$scsc_wifogg”_fw_®”t_š™
()

86 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

88 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

89 ià(!
wl
 || !wl->
š™Ÿlized
) {

90 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

91  
çl£
;

94 
wl
->
ã©u»s_mask
 |ğ
WIFI_LOGGER_MEMORY_DUMP_SUPPORTED
 | 
WIFI_LOGGER_DRIVER_DUMP_SUPPORTED
;

95 ià(!
	`mxmª_»gi¡”_fœmw¬e_nÙif›r
(&
fœmw¬e_nb
))

96 
wl
->
ã©u»s_mask
 |ğ
WIFI_LOGGER_WATCHDOG_TIMER_SUPPORTED
;

98  
Œue
;

99 
	}
}

101 
	$scsc_wifogg”_g‘_ã©u»s
()

103 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

105 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

106 ià(!
wl
 || !wl->
š™Ÿlized
) {

107 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

111  
wl
->
ã©u»s_mask
;

112 
	}
}

114 
boŞ
 
	$scsc_wifogg”_g‘_ršgs_¡©us
(
u32
 *
num_ršgs
,

115 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

117 
i
, 
j
 = 0;

118 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

120 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

121 ià(!
wl
 || !wl->
š™Ÿlized
) {

122 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

123 *
num_ršgs
 = 0;

124  
çl£
;

127 
i
 = 0; i < *
num_ršgs
 && i < 
MAX_WIFI_LOGGER_RINGS
; i++)

128 ià(
wl
->
ršgs
[
i
] && wl->ršgs[i]->
»gi¡”ed
)

129 
	`scsc_wlog_g‘_ršg_¡©us
(
wl
->
ršgs
[
i
], &
¡©us
[
j
++]);

130 *
num_ršgs
 = 
j
;

132  
Œue
;

133 
	}
}

135 
scsc_wlog_ršg
 *
	$scsc_wifogg”_g‘_ršg_äom_Çme
(*
Çme
)

137 
i
;

138 
scsc_wlog_ršg
 *
r
 = 
NULL
;

139 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

141 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

142 ià(!
wl
 || !wl->
š™Ÿlized
) {

143 
	`SCSC_TAG_ERR
(
WLOG
,

145  
r
;

148 
	`mu‹x_lock
(&
wl
->
lock
);

149 
i
 = 0; i < 
MAX_WIFI_LOGGER_RINGS
; i++) {

150 ià(
wl
->
ršgs
[
i
] &&

151 !
	`¡ºcmp
(
Çme
, 
wl
->
ršgs
[
i
]->
¡
.Çme, 
RING_NAME_SZ
)) {

152 ià(
wl
->
ršgs
[
i
]->
š™Ÿlized
 &&

153 
wl
->
ršgs
[
i
]->
»gi¡”ed
)

154 
r
 = 
wl
->
ršgs
[
i
];

158 
	`mu‹x_uÆock
(&
wl
->
lock
);

160  
r
;

161 
	}
}

163 
boŞ
 
	$scsc_wifogg”_»gi¡”_ršg
(
scsc_wlog_ršg
 *
r
)

165 
pos
;

166 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

168 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

169 ià(!
wl
 || !wl->
š™Ÿlized
) {

170 
	`SCSC_TAG_ERR
(
WLOG
,

172  
çl£
;

179 
pos
 = 
r
->
¡
.
ršg_id
 % 
MAX_WIFI_LOGGER_RINGS
;

180 
	`mu‹x_lock
(&
wl
->
lock
);

181 ià(
wl
->
ršgs
[
pos
]) {

182 
	`SCSC_TAG_ERR
(
WLOG
,

184 
wl
->
ršgs
[
pos
]->
¡
.
Çme
,…os);

185 
	`mu‹x_uÆock
(&
wl
->
lock
);

186  
çl£
;

188 
	`SCSC_TAG_DEBUG
(
WLOG
, "Registering„ing %s‡s…osition %d\n",

189 
r
->
¡
.
Çme
, 
pos
);

190 
wl
->
ršgs
[
pos
] = 
r
;

191 
wl
->
ã©u»s_mask
 |ğ
r
->features_mask;

192 
r
->
wl
 = wl;

193 
r
->
»gi¡”ed
 = 
Œue
;

194 
	`mu‹x_uÆock
(&
wl
->
lock
);

195 
	`SCSC_TAG_INFO
(
WLOG
, "Ršg '%s'„egi¡”ed\n", 
r
->
¡
.
Çme
);

197  
Œue
;

198 
	}
}

200 
	$scsc_wifogg”_de¡roy
()

202 
i
;

203 
scsc_wlog_ršg
 *
r
 = 
NULL
;

204 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

206 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

207 ià(!
wl
 || !wl->
š™Ÿlized
) {

208 
	`SCSC_TAG_ERR
(
WLOG
,

213 
	`mxmª_uÄegi¡”_fœmw¬e_nÙif›r
(&
fœmw¬e_nb
);

215 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


216 
	`scsc_wifogg”_debugfs_»move_tİ_dœ_»cursive
();

219 
	`mu‹x_lock
(&
wl
->
lock
);

220 
i
 = 0; i < 
MAX_WIFI_LOGGER_RINGS
; i++) {

221 ià(
wl
->
ršgs
[
i
]) {

222 
r
 = 
wl
->
ršgs
[
i
];

223 
	`scsc_wlog_ršg_chªge_v”bos™y
(
r
, 
WLOG_NONE
);

224 
r
->
»gi¡”ed
 = 
çl£
;

225 
wl
->
ršgs
[
i
] = 
NULL
;

226 ià(
r
->
š™Ÿlized
)

227 
	`scsc_wlog_ršg_de¡roy
(
r
);

230 
wl
->
ã©u»s_mask
 = 0;

231 
	`mu‹x_uÆock
(&
wl
->
lock
);

232 
	`kä“
(
wl
);

233 
wifi_logg”
 = 
NULL
;

234 
	}
}

	@scsc_wifilogger_internal.h

6 #iâdeà
_SCSC_WIFILOGGER_INTERNAL_H_


7 
	#_SCSC_WIFILOGGER_INTERNAL_H_


	)

9 
	~<lšux/k”Ãl.h
>

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/mu‹x.h
>

12 
	~<lšux/¦ab.h
>

13 
	~<lšux/b™İs.h
>

15 
	~"scsc_wifogg”_ty³s.h
"

16 
	~"scsc_wifogg”_cÜe.h
"

17 
	~"scsc_wifogg”_debugfs.h
"

19 
	sscsc_wifi_logg”
 {

20 
boŞ
 
	mš™Ÿlized
;

21 
mu‹x
 
	mlock
;

22 
	mã©u»s_mask
;

23 
scsc_wlog_ršg
 *
	mršgs
[
MAX_WIFI_LOGGER_RINGS
];

32 (*
	mÚ_ršg_bufãr_d©a_cb
)(*
	mršg_Çme
, *
	mbufãr
,

33 
	mbufãr_size
,

34 
scsc_wifi_ršg_bufãr_¡©us
 *
	m¡©us
,

35 *
	mùx
);

37 (*
	mÚ_®”t_cb
)(*
	mbufãr
, 
	mbufãr_size
, 
	m”r_code
, *
	mùx
);

39 *
	mÚ_ršg_bufãr_ùx
;

40 *
	mÚ_®”t_ùx
;

43 
boŞ
 
scsc_wifogg”_š™
();

44 
scsc_wifogg”_de¡roy
();

45 
boŞ
 
scsc_wifogg”_fw_®”t_š™
();

46 
scsc_wifi_logg”
 *
scsc_wifogg”_g‘_hªdË
();

47 
scsc_wifogg”_g‘_ã©u»s
();

48 
boŞ
 
scsc_wifogg”_»gi¡”_ršg
(
scsc_wlog_ršg
 *
r
);

49 
scsc_wlog_ršg
 *
scsc_wifogg”_g‘_ršg_äom_Çme
(*
Çme
);

50 
boŞ
 
scsc_wifogg”_g‘_ršgs_¡©us
(
u32
 *
num_ršgs
,

51 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
);

	@scsc_wifilogger_module.c

13 
	~"scsc_wifogg”_moduË.h
"

15 
__š™
 
	$scsc_wifogg”_moduË_š™
()

17 ià(
	`scsc_wifogg”_š™
()) {

18 
	`scsc_wifogg”_ršg_cÚÃùiv™y_š™
();

19 
	`scsc_wifogg”_ršg_wak–ock_š™
();

20 
	`scsc_wifogg”_ršg_pktç‹_š™
();

21 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


22 
	`scsc_wifogg”_ršg_‹¡_š™
();

24 
	`scsc_wifogg”_fw_®”t_š™
();

26 
	`SCSC_TAG_ERR
(
WLOG
, "Module init failed\n");

27  -
ENOMEM
;

30 
	`SCSC_TAG_INFO
(
WLOG
, "Wi-Fi Logger subsystem initialized.\n");

33 
	}
}

35 
__ex™
 
	$scsc_wifogg”_moduË_ex™
()

37 
	`scsc_wifogg”_de¡roy
();

39 
	`SCSC_TAG_INFO
(
WLOG
, "Wi-Fi Logger subsystem unloaded.\n");

40 
	}
}

42 
moduË_š™
(
scsc_wifogg”_moduË_š™
);

43 
moduË_ex™
(
scsc_wifogg”_moduË_ex™
);

45 
MODULE_LICENSE
("GPL");

46 
MODULE_AUTHOR
("Samsung SLSI");

47 
MODULE_DESCRIPTION
("Android Wi-Fi Logger module");

	@scsc_wifilogger_module.h

7 #iâdeà
_SCSC_WIFILOGGER_MODULE_H_


8 
	#_SCSC_WIFILOGGER_MODULE_H_


	)

10 
	~<lšux/k”Ãl.h
>

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/mu‹x.h
>

13 
	~<lšux/¦ab.h
>

14 
	~<lšux/moduË.h
>

15 
	~<scsc/scsc_logršg.h
>

17 
	~"scsc_wifogg”_š‹º®.h
"

19 
	~"scsc_wifogg”_ršg_cÚÃùiv™y.h
"

20 
	~"scsc_wifogg”_ršg_wak–ock.h
"

21 
	~"scsc_wifogg”_ršg_pktç‹.h
"

23 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


24 
	~"scsc_wifogg”_ršg_‹¡.h
"

	@scsc_wifilogger_ring_connectivity.c

7 
	~"scsc_wifogg”_ršg_cÚÃùiv™y.h
"

10 
	~<¡d¬g.h
>

11 
	~"scsc_wifogg”_ršg_cÚÃùiv™y_­i.h
"

12 
	~"scsc_wifogg”_š‹º®.h
"

14 
scsc_wlog_ršg
 *
	gthe_ršg
;

16 
u32
 
	güšg_Ëv
;

17 
EXPORT_SYMBOL
(
üšg_Ëv
);

19 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


20 
	~"scsc_wifogg”_debugfs.h
"

22 
scsc_wlog_debugfs_šfo
 
	gdi
;

26 
boŞ
 
	$scsc_wifogg”_ršg_cÚÃùiv™y_š™
()

28 
scsc_wlog_ršg
 *
r
 = 
NULL
;

29 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


30 
scsc_ršg_‹¡_objeù
 *
¹o
;

33 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RCONNECT_NAME
,

34 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

35 
ENTRY_TYPE_CONNECT_EVENT
, 32768 * 8,

36 
WIFI_LOGGER_CONNECT_EVENT_SUPPORTED
,

37 
NULL
, NULL, NULL);

39 ià(!
r
) {

40 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

41 
WLOGGER_RCONNECT_NAME
);

42  
çl£
;

44 
	`scsc_wlog_»gi¡”_v”bos™y_»ã»nû
(
r
, &
üšg_Ëv
);

46 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
r
)) {

47 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

48 
WLOGGER_RCONNECT_NAME
);

49 
	`scsc_wlog_ršg_de¡roy
(
r
);

50  
çl£
;

52 
the_ršg
 = 
r
;

54 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


55 
¹o
 = 
	`š™_ršg_‹¡_objeù
(
the_ršg
);

56 ià(
¹o
)

57 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
the_ršg
->
¡
.
Çme
, 
¹o
, &
di
);

60  
Œue
;

61 
	}
}

65 
	$scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
, 
u16
 
fw_ev’t_id
,

66 
u64
 
fw_time¡amp
, *
fw_bulk_d©a
, 
size_t
 
fw_bËn
)

68 
scsc_wifi_ršg_bufãr_driv”_cÚÃùiv™y_ev’t
 
ev’t_™em
;

70 ià(!
the_ršg
)

73 
	`SCSC_TAG_DEBUG
(
WLOG
, "EL -- RX MLME_EVENT_LOG_INFO -ƒvent_id[%d] @0x%x\n",

74 
fw_ev’t_id
, 
fw_time¡amp
);

75 
ev’t_™em
.
ev’t
 = 
fw_ev’t_id
;

77  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
fw_bulk_d©a
, 
fw_bËn
, &
ev’t_™em
,

78 (
ev’t_™em
), 
Ëv
, 
fw_time¡amp
);

79 
	}
}

80 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
);

82 
	$scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
,

83 
u16
 
driv”_ev’t_id
, 
g_couÁ
, ...)

85 
i
;

86 
u64
 
time¡amp
;

87 
va_li¡
 
­
;

88 
u8
 
vs
[
MAX_TLVS_SZ
];

89 
size_t
 
vs_sz
 = 0;

90 
scsc_v_log
 *
v
 = 
NULL
;

91 
scsc_wifi_ršg_bufãr_driv”_cÚÃùiv™y_ev’t
 
ev’t_™em
;

93 ià(!
the_ršg
)

96 
time¡amp
 = 
	`loÿl_şock
();

98 
	`SCSC_TAG_DEBUG
(
WLOG
, "EL -- RX Driver CONNECTIVITY EVENT -ƒvent_id[%d] @0x%x\n",

99 
driv”_ev’t_id
, 
time¡amp
);

101 
ev’t_™em
.
ev’t
 = 
driv”_ev’t_id
;

102 
	`va_¡¬t
(
­
, 
g_couÁ
);

103 
i
 = 0; i < 
g_couÁ
 &&

104 
vs_sz
 + (*
v
è< 
MAX_TLVS_SZ
; 
i
++) {

105 
v
 = (
scsc_v_log
 *)(
vs
 + 
vs_sz
);

106 
v
->
g
 = (
u16
)
	`va_¬g
(
­
, );

107 
v
->
Ëngth
 = (
u16
)
	`va_¬g
(
­
, );

108 ià(
vs_sz
 + (*
v
è+lv->
Ëngth
 >ğ
MAX_TLVS_SZ
) {

109 
	`WARN
(
Œue
,

111 
MAX_TLVS_SZ
);

114 
	`memıy
(&
v
->
v®ue
, 
	`va_¬g
(
­
, 
u8
 *),lv->
Ëngth
);

115 
vs_sz
 +ğ(*
v
è+lv->
Ëngth
;

117 
	`va_’d
(
­
);

119  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
vs
, 
vs_sz
, &
ev’t_™em
,

120 (
ev’t_™em
), 
Ëv
, 
time¡amp
);

121 
	}
}

122 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
);

	@scsc_wifilogger_ring_connectivity.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_CONNECTIVITY_H__


7 
	#__SCSC_WIFILOGGER_RING_CONNECTIVITY_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/wa™.h
>

11 
	~<lšux/mu‹x.h
>

12 
	~<lšux/li¡.h
>

13 
	~<scsc/scsc_logršg.h
>

15 
	~"scsc_wifogg”_cÜe.h
"

16 
	~"scsc_wifogg”.h
"

18 
	#MAX_TLVS_SZ
 1024

	)

19 
	#WLOGGER_RCONNECT_NAME
 "cÚÃùiv™y"

	)

25 
u32
 
üšg_Ëv
;

27 
boŞ
 
scsc_wifogg”_ršg_cÚÃùiv™y_š™
();

29 
scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
,

30 
u16
 
driv”_ev’t_id
, 
g_couÁ
, ...);

32 
scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
, 
u16
 
fw_ev’t_id
,

33 
u64
 
fw_time¡amp
, *
fw_bulk_d©a
, 
size_t
 
fw_bËn
);

	@scsc_wifilogger_ring_connectivity_api.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_CONNECTIVITY_API_H__


7 
	#__SCSC_WIFILOGGER_RING_CONNECTIVITY_API_H__


	)

17 #ià
IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

19 
	~"scsc_wifogg”_ršg_cÚÃùiv™y.h
"

44 
	#SCSC_WLOG_DRIVER_EVENT
(
Ëv
, 
driv”_ev’t_id
, 
g_couÁ
, 
g_¬gs
...) \

46 ià(
üšg_Ëv
 && (
Ëv
) <= cring_lev) \

47 
	`scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
((
Ëv
), (
driv”_ev’t_id
), \

48 (
g_couÁ
), 
g_¬gs
); \

49 } 0)

	)

66 
	#SCSC_WLOG_FW_EVENT
(
Ëv
, 
fw_ev’t_id
, 
fw_time¡amp
, 
fw_bulk_d©a
, 
fw_bËn
) \

68 ià(
üšg_Ëv
 && (
Ëv
) <= cring_lev) \

69 
	`scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
((
Ëv
), (
fw_ev’t_id
), (
fw_time¡amp
), \

70 (
fw_bulk_d©a
), (
fw_bËn
)); \

71 } 0)

	)

74 
	#SCSC_WLOG_DRIVER_EVENT
(
Ëv
, 
driv”_ev’t_id
, 
g_couÁ
, 
g_¬gs
...èdØ{} 0)

	)

75 
	#SCSC_WLOG_FW_EVENT
(
Ëv
, 
fw_ev’t_id
, 
fw_time¡amp
, 
fw_bulk_d©a
, 
fw_bËn
èdØ{} 0)

	)

	@scsc_wifilogger_ring_pktfate.c

7 
	~"scsc_wifogg”_ršg_pktç‹.h
"

10 
	~<¡d¬g.h
>

11 
	~"scsc_wifogg”_š‹º®.h
"

13 
boŞ
 
	gpktç‹_mÚ™Ü_¡¬‹d
;

15 
wifi_tx_»pÜt
 
	gtxr
;

16 
wifi_rx_»pÜt
 
	grxr
;

17 
scsc_wlog_ršg
 *
	gç‹_ršg_tx
;

18 
scsc_wlog_ršg
 *
	gç‹_ršg_rx
;

20 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


21 
	~"scsc_wifogg”_debugfs.h
"

22 
	~"scsc_wifogg”.h
"

24 
scsc_wlog_debugfs_šfo
 
	gdi_tx
, 
	gdi_rx
;

26 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


27 
	~<lšux/uacûss.h
>

29 
ssize_t
 
	$dfs_»ad_ç‹s
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

30 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

32 
size_t
 
gÙ_sz
, 
n_´ovided_ç‹s
 = 0, 
n_»que¡ed_ç‹s
;

33 
scsc_ršg_‹¡_objeù
 *
¹o
;

34 
wifi_tx_»pÜt
 *
tx_»pÜt_bufs
 = 
NULL
;

35 
wifi_rx_»pÜt
 *
rx_»pÜt_bufs
 = 
NULL
;

36 *
¤cbuf
 = 
NULL
;

38 ià(!
fp
->
´iv©e_d©a
)

39  -
EINVAL
;

40 
¹o
 = 
fp
->
´iv©e_d©a
;

42 ià(!
	`¡ºcmp
(
¹o
->
r
->
¡
.
Çme
, 
WLOGGER_RFATE_TX_NAME
, 
RING_NAME_SZ
 - 1)) {

43 
n_»que¡ed_ç‹s
 = 
couÁ
 / (
wifi_tx_»pÜt
);

44 
tx_»pÜt_bufs
 = 
	`vm®loc
((
wifi_tx_»pÜt
è* 
n_»que¡ed_ç‹s
);

45 ià(
tx_»pÜt_bufs
)

46 
	`scsc_wifi_g‘_tx_pkt_ç‹s
(
tx_»pÜt_bufs
, 
n_»que¡ed_ç‹s
,

47 &
n_´ovided_ç‹s
, 
çl£
);

48 
gÙ_sz
 = (
wifi_tx_»pÜt
è* 
n_´ovided_ç‹s
;

49 
¤cbuf
 = 
tx_»pÜt_bufs
;

51 
n_»que¡ed_ç‹s
 = 
couÁ
 / (
wifi_rx_»pÜt
);

52 
rx_»pÜt_bufs
 = 
	`vm®loc
((
wifi_rx_»pÜt
è* 
n_»que¡ed_ç‹s
);

53 ià(
rx_»pÜt_bufs
)

54 
	`scsc_wifi_g‘_rx_pkt_ç‹s
(
rx_»pÜt_bufs
, 
n_»que¡ed_ç‹s
,

55 &
n_´ovided_ç‹s
, 
çl£
);

56 
gÙ_sz
 = (
wifi_rx_»pÜt
è* 
n_´ovided_ç‹s
;

57 
¤cbuf
 = 
rx_»pÜt_bufs
;

59 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s'...asked for %d fates....GOT %d\n",

60 
¹o
->
r
->
¡
.
Çme
, 
n_»que¡ed_ç‹s
, 
n_´ovided_ç‹s
);

61 ià(
	`cİy_to_u£r
(
ubuf
, 
¤cbuf
, 
gÙ_sz
))

62  -
EFAULT
;

63 *
f_pos
 +ğ
gÙ_sz
;

65  
gÙ_sz
;

66 
	}
}

68 cÚ¡ 
fe_İ”©iÚs
 
	gg‘_ç‹s_fİs
 = {

69 .
owÃr
 = 
THIS_MODULE
,

70 .
	gİ’
 = 
dfs_İ’
,

71 .
	g»ad
 = 
dfs_»ad_ç‹s
,

72 .
	g»Ëa£
 = 
dfs_»Ëa£
,

78 
boŞ
 
	$is_pktç‹_mÚ™Ü_¡¬‹d
()

80  
pktç‹_mÚ™Ü_¡¬‹d
;

81 
	}
}

82 
EXPORT_SYMBOL
(
is_pktç‹_mÚ™Ü_¡¬‹d
);

84 
boŞ
 
	$scsc_wifogg”_ršg_pktç‹_š™
()

86 
scsc_wlog_ršg
 *
r
 = 
NULL
;

87 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


88 
scsc_ršg_‹¡_objeù
 *
¹o_tx
, *
¹o_rx
;

91 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RFATE_TX_NAME
,

92 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

93 
ENTRY_TYPE_PKT
, 32768 * 4,

94 
WIFI_LOGGER_PACKET_FATE_SUPPORTED
,

95 
NULL
, NULL, NULL);

96 ià(!
r
) {

97 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

98 
WLOGGER_RFATE_TX_NAME
);

99  
çl£
;

101 
ç‹_ršg_tx
 = 
r
;

103 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RFATE_RX_NAME
,

104 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

105 
ENTRY_TYPE_PKT
, 32768 * 4,

106 
WIFI_LOGGER_PACKET_FATE_SUPPORTED
,

107 
NULL
, NULL, NULL);

108 ià(!
r
) {

109 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

110 
WLOGGER_RFATE_RX_NAME
);

111 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_tx
);

112  
çl£
;

114 
ç‹_ršg_rx
 = 
r
;

116 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
ç‹_ršg_tx
)) {

117 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

118 
ç‹_ršg_tx
->
¡
.
Çme
);

119 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_tx
);

120 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_rx
);

121  
çl£
;

123 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
ç‹_ršg_rx
)) {

124 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

125 
ç‹_ršg_rx
->
¡
.
Çme
);

126 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_tx
);

127 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_rx
);

128  
çl£
;

132 
	`scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
ç‹_ršg_tx
);

133 
	`scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
ç‹_ršg_rx
);

135 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


139 
¹o_tx
 = 
	`š™_ršg_‹¡_objeù
(
ç‹_ršg_tx
);

140 ià(
¹o_tx
) {

141 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
ç‹_ršg_tx
->
¡
.
Çme
, 
¹o_tx
, &
di_tx
);

142 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


143 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ç‹_ršg_tx
->
¡
.
Çme
, "get_fates",

144 &
g‘_ç‹s_fİs
, 
¹o_tx
, &
di_tx
);

148 
¹o_rx
 = 
	`š™_ršg_‹¡_objeù
(
ç‹_ršg_rx
);

149 ià(
¹o_rx
) {

150 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
ç‹_ršg_rx
->
¡
.
Çme
, 
¹o_rx
, &
di_rx
);

151 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


152 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ç‹_ršg_rx
->
¡
.
Çme
, "get_fates",

153 &
g‘_ç‹s_fİs
, 
¹o_rx
, &
di_rx
);

158  
Œue
;

159 
	}
}

161 
	$scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
()

163 ià(!
ç‹_ršg_rx
 || !
ç‹_ršg_tx
)

167 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_tx
);

168 
	`scsc_wlog_¡¬t_loggšg
(
ç‹_ršg_tx
, 
WLOG_DEBUG
, 0, 0, 0);

169 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_rx
);

170 
	`scsc_wlog_¡¬t_loggšg
(
ç‹_ršg_rx
, 
WLOG_DEBUG
, 0, 0, 0);

171 
pktç‹_mÚ™Ü_¡¬‹d
 = 
Œue
;

173 
	`SCSC_TAG_INFO
(
WLOG
, "PacketFate monitor started.\n");

174 
	}
}

177 
	$scsc_wifogg”_ršg_pktç‹_Ãw_assoc
()

179 
	`SCSC_TAG_INFO
(
WLOG
, "New Association started...flushing PacketFate„ings.\n");

180 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_tx
);

181 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_rx
);

182 
	}
}

183 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_Ãw_assoc
);

185 
	$scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
ç‹
, *
»pÜt_bufs
,

186 
size_t
 
n_»que¡ed_ç‹s
,

187 
size_t
 *
n_´ovided_ç‹s
,

188 
boŞ
 
is_u£r
)

190 
scsc_wlog_ršg
 *
r
;

191 
u32
 
n_»q_ç‹s
 = (u32)
n_»que¡ed_ç‹s
;

192 
size_t
 
bËn
;

194 
r
 = (
ç‹
 =ğ
TX_FATE
è? 
ç‹_ršg_tx
 : 
ç‹_ršg_rx
;

195 ià(
ç‹
 =ğ
TX_FATE
)

196 
bËn
 = (
wifi_tx_»pÜt
è* 
n_»q_ç‹s
;

198 
bËn
 = (
wifi_rx_»pÜt
è* 
n_»q_ç‹s
;

199 
	`scsc_wlog_»ad_max_»cÜds
(
r
, 
»pÜt_bufs
, 
bËn
, &
n_»q_ç‹s
, 
is_u£r
);

200 *
n_´ovided_ç‹s
 = 
n_»q_ç‹s
;

202 
	`SCSC_TAG_INFO
(
WLOG
, "[%s]:: GET %s…kt_fates -- Requested:%zd - Got:%zd\n",

203 
r
->
¡
.
Çme
,

204 (
ç‹
 =ğ
TX_FATE
è? "TX" : "RX", 
n_»que¡ed_ç‹s
, *
n_´ovided_ç‹s
);

205 
	}
}

206 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
);

219 
	$scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
wifi_tx_·ck‘_ç‹
 
ç‹
,

220 
u16
 
hg
, *
äame
,

221 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
)

223 ià(
Ën
 > 
MAX_FRAME_LEN_ETHERNET
) {

224 
	`SCSC_TAG_WARNING
(
WLOG
, "pktfate TX:: dropped unplausible†ength frame.\n");

228 ià(
ma_un™d©a
)

229 
Ën
 =†’ <ğ
MAX_UNITDATA_LOGGED_SZ
 ?†en : MAX_UNITDATA_LOGGED_SZ;

231 
txr
.
ç‹
 = fate;

232 
txr
.
äame_šf
.
·ylßd_ty³
 = 
FRAME_TYPE_ETHERNET_II
;

233 
txr
.
äame_šf
.
äame_Ën
 = 
Ën
;

234 
txr
.
äame_šf
.
driv”_time¡amp_u£c
 = 
	`ktime_to_ns
(
	`ktime_g‘_boÙtime
());

235 
txr
.
äame_šf
.
fœmw¬e_time¡amp_u£c
 = 0;

236 
	`memıy
(&
txr
.
äame_šf
.
äame_cÚ‹Á
, 
äame
, 
Ën
);

238 
	`mem£t
(&
txr
.
md5_´efix
, 0x00, 
MD5_PREFIX_LEN
);

250 
	`scsc_wlog_wr™e_»cÜd
(
ç‹_ršg_tx
, 
NULL
, 0, &
txr
, Ñxr), 
WLOG_DEBUG
, 0);

251 
	}
}

252 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_log_tx_äame
);

254 
	$scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
wifi_rx_·ck‘_ç‹
 
ç‹
, 
u16
 
du_desc
,

255 *
äame
, 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
)

257 ià((
du_desc
 =ğ
SCSC_DUD_ETHERNET_FRAME
 && 
Ën
 > 
MAX_FRAME_LEN_ETHERNET
) ||

258 (
du_desc
 =ğ
SCSC_DUD_80211_FRAME
 && 
Ën
 > 
MAX_FRAME_LEN_80211_MGMT
)) {

259 
	`SCSC_TAG_WARNING
(
WLOG
, "pktfate RX:: dropped unplausible†ength frame.\n");

263 ià(
ma_un™d©a
)

264 
Ën
 =†’ <ğ
MAX_UNITDATA_LOGGED_SZ
 ?†en : MAX_UNITDATA_LOGGED_SZ;

266 
rxr
.
ç‹
 = fate;

267 
rxr
.
äame_šf
.
·ylßd_ty³
 = 
du_desc
 =ğ
SCSC_DUD_ETHERNET_FRAME
 ? 
FRAME_TYPE_ETHERNET_II
 :

268 (
du_desc
 =ğ
SCSC_DUD_80211_FRAME
 ? 
FRAME_TYPE_80211_MGMT
 : 
FRAME_TYPE_UNKNOWN
);

269 
rxr
.
äame_šf
.
äame_Ën
 = 
Ën
;

270 
rxr
.
äame_šf
.
driv”_time¡amp_u£c
 = 
	`ktime_to_ns
(
	`ktime_g‘_boÙtime
());

271 
rxr
.
äame_šf
.
fœmw¬e_time¡amp_u£c
 = 0;

272 
	`memıy
(&
rxr
.
äame_šf
.
äame_cÚ‹Á
, 
äame
, 
Ën
);

274 
	`mem£t
(&
rxr
.
md5_´efix
, 0x00, 
MD5_PREFIX_LEN
);

286 
	`scsc_wlog_wr™e_»cÜd
(
ç‹_ršg_rx
, 
NULL
, 0, &
rxr
, Ôxr), 
WLOG_DEBUG
, 0);

287 
	}
}

288 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_log_rx_äame
);

	@scsc_wifilogger_ring_pktfate.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_PKTFATE_H__


7 
	#__SCSC_WIFILOGGER_RING_PKTFATE_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/mu‹x.h
>

11 
	~<lšux/ktime.h
>

12 
	~<lšux/timek“pšg.h
>

13 
	~<scsc/scsc_logršg.h
>

15 
	~"scsc_wifogg”_cÜe.h
"

16 
	~"scsc_wifogg”.h
"

18 
	#TX_FATE
 0

	)

19 
	#RX_FATE
 1

	)

20 
	#WLOGGER_RFATE_TX_NAME
 "pkt_ç‹_tx"

	)

21 
	#WLOGGER_RFATE_RX_NAME
 "pkt_ç‹_rx"

	)

22 
	#MAX_UNITDATA_LOGGED_SZ
 100

	)

24 
	#SCSC_DUD_ETHERNET_FRAME
 0

	)

25 
	#SCSC_DUD_80211_FRAME
 1

	)

26 
	#SCSC_DUD_MLME
 2

	)

28 
boŞ
 
is_pktç‹_mÚ™Ü_¡¬‹d
();

29 
boŞ
 
scsc_wifogg”_ršg_pktç‹_š™
();

30 
scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
();

31 
scsc_wifogg”_ršg_pktç‹_Ãw_assoc
();

32 
scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
wifi_tx_·ck‘_ç‹
 
ç‹
,

33 
u16
 
hg
, *
pkt
,

34 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
);

35 
scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
wifi_rx_·ck‘_ç‹
 
ç‹
, 
u16
 
du_desc
,

36 *
äame
, 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
);

37 
scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
ç‹
, *
»pÜt_bufs
,

38 
size_t
 
n_»que¡ed_ç‹s
,

39 
size_t
 *
n_´ovided_ç‹s
, 
boŞ
 
is_u£r
);

	@scsc_wifilogger_ring_pktfate_api.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_PKTFATE_API_H__


7 
	#__SCSC_WIFILOGGER_RING_PKTFATE_API_H__


	)

15 #ià
IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

16 
	~"scsc_wifogg”_ršg_pktç‹.h
"

18 
	#SCSC_WLOG_PKTFATE_NEW_ASSOC
() \

20 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

21 
	`scsc_wifogg”_ršg_pktç‹_Ãw_assoc
(); \

22 } 0)

	)

24 
	#SCSC_WLOG_PKTFATE_LOG_TX_DATA_FRAME
(
hg
, 
äame
, 
æ’
) \

26 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

27 
	`scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
TX_PKT_FATE_DRV_QUEUED
, (
hg
), \

28 (*)(
äame
), (
æ’
), 
Œue
); \

29 } 0)

	)

31 
	#SCSC_WLOG_PKTFATE_LOG_RX_DATA_FRAME
(
du_desc
, 
äame
, 
æ’
) \

33 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
() && \

34 ((
du_desc
è=ğ
SCSC_DUD_ETHERNET_FRAME
 || (du_descè=ğ
SCSC_DUD_80211_FRAME
)) \

35 
	`scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
RX_PKT_FATE_DRV_QUEUED
, (
du_desc
), \

36 (*)(
äame
), (
æ’
), 
Œue
); \

37 } 0)

	)

39 
	#SCSC_WLOG_PKTFATE_LOG_TX_CTRL_FRAME
(
hg
, 
äame
, 
æ’
) \

41 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

42 
	`scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
TX_PKT_FATE_DRV_QUEUED
, (
hg
), \

43 (*)(
äame
), (
æ’
), 
çl£
); \

44 } 0)

	)

46 
	#SCSC_WLOG_PKTFATE_LOG_RX_CTRL_FRAME
(
äame
, 
æ’
) \

48 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

49 
	`scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
RX_PKT_FATE_DRV_QUEUED
, 
SCSC_DUD_MLME
, \

50 (*)(
äame
), (
æ’
), 
çl£
); \

51 } 0)

	)

55 
	#SCSC_WLOG_PKTFATE_NEW_ASSOC
(èdØ{} 0)

	)

56 
	#SCSC_WLOG_PKTFATE_LOG_TX_DATA_FRAME
(
hg
, 
skb_mac
, 
skb_hËn
èdØ{} 0)

	)

57 
	#SCSC_WLOG_PKTFATE_LOG_TX_CTRL_FRAME
(
hg
, 
skb_mac
, 
skb_hËn
èdØ{} 0)

	)

58 
	#SCSC_WLOG_PKTFATE_LOG_RX_DATA_FRAME
(
du_desc
, 
skb_mac
, 
skb_hËn
èdØ{} 0)

	)

59 
	#SCSC_WLOG_PKTFATE_LOG_RX_CTRL_FRAME
(
äame
, 
æ’
èdØ{} 0)

	)

	@scsc_wifilogger_ring_test.c

7 
	~"scsc_wifogg”_ršg_‹¡.h
"

10 
	~"scsc_wifogg”_š‹º®.h
"

11 
	~<lšux/uacûss.h
>

12 
u32
 
	g£q
;

13 
scsc_wlog_ršg
 *
	gthe_ršg
;

15 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


16 
	~"scsc_wifogg”_debugfs.h
"

18 
scsc_wlog_debugfs_šfo
 
	gdi
;

21 
	$ršg_‹¡_logËv–_chªge_cb
(
scsc_wlog_ršg
 *
r
,

22 
u32
 
Ãw_logËv–
)

24 
	`SCSC_TAG_DEBUG
(
WLOG
,

26 
r
->
¡
.
Çme
, 
Ãw_logËv–
);

29 
	}
}

31 
boŞ
 
	$ršg_‹¡_cu¡om_š™
(
scsc_wlog_ršg
 *
r
)

33 
	`SCSC_TAG_DEBUG
(
WLOG
, "Cu¡om in™ fÜ„šg:%s\n", 
r
->
¡
.
Çme
);

35  
Œue
;

36 
	}
}

38 
boŞ
 
	$ršg_‹¡_cu¡om_fši
(
scsc_wlog_ršg
 *
r
)

40 
	`SCSC_TAG_DEBUG
(
WLOG
, "Cu¡om fš˜fÜ„šg:%s\n", 
r
->
¡
.
Çme
);

42  
Œue
;

43 
	}
}

46 
	$scsc_wifogg”_ršg_‹¡_wr™e
(*
buf
, 
size_t
 
bËn
)

48 
Œšg_hdr
 
thdr
;

50 ià(!
the_ršg
)

53 
thdr
.
£q
 = seq++;

54 
thdr
.
çke
 = 666 & 
£q
;

56  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
buf
, 
bËn
, &
thdr
, Ñhdr), 
WLOG_NORMAL
, 0);

57 
	}
}

58 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_‹¡_wr™e
);

60 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


61 
ssize_t
 
	$dfs_»cÜd_wr™e
(
fe
 *
fp
, cÚ¡ 
__u£r
 *
ubuf
,

62 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

64 
ssize_t
 
wr™‹n
;

65 
scsc_ršg_‹¡_objeù
 *
¹o
;

67 ià(!
fp
->
´iv©e_d©a
)

68  -
EINVAL
;

69 
¹o
 = 
fp
->
´iv©e_d©a
;

71 
couÁ
 = couÁ < 
¹o
->
bsz
 ? count :„to->bsz;

72 ià(
	`cİy_äom_u£r
(
¹o
->
wbuf
, 
ubuf
, 
couÁ
))

73  -
EINVAL
;

74 
wr™‹n
 = 
	`scsc_wifogg”_ršg_‹¡_wr™e
(
¹o
->
wbuf
, 
couÁ
);

75 ià(!
wr™‹n
 && 
couÁ
)

76  -
EAGAIN
;

77 
	`wake_up_š‹¼u±ibË
(&
¹o
->
rw_wq
);

78 *
f_pos
 +ğ
wr™‹n
;

80  
wr™‹n
;

81 
	}
}

83 cÚ¡ 
fe_İ”©iÚs
 
	gwr™e_»cÜd_fİs
 = {

84 .
owÃr
 = 
THIS_MODULE
,

85 .
	gİ’
 = 
dfs_İ’
,

86 .
	gwr™e
 = 
dfs_»cÜd_wr™e
,

87 .
	g»Ëa£
 = 
dfs_»Ëa£
,

91 
boŞ
 
	$scsc_wifogg”_ršg_‹¡_š™
()

93 
scsc_wlog_ršg
 *
r
 = 
NULL
;

94 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


95 
scsc_ršg_‹¡_objeù
 *
¹o
;

98 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RTEST_NAME
,

99 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

100 
ENTRY_TYPE_DATA
, 32768,

101 
WIFI_LOGGER_SCSC_TEST_RING_SUPPORTED
,

102 
ršg_‹¡_cu¡om_š™
, 
ršg_‹¡_cu¡om_fši
,

103 
NULL
);

105 ià(!
r
) {

106 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

107 
WLOGGER_RTEST_NAME
);

108  
çl£
;

111 
	`scsc_wlog_»gi¡”_logËv–_chªge_cb
(
r
, 
ršg_‹¡_logËv–_chªge_cb
);

113 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
r
)) {

114 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

115 
WLOGGER_RTEST_NAME
);

116 
	`scsc_wlog_ršg_de¡roy
(
r
);

117  
çl£
;

119 
the_ršg
 = 
r
;

121 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


125 
¹o
 = 
	`š™_ršg_‹¡_objeù
(
the_ršg
);

126 ià(
¹o
) {

127 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
the_ršg
->
¡
.
Çme
, 
¹o
, &
di
);

129 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
the_ršg
->
¡
.
Çme
, "write_record",

130 &
wr™e_»cÜd_fİs
, 
¹o
, &
di
);

134  
Œue
;

135 
	}
}

	@scsc_wifilogger_ring_test.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_TEST_H__


7 
	#__SCSC_WIFILOGGER_RING_TEST_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/wa™.h
>

11 
	~<lšux/mu‹x.h
>

12 
	~<lšux/li¡.h
>

13 
	~<scsc/scsc_logršg.h
>

15 
	~"scsc_wifogg”_cÜe.h
"

16 
	~"scsc_wifogg”.h
"

18 
	#WLOGGER_RTEST_NAME
 "‹¡"

	)

20 
	sŒšg_hdr
 {

21 
u32
 
	m£q
;

22 
u64
 
	mçke
;

23 } 
	g__·cked
;

25 
boŞ
 
scsc_wifogg”_ršg_‹¡_š™
();

27 
scsc_wifogg”_ršg_‹¡_wr™e
(*
buf
, 
size_t
 
bËn
);

	@scsc_wifilogger_ring_wakelock.c

7 
	~"scsc_wifogg”_ršg_wak–ock.h
"

10 
	~"scsc_wifogg”_ršg_wak–ock_­i.h
"

11 
	~"scsc_wifogg”_š‹º®.h
"

13 
scsc_wlog_ršg
 *
	gthe_ršg
;

15 
u32
 
	gwršg_Ëv
;

16 
EXPORT_SYMBOL
(
wršg_Ëv
);

18 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


19 
	~"scsc_wifogg”_debugfs.h
"

21 
scsc_wlog_debugfs_šfo
 
	gdi
;

25 
boŞ
 
	$scsc_wifogg”_ršg_wak–ock_š™
()

27 
scsc_wlog_ršg
 *
r
 = 
NULL
;

28 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


29 
scsc_ršg_‹¡_objeù
 *
¹o
 = 
NULL
;

32 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RWAKELOCK_NAME
,

33 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

34 
ENTRY_TYPE_WAKE_LOCK
, 65536,

35 
WIFI_LOGGER_WAKE_LOCK_SUPPORTED
,

36 
NULL
, NULL, NULL);

38 ià(!
r
) {

39 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

40 
WLOGGER_RWAKELOCK_NAME
);

41  
çl£
;

43 
	`scsc_wlog_»gi¡”_v”bos™y_»ã»nû
(
r
, &
wršg_Ëv
);

45 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
r
)) {

46 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

47 
WLOGGER_RWAKELOCK_NAME
);

48 
	`scsc_wlog_ršg_de¡roy
(
r
);

49  
çl£
;

51 
the_ršg
 = 
r
;

53 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


54 
¹o
 = 
	`š™_ršg_‹¡_objeù
(
the_ršg
);

55 ià(
¹o
)

56 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
the_ršg
->
¡
.
Çme
, 
¹o
, &
di
);

59  
Œue
;

60 
	}
}

64 
	$scsc_wifogg”_ršg_wak–ock_aùiÚ
(
u32
 
v”bo£_Ëv–
, 
¡©us
,

65 *
wl_Çme
, 
»asÚ
)

67 
u64
 
time¡amp
;

68 
scsc_wake_lock_ev’t
 
wl_ev’t
;

70 ià(!
the_ršg
)

73 
time¡amp
 = 
	`loÿl_şock
();

74 
	`SCSC_TAG_DBG4
(
WLOG
, "EL -- WAKELOCK[%s] - status:%d„eason:%d @0x%x\n",

75 
wl_Çme
, 
¡©us
, 
»asÚ
, 
time¡amp
);

77 
wl_ev’t
.
¡©us
 = status;

78 
wl_ev’t
.
»asÚ
 =„eason;

79  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
wl_Çme
, 
	`¡¾’
(wl_Çme), &
wl_ev’t
,

80 (
wl_ev’t
), 
v”bo£_Ëv–
, 
time¡amp
);

81 
	}
}

82 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_wak–ock_aùiÚ
);

	@scsc_wifilogger_ring_wakelock.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_WAKELOCK_H__


7 
	#__SCSC_WIFILOGGER_RING_WAKELOCK_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<scsc/scsc_logršg.h
>

12 
	~"scsc_wifogg”_cÜe.h
"

13 
	~"scsc_wifogg”.h
"

15 
	#WLOGGER_RWAKELOCK_NAME
 "wak–ock"

	)

17 
u32
 
wršg_Ëv
;

19 
scsc_wifogg”_ršg_wak–ock_aùiÚ
(
u32
 
v”bo£_Ëv–
, 
¡©us
,

20 *
wl_Çme
, 
»asÚ
);

23 
boŞ
 
scsc_wifogg”_ršg_wak–ock_š™
();

	@scsc_wifilogger_ring_wakelock_api.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_WAKELOCK_API_H__


7 
	#__SCSC_WIFILOGGER_RING_WAKELOCK_API_H__


	)

16 
	mWL_TAKEN
 = 0,

17 
	mWL_RELEASED


21 
	mWL_REASON_TX
 = 0,

22 
	mWL_REASON_RX
,

23 
	mWL_REASON_ROAM


26 #ià
IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

28 
	~"scsc_wifogg”_ršg_wak–ock.h
"

30 
	#SCSC_WLOG_WAKELOCK
(
Ëv
, 
¡©us
, 
wl_Çme
, 
»asÚ
) \

32 ià(
wršg_Ëv
 && (
Ëv
) <= wring_lev) \

33 
	`scsc_wifogg”_ršg_wak–ock_aùiÚ
((
Ëv
), (
¡©us
), (
wl_Çme
), (
»asÚ
)); \

34 } 0)

	)

38 
	#SCSC_WLOG_WAKELOCK
(
Ëv
, 
¡©us
, 
wl_Çme
, 
»asÚ
èdØ{} 0)

	)

	@scsc_wifilogger_rings.h

6 #iâdeà
__SCSC_WIFILOGGER_RINGS_H__


7 
	#__SCSC_WIFILOGGER_RINGS_H__


	)

9 
	~"scsc_wifogg”_ty³s.h
"

11 
	~"scsc_wifogg”_ršg_cÚÃùiv™y_­i.h
"

12 
	~"scsc_wifogg”_ršg_wak–ock_­i.h
"

13 
	~"scsc_wifogg”_ršg_pktç‹_­i.h
"

	@scsc_wifilogger_types.h

6 #iâdeà
_SCSC_WIFILOGGER_TYPES_H_


7 
	#_SCSC_WIFILOGGER_TYPES_H_


	)

18 
	~<lšux/ty³s.h
>

20 
	#LOGGER_MAJOR_VERSION
 1

	)

21 
	#LOGGER_MINOR_VERSION
 0

	)

22 
	#LOGGER_MICRO_VERSION
 0

	)

29 #iâdeà
CONFIG_SCSC_WIFILOGGER_TEST_RING


30 
	#MAX_WIFI_LOGGER_RINGS
 10

	)

32 
	#MAX_WIFI_LOGGER_RINGS
 11

	)

36 
	mWIFI_SUCCESS
 = 0,

37 
	mWIFI_ERROR_NONE
 = 0,

38 
	mWIFI_ERROR_UNKNOWN
 = -1,

39 
	mWIFI_ERROR_UNINITIALIZED
 = -2,

40 
	mWIFI_ERROR_NOT_SUPPORTED
 = -3,

41 
	mWIFI_ERROR_NOT_AVAILABLE
 = -4,

42 
	mWIFI_ERROR_INVALID_ARGS
 = -5,

43 
	mWIFI_ERROR_INVALID_REQUEST_ID
 = -6,

44 
	mWIFI_ERROR_TIMED_OUT
 = -7,

45 
	mWIFI_ERROR_TOO_MANY_REQUESTS
 = -8,

46 
	mWIFI_ERROR_OUT_OF_MEMORY
 = -9,

47 
	mWIFI_ERROR_BUSY
 = -10,

48 } 
	twifi_”rÜ
;

52 
	mWLOG_NONE
 = 0,

53 
	mWLOG_NORMAL
 = 1,

54 
	mWLOG_LAZY
 = 2,

55 
	mWLOG_DEBUG
 = 3,

56 } 
	twlog_v”bo£_Ëv–
;

60 
	mWIFI_LOGGER_MEMORY_DUMP_SUPPORTED
 = (1 << (0)),

61 
	mWIFI_LOGGER_PER_PACKET_TX_RX_STATUS_SUPPORTED
 = (1 << (1)),

62 
	mWIFI_LOGGER_CONNECT_EVENT_SUPPORTED
 = (1 << (2)),

63 
	mWIFI_LOGGER_POWER_EVENT_SUPPORTED
 = (1 << (3)),

64 
	mWIFI_LOGGER_WAKE_LOCK_SUPPORTED
 = (1 << (4)),

65 
	mWIFI_LOGGER_VERBOSE_SUPPORTED
 = (1 << (5)),

66 
	mWIFI_LOGGER_WATCHDOG_TIMER_SUPPORTED
 = (1 << (6)),

67 
	mWIFI_LOGGER_DRIVER_DUMP_SUPPORTED
 = (1 << (7)),

68 
	mWIFI_LOGGER_PACKET_FATE_SUPPORTED
 = (1 << (8)),

69 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


70 
	mWIFI_LOGGER_SCSC_TEST_RING_SUPPORTED
 = (1 << (9)),

75 
	mRING_BUFFER_ENTRY_FLAGS_HAS_BINARY
 = (1 << (0)),

76 
	mRING_BUFFER_ENTRY_FLAGS_HAS_TIMESTAMP
 = (1 << (1))

79 
	#RING_NAME_SZ
 32

	)

81 
	sscsc_wifi_ršg_bufãr_¡©us
 {

82 
u8
 
	mÇme
[
RING_NAME_SZ
];

83 
u32
 
	mæags
;

84 
	mršg_id
;

85 
u32
 
	mrb_by‹_size
;

86 
u32
 
	mv”bo£_Ëv–
;

87 
u32
 
	mwr™‹n_by‹s
;

91 
u32
 
	m»ad_by‹s
;

94 
u32
 
	mwr™‹n_»cÜds
;

100 (*
	tÚ_ršg_bufãr_d©a
)(*
	tršg_Çme
, *
	tbufãr
, 
	tbufãr_size
,

101 
	tscsc_wifi_ršg_bufãr_¡©us
 *
	t¡©us
, *
	tùx
);

102 (*
	tÚ_®”t
)(*
	tbufãr
, 
	tbufãr_size
, 
	t”r_code
, *
	tùx
);

105 
ENTRY_TYPE_CONNECT_EVENT
 = 1,

106 
ENTRY_TYPE_PKT
,

107 
ENTRY_TYPE_WAKE_LOCK
,

108 
ENTRY_TYPE_POWER_EVENT
,

109 
ENTRY_TYPE_DATA


112 
	sscsc_wifi_ršg_bufãr_’Œy
 {

113 
u16
 
’Œy_size
;

114 
u8
 
æags
;

115 
u8
 
ty³
;

116 
u64
 
time¡amp
;

117 } 
__·cked
;

120 
	#WIFI_RING_BUFFER_FLAG_HAS_BINARY_ENTRIES
 0x00000001

	)

122 
	#WIFI_RING_BUFFER_FLAG_HAS_ASCII_ENTRIES
 0x00000002

	)

125 
	#WIFI_EVENT_ASSOCIATION_REQUESTED
 0

126 
	#WIFI_EVENT_AUTH_COMPLETE
 1

	)

127 
	#WIFI_EVENT_ASSOC_COMPLETE
 2

	)

128 
	#WIFI_EVENT_FW_AUTH_STARTED
 3

129 
	#WIFI_EVENT_FW_ASSOC_STARTED
 4

130 
	#WIFI_EVENT_FW_RE_ASSOC_STARTED
 5

131 
	#WIFI_EVENT_DRIVER_SCAN_REQUESTED
 6

	)

132 
	#WIFI_EVENT_DRIVER_SCAN_RESULT_FOUND
 7

	)

133 
	#WIFI_EVENT_DRIVER_SCAN_COMPLETE
 8

	)

134 
	#WIFI_EVENT_G_SCAN_STARTED
 9

	)

135 
	#WIFI_EVENT_G_SCAN_COMPLETE
 10

	)

136 
	#WIFI_EVENT_DISASSOCIATION_REQUESTED
 11

	)

137 
	#WIFI_EVENT_RE_ASSOCIATION_REQUESTED
 12

	)

138 
	#WIFI_EVENT_ROAM_REQUESTED
 13

	)

139 
	#WIFI_EVENT_BEACON_RECEIVED
 14

141 
	#WIFI_EVENT_ROAM_SCAN_STARTED
 15

142 
	#WIFI_EVENT_ROAM_SCAN_COMPLETE
 16

143 
	#WIFI_EVENT_ROAM_SEARCH_STARTED
 17

145 
	#WIFI_EVENT_ROAM_SEARCH_STOPPED
 18

147 
	#WIFI_EVENT_CHANNEL_SWITCH_ANOUNCEMENT
 20

148 
	#WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START
 21

150 
	#WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP
 22

152 
	#WIFI_EVENT_DRIVER_EAPOL_FRAME_TRANSMIT_REQUESTED
 23

154 
	#WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED
 24

156 
	#WIFI_EVENT_DRIVER_EAPOL_FRAME_RECEIVED
 26

159 
	#WIFI_EVENT_BLOCK_ACK_NEGOTIATION_COMPLETE
 27

160 
	#WIFI_EVENT_BT_COEX_BT_SCO_START
 28

	)

161 
	#WIFI_EVENT_BT_COEX_BT_SCO_STOP
 29

	)

162 
	#WIFI_EVENT_BT_COEX_BT_SCAN_START
 30

164 
	#WIFI_EVENT_BT_COEX_BT_SCAN_STOP
 31

	)

165 
	#WIFI_EVENT_BT_COEX_BT_HID_START
 32

	)

166 
	#WIFI_EVENT_BT_COEX_BT_HID_STOP
 33

	)

167 
	#WIFI_EVENT_ROAM_AUTH_STARTED
 34

168 
	#WIFI_EVENT_ROAM_AUTH_COMPLETE
 35

169 
	#WIFI_EVENT_ROAM_ASSOC_STARTED
 36

171 
	#WIFI_EVENT_ROAM_ASSOC_COMPLETE
 37

172 
	#WIFI_EVENT_G_SCAN_STOP
 38

173 
	#WIFI_EVENT_G_SCAN_CYCLE_STARTED
 39

174 
	#WIFI_EVENT_G_SCAN_CYCLE_COMPLETED
 40

175 
	#WIFI_EVENT_G_SCAN_BUCKET_STARTED
 41

177 
	#WIFI_EVENT_G_SCAN_BUCKET_COMPLETED
 42

179 
	#WIFI_EVENT_G_SCAN_RESULTS_AVAILABLE
 43

181 
	#WIFI_EVENT_G_SCAN_CAPABILITIES
 44

183 
	#WIFI_EVENT_ROAM_CANDIDATE_FOUND
 45

185 
	#WIFI_EVENT_ROAM_SCAN_CONFIG
 46

187 
	#WIFI_EVENT_AUTH_TIMEOUT
 47

188 
	#WIFI_EVENT_ASSOC_TIMEOUT
 48

189 
	#WIFI_EVENT_MEM_ALLOC_FAILURE
 49

190 
	#WIFI_EVENT_DRIVER_PNO_ADD
 50

191 
	#WIFI_EVENT_DRIVER_PNO_REMOVE
 51

192 
	#WIFI_EVENT_DRIVER_PNO_NETWORK_FOUND
 52

194 
	#WIFI_EVENT_DRIVER_PNO_SCAN_REQUESTED
 53

195 
	#WIFI_EVENT_DRIVER_PNO_SCAN_RESULT_FOUND
 54

197 
	#WIFI_EVENT_DRIVER_PNO_SCAN_COMPLETE
 55

199 

	)

204 
	#WIFI_TAG_VENDOR_SPECIFIC
 0

205 
	#WIFI_TAG_BSSID
 1

206 
	#WIFI_TAG_ADDR
 2

207 
	#WIFI_TAG_SSID
 3

208 
	#WIFI_TAG_STATUS
 4

209 
	#WIFI_TAG_CHANNEL_SPEC
 5

210 
	#WIFI_TAG_WAKE_LOCK_EVENT
 6

211 
	#WIFI_TAG_ADDR1
 7

212 
	#WIFI_TAG_ADDR2
 8

213 
	#WIFI_TAG_ADDR3
 9

214 
	#WIFI_TAG_ADDR4
 10

215 
	#WIFI_TAG_TSF
 11

216 
	#WIFI_TAG_IE
 12

219 
	#WIFI_TAG_INTERFACE
 13

220 
	#WIFI_TAG_REASON_CODE
 14

221 
	#WIFI_TAG_RATE_MBPS
 15

222 
	#WIFI_TAG_REQUEST_ID
 16

223 
	#WIFI_TAG_BUCKET_ID
 17

224 
	#WIFI_TAG_GSCAN_PARAMS
 18

225 
	#WIFI_TAG_GSCAN_CAPABILITIES
 19

226 
	#WIFI_TAG_SCAN_ID
 20

227 
	#WIFI_TAG_RSSI
 21

228 
	#WIFI_TAG_CHANNEL
 22

229 
	#WIFI_TAG_LINK_ID
 23

230 
	#WIFI_TAG_LINK_ROLE
 24

231 
	#WIFI_TAG_LINK_STATE
 25

232 
	#WIFI_TAG_LINK_TYPE
 26

233 
	#WIFI_TAG_TSCO
 27

234 
	#WIFI_TAG_RSCO
 28

235 
	#WIFI_TAG_EAPOL_MESSAGE_TYPE
 29

237 

	)

238 
	sscsc_v_log
 {

239 
u16
 
g
;

240 
u16
 
Ëngth
;

241 
u8
 
v®ue
[0];

242 } 
__·cked
;

244 
	sscsc_wifi_ršg_bufãr_driv”_cÚÃùiv™y_ev’t
 {

245 
u16
 
ev’t
;

246 
scsc_v_log
 
vs
[0];

247 } 
__·cked
;

253 
	sscsc_wake_lock_ev’t
 {

254 
¡©us
;

255 
»asÚ
;

256 
Çme
[0];

257 } 
__·cked
;

259 
	sscsc_wifi_pow”_ev’t
 {

260 
u16
 
ev’t
;

261 
scsc_v_log
 
vs
[0];

262 } 
__·cked
;

264 
	#PER_PACKET_ENTRY_FLAGS_DIRECTION_TX
 1

	)

265 
	#PER_PACKET_ENTRY_FLAGS_TX_SUCCESS
 2

	)

266 
	#PER_PACKET_ENTRY_FLAGS_80211_HEADER
 4

	)

267 
	#PER_PACKET_ENTRY_FLAGS_PROTECTED
 8

	)

269 
	sscsc_wifi_ršg_³r_·ck‘_¡©us_’Œy
 {

270 
u8
 
æags
;

271 
u8
 
tid
;

272 
u16
 
MCS
;

273 
u8
 
rssi
;

274 
u8
 
num_»Œ›s
;

275 
u16
 
Ï¡_Œªsm™_¿‹
;

276 
u16
 
lšk_Ïy”_Œªsm™_£qu’û
;

277 
u64
 
fœmw¬e_’Œy_time¡amp
;

278 
u64
 
¡¬t_cÚ‹ÁiÚ_time¡amp
;

279 
u64
 
Œªsm™_sucûss_time¡amp
;

280 
u8
 
d©a
[0];

281 } 
__·cked
;

283 (*
	tÚ_driv”_memÜy_dump
)(*
	tbufãr
, 
	tbufãr_size
, *
	tùx
);

284 (*
	tÚ_fœmw¬e_memÜy_dump
)(*
	tbufãr
, 
	tbufãr_size
, *
	tùx
);

288 
	#MD5_PREFIX_LEN
 4

	)

289 
	#MAX_FATE_LOG_LEN
 32

	)

290 
	#MAX_FRAME_LEN_ETHERNET
 1518

	)

291 
	#MAX_FRAME_LEN_80211_MGMT
 2352

292 

	)

295 
TX_PKT_FATE_ACKED
,

298 
TX_PKT_FATE_SENT
,

301 
TX_PKT_FATE_FW_QUEUED
,

305 
TX_PKT_FATE_FW_DROP_INVALID
,

308 
TX_PKT_FATE_FW_DROP_NOBUFS
,

313 
TX_PKT_FATE_FW_DROP_OTHER
,

316 
TX_PKT_FATE_DRV_QUEUED
,

320 
TX_PKT_FATE_DRV_DROP_INVALID
,

323 
TX_PKT_FATE_DRV_DROP_NOBUFS
,

326 
TX_PKT_FATE_DRV_DROP_OTHER
,

327 } 
	twifi_tx_·ck‘_ç‹
;

331 
RX_PKT_FATE_SUCCESS
,

334 
RX_PKT_FATE_FW_QUEUED
,

337 
RX_PKT_FATE_FW_DROP_FILTER
,

341 
RX_PKT_FATE_FW_DROP_INVALID
,

344 
RX_PKT_FATE_FW_DROP_NOBUFS
,

347 
RX_PKT_FATE_FW_DROP_OTHER
,

350 
RX_PKT_FATE_DRV_QUEUED
,

353 
RX_PKT_FATE_DRV_DROP_FILTER
,

356 
RX_PKT_FATE_DRV_DROP_INVALID
,

359 
RX_PKT_FATE_DRV_DROP_NOBUFS
,

362 
RX_PKT_FATE_DRV_DROP_OTHER
,

363 } 
	twifi_rx_·ck‘_ç‹
;

366 
FRAME_TYPE_UNKNOWN
,

367 
FRAME_TYPE_ETHERNET_II
,

368 
FRAME_TYPE_80211_MGMT
,

369 } 
	täame_ty³
;

371 
	sscsc_äame_šfo
 {

376 
äame_ty³
 
·ylßd_ty³
;

381 
size_t
 
äame_Ën
;

390 
u32
 
driv”_time¡amp_u£c
;

401 
u32
 
fœmw¬e_time¡amp_u£c
;

413 
‘h”Ãt_ii_by‹s
[
MAX_FRAME_LEN_ETHERNET
];

414 
›“_80211_mgmt_by‹s
[
MAX_FRAME_LEN_80211_MGMT
];

415 } 
äame_cÚ‹Á
;

422 
md5_´efix
[
MD5_PREFIX_LEN
];

423 
wifi_tx_·ck‘_ç‹
 
ç‹
;

424 
scsc_äame_šfo
 
äame_šf
;

425 } 
	t__·cked
 
	twifi_tx_»pÜt
;

431 
md5_´efix
[
MD5_PREFIX_LEN
];

432 
wifi_rx_·ck‘_ç‹
 
ç‹
;

433 
scsc_äame_šfo
 
äame_šf
;

434 } 
	t__·cked
 
	twifi_rx_»pÜt
;

	@scsc_wlan_mmap.c

6 
	~<lšux/k”Ãl.h
>

7 
	~<lšux/moduË.h
>

8 
	~<lšux/moduË·¿m.h
>

9 
	~<lšux/cdev.h
>

10 
	~<lšux/deviû.h
>

11 
	~<lšux/uacûss.h
>

12 
	~<lšux/mm.h
>

13 
	~"debug.h
"

15 
	#N_MINORS
 1

	)

16 
	#SCSC_WLAN_MAX_SIZE
 4*1024*1024

	)

18 
şass
 *
	gscsc_wÏn_mm­_şass
;

19 
cdev
 
	gscsc_wÏn_mm­_dev
[
N_MINORS
];

20 
dev_t
 
	gdev_num
;

22 
DEFINE_MUTEX
(
scsc_wÏn_lock
);

23 *
	gscsc_wÏn_mm­_buf
;

24 
size_t
 
	gscsc_wÏn_mm­_size
;

26 
	$scsc_wÏn_mm­_İ’
(
šode
 *šode, 
fe
 *
fp
)

28 
	`SLSI_INFO_NODEV
("scsc_wlan_mmap_open\n");

30 
	}
}

32 
	$scsc_wÏn_mm­_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

34 
	`SLSI_INFO_NODEV
("scsc_wlan_mmap_release\n");

36 
	}
}

39 
	$scsc_wÏn_mm­
(
fe
 *
fp
, 
vm_¬—_¡ruù
 *
vma
)

41 
¡¬t
 = 
vma
->
vm_¡¬t
;

42 
size
 = 
vma
->
vm_’d
 - vma->
vm_¡¬t
;

45 
off£t
 = 0;

46 
·ge
, 
pos
;

48 
	`mu‹x_lock
(&
scsc_wÏn_lock
);

49 ià(
size
 > 
scsc_wÏn_mm­_size
)

50 
”rÜ
;

51 ià(
off£t
 > 
scsc_wÏn_mm­_size
 - 
size
)

52 
”rÜ
;

54 ià(
scsc_wÏn_mm­_buf
 =ğ
NULL
) {

55 
	`SLSI_ERR_NODEV
("scsc_wlan_mmap_buf is NULL\n");

56 
”rÜ
;

59 
pos
 = ()
scsc_wÏn_mm­_buf
 + 
off£t
;

61 
	`SLSI_INFO_NODEV
("scsc_wÏn_mm­ size:%lu off£ˆ%ld\n", 
size
, 
off£t
);

63 
size
 > 0) {

64 
·ge
 = 
	`vm®loc_to_pâ
((*)
pos
);

65 ià(
	`»m­_pâ_¿nge
(
vma
, 
¡¬t
, 
·ge
, 
PAGE_SIZE
, 
PAGE_SHARED
))

66 
”rÜ
;

68 
¡¬t
 +ğ
PAGE_SIZE
;

69 
pos
 +ğ
PAGE_SIZE
;

70 ià(
size
 > 
PAGE_SIZE
)

71 
size
 -ğ
PAGE_SIZE
;

73 
size
 = 0;

76 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

78 
”rÜ
:

79 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

80  -
EAGAIN
;

81 
	}
}

83 
	$scsc_wÏn_mm­_£t_bufãr
(*
buf
, 
size_t
 
sz
)

85 
	`mu‹x_lock
(&
scsc_wÏn_lock
);

86 ià(
sz
 > 
SCSC_WLAN_MAX_SIZE
) {

87 
	`SLSI_ERR_NODEV
("Siz%zuƒxûed %d\n", 
sz
, 
SCSC_WLAN_MAX_SIZE
);

88 
scsc_wÏn_mm­_buf
 = 
NULL
;

89 
scsc_wÏn_mm­_size
 = 0;

90 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

91  -
EIO
;

94 
	`SLSI_INFO_NODEV
("scsc_wÏn_mm­_£t_bufã¸size:%zu\n", 
sz
);

95 
scsc_wÏn_mm­_buf
 = 
buf
;

96 
scsc_wÏn_mm­_size
 = 
sz
;

97 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

100 
	}
}

102 cÚ¡ 
fe_İ”©iÚs
 
	gscsc_wÏn_mm­_fİs
 = {

103 .
owÃr
 = 
THIS_MODULE
,

104 .
	gİ’
 = 
scsc_wÏn_mm­_İ’
,

105 .
	gmm­
 = 
scsc_wÏn_mm­
,

106 .
	g»Ëa£
 = 
scsc_wÏn_mm­_»Ëa£
,

109 
	$scsc_wÏn_mm­_ü—‹
()

111 
deviû
 *
dev
;

112 
i
;

113 
»t
;

114 
dev_t
 
cu¼_dev
;

117 
»t
 = 
	`®loc_chrdev_»giÚ
(&
dev_num
, 0, 
N_MINORS
, "scsc_wlan_mmap");

118 ià(
»t
) {

119 
	`SLSI_ERR_NODEV
("alloc_chrdev_region failed");

120 
”rÜ
;

124 
scsc_wÏn_mm­_şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, "scsc_wlan_mmap_class");

125 ià(
	`IS_ERR
(
scsc_wÏn_mm­_şass
)) {

126 
»t
 = 
	`PTR_ERR
(
scsc_wÏn_mm­_şass
);

127 
”rÜ_şass
;

131 
i
 = 0; i < 
N_MINORS
; i++) {

132 
cu¼_dev
 = 
	`MKDEV
(
	`MAJOR
(
dev_num
), 
i
);

134 
	`cdev_š™
(&
scsc_wÏn_mm­_dev
[
i
], &
scsc_wÏn_mm­_fİs
);

135 
»t
 = 
	`cdev_add
(&
scsc_wÏn_mm­_dev
[
i
], 
cu¼_dev
, 1);

136 ià(
»t
) {

137 
	`SLSI_ERR_NODEV
("cdev_add failed");

141 
scsc_wÏn_mm­_dev
[
i
].
owÃr
 = 
THIS_MODULE
;

143 
dev
 = 
	`deviû_ü—‹
(
scsc_wÏn_mm­_şass
, 
NULL
, 
cu¼_dev
, NULL, "scsc_wÏn_mm­_%d", 
i
);

144 ià(
	`IS_ERR
(
dev
)) {

145 
	`SLSI_ERR_NODEV
("device_create failed");

146 
»t
 = 
	`PTR_ERR
(
dev
);

147 
	`cdev_d–
(&
scsc_wÏn_mm­_dev
[
i
]);

154 
”rÜ_şass
:

155 
	`uÄegi¡”_chrdev_»giÚ
(
dev_num
, 
N_MINORS
);

156 
”rÜ
:

158 
	}
}

160 
	$scsc_wÏn_mm­_de¡roy
()

162 
i
;

163 
majÜ
 = 
	`MAJOR
(
dev_num
);

164 
dev_t
 
cu¼_dev
;

166 
i
 = 0; i < 
N_MINORS
; i++) {

167 
cu¼_dev
 = 
	`MKDEV
(
majÜ
, 
i
);

168 
	`cdev_d–
(&
scsc_wÏn_mm­_dev
[
i
]);

169 
	`deviû_de¡roy
(
scsc_wÏn_mm­_şass
, 
dev_num
);

171 
	`şass_de¡roy
(
scsc_wÏn_mm­_şass
);

172 
	`uÄegi¡”_chrdev_»giÚ
(
dev_num
, 
N_MINORS
);

174 
	}
}

	@scsc_wlan_mmap.h

7 #iâdeà
SCSC_WLAN_MMAP_H


8 
	#SCSC_WLAN_MMAP_H


	)

10 
scsc_wÏn_mm­_ü—‹
();

11 
scsc_wÏn_mm­_de¡roy
();

12 
scsc_wÏn_mm­_£t_bufãr
(*
buf
, 
size_t
 
sz
);

	@slsi_cpuhp_monitor.c

6 
	~"dev.h
"

7 
	~"debug.h
"

8 
	~"¦si_ıuhp_mÚ™Ü.h
"

10 
ıuhp_¡©e
 
	gıuhp_¡©e_num
 = 
CPUHP_INVALID
;

12 
	sıuhp_cb_node
 {

13 
hli¡_node
 
	mnode
;

14 (*
	mÚlše
)(
	mıu
, *
	md©a
);

15 (*
	mofæše
)(
	mıu
, *
	md©a
);

16 *
	md©a
;

19 
	$¦si_ıuhp_Úlše
(
ıu
, 
hli¡_node
 *
node
)

21 
ıuhp_cb_node
 *
cb_node
 = 
	`cÚš”_of
(
node
, cpuhp_cb_node,‚ode);

23  
cb_node
->
	`Úlše
(
ıu
, cb_node->
d©a
);

24 
	}
}

26 
	$¦si_ıuhp_ofæše
(
ıu
, 
hli¡_node
 *
node
)

28 
ıuhp_cb_node
 *
cb_node
 = 
	`cÚš”_of
(
node
, cpuhp_cb_node,‚ode);

30  
cb_node
->
	`ofæše
(
ıu
, cb_node->
d©a
);

31 
	}
}

33 
hli¡_node
 *
	$¦si_ıuhp_mÚ™Ü_»gi¡”_ÿÎback
((*
Úlše
)(
ıu
, *
d©a
), (*
ofæše
)(cpu, *data), *data)

35 
ıuhp_cb_node
 *
Ãw_node
;

37 ià(
ıuhp_¡©e_num
 =ğ
CPUHP_INVALID
) {

38 
	`SLSI_ERR_NODEV
("cpuhp_monitor was‚ot initialized.\n");

39  
NULL
;

42 
Ãw_node
 = 
	`km®loc
((*Ãw_node), 
GFP_KERNEL
);

43 ià(!
Ãw_node
) {

44 
	`SLSI_ERR_NODEV
("cannot‡llocate memory for storinghe callbacks.\n");

45  
NULL
;

48 
Ãw_node
->
Úlše
 = online;

49 
Ãw_node
->
ofæše
 = offline;

50 
Ãw_node
->
d©a
 = data;

51 
	`ıuhp_¡©e_add_š¡ªû_noÿÎs
(
ıuhp_¡©e_num
, &
Ãw_node
->
node
);

52 
	`SLSI_INFO_NODEV
("registered‚ew callbacks\n");

54  &
Ãw_node
->
node
;

55 
	}
}

57 
	$¦si_ıuhp_mÚ™Ü_uÄegi¡”_ÿÎback
(
hli¡_node
 *
node
)

59 
ıuhp_cb_node
 *
cb_node
;

61 ià(
ıuhp_¡©e_num
 =ğ
CPUHP_INVALID
) {

62 
	`SLSI_ERR_NODEV
("cpuhp_monitor was‚ot initialized.\n");

63  -
ENODEV
;

66 ià(!
node
) {

67 
	`SLSI_ERR_NODEV
("No‚ode information\n");

68  -
EINVAL
;

71 
cb_node
 = 
	`cÚš”_of
(
node
, 
ıuhp_cb_node
,‚ode);

72 
	`ıuhp_¡©e_»move_š¡ªû_noÿÎs
(
ıuhp_¡©e_num
, &
cb_node
->
node
);

73 
	`SLSI_INFO_NODEV
("unregistered callbacks\n");

74 
	`kä“
(
cb_node
);

77 
	}
}

79 
	$¦si_ıuhp_mÚ™Ü_š™
()

81 
»t
;

83 
»t
 = 
	`ıuhp_£tup_¡©e_muÉi
(
CPUHP_AP_ONLINE_DYN
, "Ãt/wlbt:Úlše", 
¦si_ıuhp_Úlše
, 
¦si_ıuhp_ofæše
);

84 ià(
»t
 > 0)

85 
ıuhp_¡©e_num
 = 
»t
;

86  
»t
;

87 
	}
}

89 
	$¦si_ıuhp_mÚ™Ü_deš™
()

91 
	`ıuhp_»move_muÉi_¡©e
(
ıuhp_¡©e_num
);

92 
ıuhp_¡©e_num
 = 
CPUHP_INVALID
;

93 
	}
}

	@slsi_cpuhp_monitor.h

6 #iâdeà
__CPUHP_MONITOR_H__


7 
	#__CPUHP_MONITOR_H__


	)

9 
	~<lšux/k”Ãl.h
>

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/¦ab.h
>

12 
	~<lšux/ıuhÙ¶ug.h
>

14 
¦si_ıuhp_mÚ™Ü_š™
();

15 
¦si_ıuhp_mÚ™Ü_deš™
();

25 
hli¡_node
 *
¦si_ıuhp_mÚ™Ü_»gi¡”_ÿÎback
((*
Úlše
)(
ıu
, *
d©a
), (*
ofæše
)(cpu, *data), *data);

33 
	`¦si_ıuhp_mÚ™Ü_uÄegi¡”_ÿÎback
(
hli¡_node
 *
node
);

	@src_sink.c

7 
	~"dev.h
"

8 
	~"¤c_sšk.h
"

9 
	~"debug.h
"

10 
	~"çpi.h
"

11 
	~"mlme.h
"

12 
	~"mgt.h
"

14 
	$¦si_¤c_sšk_çke_¡a_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

16 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

17 
¦si_³”
 *
³”
;

18 
u8
 
deviû_add»ss
[
ETH_ALEN
] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};

19 
u8
 
çke_³”_mac
[
ETH_ALEN
] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55};

21 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

23 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

24 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

25 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_STATION
;

27 ià(
	`WARN
(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0, "add VIF failed")) {

28 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

29  -
EFAULT
;

32 ià(
	`WARN
(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0, "activate VIF failed")) {

33 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

34 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

35 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

36  -
EFAULT
;

39 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
çke_³”_mac
, 
SLSI_STA_PEER_QUEUESET
 + 1);

40 ià(
	`WARN
(!
³”
, "add fake…eer failed")) {

41 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

42 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

43 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

44 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

45  -
EFAULT
;

47 
³”
->
qos_’abËd
 = 
Œue
;

48 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

49 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

50 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

52 
	}
}

54 
	$¦si_¤c_sšk_çke_¡a_¡İ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

56 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

57 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

59 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

61 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_SRC_SINK
, "¡©iÚ stİ(vif:%d)\n", 
ndev_vif
->
iâum
);

63 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "not‡ctivated")) {

64 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

68 
	`Ãtif_ÿ¼›r_off
(
dev
);

69 ià(
³”
) {

70 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

71 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

72 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

74 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

75 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

76 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

77 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

78 
	}
}

80 
	$¦si_¤c_sšk_loİback_¡¬t
(
¦si_dev
 *
sdev
)

82 
Ãt_deviû
 *
dev
;

83 
Ãtdev_vif
 *
ndev_vif
;

84 
u8
 
i
, 
queue_idx
;

86 
i
 = 
SLSI_NET_INDEX_WLAN
; i <ğ
SLSI_NET_INDEX_P2P
; i++) {

87 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

88 ià(
	`WARN
(!
dev
, "nØÃtdev (šdex:%d)", 
i
))

89  -
EFAULT
;

91 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

92 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

98 ià(
i
 =ğ
SLSI_NET_INDEX_P2P
) {

99 
queue_idx
 = 0; queue_idx < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queue_idx++) {

100 
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
] = 
	`kz®loc
((*ndev_vif->³”_¡a_»cÜd[queue_idx]), 
GFP_KERNEL
);

101 ià(!
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
]) {

102 
j
;

104 
	`SLSI_NET_ERR
(
dev
, "Could‚Ù‡Îoÿ‹ memÜy fÜ…“¸’Œy (queue_idx:%d)\n", 
queue_idx
);

107 
j
 = 0; j < 
queue_idx
; j++) {

108 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
j
]);

109 
ndev_vif
->
³”_¡a_»cÜd
[
j
] = 
NULL
;

111 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

112  -
EFAULT
;

116 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

117 ià(
	`WARN
(
	`¦si_¤c_sšk_çke_¡a_¡¬t
(
sdev
, 
dev
è!ğ0, "çkSTA s‘u°çed (vif:%d)\n", 
i
))

118  -
EFAULT
;

121 
	}
}

123 
	$¦si_¤c_sšk_loİback_¡İ
(
¦si_dev
 *
sdev
)

125 
Ãt_deviû
 *
dev
;

126 
Ãtdev_vif
 *
ndev_vif
;

127 
u8
 
i
, 
queue_idx
;

129 
i
 = 
SLSI_NET_INDEX_WLAN
; i <ğ
SLSI_NET_INDEX_P2P
; i++) {

130 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

131 ià(
	`WARN
(!
dev
, "nØÃtdev (šdex:%d)", 
i
))

134 
	`¦si_¤c_sšk_çke_¡a_¡İ
(
sdev
, 
dev
);

136 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

137 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

140 ià(
i
 =ğ
SLSI_NET_INDEX_P2P
) {

141 
queue_idx
 = 0; queue_idx < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queue_idx++) {

142 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
]);

143 
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
] = 
NULL
;

146 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

148 
	}
}

150 
	$¦si_¤c_sšk_cdev_ioùl_cfg
(
¦si_dev
 *
sdev
, 
¬g
)

152 
r
 = 0;

153 
unifiio_¤c_sšk_¬g_t
 
¤c_sšk_¬g
;

154 
Ãt_deviû
 *
dev
;

155 
Ãtdev_vif
 *
ndev_vif
;

156 
sk_buff
 *
»q
 = 
NULL
;

157 
sk_buff
 *
šd
 = 
NULL
;

159 
	`mem£t
((*)&
¤c_sšk_¬g
, 0, (
unifiio_¤c_sšk_¬g_t
));

160 ià(
	`cİy_äom_u£r
((*)(&
¤c_sšk_¬g
), (*)
¬g
, (
unifiio_¤c_sšk_¬g_t
)))

161  -
EFAULT
;

163 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, "Source/Sink\n");

164 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, "====================================================\n");

165 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #aùiÚ : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
aùiÚ
);

166 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #dœeùiÚ : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
dœeùiÚ
);

167 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #vià : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
vif
);

168 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #’dpošˆ : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

169 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, "====================================================\n");

171 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

172 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
¤c_sšk_¬g
.
commÚ
.
vif
);

173 ià(
	`WARN_ON
(!
dev
)) {

174 
	`SLSI_ERR
(
sdev
, "Ãtdev fÜ iÅuˆvif:%d i NULL\n", 
¤c_sšk_¬g
.
commÚ
.
vif
);

175 
r
 = -
ENODEV
;

176 
out_locked
;

178 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

180 
¤c_sšk_¬g
.
commÚ
.
aùiÚ
) {

181 
SRC_SINK_ACTION_SINK_START
:

182 ià(
	`WARN
(
	`¦si_¤c_sšk_çke_¡a_¡¬t
(
sdev
, 
dev
) != 0, "fake STA setup failed\n")) {

183 
r
 = -
EFAULT
;

184 
out_locked
;

186 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡¬t_»q
, 
DEBUG_PKT_SINK_START_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

187 ià(
	`WARN_ON
(!
»q
)) {

188 
r
 = -
ENODEV
;

189 
out_locked
;

191 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

192 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

193 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.interval);

194 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
·ck‘s_³r_š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.
pkts_³r_št
);

195 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_sink_start_req->\n");

196 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

198 
SRC_SINK_ACTION_SINK_STOP
:

199 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡İ_»q
, 
DEBUG_PKT_SINK_STOP_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

200 ià(
	`WARN_ON
(!
»q
)) {

201 
r
 = -
ENODEV
;

202 
out_locked
;

204 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

205 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

206 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_sink_stop_req->\n");

207 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

208 
	`¦si_¤c_sšk_çke_¡a_¡İ
(
sdev
, 
dev
);

210 
SRC_SINK_ACTION_GEN_START
:

211 ià(
	`WARN
(
	`¦si_¤c_sšk_çke_¡a_¡¬t
(
sdev
, 
dev
) != 0, "fake STA setup failed\n")) {

212 
r
 = -
EFAULT
;

213 
out_locked
;

215 
»q
 = 
	`çpi_®loc
(
debug_pkt_g’_¡¬t_»q
, 
DEBUG_PKT_GEN_START_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

216 ià(
	`WARN_ON
(!
»q
)) {

217 
r
 = -
ENODEV
;

218 
out_locked
;

220 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

221 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

222 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.interval);

223 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
·ck‘s_³r_š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.
pkts_³r_št
);

224 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
size
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.size);

225 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
u£_¡»amšg
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.use_streaming);

226 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
v4de¡š©iÚ_add»ss
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.
v4_de¡
);

227 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
·ck‘s_³r_š‹¼u±
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.
pkts_³r_šŒ
);

229 
	`SLSI_DBG3
(
sdev
, 
SLSI_SRC_SINK
,

231 
¤c_sšk_¬g
.
u
.
cÚfig
.
š‹rv®
,

232 
¤c_sšk_¬g
.
u
.
cÚfig
.
pkts_³r_št
,

233 
¤c_sšk_¬g
.
commÚ
.
vif
,

234 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
size
,

235 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
u£_¡»amšg
,

236 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
v4_de¡
,

237 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
pkts_³r_šŒ
);

238 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_gen_start_req->\n");

239 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

241 
SRC_SINK_ACTION_GEN_STOP
:

242 
»q
 = 
	`çpi_®loc
(
debug_pkt_g’_¡İ_»q
, 
DEBUG_PKT_GEN_STOP_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

243 ià(
	`WARN_ON
(!
»q
)) {

244 
r
 = -
ENODEV
;

245 
out_locked
;

247 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡İ_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

248 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡İ_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

249 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_gen_stop_req->\n");

250 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

251 
	`¦si_¤c_sšk_çke_¡a_¡İ
(
sdev
, 
dev
);

253 
SRC_SINK_ACTION_LOOPBACK_START
:

254 ià(
	`WARN
(
	`¦si_¤c_sšk_loİback_¡¬t
(
sdev
) != 0, "loopback setup failed\n")) {

255 
r
 = -
EFAULT
;

256 
out_locked
;

258 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡¬t_»q
, 
DEBUG_PKT_SINK_START_REQ
, 1, 0);

259 ià(
	`WARN_ON
(!
»q
)) {

260 
r
 = -
ENODEV
;

261 
out_locked
;

263 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
’d_pošt
, 
SRC_SINK_ENDPOINT_HOSTIO
);

264 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
dœeùiÚ
, 
SRC_SINK_DIRECTION_RX
);

265 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.interval);

266 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
·ck‘s_³r_š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.
pkts_³r_št
);

267 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_loopback_start_req->\n");

268 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

270 
SRC_SINK_ACTION_LOOPBACK_STOP
:

271 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡İ_»q
, 
DEBUG_PKT_SINK_STOP_REQ
, 1, 0);

272 ià(
	`WARN_ON
(!
»q
)) {

273 
r
 = -
ENODEV
;

274 
out_locked
;

276 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
dœeùiÚ
, 
SRC_SINK_DIRECTION_RX
);

277 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
’d_pošt
, 
SRC_SINK_ENDPOINT_HOSTIO
);

278 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_loopback_stop_req->\n");

279 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

280 
	`¦si_¤c_sšk_loİback_¡İ
(
sdev
);

282 
SRC_SINK_ACTION_SINK_REPORT
:

283 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_»pÜt_»q
, 
DEBUG_PKT_SINK_REPORT_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

284 ià(
	`WARN_ON
(!
»q
)) {

285 
r
 = -
ENODEV
;

286 
out_locked
;

288 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_»pÜt_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

289 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_»pÜt_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

290 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_sšk_»pÜt_»q
.
»pÜt_š‹rv®
, 
¤c_sšk_¬g
.u.
»pÜt
.
š‹rv®
);

291 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_sink_report_req->\n");

293 
šd
 = 
	`¦si_mlme_»q_šd
(
sdev
, 
dev
, 
»q
, 
DEBUG_PKT_SINK_REPORT_IND
);

294 ià(!
šd
) {

295 
	`SLSI_ERR
(
sdev
, "slsi_mlme_req_ind [SINK_REPORT] failed\n");

296 
r
 = -
EIO
;

300 
¤c_sšk_¬g
.
u
.
»pÜt
.
du¿tiÚ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.duration);

301 
¤c_sšk_¬g
.
u
.
»pÜt
.
couÁ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.
»ûived_·ck‘s
);

302 
¤c_sšk_¬g
.
u
.
»pÜt
.
où‘
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.
»ûived_où‘s
);

303 
¤c_sšk_¬g
.
u
.
»pÜt
.
kbps
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.kbps);

304 
¤c_sšk_¬g
.
u
.
»pÜt
.
idË_¿tio
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.idle_ratio);

305 
¤c_sšk_¬g
.
u
.
»pÜt
.
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.
št_Ï‹ncy
);

306 
¤c_sšk_¬g
.
u
.
»pÜt
.
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.free_kbytes);

307 
¤c_sšk_¬g
.
u
.
»pÜt
.
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

309 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

312 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

313 
r
 = -
EFAULT
;

314 
	`kä“_skb
(
šd
);

316 
SRC_SINK_ACTION_GEN_REPORT
:

317 
»q
 = 
	`çpi_®loc
(
debug_pkt_g’_»pÜt_»q
, 
DEBUG_PKT_GEN_REPORT_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

318 ià(
	`WARN_ON
(!
»q
)) {

319 
r
 = -
ENODEV
;

320 
out_locked
;

322 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_»pÜt_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

323 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_»pÜt_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

324 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_g’_»pÜt_»q
.
»pÜt_š‹rv®
, 
¤c_sšk_¬g
.u.
»pÜt
.
š‹rv®
);

325 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_gen_report_req->\n");

327 
šd
 = 
	`¦si_mlme_»q_šd
(
sdev
, 
dev
, 
»q
, 
DEBUG_PKT_GEN_REPORT_IND
);

328 ià(!
šd
) {

329 
	`SLSI_ERR
(
sdev
, "slsi_mlme_req_ind [GEN_REPORT] failed\n");

330 
r
 = -
EIO
;

334 
¤c_sšk_¬g
.
u
.
»pÜt
.
du¿tiÚ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.duration);

335 
¤c_sšk_¬g
.
u
.
»pÜt
.
couÁ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.
»ûived_·ck‘s
);

336 
¤c_sšk_¬g
.
u
.
»pÜt
.
çed_couÁ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.failed_count);

337 
¤c_sšk_¬g
.
u
.
»pÜt
.
où‘
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.
»ûived_où‘s
);

338 
¤c_sšk_¬g
.
u
.
»pÜt
.
kbps
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.kbps);

339 
¤c_sšk_¬g
.
u
.
»pÜt
.
idË_¿tio
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.idle_ratio);

340 
¤c_sšk_¬g
.
u
.
»pÜt
.
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.
št_Ï‹ncy
);

341 
¤c_sšk_¬g
.
u
.
»pÜt
.
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.free_kbytes);

343 
¤c_sšk_¬g
.
u
.
»pÜt
.
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

345 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

348 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

349 
r
 = -
EFAULT
;

350 
	`kä“_skb
(
šd
);

352 
SRC_SINK_ACTION_SINK_REPORT_CACHED
:

353 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "cached sink_report\n");

354 
	`memıy
(&
¤c_sšk_¬g
.
u
.
»pÜt
, &
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
, (
unifiio_¤c_sšk_»pÜt
));

355 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

357 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

358 
r
 = -
EFAULT
;

361 
SRC_SINK_ACTION_GEN_REPORT_CACHED
:

362 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "cached gen_report\n");

363 
	`memıy
(&
¤c_sšk_¬g
.
u
.
»pÜt
, &
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
, (
unifiio_¤c_sšk_»pÜt
));

364 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

366 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

367 
r
 = -
EFAULT
;

370 
	`SLSI_ERR
(
sdev
, "Inv®id iÅuˆfÜ‡ùiÚ: 0x%04X\n", 
¤c_sšk_¬g
.
commÚ
.
aùiÚ
);

371 
r
 = -
EINVAL
;

375 
out_locked
:

376 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

377 ià(
r
)

378 
	`SLSI_ERR
(
sdev
, "¦si_¤c_sšk_cdev_ioùl_cfg(vif:%dèçed w™h %ld\n", 
¤c_sšk_¬g
.
commÚ
.
vif
, 
r
);

379  
r
;

380 
	}
}

382 
	$¦si_rx_sšk_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

384 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

385 
unifiio_¤c_sšk_»pÜt
 *
»pÜt
 = &
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
;

387 
	`SLSI_DBG3
(
sdev
, 
SLSI_SRC_SINK
, "RX debug_pkt_sink_report_ind\n");

389 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

390 
	`mem£t
(
»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

391 
»pÜt
->
du¿tiÚ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.duration);

392 
»pÜt
->
couÁ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.
»ûived_·ck‘s
);

393 
»pÜt
->
où‘
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.
»ûived_où‘s
);

394 
»pÜt
->
kbps
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.kbps);

395 
»pÜt
->
idË_¿tio
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.idle_ratio);

396 
»pÜt
->
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.
št_Ï‹ncy
);

397 
»pÜt
->
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.free_kbytes);

398 
»pÜt
->
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

399 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

400 
	`kä“_skb
(
skb
);

401 
	}
}

403 
	$¦si_rx_g’_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

405 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

406 
unifiio_¤c_sšk_»pÜt
 *
»pÜt
 = &
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
;

408 
	`SLSI_DBG3
(
sdev
, 
SLSI_SRC_SINK
, "RX debug_pkt_gen_report_ind\n");

410 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

411 
	`mem£t
(
»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

412 
»pÜt
->
du¿tiÚ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.duration);

413 
»pÜt
->
couÁ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.
»ûived_·ck‘s
);

414 
»pÜt
->
çed_couÁ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.failed_count);

415 
»pÜt
->
où‘
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.
»ûived_où‘s
);

416 
»pÜt
->
kbps
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.kbps);

417 
»pÜt
->
idË_¿tio
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.idle_ratio);

418 
»pÜt
->
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.
št_Ï‹ncy
);

419 
»pÜt
->
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.free_kbytes);

420 
»pÜt
->
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

421 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

422 
	`kä“_skb
(
skb
);

423 
	}
}

	@src_sink.h

7 #iâdeà
__SLSI_SRC_SINK_H__


8 
	#__SLSI_SRC_SINK_H__


	)

10 
	~"unifiio.h
"

12 
	s¦si_¤c_sšk_·¿ms
 {

13 
unifiio_¤c_sšk_»pÜt
 
	msšk_»pÜt
;

14 
unifiio_¤c_sšk_»pÜt
 
	mg’_»pÜt
;

17 
¦si_¤c_sšk_cdev_ioùl_cfg
(
¦si_dev
 *
sdev
, 
¬g
);

19 
¦si_rx_sšk_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

20 
¦si_rx_g’_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

	@test/dev_test.c

7 
	~<Ãt/.h
>

9 
	~"debug.h
"

10 
	~"uts.h
"

11 
	~"udi.h
"

12 
	~"un™‹¡.h
"

13 
	~"mgt.h
"

14 
	~"scsc/scsc_mx.h
"

16 
	#SLSI_TESTDRV_NAME
 "s5n2560_‹¡"

	)

18 
	g¿dios
 = 11;

19 
moduË_·¿m
(
¿dios
, , 0444);

20 
MODULE_PARM_DESC
(
¿dios
, "Number of simulated„adios");

23 
¦si_¥šlock
 
	g¦si_‹¡_deviûs_lock
;

24 
¦si_‹¡_dev
 *
	g¦si_‹¡_deviûs
[
SLSI_UDI_MINOR_NODES
];

26 
şass
 *
	g‹¡_dev_şass
;

28 
dev_t
 
	gmajÜ_numb”
;

30 
deviû_driv”
 
	g¦si_‹¡_driv”
 = {

31 .
Çme
 = 
SLSI_TESTDRV_NAME


34 
¦si_‹¡_dev_©ch_wÜk
(
wÜk_¡ruù
 *
wÜk
);

35 
¦si_‹¡_dev_d‘ach_wÜk
(
wÜk_¡ruù
 *
wÜk
);

37 
	$¦si_‹¡_dev_ä“
()

39 
i
;

41 
i
 = 0; i < 
SLSI_UDI_MINOR_NODES
; i++) {

42 
¦si_‹¡_dev
 *
uáe¡dev
;

44 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

45 
uáe¡dev
 = 
¦si_‹¡_deviûs
[
i
];

46 
¦si_‹¡_deviûs
[
i
] = 
NULL
;

47 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

48 ià(
uáe¡dev
 !ğ
NULL
) {

49 
	`SLSI_INFO_NODEV
("Free Test Device: %02X:%02X:%02X:%02X:%02X:%02X\n",

50 
uáe¡dev
->
hw_addr
[0],

51 
uáe¡dev
->
hw_addr
[1],

52 
uáe¡dev
->
hw_addr
[2],

53 
uáe¡dev
->
hw_addr
[3],

54 
uáe¡dev
->
hw_addr
[4],

55 
uáe¡dev
->
hw_addr
[5]);

57 ià(
	`WARN_ON
(
uáe¡dev
->
©ched
)) {

58 
	`¦si_‹¡_bh_deš™
(
uáe¡dev
);

59 
	`æush_wÜkqueue
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
);

61 
	`de¡roy_wÜkqueue
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
);

63 
	`¦si_‹¡_udi_node_deš™
(
uáe¡dev
);

65 
	`deviû_uÄegi¡”
(
uáe¡dev
->
dev
);

66 
	`deviû_de¡roy
(
‹¡_dev_şass
, 
uáe¡dev
->
dev
->
devt
);

70 
	`¦si_‹¡_udi_deš™
();

72 ià(
‹¡_dev_şass
 !ğ
NULL
)

73 
	`şass_de¡roy
(
‹¡_dev_şass
);

75 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

76 
	}
}

78 
	$¦si_sdio_func_drv_»gi¡”
()

80 
i
 = 0, 
”r
 = 0, 
»t
 = 0;

81 
¦si_‹¡_dev
 *
uáe¡dev
;

82 
dev_t
 
devno
;

84 
	`SLSI_INFO_NODEV
("Lßdšg SLSI " 
SLSI_TESTDRV_NAME
 " Test Driver for mac80211\n");

86 ià(
¿dios
 > 
SLSI_UDI_MINOR_NODES
) {

87 
	`SLSI_ERR_NODEV
("Loading failed, configure SLSI_UDI_MINOR_NODESo match‚o. of simulated„adios\n");

88  -
ENOMEM
;

91 
	`¦si_¥šlock_ü—‹
(&
¦si_‹¡_deviûs_lock
);

92 
	`mem£t
(
¦si_‹¡_deviûs
, 0x00, (slsi_test_devices));

95 
»t
 = 
	`®loc_chrdev_»giÚ
(&
majÜ_numb”
, 0, 
SLSI_UDI_MINOR_NODES
, 
SLSI_TESTDRV_NAME
);

96 ià(
»t
) {

97 
	`SLSI_ERR_NODEV
("FaedØadd‡Îoødev‚umb”s: %d\n", 
»t
);

98 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

99 
majÜ_numb”
 = 0;

100  -
ENOMEM
;

103 
‹¡_dev_şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
SLSI_TESTDRV_NAME
);

104 ià(
	`IS_ERR
(
‹¡_dev_şass
))

105  -
EAGAIN
;

107 
	`¦si_‹¡_udi_š™
();

109 
i
 = 0; i < 
¿dios
; i++) {

110 
uáe¡dev
 = 
	`km®loc
((*uáe¡dev), 
GFP_KERNEL
);

111 
	`mem£t
(
uáe¡dev
, 0, (*uftestdev));

112 
uáe¡dev
->
©ch_d‘ach_wÜk_queue
 = 
	`®loc_Üd”ed_wÜkqueue
("Test Work", 0);

113 
	`INIT_WORK
(&
uáe¡dev
->
©ch_wÜk
, 
¦si_‹¡_dev_©ch_wÜk
);

114 
	`INIT_WORK
(&
uáe¡dev
->
d‘ach_wÜk
, 
¦si_‹¡_dev_d‘ach_wÜk
);

116 
devno
 = 
	`MKDEV
(
	`MAJOR
(
majÜ_numb”
), 
i
);

118 
uáe¡dev
->
dev
 = 
	`deviû_ü—‹
(
‹¡_dev_şass
, 
NULL
, 
devno
, uáe¡dev, 
SLSI_TESTDRV_NAME
 "_dev%d", 
i
);

119 ià(
	`IS_ERR
(
uáe¡dev
->
dev
)) {

120 
	`SLSI_ERR_NODEV
("deviû_ü—‹ FAILED,„‘uºed - (%ld)\n", 
	`PTR_ERR
(
uáe¡dev
->
dev
));

121 
”r
 = -
ENOMEM
;

122 
çed_ä“_®l
;

125 
uáe¡dev
->
dev
->
driv”
 = &
¦si_‹¡_driv”
;

127 
	`mu‹x_š™
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

128 
	`¦si_‹¡_bh_š™
(
uáe¡dev
);

129 
	`¥š_lock_š™
(&
uáe¡dev
->
rou‹_¥šlock
);

131 ià(
	`¦si_‹¡_udi_node_š™
(
uáe¡dev
, uáe¡dev->
dev
) != 0) {

132 
	`SLSI_ERR_NODEV
("udi <node> init FAILED\n");

133 
çed_dev_uÄegi¡”
;

141 
	`mem£t
(
uáe¡dev
->
hw_addr
, 0, (uftestdev->hw_addr));

142 
uáe¡dev
->
hw_addr
[1] = 0x12;

143 
uáe¡dev
->
hw_addr
[2] = 0xFB;

145 
uáe¡dev
->
hw_addr
[
ETH_ALEN
 - 1] +ğ(
i
 & (0xff));

147 
	`SLSI_INFO_NODEV
("Create Test Device: %02X:%02X:%02X:%02X:%02X:%02X\n",

148 
uáe¡dev
->
hw_addr
[0],

149 
uáe¡dev
->
hw_addr
[1],

150 
uáe¡dev
->
hw_addr
[2],

151 
uáe¡dev
->
hw_addr
[3],

152 
uáe¡dev
->
hw_addr
[4],

153 
uáe¡dev
->
hw_addr
[5]);

154 
¦si_‹¡_deviûs
[
uáe¡dev
->
deviû_mšÜ_numb”
] = uftestdev;

159 
çed_dev_uÄegi¡”
:

160 
	`deviû_uÄegi¡”
(
uáe¡dev
->
dev
);

161 
	`deviû_de¡roy
(
‹¡_dev_şass
, 
uáe¡dev
->
dev
->
devt
);

162 
çed_ä“_®l
:

163 
	`¦si_‹¡_dev_ä“
();

165  -
EPERM
;

166 
	}
}

168 
	$¦si_sdio_func_drv_uÄegi¡”
()

170 
	`SLSI_INFO_NODEV
("Unloading UF6K Test Driver for mac80211\n");

171 
	`¦si_‹¡_dev_ä“
();

172 
	}
}

174 
	$¦si_‹¡_dev_©ch
(
¦si_‹¡_dev
 *
uáe¡dev
)

176 
¦si_dev
 *
sdev
;

177 
scsc_£rviû_ş›Á
 
£rviû_ş›Á
;

179 
	`mu‹x_lock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

180 
	`SLSI_INFO_NODEV
("UnitTest UDI Attached : %02X:%02X:%02X:%02X:%02X:%02X\n",

181 
uáe¡dev
->
hw_addr
[0],

182 
uáe¡dev
->
hw_addr
[1],

183 
uáe¡dev
->
hw_addr
[2],

184 
uáe¡dev
->
hw_addr
[3],

185 
uáe¡dev
->
hw_addr
[4],

186 
uáe¡dev
->
hw_addr
[5]);

188 ià(
uáe¡dev
->
©ched
) {

189 
	`SLSI_ERR_NODEV
("attached ==rue\n");

190 
ex™
;

193 
uáe¡dev
->
©ched
 = 
Œue
;

194 
sdev
 = 
	`¦si_dev_©ch
(
uáe¡dev
->
dev
, (
scsc_mx
 *)uáe¡dev, &
£rviû_ş›Á
);

196 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

197 
uáe¡dev
->
sdev
 = sdev;

198 ià(!
sdev
) {

199 
	`SLSI_ERR_NODEV
("slsi_dev_attach() Failed\n");

200 
uáe¡dev
->
©ched
 = 
çl£
;

202 
	`¦si_‹¡_bh_¡¬t
(
uáe¡dev
);

205 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

207 
ex™
:

208 
	`mu‹x_uÆock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

209 
	}
}

211 
	$¦si_‹¡_dev_d‘ach
(
¦si_‹¡_dev
 *
uáe¡dev
)

213 
	`mu‹x_lock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

214 
	`SLSI_INFO
(
uáe¡dev
->
sdev
, "UnitTest UDI Detached : %02X:%02X:%02X:%02X:%02X:%02X\n",

215 
uáe¡dev
->
hw_addr
[0],

216 
uáe¡dev
->
hw_addr
[1],

217 
uáe¡dev
->
hw_addr
[2],

218 
uáe¡dev
->
hw_addr
[3],

219 
uáe¡dev
->
hw_addr
[4],

220 
uáe¡dev
->
hw_addr
[5]);

221 ià(!
uáe¡dev
->
©ched
) {

222 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "attached !=rue\n");

223 
ex™
;

226 
uáe¡dev
->
©ched
 = 
çl£
;

227 ià(
uáe¡dev
->
sdev
) {

228 
¦si_dev
 *
sdev
 = 
uáe¡dev
->sdev;

230 
	`¦si_‹¡_bh_¡İ
(
uáe¡dev
);

232 
	`¦si_dev_d‘ach
(
sdev
);

233 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

234 
uáe¡dev
->
sdev
 = 
NULL
;

235 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

238 
ex™
:

239 
	`mu‹x_uÆock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

240 
	}
}

242 
	$¦si_š™_Ãtdev_mac_addr
(
¦si_dev
 *
sdev
)

245 
	`¦si_g‘_hw_mac_add»ss
(
sdev
, sdev->
hw_addr
);

247 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_WLAN
], sdev->
hw_addr
);

249 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
], sdev->
hw_addr
);

250 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
][0] |= 0x02;

252 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
hw_addr
);

253 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][0] |= 0x02;

254 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][4] ^= 0x80;

256 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]->
dev_addr
, sdev->
Ãtdev_add»s£s
[SLSI_NET_INDEX_WLAN]);

257 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2P
]->
dev_addr
, sdev->
Ãtdev_add»s£s
[SLSI_NET_INDEX_P2P]);

258 
	}
}

260 
boŞ
 
	$¦si_‹¡_´oûss_sigÇl__»m­
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
, 
¦si_‹¡_d©a_rou‹
 *
rou‹
)

262 
´Ùo
 = 
	`Áohs
(
skb
->
´ÙocŞ
);

263 
u8
 *
äame
 = 
	`çpi_g‘_d©a
(
skb
) + 14;

265 
´Ùo
) {

269 
u8
 *
sha
 = &
äame
[8];

270 
u8
 *
¥a
 = &
äame
[14];

271 
u8
 *
tha
 = &
äame
[18];

272 
u8
 *
a
 = &
äame
[24];

274 
	`SLSI_UNUSED_PARAMETER
(
sha
);

275 
	`SLSI_UNUSED_PARAMETER
(
¥a
);

276 
	`SLSI_UNUSED_PARAMETER
(
tha
);

277 
	`SLSI_UNUSED_PARAMETER
(
a
);

279 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "ARP: sha:%pM, spa:%d.%d.%d.%d,ha:%pM,pa:%d.%d.%d.%d\n",

280 
sha
, 
¥a
[0], spa[1], spa[2], spa[3],

281 
tha
, 
a
[0],pa[1],pa[2],pa[3]);

282 
¥a
[2] = 
rou‹
->
subÃt
;

283 
a
[2] = 
rou‹
->
subÃt
;

284 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "ARP: sha:%pM, spa:%d.%d.%d.%d,ha:%pM,pa:%d.%d.%d.%d\n",

285 
sha
, 
¥a
[0], spa[1], spa[2], spa[3],

286 
tha
, 
a
[0],pa[1],pa[2],pa[3]);

287  
Œue
;

292 
hdr
 *
h
 = (hd¸*)
äame
;

293 
u8
 *
¤c
 = (u8 *)&
h
->
§ddr
;

294 
u8
 *
d¡
 = (u8 *)&
h
->
daddr
;

296 
	`SLSI_UNUSED_PARAMETER
(
¤c
);

297 
	`SLSI_UNUSED_PARAMETER
(
d¡
);

299 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "PING: src:%d.%d.%d.%d, dst:%d.%d.%d.%d, check:0x%.4X\n",

300 
¤c
[0], src[1], src[2], src[3],

301 
d¡
[0], dst[1], dst[2], dst[3],

302 
h
->
check
);

303 
¤c
[2] = 
rou‹
->
subÃt
;

304 
d¡
[2] = 
rou‹
->
subÃt
;

307 
h
->
check
 = 0;

308 
	`_£nd_check
(
h
);

310 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "PING: src:%d.%d.%d.%d, dst:%d.%d.%d.%d, check:0x%.4X\n",

311 
¤c
[0], src[1], src[2], src[3],

312 
d¡
[0], dst[1], dst[2], dst[3],

313 
h
->
check
);

315  
Œue
;

318 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "PrÙo:0x%.4X\n", 
´Ùo
);

321  
çl£
;

322 
	}
}

324 
¦si_‹¡_d©a_rou‹
 *
	$¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
, cÚ¡ 
u8
 *
mac
)

326 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

327 
i
;

329 ià(
	`WARN_ON
(!
	`¥š_is_locked
(&
uáe¡dev
->
rou‹_¥šlock
)))

330  
NULL
;

332 
i
 = 0; i < 
SLSI_AP_PEER_CONNECTIONS_MAX
; i++) {

333 
rou‹
 = &
uáe¡dev
->rou‹[
i
];

334 ià(
rou‹
->
cÚfigu»d
 && 
	`‘h”_addr_equ®
Ôou‹->
mac
, mac))

335  
rou‹
;

338  
NULL
;

339 
	}
}

341 
¦si_‹¡_d©a_rou‹
 *
	$¦si_‹¡_´oûss_sigÇl_g‘_ä“_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
)

343 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

344 
i
;

346 ià(
	`WARN_ON
(!
	`¥š_is_locked
(&
uáe¡dev
->
rou‹_¥šlock
)))

347  
NULL
;

349 
i
 = 0; i < 
SLSI_AP_PEER_CONNECTIONS_MAX
; i++) {

350 
rou‹
 = &
uáe¡dev
->rou‹[
i
];

351 ià(!
rou‹
->
cÚfigu»d
)

352  
rou‹
;

355  
NULL
;

356 
	}
}

358 
	$¦si_‹¡_´oûss_sigÇl_£t_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
)

360 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

361 
u8
 
mac
[
ETH_ALEN
];

362 
u16
 
de¡_deviû_mšÜ_numb”
 = 0xFFFF;

363 
i
;

365 
mac
[0] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) >> 8;

366 
mac
[1] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) & 0xFF;

367 
mac
[2] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) >> 8;

368 
mac
[3] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) & 0xFF;

369 
mac
[4] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) >> 8;

370 
mac
[5] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) & 0xFF;

372 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

373 
i
 = 0; i < 
SLSI_UDI_MINOR_NODES
; i++) {

374 
¦si_‹¡_dev
 *
de¡dev
 = 
¦si_‹¡_deviûs
[
i
];

376 ià(
de¡dev
 !ğ
NULL
 && 
	`‘h”_addr_equ®
(de¡dev->
hw_addr
, 
mac
))

377 
de¡_deviû_mšÜ_numb”
 = 
de¡dev
->
deviû_mšÜ_numb”
;

379 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

381 ià(
de¡_deviû_mšÜ_numb”
 == 0xFFFF) {

382 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "S‘tšg Rou‹ fÜ %pM FAILED. NØm©ch found\n", 
mac
);

385 
	`¥š_lock
(&
uáe¡dev
->
rou‹_¥šlock
);

386 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
uáe¡dev
, 
mac
);

387 ià(!
rou‹
)

388 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_ä“_rou‹
(
uáe¡dev
);

390 ià(
rou‹
) {

391 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "S‘tšg Rou‹ fÜ %pM -> %pM\n", uáe¡dev->
hw_addr
, 
mac
);

392 
rou‹
->
cÚfigu»d
 = 
Œue
;

393 
rou‹
->
‹¡_deviû_mšÜ_numb”
 = 
de¡_deviû_mšÜ_numb”
;

394 
	`SLSI_ETHER_COPY
(
rou‹
->
mac
, mac);

395 
rou‹
->
vif
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[5]);

396 
rou‹
->
subÃt
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[6]) & 0xFF;

397 
rou‹
->
£qu’û_numb”
 = 1;

399 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "S‘tšg Rou‹ fÜ %pM FAILED. NØF»Rou‹ EÁry\n", 
mac
);

402 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

403 
	}
}

405 
	$¦si_‹¡_´oûss_sigÇl_ş—r_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
)

407 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

408 
u8
 
mac
[
ETH_ALEN
];

410 
mac
[0] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) >> 8;

411 
mac
[1] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) & 0xFF;

412 
mac
[2] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) >> 8;

413 
mac
[3] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) & 0xFF;

414 
mac
[4] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) >> 8;

415 
mac
[5] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) & 0xFF;

417 
	`¥š_lock
(&
uáe¡dev
->
rou‹_¥šlock
);

418 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "CË¬šg Rou‹ fÜ %pM\n", 
mac
);

419 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
uáe¡dev
, 
mac
);

420 ià(
rou‹
)

421 
rou‹
->
cÚfigu»d
 = 
çl£
;

423 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "CË¬šg Rou‹ fÜ %pM FAILED. NØRou‹ EÁry Found\n", 
mac
);

424 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

425 
	}
}

427 
boŞ
 
	$¦si_‹¡_´oûss_sigÇl
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
)

429 ià(
	`çpi_g‘_sigid
(
skb
è=ğ
DEBUG_GENERIC_REQ
) {

430 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "çpi_g‘_u16(skb, u.debug_g’”ic_»q.debug_wÜds[0]èğ%d\n", 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[0]));

431 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "çpi_g‘_u16(skb, u.debug_g’”ic_»q.debug_wÜds[1]èğ%d\n", 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]));

432 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[0]) == 0x1357) {

433 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 0)

434 
	`queue_wÜk
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
, &uáe¡dev->
d‘ach_wÜk
);

435 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 1)

436 
	`queue_wÜk
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
, &uáe¡dev->
©ch_wÜk
);

437 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 2)

438 
	`¦si_‹¡_´oûss_sigÇl_£t_rou‹
(
uáe¡dev
, 
skb
);

439 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 3)

440 
	`¦si_‹¡_´oûss_sigÇl_ş—r_rou‹
(
uáe¡dev
, 
skb
);

442 
	`kä“_skb
(
skb
);

443  
Œue
;

447 ià(
	`çpi_g‘_sigid
(
skb
è=ğ
MA_UNITDATA_REQ
) {

448 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

449 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
skb
->
d©a
;

451 
	`¥š_lock
(&
uáe¡dev
->
rou‹_¥šlock
);

452 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
uáe¡dev
, 
ehdr
->
h_de¡
);

453 ià(
rou‹
 && 
	`¦si_‹¡_´oûss_sigÇl__»m­
(
uáe¡dev
, 
skb
,„oute)) {

454 
¦si_skb_cb
 *
cb
;

455 
çpi_sigÇl
 
»q
 = *((çpi_sigÇÈ*)
skb
->
d©a
);

456 
çpi_sigÇl
 *
šd
;

459 
	`WARN_ON
(!
	`skb_puÎ
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_»q
)));

460 
šd
 = (
çpi_sigÇl
 *)
	`skb_push
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_šd
));

461 ià(
	`WARN_ON
(!
šd
)) {

462 
	`kä“_skb
(
skb
);

463 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

464  
Œue
;

467 
šd
->
id
 = 
	`ıu_to_Ë16
(
MA_UNITDATA_IND
);

468 
šd
->
»ûiv”_pid
 = 0;

469 
šd
->
£nd”_pid
 = 0;

470 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
vif
, 
	`ıu_to_Ë16
(
rou‹
->vif));

471 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
£qu’û_numb”
, 
rou‹
->sequence_number++);

473 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

474 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

475 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

477 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

478 ià(
¦si_‹¡_deviûs
[
rou‹
->
‹¡_deviû_mšÜ_numb”
] &&

479 
¦si_‹¡_deviûs
[
rou‹
->
‹¡_deviû_mšÜ_numb”
]->
sdev
) {

480 ià(
	`¦si_h_rx
(
¦si_‹¡_deviûs
[
rou‹
->
‹¡_deviû_mšÜ_numb”
]->
sdev
, 
skb
) != 0)

481 
	`kä“_skb
(
skb
);

483 
rou‹
->
cÚfigu»d
 = 
çl£
;

484 
	`kä“_skb
(
skb
);

486 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

487 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

488  
Œue
;

490 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

493  
çl£
;

494 
	}
}

496 
	$¦si_‹¡_dev_©ch_wÜk
(
wÜk_¡ruù
 *
wÜk
)

498 
¦si_‹¡_dev
 *
uáe¡dev
 = 
	`cÚš”_of
(
wÜk
, ¦si_‹¡_dev, 
©ch_wÜk
);

500 
	`SLSI_INFO_NODEV
("UnitTest TEST Attach\n");

501 
	`¦si_‹¡_dev_©ch
(
uáe¡dev
);

502 
	`¦si_‹¡_udi_node_»»gi¡”
(
uáe¡dev
);

503 
	}
}

505 
	$¦si_‹¡_dev_d‘ach_wÜk
(
wÜk_¡ruù
 *
wÜk
)

507 
¦si_‹¡_dev
 *
uáe¡dev
 = 
	`cÚš”_of
(
wÜk
, ¦si_‹¡_dev, 
d‘ach_wÜk
);

509 
	`SLSI_INFO
(
uáe¡dev
->
sdev
, "UnitTest TEST Detach\n");

510 
	`¦si_‹¡_dev_d‘ach
(
uáe¡dev
);

511 
	}
}

513 
	$scsc_wifi_uÅau£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

515 
	}
}

517 
	$scsc_wifi_·u£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

519 
	}
}

521 
	$mx140_»que¡_fe
(
scsc_mx
 *
mx
, *
·th
, cÚ¡ 
fœmw¬e
 **
fœmp
)

523  -
EINVAL
;

524 
	}
}

526 
	$mx140_»Ëa£_fe
(
scsc_mx
 *
mx
, cÚ¡ 
fœmw¬e
 *
fœmp
)

528  -
EINVAL
;

529 
	}
}

	@test/hip_test.c

7 
	~<lšux/kth»ad.h
>

9 
	~"un™‹¡.h
"

10 
	~"h.h
"

11 
	~"§p.h
"

12 
	~"debug.h
"

13 
	~"´ocfs.h
"

14 
	~"h4.h
"

16 
	#SLSI_TEST_DEV_SDIO_BLOCK_SIZE
 500

	)

17 
boŞ
 
	gh4_§m¶”_§m¶e_¡¬t_¡İ_q
 = 
Œue
;

18 
h4_h_cÚŒŞ
 
	g‹¡_h_cÚŒŞ
;

21 
	sh_§p
 {

22 
§p_­i
 *
	m§p
[
SAP_TOTAL
];

23 } 
	gh_§p_cÚt
;

26 
	$¦si_h_§p_»gi¡”
(
§p_­i
 *sap_api)

28 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

30 ià(
şass
 >ğ
SAP_TOTAL
)

31  -
ENODEV
;

33 
h_§p_cÚt
.
§p
[
şass
] = 
§p_­i
;

36 
	}
}

39 
	$¦si_h_§p_uÄegi¡”
(
§p_­i
 *sap_api)

41 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

43 ià(
şass
 >ğ
SAP_TOTAL
)

44  -
ENODEV
;

46 
h_§p_cÚt
.
§p
[
şass
] = 
NULL
;

49 
	}
}

51 
	$¦si_h_§p_£tup
(
¦si_dev
 *
sdev
)

54 
u16
 
v”siÚ
 = 0;

56 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
§p_v”siÚ_suµÜ‹d
) {

57 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
);

58 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

59  -
ENODEV
;

61  -
ENODEV
;

64 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
§p_v”siÚ_suµÜ‹d
) {

65 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
);

66 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

67  -
ENODEV
;

69  -
ENODEV
;

72 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
§p_v”siÚ_suµÜ‹d
) {

73 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
);

74 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

75  -
ENODEV
;

77  -
ENODEV
;

80 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
§p_v”siÚ_suµÜ‹d
) {

81 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
);

82 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

83  -
ENODEV
;

85  -
ENODEV
;

90 
	}
}

93 
	$¦si_h_rx
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

95 
u16
 
pid
;

98 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_TO_HOST
);

99 
pid
 = 
	`çpi_g‘_u16
(
skb
, 
»ûiv”_pid
);

100 ià(
pid
 >ğ
SLSI_TX_PROCESS_ID_UDI_MIN
 &&…id <ğ
SLSI_TX_PROCESS_ID_UDI_MAX
) {

101 
	`kä“_skb
(
skb
);

105 ià(
	`çpi_is_ma
(
skb
))

106  
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_hªdËr
(
sdev
, 
skb
);

108 ià(
	`çpi_is_mlme
(
skb
))

109  
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_hªdËr
(
sdev
, 
skb
);

111 ià(
	`çpi_is_debug
(
skb
))

112  
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_hªdËr
(
sdev
, 
skb
);

114 ià(
	`çpi_is_‹¡
(
skb
))

115  
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_hªdËr
(
sdev
, 
skb
);

117  -
EIO
;

118 
	}
}

121 
	$¦si_h_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
dev
)

123 
	`SLSI_UNUSED_PARAMETER
(
dev
);

125 
	`mem£t
(&
sdev
->
h
, 0, (sdev->hip));

127 
sdev
->
h
.sdev = sdev;

128 
	`mu‹x_š™
(&
sdev
->
h
.
h_mu‹x
);

130 
sdev
->
h4_š¡
.
h_cÚŒŞ
 = &
‹¡_h_cÚŒŞ
;

132 
	}
}

134 
	$¦si_h_deš™
(
¦si_dev
 *
sdev
)

136 
	`mu‹x_de¡roy
(&
sdev
->
h
.
h_mu‹x
);

137 
	}
}

139 
	$¦si_h_¡İ
(
¦si_dev
 *
sdev
)

142 
	}
}

144 
	$h4_ä“_ù¾_¦Ùs_couÁ
(
¦si_h4
 *
h
)

146  
HIP4_CTL_SLOTS
;

147 
	}
}

149 
	$scsc_wifi_Œªsm™_äame
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
u8
 
vif_šdex
, u8 
³”_šdex
, u8 
´iÜ™y
)

151 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

153 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_FROM_HOST
);

155 
	`cÚsume_skb
(
skb
);

158 
	}
}

160 
	$¦si_‹¡_bh_wÜk_f
(
wÜk_¡ruù
 *
wÜk
)

162 
	}
}

165 
boŞ
 
	gh4_§m¶”_§m¶e_q
;

166 
boŞ
 
	gh4_§m¶”_§m¶e_q»f
;

167 
boŞ
 
	gh4_§m¶”_§m¶e_št
;

168 
boŞ
 
	gh4_§m¶”_§m¶e_çpi
;

169 
boŞ
 
	gh4_§m¶”_§m¶e_through
;

170 
boŞ
 
	gh4_§m¶”_§m¶e_¡¬t_¡İ_q
;

171 
boŞ
 
	gh4_§m¶”_§m¶e_mbulk
;

172 
boŞ
 
	gh4_§m¶”_§m¶e_qfuÎ
;

173 
boŞ
 
	gh4_§m¶”_§m¶e_mfuÎ
;

174 
boŞ
 
	gh4_§m¶”_vif
;

175 
boŞ
 
	gh4_§m¶”_bÙ
;

176 
boŞ
 
	gh4_§m¶”_pkt_tx
;

178 
	$h4_§m¶”_upd©e_»cÜd
(
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
)

180 
	}
}

182 
	$h4_§m¶”_ü—‹
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

184 
	}
}

186 
	$h4_§m¶”_de¡roy
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

188 
	}
}

190 
	$h4_§m¶”_»gi¡”_h
(
scsc_mx
 *
mx
)

193 
	}
}

195 
	$scsc_wifi_fcq_ù¾_q_š™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

198 
	}
}

200 
	$scsc_wifi_fcq_ù¾_q_deš™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

202 
	}
}

204 
	$scsc_wifi_fcq_uniÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
¦si_dev
 *
sdev
, u8 
vif
, 
¦si_³”
 *
³”
)

207 
	}
}

209 
	$scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
)

212 
	}
}

214 
	$scsc_wifi_fcq_q£t_deš™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, 
¦si_³”
 *
³”
)

216 
	}
}

218 
	$scsc_wifi_fcq_Œªsm™_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

221 
	}
}

223 
	$scsc_wifi_fcq_»ûive_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

226 
	}
}

228 
	$scsc_wifi_fcq_»ûive_d©a_no_³”
(
Ãt_deviû
 *
dev
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

231 
	}
}

233 
	$scsc_wifi_fcq_·u£_queues
(
¦si_dev
 *
sdev
)

235 
	}
}

237 
	$scsc_wifi_fcq_uÅau£_queues
(
¦si_dev
 *
sdev
)

239 
	}
}

241 
	$scsc_wifi_fcq_Œªsm™_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

244 
	}
}

246 
	$scsc_wifi_fcq_»ûive_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

249 
	}
}

251 
	$scsc_wifi_fcq_upd©e_smod
(
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_ps_¡©e
 
³”_ps_¡©e
,

252 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
)

255 
	}
}

257 
	$scsc_wifi_fcq_8021x_pÜt_¡©e
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_8021x_¡©e
 
¡©e
)

260 
	}
}

262 
	$scsc_wifi_fcq_¡©_queue
(
scsc_wifi_fcq_q_h—d”
 *
queue
,

263 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

264 *
qmod
, *
qcod
)

267 
	}
}

269 
	$scsc_wifi_fcq_¡©_queue£t
(
scsc_wifi_fcq_d©a_q£t
 *
queue_£t
,

270 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

271 *
smod
, *
scod
, 
scsc_wifi_fcq_8021x_¡©e
 *
ı_¡©e
,

272 
u32
 *
³”_ps_¡©e_Œªs™iÚs
)

275 
	}
}

276 
	$¦si_h_»´oûss_sk³d_d©a_bh
(
¦si_dev
 *
sdev
)

279 
	}
}

	@test/hydra_test.c

7 
	~"dev.h
"

8 
	~"un™‹¡.h
"

9 
	~"debug.h
"

10 
	~"h_bh.h
"

12 
	$¦si_sm_£rviû_driv”_»gi¡”
()

14 
c¤_»suÉ
;

16 
c¤_»suÉ
 = 
	`¦si_sdio_func_drv_»gi¡”
();

17 ià(
c¤_»suÉ
 != 0) {

18 
	`SLSI_ERR_NODEV
("FaedØ»gi¡”h´‘’d SDIO funùiÚ driv”: c¤ResuÉ=%d\n", 
c¤_»suÉ
);

19  -
EIO
;

23 
	}
}

25 
	$¦si_sm_£rviû_driv”_uÄegi¡”
()

27 
	`¦si_sdio_func_drv_uÄegi¡”
();

28 
	}
}

30 
	$¦si_sm_£rviû_çed
(
¦si_dev
 *
sdev
, cÚ¡ *
»asÚ
)

32 
	}
}

34 
boŞ
 
	$¦si_is_‹¡_mode_’abËd
()

36  
çl£
;

37 
	}
}

39 
boŞ
 
	$¦si_is_rf_‹¡_mode_’abËd
()

41  
çl£
;

42 
	}
}

44 
	$¦si_check_rf_‹¡_mode
(
¦si_dev
 *
sdev
)

47 
	}
}

49 
	$¦si_sm_wÏn_£rviû_¡¬t
(
¦si_dev
 *
sdev
)

52 
	}
}

54 
	$¦si_sm_wÏn_£rviû_¡İ
(
¦si_dev
 *
sdev
)

57 
	}
}

59 
	$¦si_sm_wÏn_£rviû_İ’
(
¦si_dev
 *
sdev
)

62 
	}
}

64 
	$mx140_fe_»que¡_cÚf
(
scsc_mx
 *
mx
, cÚ¡ 
fœmw¬e
 **
cÚf
, cÚ¡ *
cÚfig_»l_·th
, cÚ¡ *
f’ame
)

67 
	}
}

69 
	$mx140_fe_»Ëa£_cÚf
(
scsc_mx
 *
mx
, cÚ¡ 
fœmw¬e
 *
cÚf
)

71 
	}
}

73 
	$¦si_sm_wÏn_£rviû_şo£
(
¦si_dev
 *
sdev
)

75 
	}
}

76 
	$¦si_sm_»cov”y_£rviû_¡İ
(
¦si_dev
 *
sdev
)

79 
	}
}

80 
	$¦si_sm_»cov”y_£rviû_şo£
(
¦si_dev
 *
sdev
)

83 
	}
}

	@test/udi_test.c

7 
	~<lšux/sysfs.h
>

8 
	~<lšux/pŞl.h
>

9 
	~<lšux/cdev.h
>

11 
	~"dev.h
"

13 
	~"h.h
"

14 
	~"log_ş›Ás.h
"

15 
	~"debug.h
"

16 
	~"un™‹¡.h
"

17 
	~"udi.h
"

19 
	~"unifiio.h
"

21 
	#UDI_CHAR_DEVICE_NAME
 "s5e7570un™‹¡h"

	)

22 
	#UDI_CLASS_NAME
 "s5e7570un™‹¡h"

	)

28 
	#NUM_CHAR_CLIENTS
 1

	)

30 
	#MAX_MINOR
 (
SLSI_UDI_MINOR_NODES
 - 1è

	)

31 
dev_t
 
	gmajÜ_numb”
;

32 
şass
 *
	gşass
;

34 
	g¦si_‹¡_cdev_ş›Á
;

36 
	s¦si_cdev
 {

37 
	mmšÜ
;

38 
cdev
 
	mcdev
;

39 
¦si_‹¡_cdev_ş›Á
 *
	mş›Á
[
NUM_CHAR_CLIENTS
];

41 
¦si_‹¡_dev
 *
	muáe¡dev
;

42 
deviû
 *
	m·»Á
;

45 
	s¦si_‹¡_cdev_ş›Á
 {

46 
¦si_cdev
 *
	mufcdev
;

47 
	mlog_’abËd
;

50 
u16
 
	mma_·ck‘_f‹r_cÚfig
;

52 
sk_buff_h—d
 
	mlog_li¡
;

53 
wa™_queue_h—d_t
 
	mlog_wq
;

60 
¦si_cdev
 *
	guf_cdevs
[
SLSI_UDI_MINOR_NODES
];

62 
udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

63 
£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

64 
£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

66 
	$¦si_‹¡_cdev_İ’
(
šode
 *šode, 
fe
 *file)

68 
¦si_cdev
 *
uf_cdev
;

69 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
;

70 
šdx
;

71 
mšÜ
;

73 
mšÜ
 = 
	`imšÜ
(
šode
);

74 ià(
mšÜ
 > 
MAX_MINOR
) {

75 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

76  -
EINVAL
;

79 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

80 ià(!
uf_cdev
) {

81 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

82  -
EINVAL
;

85 ià(!
uf_cdev
->
uáe¡dev
) {

86 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

87  -
EINVAL
;

90 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

91 ià(
uf_cdev
->
ş›Á
[
šdx
] =ğ
NULL
)

93 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

94 
	`SLSI_ERR_NODEV
("already opened\n");

95  -
ENOTSUPP
;

98 
ş›Á
 = 
	`km®loc
((*ş›Á), 
GFP_KERNEL
);

99 ià(
ş›Á
 =ğ
NULL
)

100  -
ENOMEM
;

101 
	`mem£t
(
ş›Á
, 0, (
¦si_‹¡_cdev_ş›Á
));

104 
	`skb_queue_h—d_š™
(&
ş›Á
->
log_li¡
);

105 
	`š™_wa™queue_h—d
(&
ş›Á
->
log_wq
);

107 
ş›Á
->
ufcdev
 = 
uf_cdev
;

108 
uf_cdev
->
ş›Á
[
šdx
] = client;

109 
fe
->
´iv©e_d©a
 = 
ş›Á
;

111 
	`¦si_‹¡_dev_©ch
(
ş›Á
->
ufcdev
->
uáe¡dev
);

114 
	}
}

116 
	$¦si_‹¡_cdev_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

118 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

119 
¦si_cdev
 *
uf_cdev
;

120 
šdx
;

121 
mšÜ
;

123 
mšÜ
 = 
	`imšÜ
(
šode
);

124 ià(
mšÜ
 > 
MAX_MINOR
) {

125 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

126  -
EINVAL
;

129 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

130 ià(!
uf_cdev
) {

131 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

132  -
EINVAL
;

135 ià(
ş›Á
 =ğ
NULL
)

136  -
EINVAL
;

138 ià(!
ş›Á
->
ufcdev
) {

139 
	`SLSI_ERR_NODEV
("ufcdev‚ot set\n");

140  -
EINVAL
;

143 ià(!
ş›Á
->
ufcdev
->
uáe¡dev
) {

144 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

145  -
EINVAL
;

148 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

149 ià(
uf_cdev
->
ş›Á
[
šdx
] == client)

151 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

152 
	`SLSI_ERR_NODEV
("client‚ot found in†ist\n");

153  -
EINVAL
;

156 ià(
	`wa™queue_aùive
(&
ş›Á
->
log_wq
))

157 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

159 ià(
ş›Á
->
log_’abËd
 && cl›Á->
ufcdev
->
uáe¡dev
->
sdev
)

160 
	`¦si_log_ş›Á_uÄegi¡”
(
ş›Á
->
ufcdev
->
uáe¡dev
->
sdev
, client);

162 
	`¦si_‹¡_dev_d‘ach
(
ş›Á
->
ufcdev
->
uáe¡dev
);

164 
	`skb_queue_purge
(&
ş›Á
->
log_li¡
);

167 
	`kä“
(
ş›Á
);

169 
uf_cdev
->
ş›Á
[
šdx
] = 
NULL
;

172 
	}
}

174 
ssize_t
 
	$¦si_‹¡_cdev_»ad
(
fe
 *
fp
, *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

176 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

177 
msgËn
;

178 
sk_buff
 *
skb
;

180 
	`SLSI_UNUSED_PARAMETER
(
poff
);

182 ià(
ş›Á
 =ğ
NULL
)

183  -
EINVAL
;

185 ià(!
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
)) {

186 ià(
fp
->
f_æags
 & 
O_NONBLOCK
)

190 ià(
	`wa™_ev’t_š‹¼u±ibË
(
ş›Á
->
log_wq
, 
	`skb_queue_Ën
(&ş›Á->
log_li¡
)))

191  -
ERESTARTSYS
;

194 
skb
 = 
	`skb_dequeue
(&
ş›Á
->
log_li¡
);

196 
msgËn
 = 
skb
->
Ën
;

197 ià(
msgËn
 > (
s32
)
Ën
) {

198 
	`SLSI_WARN_NODEV
("Œunÿ‹d„—dØ%d‡ùu® msg†’ i %lu\n", 
msgËn
, ()
Ën
);

199 
msgËn
 = 
Ën
;

202 
	`SLSI_DBG_HEX_NODEV
(
SLSI_TEST
, 
skb
->
d©a
, skb->
Ën
, "cdev„ead skb:%p skb->data:%p\n", skb, skb->data);

203 ià(
	`cİy_to_u£r
(
p
, 
skb
->
d©a
, 
msgËn
)) {

204 
	`SLSI_ERR_NODEV
("Failedo copy UDI†ogo user\n");

205 
	`kä“_skb
(
skb
);

206  -
EFAULT
;

209 
	`kä“_skb
(
skb
);

210  
msgËn
;

211 
	}
}

213 
ssize_t
 
	$¦si_‹¡_cdev_wr™e
(
fe
 *
fp
, cÚ¡ *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

215 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
;

216 
¦si_‹¡_dev
 *
uáe¡dev
;

217 
sk_buff
 *
skb
;

218 
¦si_skb_cb
 *
cb
;

219 
u8
 *
d©a
;

221 
	`SLSI_UNUSED_PARAMETER
(
poff
);

223 
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

224 ià(
ş›Á
 =ğ
NULL
) {

225 
	`SLSI_ERR_NODEV
("filep…rivate data‚ot set\n");

226  -
EINVAL
;

229 ià(!
ş›Á
->
ufcdev
) {

230 
	`SLSI_ERR_NODEV
("ufcdev‚ot set\n");

231  -
EINVAL
;

234 
uáe¡dev
 = 
ş›Á
->
ufcdev
->uftestdev;

235 ià(!
uáe¡dev
) {

236 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

237  -
EINVAL
;

240 
skb
 = 
	`®loc_skb
(
Ën
, 
GFP_KERNEL
);

241 ià(!
skb
) {

242 
	`SLSI_WARN_NODEV
("”rÜ‡Îoÿtšg skb (Ën: %d)\n", 
Ën
);

243  -
ENOMEM
;

246 
d©a
 = 
	`skb_put
(
skb
, 
Ën
);

247 ià(
	`cİy_äom_u£r
(
d©a
, 
p
, 
Ën
)) {

248 
	`SLSI_ERR_NODEV
("copy from user failed\n");

249 
	`kä“_skb
(
skb
);

250  -
EFAULT
;

253 ià(
skb
->
Ën
 < (
çpi_sigÇl_h—d”
)) {

254 
	`SLSI_ERR_NODEV
("D©a(%dètoØshÜˆfÜ‡ sigÇl\n", 
skb
->
Ën
);

255 
	`kä“_skb
(
skb
);

256  -
EINVAL
;

259 
	`SLSI_DBG_HEX_NODEV
(
SLSI_TEST
, 
skb
->
d©a
, skb->
Ën
, "cdev write skb:%p skb->data:%p\n", skb, skb->data);

262 ià(
	`¦si_‹¡_´oûss_sigÇl
(
uáe¡dev
, 
skb
))

263  
Ën
;

266 
¦si_dev
 *
sdev
;

268 
sdev
 = 
uáe¡dev
->sdev;

269 ià(!
sdev
) {

270 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

271 
	`kä“_skb
(
skb
);

272  -
EINVAL
;

275 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

276 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

277 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

279 ià(
	`WARN_ON
(
	`¦si_h_rx
(
sdev
, 
skb
))) {

280 
	`kä“_skb
(
skb
);

281  -
EINVAL
;

284  
Ën
;

285 
	}
}

287 
	$¦si_‹¡_cdev_ioùl
(
fe
 *
fp
, 
cmd
, 
¬g
)

289 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

290 
¦si_‹¡_dev
 *
uáe¡dev
;

291 
¦si_dev
 *
sdev
;

292 
r
 = 0;

293 
št_·¿m
;

295 ià(
ş›Á
 =ğ
NULL
 || cl›Á->
ufcdev
 == NULL)

296  -
EINVAL
;

298 
uáe¡dev
 = 
ş›Á
->
ufcdev
->uftestdev;

299 ià(!
uáe¡dev
) {

300 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

301  -
EINVAL
;

304 
sdev
 = 
uáe¡dev
->sdev;

305 ià(!
sdev
) {

306 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

307  -
EINVAL
;

310 
	`FUNC_ENTER_NODEV
();

312 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

314 
cmd
) {

315 
UNIFI_GET_UDI_ENABLE
:

316 
št_·¿m
 = 
ş›Á
->
log_’abËd
;

317 
	`put_u£r
(
št_·¿m
, (*)
¬g
);

320 
UNIFI_SET_UDI_ENABLE
:

321 ià(
	`g‘_u£r
(
št_·¿m
, (*)
¬g
)) {

322 
r
 = -
EFAULT
;

326 ià(
št_·¿m
) {

327 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
, 
udi_log_ev’t
, 
NULL
, 0, 0);

328 
ş›Á
->
log_’abËd
 = 1;

330 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

331 
ş›Á
->
log_’abËd
 = 0;

335 
UNIFI_SET_UDI_LOG_MASK
:

337 
unifiio_f‹r_t
 
f‹r
;

338 
i
;

341 ià(
	`cİy_äom_u£r
(&
f‹r
, (*)
¬g
, (filter))) {

342 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK: Failedo copy from userspace\n");

343 
r
 = -
EFAULT
;

346 ià(
f‹r
.
sigÇl_ids_n
) {

347 *
sigÇl_f‹r_šdex
;

348 
max
;

349 
mš
;

350 
size
 = 
f‹r
.
sigÇl_ids_n
 * (f‹r.
sigÇl_ids
[0]);

351 
u16
 *
sigÇl_ids
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

353 ià(!
sigÇl_ids
) {

354 
r
 = -
ENOMEM
;

358 
max
 = 
sigÇl_ids
[0];

359 
mš
 = 
sigÇl_ids
[0];

361 ià(
	`cİy_äom_u£r
(
sigÇl_ids
, 
f‹r
.sigÇl_ids, 
size
)) {

362 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK: Failedo copy filter from userspace\n");

363 
	`kä“
(
sigÇl_ids
);

364 
r
 = -
EFAULT
;

368 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

369 ià(
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
) {

370 
ş›Á
->
ma_·ck‘_f‹r_cÚfig
 |ğ
sigÇl_ids
[
i
];

373 ià(
sigÇl_ids
[
i
] > 
max
)

374 
max
 = 
sigÇl_ids
[
i
];

375 ià(
sigÇl_ids
[
i
] < 
mš
)

376 
mš
 = 
sigÇl_ids
[
i
];

379 
sigÇl_f‹r_šdex
 = 
	`km®loc
(
max
 - 
mš
 + 1, 
GFP_KERNEL
);

380 ià(
sigÇl_f‹r_šdex
) {

381 
	`mem£t
(
sigÇl_f‹r_šdex
, 0, 
max
 - 
mš
 + 1);

382 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

383 ià(
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
)

385 
sigÇl_f‹r_šdex
[
sigÇl_ids
[
i
] - 
mš
] = 1;

387 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

388 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
,

389 
f‹r
.
log_li¡ed_æag
 ? 
£nd_sigÇl_to_šv”£_log_f‹r
 :

390 
£nd_sigÇl_to_log_f‹r
, 
sigÇl_f‹r_šdex
, 
mš
, 
max
);

392 
r
 = -
ENOMEM
;

394 
	`kä“
(
sigÇl_ids
);

399 
	`SLSI_WARN
(
sdev
, "O³¿tiÚ (%dènÙ suµÜ‹d\n", 
cmd
);

400 
r
 = -
EINVAL
;

403 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

404  
r
;

405 
	}
}

407 
	$¦si_‹¡_cdev_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

409 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

410 
mask
 = 0;

411 
»ady
;

413 
»ady
 = 
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
);

414 
	`pŞl_wa™
(
fp
, &
ş›Á
->
log_wq
, 
wa™
);

415 ià(
»ady
)

416 
mask
 |ğ
POLLIN
 | 
POLLRDNORM
;

418  
mask
;

419 
	}
}

425 
	$£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

427 
»t
 = 0;

428 
u16
 
sigÇl_id
 = 
	`çpi_g‘_u16
(
skb
, 
id
);

430 ià(
sigÇl_id
 > 
log_ş›Á
->
max_sigÇl_id
 || sigÇl_id <†og_ş›Á->
mš_sigÇl_id
 || !log_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

431 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

433  
»t
;

434 
	}
}

436 
	$£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

438 
»t
 = 0;

439 
u16
 
sigÇl_id
 = 
	`çpi_g‘_u16
(
skb
, 
id
);

441 ià(
sigÇl_id
 <ğ
log_ş›Á
->
max_sigÇl_id
 && sigÇl_id >ğlog_ş›Á->
mš_sigÇl_id
 &&†og_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

442 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

443  
»t
;

444 
	}
}

446 
	$udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

448 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = 
log_ş›Á
->
log_ş›Á_ùx
;

449 
udi_msg_t
 
msg
;

450 
udi_msg_t
 *
msg_skb
;

452 ià(
	`WARN_ON
(
ş›Á
 =ğ
NULL
))

453  -
EINVAL
;

454 ià(
	`WARN_ON
(
skb
 =ğ
NULL
))

455  -
EINVAL
;

456 ià(
	`WARN_ON
(
skb
->
Ën
 == 0))

457  -
EINVAL
;

459 
skb
 = 
	`skb_cİy_ex·nd
(skb, (
msg
), 0, 
GFP_ATOMIC
);

460 ià(
	`WARN_ON
(!
skb
))

461  -
ENOMEM
;

464 ià(
	`¦si_‹¡_´oûss_sigÇl
(
ş›Á
->
ufcdev
->
uáe¡dev
, 
skb
))

465  -
ECANCELED
;

467 ià(
	`WARN_ON
(
	`skb_h—droom
(
skb
è< (
msg
)))

468  -
ENOMEM
;

470 
msg
.
Ëngth
 = (msgè+ 
skb
->
Ën
;

471 
msg
.
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

472 
msg
.
dœeùiÚ
 = 
dœ
;

473 
msg
.
sigÇl_Ëngth
 = 
	`çpi_g‘_sigËn
(
skb
);

475 
msg_skb
 = (
udi_msg_t
 *)
	`skb_push
(
skb
, (
msg
));

476 *
msg_skb
 = 
msg
;

478 
	`skb_queue_
(&
ş›Á
->
log_li¡
, 
skb
);

481 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

484 
	}
}

486 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

487 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

489 cÚ¡ 
fe_İ”©iÚs
 
	g¦si_‹¡_cdev_fİs
 = {

490 .
owÃr
 = 
THIS_MODULE
,

491 .
	gİ’
 = 
¦si_‹¡_cdev_İ’
,

492 .
	g»Ëa£
 = 
¦si_‹¡_cdev_»Ëa£
,

493 .
	g»ad
 = 
¦si_‹¡_cdev_»ad
,

494 .
	gwr™e
 = 
¦si_‹¡_cdev_wr™e
,

495 .
	guÆocked_ioùl
 = 
¦si_‹¡_cdev_ioùl
,

496 .
	gcom·t_ioùl
 = 
¦si_‹¡_cdev_ioùl
,

497 .
	gpŞl
 = 
¦si_‹¡_cdev_pŞl
,

500 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

501 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

503 
	$¦si_g‘_mšÜ
()

505 
mšÜ
;

507 
mšÜ
 = 0; mšÜ < 
SLSI_UDI_MINOR_NODES
; minor++)

508 ià(
uf_cdevs
[
mšÜ
] == 0)

509  
mšÜ
;

511 
	}
}

513 
	$¦si_‹¡_cdev_ü—‹
(
¦si_‹¡_dev
 *
uáe¡dev
, 
deviû
 *
·»Á
)

515 
dev_t
 
devno
;

516 
»t
;

517 
¦si_cdev
 *
pdev
;

518 
mšÜ
;

520 
	`FUNC_ENTER_NODEV
();

521 
mšÜ
 = 
	`¦si_g‘_mšÜ
();

522 ià(
mšÜ
 < 0) {

523 
	`SLSI_ERR_NODEV
("no minor‚umbers‡vailable\n");

524  -
ENOMEM
;

527 
pdev
 = 
	`km®loc
((*pdev), 
GFP_KERNEL
);

528 ià(
pdev
 =ğ
NULL
)

529  -
ENOMEM
;

530 
	`mem£t
(
pdev
, 0, (*pdev));

532 
	`cdev_š™
(&
pdev
->
cdev
, &
¦si_‹¡_cdev_fİs
);

533 
pdev
->
cdev
.
owÃr
 = 
THIS_MODULE
;

534 
pdev
->
mšÜ
 = minor;

535 
devno
 = 
	`MKDEV
(
	`MAJOR
(
majÜ_numb”
), 
mšÜ
);

536 
»t
 = 
	`cdev_add
(&
pdev
->
cdev
, 
devno
, 1);

537 ià(
»t
) {

538 
	`SLSI_ERR_NODEV
("cdev_add faed w™h %d fÜ mšÜ %d\n", 
»t
, 
mšÜ
);

539 
	`kä“
(
pdev
);

540  
»t
;

543 
pdev
->
uáe¡dev
 = uftestdev;

544 
pdev
->
·»Á
 =…arent;

545 ià(!
	`UF_DEVICE_CREATE
(
şass
, 
pdev
->
·»Á
, 
devno
,…dev, 
UDI_CHAR_DEVICE_NAME
 "%d", 
mšÜ
)) {

546 
	`cdev_d–
(&
pdev
->
cdev
);

547 
	`kä“
(
pdev
);

548  -
EINVAL
;

550 
uáe¡dev
->
uf_cdev
 = (*)
pdev
;

551 
uáe¡dev
->
deviû_mšÜ_numb”
 = 
mšÜ
;

552 
uf_cdevs
[
mšÜ
] = 
pdev
;

554 
	}
}

556 
	$¦si_‹¡_cdev_de¡roy
(
¦si_‹¡_dev
 *
uáe¡dev
)

558 
¦si_cdev
 *
pdev
 = (¦si_cdev *)
uáe¡dev
->
uf_cdev
;

560 
	`FUNC_ENTER_NODEV
();

561 ià(!
pdev
)

563 
	`deviû_de¡roy
(
şass
, 
pdev
->
cdev
.
dev
);

564 
	`cdev_d–
(&
pdev
->
cdev
);

565 
uáe¡dev
->
uf_cdev
 = 0;

566 
uf_cdevs
[
pdev
->
mšÜ
] = 0;

567 
	`kä“
(
pdev
);

568 
	}
}

570 
	gudi_š™Ÿli£d
;

572 
	$¦si_‹¡_udi_š™
()

574 
»t
;

576 
	`mem£t
(
uf_cdevs
, 0, (uf_cdevs));

579 
»t
 = 
	`®loc_chrdev_»giÚ
(&
majÜ_numb”
, 0, 
SLSI_UDI_MINOR_NODES
, 
UDI_CLASS_NAME
);

580 ià(
»t
) {

581 
	`SLSI_ERR_NODEV
("FaedØadd‡Îoødev‚umb”s: %d\n", 
»t
);

582  
»t
;

586 
şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
UDI_CLASS_NAME
);

587 ià(
	`IS_ERR
(
şass
)) {

588 
	`SLSI_ERR_NODEV
("Failedo create UniFi class\n");

589 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

590 
majÜ_numb”
 = 0;

591  -
EINVAL
;

594 
udi_š™Ÿli£d
 = 1;

597 
	}
}

599 
	$¦si_‹¡_udi_deš™
()

601 ià(!
udi_š™Ÿli£d
)

603 
	`şass_de¡roy
(
şass
);

604 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

605 
udi_š™Ÿli£d
 = 0;

607 
	}
}

609 
	$¦si_‹¡_udi_node_š™
(
¦si_‹¡_dev
 *
uáe¡dev
, 
deviû
 *
·»Á
)

611 
	`FUNC_ENTER_NODEV
();

612 ià(!
udi_š™Ÿli£d
)

614  
	`¦si_‹¡_cdev_ü—‹
(
uáe¡dev
, 
·»Á
);

615 
	}
}

617 
	$¦si_‹¡_udi_node_»»gi¡”
(
¦si_‹¡_dev
 *
uáe¡dev
)

619 
¦si_cdev
 *
pdev
 = 
uáe¡dev
->
uf_cdev
;

620 
šdx
;

622 ià(
uáe¡dev
->
sdev
)

623 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

624 ià(
pdev
->
ş›Á
[
šdx
] !ğ
NULL
 &&…dev->ş›Á[šdx]->
log_’abËd
)

625 
	`¦si_log_ş›Á_»gi¡”
(
uáe¡dev
->
sdev
, 
pdev
->
ş›Á
[
šdx
], 
udi_log_ev’t
, 
NULL
, 0, 0);

628 
	}
}

630 
	$¦si_‹¡_udi_node_deš™
(
¦si_‹¡_dev
 *
uáe¡dev
)

632 
	`FUNC_ENTER_NODEV
();

633 ià(!
udi_š™Ÿli£d
)

635 
	`¦si_‹¡_cdev_de¡roy
(
uáe¡dev
);

637 
	}
}

	@test/unittest.h

7 #iâdeà
__SLSI_UNITTEST_H__


8 
	#__SLSI_UNITTEST_H__


	)

10 
	~"dev.h
"

12 
	g¦si_‹¡_dev
;

13 
	s¦si_‹¡_bh_wÜk
 {

14 
boŞ
 
	mavaabË
;

15 
¦si_‹¡_dev
 *
	muáe¡dev
;

16 
wÜkqueue_¡ruù
 *
	mwÜkqueue
;

17 
wÜk_¡ruù
 
	mwÜk
;

18 
¦si_¥šlock
 
	m¥šlock
;

21 
	s¦si_‹¡_d©a_rou‹
 {

22 
boŞ
 
	mcÚfigu»d
;

23 
u16
 
	m‹¡_deviû_mšÜ_numb”
;

24 
u8
 
	mmac
[
ETH_ALEN
];

25 
u16
 
	mvif
;

26 
u8
 
	msubÃt
;

27 
u16
 
	m£qu’û_numb”
;

30 
	s¦si_‹¡_dev
 {

36 
	mdeviû_mšÜ_numb”
;

38 *
	muf_cdev
;

39 
deviû
 *
	mdev
;

40 
¦si_dev
 *
	msdev
;

42 
wÜkqueue_¡ruù
 *
	m©ch_d‘ach_wÜk_queue
;

44 
mu‹x
 
	m©ch_d‘ach_mu‹x
;

45 
wÜk_¡ruù
 
	m©ch_wÜk
;

46 
wÜk_¡ruù
 
	md‘ach_wÜk
;

47 
boŞ
 
	m©ched
;

49 
u8
 
	mhw_addr
[
ETH_ALEN
];

50 
¦si_‹¡_bh_wÜk
 
	mbh_wÜk
;

53 
¥šlock_t
 
	mrou‹_¥šlock
;

54 
¦si_‹¡_d©a_rou‹
 
	mrou‹
[
SLSI_AP_PEER_CONNECTIONS_MAX
];

57 
¦si_‹¡_dev_©ch
(
¦si_‹¡_dev
 *
uáe¡dev
);

58 
¦si_‹¡_dev_d‘ach
(
¦si_‹¡_dev
 *
uáe¡dev
);

59 
boŞ
 
¦si_‹¡_´oûss_sigÇl
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
);

61 
¦si_‹¡_udi_node_š™
(
¦si_‹¡_dev
 *
uáe¡dev
, 
deviû
 *
·»Á
);

62 
¦si_‹¡_udi_node_»»gi¡”
(
¦si_‹¡_dev
 *
uáe¡dev
);

63 
¦si_‹¡_udi_node_deš™
(
¦si_‹¡_dev
 *
uáe¡dev
);

65 
¦si_‹¡_udi_š™
();

66 
¦si_‹¡_udi_deš™
();

68 
¦si_‹¡_bh_wÜk_f
(
wÜk_¡ruù
 *
wÜk
);

69 
šlše
 
	$¦si_‹¡_bh_š™
(
¦si_‹¡_dev
 *
uáe¡dev
)

71 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
çl£
;

72 
uáe¡dev
->
bh_wÜk
.uftestdev = uftestdev;

73 
	`¦si_¥šlock_ü—‹
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

74 
	`INIT_WORK
(&
uáe¡dev
->
bh_wÜk
.
wÜk
, 
¦si_‹¡_bh_wÜk_f
);

75 
uáe¡dev
->
bh_wÜk
.
wÜkqueue
 = 
	`®loc_Üd”ed_wÜkqueue
("slsi_wlan_unittest_bh", 0);

76 ià(!
uáe¡dev
->
bh_wÜk
.
wÜkqueue
)

77  -
ENOMEM
;

78 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
Œue
;

80 
	}
}

82 
šlše
 
	$¦si_‹¡_bh_¡¬t
(
¦si_‹¡_dev
 *
uáe¡dev
)

84 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

85 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
Œue
;

86 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

87 
	}
}

89 
šlše
 
	$¦si_‹¡_bh_run
(
¦si_‹¡_dev
 *
uáe¡dev
)

91 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

92 ià(!
uáe¡dev
->
bh_wÜk
.
avaabË
)

93 
ex™
;

94 
	`queue_wÜk
(
uáe¡dev
->
bh_wÜk
.
wÜkqueue
, &uáe¡dev->bh_wÜk.
wÜk
);

95 
ex™
:

96 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

97 
	}
}

99 
šlše
 
	$¦si_‹¡_bh_¡İ
(
¦si_‹¡_dev
 *
uáe¡dev
)

101 
wÜkqueue_¡ruù
 *
wÜkqueue
 = 
NULL
;

103 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

104 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
çl£
;

105 
wÜkqueue
 = 
uáe¡dev
->
bh_wÜk
.workqueue;

106 
uáe¡dev
->
bh_wÜk
.
wÜkqueue
 = 
NULL
;

107 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

109 ià(
wÜkqueue
)

110 
	`æush_wÜkqueue
(
wÜkqueue
);

111 
	}
}

113 
šlše
 
	$¦si_‹¡_bh_deš™
(
¦si_‹¡_dev
 *
uáe¡dev
)

115 
wÜkqueue_¡ruù
 *
wÜkqueue
 = 
NULL
;

117 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

118 
	`WARN_ON
(
uáe¡dev
->
bh_wÜk
.
avaabË
);

119 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
çl£
;

120 
wÜkqueue
 = 
uáe¡dev
->
bh_wÜk
.workqueue;

121 
uáe¡dev
->
bh_wÜk
.
wÜkqueue
 = 
NULL
;

122 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

123 ià(
wÜkqueue
) {

124 
	`æush_wÜkqueue
(
wÜkqueue
);

125 
	`de¡roy_wÜkqueue
(
wÜkqueue
);

127 
	}
}

	@traffic_monitor.c

6 
	~<lšux/ktime.h
>

7 
	~"dev.h
"

8 
	~"debug.h
"

9 
	~"Œaffic_mÚ™Ü.h
"

11 
	s¦si_Œaffic_mÚ_ş›Á_’Œy
 {

12 
li¡_h—d
 
	mq
;

13 *
	mş›Á_ùx
;

14 
u32
 
	mthroughput
;

15 
u32
 
	m¡©e
;

16 
u32
 
	mhy¡”esis
;

17 
u32
 
	mmode
;

18 
u32
 
	mmid_ut
;

19 
u32
 
	mhigh_ut
;

20 (*
	mŒaffic_mÚ_ş›Á_cb
)(*
	mş›Á_ùx
, 
u32
 
	m¡©e
, u32 
	mut_tx
, u32 
	mut_rx
);

23 
šlše
 
	$Œaffic_mÚ_švoke_ş›Á_ÿÎback
(
¦si_dev
 *
sdev
, 
u32
 
ut_tx
, u32 
ut_rx
, 
boŞ
 
ov”ride
)

25 
li¡_h—d
 *
pos
, *
n
;

26 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_ş›Á
;

28 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
) {

29 
Œaffic_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_Œaffic_mÚ_ş›Á_’Œy
, 
q
);

31 ià(
ov”ride
) {

32 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
;

33 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

34 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
, 
ut_tx
, 
ut_rx
);

35 } ià(
Œaffic_ş›Á
->
mode
 =ğ
TRAFFIC_MON_CLIENT_MODE_PERIODIC
) {

36 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

37 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_LOW
, 
ut_tx
, 
ut_rx
);

38 
Œaffic_ş›Á
->
throughput
 = (
ut_tx
 + 
ut_rx
);

39 } ià(
Œaffic_ş›Á
->
mode
 =ğ
TRAFFIC_MON_CLIENT_MODE_EVENTS
) {

40 ià((
Œaffic_ş›Á
->
high_ut
è&& ((
ut_tx
 + 
ut_rx
) >raffic_client->high_tput)) {

41 ià(
Œaffic_ş›Á
->
¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 &&

42 (
Œaffic_ş›Á
->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_HIGH
)) {

43 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "nÙify¿ffiøev’ˆÑput:%u, s‹:%u --> HIGH)\n", (
ut_tx
 + 
ut_rx
), 
Œaffic_ş›Á
->
¡©e
);

44 
Œaffic_ş›Á
->
hy¡”esis
 = 0;

45 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_HIGH
;

47 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

48 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_HIGH
, 
ut_tx
, 
ut_rx
);

50 } ià((
Œaffic_ş›Á
->
mid_ut
è&& ((
ut_tx
 + 
ut_rx
) >raffic_client->mid_tput)) {

51 ià(
Œaffic_ş›Á
->
¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_MID
) {

52 ià((
Œaffic_ş›Á
->
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_LOW
 && (Œaffic_ş›Á->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_HIGH
)) ||

53 (
Œaffic_ş›Á
->
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 && (Œaffic_ş›Á->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_LOW
))) {

54 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "nÙify¿ffiøev’ˆÑput:%u, s‹:%u --> MID)\n", (
ut_tx
 + 
ut_rx
), 
Œaffic_ş›Á
->
¡©e
);

55 
Œaffic_ş›Á
->
hy¡”esis
 = 0;

56 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_MID
;

57 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

58 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_MID
, 
ut_tx
, 
ut_rx
);

61 } ià(
Œaffic_ş›Á
->
¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_LOW
 &&

62 (
Œaffic_ş›Á
->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_LOW
)) {

63 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "nÙify¿ffiøev’ˆÑput:%u, s‹:%u --> LOW\n", (
ut_tx
 + 
ut_rx
), 
Œaffic_ş›Á
->
¡©e
);

64 
Œaffic_ş›Á
->
hy¡”esis
 = 0;

65 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

66 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

67 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_LOW
, 
ut_tx
, 
ut_rx
);

69 
Œaffic_ş›Á
->
throughput
 = (
ut_tx
 + 
ut_rx
);

72 
	}
}

74 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


75 
	$Œaffic_mÚ_tim”
(
tim”_li¡
 *
t
)

77 
	$Œaffic_mÚ_tim”
(
d©a
)

80 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


81 
¦si_Œaffic_mÚ_ş›Ás
 *
ş›Ás
 = 
	`äom_tim”
(ş›Ás, 
t
, 
tim”
);

82 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Ás
, 
	`ty³of
(*sdev), 
Œaffic_mÚ_ş›Ás
);

84 
¦si_dev
 *
sdev
 = (¦si_dev *)
d©a
;

86 
Ãt_deviû
 *
dev
;

87 
Ãtdev_vif
 *
ndev_vif
;

88 
boŞ
 
¡İ_mÚ™Ü
;

89 
u8
 
i
;

90 
u32
 
ut_rx
 = 0;

91 
u32
 
ut_tx
 = 0;

93 ià(!
sdev
) {

94 
	`SLSI_ERR_NODEV
("invalid sdev\n");

98 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

100 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

101 
dev
 = 
sdev
->
Ãtdev
[
i
];

102 ià(
dev
) {

103 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

105 ià(
ndev_vif
) {

106 
u32
 
time_š_ms
 = 0;

112 
time_š_ms
 = 
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
ndev_vif
->
Ï¡_tim”_time
));

117 
ndev_vif
->
num_by‹s_rx_³r_£c
 +ğndev_vif->
num_by‹s_rx_³r_tim”
;

118 
ndev_vif
->
num_by‹s_tx_³r_£c
 +ğndev_vif->
num_by‹s_tx_³r_tim”
;

119 
ndev_vif
->
»pÜt_time
 +ğ
time_š_ms
;

120 ià(
ndev_vif
->
»pÜt_time
 >= 1000) {

121 
ndev_vif
->
throughput_rx_bps
 = (ndev_vif->
num_by‹s_rx_³r_£c
 * 8 /‚dev_vif->
»pÜt_time
) * 1000;

122 
ndev_vif
->
throughput_tx_bps
 = (ndev_vif->
num_by‹s_tx_³r_£c
 * 8 /‚dev_vif->
»pÜt_time
) * 1000;

123 
ndev_vif
->
num_by‹s_rx_³r_£c
 = 0;

124 
ndev_vif
->
num_by‹s_tx_³r_£c
 = 0;

125 
ndev_vif
->
»pÜt_time
 = 0;

129 
ndev_vif
->
throughput_tx
 = (ndev_vif->
num_by‹s_tx_³r_tim”
 * 8 / 
time_š_ms
) * 1000;

130 
ndev_vif
->
throughput_rx
 = (ndev_vif->
num_by‹s_rx_³r_tim”
 * 8 / 
time_š_ms
) * 1000;

132 
ndev_vif
->
num_by‹s_tx_³r_tim”
 = 0;

133 
ndev_vif
->
num_by‹s_rx_³r_tim”
 = 0;

134 
ndev_vif
->
Ï¡_tim”_time
 = 
	`ktime_g‘
();

135 
ut_tx
 +ğ
ndev_vif
->
throughput_tx
;

136 
ut_rx
 +ğ
ndev_vif
->
throughput_rx
;

141 
	`Œaffic_mÚ_švoke_ş›Á_ÿÎback
(
sdev
, 
ut_tx
, 
ut_rx
, 
çl£
);

142 
¡İ_mÚ™Ü
 = 
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

144 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

145 ià(!
¡İ_mÚ™Ü
)

146 
	`mod_tim”
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
SLSI_TRAFFIC_MON_TIMER_PERIOD
));

147 
	}
}

149 
šlše
 
	$¦si_Œaffic_mÚ_ev’t_rx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

151 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

159 ià(
skb
->
Ën
 >= 40)

160 
ndev_vif
->
num_by‹s_rx_³r_tim”
 +ğ(
skb
->
Ën
 - 40);

162 
ndev_vif
->
num_by‹s_rx_³r_tim”
 +ğ
skb
->
Ën
;

163 
	}
}

165 
šlše
 
	$¦si_Œaffic_mÚ_ev’t_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

167 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

168 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb
);

170 ià((
skb
->
Ën
 - 
cb
->
sig_Ëngth
) >= 40)

171 
ndev_vif
->
num_by‹s_tx_³r_tim”
 +ğ((
skb
->
Ën
 - 40è- 
cb
->
sig_Ëngth
);

173 
ndev_vif
->
num_by‹s_tx_³r_tim”
 +ğ(
skb
->
Ën
 - 
cb
->
sig_Ëngth
);

174 
	}
}

176 
	$¦si_Œaffic_mÚ_ov”ride
(
¦si_dev
 *
sdev
)

178 ià(
	`WARN_ON_ONCE
(
	`š_œq
()))

181 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

182 ià(!
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
)) {

183 
	`Œaffic_mÚ_švoke_ş›Á_ÿÎback
(
sdev
, 0, 0, 
Œue
);

185 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

187 
	}
}

189 
u8
 
	$¦si_Œaffic_mÚ_is_ruÂšg
(
¦si_dev
 *
sdev
)

191 
u8
 
is_ruÂšg
 = 0;

193 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

194 ià(!
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
))

195 
is_ruÂšg
 = 1;

196 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

197  
is_ruÂšg
;

198 
	}
}

200 
	$¦si_Œaffic_mÚ_ş›Á_»gi¡”
(

201 
¦si_dev
 *
sdev
,

202 *
ş›Á_ùx
,

203 
u32
 
mode
,

204 
u32
 
mid_ut
,

205 
u32
 
high_ut
,

206 (*
Œaffic_mÚ_ş›Á_cb
)(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
))

208 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_mÚ_ş›Á
;

209 
boŞ
 
¡¬t_mÚ™Ü
;

210 
Ãt_deviû
 *
dev
;

211 
Ãtdev_vif
 *
ndev_vif
;

212 
u8
 
i
;

214 ià(!
ş›Á_ùx
) {

215 
	`SLSI_ERR
(
sdev
, "A client context must be…rovided\n");

216  -
EINVAL
;

219 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

220 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "ş›Á:%p, mode:%u, mid_ut:%u, high_ut:%u\n", 
ş›Á_ùx
, 
mode
, 
mid_ut
, 
high_ut
);

221 
¡¬t_mÚ™Ü
 = 
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

222 
Œaffic_mÚ_ş›Á
 = 
	`km®loc
((*Œaffic_mÚ_ş›Á), 
GFP_ATOMIC
);

223 ià(!
Œaffic_mÚ_ş›Á
) {

224 
	`SLSI_ERR
(
sdev
, "could‚ot‡llocate memory for Monitor client\n");

225 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

226  -
ENOMEM
;

229 
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
 = client_ctx;

230 
Œaffic_mÚ_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

231 
Œaffic_mÚ_ş›Á
->
hy¡”esis
 = 0;

232 
Œaffic_mÚ_ş›Á
->
mode
 = mode;

233 
Œaffic_mÚ_ş›Á
->
mid_ut
 = mid_tput;

234 
Œaffic_mÚ_ş›Á
->
high_ut
 = high_tput;

235 
Œaffic_mÚ_ş›Á
->
Œaffic_mÚ_ş›Á_cb
 =raffic_mon_client_cb;

238 
	`li¡_add_
(&
Œaffic_mÚ_ş›Á
->
q
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

240 ià(
¡¬t_mÚ™Ü
) {

242 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

243 
dev
 = 
sdev
->
Ãtdev
[
i
];

244 ià(
dev
) {

245 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

247 ià(
ndev_vif
) {

248 
ndev_vif
->
throughput_tx
 = 0;

249 
ndev_vif
->
throughput_rx
 = 0;

250 
ndev_vif
->
num_by‹s_tx_³r_tim”
 = 0;

251 
ndev_vif
->
num_by‹s_rx_³r_tim”
 = 0;

252 
ndev_vif
->
Ï¡_tim”_time
 = 
	`ktime_g‘
();

253 
ndev_vif
->
num_by‹s_rx_³r_£c
 = 0;

254 
ndev_vif
->
num_by‹s_tx_³r_£c
 = 0;

255 
ndev_vif
->
throughput_rx_bps
 = 0;

256 
ndev_vif
->
throughput_tx_bps
 = 0;

257 
ndev_vif
->
»pÜt_time
 = 0;

261 
	`mod_tim”
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
SLSI_TRAFFIC_MON_TIMER_PERIOD
));

264 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

266 
	}
}

268 
	$¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
ş›Á_ùx
)

270 
li¡_h—d
 *
pos
, *
n
;

271 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_mÚ_ş›Á
;

272 
Ãt_deviû
 *
dev
;

273 
Ãtdev_vif
 *
ndev_vif
;

274 
u8
 
i
;

276 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

277 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "ş›Á: %p\n", 
ş›Á_ùx
);

278 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
) {

279 
Œaffic_mÚ_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_Œaffic_mÚ_ş›Á_’Œy
, 
q
);

280 ià(
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
 == client_ctx) {

281 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "d–‘e: %p\n", 
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
);

282 
	`li¡_d–
(
pos
);

283 
	`kä“
(
Œaffic_mÚ_ş›Á
);

287 ià(
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
)) {

289 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

290 
dev
 = 
sdev
->
Ãtdev
[
i
];

291 ià(
dev
) {

292 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

294 ià(
ndev_vif
) {

295 
ndev_vif
->
throughput_tx
 = 0;

296 
ndev_vif
->
throughput_rx
 = 0;

297 
ndev_vif
->
num_by‹s_tx_³r_tim”
 = 0;

298 
ndev_vif
->
num_by‹s_rx_³r_tim”
 = 0;

299 
ndev_vif
->
num_by‹s_rx_³r_£c
 = 0;

300 
ndev_vif
->
num_by‹s_tx_³r_£c
 = 0;

301 
ndev_vif
->
throughput_rx_bps
 = 0;

302 
ndev_vif
->
throughput_tx_bps
 = 0;

303 
ndev_vif
->
»pÜt_time
 = 0;

307 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

308 
	`d–_tim”_sync
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
);

309 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

311 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

312 
	}
}

314 
	$¦si_Œaffic_mÚ_ş›Ás_š™
(
¦si_dev
 *
sdev
)

316 ià(!
sdev
) {

317 
	`SLSI_ERR_NODEV
("invalid sdev\n");

320 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


321 
	`tim”_£tup
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
Œaffic_mÚ_tim”
, 0);

323 
	`£tup_tim”
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
Œaffic_mÚ_tim”
, ()sdev);

325 
	`INIT_LIST_HEAD
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

326 
	`¥š_lock_š™
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

327 
	}
}

329 
	$¦si_Œaffic_mÚ_ş›Ás_deš™
(
¦si_dev
 *
sdev
)

331 
li¡_h—d
 *
pos
, *
n
;

332 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_mÚ_ş›Á
;

334 ià(!
sdev
) {

335 
	`SLSI_ERR_NODEV
("invalid sdev\n");

339 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

340 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
) {

341 
Œaffic_mÚ_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_Œaffic_mÚ_ş›Á_’Œy
, 
q
);

342 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "d–‘e: %p\n", 
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
);

343 
	`li¡_d–
(
pos
);

344 
	`kä“
(
Œaffic_mÚ_ş›Á
);

346 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

347 
	`d–_tim”_sync
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
);

348 
	}
}

	@traffic_monitor.h

7 #iâdeà
__TRAFFIC_MONITOR_H__


8 
	#__TRAFFIC_MONITOR_H__


	)

10 
	#SLSI_TRAFFIC_MON_TIMER_PERIOD
 100

	)

11 
	#SLSI_TRAFFIC_MON_HYSTERESIS_HIGH
 2

	)

12 
	#SLSI_TRAFFIC_MON_HYSTERESIS_LOW
 10

	)

15 
	mTRAFFIC_MON_CLIENT_MODE_NONE
,

16 
	mTRAFFIC_MON_CLIENT_MODE_PERIODIC
,

17 
	mTRAFFIC_MON_CLIENT_MODE_EVENTS


21 
	mTRAFFIC_MON_CLIENT_STATE_LOW
,

22 
	mTRAFFIC_MON_CLIENT_STATE_MID
,

23 
	mTRAFFIC_MON_CLIENT_STATE_HIGH
,

24 
	mTRAFFIC_MON_CLIENT_STATE_OVERRIDE


27 
	s¦si_Œaffic_mÚ_ş›Ás
 {

29 
¥šlock_t
 
	mlock
;

31 
tim”_li¡
 
	mtim”
;

32 
li¡_h—d
 
	mş›Á_li¡
;

35 
¦si_Œaffic_mÚ_ev’t_rx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

36 
¦si_Œaffic_mÚ_ev’t_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

47 
¦si_Œaffic_mÚ_ov”ride
(
¦si_dev
 *
sdev
);

58 
u8
 
¦si_Œaffic_mÚ_is_ruÂšg
(
¦si_dev
 *
sdev
);

75 
¦si_Œaffic_mÚ_ş›Á_»gi¡”
(

76 
¦si_dev
 *
sdev
,

77 *
ş›Á_ùx
,

78 
u32
 
mode
,

79 
u32
 
mid_ut
,

80 
u32
 
high_ut
,

82 (*
Œaffic_mÚ_ş›Á_cb
)(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
));

83 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
ş›Á_ùx
);

85 
	`¦si_Œaffic_mÚ_ş›Ás_š™
(
¦si_dev
 *
sdev
);

86 
	`¦si_Œaffic_mÚ_ş›Ás_deš™
(
¦si_dev
 *
sdev
);

	@tx.c

7 
	~"dev.h
"

8 
	~"debug.h
"

9 
	~"mgt.h
"

10 
	~"mlme.h
"

11 
	~"Ãtif.h
"

12 
	~"log_ş›Ás.h
"

13 
	~"h4_§m¶”.h
"

14 
	~"Œaffic_mÚ™Ü.h
"

15 
	~"scsc_wifogg”_ršg_pktç‹_­i.h
"

16 
	~"log2us.h
"

18 
boŞ
 
	gmsdu_’abË
 = 
Œue
;

19 
moduË_·¿m
(
msdu_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

20 
MODULE_PARM_DESC
(
msdu_’abË
, "MSDU frame format, Y:ƒnable (default), N: disable");

22 #ifdeà
CONFIG_SCSC_WLAN_TX_API


23 
__®ways_šlše
 
boŞ
 
	$is_msdu_’abË
()

25  
msdu_’abË
;

26 
	}
}

29 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


30 
	~"scsc_wifogg”_ršgs.h
"

37 
	~"h4.h
"

39 #ifdeà
CONFIG_SCSC_WLAN_TX_API


40 
	~"tx_­i.h
"

43 
	~<lšux/¥šlock.h
>

46 
	$¦si_g‘_miş’
(
Ãt_deviû
 *
dev
, 
u32
 
akm_su™e
)

48 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

50 
akm_su™e
) {

51 
SLSI_KEY_MGMT_802_1X_SUITE_B_192
:

52 
SLSI_KEY_MGMT_FT_802_1X_SHA384
:

53 
SLSI_KEY_MGMT_802_1X_SUITE_B_192_REV
:

55 
SLSI_KEY_MGMT_OWE
:

56 
SLSI_KEY_MGMT_OWE_REV
:

57 ià(
ndev_vif
->
¡a
.
owe_group_duršg_cÚÃùiÚ
 == 20)

59 ià(
ndev_vif
->
¡a
.
owe_group_duršg_cÚÃùiÚ
 == 21)

66 
	}
}

68 
	$¦si_g‘_dw–l_time_fÜ_wps
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
—pŞ
, 
u16
 
—p_Ëngth
)

76 ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_REQUEST
 ||

77 
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_RESPONSE
) {

78 ià(
—pŞ
[
SLSI_EAP_TYPE_POS
] =ğ
SLSI_EAP_TYPE_EXPANDED
 && 
—p_Ëngth
 >ğ
SLSI_EAP_OPCODE_POS
 - 3 &&

79 ((
—pŞ
[
SLSI_EAP_OPCODE_POS
] =ğ
SLSI_EAP_OPCODE_WSC_MSG
 && 
—p_Ëngth
 >ğ
SLSI_EAP_MSGTYPE_POS
 - 3 &&

80 
—pŞ
[
SLSI_EAP_MSGTYPE_POS
] !ğ
SLSI_EAP_MSGTYPE_M8
) ||

81 
—pŞ
[
SLSI_EAP_OPCODE_POS
] =ğ
SLSI_EAP_OPCODE_WSC_START
))

82  
SLSI_EAP_WPS_DWELL_TIME
;

87 ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
) &&

88 
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_REQUEST
 &&

89 
—pŞ
[
SLSI_EAP_TYPE_POS
] =ğ
SLSI_EAP_TYPE_IDENTITY
)

90  
SLSI_EAP_WPS_DWELL_TIME
;

93 
	}
}

95 #iâdeà
CONFIG_SCSC_WLAN_TX_API


96 
	$¦si_tx_—pŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

98 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

99 
¦si_³”
 *
³”
;

100 
u8
 *
—pŞ
 = 
NULL
;

101 
u16
 
msg_ty³
 = 0;

102 
u16
 
´Ùo
 = 
	`Áohs
(
skb
->
´ÙocŞ
);

103 
»t
 = 0;

104 
u32
 
dw–l_time
 = 
sdev
->
fw_dw–l_time
;

105 
u64
 
tx_by‹s_tmp
 = 0;

106 
u16
 
—p_Ëngth
 = 0;

107 
u16
 
äame_Ën
 = 
skb
->
Ën
 - (
‘hhdr
);

108 
¦si_w·_—pŞ_key
 *
key
 = 
NULL
;

109 
u8
 *
keyd©®’_pos
, *
mic
;

110 
u16
 
keyd©®’
 = 0;

112 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

113 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

114 ià(!
³”
) {

115 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

116 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ EAP f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

117  -
EINVAL
;

120 
´Ùo
) {

121 
ETH_P_PAE
:

133 ià(
äame_Ën
 < 4)

136 
—pŞ
 = 
skb
->
d©a
 + (
‘hhdr
);

137 
key
 = (
¦si_w·_—pŞ_key
 *)(
—pŞ
);

138 
mic
 = (
u8
 *)(
key
 + 1);

139 
keyd©®’_pos
 = (
mic
 + 
	`¦si_g‘_miş’
(
dev
, 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0]));

140 
keyd©®’
 = ((
keyd©®’_pos
[0] << 8) | keydatalen_pos[1]);

142 ià(
key
->
ty³
 =ğ
SLSI_IEEE8021X_TYPE_EAPOL_KEY
 && 
äame_Ën
 >= 99) {

143 
msg_ty³
 = 
FAPI_MESSAGETYPE_EAPOL_KEY_M123
;

144 ià((
key
->
key_šfo
[0] & 
SLSI_EAPOL_KEY_INFO_REQUEST_BIT_IN_HIGHER_BYTE
) ||

145 !(
key
->
key_šfo
[1] & 
SLSI_EAPOL_KEY_INFO_KEY_TYPE_BIT_IN_LOWER_BYTE
)) {

146 
msg_ty³
 = 
FAPI_MESSAGETYPE_EAPOL_KEY_M123
;

148 ià(!(
key
->
key_šfo
[1] & 
SLSI_EAPOL_KEY_INFO_ACK_BIT_IN_LOWER_BYTE
)) {

149 ià((
key
->
key_šfo
[0] & 
SLSI_EAPOL_KEY_INFO_SECURE_BIT_IN_HIGHER_BYTE
) ||

150 
keyd©®’
 == 0 ||

151 ((
key
->
key_šfo
[0] & 
SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
) &&

152 (
key
->
key_šfo
[0] & 
SLSI_EAPOL_KEY_INFO_ENCR_DATA_BIT_IN_HIGHER_BYTE
) &&

153 
keyd©®’
 =ğ
SLSI_AES_BLOCK_SIZE
)) {

154 
msg_ty³
 = 
FAPI_MESSAGETYPE_EAPOL_KEY_M4
;

155 
dw–l_time
 = 0;

161 
msg_ty³
 = 
FAPI_MESSAGETYPE_EAP_MESSAGE
;

163 
dw–l_time
 = 0;

164 ià(
äame_Ën
 >ğ9 && 
—pŞ
[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] ==

165 
SLSI_IEEE8021X_TYPE_EAP_PACKET
) {

166 
—p_Ëngth
 = (
skb
->
Ën
 - (
‘hhdr
)) - 4;

167 ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_REQUEST
) {

168 
	`SLSI_INFO
(
sdev
, "S’d EAP-Reque¡ (%d)\n", 
—p_Ëngth
);

169 } ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_RESPONSE
) {

170 
	`SLSI_INFO
(
sdev
, "S’d EAP-Re¥Ú£ (%d)\n", 
—p_Ëngth
);

171 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)

172 
sdev
->
cÚn_log2us_ùx
.
—p_»¥_Ën
 = 
—p_Ëngth
;

173 } ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_SUCCESS
) {

174 
	`SLSI_INFO
(
sdev
, "S’d EAP-Sucûs (%d)\n", 
—p_Ëngth
);

175 } ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_FAILURE
) {

176 
	`SLSI_INFO
(
sdev
, "S’d EAP-Fau» (%d)\n", 
—p_Ëngth
);

182 
dw–l_time
 = 
	`¦si_g‘_dw–l_time_fÜ_wps
(
sdev
, 
ndev_vif
, 
—pŞ
, 
—p_Ëngth
);

186 
ETH_P_WAI
:

187 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "WAI…rotocol frame\n");

188 
msg_ty³
 = 
FAPI_MESSAGETYPE_WAI_MESSAGE
;

190 ià(
skb
->
d©a
[17] != 9)

191 
dw–l_time
 = 0;

194 
	`SLSI_NET_WARN
(
dev
, "protocol NOT supported\n");

195 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

196  -
EOPNOTSUPP
;

200 
tx_by‹s_tmp
 = 
skb
->
Ën
;

201 
»t
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
dev
, 
skb
, 
msg_ty³
, 0, 
dw–l_time
, 0);

202 ià(!
»t
)

203 
³”
->
sšfo
.
tx_by‹s
 +ğ
tx_by‹s_tmp
;

205 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

206  
»t
;

207 
	}
}

209 
	$¦si_tx_¬p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

211 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

212 
¦si_³”
 *
³”
;

213 
u8
 *
äame
;

214 
u16
 
¬p_İcode
;

215 
»t
 = 0;

216 
u32
 
dw–l_time
 = 0;

218 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

220 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

221 ià(!
³”
 && !
	`is_brßdÿ¡_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_de¡
)) {

222 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

223 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ ARP f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

224  -
EINVAL
;

227 ià(
³”
) {

228 
	`¥š_lock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

230 ià(
³”
->
d©a_qs
.
cÚŒŞËd_pÜt_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
) {

231 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, " ARP 8021x_STATE_BLOCKED\n");

232 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

233 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

234  -
EPERM
;

236 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

239 
äame
 = 
skb
->
d©a
 + (
‘hhdr
);

240 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

241 ià(
¬p_İcode
 =ğ
SLSI_ARP_REQUEST_OPCODE
 &&

242 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
)) {

243 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


244 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 &&

245 !
	`memcmp
(&
äame
[
SLSI_ARP_DEST_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4)) {

246 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_äom_Ãtdev
++;

249 
dw–l_time
 = 
sdev
->
fw_dw–l_time
;

251 
»t
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
dev
, 
skb
, 
FAPI_MESSAGETYPE_ARP
, 0, 
dw–l_time
, 0);

252 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

253  
»t
;

254 
	}
}

256 
	$¦si_dump_msgty³
(
¦si_dev
 *
sdev
, 
u32
 
dhı_mes§ge_ty³
)

258 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_DISCOVER
)

259 
	`SLSI_INFO
(
sdev
, "Send DHCP [DISCOVER]\n");

260 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_OFFER
)

261 
	`SLSI_INFO
(
sdev
, "Send DHCP [OFFER]\n");

262 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_REQUEST
)

263 
	`SLSI_INFO
(
sdev
, "Send DHCP [REQUEST]\n");

264 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_DECLINE
)

265 
	`SLSI_INFO
(
sdev
, "Send DHCP [DECLINE]\n");

266 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_ACK
)

267 
	`SLSI_INFO
(
sdev
, "Send DHCP [ACK]\n");

268 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_NAK
)

269 
	`SLSI_INFO
(
sdev
, "Send DHCP [NAK]\n");

270 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_RELEASE
)

271 
	`SLSI_INFO
(
sdev
, "Send DHCP [RELEASE]\n");

272 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_INFORM
)

273 
	`SLSI_INFO
(
sdev
, "Send DHCP [INFORM]\n");

274 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_FORCERENEW
)

275 
	`SLSI_INFO
(
sdev
, "Send DHCP [FORCERENEW]\n");

277 
	`SLSI_INFO
(
sdev
, "Send DHCP [INVALID]\n");

278 
	}
}

280 
	$¦si_tx_dhı
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

282 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

283 
¦si_³”
 *
³”
;

284 
»t
 = 0;

285 
u32
 
dw–l_time
 = 0;

286 
u32
 
dhı_mes§ge_ty³
 = 
SLSI_DHCP_MESSAGE_TYPE_INVALID
;

287 
u8
 *
¡r_ty³
 = 
NULL
;

288 
u8
 *
¡r_tx_¡©us
;

290 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

291 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

292 ià(!
³”
 && !
	`is_brßdÿ¡_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_de¡
)) {

293 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

294 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ DHCP f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

295  -
EINVAL
;

298 ià(
³”
) {

299 
	`¥š_lock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

301 ià(
³”
->
d©a_qs
.
cÚŒŞËd_pÜt_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
) {

302 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "dhcp 8021x_STATE_BLOCKED\n");

303 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

304 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

305  -
EPERM
;

307 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

310 ià(
skb
->
Ën
 >ğ285 && 
	`¦si_is_dhı_·ck‘
(skb->
d©a
è!ğ
SLSI_TX_IS_NOT_DHCP
) {

312 ià(
skb
->
d©a
[42] == 1)

313 
dw–l_time
 = 
sdev
->
fw_dw–l_time
;

314 
dhı_mes§ge_ty³
 = 
skb
->
d©a
[284];

315 
	`¦si_dump_msgty³
(
sdev
, 
dhı_mes§ge_ty³
);

316 
»t
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
dev
, 
skb
, 
FAPI_MESSAGETYPE_DHCP
, 0, 
dw–l_time
, 0);

318 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_DISCOVER
)

319 
¡r_ty³
 = "DISCOVER";

320 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_REQUEST
)

321 
¡r_ty³
 = "REQUEST";

323 ià(
»t
)

324 
¡r_tx_¡©us
 = "TX_FAIL";

326 
¡r_tx_¡©us
 = "ACK";

327 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_DISCOVER
 || dhı_mes§ge_ty³ =ğ
SLSI_DHCP_MESSAGE_TYPE_REQUEST
)

328 
	`¦si_cÚn_log2us_dhı_tx
(
sdev
, 
dev
, 
¡r_ty³
, 
¡r_tx_¡©us
);

330 
	`SLSI_INFO
(
sdev
, "»ˆğ%d\n", 
»t
);

333 
	`SLSI_NET_ERR
(
dev
, "Bad IP frame in SLSI_NETIF_Q_PRIORITY\n");

335 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

336  
»t
;

337 
	}
}

339 
ušt
 
	g¦si_sg_ho¡_®ign_mask
;

350 
	$¦si_tx_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

352 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

353 #iâdeà
CONFIG_SCSC_WLAN_TX_API


354 
¦si_skb_cb
 *
cb
;

355 
¦si_³”
 *
³”
;

356 
u16
 
Ën
 = 
skb
->len;

357 
»t
 = 0;

358 
u8
 
vif_šdex
 = 0;

359 
u8
 
³”_šdex
 = 0;

360 
¦si_Œaffic_q
 
tq
;

363 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

368 
	`SLSI_NET_WARN
(
dev
, "WlanLite: NOT supported\n");

369  -
EOPNOTSUPP
;

372 ià(!
ndev_vif
->
aùiv©ed
) {

373 
	`SLSI_NET_WARN
(
dev
, "vif NOT‡ctivated\n");

374  -
EINVAL
;

377 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
) {

378 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
,

380  -
EINVAL
;

382 #ifdeà
CONFIG_SCSC_WLAN_TX_API


383 ià(
	`¦si_tx_g‘_·ck‘_ty³
(
skb
è=ğ
SLSI_CTRL_PKT
)

384  
	`¦si_tx_Œªsm™_ù¾
(
sdev
, 
dev
, 
skb
);

390 ià(
skb
->
queue_m­pšg
 =ğ
SLSI_NETIF_Q_PRIORITY
) {

391 
´Ùo
 = 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
);

393 
´Ùo
) {

396 
	`SLSI_NET_ERR
(
dev
,

397 "Bad h_´Ùo=0x%x SLSI_NETIF_Q_PRIORITY\n", 
´Ùo
);

398  -
EINVAL
;

399 
ETH_P_PAE
:

400 
ETH_P_WAI
:

401 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

403  
	`¦si_tx_—pŞ
(
sdev
, 
dev
, 
skb
);

404 
ETH_P_IP
:

405 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

407  
	`¦si_tx_dhı
(
sdev
, 
dev
, 
skb
);

411 ià(
skb
->
queue_m­pšg
 =ğ
SLSI_NETIF_Q_ARP
) {

412 
´Ùo
 = 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
);

414 
´Ùo
) {

415 
ETH_P_ARP
:

416 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

418  
	`¦si_tx_¬p
(
sdev
, 
dev
, 
skb
);

421 
	`SLSI_NET_ERR
(
dev
,

422 "Bad h_´Ùo=0x%x SLSI_NETIF_Q_ARP\n", 
´Ùo
);

423  -
EINVAL
;

429 ià(
	`skb_h—droom
(
skb
è!ğskb->
mac_h—d”
)

430 
	`skb_puÎ
(
skb
, skb->
mac_h—d”
 - 
	`skb_h—droom
(skb));

432 #ifdeà
CONFIG_SCSC_WLAN_TX_API


433  
	`¦si_tx_Œªsm™_d©a
(
sdev
, 
dev
, 
skb
);

436 ià(
msdu_’abË
)

437 
	`‘hr_ii_to_subäame_msdu
(
skb
);

439 
Ën
 = 
skb
->len;

441 ()
	`skb_push
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_»q
));

442 
tq
 = 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
);

443 
vif_šdex
 = 
ndev_vif
->
iâum
;

444 
³”_šdex
 = 
	`MAP_QS_TO_AID
(
	`¦si_Ãtif_g‘_qs_äom_queue
(
skb
->
queue_m­pšg
, 
tq
));

445 
	`çpi_£t_u16
(
skb
, 
id
, 
MA_UNITDATA_REQ
);

446 
	`çpi_£t_u16
(
skb
, 
»ûiv”_pid
, 0);

447 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
SLSI_TX_PROCESS_ID_MIN
);

448 
	`çpi_£t_u32
(
skb
, 
fw_»ã»nû
, 0);

449 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
vif
, 
vif_šdex
);

450 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
cÚfigu¿tiÚ_İtiÚ
, 
FAPI_OPTION_INLINE
);

451 
	`SLSI_NET_DBG_HEX
(
dev
, 
SLSI_TX
, 
skb
->
d©a
, skb->
Ën
 < 128 ? skb->len : 128, "\n");

453 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

454 
cb
->
sig_Ëngth
 = 
	`çpi_sig_size
(
ma_un™d©a_»q
);

455 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

458 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

459 
‘hhdr
 *
ehdr
 = 
	`‘h_hdr
(
skb
);

461 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

462 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
æow_id
, 
FAPI_PRIORITY_CONTENTION
 >> 8);

463 
	`çpi_£t_memıy
(
skb
, 
u
.
ma_un™d©a_»q
.
add»ss
, 
ehdr
->
h_sourû
);

464 
»t
 = 
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
,

465 &
ndev_vif
->
­
.
group_d©a_qs
,

466 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

467 
sdev
,

468 
vif_šdex
,

469 
³”_šdex
);

470 ià(
»t
 < 0) {

471 
	`SLSI_NET_WARN
(
dev
, "no fcq for groupcast, drop Tx frame\n");

472  
»t
;

475 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif_šdex
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

476 ià(
»t
 =ğ
NETDEV_TX_OK
) {

477  
»t
;

478 } ià(
»t
 < 0) {

480 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
,

481 &
ndev_vif
->
­
.
group_d©a_qs
,

482 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

483 
sdev
,

484 
vif_šdex
,

485 
³”_šdex
);

486  
»t
;

488  -
EIO
;

491 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

493 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

494 ià(!
³”
) {

495 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

496 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ Tx f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

497  -
EINVAL
;

507 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


509 ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

510 
u8
 
i
 = 0;

512 ià(
	`is_muÉiÿ¡_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_de¡
)) {

513 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "muÉiÿ¡ oÀNAN iÁ”çû: Sourû=%pM\n", 
	`‘h_hdr
(
skb
)->
h_sourû
);

517 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
cÚfigu¿tiÚ_İtiÚ
,

518 
FAPI_OPTION_INLINE
 | 0x0010);

524 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++) {

525 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&

526 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
v®id
 &&

527 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
ndl_vif
 !ğ
³”
->ndl_vif) {

531 
sk_buff
 *
du¶iÿ‹_skb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

533 ià(!
du¶iÿ‹_skb
) {

534 
	`SLSI_NET_WARN
(
dev
, "NAN: Tx: multicast: failedo‡lloc duplicate SKB\n");

537 
	`çpi_£t_u16
(
du¶iÿ‹_skb
, 
u
.
ma_un™d©a_»q
.
vif
, 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
ndl_vif
);

539 ià(!
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
qos_’abËd
)

540 
	`çpi_£t_u16
(
du¶iÿ‹_skb
, 
u
.
ma_un™d©a_»q
.
æow_id
,

541 ((
FAPI_PRIORITY_CONTENTION
 >> 8) & 0xff) |

542 (
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
æow_id
 & 0xff00));

544 
	`çpi_£t_u16
(
du¶iÿ‹_skb
, 
u
.
ma_un™d©a_»q
.
æow_id
,

545 (
du¶iÿ‹_skb
->
´iÜ™y
 & 0xff) |

546 (
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
æow_id
 & 0xff00));

548 
	`çpi_£t_memıy
(
du¶iÿ‹_skb
, 
u
.
ma_un™d©a_»q
.
add»ss
, 
sdev
->
Çn_şu¡”_id
);

550 
	`‘h”_addr_cİy
(
	`‘h_hdr
(
du¶iÿ‹_skb
)->
h_de¡
, 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
);

552 
»t
 = 
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
d©a_qs
,

553 
	`¦si_äame_´iÜ™y_to_ac_queue
(
du¶iÿ‹_skb
->
´iÜ™y
),

554 
sdev
,

555 
vif_šdex
,

556 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
aid
);

557 ià(
»t
 < 0) {

558 
	`SLSI_NET_WARN
(
dev
, "du¶iÿ‹ SKB:‚Øfcq fÜ " 
MACSTR
 ", drİ Tx f¿me\n", 
	`MAC2STR
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
));

559 
	`kä“_skb
(
du¶iÿ‹_skb
);

563 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
,

564 
du¶iÿ‹_skb
,

565 
çl£
,

566 
vif_šdex
,

567 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
aid
,

568 
	`¦si_äame_´iÜ™y_to_ac_queue
(
du¶iÿ‹_skb
->
´iÜ™y
));

569 ià(
»t
 !ğ
NETDEV_TX_OK
) {

571 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
d©a_qs
,

572 
	`¦si_äame_´iÜ™y_to_ac_queue
(
du¶iÿ‹_skb
->
´iÜ™y
),

573 
sdev
,

574 
vif_šdex
,

575 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
aid
);

576 
	`kä“_skb
(
du¶iÿ‹_skb
);

582 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
vif
, 
³”
->
ndl_vif
);

584 
	`‘h”_addr_cİy
(
	`‘h_hdr
(
skb
)->
h_de¡
, 
³”
->
add»ss
);

588 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "TX");

590 ià(!
³”
->
qos_’abËd
)

591 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
æow_id
,

592 ((
FAPI_PRIORITY_CONTENTION
 >> 8) & 0xff) |

593 (
³”
->
æow_id
 & 0xff00));

595 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
æow_id
,

596 (
skb
->
´iÜ™y
 & 0xffè| (
³”
->
æow_id
 & 0xff00));

598 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

599 ià(
ndev_vif
->
¡a
.
tdls_’abËd
 && 
	`¦si_is_tdls_³”
(
dev
, 
³”
))

600 
	`çpi_£t_memıy
(
skb
, 
u
.
ma_un™d©a_»q
.
add»ss
, 
ndev_vif
->
¡a
.
bssid
);

602 
	`çpi_£t_memıy
(
skb
, 
u
.
ma_un™d©a_»q
.
add»ss
, 
	`‘h_hdr
(skb)->
h_de¡
);

603 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

604 
	`çpi_£t_memıy
(
skb
, 
u
.
ma_un™d©a_»q
.
add»ss
, 
	`‘h_hdr
(skb)->
h_sourû
);

605 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


606 ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
)

607 
	`çpi_£t_memıy
(
skb
, 
u
.
ma_un™d©a_»q
.
add»ss
, 
sdev
->
Çn_şu¡”_id
);

610 
»t
 = 
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
³”
->
d©a_qs
,

611 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

612 
sdev
,

613 
vif_šdex
,

614 
³”_šdex
);

615 ià(
»t
 < 0) {

616 
	`SLSI_NET_WARN
(
dev
, "nØfcq fÜ " 
MACSTR
 ", drİ Tx f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

617 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

618  
»t
;

624 
	`¦si_Œaffic_mÚ_ev’t_tx
(
sdev
, 
dev
, 
skb
);

625 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif_šdex
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

626 ià(
»t
 !ğ
NETDEV_TX_OK
) {

628 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
³”
->
d©a_qs
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

629 
sdev
,

630 
vif_šdex
,

631 
³”_šdex
);

633 ià(
»t
 =ğ-
ENOSPC
) {

634 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

635  
»t
;

637 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

638  -
EIO
;

641 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

643 
³”
->
sšfo
.
tx_by‹s
 +ğ
Ën
;

644  
»t
;

646 
	}
}

648 
	$¦si_tx_d©a_low”
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

650 #ifdeà
CONFIG_SCSC_WLAN_TX_API


651  
	`¦si_tx_Œªsm™_low”
(
sdev
, 
skb
);

653 
Ãt_deviû
 *
dev
;

654 
Ãtdev_vif
 *
ndev_vif
;

655 
¦si_³”
 *
³”
;

656 
u16
 
vif
;

657 
u8
 
³”_šdex
 = 0;

658 
u8
 *
de¡
 = 
NULL
;

659 
»t
;

661 
vif
 = 
	`çpi_g‘_vif
(
skb
);

663 
³”_šdex
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
æow_id
) >> 8;

673 
de¡
 = 
	`‘h_hdr
(
skb
)->
h_de¡
;

675 
	`rcu_»ad_lock
();

676 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

677 ià(!
dev
) {

678 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

679 
	`rcu_»ad_uÆock
();

680  -
EINVAL
;

683 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

684 
	`rcu_»ad_uÆock
();

686 ià(
	`is_muÉiÿ¡_‘h”_addr
(
de¡
è&& 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

687 ià(
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
,

688 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

689 
sdev
,

690 
vif
,

691 
³”_šdex
) < 0) {

692 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "no fcq for groupcast, dropping TX frame\n");

693  -
EINVAL
;

695 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

696 ià(
»t
 =ğ
NETDEV_TX_OK
)

697  
»t
;

702 ià(
»t
 =ğ-
ENOSPC
)

703 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "TX_LOWER...Queue Full... BUT Dropping…acket\n");

705 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "TX_LOWER...Generic Error...Dropping…acket\n");

707 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
,

708 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

709 
sdev
,

710 
vif
,

711 
³”_šdex
);

712  
»t
;

715 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

716 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
de¡
);

717 ià(!
³”
) {

718 
	`SLSI_ERR
(
sdev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", dropping TX frame\n",

719 
	`MAC2STR
(
de¡
));

720 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

721  -
EINVAL
;

723 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "TX");

725 ià((
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
æow_id
è& 0xFFè=ğ(
FAPI_PRIORITY_CONTENTION
 >> 8))

726 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP0
;

728 
skb
->
´iÜ™y
 = 
	`çpi_g‘_u16
(skb, 
u
.
ma_un™d©a_»q
.
æow_id
) & 0xFF;

730 ià(
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
³”
->
d©a_qs
,

731 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

732 
sdev
,

733 
vif
,

734 
³”_šdex
) < 0) {

735 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "no fcq for %02x:%02x:%02x:%02x:%02x:%02x, dropping TX frame\n",

736 
	`‘h_hdr
(
skb
)->
h_de¡
[0],ƒth_hdr(skb)->h_dest[1],ƒth_hdr(skb)->h_dest[2],ƒth_hdr(skb)->h_dest[3],ƒth_hdr(skb)->h_dest[4],ƒth_hdr(skb)->h_dest[5]);

737 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

738  -
EINVAL
;

744 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

745 ià(
»t
 < 0) {

746 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "% (sigÇl: %d)\n", 
»t
 =ğ-
ENOSPC
 ? "Queui fuÎ. Flow cÚŒŞ" : "FaedØŒªsm™", 
	`çpi_g‘_sigid
(
skb
));

748 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
,

749 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

750 
sdev
,

751 
vif
,

752 
³”_šdex
);

753 ià(
»t
 =ğ-
ENOSPC
)

754 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
,

757 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
,

759 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

760  
»t
;

763 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

766 
	}
}

774 
	$¦si_tx_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

776 
¦si_skb_cb
 *
cb
;

777 
»s
 = 0;

778 
çpi_sigÇl_h—d”
 *
hdr
;

780 ià(
	`WARN_ON
(!
skb
)) {

781 
»s
 = -
EINVAL
;

782 
ex™
;

790 ià(!
	`¦si_is_‹¡_mode_’abËd
())

791 ià(!
	`çpi_is_mlme
(
skb
è&& !
	`çpi_is_ma
(skbè&& !
	`çpi_is_debug
(skbè&& !
	`çpi_is_‹¡
(skb)) {

792 
	`SLSI_NET_WARN
(
dev
, "Disÿrdšg skb beÿu£ iˆha ty³: 0x%04X\n", 
	`çpi_g‘_sigid
(
skb
));

793  -
EINVAL
;

796 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

797 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

798 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

800 
hdr
 = (
çpi_sigÇl_h—d”
 *)
skb
->
d©a
;

801 
hdr
->
fw_»ã»nû
 = 0;

803 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "TX");

804 
»s
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
Œue
, 0, 0, 0);

805 ià(
»s
 !ğ
NETDEV_TX_OK
 &&„e !ğ-
EINVAL
) {

806 
»asÚ
[80];

808 
	`SLSI_NET_ERR
(
dev
, "% (sigÇÈ%d)\n", 
»s
 =ğ-
ENOSPC
 ? "Queui fuÎ. Flow cÚŒŞ" : "FaedØŒªsm™", 
	`çpi_g‘_sigid
(
skb
));

810 ià(!
	`š_š‹¼u±
()) {

811 
	`¢´štf
(
»asÚ
, Ô—sÚ), "FaedØŒªsm™ sigÇÈ0x%04X (”r:%d)", 
	`çpi_g‘_sigid
(
skb
), 
»s
);

812 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
çl£
);

814 
»s
 = -
EIO
;

817 
ex™
:

818  
»s
;

819 
	}
}

821 #iâdeà
CONFIG_SCSC_WLAN_TX_API


822 
	$¦si_tx_·u£_queues
(
¦si_dev
 *
sdev
)

824 ià(!
sdev
)

827 
	`scsc_wifi_fcq_·u£_queues
(
sdev
);

828 
	}
}

830 
	$¦si_tx_uÅau£_queues
(
¦si_dev
 *
sdev
)

832 ià(!
sdev
)

835 
	`scsc_wifi_fcq_uÅau£_queues
(
sdev
);

836 
	}
}

	@tx_api.h

7 #iâdeà
__TX_API_H__


8 
	#__TX_API_H__


	)

10 
	~<lšux/Ãtdeviû.h
>

11 
	~<lšux/ty³s.h
>

12 
	~"dev.h
"

13 
	~"mgt.h
"

14 
	~"mlme.h
"

16 
	e¦si_tx_·ck‘_t
 {

17 
	mSLSI_CTRL_PKT
,

18 
	mSLSI_DATA_PKT


27 
¦si_dev_©ch_po¡
(
¦si_dev
 *
sdev
);

35 
¦si_dev_d‘ach_po¡
(
¦si_dev
 *
sdev
);

42 
¦si_tx_g‘_numb”_of_queues
();

50 
¦si_tx_£tup_Ãt_deviû
(
Ãt_deviû
 *
dev
);

61 
boŞ
 
¦si_³”_add_po¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
, 
¦si_³”
 *
³”
);

70 
¦si_³”_»move_po¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
, 
¦si_³”
 *
³”
);

79 
boŞ
 
¦si_vif_aùiv©ed_po¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
);

88 
¦si_vif_d—ùiv©ed_po¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
);

97 
¦si_tx_ps_pÜt_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
¦si_¡a_cÚn_¡©e
 
s
);

107 
boŞ
 
¦si_tx_tdls_upd©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
¡a_³”
, ¦si_³” *
tdls_³”
, boŞ 
cÚÃùiÚ
);

115 #ià(
KERNEL_VERSION
(5, 4, 0è<ğ
LINUX_VERSION_CODE
)

116 
u16
 
¦si_tx_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, Ãt_deviû *
sb_dev
);

117 #–ià(
KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE
)

118 
u16
 
¦si_tx_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, Ãt_deviû *
sb_dev
, 
£Ëù_queue_çÎback_t
 
çÎback
);

119 #–ià(
KERNEL_VERSION
(3, 18, 0è<ğ
LINUX_VERSION_CODE
)

120 
u16
 
¦si_tx_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, *
acûl_´iv
, 
£Ëù_queue_çÎback_t
 
çÎback
);

121 #–ià(
KERNEL_VERSION
(3, 13, 0è<ğ
LINUX_VERSION_CODE
)

122 
u16
 
¦si_tx_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, *
acûl_´iv
);

124 
u16
 
¦si_£Ëù_tx_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

134 
¦si_tx_·ck‘_t
 
¦si_tx_g‘_·ck‘_ty³
(
sk_buff
 *
skb
);

141 
¦si_tx_Œªsm™_ù¾
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

149 
¦si_tx_mlme_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

158 
¦si_tx_mlme_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

165 
¦si_tx_Œªsm™_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

173 
¦si_tx_dÚe
(
¦si_dev
 *
sdev
, 
u32
 
cŞour
, 
boŞ
 
mÜe
);

181 
¦si_tx_Œªsm™_low”
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

	@udi.c

7 
	~<lšux/sysfs.h
>

8 
	~<lšux/pŞl.h
>

9 
	~<lšux/cdev.h
>

11 
	~"dev.h
"

13 
	~"h.h
"

14 
	~"log_ş›Ás.h
"

15 
	~"mlme.h
"

16 
	~"fw_‹¡.h
"

17 
	~"debug.h
"

18 
	~"udi.h
"

19 
	~"¤c_sšk.h
"

20 
	~"unifiio.h
"

21 
	~"´ocfs.h
"

22 
	~"§p_mlme.h
"

24 #ifdeà
SLSI_TEST_DEV


25 
	~"un™‹¡.h
"

26 
	#UDI_CHAR_DEVICE_NAME
 "s5n2560un™‹¡"

	)

27 
	#UDI_CLASS_NAME
 "s5n2560‹¡"

	)

29 
	#UDI_CHAR_DEVICE_NAME
 "s5n2560udi"

	)

30 
	#UDI_CLASS_NAME
 "s5n2560"

	)

33 
	#UDI_LOG_MASK_FILTER_NUM_MAX
 5

	)

35 
	#UDI_MIB_SET_LEN_MAX
 65535

	)

36 
	#UDI_MIB_GET_LEN_MAX
 2048

	)

38 #iâdeà
ETH_P_WAPI


39 
	#ETH_P_WAPI
 0x88b4

	)

42 
	#SLSI_IP_TYPE_UDP
 0x11

	)

43 
	#SLSI_DHCP_SERVER_PORT
 67

	)

44 
	#SLSI_DHCP_CLIENT_PORT
 68

	)

45 
	#SLSI_DHCP_MAGIC_OFFSET
 272

	)

46 
	#SLSI_DHCP_MESSAGE_TYPE_ACK
 0x05

	)

52 
	#NUM_CHAR_CLIENTS
 12

	)

54 
	#MAX_MINOR
 (
SLSI_UDI_MINOR_NODES
 - 1è

	)

55 
dev_t
 
	gmajÜ_numb”
;

56 
şass
 *
	gşass
;

58 
	g¦si_cdev_ş›Á
;

60 
	s¦si_cdev
 {

61 
	mmšÜ
;

62 
cdev
 
	mcdev
;

63 
¦si_cdev_ş›Á
 *
	mş›Á
[
NUM_CHAR_CLIENTS
];

65 
¦si_dev
 *
	msdev
;

66 
deviû
 *
	m·»Á
;

69 
	sudi_sigÇl_h—d”
 {

70 
__Ë16
 
	mid
;

71 
__Ë16
 
	m»ûiv”_pid
;

72 
__Ë16
 
	m£nd”_pid
;

73 
__Ë32
 
	mfw_»ã»nû
;

74 
__Ë16
 
	mvif
;

75 } 
	g__·cked
;

77 
	s¦si_cdev_ş›Á
 {

78 
¦si_cdev
 *
	mufcdev
;

79 
	mlog_’abËd
;

80 
	mlog_®low_driv”_sigÇls
;

82 
u16
 
	mtx_£nd”_id
;

83 
¦si_fw_‹¡
 
	mfw_‹¡
;

86 
u16
 
	mma_un™d©a_f‹r_cÚfig
;

88 
u16
 
	mma_un™d©a_size_lim™
;

90 
sk_buff_h—d
 
	mlog_li¡
;

91 
£m­hÜe
 
	mlog_mu‹x
;

92 
wa™_queue_h—d_t
 
	mlog_wq
;

95 
	#UDI_MAX_QUEUED_FRAMES
 10000

	)

96 
	#UDI_RESTART_QUEUED_FRAMES
 9000

	)

98 
	#UDI_MAX_QUEUED_DATA_FRAMES
 9000

	)

99 
	#UDI_RESTART_QUEUED_DATA_FRAMES
 8000

	)

106 
u32
 
	mlog_drİ³d
;

107 
u32
 
	mlog_drİ³d_d©a
;

108 
boŞ
 
	mlog_drİ_d©a_·ck‘s
;

111 
šlše
 
sk_buff
 *
	$udi_sigÇl_®loc_skb
(
size_t
 
sig_size
, size_ˆ
d©a_size
, 
u16
 
id
, u16 
vif
, cÚ¡ *
fe
, 
lše
)

113 
sk_buff
 *
skb
 = 
	`®loc_skb
(
sig_size
 + 
d©a_size
, 
GFP_ATOMIC
);

114 
udi_sigÇl_h—d”
 *
h—d”
;

116 
	`WARN_ON
(
sig_size
 < (
udi_sigÇl_h—d”
));

117 ià(
	`WARN_ON
(!
skb
))

118  
NULL
;

120 
	`¦si_skb_cb_š™
(
skb
)->
sig_Ëngth
 = 
sig_size
;

121 
	`¦si_skb_cb_g‘
(
skb
)->
d©a_Ëngth
 = 
sig_size
;

123 
h—d”
 = (
udi_sigÇl_h—d”
 *)
	`skb_put
(
skb
, 
sig_size
);

124 
h—d”
->
id
 = 
	`ıu_to_Ë16
(id);

125 
h—d”
->
»ûiv”_pid
 = 0;

126 
h—d”
->
£nd”_pid
 = 0;

127 
h—d”
->
fw_»ã»nû
 = 0;

128 
h—d”
->
vif
 = vif;

129  
skb
;

130 
	}
}

132 
šlše
 
boŞ
 
	$¦si_cdev_un™d©a_f‹r_®low
(
¦si_cdev_ş›Á
 *
ş›Á
, 
u16
 
f‹r
)

134  (
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 & 
f‹r
) == filter;

135 
	}
}

140 
¦si_cdev
 *
	guf_cdevs
[
SLSI_UDI_MINOR_NODES
];

142 
udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

143 
£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

144 
£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

146 
	$¦si_check_cdev_»fs
()

148 
ş›Á_num
;

149 
cdev_num
;

150 
¦si_cdev
 *
cdev
 = 
NULL
;

152 
cdev_num
 = 0; cdev_num < 
SLSI_UDI_MINOR_NODES
; cdev_num++) {

153 
cdev
 = 
uf_cdevs
[
cdev_num
];

155 ià(!
cdev
)

158 
ş›Á_num
 = 0; cl›Á_num < 
NUM_CHAR_CLIENTS
; client_num++)

159 ià(
cdev
->
ş›Á
[
ş›Á_num
])

164 
	}
}

166 
	$¦si_k”Ãl_to_u£r_¥aû_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
u16
 
ev’t
, 
u32
 
d©a_Ëngth
, cÚ¡ 
u8
 *
d©a
)

168 
¦si_cdev_ş›Á
 *
ş›Á
 = 
log_ş›Á
->
log_ş›Á_ùx
;

169 
sk_buff
 *
skb
;

170 
»t
;

172 ià(
	`WARN_ON
(!
ş›Á
))

173  -
EINVAL
;

175 ià(!
ş›Á
->
log_®low_driv”_sigÇls
)

178 
skb
 = 
	`udi_sigÇl_®loc_skb
((
udi_sigÇl_h—d”
), 
d©a_Ëngth
, 
ev’t
, 0, 
__FILE__
, 
__LINE__
);

179 ià(
	`WARN_ON
(!
skb
))

180  -
ENOMEM
;

182 ià(
d©a_Ëngth
)

183 
	`çpi_­³nd_d©a
(
skb
, 
d©a
, 
d©a_Ëngth
);

185 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
UDI_CONFIG_IND
);

186 ià(
»t
)

187 
	`SLSI_WARN_NODEV
("Udi†ogƒvent‚ot„egistered\n");

192 
	`kä“_skb
(
skb
);

193  
»t
;

194 
	}
}

196 
	$¦si_cdev_İ’
(
šode
 *šode, 
fe
 *file)

198 
¦si_cdev
 *
uf_cdev
;

199 
¦si_cdev_ş›Á
 *
ş›Á
;

200 
šdx
;

201 
mšÜ
;

203 
mšÜ
 = 
	`imšÜ
(
šode
);

204 ià(
mšÜ
 > 
MAX_MINOR
) {

205 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

206  -
EINVAL
;

209 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

210 ià(!
uf_cdev
) {

211 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

212  -
EINVAL
;

215 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

216 ià(!
uf_cdev
->
ş›Á
[
šdx
])

218 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

219 
	`SLSI_ERR_NODEV
("already opened\n");

220  -
ENOTSUPP
;

223 
ş›Á
 = 
	`km®loc
((*ş›Á), 
GFP_KERNEL
);

224 ià(!
ş›Á
)

225  -
ENOMEM
;

226 
	`mem£t
(
ş›Á
, 0, (
¦si_cdev_ş›Á
));

229 
	`skb_queue_h—d_š™
(&
ş›Á
->
log_li¡
);

230 
	`š™_wa™queue_h—d
(&
ş›Á
->
log_wq
);

231 
	`£ma_š™
(&
ş›Á
->
log_mu‹x
, 1);

232 
ş›Á
->
tx_£nd”_id
 = 
SLSI_TX_PROCESS_ID_UDI_MIN
;

233 
	`¦si_fw_‹¡_š™
(
uf_cdev
->
sdev
, &
ş›Á
->
fw_‹¡
);

235 
ş›Á
->
ufcdev
 = 
uf_cdev
;

236 
uf_cdev
->
ş›Á
[
šdx
] = client;

237 
fe
->
´iv©e_d©a
 = 
ş›Á
;

238 
	`¦si_´ocfs_šc_node
();

240 #ià
	`IS_ENABLED
(
CONFIG_SCSC_MXLOGGER
)

241 
	`scsc_£rviû_»gi¡”_ob£rv”
(
NULL
, "udi");

244 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "Cl›Á:%d‡dded\n", 
šdx
);

247 
	}
}

249 
	$¦si_cdev_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

251 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

252 
¦si_cdev
 *
uf_cdev
;

253 
šdx
;

254 
mšÜ
;

256 
mšÜ
 = 
	`imšÜ
(
šode
);

257 ià(
mšÜ
 > 
MAX_MINOR
) {

258 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

259  -
EINVAL
;

262 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

263 ià(!
uf_cdev
) {

264 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

265  -
EINVAL
;

268 ià(!
ş›Á
)

269  -
EINVAL
;

271 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

272 ià(
uf_cdev
->
ş›Á
[
šdx
] == client)

274 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

275 
	`SLSI_ERR_NODEV
("client‚ot found in†ist\n");

276  -
EINVAL
;

279 ià(
	`wa™queue_aùive
(&
ş›Á
->
log_wq
))

280 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

282 ià(
ş›Á
->
log_’abËd
)

283 
	`¦si_log_ş›Á_uÄegi¡”
(
ş›Á
->
ufcdev
->
sdev
, client);

285 
	`skb_queue_purge
(&
ş›Á
->
log_li¡
);

287 
	`¦si_fw_‹¡_deš™
(
uf_cdev
->
sdev
, &
ş›Á
->
fw_‹¡
);

288 
uf_cdev
->
ş›Á
[
šdx
] = 
NULL
;

291 
	`kä“
(
ş›Á
);

292 
	`¦si_´ocfs_dec_node
();

294 #ià
	`IS_ENABLED
(
CONFIG_SCSC_MXLOGGER
)

295 
	`scsc_£rviû_uÄegi¡”_ob£rv”
(
NULL
, "udi");

298 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "Cl›Á:%d„emoved\n", 
šdx
);

301 
	}
}

303 
ssize_t
 
	$¦si_cdev_»ad
(
fe
 *
fp
, *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

305 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

306 
¦si_dev
 *
sdev
;

307 
msgËn
;

308 
sk_buff
 *
skb
;

310 
	`SLSI_UNUSED_PARAMETER
(
poff
);

312 ià(!
ş›Á
)

313  -
EINVAL
;

315 ià(!
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
)) {

316 ià(
fp
->
f_æags
 & 
O_NONBLOCK
)

320 ià(
	`wa™_ev’t_š‹¼u±ibË
(
ş›Á
->
log_wq
, 
	`skb_queue_Ën
(&ş›Á->
log_li¡
))) {

321 
	`SLSI_ERR_NODEV
("slsi_cdev_read: wait_event_interruptible failed.\n");

322  -
ERESTARTSYS
;

326 
sdev
 = 
ş›Á
->
ufcdev
->sdev;

327 ià(!
sdev
) {

328 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

329  -
EINVAL
;

332 
skb
 = 
	`skb_dequeue
(&
ş›Á
->
log_li¡
);

333 ià(!
skb
) {

334 
	`SLSI_ERR
(
sdev
, "No Data\n");

335  -
EINVAL
;

338 
	`¦si_fw_‹¡_sigÇl_w™h_udi_h—d”
(
sdev
, &
ş›Á
->
fw_‹¡
, 
skb
);

340 
msgËn
 = 
skb
->
Ën
;

341 ià(
msgËn
 > (
s32
)
Ën
) {

342 
	`SLSI_WARN
(
sdev
, "Œunÿ‹d„—dØ%d‡ùu® msg†’ i %lu\n", 
msgËn
, ()
Ën
);

343 
msgËn
 = 
Ën
;

346 ià(
	`cİy_to_u£r
(
p
, 
skb
->
d©a
, 
msgËn
)) {

347 
	`SLSI_ERR
(
sdev
, "Failedo copy UDI†ogo user\n");

348 
	`kä“_skb
(
skb
);

349  -
EFAULT
;

352 
	`kä“_skb
(
skb
);

353  
msgËn
;

354 
	}
}

356 
ssize_t
 
	$¦si_cdev_wr™e
(
fe
 *
fp
, cÚ¡ *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

358 
¦si_cdev_ş›Á
 *
ş›Á
;

359 
¦si_dev
 *
sdev
;

360 
sk_buff
 *
skb
;

361 
u8
 *
d©a
;

362 
¦si_skb_cb
 *
cb
;

364 
	`SLSI_UNUSED_PARAMETER
(
poff
);

366 
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

367 ià(!
ş›Á
) {

368 
	`SLSI_ERR_NODEV
("filep…rivate data‚ot set\n");

369  -
EINVAL
;

372 ià(!
ş›Á
->
ufcdev
) {

373 
	`SLSI_ERR_NODEV
("ufcdev‚ot set\n");

374  -
EINVAL
;

377 
sdev
 = 
ş›Á
->
ufcdev
->sdev;

378 ià(!
sdev
) {

379 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

380  -
EINVAL
;

382 
skb
 = 
	`®loc_skb
(
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + 
Ën
, 
GFP_KERNEL
);

383 ià(!
skb
) {

384 
	`SLSI_WARN_NODEV
("”rÜ‡Îoÿtšg skb (Ën: %d)\n", 
Ën
);

385  -
ENOMEM
;

388 
	`skb_»£rve
(
skb
, 
SLSI_NETIF_SKB_HEADROOM
 - 
	`SLSI_SKB_GET_ALIGNMENT_OFFSET
(skb));

389 
d©a
 = 
	`skb_put
(
skb
, 
Ën
);

390 ià(
	`cİy_äom_u£r
(
d©a
, 
p
, 
Ën
)) {

391 
	`SLSI_ERR
(
sdev
, "copy from user failed\n");

392 
	`kä“_skb
(
skb
);

393  -
EFAULT
;

396 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

397 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

398 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

401 
	`çpi_£t_u32
(
skb
, 
fw_»ã»nû
, 0);

403 
	`skb_£t_mac_h—d”
(
skb
, 
	`çpi_g‘_d©a
(skbè- skb->
d©a
);

405 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
,

407 
	`çpi_g‘_sigid
(
skb
), 
	`çpi_g‘_sigËn
(skb),

408 
	`çpi_g‘_d©®’
(
skb
), 
	`skb_h—droom
(skb), ()
Ën
);

411 ià(
	`¦si_is_‹¡_mode_’abËd
(è|| 
	`çpi_is_»q
(
skb
è|| 
	`çpi_is_»s
(skb)) {

413 
ş›Á
->
tx_£nd”_id
++;

414 ià(
ş›Á
->
tx_£nd”_id
 > 
SLSI_TX_PROCESS_ID_UDI_MAX
)

415 
ş›Á
->
tx_£nd”_id
 = 
SLSI_TX_PROCESS_ID_UDI_MIN
;

417 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
ş›Á
->
tx_£nd”_id
);

418 ià(!
	`¦si_is_‹¡_mode_’abËd
())

419 
	`¦si_fw_‹¡_sigÇl
(
sdev
, &
ş›Á
->
fw_‹¡
, 
skb
);

420 ià(
	`çpi_is_ma
(
skb
)) {

421 ià(
	`¦si_tx_d©a_low”
(
sdev
, 
skb
)) {

422 
	`kä“_skb
(
skb
);

423  -
EINVAL
;

425 } ià(
	`¦si_tx_cÚŒŞ
(
sdev
, 
NULL
, 
skb
)) {

426 
	`kä“_skb
(
skb
);

427  -
EINVAL
;

429 } ià(
	`¦si_h_rx
(
sdev
, 
skb
)) {

430 
	`kä“_skb
(
skb
);

431  -
EINVAL
;

434  
Ën
;

435 
	}
}

437 
	$¦si_unifi_£t_mib
(
¦si_dev
 *
sdev
, 
¬g
)

439 
Ãt_deviû
 *
dev
 = 
NULL
;

440 
r
 = 0;

441 
u32
 
mib_d©a_Ëngth
;

442 
u32
 
mib_d©a_size
;

443 *
mib_d©a
;

444 
u16
 
mib_vif
;

446 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

447 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Device‚ot yet‡vailable\n");

448  -
EFAULT
;

451 ià(
	`cİy_äom_u£r
((*)&
mib_vif
, (*)
¬g
, 2)) {

452 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in vif\n");

453  -
EFAULT
;

456 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_Ëngth
, (*)(
¬g
 + 2), 4)) {

457 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in mib_data_length\n");

458  -
EFAULT
;

461 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_size
, (*)(
¬g
 + 6), 4)) {

462 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in mib_data_size\n");

463  -
EFAULT
;

466 ià(
	`uÆik–y
(
mib_d©a_Ëngth
 > 
UDI_MIB_SET_LEN_MAX
 || 
mib_d©a_size
 > UDI_MIB_SET_LEN_MAX || mib_data_length > mib_data_size)) {

467 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: siztoØlÚg o¸mib_d©a_Ëngth i šv®id (mib_d©a_Ëngth:%u mib_d©a_size:%u)\n", 
mib_d©a_Ëngth
, 
mib_d©a_size
);

468  -
EFAULT
;

471 
mib_d©a
 = 
	`km®loc
(
mib_d©a_size
, 
GFP_KERNEL
);

472 ià(!
mib_d©a
) {

473 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo‡llocate memory for mib_data\n");

474  -
ENOMEM
;

477 ià(
	`cİy_äom_u£r
((*)
mib_d©a
, (*)(
¬g
 + 10), 
mib_d©a_Ëngth
)) {

478 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in mib_data\n");

479 
	`kä“
(
mib_d©a
);

480  -
EFAULT
;

483 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

484 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
mib_vif
);

485 ià(
mib_vif
 !ğ0 && !
dev
) {

486 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Faed -‚‘_deviû i NULL fÜ iÁ”çû = %d\n", 
mib_vif
);

487 
	`kä“
(
mib_d©a
);

488 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

489  -
EFAULT
;

492 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
, 
mib_d©a_Ëngth
);

493 ià(
r
 != 0)

494 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Faed - mlme_£t_»q : ResuÉ codğ%d\n", 
r
);

496 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

497 
	`kä“
(
mib_d©a
);

499  
r
;

500 
	}
}

502 
	$¦si_unifi_g‘_mib
(
¦si_dev
 *
sdev
, 
¬g
)

504 
Ãt_deviû
 *
dev
 = 
NULL
;

505 
r
 = 0;

506 
u32
 
mib_d©a_Ëngth
;

507 
u32
 
mib_d©a_size
;

508 *
mib_d©a
;

509 
u16
 
mib_vif
;

511 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

512 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Device‚ot yet‡vailable\n");

513  -
EFAULT
;

517 ià(
	`cİy_äom_u£r
((*)&
mib_vif
, (*)
¬g
, 2)) {

518 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in vif\n");

519  -
EFAULT
;

523 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_Ëngth
, (*)(
¬g
 + 2), 4)) {

524 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data_length\n");

525  -
EFAULT
;

529 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_size
, (*)(
¬g
 + 6), 4)) {

530 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data_size\n");

531  -
EFAULT
;

535 ià(
	`uÆik–y
(
mib_d©a_Ëngth
 > 
UDI_MIB_GET_LEN_MAX
 || 
mib_d©a_size
 > UDI_MIB_GET_LEN_MAX || mib_data_length > mib_data_size)) {

536 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: siztoØlÚg o¸mib_d©a_Ëngth i šv®id (mib_d©a_Ëngth:%u mib_d©a_size:%u)\n", 
mib_d©a_Ëngth
, 
mib_d©a_size
);

537  -
EFAULT
;

540 
mib_d©a
 = 
	`km®loc
(
mib_d©a_size
, 
GFP_KERNEL
);

541 ià(!
mib_d©a
) {

542 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo‡llocate memory for mib_data\n");

543  -
ENOMEM
;

546 ià(
	`cİy_äom_u£r
((*)
mib_d©a
, (*)(
¬g
 + 10), 
mib_d©a_Ëngth
)) {

547 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data\n");

548 
	`kä“
(
mib_d©a
);

549  -
EFAULT
;

552 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

553 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
mib_vif
);

554 ià(
mib_vif
 !ğ0 && !
dev
) {

555 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Faed -‚‘_deviû i NULL fÜ iÁ”çû = %d\n", 
mib_vif
);

556 
	`kä“
(
mib_d©a
);

557 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

558  -
EFAULT
;

561 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib_d©a
, 
mib_d©a_Ëngth
, mib_d©a, 
mib_d©a_size
, &mib_data_length);

562 ià(
r
 != 0) {

563 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Faed - mlme_g‘_»q : ResuÉ codğ%d\n", 
r
);

564 
	`kä“
(
mib_d©a
);

565 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

566  -
EINVAL
;

569 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

572 ià(
mib_d©a_Ëngth
 > 
mib_d©a_size
) {

573 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Mib„esuÉ d©¨i tØlÚg. (%d by‹ wh’hmax i %d by‹s)\n", 
mib_d©a_Ëngth
, 
mib_d©a_size
);

574 
	`kä“
(
mib_d©a
);

575  -
EINVAL
;

579 ià(
	`cİy_to_u£r
((*)
¬g
, (*)&
mib_d©a_Ëngth
, 4)) {

580 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data_length backo user\n");

581 
	`kä“
(
mib_d©a
);

582  -
EFAULT
;

586 ià(
	`cİy_to_u£r
((*)(
¬g
 + 4), 
mib_d©a
, 
mib_d©a_Ëngth
)) {

587 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data backo user\n");

588 
	`kä“
(
mib_d©a
);

589  -
EFAULT
;

591 
	`kä“
(
mib_d©a
);

593 
	}
}

595 
	$¦si_unifi_£t_log_mask
(
¦si_cdev_ş›Á
 *
ş›Á
, 
¦si_dev
 *
sdev
, 
¬g
)

597 
unifiio_f‹r_t
 
f‹r
;

598 
i
;

601 ià(
	`cİy_äom_u£r
(&
f‹r
, (*)
¬g
, (filter))) {

602 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK: Failedo copy from userspace\n");

603  -
EFAULT
;

606 ià(
	`uÆik–y
(
f‹r
.
sigÇl_ids_n
 > 
UDI_LOG_MASK_FILTER_NUM_MAX
)) {

607 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK:‚umber of filtersoo†ong\n");

608  -
EFAULT
;

611 ià(
f‹r
.
sigÇl_ids_n
) {

612 *
sigÇl_f‹r_šdex
;

613 
max
;

614 
mš
;

616 
max
 = 
f‹r
.
sigÇl_ids
[0];

617 
mš
 = 
f‹r
.
sigÇl_ids
[0];

620 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

621 ià(
f‹r
.
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
) {

622 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 |ğ
f‹r
.
sigÇl_ids
[
i
];

625 ià(
f‹r
.
sigÇl_ids
[
i
] > 
max
)

626 
max
 = 
f‹r
.
sigÇl_ids
[
i
];

627 ià(
f‹r
.
sigÇl_ids
[
i
] < 
mš
)

628 
mš
 = 
f‹r
.
sigÇl_ids
[
i
];

631 
sigÇl_f‹r_šdex
 = 
	`km®loc
(
max
 - 
mš
 + 1, 
GFP_KERNEL
);

632 ià(
sigÇl_f‹r_šdex
) {

633 
	`mem£t
(
sigÇl_f‹r_šdex
, 0, 
max
 - 
mš
 + 1);

634 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

635 ià(
f‹r
.
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
)

637 
sigÇl_f‹r_šdex
[
f‹r
.
sigÇl_ids
[
i
] - 
mš
] = 1;

639 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

640 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
,

641 
f‹r
.
log_li¡ed_æag
 ? 
£nd_sigÇl_to_šv”£_log_f‹r
 :

642 
£nd_sigÇl_to_log_f‹r
, 
sigÇl_f‹r_šdex
, 
mš
, 
max
);

644  -
ENOMEM
;

648 
	}
}

650 
	$¦si_cdev_ioùl
(
fe
 *
fp
, 
cmd
, 
¬g
)

652 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

653 
¦si_dev
 *
sdev
;

654 
r
 = 0;

655 
št_·¿m
;

657 ià(!
ş›Á
 || !ş›Á->
ufcdev
)

658  -
EINVAL
;

659 
sdev
 = 
ş›Á
->
ufcdev
->sdev;

661 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

663 
cmd
) {

664 
UNIFI_GET_UDI_ENABLE
:

665 
št_·¿m
 = 
ş›Á
->
log_’abËd
;

666 
	`put_u£r
(
št_·¿m
, (*)
¬g
);

669 
UNIFI_SET_UDI_ENABLE
:

670 ià(
	`g‘_u£r
(
št_·¿m
, (*)
¬g
)) {

671 
r
 = -
EFAULT
;

675 ià(
št_·¿m
) {

676 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
, 
udi_log_ev’t
, 
NULL
, 0, 0);

677 
ş›Á
->
log_’abËd
 = 1;

678 ià(
št_·¿m
 > 1)

679 
ş›Á
->
log_®low_driv”_sigÇls
 = 1;

681 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

682 
ş›Á
->
log_’abËd
 = 0;

687 
UNIFI_SET_UDI_LOG_CONFIG
:

689 
unifiio_udi_cÚfig_t
 
cÚfig
;

691 ià(
	`cİy_äom_u£r
(&
cÚfig
, (*)
¬g
, (config))) {

692 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_CONFIG: Failedo copy from userspace\n");

693 
r
 = -
EFAULT
;

697 
ş›Á
->
ma_un™d©a_size_lim™
 = 
cÚfig
.ma_unitdata_size_limit;

700 
UNIFI_SET_UDI_LOG_MASK
:

701 
r
 = 
	`¦si_unifi_£t_log_mask
(
ş›Á
, 
sdev
, 
¬g
);

704 
UNIFI_SET_MIB
:

705 
r
 = 
	`¦si_unifi_£t_mib
(
sdev
, 
¬g
);

708 
UNIFI_GET_MIB
:

709 
r
 = 
	`¦si_unifi_g‘_mib
(
sdev
, 
¬g
);

712 
UNIFI_SRC_SINK_IOCTL
:

713 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

714 
	`SLSI_ERR
(
sdev
, "UNIFI_SRC_SINK_IOCTL: Device‚ot yet‡vailable\n");

715 
r
 = -
EFAULT
;

718 
r
 = 
	`¦si_¤c_sšk_cdev_ioùl_cfg
(
sdev
, 
¬g
);

721 
UNIFI_SOFTMAC_CFG
:

723 
u32
 
soámac_cmd
;

724 
u8
 
cmd_·¿m_size
;

726 
	`SLSI_ERR
(
sdev
, "UNIFI_SOFTMAC_CFG\n");

728 ià(
	`cİy_äom_u£r
((*)&
soámac_cmd
, (*)
¬g
, 4)) {

729 
	`SLSI_ERR
(
sdev
, "Failedo gethe command\n");

730 
r
 = -
EFAULT
;

733 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "soámac_cmd -> %u\n", 
soámac_cmd
);

735 
¬g
 +ğ(
soámac_cmd
);

736 ià(
	`cİy_äom_u£r
((*)&
cmd_·¿m_size
, (*)(
¬g
 + 4), 1)) {

737 
	`SLSI_ERR
(
sdev
, "Failedo gethe command size\n");

738 
r
 = -
EFAULT
;

741 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "cmd_·¿m_siz-> %u\n", 
cmd_·¿m_size
);

743 ià(
cmd_·¿m_size
)

744 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 
UDI_MA_UNITDATA_FILTER_ALLOW_EAPOL_ID
;

746 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 0;

749 
UNIFI_GET_SW_VERSION
:

751 
»s
 = 0;

752 
bud_šfo
[200];

753 
Ën
 = 0;

754 #iâdeà
SLSI_TEST_DEV


755 
	`mem£t
(
bud_šfo
, 0, 200);

756 
	`mxmª_g‘_fw_v”siÚ
(
bud_šfo
, 200);

757 
Ën
 = 
	`¡¾’
(
bud_šfo
);

758 
	`¥rštf
(
bud_šfo
 + 
Ën
, " ");

759 ià(
Ën
 >= 197) {

760 
Ën
 = 197;

761 
bud_šfo
[
Ën
 - 1] = '.';

762 
bud_šfo
[
Ën
 - 2] = '.';

763 
bud_šfo
[
Ën
 - 3] = '.';

765 
	`mxmª_g‘_driv”_v”siÚ
(
bud_šfo
 + 
Ën
 + 1, 200 -†en - 1);

768 
	`mem£t
(
bud_šfo
, 0, 200);

769 
	`¡rıy
(
bud_šfo
, "UT Build");

772 
»s
 = 
	`cİy_to_u£r
((*)
¬g
, 
bud_šfo
, 200);

773 ià(
»s
) {

774 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_SW_VERSION:ƒ¼Ü backØu£¸%d\n", 
»s
);

775 
r
 = -
EINVAL
;

780 
UNIFI_GET_FAPI_VERSION
:

782 
»s
 = 0;

783 
çpi_šfo
[100];

785 
	`mem£t
(
çpi_šfo
, 0, 100);

786 
	`¦si_g‘_çpi_v”siÚ_¡ršg
(
çpi_šfo
);

788 
»s
 = 
	`cİy_to_u£r
((*)
¬g
, 
çpi_šfo
, 100);

789 ià(
»s
) {

790 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_FAPI_VERSION:ƒ¼Ü backØu£¸%d\n", 
»s
);

791 
r
 = -
EINVAL
;

797 
	`SLSI_WARN
(
sdev
, "O³¿tiÚ (%dènÙ suµÜ‹d\n", 
cmd
);

798 
r
 = -
EINVAL
;

801 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

802  
r
;

803 
	}
}

805 
	$¦si_cdev_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

807 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

809 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "PŞl(%d)\n", 
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
));

811 ià(
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
))

812  
POLLIN
 | 
POLLRDNORM
;

814 
	`pŞl_wa™
(
fp
, &
ş›Á
->
log_wq
, 
wa™
);

816 ià(
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
))

817  
POLLIN
 | 
POLLRDNORM
;

820 
	}
}

826 
	$£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

828 
»t
 = 0;

829 
u16
 
sigÇl_id
 = 
	`çpi_g‘_sigid
(
skb
);

831 ià(
sigÇl_id
 > 
log_ş›Á
->
max_sigÇl_id
 || sigÇl_id <†og_ş›Á->
mš_sigÇl_id
 || !log_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

832 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

834  
»t
;

835 
	}
}

837 
	$£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

839 
»t
 = 0;

840 
u16
 
sigÇl_id
 = 
	`çpi_g‘_sigid
(
skb
);

842 ià(
sigÇl_id
 <ğ
log_ş›Á
->
max_sigÇl_id
 && sigÇl_id >ğlog_ş›Á->
mš_sigÇl_id
 &&†og_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

843 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

845  
»t
;

846 
	}
}

848 
	$udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

851 
¦si_cdev_ş›Á
 *
ş›Á
 = 
log_ş›Á
->
log_ş›Á_ùx
;

852 
udi_msg_t
 
msg
;

853 
udi_msg_t
 *
msg_skb
;

854 
u16
 
sigÇl_id
 = 
	`çpi_g‘_sigid
(
skb
);

856 ià(
	`WARN_ON
(!
ş›Á
))

857  -
EINVAL
;

858 ià(
	`WARN_ON
(!
skb
))

859  -
EINVAL
;

860 ià(
	`WARN_ON
(
skb
->
Ën
 == 0))

861  -
EINVAL
;

864 ià(
	`¦si_cdev_un™d©a_f‹r_®low
(
ş›Á
, 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
) &&

865 (
sigÇl_id
 =ğ
MA_UNITDATA_REQ
 || sigÇl_id =ğ
MA_UNITDATA_IND
)) {

866 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèDROP\n", 
sigÇl_id
);

868 ià(
	`down_š‹¼u±ibË
(&
ş›Á
->
log_mu‹x
)) {

869 
	`SLSI_WARN_NODEV
("Failedo get udi sem\n");

870  -
ERESTARTSYS
;

872 ià(
ş›Á
->
log_drİ_d©a_·ck‘s
)

873 
ş›Á
->
log_drİ³d_d©a
++;

874 
	`up
(&
ş›Á
->
log_mu‹x
);

875  -
ECANCELED
;

882 ià(
dœ
 =ğ
UDI_CONFIG_IND
)

883 
®low_cÚfig_äame
;

885 ià(
	`down_š‹¼u±ibË
(&
ş›Á
->
log_mu‹x
)) {

886 
	`SLSI_WARN_NODEV
("Failedo get udi sem\n");

887  -
ERESTARTSYS
;

891 ià(
ş›Á
->
log_drİ³d
) {

892 ià(
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
è<ğ
UDI_RESTART_QUEUED_FRAMES
) {

893 
u32
 
drİ³d
 = 
ş›Á
->
log_drİ³d
;

895 
	`SLSI_WARN_NODEV
("Stİ Drİpšg UDI F¿me : %d f¿me Drİ³d\n", 
drİ³d
);

896 
ş›Á
->
log_drİ³d
 = 0;

897 
	`up
(&
ş›Á
->
log_mu‹x
);

898 
	`¦si_k”Ãl_to_u£r_¥aû_ev’t
(
log_ş›Á
, 
UDI_DRV_DROPPED_FRAMES
, (
u32
), (
u8
 *)&
drİ³d
);

899  -
ECANCELED
;

901 
ş›Á
->
log_drİ³d
++;

902 
	`up
(&
ş›Á
->
log_mu‹x
);

903  -
ECANCELED
;

904 } ià(!
ş›Á
->
log_drİ³d
 && 
	`skb_queue_Ën
(&ş›Á->
log_li¡
è>ğ
UDI_MAX_QUEUED_FRAMES
) {

905 
	`SLSI_WARN_NODEV
("Start Dropping UDI Frames\n");

906 
ş›Á
->
log_drİ³d
++;

907 
	`up
(&
ş›Á
->
log_mu‹x
);

908  -
ECANCELED
;

916 ià(
ş›Á
->
log_drİ_d©a_·ck‘s
 && 
	`skb_queue_Ën
(&ş›Á->
log_li¡
è< 
UDI_RESTART_QUEUED_DATA_FRAMES
) {

917 
u32
 
drİ³d
 = 
ş›Á
->
log_drİ³d_d©a
;

919 
	`SLSI_WARN_NODEV
("Stİ Drİpšg UDI F¿me : %d BasiøD©¨äame Drİ³d\n", 
ş›Á
->
log_drİ³d_d©a
);

920 
ş›Á
->
log_drİ_d©a_·ck‘s
 = 
çl£
;

921 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 0;

922 
ş›Á
->
log_drİ³d_d©a
 = 0;

923 
	`up
(&
ş›Á
->
log_mu‹x
);

924 
	`¦si_k”Ãl_to_u£r_¥aû_ev’t
(
log_ş›Á
, 
UDI_DRV_DROPPED_DATA_FRAMES
, (
u32
), (
u8
 *)&
drİ³d
);

925  -
ECANCELED
;

926 } ià(!
ş›Á
->
log_drİ_d©a_·ck‘s
 && 
	`skb_queue_Ën
(&ş›Á->
log_li¡
è>ğ
UDI_MAX_QUEUED_DATA_FRAMES
 && !
	`¦si_cdev_un™d©a_f‹r_®low
(ş›Á, 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
)) {

927 
	`SLSI_WARN_NODEV
("Start Dropping UDI Basic Data Frames\n");

928 
ş›Á
->
log_drİ_d©a_·ck‘s
 = 
Œue
;

929 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 
UDI_MA_UNITDATA_FILTER_ALLOW_MGT_ID
 |

930 
UDI_MA_UNITDATA_FILTER_ALLOW_KEY_ID
 |

931 
UDI_MA_UNITDATA_FILTER_ALLOW_CFM_ERROR_ID
 |

932 
UDI_MA_UNITDATA_FILTER_ALLOW_EAPOL_ID
;

934 
	`up
(&
ş›Á
->
log_mu‹x
);

936 
®low_cÚfig_äame
:

937 ià((
sigÇl_id
 =ğ
MA_UNITDATA_REQ
 || sigÇl_id =ğ
MA_UNITDATA_IND
) &&

938 (
ş›Á
->
ma_un™d©a_size_lim™
è&& (
skb
->
Ën
 > client->ma_unitdata_size_limit)) {

939 
¦si_skb_cb
 *
cb
;

940 
sk_buff
 *
skb2
 = 
	`®loc_skb
((
msg
è+ 
ş›Á
->
ma_un™d©a_size_lim™
, 
GFP_ATOMIC
);

942 ià(
	`WARN_ON
(!
skb2
))

943  -
ENOMEM
;

945 
	`skb_»£rve
(
skb2
, (
msg
));

946 
cb
 = 
	`¦si_skb_cb_š™
(
skb2
);

947 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_sigËn
(
skb
);

948 
cb
->
d©a_Ëngth
 = 
ş›Á
->
ma_un™d©a_size_lim™
;

949 
	`skb_cİy_b™s
(
skb
, 0, 
	`skb_put
(
skb2
, 
ş›Á
->
ma_un™d©a_size_lim™
), client->ma_unitdata_size_limit);

950 
skb
 = 
skb2
;

952 
skb
 = 
	`skb_cİy_ex·nd
(skb, (
msg
), 0, 
GFP_ATOMIC
);

953 ià(
	`WARN_ON
(!
skb
))

954  -
ENOMEM
;

957 
msg
.
Ëngth
 = (msgè+ 
skb
->
Ën
;

958 
msg
.
time¡amp
 = 
	`ktime_to_ms
(
	`ktime_g‘
());

959 
msg
.
dœeùiÚ
 = 
dœ
;

960 
msg
.
sigÇl_Ëngth
 = 
	`çpi_g‘_sigËn
(
skb
);

962 
msg_skb
 = (
udi_msg_t
 *)
	`skb_push
(
skb
, (
msg
));

963 *
msg_skb
 = 
msg
;

965 
	`skb_queue_
(&
ş›Á
->
log_li¡
, 
skb
);

968 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

970 
	}
}

972 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

973 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

975 cÚ¡ 
fe_İ”©iÚs
 
	g¦si_cdev_fİs
 = {

976 .
owÃr
 = 
THIS_MODULE
,

977 .
	gİ’
 = 
¦si_cdev_İ’
,

978 .
	g»Ëa£
 = 
¦si_cdev_»Ëa£
,

979 .
	g»ad
 = 
¦si_cdev_»ad
,

980 .
	gwr™e
 = 
¦si_cdev_wr™e
,

981 .
	guÆocked_ioùl
 = 
¦si_cdev_ioùl
,

982 .
	gcom·t_ioùl
 = 
¦si_cdev_ioùl
,

983 .
	gpŞl
 = 
¦si_cdev_pŞl
,

986 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

987 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

989 #iâdeà
SLSI_TEST_DEV


990 
	$¦si_g‘_mšÜ
()

992 
mšÜ
;

994 
mšÜ
 = 0; mšÜ < 
SLSI_UDI_MINOR_NODES
; minor++)

995 ià(!
uf_cdevs
[
mšÜ
])

996  
mšÜ
;

998 
	}
}

1001 
	$¦si_cdev_ü—‹
(
¦si_dev
 *
sdev
, 
deviû
 *
·»Á
)

1003 
dev_t
 
devno
;

1004 
»t
;

1005 
¦si_cdev
 *
pdev
;

1006 
mšÜ
;

1008 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "\n");

1009 #ifdeà
SLSI_TEST_DEV


1012 
¦si_‹¡_dev
 *
uáe¡dev
 = (¦si_‹¡_dev *)
sdev
->
maxw–l_cÜe
;

1014 
mšÜ
 = 
uáe¡dev
->
deviû_mšÜ_numb”
;

1015 ià(
mšÜ
 >ğ0 && mšÜ < 
SLSI_UDI_MINOR_NODES
 && 
uf_cdevs
[minor])

1016  -
EINVAL
;

1019 
mšÜ
 = 
	`¦si_g‘_mšÜ
();

1021 ià(
mšÜ
 >ğ
SLSI_UDI_MINOR_NODES
 || minor < 0) {

1022 
	`SLSI_ERR
(
sdev
, "nØmšÜ‚umb” avaabË,mšÜ:%d\n", 
mšÜ
);

1023  -
ENOMEM
;

1026 
pdev
 = 
	`km®loc
((*pdev), 
GFP_KERNEL
);

1027 ià(!
pdev
)

1028  -
ENOMEM
;

1029 
	`mem£t
(
pdev
, 0, (*pdev));

1031 
	`cdev_š™
(&
pdev
->
cdev
, &
¦si_cdev_fİs
);

1032 
pdev
->
cdev
.
owÃr
 = 
THIS_MODULE
;

1033 
pdev
->
mšÜ
 = minor;

1034 
devno
 = 
	`MKDEV
(
	`MAJOR
(
majÜ_numb”
), 
mšÜ
);

1035 
»t
 = 
	`cdev_add
(&
pdev
->
cdev
, 
devno
, 1);

1036 ià(
»t
) {

1037 
	`SLSI_ERR
(
sdev
, "cdev_add faed w™h %d fÜ mšÜ %d\n", 
»t
, 
mšÜ
);

1038 
	`kä“
(
pdev
);

1039  
»t
;

1042 
pdev
->
sdev
 = sdev;

1043 
pdev
->
·»Á
 =…arent;

1044 ià(!
	`UF_DEVICE_CREATE
(
şass
, 
pdev
->
·»Á
, 
devno
,…dev, 
UDI_CHAR_DEVICE_NAME
 "%d", 
mšÜ
)) {

1045 
	`cdev_d–
(&
pdev
->
cdev
);

1046 
	`kä“
(
pdev
);

1047  -
EINVAL
;

1049 
sdev
->
uf_cdev
 = (*)
pdev
;

1050 
sdev
->
´ocfs_š¡ªû
 = 
mšÜ
;

1051 
uf_cdevs
[
mšÜ
] = 
pdev
;

1054 
	}
}

1056 
	$¦si_cdev_de¡roy
(
¦si_dev
 *
sdev
)

1058 
¦si_cdev
 *
pdev
 = (¦si_cdev *)
sdev
->
uf_cdev
;

1059 
kobjeù
 *
kobj
;

1060 
k»f
 *kref;

1062 ià(!
pdev
)

1065 
	`SLSI_DBG1
(
sdev
, 
SLSI_UDI
, "\n");

1066 
	`¦si_check_cdev_»fs
()) {

1067 
	`SLSI_ERR
(
sdev
, "UDI Client still‡ttached. Please Terminate!\n");

1068 
	`m¦“p
(1000);

1088 
kobj
 = &
pdev
->
cdev
.kobj;

1089 
k»f
 = &
kobj
->kref;

1090 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

1091 
	`»fcouÁ_»ad
(&
k»f
->
»fcouÁ
) > 1) {

1092 
	`SLSI_WARN
(
sdev
, "UDI cl›Á Fİ„–—£‚Ù com¶‘ed y‘! (couÁ=%d)\n", 
	`»fcouÁ_»ad
(&
k»f
->
»fcouÁ
));

1093 
	`m¦“p
(50);

1096 
	`©omic_»ad
(&
k»f
->
»fcouÁ
) > 1) {

1097 
	`SLSI_WARN
(
sdev
, "UDI cl›Á Fİ„–—£‚Ù com¶‘ed y‘! (couÁ=%d)\n", 
	`©omic_»ad
(&
k»f
->
»fcouÁ
));

1098 
	`m¦“p
(50);

1101 
	`deviû_de¡roy
(
şass
, 
pdev
->
cdev
.
dev
);

1102 
	`cdev_d–
(&
pdev
->
cdev
);

1103 
sdev
->
uf_cdev
 = 
NULL
;

1104 
uf_cdevs
[
pdev
->
mšÜ
] = 
NULL
;

1105 
	`kä“
(
pdev
);

1106 
	}
}

1108 
	gudi_š™Ÿli£d
;

1110 
	$¦si_udi_š™
()

1112 
»t
;

1114 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "\n");

1115 
	`mem£t
(
uf_cdevs
, 0, (uf_cdevs));

1118 
»t
 = 
	`®loc_chrdev_»giÚ
(&
majÜ_numb”
, 0, 
SLSI_UDI_MINOR_NODES
, 
UDI_CLASS_NAME
);

1119 ià(
»t
) {

1120 
	`SLSI_ERR_NODEV
("FaedØadd‡Îoødev‚umb”s: %d\n", 
»t
);

1121  
»t
;

1125 
şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
UDI_CLASS_NAME
);

1126 ià(
	`IS_ERR
(
şass
)) {

1127 
	`SLSI_ERR_NODEV
("Failedo create driver udi class\n");

1128 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

1129 
majÜ_numb”
 = 0;

1130  -
EINVAL
;

1133 
udi_š™Ÿli£d
 = 1;

1136 
	}
}

1138 
	$¦si_udi_deš™
()

1140 ià(!
udi_š™Ÿli£d
)

1142 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "\n");

1143 
	`şass_de¡roy
(
şass
);

1144 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

1145 
udi_š™Ÿli£d
 = 0;

1147 
	}
}

1149 
	$¦si_udi_node_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
·»Á
)

1151  
	`¦si_cdev_ü—‹
(
sdev
, 
·»Á
);

1152 
	}
}

1154 
	$¦si_udi_node_deš™
(
¦si_dev
 *
sdev
)

1156 
	`¦si_cdev_de¡roy
(
sdev
);

1158 
	}
}

	@udi.h

7 #iâdeà
__SLSI_UDI_H__


8 
	#__SLSI_UDI_H__


	)

10 
	~"dev.h
"

12 #ifdeà
SLSI_TEST_DEV


17 
	#SLSI_UDI_MINOR_NODES
 20

	)

20 
	#SLSI_UDI_MINOR_NODES
 2

	)

23 
¦si_udi_node_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
·»Á
);

24 
¦si_udi_node_deš™
(
¦si_dev
 *
sdev
);

26 
¦si_udi_š™
();

27 
¦si_udi_deš™
();

28 
¦si_k”Ãl_to_u£r_¥aû_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
u16
 
ev’t
, 
u32
 
d©a_Ëngth
, cÚ¡ 
u8
 *
d©a
);

29 
¦si_check_cdev_»fs
();

	@unifiio.h

8 #iâdeà
__UNIFIIO_H__


9 
	#__UNIFIIO_H__


	)

11 
	~<lšux/ty³s.h
>

16 #ifdeà
__KERNEL__


17 
	~<lšux/sock‘.h
>

18 
	~<lšux/ty³s.h
>

20 
	~<sys/sock‘.h
>

21 
	~<¡dboŞ.h
>

23 
	~<lšux/if.h
>

25 #ifdeà
__ılu¥lus


29 
	#UNIFI_GET_UDI_ENABLE
 
	`_IOR
('u', 1, )

	)

30 
	#UNIFI_SET_UDI_ENABLE
 
	`_IOW
('u', 2, )

	)

32 
	#UDI_ENABLE_DATA
 0x1

	)

33 
	#UDI_ENABLE_CONTROL
 0x2

	)

36 
	#UNIFI_GET_MIB
 
	`_IOWR
('u', 3, )

	)

37 
	#UNIFI_SET_MIB
 
	`_IOW
('u', 4, )

	)

38 
	#MAX_MIB_DATA_LENGTH
 2048

	)

41 
	#SIOCIWS80211POWERSAVEPRIV
 
SIOCIWFIRSTPRIV


	)

42 
	#SIOCIWG80211POWERSAVEPRIV
 (
SIOCIWFIRSTPRIV
 + 1)

	)

43 
	#SIOCIWS80211RELOADDEFAULTSPRIV
 (
SIOCIWFIRSTPRIV
 + 2)

	)

44 
	#SIOCIWSCONFWAPIPRIV
 (
SIOCIWFIRSTPRIV
 + 4)

	)

45 
	#SIOCIWSWAPIKEYPRIV
 (
SIOCIWFIRSTPRIV
 + 6)

	)

46 
	#SIOCIWSSMEDEBUGPRIV
 (
SIOCIWFIRSTPRIV
 + 8)

	)

47 
	#SIOCIWSAPCFGPRIV
 (
SIOCIWFIRSTPRIV
 + 10)

	)

48 
	#SIOCIWSAPSTARTPRIV
 (
SIOCIWFIRSTPRIV
 + 12)

	)

49 
	#SIOCIWSAPSTOPPRIV
 (
SIOCIWFIRSTPRIV
 + 14)

	)

50 
	#SIOCIWSFWRELOADPRIV
 (
SIOCIWFIRSTPRIV
 + 16)

	)

51 
	#SIOCIWSSTACKSTART
 (
SIOCIWFIRSTPRIV
 + 18)

	)

52 
	#SIOCIWSSTACKSTOP
 (
SIOCIWFIRSTPRIV
 + 20)

	)

54 
	#IWPRIV_POWER_SAVE_MAX_STRING
 32

	)

55 
	#IWPRIV_SME_DEBUG_MAX_STRING
 32

	)

56 
	#IWPRIV_SME_MAX_STRING
 120

	)

59 
	#UNIFI_CFG
 
	`_IOWR
('u', 5, [4])

	)

83 
	#UNIFI_BUILD_TYPE
 
	`_IOWR
('u', 7, )

	)

85 
	#UNIFI_BUILD_NME
 1

	)

86 
	#UNIFI_BUILD_WEXT
 2

	)

87 
	#UNIFI_BUILD_AP
 3

	)

90 
	#UNIFI_SET_DEBUG
 
	`_IO
('u', 0x11)

	)

91 
	#UNIFI_SET_TRACE
 
	`_IO
('u', 0x12)

	)

93 
	#UNIFI_GET_INIT_STATUS
 
	`_IOR
('u', 0x15, )

	)

94 
	#UNIFI_SET_UDI_LOG_CONFIG
 
	`_IOR
('u', 0x16, 
unifiio_udi_cÚfig_t
)

	)

95 
	#UNIFI_SET_UDI_LOG_MASK
 
	`_IOR
('u', 0x18, 
unifiio_f‹r_t
)

	)

97 
	#UNIFI_INIT_HW
 
	`_IOR
('u', 0x13, )

	)

98 
	#UNIFI_INIT_NETDEV
 
	`_IOW
('u', 0x14, [6])

	)

99 
	#UNIFI_SME_PRESENT
 
	`_IOW
('u', 0x19, )

	)

101 
	#UNIFI_CFG_PERIOD_TRAFFIC
 
	`_IOW
('u', 0x21, [4])

	)

102 
	#UNIFI_CFG_UAPSD_TRAFFIC
 
	`_IOW
('u', 0x22, )

	)

104 
	#UNIFI_SOFTMAC_CFG
 
	`_IOWR
('u', 0x30, [4])

	)

106 
	#UNIFI_NETDEV_CFG
 
	`_IOWR
('u', 0x31, 
unifiio_Ãtdev_cfg_t
)

	)

107 
	#UNIFI_STREAM_CFG
 
	`_IOWR
('u', 0x32, 
unifiio_¡»am_cfg_t
)

	)

108 
	#UNIFI_AMSDU_CFG
 
	`_IOWR
('u', 0x33, 
unifiio_amsdu_cfg_t
)

	)

109 
	#UNIFI_BA_CFG
 
	`_IOWR
('u', 0x34, 
unifiio_ba_cfg_t
)

	)

110 
	#UNIFI_SUSPEND_RESUME_CFG
 
	`_IOWR
('u', 0x35, 
unifiio_su¥’d_»sume_cfg_t
)

	)

111 
	#UNIFI_SRC_SINK_IOCTL
 
	`_IOWR
('u', 0x41, 
unifiio_¤c_sšk_¬g_t
)

	)

112 
	#UNIFI_GET_FAPI_VERSION
 
	`_IOWR
('u', 0x42, [200])

	)

113 
	#UNIFI_GET_SW_VERSION
 
	`_IOWR
('u', 0x43, [200])

	)

115 
	#¤c_sšk_aùiÚ
 
ušt16_t


	)

116 
	#SRC_SINK_ACTION_NONE
 ((
¤c_sšk_aùiÚ
)0x0000)

	)

117 
	#SRC_SINK_ACTION_ENABLE_BA
 ((
¤c_sšk_aùiÚ
)0x0001)

	)

118 
	#SRC_SINK_ACTION_SINK_START
 ((
¤c_sšk_aùiÚ
)0x0002)

	)

119 
	#SRC_SINK_ACTION_SINK_STOP
 ((
¤c_sšk_aùiÚ
)0x0003)

	)

120 
	#SRC_SINK_ACTION_GEN_START
 ((
¤c_sšk_aùiÚ
)0x0004)

	)

121 
	#SRC_SINK_ACTION_GEN_STOP
 ((
¤c_sšk_aùiÚ
)0x0005)

	)

122 
	#SRC_SINK_ACTION_SINK_REPORT
 ((
¤c_sšk_aùiÚ
)0x0006)

	)

123 
	#SRC_SINK_ACTION_GEN_REPORT
 ((
¤c_sšk_aùiÚ
)0x0007)

	)

124 
	#SRC_SINK_ACTION_SINK_REPORT_CACHED
 ((
¤c_sšk_aùiÚ
)0x0008)

	)

125 
	#SRC_SINK_ACTION_GEN_REPORT_CACHED
 ((
¤c_sšk_aùiÚ
)0x0009)

	)

126 
	#SRC_SINK_ACTION_LOOPBACK_START
 ((
¤c_sšk_aùiÚ
)0x000A)

	)

127 
	#SRC_SINK_ACTION_LOOPBACK_STOP
 ((
¤c_sšk_aùiÚ
)0x000B)

	)

129 
	#¤c_sšk_dœeùiÚ
 
ušt16_t


	)

130 
	#SRC_SINK_DIRECTION_TX
 ((
¤c_sšk_dœeùiÚ
)0x0000)

	)

131 
	#SRC_SINK_DIRECTION_RX
 ((
¤c_sšk_dœeùiÚ
)0x0001)

	)

133 
	#¤c_sšk_’dpošt
 
ušt16_t


	)

134 
	#SRC_SINK_ENDPOINT_HOSTIO
 ((
¤c_sšk_’dpošt
)0x0000)

	)

135 
	#SRC_SINK_ENDPOINT_MACRAME
 ((
¤c_sšk_’dpošt
)0x0001)

	)

137 
	sunifiio_¤c_sšk_»pÜt
 {

139 
ušt32_t
 
time
;

141 
ušt32_t
 
š‹rv®
;

144 
ušt32_t
 
time¡amp
;

146 
ušt32_t
 
du¿tiÚ
;

148 
ušt32_t
 
couÁ
;

150 
ušt32_t
 
où‘
;

152 
ušt32_t
 
kbps
;

154 
ušt16_t
 
idË_¿tio
;

155 
ušt16_t
 
š‹¼u±_Ï‹ncy
;

156 
ušt16_t
 
ä“_kby‹s
;

158 
ušt32_t
 
çed_couÁ
;

162 
	sunifiio_¤c_sšk_g’_cÚfig
 {

163 
ušt16_t
 
size
;

164 
ušt16_t
 
u£_¡»amšg
;

165 
ušt16_t
 
pkts_³r_šŒ
;

166 
ušt32_t
 
v4_de¡
;

170 
	sunifiio_¤c_sšk_cÚfig
 {

171 
ušt32_t
 
š‹rv®
;

172 
ušt16_t
 
pkts_³r_št
;

174 
unifiio_¤c_sšk_g’_cÚfig
 
g’
;

175 } 
u
;

179 
	sunifiio_¤c_sšk_commÚ
 {

181 
¤c_sšk_aùiÚ
 
aùiÚ
;

182 
ušt16_t
 
vif
;

183 
¤c_sšk_dœeùiÚ
 
dœeùiÚ
;

184 
¤c_sšk_’dpošt
 
’dpošt
;

187 
	sunifiio_¤c_sšk_¬g_t
 {

189 
unifiio_¤c_sšk_commÚ
 
commÚ
;

191 
unifiio_¤c_sšk_cÚfig
 
cÚfig
;

192 
unifiio_¤c_sšk_»pÜt
 
»pÜt
;

193 } 
u
;

197 
	sudi_msg_t
 {

199 
Ëngth
;

202 
time¡amp
;

205 
dœeùiÚ
;

206 
	#UDI_FROM_HOST
 0

	)

207 
	#UDI_TO_HOST
 1

	)

208 
	#UDI_CONFIG_IND
 2

	)

211 
sigÇl_Ëngth
;

219 
	#UDI_MA_UNITDATA_FILTER_ALLOW_MASK
 0x8000

	)

220 
	#UDI_MA_UNITDATA_FILTER_ALLOW_MGT_ID
 0x8001

	)

221 
	#UDI_MA_UNITDATA_FILTER_ALLOW_KEY_ID
 0x8002

	)

222 
	#UDI_MA_UNITDATA_FILTER_ALLOW_CFM_ERROR_ID
 0x8004

	)

223 
	#UDI_MA_UNITDATA_FILTER_ALLOW_EAPOL_ID
 0x8008

	)

230 
	#UDI_DRV_SIGNAL_BASE
 0xA000

	)

231 
	#UDI_DRV_UNLOAD_IND
 (
UDI_DRV_SIGNAL_BASE
 + 1)

	)

232 
	#UDI_DRV_DROPPED_FRAMES
 (
UDI_DRV_SIGNAL_BASE
 + 2)

	)

233 
	#UDI_DRV_DROPPED_DATA_FRAMES
 (
UDI_DRV_SIGNAL_BASE
 + 3)

	)

234 
	#UDI_DRV_SUSPEND_IND
 (
UDI_DRV_SIGNAL_BASE
 + 4)

	)

235 
	#UDI_DRV_RESUME_IND
 (
UDI_DRV_SIGNAL_BASE
 + 5)

	)

237 
	sunifiio_udi_cÚfig_t
 {

238 
ušt16_t
 
ma_un™d©a_size_lim™
;

241 
	sunifiio_f‹r_t
 {

242 
ušt16_t
 
log_li¡ed_æag
;

243 
ušt16_t
 
sigÇl_ids_n
;

244 
ušt16_t
 
sigÇl_ids
[5];

247 
	#unifi_cfg_commªd
 
ušt32_t


	)

248 
	#UNIFI_CFG_GET
 ((
unifi_cfg_commªd
)0)

	)

249 
	#UNIFI_CFG_POWER
 ((
unifi_cfg_commªd
)1)

	)

250 
	#UNIFI_CFG_POWERSAVE
 ((
unifi_cfg_commªd
)2)

	)

251 
	#UNIFI_CFG_FILTER
 ((
unifi_cfg_commªd
)3)

	)

252 
	#UNIFI_CFG_POWERSUPPLY
 ((
unifi_cfg_commªd
)4)

	)

253 
	#UNIFI_CFG_WMM_QOSINFO
 ((
unifi_cfg_commªd
)5)

	)

254 
	#UNIFI_CFG_WMM_ADDTS
 ((
unifi_cfg_commªd
)6)

	)

255 
	#UNIFI_CFG_WMM_DELTS
 ((
unifi_cfg_commªd
)7)

	)

256 
	#UNIFI_CFG_STRICT_DRAFT_N
 ((
unifi_cfg_commªd
)8)

	)

257 
	#UNIFI_CFG_SET_AP_CONFIG
 ((
unifi_cfg_commªd
)9)

	)

258 
	#UNIFI_CFG_CORE_DUMP
 ((
unifi_cfg_commªd
)10)

	)

260 
	#unifi_cfg_pow”
 
ušt32_t


	)

261 
	#UNIFI_CFG_POWER_UNSPECIFIED
 ((
unifi_cfg_pow”
)0)

	)

262 
	#UNIFI_CFG_POWER_OFF
 ((
unifi_cfg_pow”
)1)

	)

263 
	#UNIFI_CFG_POWER_ON
 ((
unifi_cfg_pow”
)2)

	)

265 
	#unifi_cfg_pow”suµly
 
ušt32_t


	)

266 
	#UNIFI_CFG_POWERSUPPLY_UNSPECIFIED
 ((
unifi_cfg_pow”suµly
)0)

	)

267 
	#UNIFI_CFG_POWERSUPPLY_MAINS
 ((
unifi_cfg_pow”suµly
)1)

	)

268 
	#UNIFI_CFG_POWERSUPPLY_BATTERIES
 ((
unifi_cfg_pow”suµly
)2)

	)

270 
	#unifi_cfg_pow”§ve
 
ušt32_t


	)

271 
	#UNIFI_CFG_POWERSAVE_UNSPECIFIED
 ((
unifi_cfg_pow”§ve
)0)

	)

272 
	#UNIFI_CFG_POWERSAVE_NONE
 ((
unifi_cfg_pow”§ve
)1)

	)

273 
	#UNIFI_CFG_POWERSAVE_FAST
 ((
unifi_cfg_pow”§ve
)2)

	)

274 
	#UNIFI_CFG_POWERSAVE_FULL
 ((
unifi_cfg_pow”§ve
)3)

	)

275 
	#UNIFI_CFG_POWERSAVE_AUTO
 ((
unifi_cfg_pow”§ve
)4)

	)

277 
	#unifi_cfg_g‘
 
ušt32_t


	)

278 
	#UNIFI_CFG_GET_COEX
 ((
unifi_cfg_g‘
)0)

	)

279 
	#UNIFI_CFG_GET_POWER_MODE
 ((
unifi_cfg_g‘
)1)

	)

280 
	#UNIFI_CFG_GET_VERSIONS
 ((
unifi_cfg_g‘
)2)

	)

281 
	#UNIFI_CFG_GET_POWER_SUPPLY
 ((
unifi_cfg_g‘
)3)

	)

282 
	#UNIFI_CFG_GET_INSTANCE
 ((
unifi_cfg_g‘
)4)

	)

283 
	#UNIFI_CFG_GET_AP_CONFIG
 ((
unifi_cfg_g‘
)5)

	)

285 
	#UNIFI_CFG_FILTER_NONE
 0x0000

	)

286 
	#UNIFI_CFG_FILTER_DHCP
 0x0001

	)

287 
	#UNIFI_CFG_FILTER_ARP
 0x0002

	)

288 
	#UNIFI_CFG_FILTER_NBNS
 0x0004

	)

289 
	#UNIFI_CFG_FILTER_NBDS
 0x0008

	)

290 
	#UNIFI_CFG_FILTER_CUPS
 0x0010

	)

291 
	#UNIFI_CFG_FILTER_ALL
 0xFFFF

	)

293 
	#uf_cfg_·ck‘_f‹r_ty³
 
ušt32_t


	)

294 
	#UNIFI_CFG_FILTER_TYPE_NONE
 ((
uf_cfg_·ck‘_f‹r_ty³
)0)

	)

295 
	#UNIFI_CFG_FILTER_TYPE_ACTIVE_HOST
 ((
uf_cfg_·ck‘_f‹r_ty³
)1)

	)

296 
	#UNIFI_CFG_FILTER_TYPE_SUSPENDED_HOST
 ((
uf_cfg_·ck‘_f‹r_ty³
)2)

	)

298 
	suf_cfg_bÿ¡_·ck‘_f‹r
 {

299 
f‹r_mode
;

300 
uf_cfg_·ck‘_f‹r_ty³
 
·ck‘_f‹r_ty³
;

301 
¬p_f‹r
;

302 
dhı_f‹r
;

303 
tşas_›s_Ëngth
;

304 
tşas_›s
[1];

307 
	suf_cfg_­_cÚfig
 {

308 
ušt8_t
 
phySuµÜ‹dB™m­
;

309 
ušt8_t
 
chªÃl
;

310 
ušt16_t
 
b—cÚIÁ”v®
;

311 
ušt8_t
 
dtimP”iod
;

312 
boŞ
 
wmmEÇbËd
;

313 
ušt8_t
 
shÜtSlÙTimeEÇbËd
;

314 
ušt16_t
 
groupkeyTimeout
;

315 
boŞ
 
¡riùGtkRekeyEÇbËd
;

316 
ušt16_t
 
gmkTimeout
;

317 
ušt16_t
 
»¥Ú£Timeout
;

318 
ušt8_t
 
»ŒªsLim™
;

319 
ušt8_t
 
rxStbc
;

320 
boŞ
 
rifsModeAÎowed
;

321 
ušt8_t
 
du®CtsPrÙeùiÚ
;

322 
ušt8_t
 
ùsPrÙeùiÚTy³
;

323 
ušt16_t
 
maxLi¡’IÁ”v®
;

326 
	sc¤_wifi_cfg_cÛx_šfo
 {

327 
boŞ
 
hasT¿fficD©a
;

328 
ušt8_t
 
cu¼’tT¿fficTy³
;

329 
ušt16_t
 
cu¼’tP”iodMs
;

330 
ušt8_t
 
cu¼’tPow”Save
;

331 
ušt16_t
 
cu¼’tCÛxP”iodMs
;

332 
ušt16_t
 
cu¼’tCÛxL©’cyMs
;

333 
boŞ
 
hasBtDeviû
;

334 
ušt32_t
 
cu¼’tBÏckOutDu¿tiÚUs
;

335 
ušt32_t
 
cu¼’tBÏckOutP”iodUs
;

336 
ušt8_t
 
cu¼’tCÛxScheme
;

339 
	stı_şsä
 {

340 
__u8
 
şs_ä_ty³
;

341 
__u8
 
şs_ä_mask
;

342 
__u8
 
v”siÚ
;

343 
__u8
 
sourû__addr
[4];

344 
__u8
 
de¡__addr
[4];

345 
__u16
 
sourû_pÜt
;

346 
__u16
 
de¡_pÜt
;

347 
__u8
 
dsı
;

348 
__u8
 
´ÙocŞ
;

349 
__u8
 
»£rved
;

350 } 
__·cked
;

351 
	#tı_şsä_t
 
tı_şsä


	)

353 
	stşas
 {

354 
__u8
 
–em’t_id
;

355 
__u8
 
Ëngth
;

356 
__u8
 
u£r_´iÜ™y
;

357 
tı_şsä_t
 
tı__şs_ä
;

358 } 
__·cked
;

360 
	#CONFIG_IND_ERROR
 0x01

	)

361 
	#CONFIG_IND_EXIT
 0x02

	)

362 
	#CONFIG_SME_NOT_PRESENT
 0x10

	)

363 
	#CONFIG_SME_PRESENT
 0x20

	)

393 
	sunifiio_Ãtdev_cfg_t
 {

394 
ušt8_t
 
İ”©iÚ
;

396 
š‹rçûTag
;

397 
ušt8_t
 
vif_šdex
;

398 
ušt8_t
 
š‹rçûMode
;

399 
maÿddr
[6];

400 
Çme
[
IFNAMSIZ
];

401 
³”_maÿddr
[6];

402 
ušt16_t
 
assocŸtiÚ_id
;

405 
	#unifiio_¡»am_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

406 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_NONE
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)0)

	)

407 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_CREATE
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)1)

	)

408 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_STOP
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)2)

	)

409 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_DELETE
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)3)

	)

411 
	sunifiio_¡»am_cfg_t
 {

412 
unifiio_¡»am_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

413 
š‹rçûTag
;

414 
³”_maÿddr
[6];

415 
ušt16_t
 
tId
;

416 
ušt16_t
 
hªdË
;

417 
ušt16_t
 
size
;

420 
	#unifiio_amsdu_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

421 
	#UNIFI_CFG_AMSDU_OPERATION_TYPE_SET_MAX_SIZE
 ((
unifiio_amsdu_cfg_İ”©iÚ_ty³
)0)

	)

423 
	sunifiio_amsdu_cfg_t
 {

424 
unifiio_amsdu_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

425 
š‹rçûTag
;

426 
³”_maÿddr
[6];

427 
ušt16_t
 
size
;

430 
	#unifiio_ba_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

431 
	#UNIFI_CFG_BA_SESSION_STOP
 ((
unifiio_ba_cfg_İ”©iÚ_ty³
)0)

	)

432 
	#UNIFI_CFG_BA_SESSION_START
 ((
unifiio_ba_cfg_İ”©iÚ_ty³
)1)

	)

434 
	sunifiio_ba_cfg_t
 {

435 
unifiio_ba_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

436 
š‹rçûTag
;

437 
³”_maÿddr
[6];

438 
ušt16_t
 
tId
;

439 
ušt8_t
 
rŞe
;

440 
ušt16_t
 
wšdow_size
;

441 
ušt16_t
 
s¢
;

444 
	#unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

445 
	#UNIFI_CFG_SUSPEND
 ((
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
)0)

	)

446 
	#UNIFI_CFG_RESUME
 ((
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
)1)

	)

447 
	#UNIFI_CFG_WAIT_FOR_RESUME
 ((
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
)2)

	)

449 
	sunifiio_su¥’d_»sume_cfg_t
 {

450 
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

451 
timeout_ms
;

454 #ifdeà
__ılu¥lus


	@utils.h

7 #iâdeà
SLSI_UTILS_H__


8 
	#SLSI_UTILS_H__


	)

10 
	~<lšux/v”siÚ.h
>

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/¥šlock.h
>

13 
	~<lšux/wÜkqueue.h
>

14 
	~<lšux/skbuff.h
>

15 
	~<Ãt/cfg80211.h
>

16 
	~<lšux/fœmw¬e.h
>

18 
	~"Ãtif.h
"

19 
	~"çpi.h
"

21 
	s¦si_skb_cb
 {

22 
u32
 
	msig_Ëngth
;

23 
u32
 
	md©a_Ëngth
;

24 
u32
 
	mäame_fÜm©
;

25 #ifdeà
CONFIG_SCSC_SMAPPER


26 
boŞ
 
	msm­³r_lšked
;

27 
boŞ
 
	mä“_ma_un™d©
;

28 
sk_buff
 *
	mskb_addr
;

30 
boŞ
 
	mwakeup
;

31 
boŞ
 
	mis_ch”ed
;

32 
boŞ
 
	mis_amsdu
;

33 
boŞ
 
	mis_tdls
;

34 
u8
 
	mdisÿrd
;

35 
u16
 
	mtid
;

36 
u16
 
	m£q_num
;

37 
u8
 
	mkeyrsc
[8];

39 
	gÃtdev_vif
;

41 
šlše
 
¦si_skb_cb
 *
	$¦si_skb_cb_g‘
(
sk_buff
 *
skb
)

43  (
¦si_skb_cb
 *)
skb
->
cb
;

44 
	}
}

46 
šlše
 
¦si_skb_cb
 *
	$¦si_skb_cb_š™
(
sk_buff
 *
skb
)

48 
	`BUILD_BUG_ON
((
¦si_skb_cb
è> (
skb
->
cb
));

50 
	`mem£t
(
skb
->
cb
, 0, (
¦si_skb_cb
));

51  
	`¦si_skb_cb_g‘
(
skb
);

52 
	}
}

54 
	#çpi_®loc
(
mp_Çme
, 
mp_id
, 
mp_vif
, 
mp_d©®’
è
	`çpi_®loc_f
(
	`çpi_sig_size
(mp_Çme), mp_d©®’, mp_id, mp_vif, 
__FILE__
, 
__LINE__
)

	)

55 
	#çpi_g‘_buff
(
mp_skb
, 
mp_Çme
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

56 
	#çpi_g‘_u16
(
mp_skb
, 
mp_Çme
è
	`Ë16_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

57 
	#çpi_g‘_u32
(
mp_skb
, 
mp_Çme
è
	`Ë32_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

58 
	#çpi_g‘_u64
(
mp_skb
, 
mp_Çme
è
	`Ë64_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

59 
	#çpi_£t_u16
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë16
(mp_v®ue))

	)

60 
	#çpi_£t_u32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë32
(mp_v®ue))

	)

61 
	#çpi_g‘_s16
(
mp_skb
, 
mp_Çme
è((
s16
)
	`Ë16_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme))

	)

62 
	#çpi_g‘_s32
(
mp_skb
, 
mp_Çme
è((
s32
)
	`Ë32_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme))

	)

63 
	#çpi_£t_s16
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë16
((
u16
)mp_v®ue))

	)

64 
	#çpi_£t_s32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë32
((
u32
)mp_v®ue))

	)

65 
	#çpi_£t_memıy
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`memıy
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme, mp_v®ue, (((çpi_sigÇÈ*)(mp_skb)->d©a)->mp_Çme))

	)

66 
	#çpi_£t_mem£t
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`mem£t
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme, mp_v®ue, (((çpi_sigÇÈ*)(mp_skb)->d©a)->mp_Çme))

	)

69 
	#çpi_g‘_high16_u32
(
mp_skb
, 
mp_Çme
è((
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffff0000è>> 16)

	)

70 
	#çpi_£t_high16_u32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`çpi_£t_u32
((mp_skb), mp_Çme, (
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffffè| ((mp_v®ueè<< 16))

	)

71 
	#çpi_g‘_low16_u32
(
mp_skb
, 
mp_Çme
è(
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffff)

	)

72 
	#çpi_£t_low16_u32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`çpi_£t_u32
((mp_skb), mp_Çme, (
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffff0000è| (mp_v®ue))

	)

74 
	#çpi_g‘_sigËn
(
mp_skb
è(
	`¦si_skb_cb_g‘
(mp_skb)->
sig_Ëngth
)

	)

75 
	#çpi_g‘_d©®’
(
mp_skb
è(
	`¦si_skb_cb_g‘
(mp_skb)->
d©a_Ëngth
 - slsi_skb_cb_g‘(mp_skb)->
sig_Ëngth
)

	)

76 
	#çpi_g‘_d©a
(
mp_skb
è(mp_skb->
d©a
 + 
	`çpi_g‘_sigËn
(mp_skb))

	)

77 
	#çpi_g‘_vif
(
mp_skb
è
	`Ë16_to_ıu
(((
çpi_vif_sigÇl_h—d”
 *)(mp_skb)->
d©a
)->
vif
)

	)

80 
	#çpi_g‘_mgmt
(
mp_skb
è((
›“80211_mgmt
 *)
	`çpi_g‘_d©a
(mp_skb))

	)

81 
	#çpi_g‘_mgm’
(
mp_skb
è
	`çpi_g‘_d©®’
(mp_skb)

	)

83 
	#SLSI_BYTE_TO_BINARY_PATTERN
 "%c%c%c%c%c%c%c%c"

	)

84 
	#SLSI_BYTE_TO_BINARY
(
by‹
) \

85 (
by‹
 & 0x01 ? '1' : '0'), \

86 (
by‹
 & 0x02 ? '1' : '0'), \

87 (
by‹
 & 0x04 ? '1' : '0'), \

88 (
by‹
 & 0x08 ? '1' : '0'), \

89 (
by‹
 & 0x10 ? '1' : '0'), \

90 (
by‹
 & 0x20 ? '1' : '0'), \

91 (
by‹
 & 0x40 ? '1' : '0'), \

92 (
by‹
 & 0x80 ? '1' : '0')

	)

94 
šlše
 
sk_buff
 *
	$çpi_®loc_f
(
size_t
 
sig_size
, size_ˆ
d©a_size
, 
u16
 
id
, u16 
vif
, cÚ¡ *
fe
, 
lše
)

96 
sk_buff
 *
skb
 = 
NULL
;

97 
çpi_vif_sigÇl_h—d”
 *
h—d”
;

99 ià(
	`WARN_ON
(
	`š_š‹¼u±
()))

100  
NULL
;

101 
skb
 = 
	`®loc_skb
(
sig_size
 + 
d©a_size
, 
GFP_KERNEL
);

102 
	`WARN_ON
(
sig_size
 < (
çpi_sigÇl_h—d”
));

103 ià(
	`WARN_ON
(!
skb
))

104  
NULL
;

106 
	`¦si_skb_cb_š™
(
skb
)->
sig_Ëngth
 = 
sig_size
;

107 
	`¦si_skb_cb_g‘
(
skb
)->
d©a_Ëngth
 = 
sig_size
;

109 
h—d”
 = (
çpi_vif_sigÇl_h—d”
 *)
	`skb_put
(
skb
, 
sig_size
);

110 
h—d”
->
id
 = 
	`ıu_to_Ë16
(id);

111 
h—d”
->
»ûiv”_pid
 = 0;

112 
h—d”
->
£nd”_pid
 = 0;

113 
h—d”
->
fw_»ã»nû
 = 0;

114 
h—d”
->
vif
 = vif;

115  
skb
;

116 
	}
}

118 
šlše
 
u8
 *
	$çpi_­³nd_d©a
(
sk_buff
 *
skb
, cÚ¡ 
u8
 *
d©a
, 
size_t
 
d©a_Ën
)

120 
u8
 *
p
;

122 ià(
	`WARN_ON
(
	`skb_room
(
skb
è< 
d©a_Ën
))

123  
NULL
;

125 
p
 = 
	`skb_put
(
skb
, 
d©a_Ën
);

126 
	`¦si_skb_cb_g‘
(
skb
)->
d©a_Ëngth
 +ğ
d©a_Ën
;

127 ià(
d©a
)

128 
	`memıy
(
p
, 
d©a
, 
d©a_Ën
);

129  
p
;

130 
	}
}

132 
šlše
 
u8
 *
	$çpi_­³nd_d©a_u32
(
sk_buff
 *
skb
, cÚ¡ 
u32
 
d©a
)

134 
__Ë32
 
v®
 = 
	`ıu_to_Ë32
(
d©a
);

136  
	`çpi_­³nd_d©a
(
skb
, (
u8
 *)&
v®
, (val));

137 
	}
}

139 
šlše
 
u8
 *
	$çpi_­³nd_d©a_u16
(
sk_buff
 *
skb
, cÚ¡ 
u16
 
d©a
)

141 
__Ë16
 
v®
 = 
	`ıu_to_Ë16
(
d©a
);

143  
	`çpi_­³nd_d©a
(
skb
, (
u8
 *)&
v®
, (val));

144 
	}
}

146 
šlše
 
u8
 *
	$çpi_­³nd_d©a_u8
(
sk_buff
 *
skb
, cÚ¡ 
u8
 
d©a
)

148 
u8
 
v®
 = 
d©a
;

150  
	`çpi_­³nd_d©a
(
skb
, (
u8
 *)&
v®
, (val));

151 
	}
}

153 
	#çpi_­³nd_d©a_boŞ
(
skb
, 
d©a
è
	`çpi_­³nd_d©a_u16
(skb, d©a)

	)

155 
šlše
 
u32
 
	$¦si_cÚv”t_v_d©a_to_v®ue
(
u8
 *
d©a
, 
u16
 
Ëngth
)

157 
u32
 
v®ue
 = 0;

158 
i
;

160 ià(
Ëngth
 > 4)

162 
i
 = 0; i < 
Ëngth
; i++)

163 
v®ue
 |ğ((
u32
)
d©a
[
i
]) << i * 8;

165  
v®ue
;

166 
	}
}

168 
šlše
 
	$¦si_cÚv”t_v_to_64b™_v®ue
(
u8
 *
d©a
, 
u16
 
Ëngth
, 
u32
 *
low”
, u32 *
high”
)

170 
i
;

172 *
low”
 = 0;

173 *
high”
 = 0;

174 ià(
Ëngth
 > 8)

176 
i
 = 0; i < 4 && i < 
Ëngth
; i++)

177 *
low”
 |ğ((
u32
)
d©a
[
i
]) << i * 8;

178 
i
 = 4; i < 8 && i < 
Ëngth
; i++)

179 *
high”
 |ğ((
u32
)
d©a
[
i
]) << (i - 4) * 8;

180 
	}
}

182 #ifdeà
__ılu¥lus


186 
	#SLSI_ETHER_COPY
(
d¡
, 
¤c
è
	`‘h”_addr_cİy
((d¡), (¤c))

	)

187 
	#SLSI_ETHER_EQUAL
(
mac1
, 
mac2
è
	`‘h”_addr_equ®
((mac1), (mac2))

	)

189 
ušt
 
¦si_sg_ho¡_®ign_mask
;

190 
	#SLSI_HIP_FH_SIG_PREAMBLE_LEN
 4

	)

191 
	#SLSI_SKB_GET_ALIGNMENT_OFFSET
(
skb
è(0)

	)

194 
	#SLSI_UNUSED_PARAMETER
(
x
è(()(x))

	)

197 
	#SLSI_ECR
(
func
) \

199 
_”r
 = (
func
); \

200 ià(
_”r
 != 0) { \

201 
	`SLSI_ERR_NODEV
("e=%d\n", 
_”r
); \

202  
_”r
; \

204 } 0)

	)

206 
	#SLSI_EC
(
func
) \

208 
_”r
 = (
func
); \

209 ià(
_”r
 != 0) { \

210 
	`SLSI_ERR_NODEV
("e=%d\n", 
_”r
); \

213 } 0)

	)

215 
	#SLSI_EC_GOTO
(
func
, 
”r
, 
Ïb–
) \

217 (
”r
èğ
func
; \

218 ià((
”r
) != 0) { \

219 
	`WARN_ON
(1); \

220 
	`SLSI_ERR
(
sdev
, "ç‡ˆlše:%d\n", 
__LINE__
); \

221 
Ïb–
; \

223 } 0)

	)

225 
	#SLSI_ENSURE_NULL_TERMINATED
(
¡r
, 
size
è((¡r)[(sizeè- 1] = '\0')

	)

230 
	#SLSI_BUFF_LE_TO_U16
(
±r
è(((
u16
)((
u8
 *)ÕŒ))[0]è| ((u16)((u8 *)ÕŒ))[1]è<< 8)

	)

231 
	#SLSI_U16_TO_BUFF_LE
(
ušt
, 
±r
) \

233 
u32
 
loÿl_ušt_tmp
 = (
ušt
); \

234 ((
u8
 *)(
±r
))[0] = ((u8)((
loÿl_ušt_tmp
 & 0x00FF))); \

235 ((
u8
 *)(
±r
))[1] = ((u8)(
loÿl_ušt_tmp
 >> 8)); \

236 } 0)

	)

238 
	#SLSI_U32_TO_BUFF_LE
(
ušt
, 
±r
è((*(
u32
 *íŒèğ
	`ıu_to_Ë32
(ušt))

	)

240 
	#SLSI_BUFF_LE_TO_U16_P
(
ouut
, 
šput
) \

242 (
ouut
èğ(
u16
)((((u16)(
šput
)[1]) << 8) | ((u16)(input)[0])); \

243 (
šput
) += 2; \

244 } 0)

	)

246 
	#SLSI_BUFF_LE_TO_U32_P
(
ouut
, 
šput
) \

248 (
ouut
èğ
	`Ë32_to_ıu
(*(
u32
 *)
šput
); \

249 (
šput
) += 4; \

250 } 0)

	)

252 
	#SLSI_U16_TO_BUFF_LE_P
(
ouut
, 
šput
) \

254 (
ouut
)[0] = ((
u8
)((
šput
) & 0x00FF)); \

255 (
ouut
)[1] = ((
u8
)((
šput
) >> 8)); \

256 (
ouut
) += 2; \

257 } 0)

	)

259 
	#SLSI_U32_TO_BUFF_LE_P
(
ouut
, 
šput
) \

261 (*(
u32
 *)
ouut
èğ
	`ıu_to_Ë32
(
šput
); \

262 (
ouut
) += 4; \

263 } 0)

	)

266 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


267 
	#¦si_wake_lock_š™
(
lock
, 
ty³
, 
Çme
è
	`wake_lock_š™
Öock,y³,‚ame)

	)

268 
	#¦si_wake_lock
(
lock
è
	`wake_lock
Öock)

	)

269 
	#¦si_wake_uÆock
(
lock
è
	`wake_uÆock
Öock)

	)

270 
	#¦si_wake_lock_timeout
(
lock
, 
timeout
è
	`wake_lock_timeout
Öock,imeout)

	)

271 
	#¦si_wake_lock_aùive
(
lock
è
	`wake_lock_aùive
Öock)

	)

272 
	#¦si_wake_lock_de¡roy
(
lock
è
	`wake_lock_de¡roy
Öock)

	)

274 
	#¦si_wake_lock_š™
(
lock
, 
ty³
, 
Çme
)

	)

275 
	#¦si_wake_lock
(
lock
)

	)

276 
	#¦si_wake_uÆock
(
lock
)

	)

277 
	#¦si_wake_lock_timeout
(
lock
, 
timeout
)

	)

278 
	#¦si_wake_lock_aùive
(
lock
è(
çl£
)

	)

279 
	#¦si_wake_lock_de¡roy
(
lock
)

	)

282 
	s¦si_¥šlock
 {

284 
¥šlock_t
 
	glock
;

285 
	gæags
;

289 
šlše
 
¦si_¥šlock_ü—‹
(
¦si_¥šlock
 *
lock
)

291 
¥š_lock_š™
(&
lock
->lock);

294 
šlše
 
¦si_¥šlock_lock
(
¦si_¥šlock
 *
lock
)

296 
¥š_lock_bh
(&
lock
->lock);

299 
šlše
 
¦si_¥šlock_uÆock
(
¦si_¥šlock
 *
lock
)

301 
¥š_uÆock_bh
(&
lock
->lock);

304 
	g¦si_dev
;

305 
	s¦si_skb_wÜk
 {

306 
¦si_dev
 *
	gsdev
;

307 
Ãt_deviû
 *
	gdev
;

308 
wÜkqueue_¡ruù
 *
	gwÜkqueue
;

309 
wÜk_¡ruù
 
	gwÜk
;

310 
sk_buff_h—d
 
	gqueue
;

311 
__rcu
 *
	gsync_±r
;

314 
šlše
 
¦si_skb_wÜk_š™
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_skb_wÜk
 *
wÜk
,

315 cÚ¡ *
Çme
, (*
func
)(
wÜk_¡ruù
 *
wÜk
))

317 
rcu_assign_poš‹r
(
wÜk
->
sync_±r
, (*)
sdev
);

318 
	gwÜk
->
	gsdev
 = 
sdev
;

319 
	gwÜk
->
	gdev
 = 
dev
;

320 
skb_queue_h—d_š™
(&
wÜk
->
queue
);

321 
INIT_WORK
(&
wÜk
->wÜk, 
func
);

322 
	gwÜk
->
	gwÜkqueue
 = 
®loc_Üd”ed_wÜkqueue
(
Çme
, 0);

324 ià(!
	gwÜk
->
	gwÜkqueue
)

325  -
	gENOMEM
;

329 
šlše
 
¦si_skb_scheduË_wÜk
(
¦si_skb_wÜk
 *
wÜk
)

331 
queue_wÜk
(
wÜk
->
wÜkqueue
, &work->work);

334 
šlše
 
¦si_skb_wÜk_’queue_l
(
¦si_skb_wÜk
 *
wÜk
, 
sk_buff
 *
skb
)

336 *
	gsync_±r
;

338 
rcu_»ad_lock
();

340 
	gsync_±r
 = 
rcu_d”eã»nû
(
wÜk
->
sync_±r
);

342 ià(
WARN_ON
(!
sync_±r
)) {

343 
kä“_skb
(
skb
);

344 
rcu_»ad_uÆock
();

347 
skb_queue_
(&
wÜk
->
queue
, 
skb
);

348 
¦si_skb_scheduË_wÜk
(
wÜk
);

350 
rcu_»ad_uÆock
();

353 
šlše
 
sk_buff
 *
¦si_skb_wÜk_dequeue_l
(
¦si_skb_wÜk
 *
wÜk
)

355  
skb_dequeue
(&
wÜk
->
queue
);

358 
šlše
 
¦si_skb_wÜk_deš™
(
¦si_skb_wÜk
 *
wÜk
)

360 
rcu_»ad_lock
();

362 ià(
WARN_ON
(!
wÜk
->
sync_±r
)) {

363 
rcu_»ad_uÆock
();

367 
rcu_assign_poš‹r
(
wÜk
->
sync_±r
, 
NULL
);

368 
rcu_»ad_uÆock
();

370 
synchrÚize_rcu
();

371 
æush_wÜkqueue
(
wÜk
->
wÜkqueue
);

372 
de¡roy_wÜkqueue
(
wÜk
->
wÜkqueue
);

373 
	gwÜk
->
	gwÜkqueue
 = 
NULL
;

374 
skb_queue_purge
(&
wÜk
->
queue
);

377 
šlše
 
¦si_cfg80211_put_bss
(
why
 *why, 
cfg80211_bss
 *
bss
)

379 
cfg80211_put_bss
(
why
, 
bss
);

382 
	#¦si_skb_wÜk_’queue
(
wÜk_
, 
skb_
è
	`¦si_skb_wÜk_’queue_l
(wÜk_, skb_)

	)

383 
	#¦si_skb_wÜk_dequeue
(
wÜk_
è
	`¦si_skb_wÜk_dequeue_l
(wÜk_)

	)

385 
šlše
 
¦si_‘h_z”o_addr
(
u8
 *
addr
)

387 
mem£t
(
addr
, 0x00, 
ETH_ALEN
);

390 
šlše
 
¦si_‘h_brßdÿ¡_addr
(
u8
 *
addr
)

392 
mem£t
(
addr
, 0xff, 
ETH_ALEN
);

395 
šlše
 
¦si_¡r_to_št
(*
¡r
, *
»suÉ
)

397 
	gi
 = 0;

398 
	gsign
 = 1;

399 
	g”r
 = 0;

400 
	g»s
 = 0;

401 
	gdig™
 = 0;

403 ià(!
	g¡r
)

405 ià(*
	g¡r
 == '-') {

406 
sign
 = -1;

407 ++
	g¡r
;

408 } ià(*
	g¡r
 == '+') {

409 
sign
 = 1;

410 ++
	g¡r
;

413 *
	g»suÉ
 = 0;

414 ià((
	g¡r
[
i
] >ğ'0'è&& (
¡r
[i] <= '9')) {

415 
¡r
[
i
] >= '0' && str[i] <= '9') {

416 ià(
»s
 > 
INT_MAX
 / 10) {

417 
”r
 = 1;

420 
	g»s
 *= 10;

421 
	gdig™
 = 
¡r
[
i
] - '0';

423 ià(
	g»s
 > 
	gINT_MAX
 - 
	gdig™
) {

424 ià(
	gsign
 == -1) {

425 
»s
 +ğ
dig™
;

426 ià(-(
	g»s
è>ğ
INT_MIN
) {

429 
	g”r
 = 1;

433 
	g”r
 = 1;

437 
	g»s
 +ğ
dig™
;

438 
	gi
++;

441 ià(!
	g”r
)

442 *
	g»suÉ
 = ((
sign
 =ğ-1è? -(
»s
) :„es);

446  
	gi
;

449 
šlše
 
¦si_¡r_cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
)

451 ià(!
	gs1
 && !
	gs2
)

453 ià(
	gs1
 && !
	gs2
)

455 ià(!
	gs1
 && 
	gs2
)

458  
¡rcmp
(
s1
, 
s2
);

461 
	#P80211_OUI_LEN
 3

	)

463 
	s›“80211_¢­_hdr
 {

464 
u8
 
	gd§p
;

465 
u8
 
	gs§p
;

466 
u8
 
	gù¾
;

467 
u8
 
	goui
[
P80211_OUI_LEN
];

468 } 
	g__·cked
;

470 
	smsdu_hdr
 {

471 
	gda
[
ETH_ALEN
];

472 
	g§
[
ETH_ALEN
];

473 
__be16
 
	gËngth
;

474 
›“80211_¢­_hdr
 
	g¢­
;

475 
__be16
 
	g‘h”_ty³
;

476 } 
	g__·cked
;

478 
	#ETHER_TYPE_SIZE
 2

	)

479 
	#MSDU_HLEN
 (
msdu_hdr
)

	)

480 
	#MSDU_LENGTH
 ((
›“80211_¢­_hdr
è+ (
__be16
))

	)

482 
šlše
 
¦si_skb_msdu_to_‘hhdr
(
sk_buff
 *
skb
)

484 
‘hhdr
 *
	g‘h
;

485 
msdu_hdr
 *
	gmsdu
;

487 
	gda
[
ETH_ALEN
];

488 
	g§
[
ETH_ALEN
];

489 
__be16
 
	g´Ùo
;

491 
	gmsdu
 = (
msdu_hdr
 *)
skb
->
d©a
;

492 
SLSI_ETHER_COPY
(
da
, 
msdu
->da);

493 
SLSI_ETHER_COPY
(
§
, 
msdu
->sa);

494 
	g´Ùo
 = 
msdu
->
‘h”_ty³
;

496 
skb_puÎ
(
skb
, 
MSDU_HLEN
);

498 
	g‘h
 = (
‘hhdr
 *)
skb_push
(
skb
, 
ETH_HLEN
);

500 
SLSI_ETHER_COPY
(
‘h
->
h_de¡
, 
da
);

501 
SLSI_ETHER_COPY
(
‘h
->
h_sourû
, 
§
);

502 
	g‘h
->
	gh_´Ùo
 = 
´Ùo
;

507 
šlše
 
¦si_skb_‘hhdr_to_msdu
(
sk_buff
 *
skb
)

509 
‘hhdr
 *
	g‘h
;

510 
msdu_hdr
 *
	gmsdu
;

511 
	gËn
;

512 
__be16
 
	g‘h”_ty³
;

514 ià(
skb_h—droom
(
skb
è< (
	gMSDU_HLEN
 - 
	gETH_HLEN
))

515  -
	gEINVAL
;

517 
	g‘h
 = 
‘h_hdr
(
skb
);

518 
	g‘h”_ty³
 = 
‘h
->
h_´Ùo
;

520 
	gËn
 = 
skb
->
Ën
;

522 
skb_puÎ
(
skb
, 
ETH_HLEN
);

524 
	gmsdu
 = (
msdu_hdr
 *)
skb_push
(
skb
, 
MSDU_HLEN
);

526 
SLSI_ETHER_COPY
(
msdu
->
da
, 
‘h
->
h_de¡
);

527 
SLSI_ETHER_COPY
(
msdu
->
§
, 
‘h
->
h_sourû
);

528 
	gmsdu
->
	gËngth
 = 
htÚs
(
Ën
 - 
ETH_HLEN
 + 
MSDU_LENGTH
);

529 
memıy
(&
msdu
->
¢­
, 
rfc1042_h—d”
, (
›“80211_¢­_hdr
));

530 
	gmsdu
->
	g‘h”_ty³
 = 
‘h”_ty³
;

535 
šlše
 
u32
 
¦si_g‘_ûÁ”_äeq1
(
¦si_dev
 *
sdev
, 
u16
 
chªn_šfo
, u16 
ûÁ”_äeq
)

537 
u32
 
	gûÁ”_äeq1
 = 0x0000;

539 
SLSI_UNUSED_PARAMETER
(
sdev
);

541 
	gchªn_šfo
 & 0xFF) {

543 
ûÁ”_äeq1
 = 
ûÁ”_äeq
 - 20 * ((
chªn_šfo
 & 0xFF00) >> 8) + 10;

546 
ûÁ”_äeq1
 = 
ûÁ”_äeq
 - 20 * ((
chªn_šfo
 & 0xFF00) >> 8) + 30;

551  
	gûÁ”_äeq1
;

560 
šlše
 
¡¹ošt
(cÚ¡ *
s
, *
»s
)

562 
	gba£
 = 10;

564 ià(
¡¾’
(
s
) > 2)

565 ià(
	gs
[0] =ğ'0' && (
s
[1] == 'x' || s[1] == 'X'))

566 
ba£
 = 16;

567  
k¡¹ošt
(
s
, 
ba£
, 
»s
);

570 
šlše
 
u8
 *
¦si_mem_dup
(u8 *
¤c
, 
size_t
 
Ën
)

572 
u8
 *
	gde¡
;

574 ià(!
	g¤c
 || !
	gËn
)

575  
	gNULL
;

577 
	gde¡
 = 
km®loc
(
Ën
, 
GFP_KERNEL
);

578 ià(!
	gde¡
)

579  
	gNULL
;

580 
memıy
(
de¡
, 
¤c
, 
Ën
);

581  
	gde¡
;

584 
šlše
 
¦si_g‘_¿ndom_by‹s
(
u8
 *
by‹_bufãr
, 
u32
 
bufãr_Ën
)

586  
g‘_¿ndom_by‹s
(
by‹_bufãr
, 
bufãr_Ën
);

589 
šlše
 
¦si_ut_Æa_g‘_u8
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u8
 *
v®
)

591 ià(
Æa_Ën
(
©Œ
è>ğ(
u8
)) {

592 *
v®
 = 
Æa_g‘_u8
(
©Œ
);

595  -
	gEINVAL
;

598 
šlše
 
¦si_ut_Æa_g‘_u16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u16
 *
v®
)

600 ià(
Æa_Ën
(
©Œ
è>ğ(
u16
)) {

601 *
v®
 = 
Æa_g‘_u16
(
©Œ
);

604  -
	gEINVAL
;

608 
šlše
 
¦si_ut_Æa_g‘_u32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u32
 *
v®
)

610 ià(
Æa_Ën
(
©Œ
è>ğ(
u32
)) {

611 *
v®
 = 
Æa_g‘_u32
(
©Œ
);

614  -
	gEINVAL
;

617 
šlše
 
¦si_ut_Æa_g‘_u64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u64
 *
v®
)

619 ià(
Æa_Ën
(
©Œ
è>ğ(
u64
)) {

620 *
v®
 = 
Æa_g‘_u64
(
©Œ
);

623  -
	gEINVAL
;

627 
šlše
 
¦si_ut_Æa_g‘_s8
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s8
 *
v®
)

629 ià(
Æa_Ën
(
©Œ
è>ğ(
s8
)) {

630 *
v®
 = 
Æa_g‘_s8
(
©Œ
);

633  -
	gEINVAL
;

636 
šlše
 
¦si_ut_Æa_g‘_s16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s16
 *
v®
)

638 ià(
Æa_Ën
(
©Œ
è>ğ(
s16
)) {

639 *
v®
 = 
Æa_g‘_s16
(
©Œ
);

642  -
	gEINVAL
;

645 
šlše
 
¦si_ut_Æa_g‘_s32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s32
 *
v®
)

647 ià(
Æa_Ën
(
©Œ
è>ğ(
s32
)) {

648 *
v®
 = 
Æa_g‘_s32
(
©Œ
);

651  -
	gEINVAL
;

654 
šlše
 
¦si_ut_Æa_g‘_s64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s64
 *
v®
)

656 ià(
Æa_Ën
(
©Œ
è>ğ(
s64
)) {

657 *
v®
 = 
Æa_g‘_s64
(
©Œ
);

660  -
	gEINVAL
;

663 
šlše
 
¦si_ut_Æa_g‘_be16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__be16
 *
v®
)

665 ià(
Æa_Ën
(
©Œ
è>ğ(
__be16
)) {

666 *
v®
 = 
Æa_g‘_be16
(
©Œ
);

669  -
	gEINVAL
;

672 
šlše
 
¦si_ut_Æa_g‘_be32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__be32
 *
v®
)

674 ià(
Æa_Ën
(
©Œ
è>ğ(
__be32
)) {

675 *
v®
 = 
Æa_g‘_be32
(
©Œ
);

678  -
	gEINVAL
;

681 
šlše
 
¦si_ut_Æa_g‘_be64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__be64
 *
v®
)

683 ià(
Æa_Ën
(
©Œ
è>ğ(
__be64
)) {

684 *
v®
 = 
Æa_g‘_be64
(
©Œ
);

687  -
	gEINVAL
;

690 
šlše
 
¦si_ut_Æa_g‘_Ë16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__Ë16
 *
v®
)

692 ià(
Æa_Ën
(
©Œ
è>ğ(
__Ë16
)) {

693 *
v®
 = 
Æa_g‘_Ë16
(
©Œ
);

696  -
	gEINVAL
;

699 
šlše
 
¦si_ut_Æa_g‘_Ë32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__Ë32
 *
v®
)

701 ià(
Æa_Ën
(
©Œ
è>ğ(
__Ë32
)) {

702 *
v®
 = 
Æa_g‘_Ë32
(
©Œ
);

705  -
	gEINVAL
;

708 
šlše
 
¦si_ut_Æa_g‘_Ë64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__Ë64
 *
v®
)

710 ià(
Æa_Ën
(
©Œ
è>ğ(
__Ë64
)) {

711 *
v®
 = 
Æa_g‘_Ë64
(
©Œ
);

714  -
	gEINVAL
;

717 
šlše
 
¦si_ut_Æa_g‘_d©a
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
size_t
 
size
, *
v®
)

719 ià(
Æa_Ën
(
©Œ
è>ğ
size
) {

720 
memıy
(
v®
, 
Æa_d©a
(
©Œ
), 
size
);

723  -
	gEINVAL
;

726 
šlše
 
Ãt_deviû
 *
¦si_ndev_vif_2_Ãt_deviû
(
Ãtdev_vif
 *
ndev_vif
)

728 
	gadd»ss
 = ()
ndev_vif
;

729 
	goff£t
 = 
ALIGN
((
Ãt_deviû
), 
NETDEV_ALIGN
);

731 ià(
	gadd»ss
 < 
	goff£t
)

732  
	gNULL
;

733  (
	gÃt_deviû
 *)((*)
	gndev_vif
 - 
	goff£t
);

736 
šlše
 
g‘_k”Ãl_time¡amp
(*
time
)

738 
time¥ec64
 
	gtv
;

740 
ktime_g‘_ts64
(&
tv
);

741 
	gtime
[0] = 
tv
.
tv_£c
;

742 
	gtime
[1] = 
tv
.
tv_n£c
;

745 
šlše
 
fœmw¬e_»ad
(cÚ¡ 
fœmw¬e
 *
fœm
, *
de¡
, 
size_t
 
size
, *
off£t
)

747 ià(
	gfœm
->
	gsize
 - *
	goff£t
 < size)

748  -
	gEINVAL
;

750 
memıy
(
de¡
, 
fœm
->
d©a
 + *
off£t
, 
size
);

751 *
	goff£t
 = *
off£t
 + 
size
;

752  
	gsize
;

755 #ifdeà
__ılu¥lus


	@wl_result.h

9 #iâdeà
WL_RESULT_H__


10 
	#WL_RESULT_H__


	)

12 
	#C¤ResuÉ
 
u16


	)

14 
	#CSR_RESULT_SUCCESS
 ((
C¤ResuÉ
)0x0000)

	)

15 
	#CSR_RESULT_FAILURE
 ((
C¤ResuÉ
)0xffff)

	)

17 
	#CSR_WIFI_HIP_RESULT_INVALID_VALUE
 ((
C¤ResuÉ
)1è

	)

18 
	#CSR_WIFI_HIP_RESULT_NO_DEVICE
 ((
C¤ResuÉ
)2è

	)

19 
	#CSR_WIFI_HIP_RESULT_NO_SPACE
 ((
C¤ResuÉ
)3è

	)

20 
	#CSR_WIFI_HIP_RESULT_NO_MEMORY
 ((
C¤ResuÉ
)4è

	)

21 
	#CSR_WIFI_HIP_RESULT_RANGE
 ((
C¤ResuÉ
)5è

	)

22 
	#CSR_WIFI_HIP_RESULT_NOT_FOUND
 ((
C¤ResuÉ
)6è

	)

23 
	#CSR_WIFI_PS_RESULT_FULL
 ((
C¤ResuÉ
)7è

	)

24 
	#CSR_WIFI_PS_QSIG_NONE
 ((
C¤ResuÉ
)8è

	)

25 
	#CSR_WIFI_PS_QSIG_NO_SPACE
 ((
C¤ResuÉ
)9è

	)

26 
	#CSR_WIFI_PS_QS_PAUSED_UNTIL_BOT_UPDATE
 ((
C¤ResuÉ
)10è

	)

	@../../../misc/samsung/scsc/scsc_wlbtd.h

6 #iâdeà
__SCSC_WLBTD_H


7 
	#__SCSC_WLBTD_H


	)

8 
	~<Ãt/g’‘lšk.h
>

9 
	~<scsc/scsc_logršg.h
>

10 
	~<scsc/scsc_mx.h
>

11 
	~<scsc/scsc_log_cŞËùÜ.h
>

14 
	#MEMDUMP_FILE_FOR_RECOVERY
 2

	)

16 
	#MEMDUMP_FILE_KERNEL_PANIC
 3

	)

23 
	e©Œibu‹s
 {

25 
	mATTR_UNSPEC
,

27 
	mATTR_STR
,

28 
	mATTR_INT
,

29 
	mATTR_PATH
,

30 
	mATTR_CONTENT
,

31 
	mATTR_INT8
,

34 
	m__ATTR_MAX
,

40 
	eev’ts
 {

42 
	mEVENT_UNSPEC
,

44 
	mEVENT_SCSC
,

45 
	mEVENT_SYSTEM_PROPERTY
,

46 
	mEVENT_WRITE_FILE
,

47 
	mEVENT_SABLE
,

48 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

49 
	mEVENT_CHIPSET_LOGGING
,

52 
	m__EVENT_MAX
,

55 
	escsc_wlbtd_»¥Ú£_codes
 {

58 
	mSCSC_WLBTD_ERR_PARSE_FAILED
,

61 
	mSCSC_WLBTD_FW_PANIC_TAR_GENERATED
,

62 
	mSCSC_WLBTD_FW_PANIC_ERR_SCRIPT_FILE_NOT_FOUND
,

63 
	mSCSC_WLBTD_FW_PANIC_ERR_NO_DEV
,

64 
	mSCSC_WLBTD_FW_PANIC_ERR_MMAP
,

65 
	mSCSC_WLBTD_FW_PANIC_ERR_SABLE_FILE
,

66 
	mSCSC_WLBTD_FW_PANIC_ERR_TAR
,

69 
	mSCSC_WLBTD_OTHER_SBL_GENERATED
,

70 
	mSCSC_WLBTD_OTHER_TAR_GENERATED
,

71 
	mSCSC_WLBTD_OTHER_ERR_SCRIPT_FILE_NOT_FOUND
,

72 
	mSCSC_WLBTD_OTHER_ERR_NO_DEV
,

73 
	mSCSC_WLBTD_OTHER_ERR_MMAP
,

74 
	mSCSC_WLBTD_OTHER_ERR_SABLE_FILE
,

75 
	mSCSC_WLBTD_OTHER_ERR_TAR
,

76 
	mSCSC_WLBTD_OTHER_IGNORE_TRIGGER
,

79 
	mSCSC_WLBTD_LAST_RESPONSE_CODE
,

82 cÚ¡ 
g’l_muÉiÿ¡_group
 
	gscsc_mcg½
[] = {

83 { .
Çme
 = "scsc_mdp_grp", },

85 
scsc_wlbtd_š™
();

86 
scsc_wlbtd_deš™
();

87 
ÿÎ_wlbtd
(cÚ¡ *
süt_·th
);

88 
wlbtd_wr™e_fe
(cÚ¡ *
·th
, cÚ¡ *
cÚ‹Á
);

89 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

90 
wlbtd_ch£t_loggšg
(cÚ¡ *
cÚ‹Á
, 
size_t
 
by‹s
, 
boŞ
 
ov”_mm­
);

92 
ÿÎ_wlbtd_§bË
(
u8
 
Œigg”_code
, 
u16
 
»asÚ_code
);

93 
scsc_wlbtd_wa™_fÜ_§bË_loggšg
();

94 
scsc_wlbtd_g‘_ªd_´št_bud_ty³
();

	@/usr/include/linux/errno.h

1 
	~<asm/”ºo.h
>

	@/usr/include/linux/fs.h

2 #iâdeà
_LINUX_FS_H


3 
	#_LINUX_FS_H


	)

13 
	~<lšux/lim™s.h
>

14 
	~<lšux/ioùl.h
>

15 
	~<lšux/ty³s.h
>

16 
	~<lšux/fsüy±.h
>

19 
	~<lšux/mouÁ.h
>

32 #undeà
NR_OPEN


33 
	#INR_OPEN_CUR
 1024

	)

34 
	#INR_OPEN_MAX
 4096

	)

36 
	#BLOCK_SIZE_BITS
 10

	)

37 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

39 
	#SEEK_SET
 0

	)

40 
	#SEEK_CUR
 1

	)

41 
	#SEEK_END
 2

	)

42 
	#SEEK_DATA
 3

	)

43 
	#SEEK_HOLE
 4

	)

44 
	#SEEK_MAX
 
SEEK_HOLE


	)

46 
	#RENAME_NOREPLACE
 (1 << 0è

	)

47 
	#RENAME_EXCHANGE
 (1 << 1è

	)

48 
	#RENAME_WHITEOUT
 (1 << 2è

	)

50 
	sfe_şÚe_¿nge
 {

51 
__s64
 
	m¤c_fd
;

52 
__u64
 
	m¤c_off£t
;

53 
__u64
 
	m¤c_Ëngth
;

54 
__u64
 
	mde¡_off£t
;

57 
	sf¡rim_¿nge
 {

58 
__u64
 
	m¡¬t
;

59 
__u64
 
	mËn
;

60 
__u64
 
	mmšËn
;

64 
	#FILE_DEDUPE_RANGE_SAME
 0

	)

65 
	#FILE_DEDUPE_RANGE_DIFFERS
 1

	)

68 
	sfe_dedu³_¿nge_šfo
 {

69 
__s64
 
	mde¡_fd
;

70 
__u64
 
	mde¡_off£t
;

71 
__u64
 
	mby‹s_dedu³d
;

78 
__s32
 
	m¡©us
;

79 
__u32
 
	m»£rved
;

83 
	sfe_dedu³_¿nge
 {

84 
__u64
 
	m¤c_off£t
;

85 
__u64
 
	m¤c_Ëngth
;

86 
__u16
 
	mde¡_couÁ
;

87 
__u16
 
	m»£rved1
;

88 
__u32
 
	m»£rved2
;

89 
fe_dedu³_¿nge_šfo
 
	mšfo
[0];

93 
	sfes_¡©_¡ruù
 {

94 
	mÄ_fes
;

95 
	mÄ_ä“_fes
;

96 
	mmax_fes
;

99 
	sšodes_¡©_t
 {

100 
	mÄ_šodes
;

101 
	mÄ_unu£d
;

102 
	mdummy
[5];

106 
	#NR_FILE
 8192

	)

111 
	sfsx©Œ
 {

112 
__u32
 
	mfsx_xæags
;

113 
__u32
 
	mfsx_extsize
;

114 
__u32
 
	mfsx_Ãx‹Ás
;

115 
__u32
 
	mfsx_´ojid
;

116 
__u32
 
	mfsx_cowextsize
;

117 
	mfsx_·d
[8];

123 
	#FS_XFLAG_REALTIME
 0x00000001

	)

124 
	#FS_XFLAG_PREALLOC
 0x00000002

	)

125 
	#FS_XFLAG_IMMUTABLE
 0x00000008

	)

126 
	#FS_XFLAG_APPEND
 0x00000010

	)

127 
	#FS_XFLAG_SYNC
 0x00000020

	)

128 
	#FS_XFLAG_NOATIME
 0x00000040

	)

129 
	#FS_XFLAG_NODUMP
 0x00000080

	)

130 
	#FS_XFLAG_RTINHERIT
 0x00000100

	)

131 
	#FS_XFLAG_PROJINHERIT
 0x00000200

	)

132 
	#FS_XFLAG_NOSYMLINKS
 0x00000400

	)

133 
	#FS_XFLAG_EXTSIZE
 0x00000800

	)

134 
	#FS_XFLAG_EXTSZINHERIT
 0x00001000

	)

135 
	#FS_XFLAG_NODEFRAG
 0x00002000

	)

136 
	#FS_XFLAG_FILESTREAM
 0x00004000

	)

137 
	#FS_XFLAG_DAX
 0x00008000

	)

138 
	#FS_XFLAG_COWEXTSIZE
 0x00010000

	)

139 
	#FS_XFLAG_HASATTR
 0x80000000

	)

144 
	#BLKROSET
 
	`_IO
(0x12,93è

	)

145 
	#BLKROGET
 
	`_IO
(0x12,94è

	)

146 
	#BLKRRPART
 
	`_IO
(0x12,95è

	)

147 
	#BLKGETSIZE
 
	`_IO
(0x12,96è

	)

148 
	#BLKFLSBUF
 
	`_IO
(0x12,97è

	)

149 
	#BLKRASET
 
	`_IO
(0x12,98è

	)

150 
	#BLKRAGET
 
	`_IO
(0x12,99è

	)

151 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

152 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

153 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

154 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

155 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

157 
	#BLKPG
 
	`_IO
(0x12,105)

	)

161 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

162 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

167 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

168 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

169 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

170 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_Œaû_£tup
)

	)

171 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

172 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

173 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

174 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

175 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

176 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

177 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

178 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

179 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

180 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

181 
	#BLKROTATIONAL
 
	`_IO
(0x12,126)

	)

182 
	#BLKZEROOUT
 
	`_IO
(0x12,127)

	)

183 
	#BLKGETDISKSEQ
 
	`_IOR
(0x12,128,
__u64
)

	)

189 
	#BMAP_IOCTL
 1

	)

190 
	#FIBMAP
 
	`_IO
(0x00,1è

	)

191 
	#FIGETBSZ
 
	`_IO
(0x00,2è

	)

192 
	#FIFREEZE
 
	`_IOWR
('X', 119, è

	)

193 
	#FITHAW
 
	`_IOWR
('X', 120, è

	)

194 
	#FITRIM
 
	`_IOWR
('X', 121, 
f¡rim_¿nge
è

	)

195 
	#FICLONE
 
	`_IOW
(0x94, 9, )

	)

196 
	#FICLONERANGE
 
	`_IOW
(0x94, 13, 
fe_şÚe_¿nge
)

	)

197 
	#FIDEDUPERANGE
 
	`_IOWR
(0x94, 54, 
fe_dedu³_¿nge
)

	)

199 
	#FSLABEL_MAX
 256

	)

201 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

202 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

203 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

204 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

205 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
f›m­
)

	)

206 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

207 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

208 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

209 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

210 
	#FS_IOC_FSGETXATTR
 
	`_IOR
('X', 31, 
fsx©Œ
)

	)

211 
	#FS_IOC_FSSETXATTR
 
	`_IOW
('X', 32, 
fsx©Œ
)

	)

212 
	#FS_IOC_GETFSLABEL
 
	`_IOR
(0x94, 49, [
FSLABEL_MAX
])

	)

213 
	#FS_IOC_SETFSLABEL
 
	`_IOW
(0x94, 50, [
FSLABEL_MAX
])

	)

235 
	#FS_SECRM_FL
 0x00000001

	)

236 
	#FS_UNRM_FL
 0x00000002

	)

237 
	#FS_COMPR_FL
 0x00000004

	)

238 
	#FS_SYNC_FL
 0x00000008

	)

239 
	#FS_IMMUTABLE_FL
 0x00000010

	)

240 
	#FS_APPEND_FL
 0x00000020

	)

241 
	#FS_NODUMP_FL
 0x00000040

	)

242 
	#FS_NOATIME_FL
 0x00000080

	)

244 
	#FS_DIRTY_FL
 0x00000100

	)

245 
	#FS_COMPRBLK_FL
 0x00000200

	)

246 
	#FS_NOCOMP_FL
 0x00000400

	)

248 
	#FS_ENCRYPT_FL
 0x00000800

	)

249 
	#FS_BTREE_FL
 0x00001000

	)

250 
	#FS_INDEX_FL
 0x00001000

	)

251 
	#FS_IMAGIC_FL
 0x00002000

	)

252 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

253 
	#FS_NOTAIL_FL
 0x00008000

	)

254 
	#FS_DIRSYNC_FL
 0x00010000

	)

255 
	#FS_TOPDIR_FL
 0x00020000

	)

256 
	#FS_HUGE_FILE_FL
 0x00040000

	)

257 
	#FS_EXTENT_FL
 0x00080000

	)

258 
	#FS_VERITY_FL
 0x00100000

	)

259 
	#FS_EA_INODE_FL
 0x00200000

	)

260 
	#FS_EOFBLOCKS_FL
 0x00400000

	)

261 
	#FS_NOCOW_FL
 0x00800000

	)

262 
	#FS_DAX_FL
 0x02000000

	)

263 
	#FS_INLINE_DATA_FL
 0x10000000

	)

264 
	#FS_PROJINHERIT_FL
 0x20000000

	)

265 
	#FS_CASEFOLD_FL
 0x40000000

	)

266 
	#FS_RESERVED_FL
 0x80000000

	)

268 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

269 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

272 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

273 
	#SYNC_FILE_RANGE_WRITE
 2

	)

274 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

275 
	#SYNC_FILE_RANGE_WRITE_AND_WAIT
 (
SYNC_FILE_RANGE_WRITE
 | \

276 
SYNC_FILE_RANGE_WAIT_BEFORE
 | \

277 
SYNC_FILE_RANGE_WAIT_AFTER
)

	)

283 
	t__b™wi£
 
	t__k”Ãl_rwf_t
;

286 
	#RWF_HIPRI
 ((
__k”Ãl_rwf_t
)0x00000001)

	)

289 
	#RWF_DSYNC
 ((
__k”Ãl_rwf_t
)0x00000002)

	)

292 
	#RWF_SYNC
 ((
__k”Ãl_rwf_t
)0x00000004)

	)

295 
	#RWF_NOWAIT
 ((
__k”Ãl_rwf_t
)0x00000008)

	)

298 
	#RWF_APPEND
 ((
__k”Ãl_rwf_t
)0x00000010)

	)

301 
	#RWF_SUPPORTED
 (
RWF_HIPRI
 | 
RWF_DSYNC
 | 
RWF_SYNC
 | 
RWF_NOWAIT
 |\

302 
RWF_APPEND
)

	)

	@/usr/include/linux/if.h

20 #iâdeà
_LINUX_IF_H


21 
	#_LINUX_IF_H


	)

23 
	~<lšux/libc-com·t.h
>

24 
	~<lšux/ty³s.h
>

25 
	~<lšux/sock‘.h
>

28 
	~<sys/sock‘.h
>

30 #ià
__UAPI_DEF_IF_IFNAMSIZ


31 
	#IFNAMSIZ
 16

	)

33 
	#IFALIASZ
 256

	)

34 
	#ALTIFNAMSIZ
 128

	)

35 
	~<lšux/hdlc/ioùl.h
>

38 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 != 0 || \

39 
	g__UAPI_DEF_IF_NET_DEVICE_FLAGS
 != 0

80 
	eÃt_deviû_æags
 {

82 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


83 
IFF_UP
 = 1<<0,

84 
	mIFF_BROADCAST
 = 1<<1,

85 
	mIFF_DEBUG
 = 1<<2,

86 
	mIFF_LOOPBACK
 = 1<<3,

87 
	mIFF_POINTOPOINT
 = 1<<4,

88 
	mIFF_NOTRAILERS
 = 1<<5,

89 
	mIFF_RUNNING
 = 1<<6,

90 
	mIFF_NOARP
 = 1<<7,

91 
	mIFF_PROMISC
 = 1<<8,

92 
	mIFF_ALLMULTI
 = 1<<9,

93 
	mIFF_MASTER
 = 1<<10,

94 
	mIFF_SLAVE
 = 1<<11,

95 
	mIFF_MULTICAST
 = 1<<12,

96 
	mIFF_PORTSEL
 = 1<<13,

97 
	mIFF_AUTOMEDIA
 = 1<<14,

98 
	mIFF_DYNAMIC
 = 1<<15,

100 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


101 
	mIFF_LOWER_UP
 = 1<<16,

102 
	mIFF_DORMANT
 = 1<<17,

103 
	mIFF_ECHO
 = 1<<18,

109 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


110 
	#IFF_UP
 
IFF_UP


	)

111 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

112 
	#IFF_DEBUG
 
IFF_DEBUG


	)

113 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

114 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

115 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

116 
	#IFF_RUNNING
 
IFF_RUNNING


	)

117 
	#IFF_NOARP
 
IFF_NOARP


	)

118 
	#IFF_PROMISC
 
IFF_PROMISC


	)

119 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

120 
	#IFF_MASTER
 
IFF_MASTER


	)

121 
	#IFF_SLAVE
 
IFF_SLAVE


	)

122 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

123 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

124 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

125 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

128 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


129 
	#IFF_LOWER_UP
 
IFF_LOWER_UP


	)

130 
	#IFF_DORMANT
 
IFF_DORMANT


	)

131 
	#IFF_ECHO
 
IFF_ECHO


	)

134 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

135 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

137 
	#IF_GET_IFACE
 0x0001

	)

138 
	#IF_GET_PROTO
 0x0002

	)

141 
	#IF_IFACE_V35
 0x1000

	)

142 
	#IF_IFACE_V24
 0x1001

	)

143 
	#IF_IFACE_X21
 0x1002

	)

144 
	#IF_IFACE_T1
 0x1003

	)

145 
	#IF_IFACE_E1
 0x1004

	)

146 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

147 
	#IF_IFACE_X21D
 0x1006

	)

150 
	#IF_PROTO_HDLC
 0x2000

	)

151 
	#IF_PROTO_PPP
 0x2001

	)

152 
	#IF_PROTO_CISCO
 0x2002

	)

153 
	#IF_PROTO_FR
 0x2003

	)

154 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

155 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

156 
	#IF_PROTO_X25
 0x2006

	)

157 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

158 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

159 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

160 
	#IF_PROTO_FR_PVC
 0x200A

	)

161 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

162 
	#IF_PROTO_RAW
 0x200C

	)

166 
	mIF_OPER_UNKNOWN
,

167 
	mIF_OPER_NOTPRESENT
,

168 
	mIF_OPER_DOWN
,

169 
	mIF_OPER_LOWERLAYERDOWN
,

170 
	mIF_OPER_TESTING
,

171 
	mIF_OPER_DORMANT
,

172 
	mIF_OPER_UP
,

177 
	mIF_LINK_MODE_DEFAULT
,

178 
	mIF_LINK_MODE_DORMANT
,

179 
	mIF_LINK_MODE_TESTING
,

193 #ià
__UAPI_DEF_IF_IFMAP


194 
	sifm­
 {

195 
	mmem_¡¬t
;

196 
	mmem_’d
;

197 
	mba£_addr
;

198 
	mœq
;

199 
	mdma
;

200 
	mpÜt
;

205 
	sif_£‰šgs
 {

206 
	mty³
;

207 
	msize
;

210 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

211 
cisco_´Ùo
 *
	mcisco
;

212 
ä_´Ùo
 *
	mä
;

213 
ä_´Ùo_pvc
 *
	mä_pvc
;

214 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

215 
x25_hdlc_´Ùo
 *
	mx25
;

218 
sync_£rŸl_£‰šgs
 *
	msync
;

219 
‹1_£‰šgs
 *
	m‹1
;

220 } 
	mifs_ifsu
;

231 #ià
__UAPI_DEF_IF_IFREQ


232 
	siäeq
 {

233 
	#IFHWADDRLEN
 6

	)

236 
	miän_Çme
[
IFNAMSIZ
];

237 } 
	miä_iän
;

240 
sockaddr
 
	miäu_addr
;

241 
sockaddr
 
	miäu_d¡addr
;

242 
sockaddr
 
	miäu_brßdaddr
;

243 
sockaddr
 
	miäu_Ãtmask
;

244 
sockaddr
 
	miäu_hwaddr
;

245 
	miäu_æags
;

246 
	miäu_iv®ue
;

247 
	miäu_mtu
;

248 
ifm­
 
	miäu_m­
;

249 
	miäu_¦ave
[
IFNAMSIZ
];

250 
	miäu_ÃwÇme
[
IFNAMSIZ
];

251 * 
	miäu_d©a
;

252 
if_£‰šgs
 
	miäu_£‰šgs
;

253 } 
	miä_iäu
;

257 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

258 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

259 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

260 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

261 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

262 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

263 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

264 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

265 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

266 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

267 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

268 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

269 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

270 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

271 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

272 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

273 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

283 #ià
__UAPI_DEF_IF_IFCONF


284 
	sifcÚf
 {

285 
	mifc_Ën
;

287 *
	mifcu_buf
;

288 
iäeq
 *
	mifcu_»q
;

289 } 
	mifc_ifcu
;

293 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

294 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_ether.h

22 #iâdeà
_LINUX_IF_ETHER_H


23 
	#_LINUX_IF_ETHER_H


	)

25 
	~<lšux/ty³s.h
>

32 
	#ETH_ALEN
 6

	)

33 
	#ETH_TLEN
 2

	)

34 
	#ETH_HLEN
 14

	)

35 
	#ETH_ZLEN
 60

	)

36 
	#ETH_DATA_LEN
 1500

	)

37 
	#ETH_FRAME_LEN
 1514

	)

38 
	#ETH_FCS_LEN
 4

	)

40 
	#ETH_MIN_MTU
 68

	)

41 
	#ETH_MAX_MTU
 0xFFFFU

	)

47 
	#ETH_P_LOOP
 0x0060

	)

48 
	#ETH_P_PUP
 0x0200

	)

49 
	#ETH_P_PUPAT
 0x0201

	)

50 
	#ETH_P_TSN
 0x22F0

	)

51 
	#ETH_P_ERSPAN2
 0x22EB

	)

52 
	#ETH_P_IP
 0x0800

	)

53 
	#ETH_P_X25
 0x0805

	)

54 
	#ETH_P_ARP
 0x0806

	)

55 
	#ETH_P_BPQ
 0x08FF

	)

56 
	#ETH_P_IEEEPUP
 0x0a00

	)

57 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

58 
	#ETH_P_BATMAN
 0x4305

	)

59 
	#ETH_P_DEC
 0x6000

	)

60 
	#ETH_P_DNA_DL
 0x6001

	)

61 
	#ETH_P_DNA_RC
 0x6002

	)

62 
	#ETH_P_DNA_RT
 0x6003

	)

63 
	#ETH_P_LAT
 0x6004

	)

64 
	#ETH_P_DIAG
 0x6005

	)

65 
	#ETH_P_CUST
 0x6006

	)

66 
	#ETH_P_SCA
 0x6007

	)

67 
	#ETH_P_TEB
 0x6558

	)

68 
	#ETH_P_RARP
 0x8035

	)

69 
	#ETH_P_ATALK
 0x809B

	)

70 
	#ETH_P_AARP
 0x80F3

	)

71 
	#ETH_P_8021Q
 0x8100

	)

72 
	#ETH_P_ERSPAN
 0x88BE

	)

73 
	#ETH_P_IPX
 0x8137

	)

74 
	#ETH_P_IPV6
 0x86DD

	)

75 
	#ETH_P_PAUSE
 0x8808

	)

76 
	#ETH_P_SLOW
 0x8809

	)

77 
	#ETH_P_WCCP
 0x883E

	)

79 
	#ETH_P_MPLS_UC
 0x8847

	)

80 
	#ETH_P_MPLS_MC
 0x8848

	)

81 
	#ETH_P_ATMMPOA
 0x884ø

	)

82 
	#ETH_P_PPP_DISC
 0x8863

	)

83 
	#ETH_P_PPP_SES
 0x8864

	)

84 
	#ETH_P_LINK_CTL
 0x886ø

	)

85 
	#ETH_P_ATMFATE
 0x8884

	)

88 
	#ETH_P_PAE
 0x888E

	)

89 
	#ETH_P_AOE
 0x88A2

	)

90 
	#ETH_P_8021AD
 0x88A8

	)

91 
	#ETH_P_802_EX1
 0x88B5

	)

92 
	#ETH_P_PREAUTH
 0x88C7

	)

93 
	#ETH_P_TIPC
 0x88CA

	)

94 
	#ETH_P_LLDP
 0x88CC

	)

95 
	#ETH_P_MRP
 0x88E3

	)

96 
	#ETH_P_MACSEC
 0x88E5

	)

97 
	#ETH_P_8021AH
 0x88E7

	)

98 
	#ETH_P_MVRP
 0x88F5

	)

99 
	#ETH_P_1588
 0x88F7

	)

100 
	#ETH_P_NCSI
 0x88F8

	)

101 
	#ETH_P_PRP
 0x88FB

	)

102 
	#ETH_P_CFM
 0x8902

	)

103 
	#ETH_P_FCOE
 0x8906

	)

104 
	#ETH_P_IBOE
 0x8915

	)

105 
	#ETH_P_TDLS
 0x890D

	)

106 
	#ETH_P_FIP
 0x8914

	)

107 
	#ETH_P_80221
 0x8917

	)

108 
	#ETH_P_HSR
 0x892F

	)

109 
	#ETH_P_NSH
 0x894F

	)

110 
	#ETH_P_LOOPBACK
 0x9000

	)

111 
	#ETH_P_QINQ1
 0x9100

	)

112 
	#ETH_P_QINQ2
 0x9200

	)

113 
	#ETH_P_QINQ3
 0x9300

	)

114 
	#ETH_P_EDSA
 0xDADA

	)

115 
	#ETH_P_DSA_8021Q
 0xDADB

	)

116 
	#ETH_P_IFE
 0xED3E

	)

117 
	#ETH_P_AF_IUCV
 0xFBFB

	)

119 
	#ETH_P_802_3_MIN
 0x0600

	)

126 
	#ETH_P_802_3
 0x0001

	)

127 
	#ETH_P_AX25
 0x0002

	)

128 
	#ETH_P_ALL
 0x0003

	)

129 
	#ETH_P_802_2
 0x0004

	)

130 
	#ETH_P_SNAP
 0x0005

	)

131 
	#ETH_P_DDCMP
 0x0006

	)

132 
	#ETH_P_WAN_PPP
 0x0007

	)

133 
	#ETH_P_PPP_MP
 0x0008

	)

134 
	#ETH_P_LOCALTALK
 0x0009

	)

135 
	#ETH_P_CAN
 0x000C

	)

136 
	#ETH_P_CANFD
 0x000D

	)

137 
	#ETH_P_PPPTALK
 0x0010

	)

138 
	#ETH_P_TR_802_2
 0x0011

	)

139 
	#ETH_P_MOBITEX
 0x0015

	)

140 
	#ETH_P_CONTROL
 0x0016

	)

141 
	#ETH_P_IRDA
 0x0017

	)

142 
	#ETH_P_ECONET
 0x0018

	)

143 
	#ETH_P_HDLC
 0x0019

	)

144 
	#ETH_P_ARCNET
 0x001A

	)

145 
	#ETH_P_DSA
 0x001B

	)

146 
	#ETH_P_TRAILER
 0x001C

	)

147 
	#ETH_P_PHONET
 0x00F5

	)

148 
	#ETH_P_IEEE802154
 0x00F6

	)

149 
	#ETH_P_CAIF
 0x00F7

	)

150 
	#ETH_P_XDSA
 0x00F8

	)

151 
	#ETH_P_MAP
 0x00F9

	)

154 
	#ETH_P_MCTP
 0x00FA

	)

163 #iâdeà
__UAPI_DEF_ETHHDR


164 
	#__UAPI_DEF_ETHHDR
 1

	)

167 #ià
__UAPI_DEF_ETHHDR


168 
	s‘hhdr
 {

169 
	mh_de¡
[
ETH_ALEN
];

170 
	mh_sourû
[
ETH_ALEN
];

171 
__be16
 
	mh_´Ùo
;

172 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/igmp.h

17 #iâdeà
_LINUX_IGMP_H


18 
	#_LINUX_IGMP_H


	)

20 
	~<lšux/ty³s.h
>

21 
	~<asm/by‹Üd”.h
>

31 
	sigmphdr
 {

32 
__u8
 
	mty³
;

33 
__u8
 
	mcode
;

34 
__sum16
 
	mcsum
;

35 
__be32
 
	mgroup
;

39 
	#IGMPV3_MODE_IS_INCLUDE
 1

	)

40 
	#IGMPV3_MODE_IS_EXCLUDE
 2

	)

41 
	#IGMPV3_CHANGE_TO_INCLUDE
 3

	)

42 
	#IGMPV3_CHANGE_TO_EXCLUDE
 4

	)

43 
	#IGMPV3_ALLOW_NEW_SOURCES
 5

	)

44 
	#IGMPV3_BLOCK_OLD_SOURCES
 6

	)

46 
	sigmpv3_g»c
 {

47 
__u8
 
	mg»c_ty³
;

48 
__u8
 
	mg»c_auxwÜds
;

49 
__be16
 
	mg»c_n¤cs
;

50 
__be32
 
	mg»c_mÿ
;

51 
__be32
 
	mg»c_¤c
[0];

54 
	sigmpv3_»pÜt
 {

55 
__u8
 
	mty³
;

56 
__u8
 
	m»sv1
;

57 
__sum16
 
	mcsum
;

58 
__be16
 
	m»sv2
;

59 
__be16
 
	mng»c
;

60 
igmpv3_g»c
 
	mg»c
[0];

63 
	sigmpv3_qu”y
 {

64 
__u8
 
	mty³
;

65 
__u8
 
	mcode
;

66 
__sum16
 
	mcsum
;

67 
__be32
 
	mgroup
;

68 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

69 
__u8
 
	mqrv
:3,

70 
	msuµ»ss
:1,

71 
	m»sv
:4;

72 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

73 
__u8
 
	m»sv
:4,

74 
	msuµ»ss
:1,

75 
	mqrv
:3;

79 
__u8
 
	mqqic
;

80 
__be16
 
	mn¤cs
;

81 
__be32
 
	m¤cs
[0];

84 
	#IGMP_HOST_MEMBERSHIP_QUERY
 0x11

	)

85 
	#IGMP_HOST_MEMBERSHIP_REPORT
 0x12

	)

86 
	#IGMP_DVMRP
 0x13

	)

87 
	#IGMP_PIM
 0x14

	)

88 
	#IGMP_TRACE
 0x15

	)

89 
	#IGMPV2_HOST_MEMBERSHIP_REPORT
 0x16

	)

90 
	#IGMP_HOST_LEAVE_MESSAGE
 0x17

	)

91 
	#IGMPV3_HOST_MEMBERSHIP_REPORT
 0x22

	)

93 
	#IGMP_MTRACE_RESP
 0x1e

	)

94 
	#IGMP_MTRACE
 0x1f

	)

96 
	#IGMP_MRDISC_ADV
 0x30

	)

102 
	#IGMP_DELAYING_MEMBER
 0x01

	)

103 
	#IGMP_IDLE_MEMBER
 0x02

	)

104 
	#IGMP_LAZY_MEMBER
 0x03

	)

105 
	#IGMP_SLEEPING_MEMBER
 0x04

	)

106 
	#IGMP_AWAKENING_MEMBER
 0x05

	)

108 
	#IGMP_MINLEN
 8

	)

110 
	#IGMP_MAX_HOST_REPORT_DELAY
 10

	)

113 
	#IGMP_TIMER_SCALE
 10

	)

116 
	#IGMP_AGE_THRESHOLD
 400

	)

120 
	#IGMP_ALL_HOSTS
 
	`htÚl
(0xE0000001L)

	)

121 
	#IGMP_ALL_ROUTER
 
	`htÚl
(0xE0000002L)

	)

122 
	#IGMPV3_ALL_MCR
 
	`htÚl
(0xE0000016L)

	)

123 
	#IGMP_LOCAL_GROUP
 
	`htÚl
(0xE0000000L)

	)

124 
	#IGMP_LOCAL_GROUP_MASK
 
	`htÚl
(0xFFFFFF00L)

	)

	@/usr/include/linux/in.h

19 #iâdeà
_LINUX_IN_H


20 
	#_LINUX_IN_H


	)

22 
	~<lšux/ty³s.h
>

23 
	~<lšux/libc-com·t.h
>

24 
	~<lšux/sock‘.h
>

26 #ià
__UAPI_DEF_IN_IPPROTO


29 
	mIPPROTO_IP
 = 0,

30 
	#IPPROTO_IP
 
IPPROTO_IP


	)

31 
	mIPPROTO_ICMP
 = 1,

32 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

33 
	mIPPROTO_IGMP
 = 2,

34 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

35 
	mIPPROTO_IPIP
 = 4,

36 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

37 
	mIPPROTO_TCP
 = 6,

38 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

39 
	mIPPROTO_EGP
 = 8,

40 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

41 
	mIPPROTO_PUP
 = 12,

42 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

43 
	mIPPROTO_UDP
 = 17,

44 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

45 
	mIPPROTO_IDP
 = 22,

46 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

47 
	mIPPROTO_TP
 = 29,

48 
	#IPPROTO_TP
 
IPPROTO_TP


	)

49 
	mIPPROTO_DCCP
 = 33,

50 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

51 
	mIPPROTO_IPV6
 = 41,

52 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

53 
	mIPPROTO_RSVP
 = 46,

54 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

55 
	mIPPROTO_GRE
 = 47,

56 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

57 
	mIPPROTO_ESP
 = 50,

58 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

59 
	mIPPROTO_AH
 = 51,

60 
	#IPPROTO_AH
 
IPPROTO_AH


	)

61 
	mIPPROTO_MTP
 = 92,

62 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

63 
	mIPPROTO_BEETPH
 = 94,

64 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

65 
	mIPPROTO_ENCAP
 = 98,

66 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

67 
	mIPPROTO_PIM
 = 103,

68 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

69 
	mIPPROTO_COMP
 = 108,

70 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

71 
	mIPPROTO_SCTP
 = 132,

72 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

73 
	mIPPROTO_UDPLITE
 = 136,

74 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

75 
	mIPPROTO_MPLS
 = 137,

76 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

77 
	mIPPROTO_ETHERNET
 = 143,

78 
	#IPPROTO_ETHERNET
 
IPPROTO_ETHERNET


	)

79 
	mIPPROTO_RAW
 = 255,

80 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

81 
	mIPPROTO_MPTCP
 = 262,

82 
	#IPPROTO_MPTCP
 
IPPROTO_MPTCP


	)

83 
	mIPPROTO_MAX


87 #ià
__UAPI_DEF_IN_ADDR


89 
	sš_addr
 {

90 
__be32
 
	ms_addr
;

94 
	#IP_TOS
 1

	)

95 
	#IP_TTL
 2

	)

96 
	#IP_HDRINCL
 3

	)

97 
	#IP_OPTIONS
 4

	)

98 
	#IP_ROUTER_ALERT
 5

	)

99 
	#IP_RECVOPTS
 6

	)

100 
	#IP_RETOPTS
 7

	)

101 
	#IP_PKTINFO
 8

	)

102 
	#IP_PKTOPTIONS
 9

	)

103 
	#IP_MTU_DISCOVER
 10

	)

104 
	#IP_RECVERR
 11

	)

105 
	#IP_RECVTTL
 12

	)

106 
	#IP_RECVTOS
 13

	)

107 
	#IP_MTU
 14

	)

108 
	#IP_FREEBIND
 15

	)

109 
	#IP_IPSEC_POLICY
 16

	)

110 
	#IP_XFRM_POLICY
 17

	)

111 
	#IP_PASSSEC
 18

	)

112 
	#IP_TRANSPARENT
 19

	)

115 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

118 
	#IP_ORIGDSTADDR
 20

	)

119 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

121 
	#IP_MINTTL
 21

	)

122 
	#IP_NODEFRAG
 22

	)

123 
	#IP_CHECKSUM
 23

	)

124 
	#IP_BIND_ADDRESS_NO_PORT
 24

	)

125 
	#IP_RECVFRAGSIZE
 25

	)

126 
	#IP_RECVERR_RFC4884
 26

	)

129 
	#IP_PMTUDISC_DONT
 0

	)

130 
	#IP_PMTUDISC_WANT
 1

	)

131 
	#IP_PMTUDISC_DO
 2

	)

132 
	#IP_PMTUDISC_PROBE
 3

	)

137 
	#IP_PMTUDISC_INTERFACE
 4

	)

141 
	#IP_PMTUDISC_OMIT
 5

	)

143 
	#IP_MULTICAST_IF
 32

	)

144 
	#IP_MULTICAST_TTL
 33

	)

145 
	#IP_MULTICAST_LOOP
 34

	)

146 
	#IP_ADD_MEMBERSHIP
 35

	)

147 
	#IP_DROP_MEMBERSHIP
 36

	)

148 
	#IP_UNBLOCK_SOURCE
 37

	)

149 
	#IP_BLOCK_SOURCE
 38

	)

150 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

151 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

152 
	#IP_MSFILTER
 41

	)

153 
	#MCAST_JOIN_GROUP
 42

	)

154 
	#MCAST_BLOCK_SOURCE
 43

	)

155 
	#MCAST_UNBLOCK_SOURCE
 44

	)

156 
	#MCAST_LEAVE_GROUP
 45

	)

157 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

158 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

159 
	#MCAST_MSFILTER
 48

	)

160 
	#IP_MULTICAST_ALL
 49

	)

161 
	#IP_UNICAST_IF
 50

	)

162 
	#IP_LOCAL_PORT_RANGE
 51

	)

163 
	#IP_PROTOCOL
 52

	)

165 
	#MCAST_EXCLUDE
 0

	)

166 
	#MCAST_INCLUDE
 1

	)

169 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

170 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

174 #ià
__UAPI_DEF_IP_MREQ


175 
	s_m»q
 {

176 
š_addr
 
	mimr_muÉŸddr
;

177 
š_addr
 
	mimr_š‹rçû
;

180 
	s_m»qn
 {

181 
š_addr
 
	mimr_muÉŸddr
;

182 
š_addr
 
	mimr_add»ss
;

183 
	mimr_ifšdex
;

186 
	s_m»q_sourû
 {

187 
__be32
 
	mimr_muÉŸddr
;

188 
__be32
 
	mimr_š‹rçû
;

189 
__be32
 
	mimr_sourûaddr
;

192 
	s_msf‹r
 {

195 
__be32
 
	mimsf_muÉŸddr_aux
;

196 
__be32
 
	mimsf_š‹rçû_aux
;

197 
__u32
 
	mimsf_fmode_aux
;

198 
__u32
 
	mimsf_num¤c_aux
;

199 
__be32
 
	mimsf_¦i¡
[1];

202 
__be32
 
	mimsf_muÉŸddr
;

203 
__be32
 
	mimsf_š‹rçû
;

204 
__u32
 
	mimsf_fmode
;

205 
__u32
 
	mimsf_num¤c
;

206 
__be32
 
	mimsf_¦i¡_æex
[];

211 
	#IP_MSFILTER_SIZE
(
num¤c
) \

212 ((
_msf‹r
è- (
__u32
) \

213 + (
num¤c
è* (
__u32
))

	)

215 
	sgroup_»q
 {

216 
__u32
 
	mgr_š‹rçû
;

217 
__k”Ãl_sockaddr_¡Üage
 
	mgr_group
;

220 
	sgroup_sourû_»q
 {

221 
__u32
 
	mg¤_š‹rçû
;

222 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_group
;

223 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_sourû
;

226 
	sgroup_f‹r
 {

229 
__u32
 
	mgf_š‹rçû_aux
;

230 
__k”Ãl_sockaddr_¡Üage
 
	mgf_group_aux
;

231 
__u32
 
	mgf_fmode_aux
;

232 
__u32
 
	mgf_num¤c_aux
;

233 
__k”Ãl_sockaddr_¡Üage
 
	mgf_¦i¡
[1];

236 
__u32
 
	mgf_š‹rçû
;

237 
__k”Ãl_sockaddr_¡Üage
 
	mgf_group
;

238 
__u32
 
	mgf_fmode
;

239 
__u32
 
	mgf_num¤c
;

240 
__k”Ãl_sockaddr_¡Üage
 
	mgf_¦i¡_æex
[];

245 
	#GROUP_FILTER_SIZE
(
num¤c
) \

246 ((
group_f‹r
è- (
__k”Ãl_sockaddr_¡Üage
) \

247 + (
num¤c
è* (
__k”Ãl_sockaddr_¡Üage
))

	)

250 #ià
__UAPI_DEF_IN_PKTINFO


251 
	sš_pktšfo
 {

252 
	mi_ifšdex
;

253 
š_addr
 
	mi_¥ec_d¡
;

254 
š_addr
 
	mi_addr
;

259 #ià 
__UAPI_DEF_SOCKADDR_IN


260 
	#__SOCK_SIZE__
 16

	)

261 
	ssockaddr_š
 {

262 
__k”Ãl_§_çmy_t
 
	msš_çmy
;

263 
__be16
 
	msš_pÜt
;

264 
š_addr
 
	msš_addr
;

267 
	m__·d
[
__SOCK_SIZE__
 - () -

268 (è- (
š_addr
)];

270 
	#sš_z”o
 
__·d


	)

273 #ià
__UAPI_DEF_IN_CLASS


279 
	#IN_CLASSA
(
a
è((((è×)è& 0x80000000è=ğ0)

	)

280 
	#IN_CLASSA_NET
 0xff000000

	)

281 
	#IN_CLASSA_NSHIFT
 24

	)

282 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

283 
	#IN_CLASSA_MAX
 128

	)

285 
	#IN_CLASSB
(
a
è((((è×)è& 0xc0000000è=ğ0x80000000)

	)

286 
	#IN_CLASSB_NET
 0xffff0000

	)

287 
	#IN_CLASSB_NSHIFT
 16

	)

288 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

289 
	#IN_CLASSB_MAX
 65536

	)

291 
	#IN_CLASSC
(
a
è((((è×)è& 0xe0000000è=ğ0xc0000000)

	)

292 
	#IN_CLASSC_NET
 0xffffff00

	)

293 
	#IN_CLASSC_NSHIFT
 8

	)

294 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

296 
	#IN_CLASSD
(
a
è((((è×)è& 0xf0000000è=ğ0xe0000000)

	)

297 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

298 
	#IN_MULTICAST_NET
 0xe0000000

	)

300 
	#IN_BADCLASS
(
a
è(((è×èè=ğ()0xffffffff)

	)

301 
	#IN_EXPERIMENTAL
(
a
è
	`IN_BADCLASS
(×))

	)

303 
	#IN_CLASSE
(
a
è((((è×)è& 0xf0000000è=ğ0xf0000000)

	)

304 
	#IN_CLASSE_NET
 0xffffffff

	)

305 
	#IN_CLASSE_NSHIFT
 0

	)

308 
	#INADDR_ANY
 ((è0x00000000)

	)

311 
	#INADDR_BROADCAST
 ((è0xffffffff)

	)

314 
	#INADDR_NONE
 ((è0xffffffff)

	)

317 
	#INADDR_DUMMY
 ((è0xc0000008)

	)

320 
	#IN_LOOPBACKNET
 127

	)

323 
	#INADDR_LOOPBACK
 0x7f000001

	)

324 
	#IN_LOOPBACK
(
a
è((((è×)è& 0xff000000è=ğ0x7f000000)

	)

327 
	#INADDR_UNSPEC_GROUP
 0xe0000000U

	)

328 
	#INADDR_ALLHOSTS_GROUP
 0xe0000001U

	)

329 
	#INADDR_ALLRTRS_GROUP
 0xe0000002U

	)

330 
	#INADDR_ALLSNOOPERS_GROUP
 0xe000006aU

	)

331 
	#INADDR_MAX_LOCAL_GROUP
 0xe00000ffU

	)

335 
	~<asm/by‹Üd”.h
>

	@/usr/include/linux/ip.h

18 #iâdeà
_LINUX_IP_H


19 
	#_LINUX_IP_H


	)

20 
	~<lšux/ty³s.h
>

21 
	~<lšux/¡ddef.h
>

22 
	~<asm/by‹Üd”.h
>

24 
	#IPTOS_TOS_MASK
 0x1E

	)

25 
	#IPTOS_TOS
(
tos
è(Ños)&
IPTOS_TOS_MASK
)

	)

26 
	#IPTOS_LOWDELAY
 0x10

	)

27 
	#IPTOS_THROUGHPUT
 0x08

	)

28 
	#IPTOS_RELIABILITY
 0x04

	)

29 
	#IPTOS_MINCOST
 0x02

	)

31 
	#IPTOS_PREC_MASK
 0xE0

	)

32 
	#IPTOS_PREC
(
tos
è(Ños)&
IPTOS_PREC_MASK
)

	)

33 
	#IPTOS_PREC_NETCONTROL
 0xe0

	)

34 
	#IPTOS_PREC_INTERNETCONTROL
 0xc0

	)

35 
	#IPTOS_PREC_CRITIC_ECP
 0xa0

	)

36 
	#IPTOS_PREC_FLASHOVERRIDE
 0x80

	)

37 
	#IPTOS_PREC_FLASH
 0x60

	)

38 
	#IPTOS_PREC_IMMEDIATE
 0x40

	)

39 
	#IPTOS_PREC_PRIORITY
 0x20

	)

40 
	#IPTOS_PREC_ROUTINE
 0x00

	)

44 
	#IPOPT_COPY
 0x80

	)

45 
	#IPOPT_CLASS_MASK
 0x60

	)

46 
	#IPOPT_NUMBER_MASK
 0x1f

	)

48 
	#IPOPT_COPIED
(
o
è((o)&
IPOPT_COPY
)

	)

49 
	#IPOPT_CLASS
(
o
è((o)&
IPOPT_CLASS_MASK
)

	)

50 
	#IPOPT_NUMBER
(
o
è((o)&
IPOPT_NUMBER_MASK
)

	)

52 
	#IPOPT_CONTROL
 0x00

	)

53 
	#IPOPT_RESERVED1
 0x20

	)

54 
	#IPOPT_MEASUREMENT
 0x40

	)

55 
	#IPOPT_RESERVED2
 0x60

	)

57 
	#IPOPT_END
 (0 |
IPOPT_CONTROL
)

	)

58 
	#IPOPT_NOOP
 (1 |
IPOPT_CONTROL
)

	)

59 
	#IPOPT_SEC
 (2 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

60 
	#IPOPT_LSRR
 (3 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

61 
	#IPOPT_TIMESTAMP
 (4 |
IPOPT_MEASUREMENT
)

	)

62 
	#IPOPT_CIPSO
 (6 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

63 
	#IPOPT_RR
 (7 |
IPOPT_CONTROL
)

	)

64 
	#IPOPT_SID
 (8 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

65 
	#IPOPT_SSRR
 (9 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

66 
	#IPOPT_RA
 (20|
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

68 
	#IPVERSION
 4

	)

69 
	#MAXTTL
 255

	)

70 
	#IPDEFTTL
 64

	)

72 
	#IPOPT_OPTVAL
 0

	)

73 
	#IPOPT_OLEN
 1

	)

74 
	#IPOPT_OFFSET
 2

	)

75 
	#IPOPT_MINOFF
 4

	)

76 
	#MAX_IPOPTLEN
 40

	)

77 
	#IPOPT_NOP
 
IPOPT_NOOP


	)

78 
	#IPOPT_EOL
 
IPOPT_END


	)

79 
	#IPOPT_TS
 
IPOPT_TIMESTAMP


	)

81 
	#IPOPT_TS_TSONLY
 0

	)

82 
	#IPOPT_TS_TSANDADDR
 1

	)

83 
	#IPOPT_TS_PRESPEC
 3

	)

85 
	#IPV4_BEET_PHMAXLEN
 8

	)

87 
	shdr
 {

88 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

89 
__u8
 
	mihl
:4,

90 
	mv”siÚ
:4;

91 #–ià
defšed
 (
__BIG_ENDIAN_BITFIELD
)

92 
__u8
 
	mv”siÚ
:4,

93 
	mihl
:4;

97 
__u8
 
	mtos
;

98 
__be16
 
	mtÙ_Ën
;

99 
__be16
 
	mid
;

100 
__be16
 
	mäag_off
;

101 
__u8
 
	m‰l
;

102 
__u8
 
	m´ÙocŞ
;

103 
__sum16
 
	mcheck
;

104 
__¡ruù_group
Ğ, 
addrs
, ,

105 
__be32
 
§ddr
;

106 
__be32
 
daddr
;

112 
	s_auth_hdr
 {

113 
__u8
 
	mÃxthdr
;

114 
__u8
 
	mhd¾’
;

115 
__be16
 
	m»£rved
;

116 
__be32
 
	m¥i
;

117 
__be32
 
	m£q_no
;

118 
__u8
 
	mauth_d©a
[0];

121 
	s_e¥_hdr
 {

122 
__be32
 
	m¥i
;

123 
__be32
 
	m£q_no
;

124 
__u8
 
	m’c_d©a
[0];

127 
	s_comp_hdr
 {

128 
__u8
 
	mÃxthdr
;

129 
__u8
 
	mæags
;

130 
__be16
 
	mıi
;

133 
	s_b“t_phdr
 {

134 
__u8
 
	mÃxthdr
;

135 
__u8
 
	mhd¾’
;

136 
__u8
 
	m·dËn
;

137 
__u8
 
	m»£rved
;

143 
	mIPV4_DEVCONF_FORWARDING
=1,

144 
	mIPV4_DEVCONF_MC_FORWARDING
,

145 
	mIPV4_DEVCONF_PROXY_ARP
,

146 
	mIPV4_DEVCONF_ACCEPT_REDIRECTS
,

147 
	mIPV4_DEVCONF_SECURE_REDIRECTS
,

148 
	mIPV4_DEVCONF_SEND_REDIRECTS
,

149 
	mIPV4_DEVCONF_SHARED_MEDIA
,

150 
	mIPV4_DEVCONF_RP_FILTER
,

151 
	mIPV4_DEVCONF_ACCEPT_SOURCE_ROUTE
,

152 
	mIPV4_DEVCONF_BOOTP_RELAY
,

153 
	mIPV4_DEVCONF_LOG_MARTIANS
,

154 
	mIPV4_DEVCONF_TAG
,

155 
	mIPV4_DEVCONF_ARPFILTER
,

156 
	mIPV4_DEVCONF_MEDIUM_ID
,

157 
	mIPV4_DEVCONF_NOXFRM
,

158 
	mIPV4_DEVCONF_NOPOLICY
,

159 
	mIPV4_DEVCONF_FORCE_IGMP_VERSION
,

160 
	mIPV4_DEVCONF_ARP_ANNOUNCE
,

161 
	mIPV4_DEVCONF_ARP_IGNORE
,

162 
	mIPV4_DEVCONF_PROMOTE_SECONDARIES
,

163 
	mIPV4_DEVCONF_ARP_ACCEPT
,

164 
	mIPV4_DEVCONF_ARP_NOTIFY
,

165 
	mIPV4_DEVCONF_ACCEPT_LOCAL
,

166 
	mIPV4_DEVCONF_SRC_VMARK
,

167 
	mIPV4_DEVCONF_PROXY_ARP_PVLAN
,

168 
	mIPV4_DEVCONF_ROUTE_LOCALNET
,

169 
	mIPV4_DEVCONF_IGMPV2_UNSOLICITED_REPORT_INTERVAL
,

170 
	mIPV4_DEVCONF_IGMPV3_UNSOLICITED_REPORT_INTERVAL
,

171 
	mIPV4_DEVCONF_IGNORE_ROUTES_WITH_LINKDOWN
,

172 
	mIPV4_DEVCONF_DROP_UNICAST_IN_L2_MULTICAST
,

173 
	mIPV4_DEVCONF_DROP_GRATUITOUS_ARP
,

174 
	mIPV4_DEVCONF_BC_FORWARDING
,

175 
	m__IPV4_DEVCONF_MAX


178 
	#IPV4_DEVCONF_MAX
 (
__IPV4_DEVCONF_MAX
 - 1)

	)

	@/usr/include/linux/kernel.h

2 #iâdeà
_LINUX_KERNEL_H


3 
	#_LINUX_KERNEL_H


	)

5 
	~<lšux/sysšfo.h
>

6 
	~<lšux/cÚ¡.h
>

	@/usr/include/linux/module.h

2 #iâdeà
_LINUX_MODULE_H


3 
	#_LINUX_MODULE_H


	)

6 
	#MODULE_INIT_IGNORE_MODVERSIONS
 1

	)

7 
	#MODULE_INIT_IGNORE_VERMAGIC
 2

	)

	@/usr/include/linux/netdevice.h

26 #iâdeà
_LINUX_NETDEVICE_H


27 
	#_LINUX_NETDEVICE_H


	)

29 
	~<lšux/if.h
>

30 
	~<lšux/if_‘h”.h
>

31 
	~<lšux/if_·ck‘.h
>

32 
	~<lšux/if_lšk.h
>

35 
	#MAX_ADDR_LEN
 32

	)

38 
	#INIT_NETDEV_GROUP
 0

	)

42 
	#NET_NAME_UNKNOWN
 0

	)

43 
	#NET_NAME_ENUM
 1

	)

44 
	#NET_NAME_PREDICTABLE
 2

	)

45 
	#NET_NAME_USER
 3

	)

46 
	#NET_NAME_RENAMED
 4

	)

50 
	mIF_PORT_UNKNOWN
 = 0,

51 
	mIF_PORT_10BASE2
,

52 
	mIF_PORT_10BASET
,

53 
	mIF_PORT_AUI
,

54 
	mIF_PORT_100BASET
,

55 
	mIF_PORT_100BASETX
,

56 
	mIF_PORT_100BASEFX


60 
	#NET_ADDR_PERM
 0

	)

61 
	#NET_ADDR_RANDOM
 1

	)

62 
	#NET_ADDR_STOLEN
 2

	)

63 
	#NET_ADDR_SET
 3

	)

	@/usr/include/linux/nl80211.h

1 #iâdeà
__LINUX_NL80211_H


2 
	#__LINUX_NL80211_H


	)

43 
	~<lšux/ty³s.h
>

45 
	#NL80211_GENL_NAME
 "Æ80211"

	)

47 
	#NL80211_MULTICAST_GROUP_CONFIG
 "cÚfig"

	)

48 
	#NL80211_MULTICAST_GROUP_SCAN
 "sÿn"

	)

49 
	#NL80211_MULTICAST_GROUP_REG
 "»guÏtÜy"

	)

50 
	#NL80211_MULTICAST_GROUP_MLME
 "mlme"

	)

51 
	#NL80211_MULTICAST_GROUP_VENDOR
 "v’dÜ"

	)

52 
	#NL80211_MULTICAST_GROUP_NAN
 "Çn"

	)

53 
	#NL80211_MULTICAST_GROUP_TESTMODE
 "‹¡mode"

	)

55 
	#NL80211_EDMG_BW_CONFIG_MIN
 4

	)

56 
	#NL80211_EDMG_BW_CONFIG_MAX
 15

	)

57 
	#NL80211_EDMG_CHANNELS_MIN
 1

	)

58 
	#NL80211_EDMG_CHANNELS_MAX
 0x3ø

	)

1206 
	eÆ80211_commªds
 {

1208 
	mNL80211_CMD_UNSPEC
,

1210 
	mNL80211_CMD_GET_WIPHY
,

1211 
	mNL80211_CMD_SET_WIPHY
,

1212 
	mNL80211_CMD_NEW_WIPHY
,

1213 
	mNL80211_CMD_DEL_WIPHY
,

1215 
	mNL80211_CMD_GET_INTERFACE
,

1216 
	mNL80211_CMD_SET_INTERFACE
,

1217 
	mNL80211_CMD_NEW_INTERFACE
,

1218 
	mNL80211_CMD_DEL_INTERFACE
,

1220 
	mNL80211_CMD_GET_KEY
,

1221 
	mNL80211_CMD_SET_KEY
,

1222 
	mNL80211_CMD_NEW_KEY
,

1223 
	mNL80211_CMD_DEL_KEY
,

1225 
	mNL80211_CMD_GET_BEACON
,

1226 
	mNL80211_CMD_SET_BEACON
,

1227 
	mNL80211_CMD_START_AP
,

1228 
	mNL80211_CMD_NEW_BEACON
 = 
NL80211_CMD_START_AP
,

1229 
	mNL80211_CMD_STOP_AP
,

1230 
	mNL80211_CMD_DEL_BEACON
 = 
NL80211_CMD_STOP_AP
,

1232 
	mNL80211_CMD_GET_STATION
,

1233 
	mNL80211_CMD_SET_STATION
,

1234 
	mNL80211_CMD_NEW_STATION
,

1235 
	mNL80211_CMD_DEL_STATION
,

1237 
	mNL80211_CMD_GET_MPATH
,

1238 
	mNL80211_CMD_SET_MPATH
,

1239 
	mNL80211_CMD_NEW_MPATH
,

1240 
	mNL80211_CMD_DEL_MPATH
,

1242 
	mNL80211_CMD_SET_BSS
,

1244 
	mNL80211_CMD_SET_REG
,

1245 
	mNL80211_CMD_REQ_SET_REG
,

1247 
	mNL80211_CMD_GET_MESH_CONFIG
,

1248 
	mNL80211_CMD_SET_MESH_CONFIG
,

1250 
	mNL80211_CMD_SET_MGMT_EXTRA_IE
 ,

1252 
	mNL80211_CMD_GET_REG
,

1254 
	mNL80211_CMD_GET_SCAN
,

1255 
	mNL80211_CMD_TRIGGER_SCAN
,

1256 
	mNL80211_CMD_NEW_SCAN_RESULTS
,

1257 
	mNL80211_CMD_SCAN_ABORTED
,

1259 
	mNL80211_CMD_REG_CHANGE
,

1261 
	mNL80211_CMD_AUTHENTICATE
,

1262 
	mNL80211_CMD_ASSOCIATE
,

1263 
	mNL80211_CMD_DEAUTHENTICATE
,

1264 
	mNL80211_CMD_DISASSOCIATE
,

1266 
	mNL80211_CMD_MICHAEL_MIC_FAILURE
,

1268 
	mNL80211_CMD_REG_BEACON_HINT
,

1270 
	mNL80211_CMD_JOIN_IBSS
,

1271 
	mNL80211_CMD_LEAVE_IBSS
,

1273 
	mNL80211_CMD_TESTMODE
,

1275 
	mNL80211_CMD_CONNECT
,

1276 
	mNL80211_CMD_ROAM
,

1277 
	mNL80211_CMD_DISCONNECT
,

1279 
	mNL80211_CMD_SET_WIPHY_NETNS
,

1281 
	mNL80211_CMD_GET_SURVEY
,

1282 
	mNL80211_CMD_NEW_SURVEY_RESULTS
,

1284 
	mNL80211_CMD_SET_PMKSA
,

1285 
	mNL80211_CMD_DEL_PMKSA
,

1286 
	mNL80211_CMD_FLUSH_PMKSA
,

1288 
	mNL80211_CMD_REMAIN_ON_CHANNEL
,

1289 
	mNL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

1291 
	mNL80211_CMD_SET_TX_BITRATE_MASK
,

1293 
	mNL80211_CMD_REGISTER_FRAME
,

1294 
	mNL80211_CMD_REGISTER_ACTION
 = 
NL80211_CMD_REGISTER_FRAME
,

1295 
	mNL80211_CMD_FRAME
,

1296 
	mNL80211_CMD_ACTION
 = 
NL80211_CMD_FRAME
,

1297 
	mNL80211_CMD_FRAME_TX_STATUS
,

1298 
	mNL80211_CMD_ACTION_TX_STATUS
 = 
NL80211_CMD_FRAME_TX_STATUS
,

1300 
	mNL80211_CMD_SET_POWER_SAVE
,

1301 
	mNL80211_CMD_GET_POWER_SAVE
,

1303 
	mNL80211_CMD_SET_CQM
,

1304 
	mNL80211_CMD_NOTIFY_CQM
,

1306 
	mNL80211_CMD_SET_CHANNEL
,

1307 
	mNL80211_CMD_SET_WDS_PEER
,

1309 
	mNL80211_CMD_FRAME_WAIT_CANCEL
,

1311 
	mNL80211_CMD_JOIN_MESH
,

1312 
	mNL80211_CMD_LEAVE_MESH
,

1314 
	mNL80211_CMD_UNPROT_DEAUTHENTICATE
,

1315 
	mNL80211_CMD_UNPROT_DISASSOCIATE
,

1317 
	mNL80211_CMD_NEW_PEER_CANDIDATE
,

1319 
	mNL80211_CMD_GET_WOWLAN
,

1320 
	mNL80211_CMD_SET_WOWLAN
,

1322 
	mNL80211_CMD_START_SCHED_SCAN
,

1323 
	mNL80211_CMD_STOP_SCHED_SCAN
,

1324 
	mNL80211_CMD_SCHED_SCAN_RESULTS
,

1325 
	mNL80211_CMD_SCHED_SCAN_STOPPED
,

1327 
	mNL80211_CMD_SET_REKEY_OFFLOAD
,

1329 
	mNL80211_CMD_PMKSA_CANDIDATE
,

1331 
	mNL80211_CMD_TDLS_OPER
,

1332 
	mNL80211_CMD_TDLS_MGMT
,

1334 
	mNL80211_CMD_UNEXPECTED_FRAME
,

1336 
	mNL80211_CMD_PROBE_CLIENT
,

1338 
	mNL80211_CMD_REGISTER_BEACONS
,

1340 
	mNL80211_CMD_UNEXPECTED_4ADDR_FRAME
,

1342 
	mNL80211_CMD_SET_NOACK_MAP
,

1344 
	mNL80211_CMD_CH_SWITCH_NOTIFY
,

1346 
	mNL80211_CMD_START_P2P_DEVICE
,

1347 
	mNL80211_CMD_STOP_P2P_DEVICE
,

1349 
	mNL80211_CMD_CONN_FAILED
,

1351 
	mNL80211_CMD_SET_MCAST_RATE
,

1353 
	mNL80211_CMD_SET_MAC_ACL
,

1355 
	mNL80211_CMD_RADAR_DETECT
,

1357 
	mNL80211_CMD_GET_PROTOCOL_FEATURES
,

1359 
	mNL80211_CMD_UPDATE_FT_IES
,

1360 
	mNL80211_CMD_FT_EVENT
,

1362 
	mNL80211_CMD_CRIT_PROTOCOL_START
,

1363 
	mNL80211_CMD_CRIT_PROTOCOL_STOP
,

1365 
	mNL80211_CMD_GET_COALESCE
,

1366 
	mNL80211_CMD_SET_COALESCE
,

1368 
	mNL80211_CMD_CHANNEL_SWITCH
,

1370 
	mNL80211_CMD_VENDOR
,

1372 
	mNL80211_CMD_SET_QOS_MAP
,

1374 
	mNL80211_CMD_ADD_TX_TS
,

1375 
	mNL80211_CMD_DEL_TX_TS
,

1377 
	mNL80211_CMD_GET_MPP
,

1379 
	mNL80211_CMD_JOIN_OCB
,

1380 
	mNL80211_CMD_LEAVE_OCB
,

1382 
	mNL80211_CMD_CH_SWITCH_STARTED_NOTIFY
,

1384 
	mNL80211_CMD_TDLS_CHANNEL_SWITCH
,

1385 
	mNL80211_CMD_TDLS_CANCEL_CHANNEL_SWITCH
,

1387 
	mNL80211_CMD_WIPHY_REG_CHANGE
,

1389 
	mNL80211_CMD_ABORT_SCAN
,

1391 
	mNL80211_CMD_START_NAN
,

1392 
	mNL80211_CMD_STOP_NAN
,

1393 
	mNL80211_CMD_ADD_NAN_FUNCTION
,

1394 
	mNL80211_CMD_DEL_NAN_FUNCTION
,

1395 
	mNL80211_CMD_CHANGE_NAN_CONFIG
,

1396 
	mNL80211_CMD_NAN_MATCH
,

1398 
	mNL80211_CMD_SET_MULTICAST_TO_UNICAST
,

1400 
	mNL80211_CMD_UPDATE_CONNECT_PARAMS
,

1402 
	mNL80211_CMD_SET_PMK
,

1403 
	mNL80211_CMD_DEL_PMK
,

1405 
	mNL80211_CMD_PORT_AUTHORIZED
,

1407 
	mNL80211_CMD_RELOAD_REGDB
,

1409 
	mNL80211_CMD_EXTERNAL_AUTH
,

1411 
	mNL80211_CMD_STA_OPMODE_CHANGED
,

1413 
	mNL80211_CMD_CONTROL_PORT_FRAME
,

1415 
	mNL80211_CMD_GET_FTM_RESPONDER_STATS
,

1417 
	mNL80211_CMD_PEER_MEASUREMENT_START
,

1418 
	mNL80211_CMD_PEER_MEASUREMENT_RESULT
,

1419 
	mNL80211_CMD_PEER_MEASUREMENT_COMPLETE
,

1421 
	mNL80211_CMD_NOTIFY_RADAR
,

1423 
	mNL80211_CMD_UPDATE_OWE_INFO
,

1425 
	mNL80211_CMD_PROBE_MESH_LINK
,

1427 
	mNL80211_CMD_SET_TID_CONFIG
,

1429 
	mNL80211_CMD_UNPROT_BEACON
,

1431 
	mNL80211_CMD_CONTROL_PORT_FRAME_TX_STATUS
,

1433 
	mNL80211_CMD_SET_SAR_SPECS
,

1435 
	mNL80211_CMD_OBSS_COLOR_COLLISION
,

1437 
	mNL80211_CMD_COLOR_CHANGE_REQUEST
,

1439 
	mNL80211_CMD_COLOR_CHANGE_STARTED
,

1440 
	mNL80211_CMD_COLOR_CHANGE_ABORTED
,

1441 
	mNL80211_CMD_COLOR_CHANGE_COMPLETED
,

1446 
	m__NL80211_CMD_AFTER_LAST
,

1447 
	mNL80211_CMD_MAX
 = 
__NL80211_CMD_AFTER_LAST
 - 1

1454 
	#NL80211_CMD_SET_BSS
 
NL80211_CMD_SET_BSS


	)

1455 
	#NL80211_CMD_SET_MGMT_EXTRA_IE
 
NL80211_CMD_SET_MGMT_EXTRA_IE


	)

1456 
	#NL80211_CMD_REG_CHANGE
 
NL80211_CMD_REG_CHANGE


	)

1457 
	#NL80211_CMD_AUTHENTICATE
 
NL80211_CMD_AUTHENTICATE


	)

1458 
	#NL80211_CMD_ASSOCIATE
 
NL80211_CMD_ASSOCIATE


	)

1459 
	#NL80211_CMD_DEAUTHENTICATE
 
NL80211_CMD_DEAUTHENTICATE


	)

1460 
	#NL80211_CMD_DISASSOCIATE
 
NL80211_CMD_DISASSOCIATE


	)

1461 
	#NL80211_CMD_REG_BEACON_HINT
 
NL80211_CMD_REG_BEACON_HINT


	)

1463 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

1466 
	#NL80211_CMD_GET_MESH_PARAMS
 
NL80211_CMD_GET_MESH_CONFIG


	)

1467 
	#NL80211_CMD_SET_MESH_PARAMS
 
NL80211_CMD_SET_MESH_CONFIG


	)

1468 
	#NL80211_MESH_SETUP_VENDOR_PATH_SEL_IE
 
NL80211_MESH_SETUP_IE


	)

2600 
	eÆ80211_©Œs
 {

2602 
	mNL80211_ATTR_UNSPEC
,

2604 
	mNL80211_ATTR_WIPHY
,

2605 
	mNL80211_ATTR_WIPHY_NAME
,

2607 
	mNL80211_ATTR_IFINDEX
,

2608 
	mNL80211_ATTR_IFNAME
,

2609 
	mNL80211_ATTR_IFTYPE
,

2611 
	mNL80211_ATTR_MAC
,

2613 
	mNL80211_ATTR_KEY_DATA
,

2614 
	mNL80211_ATTR_KEY_IDX
,

2615 
	mNL80211_ATTR_KEY_CIPHER
,

2616 
	mNL80211_ATTR_KEY_SEQ
,

2617 
	mNL80211_ATTR_KEY_DEFAULT
,

2619 
	mNL80211_ATTR_BEACON_INTERVAL
,

2620 
	mNL80211_ATTR_DTIM_PERIOD
,

2621 
	mNL80211_ATTR_BEACON_HEAD
,

2622 
	mNL80211_ATTR_BEACON_TAIL
,

2624 
	mNL80211_ATTR_STA_AID
,

2625 
	mNL80211_ATTR_STA_FLAGS
,

2626 
	mNL80211_ATTR_STA_LISTEN_INTERVAL
,

2627 
	mNL80211_ATTR_STA_SUPPORTED_RATES
,

2628 
	mNL80211_ATTR_STA_VLAN
,

2629 
	mNL80211_ATTR_STA_INFO
,

2631 
	mNL80211_ATTR_WIPHY_BANDS
,

2633 
	mNL80211_ATTR_MNTR_FLAGS
,

2635 
	mNL80211_ATTR_MESH_ID
,

2636 
	mNL80211_ATTR_STA_PLINK_ACTION
,

2637 
	mNL80211_ATTR_MPATH_NEXT_HOP
,

2638 
	mNL80211_ATTR_MPATH_INFO
,

2640 
	mNL80211_ATTR_BSS_CTS_PROT
,

2641 
	mNL80211_ATTR_BSS_SHORT_PREAMBLE
,

2642 
	mNL80211_ATTR_BSS_SHORT_SLOT_TIME
,

2644 
	mNL80211_ATTR_HT_CAPABILITY
,

2646 
	mNL80211_ATTR_SUPPORTED_IFTYPES
,

2648 
	mNL80211_ATTR_REG_ALPHA2
,

2649 
	mNL80211_ATTR_REG_RULES
,

2651 
	mNL80211_ATTR_MESH_CONFIG
,

2653 
	mNL80211_ATTR_BSS_BASIC_RATES
,

2655 
	mNL80211_ATTR_WIPHY_TXQ_PARAMS
,

2656 
	mNL80211_ATTR_WIPHY_FREQ
,

2657 
	mNL80211_ATTR_WIPHY_CHANNEL_TYPE
,

2659 
	mNL80211_ATTR_KEY_DEFAULT_MGMT
,

2661 
	mNL80211_ATTR_MGMT_SUBTYPE
,

2662 
	mNL80211_ATTR_IE
,

2664 
	mNL80211_ATTR_MAX_NUM_SCAN_SSIDS
,

2666 
	mNL80211_ATTR_SCAN_FREQUENCIES
,

2667 
	mNL80211_ATTR_SCAN_SSIDS
,

2668 
	mNL80211_ATTR_GENERATION
,

2669 
	mNL80211_ATTR_BSS
,

2671 
	mNL80211_ATTR_REG_INITIATOR
,

2672 
	mNL80211_ATTR_REG_TYPE
,

2674 
	mNL80211_ATTR_SUPPORTED_COMMANDS
,

2676 
	mNL80211_ATTR_FRAME
,

2677 
	mNL80211_ATTR_SSID
,

2678 
	mNL80211_ATTR_AUTH_TYPE
,

2679 
	mNL80211_ATTR_REASON_CODE
,

2681 
	mNL80211_ATTR_KEY_TYPE
,

2683 
	mNL80211_ATTR_MAX_SCAN_IE_LEN
,

2684 
	mNL80211_ATTR_CIPHER_SUITES
,

2686 
	mNL80211_ATTR_FREQ_BEFORE
,

2687 
	mNL80211_ATTR_FREQ_AFTER
,

2689 
	mNL80211_ATTR_FREQ_FIXED
,

2692 
	mNL80211_ATTR_WIPHY_RETRY_SHORT
,

2693 
	mNL80211_ATTR_WIPHY_RETRY_LONG
,

2694 
	mNL80211_ATTR_WIPHY_FRAG_THRESHOLD
,

2695 
	mNL80211_ATTR_WIPHY_RTS_THRESHOLD
,

2697 
	mNL80211_ATTR_TIMED_OUT
,

2699 
	mNL80211_ATTR_USE_MFP
,

2701 
	mNL80211_ATTR_STA_FLAGS2
,

2703 
	mNL80211_ATTR_CONTROL_PORT
,

2705 
	mNL80211_ATTR_TESTDATA
,

2707 
	mNL80211_ATTR_PRIVACY
,

2709 
	mNL80211_ATTR_DISCONNECTED_BY_AP
,

2710 
	mNL80211_ATTR_STATUS_CODE
,

2712 
	mNL80211_ATTR_CIPHER_SUITES_PAIRWISE
,

2713 
	mNL80211_ATTR_CIPHER_SUITE_GROUP
,

2714 
	mNL80211_ATTR_WPA_VERSIONS
,

2715 
	mNL80211_ATTR_AKM_SUITES
,

2717 
	mNL80211_ATTR_REQ_IE
,

2718 
	mNL80211_ATTR_RESP_IE
,

2720 
	mNL80211_ATTR_PREV_BSSID
,

2722 
	mNL80211_ATTR_KEY
,

2723 
	mNL80211_ATTR_KEYS
,

2725 
	mNL80211_ATTR_PID
,

2727 
	mNL80211_ATTR_4ADDR
,

2729 
	mNL80211_ATTR_SURVEY_INFO
,

2731 
	mNL80211_ATTR_PMKID
,

2732 
	mNL80211_ATTR_MAX_NUM_PMKIDS
,

2734 
	mNL80211_ATTR_DURATION
,

2736 
	mNL80211_ATTR_COOKIE
,

2738 
	mNL80211_ATTR_WIPHY_COVERAGE_CLASS
,

2740 
	mNL80211_ATTR_TX_RATES
,

2742 
	mNL80211_ATTR_FRAME_MATCH
,

2744 
	mNL80211_ATTR_ACK
,

2746 
	mNL80211_ATTR_PS_STATE
,

2748 
	mNL80211_ATTR_CQM
,

2750 
	mNL80211_ATTR_LOCAL_STATE_CHANGE
,

2752 
	mNL80211_ATTR_AP_ISOLATE
,

2754 
	mNL80211_ATTR_WIPHY_TX_POWER_SETTING
,

2755 
	mNL80211_ATTR_WIPHY_TX_POWER_LEVEL
,

2757 
	mNL80211_ATTR_TX_FRAME_TYPES
,

2758 
	mNL80211_ATTR_RX_FRAME_TYPES
,

2759 
	mNL80211_ATTR_FRAME_TYPE
,

2761 
	mNL80211_ATTR_CONTROL_PORT_ETHERTYPE
,

2762 
	mNL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
,

2764 
	mNL80211_ATTR_SUPPORT_IBSS_RSN
,

2766 
	mNL80211_ATTR_WIPHY_ANTENNA_TX
,

2767 
	mNL80211_ATTR_WIPHY_ANTENNA_RX
,

2769 
	mNL80211_ATTR_MCAST_RATE
,

2771 
	mNL80211_ATTR_OFFCHANNEL_TX_OK
,

2773 
	mNL80211_ATTR_BSS_HT_OPMODE
,

2775 
	mNL80211_ATTR_KEY_DEFAULT_TYPES
,

2777 
	mNL80211_ATTR_MAX_REMAIN_ON_CHANNEL_DURATION
,

2779 
	mNL80211_ATTR_MESH_SETUP
,

2781 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_TX
,

2782 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_RX
,

2784 
	mNL80211_ATTR_SUPPORT_MESH_AUTH
,

2785 
	mNL80211_ATTR_STA_PLINK_STATE
,

2787 
	mNL80211_ATTR_WOWLAN_TRIGGERS
,

2788 
	mNL80211_ATTR_WOWLAN_TRIGGERS_SUPPORTED
,

2790 
	mNL80211_ATTR_SCHED_SCAN_INTERVAL
,

2792 
	mNL80211_ATTR_INTERFACE_COMBINATIONS
,

2793 
	mNL80211_ATTR_SOFTWARE_IFTYPES
,

2795 
	mNL80211_ATTR_REKEY_DATA
,

2797 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_SSIDS
,

2798 
	mNL80211_ATTR_MAX_SCHED_SCAN_IE_LEN
,

2800 
	mNL80211_ATTR_SCAN_SUPP_RATES
,

2802 
	mNL80211_ATTR_HIDDEN_SSID
,

2804 
	mNL80211_ATTR_IE_PROBE_RESP
,

2805 
	mNL80211_ATTR_IE_ASSOC_RESP
,

2807 
	mNL80211_ATTR_STA_WME
,

2808 
	mNL80211_ATTR_SUPPORT_AP_UAPSD
,

2810 
	mNL80211_ATTR_ROAM_SUPPORT
,

2812 
	mNL80211_ATTR_SCHED_SCAN_MATCH
,

2813 
	mNL80211_ATTR_MAX_MATCH_SETS
,

2815 
	mNL80211_ATTR_PMKSA_CANDIDATE
,

2817 
	mNL80211_ATTR_TX_NO_CCK_RATE
,

2819 
	mNL80211_ATTR_TDLS_ACTION
,

2820 
	mNL80211_ATTR_TDLS_DIALOG_TOKEN
,

2821 
	mNL80211_ATTR_TDLS_OPERATION
,

2822 
	mNL80211_ATTR_TDLS_SUPPORT
,

2823 
	mNL80211_ATTR_TDLS_EXTERNAL_SETUP
,

2825 
	mNL80211_ATTR_DEVICE_AP_SME
,

2827 
	mNL80211_ATTR_DONT_WAIT_FOR_ACK
,

2829 
	mNL80211_ATTR_FEATURE_FLAGS
,

2831 
	mNL80211_ATTR_PROBE_RESP_OFFLOAD
,

2833 
	mNL80211_ATTR_PROBE_RESP
,

2835 
	mNL80211_ATTR_DFS_REGION
,

2837 
	mNL80211_ATTR_DISABLE_HT
,

2838 
	mNL80211_ATTR_HT_CAPABILITY_MASK
,

2840 
	mNL80211_ATTR_NOACK_MAP
,

2842 
	mNL80211_ATTR_INACTIVITY_TIMEOUT
,

2844 
	mNL80211_ATTR_RX_SIGNAL_DBM
,

2846 
	mNL80211_ATTR_BG_SCAN_PERIOD
,

2848 
	mNL80211_ATTR_WDEV
,

2850 
	mNL80211_ATTR_USER_REG_HINT_TYPE
,

2852 
	mNL80211_ATTR_CONN_FAILED_REASON
,

2854 
	mNL80211_ATTR_AUTH_DATA
,

2856 
	mNL80211_ATTR_VHT_CAPABILITY
,

2858 
	mNL80211_ATTR_SCAN_FLAGS
,

2860 
	mNL80211_ATTR_CHANNEL_WIDTH
,

2861 
	mNL80211_ATTR_CENTER_FREQ1
,

2862 
	mNL80211_ATTR_CENTER_FREQ2
,

2864 
	mNL80211_ATTR_P2P_CTWINDOW
,

2865 
	mNL80211_ATTR_P2P_OPPPS
,

2867 
	mNL80211_ATTR_LOCAL_MESH_POWER_MODE
,

2869 
	mNL80211_ATTR_ACL_POLICY
,

2871 
	mNL80211_ATTR_MAC_ADDRS
,

2873 
	mNL80211_ATTR_MAC_ACL_MAX
,

2875 
	mNL80211_ATTR_RADAR_EVENT
,

2877 
	mNL80211_ATTR_EXT_CAPA
,

2878 
	mNL80211_ATTR_EXT_CAPA_MASK
,

2880 
	mNL80211_ATTR_STA_CAPABILITY
,

2881 
	mNL80211_ATTR_STA_EXT_CAPABILITY
,

2883 
	mNL80211_ATTR_PROTOCOL_FEATURES
,

2884 
	mNL80211_ATTR_SPLIT_WIPHY_DUMP
,

2886 
	mNL80211_ATTR_DISABLE_VHT
,

2887 
	mNL80211_ATTR_VHT_CAPABILITY_MASK
,

2889 
	mNL80211_ATTR_MDID
,

2890 
	mNL80211_ATTR_IE_RIC
,

2892 
	mNL80211_ATTR_CRIT_PROT_ID
,

2893 
	mNL80211_ATTR_MAX_CRIT_PROT_DURATION
,

2895 
	mNL80211_ATTR_PEER_AID
,

2897 
	mNL80211_ATTR_COALESCE_RULE
,

2899 
	mNL80211_ATTR_CH_SWITCH_COUNT
,

2900 
	mNL80211_ATTR_CH_SWITCH_BLOCK_TX
,

2901 
	mNL80211_ATTR_CSA_IES
,

2902 
	mNL80211_ATTR_CNTDWN_OFFS_BEACON
,

2903 
	mNL80211_ATTR_CNTDWN_OFFS_PRESP
,

2905 
	mNL80211_ATTR_RXMGMT_FLAGS
,

2907 
	mNL80211_ATTR_STA_SUPPORTED_CHANNELS
,

2909 
	mNL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
,

2911 
	mNL80211_ATTR_HANDLE_DFS
,

2913 
	mNL80211_ATTR_SUPPORT_5_MHZ
,

2914 
	mNL80211_ATTR_SUPPORT_10_MHZ
,

2916 
	mNL80211_ATTR_OPMODE_NOTIF
,

2918 
	mNL80211_ATTR_VENDOR_ID
,

2919 
	mNL80211_ATTR_VENDOR_SUBCMD
,

2920 
	mNL80211_ATTR_VENDOR_DATA
,

2921 
	mNL80211_ATTR_VENDOR_EVENTS
,

2923 
	mNL80211_ATTR_QOS_MAP
,

2925 
	mNL80211_ATTR_MAC_HINT
,

2926 
	mNL80211_ATTR_WIPHY_FREQ_HINT
,

2928 
	mNL80211_ATTR_MAX_AP_ASSOC_STA
,

2930 
	mNL80211_ATTR_TDLS_PEER_CAPABILITY
,

2932 
	mNL80211_ATTR_SOCKET_OWNER
,

2934 
	mNL80211_ATTR_CSA_C_OFFSETS_TX
,

2935 
	mNL80211_ATTR_MAX_CSA_COUNTERS
,

2937 
	mNL80211_ATTR_TDLS_INITIATOR
,

2939 
	mNL80211_ATTR_USE_RRM
,

2941 
	mNL80211_ATTR_WIPHY_DYN_ACK
,

2943 
	mNL80211_ATTR_TSID
,

2944 
	mNL80211_ATTR_USER_PRIO
,

2945 
	mNL80211_ATTR_ADMITTED_TIME
,

2947 
	mNL80211_ATTR_SMPS_MODE
,

2949 
	mNL80211_ATTR_OPER_CLASS
,

2951 
	mNL80211_ATTR_MAC_MASK
,

2953 
	mNL80211_ATTR_WIPHY_SELF_MANAGED_REG
,

2955 
	mNL80211_ATTR_EXT_FEATURES
,

2957 
	mNL80211_ATTR_SURVEY_RADIO_STATS
,

2959 
	mNL80211_ATTR_NETNS_FD
,

2961 
	mNL80211_ATTR_SCHED_SCAN_DELAY
,

2963 
	mNL80211_ATTR_REG_INDOOR
,

2965 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_PLANS
,

2966 
	mNL80211_ATTR_MAX_SCAN_PLAN_INTERVAL
,

2967 
	mNL80211_ATTR_MAX_SCAN_PLAN_ITERATIONS
,

2968 
	mNL80211_ATTR_SCHED_SCAN_PLANS
,

2970 
	mNL80211_ATTR_PBSS
,

2972 
	mNL80211_ATTR_BSS_SELECT
,

2974 
	mNL80211_ATTR_STA_SUPPORT_P2P_PS
,

2976 
	mNL80211_ATTR_PAD
,

2978 
	mNL80211_ATTR_IFTYPE_EXT_CAPA
,

2980 
	mNL80211_ATTR_MU_MIMO_GROUP_DATA
,

2981 
	mNL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR
,

2983 
	mNL80211_ATTR_SCAN_START_TIME_TSF
,

2984 
	mNL80211_ATTR_SCAN_START_TIME_TSF_BSSID
,

2985 
	mNL80211_ATTR_MEASUREMENT_DURATION
,

2986 
	mNL80211_ATTR_MEASUREMENT_DURATION_MANDATORY
,

2988 
	mNL80211_ATTR_MESH_PEER_AID
,

2990 
	mNL80211_ATTR_NAN_MASTER_PREF
,

2991 
	mNL80211_ATTR_BANDS
,

2992 
	mNL80211_ATTR_NAN_FUNC
,

2993 
	mNL80211_ATTR_NAN_MATCH
,

2995 
	mNL80211_ATTR_FILS_KEK
,

2996 
	mNL80211_ATTR_FILS_NONCES
,

2998 
	mNL80211_ATTR_MULTICAST_TO_UNICAST_ENABLED
,

3000 
	mNL80211_ATTR_BSSID
,

3002 
	mNL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
,

3003 
	mNL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
,

3005 
	mNL80211_ATTR_TIMEOUT_REASON
,

3007 
	mNL80211_ATTR_FILS_ERP_USERNAME
,

3008 
	mNL80211_ATTR_FILS_ERP_REALM
,

3009 
	mNL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
,

3010 
	mNL80211_ATTR_FILS_ERP_RRK
,

3011 
	mNL80211_ATTR_FILS_CACHE_ID
,

3013 
	mNL80211_ATTR_PMK
,

3015 
	mNL80211_ATTR_SCHED_SCAN_MULTI
,

3016 
	mNL80211_ATTR_SCHED_SCAN_MAX_REQS
,

3018 
	mNL80211_ATTR_WANT_1X_4WAY_HS
,

3019 
	mNL80211_ATTR_PMKR0_NAME
,

3020 
	mNL80211_ATTR_PORT_AUTHORIZED
,

3022 
	mNL80211_ATTR_EXTERNAL_AUTH_ACTION
,

3023 
	mNL80211_ATTR_EXTERNAL_AUTH_SUPPORT
,

3025 
	mNL80211_ATTR_NSS
,

3026 
	mNL80211_ATTR_ACK_SIGNAL
,

3028 
	mNL80211_ATTR_CONTROL_PORT_OVER_NL80211
,

3030 
	mNL80211_ATTR_TXQ_STATS
,

3031 
	mNL80211_ATTR_TXQ_LIMIT
,

3032 
	mNL80211_ATTR_TXQ_MEMORY_LIMIT
,

3033 
	mNL80211_ATTR_TXQ_QUANTUM
,

3035 
	mNL80211_ATTR_HE_CAPABILITY
,

3037 
	mNL80211_ATTR_FTM_RESPONDER
,

3039 
	mNL80211_ATTR_FTM_RESPONDER_STATS
,

3041 
	mNL80211_ATTR_TIMEOUT
,

3043 
	mNL80211_ATTR_PEER_MEASUREMENTS
,

3045 
	mNL80211_ATTR_AIRTIME_WEIGHT
,

3046 
	mNL80211_ATTR_STA_TX_POWER_SETTING
,

3047 
	mNL80211_ATTR_STA_TX_POWER
,

3049 
	mNL80211_ATTR_SAE_PASSWORD
,

3051 
	mNL80211_ATTR_TWT_RESPONDER
,

3053 
	mNL80211_ATTR_HE_OBSS_PD
,

3055 
	mNL80211_ATTR_WIPHY_EDMG_CHANNELS
,

3056 
	mNL80211_ATTR_WIPHY_EDMG_BW_CONFIG
,

3058 
	mNL80211_ATTR_VLAN_ID
,

3060 
	mNL80211_ATTR_HE_BSS_COLOR
,

3062 
	mNL80211_ATTR_IFTYPE_AKM_SUITES
,

3064 
	mNL80211_ATTR_TID_CONFIG
,

3066 
	mNL80211_ATTR_CONTROL_PORT_NO_PREAUTH
,

3068 
	mNL80211_ATTR_PMK_LIFETIME
,

3069 
	mNL80211_ATTR_PMK_REAUTH_THRESHOLD
,

3071 
	mNL80211_ATTR_RECEIVE_MULTICAST
,

3072 
	mNL80211_ATTR_WIPHY_FREQ_OFFSET
,

3073 
	mNL80211_ATTR_CENTER_FREQ1_OFFSET
,

3074 
	mNL80211_ATTR_SCAN_FREQ_KHZ
,

3076 
	mNL80211_ATTR_HE_6GHZ_CAPABILITY
,

3078 
	mNL80211_ATTR_FILS_DISCOVERY
,

3080 
	mNL80211_ATTR_UNSOL_BCAST_PROBE_RESP
,

3082 
	mNL80211_ATTR_S1G_CAPABILITY
,

3083 
	mNL80211_ATTR_S1G_CAPABILITY_MASK
,

3085 
	mNL80211_ATTR_SAE_PWE
,

3087 
	mNL80211_ATTR_RECONNECT_REQUESTED
,

3089 
	mNL80211_ATTR_SAR_SPEC
,

3091 
	mNL80211_ATTR_DISABLE_HE
,

3093 
	mNL80211_ATTR_OBSS_COLOR_BITMAP
,

3095 
	mNL80211_ATTR_COLOR_CHANGE_COUNT
,

3096 
	mNL80211_ATTR_COLOR_CHANGE_COLOR
,

3097 
	mNL80211_ATTR_COLOR_CHANGE_ELEMS
,

3101 
	m__NL80211_ATTR_AFTER_LAST
,

3102 
	mNUM_NL80211_ATTR
 = 
__NL80211_ATTR_AFTER_LAST
,

3103 
	mNL80211_ATTR_MAX
 = 
__NL80211_ATTR_AFTER_LAST
 - 1

3107 
	#NL80211_ATTR_SCAN_GENERATION
 
NL80211_ATTR_GENERATION


	)

3108 
	#NL80211_ATTR_MESH_PARAMS
 
NL80211_ATTR_MESH_CONFIG


	)

3109 
	#NL80211_ATTR_IFACE_SOCKET_OWNER
 
NL80211_ATTR_SOCKET_OWNER


	)

3110 
	#NL80211_ATTR_SAE_DATA
 
NL80211_ATTR_AUTH_DATA


	)

3111 
	#NL80211_ATTR_CSA_C_OFF_BEACON
 
NL80211_ATTR_CNTDWN_OFFS_BEACON


	)

3112 
	#NL80211_ATTR_CSA_C_OFF_PRESP
 
NL80211_ATTR_CNTDWN_OFFS_PRESP


	)

3118 
	#NL80211_CMD_CONNECT
 
NL80211_CMD_CONNECT


	)

3119 
	#NL80211_ATTR_HT_CAPABILITY
 
NL80211_ATTR_HT_CAPABILITY


	)

3120 
	#NL80211_ATTR_BSS_BASIC_RATES
 
NL80211_ATTR_BSS_BASIC_RATES


	)

3121 
	#NL80211_ATTR_WIPHY_TXQ_PARAMS
 
NL80211_ATTR_WIPHY_TXQ_PARAMS


	)

3122 
	#NL80211_ATTR_WIPHY_FREQ
 
NL80211_ATTR_WIPHY_FREQ


	)

3123 
	#NL80211_ATTR_WIPHY_CHANNEL_TYPE
 
NL80211_ATTR_WIPHY_CHANNEL_TYPE


	)

3124 
	#NL80211_ATTR_MGMT_SUBTYPE
 
NL80211_ATTR_MGMT_SUBTYPE


	)

3125 
	#NL80211_ATTR_IE
 
NL80211_ATTR_IE


	)

3126 
	#NL80211_ATTR_REG_INITIATOR
 
NL80211_ATTR_REG_INITIATOR


	)

3127 
	#NL80211_ATTR_REG_TYPE
 
NL80211_ATTR_REG_TYPE


	)

3128 
	#NL80211_ATTR_FRAME
 
NL80211_ATTR_FRAME


	)

3129 
	#NL80211_ATTR_SSID
 
NL80211_ATTR_SSID


	)

3130 
	#NL80211_ATTR_AUTH_TYPE
 
NL80211_ATTR_AUTH_TYPE


	)

3131 
	#NL80211_ATTR_REASON_CODE
 
NL80211_ATTR_REASON_CODE


	)

3132 
	#NL80211_ATTR_CIPHER_SUITES_PAIRWISE
 
NL80211_ATTR_CIPHER_SUITES_PAIRWISE


	)

3133 
	#NL80211_ATTR_CIPHER_SUITE_GROUP
 
NL80211_ATTR_CIPHER_SUITE_GROUP


	)

3134 
	#NL80211_ATTR_WPA_VERSIONS
 
NL80211_ATTR_WPA_VERSIONS


	)

3135 
	#NL80211_ATTR_AKM_SUITES
 
NL80211_ATTR_AKM_SUITES


	)

3136 
	#NL80211_ATTR_KEY
 
NL80211_ATTR_KEY


	)

3137 
	#NL80211_ATTR_KEYS
 
NL80211_ATTR_KEYS


	)

3138 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

3140 
	#NL80211_WIPHY_NAME_MAXLEN
 64

	)

3142 
	#NL80211_MAX_SUPP_RATES
 32

	)

3143 
	#NL80211_MAX_SUPP_HT_RATES
 77

	)

3144 
	#NL80211_MAX_SUPP_REG_RULES
 128

	)

3145 
	#NL80211_TKIP_DATA_OFFSET_ENCR_KEY
 0

	)

3146 
	#NL80211_TKIP_DATA_OFFSET_TX_MIC_KEY
 16

	)

3147 
	#NL80211_TKIP_DATA_OFFSET_RX_MIC_KEY
 24

	)

3148 
	#NL80211_HT_CAPABILITY_LEN
 26

	)

3149 
	#NL80211_VHT_CAPABILITY_LEN
 12

	)

3150 
	#NL80211_HE_MIN_CAPABILITY_LEN
 16

	)

3151 
	#NL80211_HE_MAX_CAPABILITY_LEN
 54

	)

3152 
	#NL80211_MAX_NR_CIPHER_SUITES
 5

	)

3153 
	#NL80211_MAX_NR_AKM_SUITES
 2

	)

3155 
	#NL80211_MIN_REMAIN_ON_CHANNEL_TIME
 10

	)

3158 
	#NL80211_SCAN_RSSI_THOLD_OFF
 -300

	)

3160 
	#NL80211_CQM_TXE_MAX_INTVL
 1800

	)

3191 
	eÆ80211_iáy³
 {

3192 
	mNL80211_IFTYPE_UNSPECIFIED
,

3193 
	mNL80211_IFTYPE_ADHOC
,

3194 
	mNL80211_IFTYPE_STATION
,

3195 
	mNL80211_IFTYPE_AP
,

3196 
	mNL80211_IFTYPE_AP_VLAN
,

3197 
	mNL80211_IFTYPE_WDS
,

3198 
	mNL80211_IFTYPE_MONITOR
,

3199 
	mNL80211_IFTYPE_MESH_POINT
,

3200 
	mNL80211_IFTYPE_P2P_CLIENT
,

3201 
	mNL80211_IFTYPE_P2P_GO
,

3202 
	mNL80211_IFTYPE_P2P_DEVICE
,

3203 
	mNL80211_IFTYPE_OCB
,

3204 
	mNL80211_IFTYPE_NAN
,

3207 
	mNUM_NL80211_IFTYPES
,

3208 
	mNL80211_IFTYPE_MAX
 = 
NUM_NL80211_IFTYPES
 - 1

3235 
	eÆ80211_¡a_æags
 {

3236 
	m__NL80211_STA_FLAG_INVALID
,

3237 
	mNL80211_STA_FLAG_AUTHORIZED
,

3238 
	mNL80211_STA_FLAG_SHORT_PREAMBLE
,

3239 
	mNL80211_STA_FLAG_WME
,

3240 
	mNL80211_STA_FLAG_MFP
,

3241 
	mNL80211_STA_FLAG_AUTHENTICATED
,

3242 
	mNL80211_STA_FLAG_TDLS_PEER
,

3243 
	mNL80211_STA_FLAG_ASSOCIATED
,

3246 
	m__NL80211_STA_FLAG_AFTER_LAST
,

3247 
	mNL80211_STA_FLAG_MAX
 = 
__NL80211_STA_FLAG_AFTER_LAST
 - 1

3257 
	eÆ80211_¡a_p2p_ps_¡©us
 {

3258 
	mNL80211_P2P_PS_UNSUPPORTED
 = 0,

3259 
	mNL80211_P2P_PS_SUPPORTED
,

3261 
	mNUM_NL80211_P2P_PS_STATUS
,

3264 
	#NL80211_STA_FLAG_MAX_OLD_API
 
NL80211_STA_FLAG_TDLS_PEER


	)

3273 
	sÆ80211_¡a_æag_upd©e
 {

3274 
__u32
 
	mmask
;

3275 
__u32
 
	m£t
;

3276 } 
__©Œibu‹__
((
·cked
));

3284 
	eÆ80211_he_gi
 {

3285 
	mNL80211_RATE_INFO_HE_GI_0_8
,

3286 
	mNL80211_RATE_INFO_HE_GI_1_6
,

3287 
	mNL80211_RATE_INFO_HE_GI_3_2
,

3296 
	eÆ80211_he_Éf
 {

3297 
	mNL80211_RATE_INFO_HE_1XLTF
,

3298 
	mNL80211_RATE_INFO_HE_2XLTF
,

3299 
	mNL80211_RATE_INFO_HE_4XLTF
,

3312 
	eÆ80211_he_ru_®loc
 {

3313 
	mNL80211_RATE_INFO_HE_RU_ALLOC_26
,

3314 
	mNL80211_RATE_INFO_HE_RU_ALLOC_52
,

3315 
	mNL80211_RATE_INFO_HE_RU_ALLOC_106
,

3316 
	mNL80211_RATE_INFO_HE_RU_ALLOC_242
,

3317 
	mNL80211_RATE_INFO_HE_RU_ALLOC_484
,

3318 
	mNL80211_RATE_INFO_HE_RU_ALLOC_996
,

3319 
	mNL80211_RATE_INFO_HE_RU_ALLOC_2x996
,

3363 
	eÆ80211_¿‹_šfo
 {

3364 
	m__NL80211_RATE_INFO_INVALID
,

3365 
	mNL80211_RATE_INFO_BITRATE
,

3366 
	mNL80211_RATE_INFO_MCS
,

3367 
	mNL80211_RATE_INFO_40_MHZ_WIDTH
,

3368 
	mNL80211_RATE_INFO_SHORT_GI
,

3369 
	mNL80211_RATE_INFO_BITRATE32
,

3370 
	mNL80211_RATE_INFO_VHT_MCS
,

3371 
	mNL80211_RATE_INFO_VHT_NSS
,

3372 
	mNL80211_RATE_INFO_80_MHZ_WIDTH
,

3373 
	mNL80211_RATE_INFO_80P80_MHZ_WIDTH
,

3374 
	mNL80211_RATE_INFO_160_MHZ_WIDTH
,

3375 
	mNL80211_RATE_INFO_10_MHZ_WIDTH
,

3376 
	mNL80211_RATE_INFO_5_MHZ_WIDTH
,

3377 
	mNL80211_RATE_INFO_HE_MCS
,

3378 
	mNL80211_RATE_INFO_HE_NSS
,

3379 
	mNL80211_RATE_INFO_HE_GI
,

3380 
	mNL80211_RATE_INFO_HE_DCM
,

3381 
	mNL80211_RATE_INFO_HE_RU_ALLOC
,

3384 
	m__NL80211_RATE_INFO_AFTER_LAST
,

3385 
	mNL80211_RATE_INFO_MAX
 = 
__NL80211_RATE_INFO_AFTER_LAST
 - 1

3405 
	eÆ80211_¡a_bss_·¿m
 {

3406 
	m__NL80211_STA_BSS_PARAM_INVALID
,

3407 
	mNL80211_STA_BSS_PARAM_CTS_PROT
,

3408 
	mNL80211_STA_BSS_PARAM_SHORT_PREAMBLE
,

3409 
	mNL80211_STA_BSS_PARAM_SHORT_SLOT_TIME
,

3410 
	mNL80211_STA_BSS_PARAM_DTIM_PERIOD
,

3411 
	mNL80211_STA_BSS_PARAM_BEACON_INTERVAL
,

3414 
	m__NL80211_STA_BSS_PARAM_AFTER_LAST
,

3415 
	mNL80211_STA_BSS_PARAM_MAX
 = 
__NL80211_STA_BSS_PARAM_AFTER_LAST
 - 1

3501 
	eÆ80211_¡a_šfo
 {

3502 
	m__NL80211_STA_INFO_INVALID
,

3503 
	mNL80211_STA_INFO_INACTIVE_TIME
,

3504 
	mNL80211_STA_INFO_RX_BYTES
,

3505 
	mNL80211_STA_INFO_TX_BYTES
,

3506 
	mNL80211_STA_INFO_LLID
,

3507 
	mNL80211_STA_INFO_PLID
,

3508 
	mNL80211_STA_INFO_PLINK_STATE
,

3509 
	mNL80211_STA_INFO_SIGNAL
,

3510 
	mNL80211_STA_INFO_TX_BITRATE
,

3511 
	mNL80211_STA_INFO_RX_PACKETS
,

3512 
	mNL80211_STA_INFO_TX_PACKETS
,

3513 
	mNL80211_STA_INFO_TX_RETRIES
,

3514 
	mNL80211_STA_INFO_TX_FAILED
,

3515 
	mNL80211_STA_INFO_SIGNAL_AVG
,

3516 
	mNL80211_STA_INFO_RX_BITRATE
,

3517 
	mNL80211_STA_INFO_BSS_PARAM
,

3518 
	mNL80211_STA_INFO_CONNECTED_TIME
,

3519 
	mNL80211_STA_INFO_STA_FLAGS
,

3520 
	mNL80211_STA_INFO_BEACON_LOSS
,

3521 
	mNL80211_STA_INFO_T_OFFSET
,

3522 
	mNL80211_STA_INFO_LOCAL_PM
,

3523 
	mNL80211_STA_INFO_PEER_PM
,

3524 
	mNL80211_STA_INFO_NONPEER_PM
,

3525 
	mNL80211_STA_INFO_RX_BYTES64
,

3526 
	mNL80211_STA_INFO_TX_BYTES64
,

3527 
	mNL80211_STA_INFO_CHAIN_SIGNAL
,

3528 
	mNL80211_STA_INFO_CHAIN_SIGNAL_AVG
,

3529 
	mNL80211_STA_INFO_EXPECTED_THROUGHPUT
,

3530 
	mNL80211_STA_INFO_RX_DROP_MISC
,

3531 
	mNL80211_STA_INFO_BEACON_RX
,

3532 
	mNL80211_STA_INFO_BEACON_SIGNAL_AVG
,

3533 
	mNL80211_STA_INFO_TID_STATS
,

3534 
	mNL80211_STA_INFO_RX_DURATION
,

3535 
	mNL80211_STA_INFO_PAD
,

3536 
	mNL80211_STA_INFO_ACK_SIGNAL
,

3537 
	mNL80211_STA_INFO_ACK_SIGNAL_AVG
,

3538 
	mNL80211_STA_INFO_RX_MPDUS
,

3539 
	mNL80211_STA_INFO_FCS_ERROR_COUNT
,

3540 
	mNL80211_STA_INFO_CONNECTED_TO_GATE
,

3541 
	mNL80211_STA_INFO_TX_DURATION
,

3542 
	mNL80211_STA_INFO_AIRTIME_WEIGHT
,

3543 
	mNL80211_STA_INFO_AIRTIME_LINK_METRIC
,

3544 
	mNL80211_STA_INFO_ASSOC_AT_BOOTTIME
,

3545 
	mNL80211_STA_INFO_CONNECTED_TO_AS
,

3548 
	m__NL80211_STA_INFO_AFTER_LAST
,

3549 
	mNL80211_STA_INFO_MAX
 = 
__NL80211_STA_INFO_AFTER_LAST
 - 1

3553 
	#NL80211_STA_INFO_DATA_ACK_SIGNAL_AVG
 
NL80211_STA_INFO_ACK_SIGNAL_AVG


	)

3571 
	eÆ80211_tid_¡©s
 {

3572 
	m__NL80211_TID_STATS_INVALID
,

3573 
	mNL80211_TID_STATS_RX_MSDU
,

3574 
	mNL80211_TID_STATS_TX_MSDU
,

3575 
	mNL80211_TID_STATS_TX_MSDU_RETRIES
,

3576 
	mNL80211_TID_STATS_TX_MSDU_FAILED
,

3577 
	mNL80211_TID_STATS_PAD
,

3578 
	mNL80211_TID_STATS_TXQ_STATS
,

3581 
	mNUM_NL80211_TID_STATS
,

3582 
	mNL80211_TID_STATS_MAX
 = 
NUM_NL80211_TID_STATS
 - 1

3604 
	eÆ80211_txq_¡©s
 {

3605 
	m__NL80211_TXQ_STATS_INVALID
,

3606 
	mNL80211_TXQ_STATS_BACKLOG_BYTES
,

3607 
	mNL80211_TXQ_STATS_BACKLOG_PACKETS
,

3608 
	mNL80211_TXQ_STATS_FLOWS
,

3609 
	mNL80211_TXQ_STATS_DROPS
,

3610 
	mNL80211_TXQ_STATS_ECN_MARKS
,

3611 
	mNL80211_TXQ_STATS_OVERLIMIT
,

3612 
	mNL80211_TXQ_STATS_OVERMEMORY
,

3613 
	mNL80211_TXQ_STATS_COLLISIONS
,

3614 
	mNL80211_TXQ_STATS_TX_BYTES
,

3615 
	mNL80211_TXQ_STATS_TX_PACKETS
,

3616 
	mNL80211_TXQ_STATS_MAX_FLOWS
,

3619 
	mNUM_NL80211_TXQ_STATS
,

3620 
	mNL80211_TXQ_STATS_MAX
 = 
NUM_NL80211_TXQ_STATS
 - 1

3632 
	eÆ80211_m·th_æags
 {

3633 
	mNL80211_MPATH_FLAG_ACTIVE
 = 1<<0,

3634 
	mNL80211_MPATH_FLAG_RESOLVING
 = 1<<1,

3635 
	mNL80211_MPATH_FLAG_SN_VALID
 = 1<<2,

3636 
	mNL80211_MPATH_FLAG_FIXED
 = 1<<3,

3637 
	mNL80211_MPATH_FLAG_RESOLVED
 = 1<<4,

3661 
	eÆ80211_m·th_šfo
 {

3662 
	m__NL80211_MPATH_INFO_INVALID
,

3663 
	mNL80211_MPATH_INFO_FRAME_QLEN
,

3664 
	mNL80211_MPATH_INFO_SN
,

3665 
	mNL80211_MPATH_INFO_METRIC
,

3666 
	mNL80211_MPATH_INFO_EXPTIME
,

3667 
	mNL80211_MPATH_INFO_FLAGS
,

3668 
	mNL80211_MPATH_INFO_DISCOVERY_TIMEOUT
,

3669 
	mNL80211_MPATH_INFO_DISCOVERY_RETRIES
,

3670 
	mNL80211_MPATH_INFO_HOP_COUNT
,

3671 
	mNL80211_MPATH_INFO_PATH_CHANGE
,

3674 
	m__NL80211_MPATH_INFO_AFTER_LAST
,

3675 
	mNL80211_MPATH_INFO_MAX
 = 
__NL80211_MPATH_INFO_AFTER_LAST
 - 1

3700 
	eÆ80211_bªd_iáy³_©Œ
 {

3701 
	m__NL80211_BAND_IFTYPE_ATTR_INVALID
,

3703 
	mNL80211_BAND_IFTYPE_ATTR_IFTYPES
,

3704 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_MAC
,

3705 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_PHY
,

3706 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_MCS_SET
,

3707 
	mNL80211_BAND_IFTYPE_ATTR_HE_CAP_PPE
,

3708 
	mNL80211_BAND_IFTYPE_ATTR_HE_6GHZ_CAPA
,

3709 
	mNL80211_BAND_IFTYPE_ATTR_VENDOR_ELEMS
,

3712 
	m__NL80211_BAND_IFTYPE_ATTR_AFTER_LAST
,

3713 
	mNL80211_BAND_IFTYPE_ATTR_MAX
 = 
__NL80211_BAND_IFTYPE_ATTR_AFTER_LAST
 - 1

3742 
	eÆ80211_bªd_©Œ
 {

3743 
	m__NL80211_BAND_ATTR_INVALID
,

3744 
	mNL80211_BAND_ATTR_FREQS
,

3745 
	mNL80211_BAND_ATTR_RATES
,

3747 
	mNL80211_BAND_ATTR_HT_MCS_SET
,

3748 
	mNL80211_BAND_ATTR_HT_CAPA
,

3749 
	mNL80211_BAND_ATTR_HT_AMPDU_FACTOR
,

3750 
	mNL80211_BAND_ATTR_HT_AMPDU_DENSITY
,

3752 
	mNL80211_BAND_ATTR_VHT_MCS_SET
,

3753 
	mNL80211_BAND_ATTR_VHT_CAPA
,

3754 
	mNL80211_BAND_ATTR_IFTYPE_DATA
,

3756 
	mNL80211_BAND_ATTR_EDMG_CHANNELS
,

3757 
	mNL80211_BAND_ATTR_EDMG_BW_CONFIG
,

3760 
	m__NL80211_BAND_ATTR_AFTER_LAST
,

3761 
	mNL80211_BAND_ATTR_MAX
 = 
__NL80211_BAND_ATTR_AFTER_LAST
 - 1

3764 
	#NL80211_BAND_ATTR_HT_CAPA
 
NL80211_BAND_ATTR_HT_CAPA


	)

3777 
	eÆ80211_wmm_ruË
 {

3778 
	m__NL80211_WMMR_INVALID
,

3779 
	mNL80211_WMMR_CW_MIN
,

3780 
	mNL80211_WMMR_CW_MAX
,

3781 
	mNL80211_WMMR_AIFSN
,

3782 
	mNL80211_WMMR_TXOP
,

3785 
	m__NL80211_WMMR_LAST
,

3786 
	mNL80211_WMMR_MAX
 = 
__NL80211_WMMR_LAST
 - 1

3863 
	eÆ80211_äequ’cy_©Œ
 {

3864 
	m__NL80211_FREQUENCY_ATTR_INVALID
,

3865 
	mNL80211_FREQUENCY_ATTR_FREQ
,

3866 
	mNL80211_FREQUENCY_ATTR_DISABLED
,

3867 
	mNL80211_FREQUENCY_ATTR_NO_IR
,

3868 
	m__NL80211_FREQUENCY_ATTR_NO_IBSS
,

3869 
	mNL80211_FREQUENCY_ATTR_RADAR
,

3870 
	mNL80211_FREQUENCY_ATTR_MAX_TX_POWER
,

3871 
	mNL80211_FREQUENCY_ATTR_DFS_STATE
,

3872 
	mNL80211_FREQUENCY_ATTR_DFS_TIME
,

3873 
	mNL80211_FREQUENCY_ATTR_NO_HT40_MINUS
,

3874 
	mNL80211_FREQUENCY_ATTR_NO_HT40_PLUS
,

3875 
	mNL80211_FREQUENCY_ATTR_NO_80MHZ
,

3876 
	mNL80211_FREQUENCY_ATTR_NO_160MHZ
,

3877 
	mNL80211_FREQUENCY_ATTR_DFS_CAC_TIME
,

3878 
	mNL80211_FREQUENCY_ATTR_INDOOR_ONLY
,

3879 
	mNL80211_FREQUENCY_ATTR_IR_CONCURRENT
,

3880 
	mNL80211_FREQUENCY_ATTR_NO_20MHZ
,

3881 
	mNL80211_FREQUENCY_ATTR_NO_10MHZ
,

3882 
	mNL80211_FREQUENCY_ATTR_WMM
,

3883 
	mNL80211_FREQUENCY_ATTR_NO_HE
,

3884 
	mNL80211_FREQUENCY_ATTR_OFFSET
,

3885 
	mNL80211_FREQUENCY_ATTR_1MHZ
,

3886 
	mNL80211_FREQUENCY_ATTR_2MHZ
,

3887 
	mNL80211_FREQUENCY_ATTR_4MHZ
,

3888 
	mNL80211_FREQUENCY_ATTR_8MHZ
,

3889 
	mNL80211_FREQUENCY_ATTR_16MHZ
,

3892 
	m__NL80211_FREQUENCY_ATTR_AFTER_LAST
,

3893 
	mNL80211_FREQUENCY_ATTR_MAX
 = 
__NL80211_FREQUENCY_ATTR_AFTER_LAST
 - 1

3896 
	#NL80211_FREQUENCY_ATTR_MAX_TX_POWER
 
NL80211_FREQUENCY_ATTR_MAX_TX_POWER


	)

3897 
	#NL80211_FREQUENCY_ATTR_PASSIVE_SCAN
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3898 
	#NL80211_FREQUENCY_ATTR_NO_IBSS
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3899 
	#NL80211_FREQUENCY_ATTR_NO_IR
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3900 
	#NL80211_FREQUENCY_ATTR_GO_CONCURRENT
 \

3901 
NL80211_FREQUENCY_ATTR_IR_CONCURRENT


	)

3913 
	eÆ80211_b™¿‹_©Œ
 {

3914 
	m__NL80211_BITRATE_ATTR_INVALID
,

3915 
	mNL80211_BITRATE_ATTR_RATE
,

3916 
	mNL80211_BITRATE_ATTR_2GHZ_SHORTPREAMBLE
,

3919 
	m__NL80211_BITRATE_ATTR_AFTER_LAST
,

3920 
	mNL80211_BITRATE_ATTR_MAX
 = 
__NL80211_BITRATE_ATTR_AFTER_LAST
 - 1

3939 
	eÆ80211_»g_š™ŸtÜ
 {

3940 
	mNL80211_REGDOM_SET_BY_CORE
,

3941 
	mNL80211_REGDOM_SET_BY_USER
,

3942 
	mNL80211_REGDOM_SET_BY_DRIVER
,

3943 
	mNL80211_REGDOM_SET_BY_COUNTRY_IE
,

3962 
	eÆ80211_»g_ty³
 {

3963 
	mNL80211_REGDOM_TYPE_COUNTRY
,

3964 
	mNL80211_REGDOM_TYPE_WORLD
,

3965 
	mNL80211_REGDOM_TYPE_CUSTOM_WORLD
,

3966 
	mNL80211_REGDOM_TYPE_INTERSECTION
,

3994 
	eÆ80211_»g_ruË_©Œ
 {

3995 
	m__NL80211_REG_RULE_ATTR_INVALID
,

3996 
	mNL80211_ATTR_REG_RULE_FLAGS
,

3998 
	mNL80211_ATTR_FREQ_RANGE_START
,

3999 
	mNL80211_ATTR_FREQ_RANGE_END
,

4000 
	mNL80211_ATTR_FREQ_RANGE_MAX_BW
,

4002 
	mNL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
,

4003 
	mNL80211_ATTR_POWER_RULE_MAX_EIRP
,

4005 
	mNL80211_ATTR_DFS_CAC_TIME
,

4008 
	m__NL80211_REG_RULE_ATTR_AFTER_LAST
,

4009 
	mNL80211_REG_RULE_ATTR_MAX
 = 
__NL80211_REG_RULE_ATTR_AFTER_LAST
 - 1

4047 
	eÆ80211_sched_sÿn_m©ch_©Œ
 {

4048 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_INVALID
,

4050 
	mNL80211_SCHED_SCAN_MATCH_ATTR_SSID
,

4051 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI
,

4052 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RELATIVE_RSSI
,

4053 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI_ADJUST
,

4054 
	mNL80211_SCHED_SCAN_MATCH_ATTR_BSSID
,

4055 
	mNL80211_SCHED_SCAN_MATCH_PER_BAND_RSSI
,

4058 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
,

4059 
	mNL80211_SCHED_SCAN_MATCH_ATTR_MAX
 =

4060 
__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
 - 1

4064 
	#NL80211_ATTR_SCHED_SCAN_MATCH_SSID
 
NL80211_SCHED_SCAN_MATCH_ATTR_SSID


	)

4089 
	eÆ80211_»g_ruË_æags
 {

4090 
	mNL80211_RRF_NO_OFDM
 = 1<<0,

4091 
	mNL80211_RRF_NO_CCK
 = 1<<1,

4092 
	mNL80211_RRF_NO_INDOOR
 = 1<<2,

4093 
	mNL80211_RRF_NO_OUTDOOR
 = 1<<3,

4094 
	mNL80211_RRF_DFS
 = 1<<4,

4095 
	mNL80211_RRF_PTP_ONLY
 = 1<<5,

4096 
	mNL80211_RRF_PTMP_ONLY
 = 1<<6,

4097 
	mNL80211_RRF_NO_IR
 = 1<<7,

4098 
	m__NL80211_RRF_NO_IBSS
 = 1<<8,

4099 
	mNL80211_RRF_AUTO_BW
 = 1<<11,

4100 
	mNL80211_RRF_IR_CONCURRENT
 = 1<<12,

4101 
	mNL80211_RRF_NO_HT40MINUS
 = 1<<13,

4102 
	mNL80211_RRF_NO_HT40PLUS
 = 1<<14,

4103 
	mNL80211_RRF_NO_80MHZ
 = 1<<15,

4104 
	mNL80211_RRF_NO_160MHZ
 = 1<<16,

4105 
	mNL80211_RRF_NO_HE
 = 1<<17,

4108 
	#NL80211_RRF_PASSIVE_SCAN
 
NL80211_RRF_NO_IR


	)

4109 
	#NL80211_RRF_NO_IBSS
 
NL80211_RRF_NO_IR


	)

4110 
	#NL80211_RRF_NO_IR
 
NL80211_RRF_NO_IR


	)

4111 
	#NL80211_RRF_NO_HT40
 (
NL80211_RRF_NO_HT40MINUS
 |\

4112 
NL80211_RRF_NO_HT40PLUS
)

	)

4113 
	#NL80211_RRF_GO_CONCURRENT
 
NL80211_RRF_IR_CONCURRENT


	)

4116 
	#NL80211_RRF_NO_IR_ALL
 (
NL80211_RRF_NO_IR
 | 
__NL80211_RRF_NO_IBSS
)

	)

4126 
	eÆ80211_dfs_»giÚs
 {

4127 
	mNL80211_DFS_UNSET
 = 0,

4128 
	mNL80211_DFS_FCC
 = 1,

4129 
	mNL80211_DFS_ETSI
 = 2,

4130 
	mNL80211_DFS_JP
 = 3,

4150 
	eÆ80211_u£r_»g_hšt_ty³
 {

4151 
	mNL80211_USER_REG_HINT_USER
 = 0,

4152 
	mNL80211_USER_REG_HINT_CELL_BASE
 = 1,

4153 
	mNL80211_USER_REG_HINT_INDOOR
 = 2,

4186 
	eÆ80211_survey_šfo
 {

4187 
	m__NL80211_SURVEY_INFO_INVALID
,

4188 
	mNL80211_SURVEY_INFO_FREQUENCY
,

4189 
	mNL80211_SURVEY_INFO_NOISE
,

4190 
	mNL80211_SURVEY_INFO_IN_USE
,

4191 
	mNL80211_SURVEY_INFO_TIME
,

4192 
	mNL80211_SURVEY_INFO_TIME_BUSY
,

4193 
	mNL80211_SURVEY_INFO_TIME_EXT_BUSY
,

4194 
	mNL80211_SURVEY_INFO_TIME_RX
,

4195 
	mNL80211_SURVEY_INFO_TIME_TX
,

4196 
	mNL80211_SURVEY_INFO_TIME_SCAN
,

4197 
	mNL80211_SURVEY_INFO_PAD
,

4198 
	mNL80211_SURVEY_INFO_TIME_BSS_RX
,

4199 
	mNL80211_SURVEY_INFO_FREQUENCY_OFFSET
,

4202 
	m__NL80211_SURVEY_INFO_AFTER_LAST
,

4203 
	mNL80211_SURVEY_INFO_MAX
 = 
__NL80211_SURVEY_INFO_AFTER_LAST
 - 1

4207 
	#NL80211_SURVEY_INFO_CHANNEL_TIME
 
NL80211_SURVEY_INFO_TIME


	)

4208 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_BUSY
 
NL80211_SURVEY_INFO_TIME_BUSY


	)

4209 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_EXT_BUSY
 
NL80211_SURVEY_INFO_TIME_EXT_BUSY


	)

4210 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_RX
 
NL80211_SURVEY_INFO_TIME_RX


	)

4211 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_TX
 
NL80211_SURVEY_INFO_TIME_TX


	)

4232 
	eÆ80211_mÁr_æags
 {

4233 
	m__NL80211_MNTR_FLAG_INVALID
,

4234 
	mNL80211_MNTR_FLAG_FCSFAIL
,

4235 
	mNL80211_MNTR_FLAG_PLCPFAIL
,

4236 
	mNL80211_MNTR_FLAG_CONTROL
,

4237 
	mNL80211_MNTR_FLAG_OTHER_BSS
,

4238 
	mNL80211_MNTR_FLAG_COOK_FRAMES
,

4239 
	mNL80211_MNTR_FLAG_ACTIVE
,

4242 
	m__NL80211_MNTR_FLAG_AFTER_LAST
,

4243 
	mNL80211_MNTR_FLAG_MAX
 = 
__NL80211_MNTR_FLAG_AFTER_LAST
 - 1

4264 
	eÆ80211_mesh_pow”_mode
 {

4265 
	mNL80211_MESH_POWER_UNKNOWN
,

4266 
	mNL80211_MESH_POWER_ACTIVE
,

4267 
	mNL80211_MESH_POWER_LIGHT_SLEEP
,

4268 
	mNL80211_MESH_POWER_DEEP_SLEEP
,

4270 
	m__NL80211_MESH_POWER_AFTER_LAST
,

4271 
	mNL80211_MESH_POWER_MAX
 = 
__NL80211_MESH_POWER_AFTER_LAST
 - 1

4397 
	eÆ80211_meshcÚf_·¿ms
 {

4398 
	m__NL80211_MESHCONF_INVALID
,

4399 
	mNL80211_MESHCONF_RETRY_TIMEOUT
,

4400 
	mNL80211_MESHCONF_CONFIRM_TIMEOUT
,

4401 
	mNL80211_MESHCONF_HOLDING_TIMEOUT
,

4402 
	mNL80211_MESHCONF_MAX_PEER_LINKS
,

4403 
	mNL80211_MESHCONF_MAX_RETRIES
,

4404 
	mNL80211_MESHCONF_TTL
,

4405 
	mNL80211_MESHCONF_AUTO_OPEN_PLINKS
,

4406 
	mNL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

4407 
	mNL80211_MESHCONF_PATH_REFRESH_TIME
,

4408 
	mNL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

4409 
	mNL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

4410 
	mNL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

4411 
	mNL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

4412 
	mNL80211_MESHCONF_HWMP_ROOTMODE
,

4413 
	mNL80211_MESHCONF_ELEMENT_TTL
,

4414 
	mNL80211_MESHCONF_HWMP_RANN_INTERVAL
,

4415 
	mNL80211_MESHCONF_GATE_ANNOUNCEMENTS
,

4416 
	mNL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
,

4417 
	mNL80211_MESHCONF_FORWARDING
,

4418 
	mNL80211_MESHCONF_RSSI_THRESHOLD
,

4419 
	mNL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
,

4420 
	mNL80211_MESHCONF_HT_OPMODE
,

4421 
	mNL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
,

4422 
	mNL80211_MESHCONF_HWMP_ROOT_INTERVAL
,

4423 
	mNL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
,

4424 
	mNL80211_MESHCONF_POWER_MODE
,

4425 
	mNL80211_MESHCONF_AWAKE_WINDOW
,

4426 
	mNL80211_MESHCONF_PLINK_TIMEOUT
,

4427 
	mNL80211_MESHCONF_CONNECTED_TO_GATE
,

4428 
	mNL80211_MESHCONF_NOLEARN
,

4429 
	mNL80211_MESHCONF_CONNECTED_TO_AS
,

4432 
	m__NL80211_MESHCONF_ATTR_AFTER_LAST
,

4433 
	mNL80211_MESHCONF_ATTR_MAX
 = 
__NL80211_MESHCONF_ATTR_AFTER_LAST
 - 1

4485 
	eÆ80211_mesh_£tup_·¿ms
 {

4486 
	m__NL80211_MESH_SETUP_INVALID
,

4487 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
,

4488 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
,

4489 
	mNL80211_MESH_SETUP_IE
,

4490 
	mNL80211_MESH_SETUP_USERSPACE_AUTH
,

4491 
	mNL80211_MESH_SETUP_USERSPACE_AMPE
,

4492 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
,

4493 
	mNL80211_MESH_SETUP_USERSPACE_MPM
,

4494 
	mNL80211_MESH_SETUP_AUTH_PROTOCOL
,

4497 
	m__NL80211_MESH_SETUP_ATTR_AFTER_LAST
,

4498 
	mNL80211_MESH_SETUP_ATTR_MAX
 = 
__NL80211_MESH_SETUP_ATTR_AFTER_LAST
 - 1

4515 
	eÆ80211_txq_©Œ
 {

4516 
	m__NL80211_TXQ_ATTR_INVALID
,

4517 
	mNL80211_TXQ_ATTR_AC
,

4518 
	mNL80211_TXQ_ATTR_TXOP
,

4519 
	mNL80211_TXQ_ATTR_CWMIN
,

4520 
	mNL80211_TXQ_ATTR_CWMAX
,

4521 
	mNL80211_TXQ_ATTR_AIFS
,

4524 
	m__NL80211_TXQ_ATTR_AFTER_LAST
,

4525 
	mNL80211_TXQ_ATTR_MAX
 = 
__NL80211_TXQ_ATTR_AFTER_LAST
 - 1

4528 
	eÆ80211_ac
 {

4529 
	mNL80211_AC_VO
,

4530 
	mNL80211_AC_VI
,

4531 
	mNL80211_AC_BE
,

4532 
	mNL80211_AC_BK
,

4533 
	mNL80211_NUM_ACS


4537 
	#NL80211_TXQ_ATTR_QUEUE
 
NL80211_TXQ_ATTR_AC


	)

4538 
	#NL80211_TXQ_Q_VO
 
NL80211_AC_VO


	)

4539 
	#NL80211_TXQ_Q_VI
 
NL80211_AC_VI


	)

4540 
	#NL80211_TXQ_Q_BE
 
NL80211_AC_BE


	)

4541 
	#NL80211_TXQ_Q_BK
 
NL80211_AC_BK


	)

4552 
	eÆ80211_chªÃl_ty³
 {

4553 
	mNL80211_CHAN_NO_HT
,

4554 
	mNL80211_CHAN_HT20
,

4555 
	mNL80211_CHAN_HT40MINUS
,

4556 
	mNL80211_CHAN_HT40PLUS


4574 
	eÆ80211_key_mode
 {

4575 
	mNL80211_KEY_RX_TX
,

4576 
	mNL80211_KEY_NO_TX
,

4577 
	mNL80211_KEY_SET_TX


4604 
	eÆ80211_chª_width
 {

4605 
	mNL80211_CHAN_WIDTH_20_NOHT
,

4606 
	mNL80211_CHAN_WIDTH_20
,

4607 
	mNL80211_CHAN_WIDTH_40
,

4608 
	mNL80211_CHAN_WIDTH_80
,

4609 
	mNL80211_CHAN_WIDTH_80P80
,

4610 
	mNL80211_CHAN_WIDTH_160
,

4611 
	mNL80211_CHAN_WIDTH_5
,

4612 
	mNL80211_CHAN_WIDTH_10
,

4613 
	mNL80211_CHAN_WIDTH_1
,

4614 
	mNL80211_CHAN_WIDTH_2
,

4615 
	mNL80211_CHAN_WIDTH_4
,

4616 
	mNL80211_CHAN_WIDTH_8
,

4617 
	mNL80211_CHAN_WIDTH_16
,

4631 
	eÆ80211_bss_sÿn_width
 {

4632 
	mNL80211_BSS_CHAN_WIDTH_20
,

4633 
	mNL80211_BSS_CHAN_WIDTH_10
,

4634 
	mNL80211_BSS_CHAN_WIDTH_5
,

4635 
	mNL80211_BSS_CHAN_WIDTH_1
,

4636 
	mNL80211_BSS_CHAN_WIDTH_2
,

4692 
	eÆ80211_bss
 {

4693 
	m__NL80211_BSS_INVALID
,

4694 
	mNL80211_BSS_BSSID
,

4695 
	mNL80211_BSS_FREQUENCY
,

4696 
	mNL80211_BSS_TSF
,

4697 
	mNL80211_BSS_BEACON_INTERVAL
,

4698 
	mNL80211_BSS_CAPABILITY
,

4699 
	mNL80211_BSS_INFORMATION_ELEMENTS
,

4700 
	mNL80211_BSS_SIGNAL_MBM
,

4701 
	mNL80211_BSS_SIGNAL_UNSPEC
,

4702 
	mNL80211_BSS_STATUS
,

4703 
	mNL80211_BSS_SEEN_MS_AGO
,

4704 
	mNL80211_BSS_BEACON_IES
,

4705 
	mNL80211_BSS_CHAN_WIDTH
,

4706 
	mNL80211_BSS_BEACON_TSF
,

4707 
	mNL80211_BSS_PRESP_DATA
,

4708 
	mNL80211_BSS_LAST_SEEN_BOOTTIME
,

4709 
	mNL80211_BSS_PAD
,

4710 
	mNL80211_BSS_PARENT_TSF
,

4711 
	mNL80211_BSS_PARENT_BSSID
,

4712 
	mNL80211_BSS_CHAIN_SIGNAL
,

4713 
	mNL80211_BSS_FREQUENCY_OFFSET
,

4716 
	m__NL80211_BSS_AFTER_LAST
,

4717 
	mNL80211_BSS_MAX
 = 
__NL80211_BSS_AFTER_LAST
 - 1

4732 
	eÆ80211_bss_¡©us
 {

4733 
	mNL80211_BSS_STATUS_AUTHENTICATED
,

4734 
	mNL80211_BSS_STATUS_ASSOCIATED
,

4735 
	mNL80211_BSS_STATUS_IBSS_JOINED
,

4755 
	eÆ80211_auth_ty³
 {

4756 
	mNL80211_AUTHTYPE_OPEN_SYSTEM
,

4757 
	mNL80211_AUTHTYPE_SHARED_KEY
,

4758 
	mNL80211_AUTHTYPE_FT
,

4759 
	mNL80211_AUTHTYPE_NETWORK_EAP
,

4760 
	mNL80211_AUTHTYPE_SAE
,

4761 
	mNL80211_AUTHTYPE_FILS_SK
,

4762 
	mNL80211_AUTHTYPE_FILS_SK_PFS
,

4763 
	mNL80211_AUTHTYPE_FILS_PK
,

4766 
	m__NL80211_AUTHTYPE_NUM
,

4767 
	mNL80211_AUTHTYPE_MAX
 = 
__NL80211_AUTHTYPE_NUM
 - 1,

4768 
	mNL80211_AUTHTYPE_AUTOMATIC


4778 
	eÆ80211_key_ty³
 {

4779 
	mNL80211_KEYTYPE_GROUP
,

4780 
	mNL80211_KEYTYPE_PAIRWISE
,

4781 
	mNL80211_KEYTYPE_PEERKEY
,

4783 
	mNUM_NL80211_KEYTYPES


4792 
	eÆ80211_må
 {

4793 
	mNL80211_MFP_NO
,

4794 
	mNL80211_MFP_REQUIRED
,

4795 
	mNL80211_MFP_OPTIONAL
,

4798 
	eÆ80211_w·_v”siÚs
 {

4799 
	mNL80211_WPA_VERSION_1
 = 1 << 0,

4800 
	mNL80211_WPA_VERSION_2
 = 1 << 1,

4801 
	mNL80211_WPA_VERSION_3
 = 1 << 2,

4813 
	eÆ80211_key_deçuÉ_ty³s
 {

4814 
	m__NL80211_KEY_DEFAULT_TYPE_INVALID
,

4815 
	mNL80211_KEY_DEFAULT_TYPE_UNICAST
,

4816 
	mNL80211_KEY_DEFAULT_TYPE_MULTICAST
,

4818 
	mNUM_NL80211_KEY_DEFAULT_TYPES


4847 
	eÆ80211_key_©Œibu‹s
 {

4848 
	m__NL80211_KEY_INVALID
,

4849 
	mNL80211_KEY_DATA
,

4850 
	mNL80211_KEY_IDX
,

4851 
	mNL80211_KEY_CIPHER
,

4852 
	mNL80211_KEY_SEQ
,

4853 
	mNL80211_KEY_DEFAULT
,

4854 
	mNL80211_KEY_DEFAULT_MGMT
,

4855 
	mNL80211_KEY_TYPE
,

4856 
	mNL80211_KEY_DEFAULT_TYPES
,

4857 
	mNL80211_KEY_MODE
,

4858 
	mNL80211_KEY_DEFAULT_BEACON
,

4861 
	m__NL80211_KEY_AFTER_LAST
,

4862 
	mNL80211_KEY_MAX
 = 
__NL80211_KEY_AFTER_LAST
 - 1

4884 
	eÆ80211_tx_¿‹_©Œibu‹s
 {

4885 
	m__NL80211_TXRATE_INVALID
,

4886 
	mNL80211_TXRATE_LEGACY
,

4887 
	mNL80211_TXRATE_HT
,

4888 
	mNL80211_TXRATE_VHT
,

4889 
	mNL80211_TXRATE_GI
,

4890 
	mNL80211_TXRATE_HE
,

4891 
	mNL80211_TXRATE_HE_GI
,

4892 
	mNL80211_TXRATE_HE_LTF
,

4895 
	m__NL80211_TXRATE_AFTER_LAST
,

4896 
	mNL80211_TXRATE_MAX
 = 
__NL80211_TXRATE_AFTER_LAST
 - 1

4899 
	#NL80211_TXRATE_MCS
 
NL80211_TXRATE_HT


	)

4900 
	#NL80211_VHT_NSS_MAX
 8

	)

4906 
	sÆ80211_tx¿‹_vht
 {

4907 
__u16
 
	mmcs
[
NL80211_VHT_NSS_MAX
];

4910 
	#NL80211_HE_NSS_MAX
 8

	)

4915 
	sÆ80211_tx¿‹_he
 {

4916 
__u16
 
	mmcs
[
NL80211_HE_NSS_MAX
];

4919 
	eÆ80211_tx¿‹_gi
 {

4920 
	mNL80211_TXRATE_DEFAULT_GI
,

4921 
	mNL80211_TXRATE_FORCE_SGI
,

4922 
	mNL80211_TXRATE_FORCE_LGI
,

4935 
	eÆ80211_bªd
 {

4936 
	mNL80211_BAND_2GHZ
,

4937 
	mNL80211_BAND_5GHZ
,

4938 
	mNL80211_BAND_60GHZ
,

4939 
	mNL80211_BAND_6GHZ
,

4940 
	mNL80211_BAND_S1GHZ
,

4942 
	mNUM_NL80211_BANDS
,

4950 
	eÆ80211_ps_¡©e
 {

4951 
	mNL80211_PS_DISABLED
,

4952 
	mNL80211_PS_ENABLED
,

4988 
	eÆ80211_©Œ_cqm
 {

4989 
	m__NL80211_ATTR_CQM_INVALID
,

4990 
	mNL80211_ATTR_CQM_RSSI_THOLD
,

4991 
	mNL80211_ATTR_CQM_RSSI_HYST
,

4992 
	mNL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
,

4993 
	mNL80211_ATTR_CQM_PKT_LOSS_EVENT
,

4994 
	mNL80211_ATTR_CQM_TXE_RATE
,

4995 
	mNL80211_ATTR_CQM_TXE_PKTS
,

4996 
	mNL80211_ATTR_CQM_TXE_INTVL
,

4997 
	mNL80211_ATTR_CQM_BEACON_LOSS_EVENT
,

4998 
	mNL80211_ATTR_CQM_RSSI_LEVEL
,

5001 
	m__NL80211_ATTR_CQM_AFTER_LAST
,

5002 
	mNL80211_ATTR_CQM_MAX
 = 
__NL80211_ATTR_CQM_AFTER_LAST
 - 1

5013 
	eÆ80211_cqm_rssi_th»shŞd_ev’t
 {

5014 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_LOW
,

5015 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_HIGH
,

5016 
	mNL80211_CQM_RSSI_BEACON_LOSS_EVENT
,

5026 
	eÆ80211_tx_pow”_£‰šg
 {

5027 
	mNL80211_TX_POWER_AUTOMATIC
,

5028 
	mNL80211_TX_POWER_LIMITED
,

5029 
	mNL80211_TX_POWER_FIXED
,

5037 
	eÆ80211_tid_cÚfig
 {

5038 
	mNL80211_TID_CONFIG_ENABLE
,

5039 
	mNL80211_TID_CONFIG_DISABLE
,

5047 
	eÆ80211_tx_¿‹_£‰šg
 {

5048 
	mNL80211_TX_RATE_AUTOMATIC
,

5049 
	mNL80211_TX_RATE_LIMITED
,

5050 
	mNL80211_TX_RATE_FIXED
,

5097 
	eÆ80211_tid_cÚfig_©Œ
 {

5098 
	m__NL80211_TID_CONFIG_ATTR_INVALID
,

5099 
	mNL80211_TID_CONFIG_ATTR_PAD
,

5100 
	mNL80211_TID_CONFIG_ATTR_VIF_SUPP
,

5101 
	mNL80211_TID_CONFIG_ATTR_PEER_SUPP
,

5102 
	mNL80211_TID_CONFIG_ATTR_OVERRIDE
,

5103 
	mNL80211_TID_CONFIG_ATTR_TIDS
,

5104 
	mNL80211_TID_CONFIG_ATTR_NOACK
,

5105 
	mNL80211_TID_CONFIG_ATTR_RETRY_SHORT
,

5106 
	mNL80211_TID_CONFIG_ATTR_RETRY_LONG
,

5107 
	mNL80211_TID_CONFIG_ATTR_AMPDU_CTRL
,

5108 
	mNL80211_TID_CONFIG_ATTR_RTSCTS_CTRL
,

5109 
	mNL80211_TID_CONFIG_ATTR_AMSDU_CTRL
,

5110 
	mNL80211_TID_CONFIG_ATTR_TX_RATE_TYPE
,

5111 
	mNL80211_TID_CONFIG_ATTR_TX_RATE
,

5114 
	m__NL80211_TID_CONFIG_ATTR_AFTER_LAST
,

5115 
	mNL80211_TID_CONFIG_ATTR_MAX
 = 
__NL80211_TID_CONFIG_ATTR_AFTER_LAST
 - 1

5139 
	eÆ80211_·ck‘_·‰”n_©Œ
 {

5140 
	m__NL80211_PKTPAT_INVALID
,

5141 
	mNL80211_PKTPAT_MASK
,

5142 
	mNL80211_PKTPAT_PATTERN
,

5143 
	mNL80211_PKTPAT_OFFSET
,

5145 
	mNUM_NL80211_PKTPAT
,

5146 
	mMAX_NL80211_PKTPAT
 = 
NUM_NL80211_PKTPAT
 - 1,

5162 
	sÆ80211_·‰”n_suµÜt
 {

5163 
__u32
 
	mmax_·‰”ns
;

5164 
__u32
 
	mmš_·‰”n_Ën
;

5165 
__u32
 
	mmax_·‰”n_Ën
;

5166 
__u32
 
	mmax_pkt_off£t
;

5167 } 
__©Œibu‹__
((
·cked
));

5170 
	#__NL80211_WOWLAN_PKTPAT_INVALID
 
__NL80211_PKTPAT_INVALID


	)

5171 
	#NL80211_WOWLAN_PKTPAT_MASK
 
NL80211_PKTPAT_MASK


	)

5172 
	#NL80211_WOWLAN_PKTPAT_PATTERN
 
NL80211_PKTPAT_PATTERN


	)

5173 
	#NL80211_WOWLAN_PKTPAT_OFFSET
 
NL80211_PKTPAT_OFFSET


	)

5174 
	#NUM_NL80211_WOWLAN_PKTPAT
 
NUM_NL80211_PKTPAT


	)

5175 
	#MAX_NL80211_WOWLAN_PKTPAT
 
MAX_NL80211_PKTPAT


	)

5176 
	#Æ80211_wowÏn_·‰”n_suµÜt
 
Æ80211_·‰”n_suµÜt


	)

5267 
	eÆ80211_wowÏn_Œigg”s
 {

5268 
	m__NL80211_WOWLAN_TRIG_INVALID
,

5269 
	mNL80211_WOWLAN_TRIG_ANY
,

5270 
	mNL80211_WOWLAN_TRIG_DISCONNECT
,

5271 
	mNL80211_WOWLAN_TRIG_MAGIC_PKT
,

5272 
	mNL80211_WOWLAN_TRIG_PKT_PATTERN
,

5273 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
,

5274 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
,

5275 
	mNL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
,

5276 
	mNL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
,

5277 
	mNL80211_WOWLAN_TRIG_RFKILL_RELEASE
,

5278 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211
,

5279 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211_LEN
,

5280 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023
,

5281 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023_LEN
,

5282 
	mNL80211_WOWLAN_TRIG_TCP_CONNECTION
,

5283 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_MATCH
,

5284 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_CONNLOST
,

5285 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_NOMORETOKENS
,

5286 
	mNL80211_WOWLAN_TRIG_NET_DETECT
,

5287 
	mNL80211_WOWLAN_TRIG_NET_DETECT_RESULTS
,

5290 
	mNUM_NL80211_WOWLAN_TRIG
,

5291 
	mMAX_NL80211_WOWLAN_TRIG
 = 
NUM_NL80211_WOWLAN_TRIG
 - 1

5327 
	sÆ80211_wowÏn_tı_d©a_£q
 {

5328 
__u32
 
	m¡¬t
, 
	moff£t
, 
	mËn
;

5338 
	sÆ80211_wowÏn_tı_d©a_tok’
 {

5339 
__u32
 
	moff£t
, 
	mËn
;

5340 
__u8
 
	mtok’_¡»am
[];

5349 
	sÆ80211_wowÏn_tı_d©a_tok’_ã©u»
 {

5350 
__u32
 
	mmš_Ën
, 
	mmax_Ën
, 
	mbufsize
;

5385 
	eÆ80211_wowÏn_tı_©Œs
 {

5386 
	m__NL80211_WOWLAN_TCP_INVALID
,

5387 
	mNL80211_WOWLAN_TCP_SRC_IPV4
,

5388 
	mNL80211_WOWLAN_TCP_DST_IPV4
,

5389 
	mNL80211_WOWLAN_TCP_DST_MAC
,

5390 
	mNL80211_WOWLAN_TCP_SRC_PORT
,

5391 
	mNL80211_WOWLAN_TCP_DST_PORT
,

5392 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD
,

5393 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
,

5394 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
,

5395 
	mNL80211_WOWLAN_TCP_DATA_INTERVAL
,

5396 
	mNL80211_WOWLAN_TCP_WAKE_PAYLOAD
,

5397 
	mNL80211_WOWLAN_TCP_WAKE_MASK
,

5400 
	mNUM_NL80211_WOWLAN_TCP
,

5401 
	mMAX_NL80211_WOWLAN_TCP
 = 
NUM_NL80211_WOWLAN_TCP
 - 1

5413 
	sÆ80211_cßËsû_ruË_suµÜt
 {

5414 
__u32
 
	mmax_ruËs
;

5415 
Æ80211_·‰”n_suµÜt
 
	m·t
;

5416 
__u32
 
	mmax_d–ay
;

5417 } 
__©Œibu‹__
((
·cked
));

5430 
	eÆ80211_©Œ_cßËsû_ruË
 {

5431 
	m__NL80211_COALESCE_RULE_INVALID
,

5432 
	mNL80211_ATTR_COALESCE_RULE_DELAY
,

5433 
	mNL80211_ATTR_COALESCE_RULE_CONDITION
,

5434 
	mNL80211_ATTR_COALESCE_RULE_PKT_PATTERN
,

5437 
	mNUM_NL80211_ATTR_COALESCE_RULE
,

5438 
	mNL80211_ATTR_COALESCE_RULE_MAX
 = 
NUM_NL80211_ATTR_COALESCE_RULE
 - 1

5448 
	eÆ80211_cßËsû_cÚd™iÚ
 {

5449 
	mNL80211_COALESCE_CONDITION_MATCH
,

5450 
	mNL80211_COALESCE_CONDITION_NO_MATCH


5463 
	eÆ80211_içû_lim™_©Œs
 {

5464 
	mNL80211_IFACE_LIMIT_UNSPEC
,

5465 
	mNL80211_IFACE_LIMIT_MAX
,

5466 
	mNL80211_IFACE_LIMIT_TYPES
,

5469 
	mNUM_NL80211_IFACE_LIMIT
,

5470 
	mMAX_NL80211_IFACE_LIMIT
 = 
NUM_NL80211_IFACE_LIMIT
 - 1

5522 
	eÆ80211_if_combš©iÚ_©Œs
 {

5523 
	mNL80211_IFACE_COMB_UNSPEC
,

5524 
	mNL80211_IFACE_COMB_LIMITS
,

5525 
	mNL80211_IFACE_COMB_MAXNUM
,

5526 
	mNL80211_IFACE_COMB_STA_AP_BI_MATCH
,

5527 
	mNL80211_IFACE_COMB_NUM_CHANNELS
,

5528 
	mNL80211_IFACE_COMB_RADAR_DETECT_WIDTHS
,

5529 
	mNL80211_IFACE_COMB_RADAR_DETECT_REGIONS
,

5530 
	mNL80211_IFACE_COMB_BI_MIN_GCD
,

5533 
	mNUM_NL80211_IFACE_COMB
,

5534 
	mMAX_NL80211_IFACE_COMB
 = 
NUM_NL80211_IFACE_COMB
 - 1

5556 
	eÆ80211_¶šk_¡©e
 {

5557 
	mNL80211_PLINK_LISTEN
,

5558 
	mNL80211_PLINK_OPN_SNT
,

5559 
	mNL80211_PLINK_OPN_RCVD
,

5560 
	mNL80211_PLINK_CNF_RCVD
,

5561 
	mNL80211_PLINK_ESTAB
,

5562 
	mNL80211_PLINK_HOLDING
,

5563 
	mNL80211_PLINK_BLOCKED
,

5566 
	mNUM_NL80211_PLINK_STATES
,

5567 
	mMAX_NL80211_PLINK_STATES
 = 
NUM_NL80211_PLINK_STATES
 - 1

5578 
	e¶šk_aùiÚs
 {

5579 
	mNL80211_PLINK_ACTION_NO_ACTION
,

5580 
	mNL80211_PLINK_ACTION_OPEN
,

5581 
	mNL80211_PLINK_ACTION_BLOCK
,

5583 
	mNUM_NL80211_PLINK_ACTIONS
,

5587 
	#NL80211_KCK_LEN
 16

	)

5588 
	#NL80211_KEK_LEN
 16

	)

5589 
	#NL80211_KCK_EXT_LEN
 24

	)

5590 
	#NL80211_KEK_EXT_LEN
 32

	)

5591 
	#NL80211_REPLAY_CTR_LEN
 8

	)

5603 
	eÆ80211_»key_d©a
 {

5604 
	m__NL80211_REKEY_DATA_INVALID
,

5605 
	mNL80211_REKEY_DATA_KEK
,

5606 
	mNL80211_REKEY_DATA_KCK
,

5607 
	mNL80211_REKEY_DATA_REPLAY_CTR
,

5608 
	mNL80211_REKEY_DATA_AKM
,

5611 
	mNUM_NL80211_REKEY_DATA
,

5612 
	mMAX_NL80211_REKEY_DATA
 = 
NUM_NL80211_REKEY_DATA
 - 1

5624 
	eÆ80211_hidd’_ssid
 {

5625 
	mNL80211_HIDDEN_SSID_NOT_IN_USE
,

5626 
	mNL80211_HIDDEN_SSID_ZERO_LEN
,

5627 
	mNL80211_HIDDEN_SSID_ZERO_CONTENTS


5640 
	eÆ80211_¡a_wme_©Œ
 {

5641 
	m__NL80211_STA_WME_INVALID
,

5642 
	mNL80211_STA_WME_UAPSD_QUEUES
,

5643 
	mNL80211_STA_WME_MAX_SP
,

5646 
	m__NL80211_STA_WME_AFTER_LAST
,

5647 
	mNL80211_STA_WME_MAX
 = 
__NL80211_STA_WME_AFTER_LAST
 - 1

5662 
	eÆ80211_pmk§_ÿndid©e_©Œ
 {

5663 
	m__NL80211_PMKSA_CANDIDATE_INVALID
,

5664 
	mNL80211_PMKSA_CANDIDATE_INDEX
,

5665 
	mNL80211_PMKSA_CANDIDATE_BSSID
,

5666 
	mNL80211_PMKSA_CANDIDATE_PREAUTH
,

5669 
	mNUM_NL80211_PMKSA_CANDIDATE
,

5670 
	mMAX_NL80211_PMKSA_CANDIDATE
 = 
NUM_NL80211_PMKSA_CANDIDATE
 - 1

5681 
	eÆ80211_tdls_İ”©iÚ
 {

5682 
	mNL80211_TDLS_DISCOVERY_REQ
,

5683 
	mNL80211_TDLS_SETUP
,

5684 
	mNL80211_TDLS_TEARDOWN
,

5685 
	mNL80211_TDLS_ENABLE_LINK
,

5686 
	mNL80211_TDLS_DISABLE_LINK
,

5790 
	eÆ80211_ã©u»_æags
 {

5791 
	mNL80211_FEATURE_SK_TX_STATUS
 = 1 << 0,

5792 
	mNL80211_FEATURE_HT_IBSS
 = 1 << 1,

5793 
	mNL80211_FEATURE_INACTIVITY_TIMER
 = 1 << 2,

5794 
	mNL80211_FEATURE_CELL_BASE_REG_HINTS
 = 1 << 3,

5795 
	mNL80211_FEATURE_P2P_DEVICE_NEEDS_CHANNEL
 = 1 << 4,

5796 
	mNL80211_FEATURE_SAE
 = 1 << 5,

5797 
	mNL80211_FEATURE_LOW_PRIORITY_SCAN
 = 1 << 6,

5798 
	mNL80211_FEATURE_SCAN_FLUSH
 = 1 << 7,

5799 
	mNL80211_FEATURE_AP_SCAN
 = 1 << 8,

5800 
	mNL80211_FEATURE_VIF_TXPOWER
 = 1 << 9,

5801 
	mNL80211_FEATURE_NEED_OBSS_SCAN
 = 1 << 10,

5802 
	mNL80211_FEATURE_P2P_GO_CTWIN
 = 1 << 11,

5803 
	mNL80211_FEATURE_P2P_GO_OPPPS
 = 1 << 12,

5805 
	mNL80211_FEATURE_ADVERTISE_CHAN_LIMITS
 = 1 << 14,

5806 
	mNL80211_FEATURE_FULL_AP_CLIENT_STATE
 = 1 << 15,

5807 
	mNL80211_FEATURE_USERSPACE_MPM
 = 1 << 16,

5808 
	mNL80211_FEATURE_ACTIVE_MONITOR
 = 1 << 17,

5809 
	mNL80211_FEATURE_AP_MODE_CHAN_WIDTH_CHANGE
 = 1 << 18,

5810 
	mNL80211_FEATURE_DS_PARAM_SET_IE_IN_PROBES
 = 1 << 19,

5811 
	mNL80211_FEATURE_WFA_TPC_IE_IN_PROBES
 = 1 << 20,

5812 
	mNL80211_FEATURE_QUIET
 = 1 << 21,

5813 
	mNL80211_FEATURE_TX_POWER_INSERTION
 = 1 << 22,

5814 
	mNL80211_FEATURE_ACKTO_ESTIMATION
 = 1 << 23,

5815 
	mNL80211_FEATURE_STATIC_SMPS
 = 1 << 24,

5816 
	mNL80211_FEATURE_DYNAMIC_SMPS
 = 1 << 25,

5817 
	mNL80211_FEATURE_SUPPORTS_WMM_ADMISSION
 = 1 << 26,

5818 
	mNL80211_FEATURE_MAC_ON_CREATE
 = 1 << 27,

5819 
	mNL80211_FEATURE_TDLS_CHANNEL_SWITCH
 = 1 << 28,

5820 
	mNL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
 = 1 << 29,

5821 
	mNL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
 = 1 << 30,

5822 
	mNL80211_FEATURE_ND_RANDOM_MAC_ADDR
 = 1U << 31,

6001 
	eÆ80211_ext_ã©u»_šdex
 {

6002 
	mNL80211_EXT_FEATURE_VHT_IBSS
,

6003 
	mNL80211_EXT_FEATURE_RRM
,

6004 
	mNL80211_EXT_FEATURE_MU_MIMO_AIR_SNIFFER
,

6005 
	mNL80211_EXT_FEATURE_SCAN_START_TIME
,

6006 
	mNL80211_EXT_FEATURE_BSS_PARENT_TSF
,

6007 
	mNL80211_EXT_FEATURE_SET_SCAN_DWELL
,

6008 
	mNL80211_EXT_FEATURE_BEACON_RATE_LEGACY
,

6009 
	mNL80211_EXT_FEATURE_BEACON_RATE_HT
,

6010 
	mNL80211_EXT_FEATURE_BEACON_RATE_VHT
,

6011 
	mNL80211_EXT_FEATURE_FILS_STA
,

6012 
	mNL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA
,

6013 
	mNL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA_CONNECTED
,

6014 
	mNL80211_EXT_FEATURE_SCHED_SCAN_RELATIVE_RSSI
,

6015 
	mNL80211_EXT_FEATURE_CQM_RSSI_LIST
,

6016 
	mNL80211_EXT_FEATURE_FILS_SK_OFFLOAD
,

6017 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_PSK
,

6018 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_1X
,

6019 
	mNL80211_EXT_FEATURE_FILS_MAX_CHANNEL_TIME
,

6020 
	mNL80211_EXT_FEATURE_ACCEPT_BCAST_PROBE_RESP
,

6021 
	mNL80211_EXT_FEATURE_OCE_PROBE_REQ_HIGH_TX_RATE
,

6022 
	mNL80211_EXT_FEATURE_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
,

6023 
	mNL80211_EXT_FEATURE_MFP_OPTIONAL
,

6024 
	mNL80211_EXT_FEATURE_LOW_SPAN_SCAN
,

6025 
	mNL80211_EXT_FEATURE_LOW_POWER_SCAN
,

6026 
	mNL80211_EXT_FEATURE_HIGH_ACCURACY_SCAN
,

6027 
	mNL80211_EXT_FEATURE_DFS_OFFLOAD
,

6028 
	mNL80211_EXT_FEATURE_CONTROL_PORT_OVER_NL80211
,

6029 
	mNL80211_EXT_FEATURE_ACK_SIGNAL_SUPPORT
,

6031 
	mNL80211_EXT_FEATURE_DATA_ACK_SIGNAL_SUPPORT
 = 
NL80211_EXT_FEATURE_ACK_SIGNAL_SUPPORT
,

6032 
	mNL80211_EXT_FEATURE_TXQS
,

6033 
	mNL80211_EXT_FEATURE_SCAN_RANDOM_SN
,

6034 
	mNL80211_EXT_FEATURE_SCAN_MIN_PREQ_CONTENT
,

6035 
	mNL80211_EXT_FEATURE_CAN_REPLACE_PTK0
,

6036 
	mNL80211_EXT_FEATURE_ENABLE_FTM_RESPONDER
,

6037 
	mNL80211_EXT_FEATURE_AIRTIME_FAIRNESS
,

6038 
	mNL80211_EXT_FEATURE_AP_PMKSA_CACHING
,

6039 
	mNL80211_EXT_FEATURE_SCHED_SCAN_BAND_SPECIFIC_RSSI_THOLD
,

6040 
	mNL80211_EXT_FEATURE_EXT_KEY_ID
,

6041 
	mNL80211_EXT_FEATURE_STA_TX_PWR
,

6042 
	mNL80211_EXT_FEATURE_SAE_OFFLOAD
,

6043 
	mNL80211_EXT_FEATURE_VLAN_OFFLOAD
,

6044 
	mNL80211_EXT_FEATURE_AQL
,

6045 
	mNL80211_EXT_FEATURE_BEACON_PROTECTION
,

6046 
	mNL80211_EXT_FEATURE_CONTROL_PORT_NO_PREAUTH
,

6047 
	mNL80211_EXT_FEATURE_PROTECTED_TWT
,

6048 
	mNL80211_EXT_FEATURE_DEL_IBSS_STA
,

6049 
	mNL80211_EXT_FEATURE_MULTICAST_REGISTRATIONS
,

6050 
	mNL80211_EXT_FEATURE_BEACON_PROTECTION_CLIENT
,

6051 
	mNL80211_EXT_FEATURE_SCAN_FREQ_KHZ
,

6052 
	mNL80211_EXT_FEATURE_CONTROL_PORT_OVER_NL80211_TX_STATUS
,

6053 
	mNL80211_EXT_FEATURE_OPERATING_CHANNEL_VALIDATION
,

6054 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_AP_PSK
,

6055 
	mNL80211_EXT_FEATURE_SAE_OFFLOAD_AP
,

6056 
	mNL80211_EXT_FEATURE_FILS_DISCOVERY
,

6057 
	mNL80211_EXT_FEATURE_UNSOL_BCAST_PROBE_RESP
,

6058 
	mNL80211_EXT_FEATURE_BEACON_RATE_HE
,

6059 
	mNL80211_EXT_FEATURE_SECURE_LTF
,

6060 
	mNL80211_EXT_FEATURE_SECURE_RTT
,

6061 
	mNL80211_EXT_FEATURE_PROT_RANGE_NEGO_AND_MEASURE
,

6062 
	mNL80211_EXT_FEATURE_BSS_COLOR
,

6065 
	mNUM_NL80211_EXT_FEATURES
,

6066 
	mMAX_NL80211_EXT_FEATURES
 = 
NUM_NL80211_EXT_FEATURES
 - 1

6083 
	eÆ80211_´obe_»¥_ofæßd_suµÜt_©Œ
 {

6084 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS
 = 1<<0,

6085 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS2
 = 1<<1,

6086 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_P2P
 = 1<<2,

6087 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_80211U
 = 1<<3,

6096 
	eÆ80211_cÚÃù_çed_»asÚ
 {

6097 
	mNL80211_CONN_FAIL_MAX_CLIENTS
,

6098 
	mNL80211_CONN_FAIL_BLOCKED_CLIENT
,

6109 
	eÆ80211_timeout_»asÚ
 {

6110 
	mNL80211_TIMEOUT_UNSPECIFIED
,

6111 
	mNL80211_TIMEOUT_SCAN
,

6112 
	mNL80211_TIMEOUT_AUTH
,

6113 
	mNL80211_TIMEOUT_ASSOC
,

6180 
	eÆ80211_sÿn_æags
 {

6181 
	mNL80211_SCAN_FLAG_LOW_PRIORITY
 = 1<<0,

6182 
	mNL80211_SCAN_FLAG_FLUSH
 = 1<<1,

6183 
	mNL80211_SCAN_FLAG_AP
 = 1<<2,

6184 
	mNL80211_SCAN_FLAG_RANDOM_ADDR
 = 1<<3,

6185 
	mNL80211_SCAN_FLAG_FILS_MAX_CHANNEL_TIME
 = 1<<4,

6186 
	mNL80211_SCAN_FLAG_ACCEPT_BCAST_PROBE_RESP
 = 1<<5,

6187 
	mNL80211_SCAN_FLAG_OCE_PROBE_REQ_HIGH_TX_RATE
 = 1<<6,

6188 
	mNL80211_SCAN_FLAG_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
 = 1<<7,

6189 
	mNL80211_SCAN_FLAG_LOW_SPAN
 = 1<<8,

6190 
	mNL80211_SCAN_FLAG_LOW_POWER
 = 1<<9,

6191 
	mNL80211_SCAN_FLAG_HIGH_ACCURACY
 = 1<<10,

6192 
	mNL80211_SCAN_FLAG_RANDOM_SN
 = 1<<11,

6193 
	mNL80211_SCAN_FLAG_MIN_PREQ_CONTENT
 = 1<<12,

6194 
	mNL80211_SCAN_FLAG_FREQ_KHZ
 = 1<<13,

6195 
	mNL80211_SCAN_FLAG_COLOCATED_6GHZ
 = 1<<14,

6211 
	eÆ80211_aş_pŞicy
 {

6212 
	mNL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
,

6213 
	mNL80211_ACL_POLICY_DENY_UNLESS_LISTED
,

6226 
	eÆ80211_smps_mode
 {

6227 
	mNL80211_SMPS_OFF
,

6228 
	mNL80211_SMPS_STATIC
,

6229 
	mNL80211_SMPS_DYNAMIC
,

6231 
	m__NL80211_SMPS_AFTER_LAST
,

6232 
	mNL80211_SMPS_MAX
 = 
__NL80211_SMPS_AFTER_LAST
 - 1

6256 
	eÆ80211_¿d¬_ev’t
 {

6257 
	mNL80211_RADAR_DETECTED
,

6258 
	mNL80211_RADAR_CAC_FINISHED
,

6259 
	mNL80211_RADAR_CAC_ABORTED
,

6260 
	mNL80211_RADAR_NOP_FINISHED
,

6261 
	mNL80211_RADAR_PRE_CAC_EXPIRED
,

6262 
	mNL80211_RADAR_CAC_STARTED
,

6276 
	eÆ80211_dfs_¡©e
 {

6277 
	mNL80211_DFS_USABLE
,

6278 
	mNL80211_DFS_UNAVAILABLE
,

6279 
	mNL80211_DFS_AVAILABLE
,

6290 
	eÆ80211_´ÙocŞ_ã©u»s
 {

6291 
	mNL80211_PROTOCOL_FEATURE_SPLIT_WIPHY_DUMP
 = 1 << 0,

6303 
	eÆ80211_ü™_´Ùo_id
 {

6304 
	mNL80211_CRIT_PROTO_UNSPEC
,

6305 
	mNL80211_CRIT_PROTO_DHCP
,

6306 
	mNL80211_CRIT_PROTO_EAPOL
,

6307 
	mNL80211_CRIT_PROTO_APIPA
,

6309 
	mNUM_NL80211_CRIT_PROTO


6313 
	#NL80211_CRIT_PROTO_MAX_DURATION
 5000

	)

6326 
	eÆ80211_rxmgmt_æags
 {

6327 
	mNL80211_RXMGMT_FLAG_ANSWERED
 = 1 << 0,

6328 
	mNL80211_RXMGMT_FLAG_EXTERNAL_AUTH
 = 1 << 1,

6336 
	#NL80211_VENDOR_ID_IS_LINUX
 0x80000000

	)

6346 
	sÆ80211_v’dÜ_cmd_šfo
 {

6347 
__u32
 
	mv’dÜ_id
;

6348 
__u32
 
	msubcmd
;

6362 
	eÆ80211_tdls_³”_ÿ·b™y
 {

6363 
	mNL80211_TDLS_PEER_HT
 = 1<<0,

6364 
	mNL80211_TDLS_PEER_VHT
 = 1<<1,

6365 
	mNL80211_TDLS_PEER_WMM
 = 1<<2,

6366 
	mNL80211_TDLS_PEER_HE
 = 1<<3,

6382 
	eÆ80211_sched_sÿn_¶ª
 {

6383 
	m__NL80211_SCHED_SCAN_PLAN_INVALID
,

6384 
	mNL80211_SCHED_SCAN_PLAN_INTERVAL
,

6385 
	mNL80211_SCHED_SCAN_PLAN_ITERATIONS
,

6388 
	m__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
,

6389 
	mNL80211_SCHED_SCAN_PLAN_MAX
 =

6390 
__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
 - 1

6400 
	sÆ80211_bss_£Ëù_rssi_adju¡
 {

6401 
__u8
 
	mbªd
;

6402 
__s8
 
	md–
;

6403 } 
__©Œibu‹__
((
·cked
));

6427 
	eÆ80211_bss_£Ëù_©Œ
 {

6428 
	m__NL80211_BSS_SELECT_ATTR_INVALID
,

6429 
	mNL80211_BSS_SELECT_ATTR_RSSI
,

6430 
	mNL80211_BSS_SELECT_ATTR_BAND_PREF
,

6431 
	mNL80211_BSS_SELECT_ATTR_RSSI_ADJUST
,

6434 
	m__NL80211_BSS_SELECT_ATTR_AFTER_LAST
,

6435 
	mNL80211_BSS_SELECT_ATTR_MAX
 = 
__NL80211_BSS_SELECT_ATTR_AFTER_LAST
 - 1

6447 
	eÆ80211_Çn_funùiÚ_ty³
 {

6448 
	mNL80211_NAN_FUNC_PUBLISH
,

6449 
	mNL80211_NAN_FUNC_SUBSCRIBE
,

6450 
	mNL80211_NAN_FUNC_FOLLOW_UP
,

6453 
	m__NL80211_NAN_FUNC_TYPE_AFTER_LAST
,

6454 
	mNL80211_NAN_FUNC_MAX_TYPE
 = 
__NL80211_NAN_FUNC_TYPE_AFTER_LAST
 - 1,

6465 
	eÆ80211_Çn_publish_ty³
 {

6466 
	mNL80211_NAN_SOLICITED_PUBLISH
 = 1 << 0,

6467 
	mNL80211_NAN_UNSOLICITED_PUBLISH
 = 1 << 1,

6479 
	eÆ80211_Çn_func_‹rm_»asÚ
 {

6480 
	mNL80211_NAN_FUNC_TERM_REASON_USER_REQUEST
,

6481 
	mNL80211_NAN_FUNC_TERM_REASON_TTL_EXPIRED
,

6482 
	mNL80211_NAN_FUNC_TERM_REASON_ERROR
,

6485 
	#NL80211_NAN_FUNC_SERVICE_ID_LEN
 6

	)

6486 
	#NL80211_NAN_FUNC_SERVICE_SPEC_INFO_MAX_LEN
 0xff

	)

6487 
	#NL80211_NAN_FUNC_SRF_MAX_LEN
 0xff

	)

6531 
	eÆ80211_Çn_func_©Œibu‹s
 {

6532 
	m__NL80211_NAN_FUNC_INVALID
,

6533 
	mNL80211_NAN_FUNC_TYPE
,

6534 
	mNL80211_NAN_FUNC_SERVICE_ID
,

6535 
	mNL80211_NAN_FUNC_PUBLISH_TYPE
,

6536 
	mNL80211_NAN_FUNC_PUBLISH_BCAST
,

6537 
	mNL80211_NAN_FUNC_SUBSCRIBE_ACTIVE
,

6538 
	mNL80211_NAN_FUNC_FOLLOW_UP_ID
,

6539 
	mNL80211_NAN_FUNC_FOLLOW_UP_REQ_ID
,

6540 
	mNL80211_NAN_FUNC_FOLLOW_UP_DEST
,

6541 
	mNL80211_NAN_FUNC_CLOSE_RANGE
,

6542 
	mNL80211_NAN_FUNC_TTL
,

6543 
	mNL80211_NAN_FUNC_SERVICE_INFO
,

6544 
	mNL80211_NAN_FUNC_SRF
,

6545 
	mNL80211_NAN_FUNC_RX_MATCH_FILTER
,

6546 
	mNL80211_NAN_FUNC_TX_MATCH_FILTER
,

6547 
	mNL80211_NAN_FUNC_INSTANCE_ID
,

6548 
	mNL80211_NAN_FUNC_TERM_REASON
,

6551 
	mNUM_NL80211_NAN_FUNC_ATTR
,

6552 
	mNL80211_NAN_FUNC_ATTR_MAX
 = 
NUM_NL80211_NAN_FUNC_ATTR
 - 1

6570 
	eÆ80211_Çn_¤f_©Œibu‹s
 {

6571 
	m__NL80211_NAN_SRF_INVALID
,

6572 
	mNL80211_NAN_SRF_INCLUDE
,

6573 
	mNL80211_NAN_SRF_BF
,

6574 
	mNL80211_NAN_SRF_BF_IDX
,

6575 
	mNL80211_NAN_SRF_MAC_ADDRS
,

6578 
	mNUM_NL80211_NAN_SRF_ATTR
,

6579 
	mNL80211_NAN_SRF_ATTR_MAX
 = 
NUM_NL80211_NAN_SRF_ATTR
 - 1,

6595 
	eÆ80211_Çn_m©ch_©Œibu‹s
 {

6596 
	m__NL80211_NAN_MATCH_INVALID
,

6597 
	mNL80211_NAN_MATCH_FUNC_LOCAL
,

6598 
	mNL80211_NAN_MATCH_FUNC_PEER
,

6601 
	mNUM_NL80211_NAN_MATCH_ATTR
,

6602 
	mNL80211_NAN_MATCH_ATTR_MAX
 = 
NUM_NL80211_NAN_MATCH_ATTR
 - 1

6611 
	eÆ80211_ex‹º®_auth_aùiÚ
 {

6612 
	mNL80211_EXTERNAL_AUTH_START
,

6613 
	mNL80211_EXTERNAL_AUTH_ABORT
,

6630 
	eÆ80211_ám_»¥Úd”_©Œibu‹s
 {

6631 
	m__NL80211_FTM_RESP_ATTR_INVALID
,

6633 
	mNL80211_FTM_RESP_ATTR_ENABLED
,

6634 
	mNL80211_FTM_RESP_ATTR_LCI
,

6635 
	mNL80211_FTM_RESP_ATTR_CIVICLOC
,

6638 
	m__NL80211_FTM_RESP_ATTR_LAST
,

6639 
	mNL80211_FTM_RESP_ATTR_MAX
 = 
__NL80211_FTM_RESP_ATTR_LAST
 - 1,

6670 
	eÆ80211_ám_»¥Úd”_¡©s
 {

6671 
	m__NL80211_FTM_STATS_INVALID
,

6672 
	mNL80211_FTM_STATS_SUCCESS_NUM
,

6673 
	mNL80211_FTM_STATS_PARTIAL_NUM
,

6674 
	mNL80211_FTM_STATS_FAILED_NUM
,

6675 
	mNL80211_FTM_STATS_ASAP_NUM
,

6676 
	mNL80211_FTM_STATS_NON_ASAP_NUM
,

6677 
	mNL80211_FTM_STATS_TOTAL_DURATION_MSEC
,

6678 
	mNL80211_FTM_STATS_UNKNOWN_TRIGGERS_NUM
,

6679 
	mNL80211_FTM_STATS_RESCHEDULE_REQUESTS_NUM
,

6680 
	mNL80211_FTM_STATS_OUT_OF_WINDOW_TRIGGERS_NUM
,

6681 
	mNL80211_FTM_STATS_PAD
,

6684 
	m__NL80211_FTM_STATS_AFTER_LAST
,

6685 
	mNL80211_FTM_STATS_MAX
 = 
__NL80211_FTM_STATS_AFTER_LAST
 - 1

6696 
	eÆ80211_´—mbË
 {

6697 
	mNL80211_PREAMBLE_LEGACY
,

6698 
	mNL80211_PREAMBLE_HT
,

6699 
	mNL80211_PREAMBLE_VHT
,

6700 
	mNL80211_PREAMBLE_DMG
,

6701 
	mNL80211_PREAMBLE_HE
,

6714 
	eÆ80211_³”_m—su»m’t_ty³
 {

6715 
	mNL80211_PMSR_TYPE_INVALID
,

6717 
	mNL80211_PMSR_TYPE_FTM
,

6719 
	mNUM_NL80211_PMSR_TYPES
,

6720 
	mNL80211_PMSR_TYPE_MAX
 = 
NUM_NL80211_PMSR_TYPES
 - 1

6731 
	eÆ80211_³”_m—su»m’t_¡©us
 {

6732 
	mNL80211_PMSR_STATUS_SUCCESS
,

6733 
	mNL80211_PMSR_STATUS_REFUSED
,

6734 
	mNL80211_PMSR_STATUS_TIMEOUT
,

6735 
	mNL80211_PMSR_STATUS_FAILURE
,

6751 
	eÆ80211_³”_m—su»m’t_»q
 {

6752 
	m__NL80211_PMSR_REQ_ATTR_INVALID
,

6754 
	mNL80211_PMSR_REQ_ATTR_DATA
,

6755 
	mNL80211_PMSR_REQ_ATTR_GET_AP_TSF
,

6758 
	mNUM_NL80211_PMSR_REQ_ATTRS
,

6759 
	mNL80211_PMSR_REQ_ATTR_MAX
 = 
NUM_NL80211_PMSR_REQ_ATTRS
 - 1

6787 
	eÆ80211_³”_m—su»m’t_»¥
 {

6788 
	m__NL80211_PMSR_RESP_ATTR_INVALID
,

6790 
	mNL80211_PMSR_RESP_ATTR_DATA
,

6791 
	mNL80211_PMSR_RESP_ATTR_STATUS
,

6792 
	mNL80211_PMSR_RESP_ATTR_HOST_TIME
,

6793 
	mNL80211_PMSR_RESP_ATTR_AP_TSF
,

6794 
	mNL80211_PMSR_RESP_ATTR_FINAL
,

6795 
	mNL80211_PMSR_RESP_ATTR_PAD
,

6798 
	mNUM_NL80211_PMSR_RESP_ATTRS
,

6799 
	mNL80211_PMSR_RESP_ATTR_MAX
 = 
NUM_NL80211_PMSR_RESP_ATTRS
 - 1

6819 
	eÆ80211_³”_m—su»m’t_³”_©Œs
 {

6820 
	m__NL80211_PMSR_PEER_ATTR_INVALID
,

6822 
	mNL80211_PMSR_PEER_ATTR_ADDR
,

6823 
	mNL80211_PMSR_PEER_ATTR_CHAN
,

6824 
	mNL80211_PMSR_PEER_ATTR_REQ
,

6825 
	mNL80211_PMSR_PEER_ATTR_RESP
,

6828 
	mNUM_NL80211_PMSR_PEER_ATTRS
,

6829 
	mNL80211_PMSR_PEER_ATTR_MAX
 = 
NUM_NL80211_PMSR_PEER_ATTRS
 - 1,

6856 
	eÆ80211_³”_m—su»m’t_©Œs
 {

6857 
	m__NL80211_PMSR_ATTR_INVALID
,

6859 
	mNL80211_PMSR_ATTR_MAX_PEERS
,

6860 
	mNL80211_PMSR_ATTR_REPORT_AP_TSF
,

6861 
	mNL80211_PMSR_ATTR_RANDOMIZE_MAC_ADDR
,

6862 
	mNL80211_PMSR_ATTR_TYPE_CAPA
,

6863 
	mNL80211_PMSR_ATTR_PEERS
,

6866 
	mNUM_NL80211_PMSR_ATTR
,

6867 
	mNL80211_PMSR_ATTR_MAX
 = 
NUM_NL80211_PMSR_ATTR
 - 1

6902 
	eÆ80211_³”_m—su»m’t_ám_ÿ·
 {

6903 
	m__NL80211_PMSR_FTM_CAPA_ATTR_INVALID
,

6905 
	mNL80211_PMSR_FTM_CAPA_ATTR_ASAP
,

6906 
	mNL80211_PMSR_FTM_CAPA_ATTR_NON_ASAP
,

6907 
	mNL80211_PMSR_FTM_CAPA_ATTR_REQ_LCI
,

6908 
	mNL80211_PMSR_FTM_CAPA_ATTR_REQ_CIVICLOC
,

6909 
	mNL80211_PMSR_FTM_CAPA_ATTR_PREAMBLES
,

6910 
	mNL80211_PMSR_FTM_CAPA_ATTR_BANDWIDTHS
,

6911 
	mNL80211_PMSR_FTM_CAPA_ATTR_MAX_BURSTS_EXPONENT
,

6912 
	mNL80211_PMSR_FTM_CAPA_ATTR_MAX_FTMS_PER_BURST
,

6913 
	mNL80211_PMSR_FTM_CAPA_ATTR_TRIGGER_BASED
,

6914 
	mNL80211_PMSR_FTM_CAPA_ATTR_NON_TRIGGER_BASED
,

6917 
	mNUM_NL80211_PMSR_FTM_CAPA_ATTR
,

6918 
	mNL80211_PMSR_FTM_CAPA_ATTR_MAX
 = 
NUM_NL80211_PMSR_FTM_CAPA_ATTR
 - 1

6968 
	eÆ80211_³”_m—su»m’t_ám_»q
 {

6969 
	m__NL80211_PMSR_FTM_REQ_ATTR_INVALID
,

6971 
	mNL80211_PMSR_FTM_REQ_ATTR_ASAP
,

6972 
	mNL80211_PMSR_FTM_REQ_ATTR_PREAMBLE
,

6973 
	mNL80211_PMSR_FTM_REQ_ATTR_NUM_BURSTS_EXP
,

6974 
	mNL80211_PMSR_FTM_REQ_ATTR_BURST_PERIOD
,

6975 
	mNL80211_PMSR_FTM_REQ_ATTR_BURST_DURATION
,

6976 
	mNL80211_PMSR_FTM_REQ_ATTR_FTMS_PER_BURST
,

6977 
	mNL80211_PMSR_FTM_REQ_ATTR_NUM_FTMR_RETRIES
,

6978 
	mNL80211_PMSR_FTM_REQ_ATTR_REQUEST_LCI
,

6979 
	mNL80211_PMSR_FTM_REQ_ATTR_REQUEST_CIVICLOC
,

6980 
	mNL80211_PMSR_FTM_REQ_ATTR_TRIGGER_BASED
,

6981 
	mNL80211_PMSR_FTM_REQ_ATTR_NON_TRIGGER_BASED
,

6982 
	mNL80211_PMSR_FTM_REQ_ATTR_LMR_FEEDBACK
,

6983 
	mNL80211_PMSR_FTM_REQ_ATTR_BSS_COLOR
,

6986 
	mNUM_NL80211_PMSR_FTM_REQ_ATTR
,

6987 
	mNL80211_PMSR_FTM_REQ_ATTR_MAX
 = 
NUM_NL80211_PMSR_FTM_REQ_ATTR
 - 1

7006 
	eÆ80211_³”_m—su»m’t_ám_çu»_»asÚs
 {

7007 
	mNL80211_PMSR_FTM_FAILURE_UNSPECIFIED
,

7008 
	mNL80211_PMSR_FTM_FAILURE_NO_RESPONSE
,

7009 
	mNL80211_PMSR_FTM_FAILURE_REJECTED
,

7010 
	mNL80211_PMSR_FTM_FAILURE_WRONG_CHANNEL
,

7011 
	mNL80211_PMSR_FTM_FAILURE_PEER_NOT_CAPABLE
,

7012 
	mNL80211_PMSR_FTM_FAILURE_INVALID_TIMESTAMP
,

7013 
	mNL80211_PMSR_FTM_FAILURE_PEER_BUSY
,

7014 
	mNL80211_PMSR_FTM_FAILURE_BAD_CHANGED_PARAMS
,

7072 
	eÆ80211_³”_m—su»m’t_ám_»¥
 {

7073 
	m__NL80211_PMSR_FTM_RESP_ATTR_INVALID
,

7075 
	mNL80211_PMSR_FTM_RESP_ATTR_FAIL_REASON
,

7076 
	mNL80211_PMSR_FTM_RESP_ATTR_BURST_INDEX
,

7077 
	mNL80211_PMSR_FTM_RESP_ATTR_NUM_FTMR_ATTEMPTS
,

7078 
	mNL80211_PMSR_FTM_RESP_ATTR_NUM_FTMR_SUCCESSES
,

7079 
	mNL80211_PMSR_FTM_RESP_ATTR_BUSY_RETRY_TIME
,

7080 
	mNL80211_PMSR_FTM_RESP_ATTR_NUM_BURSTS_EXP
,

7081 
	mNL80211_PMSR_FTM_RESP_ATTR_BURST_DURATION
,

7082 
	mNL80211_PMSR_FTM_RESP_ATTR_FTMS_PER_BURST
,

7083 
	mNL80211_PMSR_FTM_RESP_ATTR_RSSI_AVG
,

7084 
	mNL80211_PMSR_FTM_RESP_ATTR_RSSI_SPREAD
,

7085 
	mNL80211_PMSR_FTM_RESP_ATTR_TX_RATE
,

7086 
	mNL80211_PMSR_FTM_RESP_ATTR_RX_RATE
,

7087 
	mNL80211_PMSR_FTM_RESP_ATTR_RTT_AVG
,

7088 
	mNL80211_PMSR_FTM_RESP_ATTR_RTT_VARIANCE
,

7089 
	mNL80211_PMSR_FTM_RESP_ATTR_RTT_SPREAD
,

7090 
	mNL80211_PMSR_FTM_RESP_ATTR_DIST_AVG
,

7091 
	mNL80211_PMSR_FTM_RESP_ATTR_DIST_VARIANCE
,

7092 
	mNL80211_PMSR_FTM_RESP_ATTR_DIST_SPREAD
,

7093 
	mNL80211_PMSR_FTM_RESP_ATTR_LCI
,

7094 
	mNL80211_PMSR_FTM_RESP_ATTR_CIVICLOC
,

7095 
	mNL80211_PMSR_FTM_RESP_ATTR_PAD
,

7098 
	mNUM_NL80211_PMSR_FTM_RESP_ATTR
,

7099 
	mNL80211_PMSR_FTM_RESP_ATTR_MAX
 = 
NUM_NL80211_PMSR_FTM_RESP_ATTR
 - 1

7119 
	eÆ80211_obss_pd_©Œibu‹s
 {

7120 
	m__NL80211_HE_OBSS_PD_ATTR_INVALID
,

7122 
	mNL80211_HE_OBSS_PD_ATTR_MIN_OFFSET
,

7123 
	mNL80211_HE_OBSS_PD_ATTR_MAX_OFFSET
,

7124 
	mNL80211_HE_OBSS_PD_ATTR_NON_SRG_MAX_OFFSET
,

7125 
	mNL80211_HE_OBSS_PD_ATTR_BSS_COLOR_BITMAP
,

7126 
	mNL80211_HE_OBSS_PD_ATTR_PARTIAL_BSSID_BITMAP
,

7127 
	mNL80211_HE_OBSS_PD_ATTR_SR_CTRL
,

7130 
	m__NL80211_HE_OBSS_PD_ATTR_LAST
,

7131 
	mNL80211_HE_OBSS_PD_ATTR_MAX
 = 
__NL80211_HE_OBSS_PD_ATTR_LAST
 - 1,

7145 
	eÆ80211_bss_cŞÜ_©Œibu‹s
 {

7146 
	m__NL80211_HE_BSS_COLOR_ATTR_INVALID
,

7148 
	mNL80211_HE_BSS_COLOR_ATTR_COLOR
,

7149 
	mNL80211_HE_BSS_COLOR_ATTR_DISABLED
,

7150 
	mNL80211_HE_BSS_COLOR_ATTR_PARTIAL
,

7153 
	m__NL80211_HE_BSS_COLOR_ATTR_LAST
,

7154 
	mNL80211_HE_BSS_COLOR_ATTR_MAX
 = 
__NL80211_HE_BSS_COLOR_ATTR_LAST
 - 1,

7170 
	eÆ80211_iáy³_akm_©Œibu‹s
 {

7171 
	m__NL80211_IFTYPE_AKM_ATTR_INVALID
,

7173 
	mNL80211_IFTYPE_AKM_ATTR_IFTYPES
,

7174 
	mNL80211_IFTYPE_AKM_ATTR_SUITES
,

7177 
	m__NL80211_IFTYPE_AKM_ATTR_LAST
,

7178 
	mNL80211_IFTYPE_AKM_ATTR_MAX
 = 
__NL80211_IFTYPE_AKM_ATTR_LAST
 - 1,

7197 
	eÆ80211_fs_discov”y_©Œibu‹s
 {

7198 
	m__NL80211_FILS_DISCOVERY_ATTR_INVALID
,

7200 
	mNL80211_FILS_DISCOVERY_ATTR_INT_MIN
,

7201 
	mNL80211_FILS_DISCOVERY_ATTR_INT_MAX
,

7202 
	mNL80211_FILS_DISCOVERY_ATTR_TMPL
,

7205 
	m__NL80211_FILS_DISCOVERY_ATTR_LAST
,

7206 
	mNL80211_FILS_DISCOVERY_ATTR_MAX
 = 
__NL80211_FILS_DISCOVERY_ATTR_LAST
 - 1

7213 
	#NL80211_FILS_DISCOVERY_TMPL_MIN_LEN
 42

	)

7230 
	eÆ80211_unsŞ_bÿ¡_´obe_»¥_©Œibu‹s
 {

7231 
	m__NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INVALID
,

7233 
	mNL80211_UNSOL_BCAST_PROBE_RESP_ATTR_INT
,

7234 
	mNL80211_UNSOL_BCAST_PROBE_RESP_ATTR_TMPL
,

7237 
	m__NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_LAST
,

7238 
	mNL80211_UNSOL_BCAST_PROBE_RESP_ATTR_MAX
 =

7239 
__NL80211_UNSOL_BCAST_PROBE_RESP_ATTR_LAST
 - 1

7254 
	eÆ80211_§e_pwe_mechªism
 {

7255 
	mNL80211_SAE_PWE_UNSPECIFIED
,

7256 
	mNL80211_SAE_PWE_HUNT_AND_PECK
,

7257 
	mNL80211_SAE_PWE_HASH_TO_ELEMENT
,

7258 
	mNL80211_SAE_PWE_BOTH
,

7267 
	eÆ80211_§r_ty³
 {

7268 
	mNL80211_SAR_TYPE_POWER
,

7273 
	mNUM_NL80211_SAR_TYPE
,

7297 
	eÆ80211_§r_©Œs
 {

7298 
	m__NL80211_SAR_ATTR_INVALID
,

7300 
	mNL80211_SAR_ATTR_TYPE
,

7301 
	mNL80211_SAR_ATTR_SPECS
,

7303 
	m__NL80211_SAR_ATTR_LAST
,

7304 
	mNL80211_SAR_ATTR_MAX
 = 
__NL80211_SAR_ATTR_LAST
 - 1,

7340 
	eÆ80211_§r_¥ecs_©Œs
 {

7341 
	m__NL80211_SAR_ATTR_SPECS_INVALID
,

7343 
	mNL80211_SAR_ATTR_SPECS_POWER
,

7344 
	mNL80211_SAR_ATTR_SPECS_RANGE_INDEX
,

7345 
	mNL80211_SAR_ATTR_SPECS_START_FREQ
,

7346 
	mNL80211_SAR_ATTR_SPECS_END_FREQ
,

7348 
	m__NL80211_SAR_ATTR_SPECS_LAST
,

7349 
	mNL80211_SAR_ATTR_SPECS_MAX
 = 
__NL80211_SAR_ATTR_SPECS_LAST
 - 1,

	@/usr/include/linux/poll.h

1 
	~<asm/pŞl.h
>

	@/usr/include/linux/rtnetlink.h

2 #iâdeà
__LINUX_RTNETLINK_H


3 
	#__LINUX_RTNETLINK_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

7 
	~<lšux/if_lšk.h
>

8 
	~<lšux/if_addr.h
>

9 
	~<lšux/Ãighbour.h
>

14 
	#RTNL_FAMILY_IPMR
 128

	)

15 
	#RTNL_FAMILY_IP6MR
 129

	)

16 
	#RTNL_FAMILY_MAX
 129

	)

25 
	mRTM_BASE
 = 16,

26 
	#RTM_BASE
 
RTM_BASE


	)

28 
	mRTM_NEWLINK
 = 16,

29 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

30 
	mRTM_DELLINK
,

31 
	#RTM_DELLINK
 
RTM_DELLINK


	)

32 
	mRTM_GETLINK
,

33 
	#RTM_GETLINK
 
RTM_GETLINK


	)

34 
	mRTM_SETLINK
,

35 
	#RTM_SETLINK
 
RTM_SETLINK


	)

37 
	mRTM_NEWADDR
 = 20,

38 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

39 
	mRTM_DELADDR
,

40 
	#RTM_DELADDR
 
RTM_DELADDR


	)

41 
	mRTM_GETADDR
,

42 
	#RTM_GETADDR
 
RTM_GETADDR


	)

44 
	mRTM_NEWROUTE
 = 24,

45 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

46 
	mRTM_DELROUTE
,

47 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

48 
	mRTM_GETROUTE
,

49 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

51 
	mRTM_NEWNEIGH
 = 28,

52 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

53 
	mRTM_DELNEIGH
,

54 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

55 
	mRTM_GETNEIGH
,

56 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

58 
	mRTM_NEWRULE
 = 32,

59 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

60 
	mRTM_DELRULE
,

61 
	#RTM_DELRULE
 
RTM_DELRULE


	)

62 
	mRTM_GETRULE
,

63 
	#RTM_GETRULE
 
RTM_GETRULE


	)

65 
	mRTM_NEWQDISC
 = 36,

66 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

67 
	mRTM_DELQDISC
,

68 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

69 
	mRTM_GETQDISC
,

70 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

72 
	mRTM_NEWTCLASS
 = 40,

73 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

74 
	mRTM_DELTCLASS
,

75 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

76 
	mRTM_GETTCLASS
,

77 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

79 
	mRTM_NEWTFILTER
 = 44,

80 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

81 
	mRTM_DELTFILTER
,

82 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

83 
	mRTM_GETTFILTER
,

84 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

86 
	mRTM_NEWACTION
 = 48,

87 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

88 
	mRTM_DELACTION
,

89 
	#RTM_DELACTION
 
RTM_DELACTION


	)

90 
	mRTM_GETACTION
,

91 
	#RTM_GETACTION
 
RTM_GETACTION


	)

93 
	mRTM_NEWPREFIX
 = 52,

94 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

96 
	mRTM_GETMULTICAST
 = 58,

97 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

99 
	mRTM_GETANYCAST
 = 62,

100 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

102 
	mRTM_NEWNEIGHTBL
 = 64,

103 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

104 
	mRTM_GETNEIGHTBL
 = 66,

105 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

106 
	mRTM_SETNEIGHTBL
,

107 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

109 
	mRTM_NEWNDUSEROPT
 = 68,

110 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

112 
	mRTM_NEWADDRLABEL
 = 72,

113 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

114 
	mRTM_DELADDRLABEL
,

115 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

116 
	mRTM_GETADDRLABEL
,

117 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

119 
	mRTM_GETDCB
 = 78,

120 
	#RTM_GETDCB
 
RTM_GETDCB


	)

121 
	mRTM_SETDCB
,

122 
	#RTM_SETDCB
 
RTM_SETDCB


	)

124 
	mRTM_NEWNETCONF
 = 80,

125 
	#RTM_NEWNETCONF
 
RTM_NEWNETCONF


	)

126 
	mRTM_DELNETCONF
,

127 
	#RTM_DELNETCONF
 
RTM_DELNETCONF


	)

128 
	mRTM_GETNETCONF
 = 82,

129 
	#RTM_GETNETCONF
 
RTM_GETNETCONF


	)

131 
	mRTM_NEWMDB
 = 84,

132 
	#RTM_NEWMDB
 
RTM_NEWMDB


	)

133 
	mRTM_DELMDB
 = 85,

134 
	#RTM_DELMDB
 
RTM_DELMDB


	)

135 
	mRTM_GETMDB
 = 86,

136 
	#RTM_GETMDB
 
RTM_GETMDB


	)

138 
	mRTM_NEWNSID
 = 88,

139 
	#RTM_NEWNSID
 
RTM_NEWNSID


	)

140 
	mRTM_DELNSID
 = 89,

141 
	#RTM_DELNSID
 
RTM_DELNSID


	)

142 
	mRTM_GETNSID
 = 90,

143 
	#RTM_GETNSID
 
RTM_GETNSID


	)

145 
	mRTM_NEWSTATS
 = 92,

146 
	#RTM_NEWSTATS
 
RTM_NEWSTATS


	)

147 
	mRTM_GETSTATS
 = 94,

148 
	#RTM_GETSTATS
 
RTM_GETSTATS


	)

150 
	mRTM_NEWCACHEREPORT
 = 96,

151 
	#RTM_NEWCACHEREPORT
 
RTM_NEWCACHEREPORT


	)

153 
	mRTM_NEWCHAIN
 = 100,

154 
	#RTM_NEWCHAIN
 
RTM_NEWCHAIN


	)

155 
	mRTM_DELCHAIN
,

156 
	#RTM_DELCHAIN
 
RTM_DELCHAIN


	)

157 
	mRTM_GETCHAIN
,

158 
	#RTM_GETCHAIN
 
RTM_GETCHAIN


	)

160 
	mRTM_NEWNEXTHOP
 = 104,

161 
	#RTM_NEWNEXTHOP
 
RTM_NEWNEXTHOP


	)

162 
	mRTM_DELNEXTHOP
,

163 
	#RTM_DELNEXTHOP
 
RTM_DELNEXTHOP


	)

164 
	mRTM_GETNEXTHOP
,

165 
	#RTM_GETNEXTHOP
 
RTM_GETNEXTHOP


	)

167 
	mRTM_NEWLINKPROP
 = 108,

168 
	#RTM_NEWLINKPROP
 
RTM_NEWLINKPROP


	)

169 
	mRTM_DELLINKPROP
,

170 
	#RTM_DELLINKPROP
 
RTM_DELLINKPROP


	)

171 
	mRTM_GETLINKPROP
,

172 
	#RTM_GETLINKPROP
 
RTM_GETLINKPROP


	)

174 
	mRTM_NEWVLAN
 = 112,

175 
	#RTM_NEWNVLAN
 
RTM_NEWVLAN


	)

176 
	mRTM_DELVLAN
,

177 
	#RTM_DELVLAN
 
RTM_DELVLAN


	)

178 
	mRTM_GETVLAN
,

179 
	#RTM_GETVLAN
 
RTM_GETVLAN


	)

181 
	mRTM_NEWNEXTHOPBUCKET
 = 116,

182 
	#RTM_NEWNEXTHOPBUCKET
 
RTM_NEWNEXTHOPBUCKET


	)

183 
	mRTM_DELNEXTHOPBUCKET
,

184 
	#RTM_DELNEXTHOPBUCKET
 
RTM_DELNEXTHOPBUCKET


	)

185 
	mRTM_GETNEXTHOPBUCKET
,

186 
	#RTM_GETNEXTHOPBUCKET
 
RTM_GETNEXTHOPBUCKET


	)

188 
	m__RTM_MAX
,

189 
	#RTM_MAX
 (((
__RTM_MAX
 + 3è& ~3è- 1)

	)

192 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

193 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

194 
	#RTM_FAM
(
cmd
è(((cmdè- 
RTM_BASE
è>> 2)

	)

202 
	s¹©Œ
 {

203 
	m¹a_Ën
;

204 
	m¹a_ty³
;

209 
	#RTA_ALIGNTO
 4U

	)

210 
	#RTA_ALIGN
(
Ën
èĞ(Ö’)+
RTA_ALIGNTO
-1è& ~(RTA_ALIGNTO-1è)

	)

211 
	#RTA_OK
(
¹a
,
Ën
è(Ö’è>ğ()(
¹©Œ
) && \

212 (
¹a
)->
¹a_Ën
 >ğ(
¹©Œ
) && \

213 (
¹a
)->
¹a_Ën
 <ğ(
Ën
))

	)

214 
	#RTA_NEXT
(
¹a
,
©ŒËn
è(×‰¾’è-ğ
	`RTA_ALIGN
(Ô)->
¹a_Ën
), \

215 (
¹©Œ
*)(((*)(
¹a
)è+ 
	`RTA_ALIGN
(Ô)->
¹a_Ën
)))

	)

216 
	#RTA_LENGTH
(
Ën
è(
	`RTA_ALIGN
((
¹©Œ
)è+ (Ën))

	)

217 
	#RTA_SPACE
(
Ën
è
	`RTA_ALIGN
(
	`RTA_LENGTH
Ö’))

	)

218 
	#RTA_DATA
(
¹a
è((*)(((*)Ô)è+ 
	`RTA_LENGTH
(0)))

	)

219 
	#RTA_PAYLOAD
(
¹a
è(()(Ô)->
¹a_Ën
è- 
	`RTA_LENGTH
(0))

	)

228 
	s¹msg
 {

229 
	m¹m_çmy
;

230 
	m¹m_d¡_Ën
;

231 
	m¹m_¤c_Ën
;

232 
	m¹m_tos
;

234 
	m¹m_bË
;

235 
	m¹m_´ÙocŞ
;

236 
	m¹m_scİe
;

237 
	m¹m_ty³
;

239 
	m¹m_æags
;

245 
	mRTN_UNSPEC
,

246 
	mRTN_UNICAST
,

247 
	mRTN_LOCAL
,

248 
	mRTN_BROADCAST
,

250 
	mRTN_ANYCAST
,

252 
	mRTN_MULTICAST
,

253 
	mRTN_BLACKHOLE
,

254 
	mRTN_UNREACHABLE
,

255 
	mRTN_PROHIBIT
,

256 
	mRTN_THROW
,

257 
	mRTN_NAT
,

258 
	mRTN_XRESOLVE
,

259 
	m__RTN_MAX


262 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

267 
	#RTPROT_UNSPEC
 0

	)

268 
	#RTPROT_REDIRECT
 1

	)

270 
	#RTPROT_KERNEL
 2

	)

271 
	#RTPROT_BOOT
 3

	)

272 
	#RTPROT_STATIC
 4

	)

281 
	#RTPROT_GATED
 8

	)

282 
	#RTPROT_RA
 9

	)

283 
	#RTPROT_MRT
 10

	)

284 
	#RTPROT_ZEBRA
 11

	)

285 
	#RTPROT_BIRD
 12

	)

286 
	#RTPROT_DNROUTED
 13

	)

287 
	#RTPROT_XORP
 14

	)

288 
	#RTPROT_NTK
 15

	)

289 
	#RTPROT_DHCP
 16

	)

290 
	#RTPROT_MROUTED
 17

	)

291 
	#RTPROT_KEEPALIVED
 18

	)

292 
	#RTPROT_BABEL
 42

	)

293 
	#RTPROT_OPENR
 99

	)

294 
	#RTPROT_BGP
 186

	)

295 
	#RTPROT_ISIS
 187

	)

296 
	#RTPROT_OSPF
 188

	)

297 
	#RTPROT_RIP
 189

	)

298 
	#RTPROT_EIGRP
 192

	)

311 
	e¹_scİe_t
 {

312 
	mRT_SCOPE_UNIVERSE
=0,

314 
	mRT_SCOPE_SITE
=200,

315 
	mRT_SCOPE_LINK
=253,

316 
	mRT_SCOPE_HOST
=254,

317 
	mRT_SCOPE_NOWHERE
=255

322 
	#RTM_F_NOTIFY
 0x100

	)

323 
	#RTM_F_CLONED
 0x200

	)

324 
	#RTM_F_EQUALIZE
 0x400

	)

325 
	#RTM_F_PREFIX
 0x800

	)

326 
	#RTM_F_LOOKUP_TABLE
 0x1000

	)

327 
	#RTM_F_FIB_MATCH
 0x2000

	)

328 
	#RTM_F_OFFLOAD
 0x4000

	)

329 
	#RTM_F_TRAP
 0x8000

	)

330 
	#RTM_F_OFFLOAD_FAILED
 0x20000000

	)

338 
	e¹_şass_t
 {

339 
	mRT_TABLE_UNSPEC
=0,

341 
	mRT_TABLE_COMPAT
=252,

342 
	mRT_TABLE_DEFAULT
=253,

343 
	mRT_TABLE_MAIN
=254,

344 
	mRT_TABLE_LOCAL
=255,

345 
	mRT_TABLE_MAX
=0xFFFFFFFF

351 
	e¹©Œ_ty³_t
 {

352 
	mRTA_UNSPEC
,

353 
	mRTA_DST
,

354 
	mRTA_SRC
,

355 
	mRTA_IIF
,

356 
	mRTA_OIF
,

357 
	mRTA_GATEWAY
,

358 
	mRTA_PRIORITY
,

359 
	mRTA_PREFSRC
,

360 
	mRTA_METRICS
,

361 
	mRTA_MULTIPATH
,

362 
	mRTA_PROTOINFO
,

363 
	mRTA_FLOW
,

364 
	mRTA_CACHEINFO
,

365 
	mRTA_SESSION
,

366 
	mRTA_MP_ALGO
,

367 
	mRTA_TABLE
,

368 
	mRTA_MARK
,

369 
	mRTA_MFC_STATS
,

370 
	mRTA_VIA
,

371 
	mRTA_NEWDST
,

372 
	mRTA_PREF
,

373 
	mRTA_ENCAP_TYPE
,

374 
	mRTA_ENCAP
,

375 
	mRTA_EXPIRES
,

376 
	mRTA_PAD
,

377 
	mRTA_UID
,

378 
	mRTA_TTL_PROPAGATE
,

379 
	mRTA_IP_PROTO
,

380 
	mRTA_SPORT
,

381 
	mRTA_DPORT
,

382 
	mRTA_NH_ID
,

383 
	m__RTA_MAX


386 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

388 
	#RTM_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
¹msg
))))

	)

389 
	#RTM_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
¹msg
))

	)

400 
	s¹Ãxthİ
 {

401 
	m¹nh_Ën
;

402 
	m¹nh_æags
;

403 
	m¹nh_hİs
;

404 
	m¹nh_ifšdex
;

409 
	#RTNH_F_DEAD
 1

	)

410 
	#RTNH_F_PERVASIVE
 2

	)

411 
	#RTNH_F_ONLINK
 4

	)

412 
	#RTNH_F_OFFLOAD
 8

	)

413 
	#RTNH_F_LINKDOWN
 16

	)

414 
	#RTNH_F_UNRESOLVED
 32

	)

415 
	#RTNH_F_TRAP
 64

	)

417 
	#RTNH_COMPARE_MASK
 (
RTNH_F_DEAD
 | 
RTNH_F_LINKDOWN
 | \

418 
RTNH_F_OFFLOAD
 | 
RTNH_F_TRAP
)

	)

422 
	#RTNH_ALIGNTO
 4

	)

423 
	#RTNH_ALIGN
(
Ën
èĞ(Ö’)+
RTNH_ALIGNTO
-1è& ~(RTNH_ALIGNTO-1è)

	)

424 
	#RTNH_OK
(
¹nh
,
Ën
è(ÔŠh)->
¹nh_Ën
 >ğ(
¹Ãxthİ
) && \

425 (()(
¹nh
)->
¹nh_Ën
è<ğ(
Ën
))

	)

426 
	#RTNH_NEXT
(
¹nh
è((
¹Ãxthİ
*)(((*)ÔŠh)è+ 
	`RTNH_ALIGN
(ÔŠh)->
¹nh_Ën
)))

	)

427 
	#RTNH_LENGTH
(
Ën
è(
	`RTNH_ALIGN
((
¹Ãxthİ
)è+ (Ën))

	)

428 
	#RTNH_SPACE
(
Ën
è
	`RTNH_ALIGN
(
	`RTNH_LENGTH
Ö’))

	)

429 
	#RTNH_DATA
(
¹nh
è((
¹©Œ
*)(((*)ÔŠh)è+ 
	`RTNH_LENGTH
(0)))

	)

432 
	s¹vŸ
 {

433 
__k”Ãl_§_çmy_t
 
	m¹vŸ_çmy
;

434 
__u8
 
	m¹vŸ_addr
[0];

439 
	s¹a_ÿchešfo
 {

440 
__u32
 
	m¹a_şÁ»f
;

441 
__u32
 
	m¹a_Ï¡u£
;

442 
__s32
 
	m¹a_expœes
;

443 
__u32
 
	m¹a_”rÜ
;

444 
__u32
 
	m¹a_u£d
;

446 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

447 
__u32
 
	m¹a_id
;

448 
__u32
 
	m¹a_ts
;

449 
__u32
 
	m¹a_t§ge
;

455 
	mRTAX_UNSPEC
,

456 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

457 
	mRTAX_LOCK
,

458 
	#RTAX_LOCK
 
RTAX_LOCK


	)

459 
	mRTAX_MTU
,

460 
	#RTAX_MTU
 
RTAX_MTU


	)

461 
	mRTAX_WINDOW
,

462 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

463 
	mRTAX_RTT
,

464 
	#RTAX_RTT
 
RTAX_RTT


	)

465 
	mRTAX_RTTVAR
,

466 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

467 
	mRTAX_SSTHRESH
,

468 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

469 
	mRTAX_CWND
,

470 
	#RTAX_CWND
 
RTAX_CWND


	)

471 
	mRTAX_ADVMSS
,

472 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

473 
	mRTAX_REORDERING
,

474 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

475 
	mRTAX_HOPLIMIT
,

476 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

477 
	mRTAX_INITCWND
,

478 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

479 
	mRTAX_FEATURES
,

480 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

481 
	mRTAX_RTO_MIN
,

482 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

483 
	mRTAX_INITRWND
,

484 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

485 
	mRTAX_QUICKACK
,

486 
	#RTAX_QUICKACK
 
RTAX_QUICKACK


	)

487 
	mRTAX_CC_ALGO
,

488 
	#RTAX_CC_ALGO
 
RTAX_CC_ALGO


	)

489 
	mRTAX_FASTOPEN_NO_COOKIE
,

490 
	#RTAX_FASTOPEN_NO_COOKIE
 
RTAX_FASTOPEN_NO_COOKIE


	)

491 
	m__RTAX_MAX


494 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

496 
	#RTAX_FEATURE_ECN
 (1 << 0)

	)

497 
	#RTAX_FEATURE_SACK
 (1 << 1)

	)

498 
	#RTAX_FEATURE_TIMESTAMP
 (1 << 2)

	)

499 
	#RTAX_FEATURE_ALLFRAG
 (1 << 3)

	)

501 
	#RTAX_FEATURE_MASK
 (
RTAX_FEATURE_ECN
 | 
RTAX_FEATURE_SACK
 | \

502 
RTAX_FEATURE_TIMESTAMP
 | 
RTAX_FEATURE_ALLFRAG
)

	)

504 
	s¹a_£ssiÚ
 {

505 
__u8
 
	m´Ùo
;

506 
__u8
 
	m·d1
;

507 
__u16
 
	m·d2
;

511 
__u16
 
	m¥Üt
;

512 
__u16
 
	mdpÜt
;

513 } 
	mpÜts
;

516 
__u8
 
	mty³
;

517 
__u8
 
	mcode
;

518 
__u16
 
	mid’t
;

519 } 
	micm±
;

521 
__u32
 
	m¥i
;

522 } 
	mu
;

525 
	s¹a_mfc_¡©s
 {

526 
__u64
 
	mmfcs_·ck‘s
;

527 
__u64
 
	mmfcs_by‹s
;

528 
__u64
 
	mmfcs_wrÚg_if
;

535 
	s¹g’msg
 {

536 
	m¹g’_çmy
;

548 
	sifšfomsg
 {

549 
	mifi_çmy
;

550 
	m__ifi_·d
;

551 
	mifi_ty³
;

552 
	mifi_šdex
;

553 
	mifi_æags
;

554 
	mifi_chªge
;

561 
	s´efixmsg
 {

562 
	m´efix_çmy
;

563 
	m´efix_·d1
;

564 
	m´efix_·d2
;

565 
	m´efix_ifšdex
;

566 
	m´efix_ty³
;

567 
	m´efix_Ën
;

568 
	m´efix_æags
;

569 
	m´efix_·d3
;

574 
	mPREFIX_UNSPEC
,

575 
	mPREFIX_ADDRESS
,

576 
	mPREFIX_CACHEINFO
,

577 
	m__PREFIX_MAX


580 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

582 
	s´efix_ÿchešfo
 {

583 
__u32
 
	m´eã¼ed_time
;

584 
__u32
 
	mv®id_time
;

592 
	stcmsg
 {

593 
	mtcm_çmy
;

594 
	mtcm__·d1
;

595 
	mtcm__·d2
;

596 
	mtcm_ifšdex
;

597 
__u32
 
	mtcm_hªdË
;

598 
__u32
 
	mtcm_·»Á
;

602 
	#tcm_block_šdex
 
tcm_·»Á


	)

603 
__u32
 
	mtcm_šfo
;

610 
	#TCM_IFINDEX_MAGIC_BLOCK
 (0xFFFFFFFFU)

	)

613 
	mTCA_UNSPEC
,

614 
	mTCA_KIND
,

615 
	mTCA_OPTIONS
,

616 
	mTCA_STATS
,

617 
	mTCA_XSTATS
,

618 
	mTCA_RATE
,

619 
	mTCA_FCNT
,

620 
	mTCA_STATS2
,

621 
	mTCA_STAB
,

622 
	mTCA_PAD
,

623 
	mTCA_DUMP_INVISIBLE
,

624 
	mTCA_CHAIN
,

625 
	mTCA_HW_OFFLOAD
,

626 
	mTCA_INGRESS_BLOCK
,

627 
	mTCA_EGRESS_BLOCK
,

628 
	mTCA_DUMP_FLAGS
,

629 
	m__TCA_MAX


632 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

634 
	#TCA_DUMP_FLAGS_TERSE
 (1 << 0è

	)

639 
	#TCA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

640 
	#TCA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tcmsg
))

	)

646 
	sndu£rİtmsg
 {

647 
	mndu£rİt_çmy
;

648 
	mndu£rİt_·d1
;

649 
	mndu£rİt_İts_Ën
;

650 
	mndu£rİt_ifšdex
;

651 
__u8
 
	mndu£rİt_icmp_ty³
;

652 
__u8
 
	mndu£rİt_icmp_code
;

653 
	mndu£rİt_·d2
;

654 
	mndu£rİt_·d3
;

659 
	mNDUSEROPT_UNSPEC
,

660 
	mNDUSEROPT_SRCADDR
,

661 
	m__NDUSEROPT_MAX


664 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

667 
	#RTMGRP_LINK
 1

	)

668 
	#RTMGRP_NOTIFY
 2

	)

669 
	#RTMGRP_NEIGH
 4

	)

670 
	#RTMGRP_TC
 8

	)

672 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

673 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

674 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

675 
	#RTMGRP_IPV4_RULE
 0x80

	)

677 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

678 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

679 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

680 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

682 
	#RTMGRP_DECÃt_IFADDR
 0x1000

	)

683 
	#RTMGRP_DECÃt_ROUTE
 0x4000

	)

685 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

688 
	e¹Ãšk_groups
 {

689 
	mRTNLGRP_NONE
,

690 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

691 
	mRTNLGRP_LINK
,

692 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

693 
	mRTNLGRP_NOTIFY
,

694 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

695 
	mRTNLGRP_NEIGH
,

696 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

697 
	mRTNLGRP_TC
,

698 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

699 
	mRTNLGRP_IPV4_IFADDR
,

700 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

701 
	mRTNLGRP_IPV4_MROUTE
,

702 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

703 
	mRTNLGRP_IPV4_ROUTE
,

704 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

705 
	mRTNLGRP_IPV4_RULE
,

706 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

707 
	mRTNLGRP_IPV6_IFADDR
,

708 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

709 
	mRTNLGRP_IPV6_MROUTE
,

710 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

711 
	mRTNLGRP_IPV6_ROUTE
,

712 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

713 
	mRTNLGRP_IPV6_IFINFO
,

714 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

715 
	mRTNLGRP_DECÃt_IFADDR
,

716 
	#RTNLGRP_DECÃt_IFADDR
 
RTNLGRP_DECÃt_IFADDR


	)

717 
	mRTNLGRP_NOP2
,

718 
	mRTNLGRP_DECÃt_ROUTE
,

719 
	#RTNLGRP_DECÃt_ROUTE
 
RTNLGRP_DECÃt_ROUTE


	)

720 
	mRTNLGRP_DECÃt_RULE
,

721 
	#RTNLGRP_DECÃt_RULE
 
RTNLGRP_DECÃt_RULE


	)

722 
	mRTNLGRP_NOP4
,

723 
	mRTNLGRP_IPV6_PREFIX
,

724 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

725 
	mRTNLGRP_IPV6_RULE
,

726 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

727 
	mRTNLGRP_ND_USEROPT
,

728 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

729 
	mRTNLGRP_PHONET_IFADDR
,

730 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

731 
	mRTNLGRP_PHONET_ROUTE
,

732 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

733 
	mRTNLGRP_DCB
,

734 
	#RTNLGRP_DCB
 
RTNLGRP_DCB


	)

735 
	mRTNLGRP_IPV4_NETCONF
,

736 
	#RTNLGRP_IPV4_NETCONF
 
RTNLGRP_IPV4_NETCONF


	)

737 
	mRTNLGRP_IPV6_NETCONF
,

738 
	#RTNLGRP_IPV6_NETCONF
 
RTNLGRP_IPV6_NETCONF


	)

739 
	mRTNLGRP_MDB
,

740 
	#RTNLGRP_MDB
 
RTNLGRP_MDB


	)

741 
	mRTNLGRP_MPLS_ROUTE
,

742 
	#RTNLGRP_MPLS_ROUTE
 
RTNLGRP_MPLS_ROUTE


	)

743 
	mRTNLGRP_NSID
,

744 
	#RTNLGRP_NSID
 
RTNLGRP_NSID


	)

745 
	mRTNLGRP_MPLS_NETCONF
,

746 
	#RTNLGRP_MPLS_NETCONF
 
RTNLGRP_MPLS_NETCONF


	)

747 
	mRTNLGRP_IPV4_MROUTE_R
,

748 
	#RTNLGRP_IPV4_MROUTE_R
 
RTNLGRP_IPV4_MROUTE_R


	)

749 
	mRTNLGRP_IPV6_MROUTE_R
,

750 
	#RTNLGRP_IPV6_MROUTE_R
 
RTNLGRP_IPV6_MROUTE_R


	)

751 
	mRTNLGRP_NEXTHOP
,

752 
	#RTNLGRP_NEXTHOP
 
RTNLGRP_NEXTHOP


	)

753 
	mRTNLGRP_BRVLAN
,

754 
	#RTNLGRP_BRVLAN
 
RTNLGRP_BRVLAN


	)

755 
	m__RTNLGRP_MAX


757 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

760 
	stÿmsg
 {

761 
	mtÿ_çmy
;

762 
	mtÿ__·d1
;

763 
	mtÿ__·d2
;

767 
	mTCA_ROOT_UNSPEC
,

768 
	mTCA_ROOT_TAB
,

769 
	#TCA_ACT_TAB
 
TCA_ROOT_TAB


	)

770 
	#TCAA_MAX
 
TCA_ROOT_TAB


	)

771 
	mTCA_ROOT_FLAGS
,

772 
	mTCA_ROOT_COUNT
,

773 
	mTCA_ROOT_TIME_DELTA
,

774 
	m__TCA_ROOT_MAX
,

775 
	#TCA_ROOT_MAX
 (
__TCA_ROOT_MAX
 - 1)

	)

778 
	#TA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tÿmsg
))))

	)

779 
	#TA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tÿmsg
))

	)

791 
	#TCA_FLAG_LARGE_DUMP_ON
 (1 << 0)

	)

792 
	#TCA_ACT_FLAG_LARGE_DUMP_ON
 
TCA_FLAG_LARGE_DUMP_ON


	)

793 
	#TCA_ACT_FLAG_TERSE_DUMP
 (1 << 1)

	)

796 
	#RTEXT_FILTER_VF
 (1 << 0)

	)

797 
	#RTEXT_FILTER_BRVLAN
 (1 << 1)

	)

798 
	#RTEXT_FILTER_BRVLAN_COMPRESSED
 (1 << 2)

	)

799 
	#RTEXT_FILTER_SKIP_STATS
 (1 << 3)

	)

800 
	#RTEXT_FILTER_MRP
 (1 << 4)

	)

801 
	#RTEXT_FILTER_CFM_CONFIG
 (1 << 5)

	)

802 
	#RTEXT_FILTER_CFM_STATUS
 (1 << 6)

	)

	@/usr/include/linux/sched.h

2 #iâdeà
_LINUX_SCHED_H


3 
	#_LINUX_SCHED_H


	)

5 
	~<lšux/ty³s.h
>

10 
	#CSIGNAL
 0x000000fà

	)

11 
	#CLONE_VM
 0x00000100

	)

12 
	#CLONE_FS
 0x00000200

	)

13 
	#CLONE_FILES
 0x00000400

	)

14 
	#CLONE_SIGHAND
 0x00000800

	)

15 
	#CLONE_PIDFD
 0x00001000

	)

16 
	#CLONE_PTRACE
 0x00002000

	)

17 
	#CLONE_VFORK
 0x00004000

	)

18 
	#CLONE_PARENT
 0x00008000

	)

19 
	#CLONE_THREAD
 0x00010000

	)

20 
	#CLONE_NEWNS
 0x00020000

	)

21 
	#CLONE_SYSVSEM
 0x00040000

	)

22 
	#CLONE_SETTLS
 0x00080000

	)

23 
	#CLONE_PARENT_SETTID
 0x00100000

	)

24 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

25 
	#CLONE_DETACHED
 0x00400000

	)

26 
	#CLONE_UNTRACED
 0x00800000

	)

27 
	#CLONE_CHILD_SETTID
 0x01000000

	)

28 
	#CLONE_NEWCGROUP
 0x02000000

	)

29 
	#CLONE_NEWUTS
 0x04000000

	)

30 
	#CLONE_NEWIPC
 0x08000000

	)

31 
	#CLONE_NEWUSER
 0x10000000

	)

32 
	#CLONE_NEWPID
 0x20000000

	)

33 
	#CLONE_NEWNET
 0x40000000

	)

34 
	#CLONE_IO
 0x80000000

	)

37 
	#CLONE_CLEAR_SIGHAND
 0x100000000ULL

	)

38 
	#CLONE_INTO_CGROUP
 0x200000000ULL

	)

44 
	#CLONE_NEWTIME
 0x00000080

	)

46 #iâdeà
__ASSEMBLY__


92 
	sşÚe_¬gs
 {

93 
__®igÃd_u64
 
	mæags
;

94 
__®igÃd_u64
 
	mpidfd
;

95 
__®igÃd_u64
 
	mchd_tid
;

96 
__®igÃd_u64
 
	m·»Á_tid
;

97 
__®igÃd_u64
 
	mex™_sigÇl
;

98 
__®igÃd_u64
 
	m¡ack
;

99 
__®igÃd_u64
 
	m¡ack_size
;

100 
__®igÃd_u64
 
	ms
;

101 
__®igÃd_u64
 
	m£t_tid
;

102 
__®igÃd_u64
 
	m£t_tid_size
;

103 
__®igÃd_u64
 
	mcgroup
;

107 
	#CLONE_ARGS_SIZE_VER0
 64

	)

108 
	#CLONE_ARGS_SIZE_VER1
 80

	)

109 
	#CLONE_ARGS_SIZE_VER2
 88

	)

114 
	#SCHED_NORMAL
 0

	)

115 
	#SCHED_FIFO
 1

	)

116 
	#SCHED_RR
 2

	)

117 
	#SCHED_BATCH
 3

	)

119 
	#SCHED_IDLE
 5

	)

120 
	#SCHED_DEADLINE
 6

	)

123 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

128 
	#SCHED_FLAG_RESET_ON_FORK
 0x01

	)

129 
	#SCHED_FLAG_RECLAIM
 0x02

	)

130 
	#SCHED_FLAG_DL_OVERRUN
 0x04

	)

131 
	#SCHED_FLAG_KEEP_POLICY
 0x08

	)

132 
	#SCHED_FLAG_KEEP_PARAMS
 0x10

	)

133 
	#SCHED_FLAG_UTIL_CLAMP_MIN
 0x20

	)

134 
	#SCHED_FLAG_UTIL_CLAMP_MAX
 0x40

	)

136 
	#SCHED_FLAG_KEEP_ALL
 (
SCHED_FLAG_KEEP_POLICY
 | \

137 
SCHED_FLAG_KEEP_PARAMS
)

	)

139 
	#SCHED_FLAG_UTIL_CLAMP
 (
SCHED_FLAG_UTIL_CLAMP_MIN
 | \

140 
SCHED_FLAG_UTIL_CLAMP_MAX
)

	)

142 
	#SCHED_FLAG_ALL
 (
SCHED_FLAG_RESET_ON_FORK
 | \

143 
SCHED_FLAG_RECLAIM
 | \

144 
SCHED_FLAG_DL_OVERRUN
 | \

145 
SCHED_FLAG_KEEP_ALL
 | \

146 
SCHED_FLAG_UTIL_CLAMP
)

	)

	@/usr/include/linux/socket.h

2 #iâdeà
_LINUX_SOCKET_H


3 
	#_LINUX_SOCKET_H


	)

8 
	#_K_SS_MAXSIZE
 128

	)

10 
	t__k”Ãl_§_çmy_t
;

16 
	s__k”Ãl_sockaddr_¡Üage
 {

19 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

21 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

25 *
	m__®ign
;

29 
	#SOCK_SNDBUF_LOCK
 1

	)

30 
	#SOCK_RCVBUF_LOCK
 2

	)

32 
	#SOCK_BUF_LOCK_MASK
 (
SOCK_SNDBUF_LOCK
 | 
SOCK_RCVBUF_LOCK
)

	)

	@/usr/include/linux/string.h

2 #iâdeà
_LINUX_STRING_H_


3 
	#_LINUX_STRING_H_


	)

7 
	~<¡ršg.h
>

	@/usr/include/linux/time.h

2 #iâdeà
_LINUX_TIME_H


3 
	#_LINUX_TIME_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/time_ty³s.h
>

8 #iâdeà
_STRUCT_TIMESPEC


9 
	#_STRUCT_TIMESPEC


	)

10 
	stime¥ec
 {

11 
__k”Ãl_Şd_time_t
 
	mtv_£c
;

12 
	mtv_n£c
;

16 
	stimev®
 {

17 
__k”Ãl_Şd_time_t
 
	mtv_£c
;

18 
__k”Ãl_su£cÚds_t
 
	mtv_u£c
;

21 
	s™im”¥ec
 {

22 
time¥ec
 
	m™_š‹rv®
;

23 
time¥ec
 
	m™_v®ue
;

26 
	s™im”v®
 {

27 
timev®
 
	m™_š‹rv®
;

28 
timev®
 
	m™_v®ue
;

31 
	stimezÚe
 {

32 
	mtz_mšu‹swe¡
;

33 
	mtz_d¡time
;

40 
	#ITIMER_REAL
 0

	)

41 
	#ITIMER_VIRTUAL
 1

	)

42 
	#ITIMER_PROF
 2

	)

47 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

49 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

50 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

51 
	#CLOCK_MONOTONIC_RAW
 4

	)

52 
	#CLOCK_REALTIME_COARSE
 5

	)

53 
	#CLOCK_MONOTONIC_COARSE
 6

	)

54 
	#CLOCK_BOOTTIME
 7

	)

55 
	#CLOCK_REALTIME_ALARM
 8

	)

56 
	#CLOCK_BOOTTIME_ALARM
 9

	)

61 
	#CLOCK_SGI_CYCLE
 10

	)

62 
	#CLOCK_TAI
 11

	)

64 
	#MAX_CLOCKS
 16

	)

65 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
)

	)

66 
	#CLOCKS_MONO
 
CLOCK_MONOTONIC


	)

71 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/types.h

2 #iâdeà
_LINUX_TYPES_H


3 
	#_LINUX_TYPES_H


	)

5 
	~<asm/ty³s.h
>

7 #iâdeà
__ASSEMBLY__


9 
	~<lšux/posix_ty³s.h
>

17 #ifdeà
__CHECKER__


18 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

20 
	#__b™wi£__


	)

22 
	#__b™wi£
 
__b™wi£__


	)

24 
__u16
 
	t__b™wi£
 
	t__Ë16
;

25 
__u16
 
	t__b™wi£
 
	t__be16
;

26 
__u32
 
	t__b™wi£
 
	t__Ë32
;

27 
__u32
 
	t__b™wi£
 
	t__be32
;

28 
__u64
 
	t__b™wi£
 
	t__Ë64
;

29 
__u64
 
	t__b™wi£
 
	t__be64
;

31 
__u16
 
	t__b™wi£
 
	t__sum16
;

32 
__u32
 
	t__b™wi£
 
	t__wsum
;

43 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

44 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

45 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	t__b™wi£
 
	t__pŞl_t
;

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 331688

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
è((×è<< 16è+ ((bè<< 8è+ ((cè> 255 ? 255 : (c)))

	)

3 
	#LINUX_VERSION_MAJOR
 5

	)

4 
	#LINUX_VERSION_PATCHLEVEL
 15

	)

5 
	#LINUX_VERSION_SUBLEVEL
 168

	)

	@/usr/include/linux/wait.h

2 #iâdeà
_LINUX_WAIT_H


3 
	#_LINUX_WAIT_H


	)

5 
	#WNOHANG
 0x00000001

	)

6 
	#WUNTRACED
 0x00000002

	)

7 
	#WSTOPPED
 
WUNTRACED


	)

8 
	#WEXITED
 0x00000004

	)

9 
	#WCONTINUED
 0x00000008

	)

10 
	#WNOWAIT
 0x01000000

	)

12 
	#__WNOTHREAD
 0x20000000

	)

13 
	#__WALL
 0x40000000

	)

14 
	#__WCLONE
 0x80000000

	)

17 
	#P_ALL
 0

	)

18 
	#P_PID
 1

	)

19 
	#P_PGID
 2

	)

20 
	#P_PIDFD
 3

	)

	@/usr/include/linux/wireless.h

11 #iâdeà
_LINUX_WIRELESS_H


12 
	#_LINUX_WIRELESS_H


	)

73 
	~<lšux/ty³s.h
>

74 
	~<lšux/sock‘.h
>

75 
	~<lšux/if.h
>

77 
	~<¡ddef.h
>

86 
	#WIRELESS_EXT
 22

	)

233 
	#SIOCSIWCOMMIT
 0x8B00

	)

234 
	#SIOCGIWNAME
 0x8B01

	)

240 
	#SIOCSIWNWID
 0x8B02

	)

241 
	#SIOCGIWNWID
 0x8B03

	)

242 
	#SIOCSIWFREQ
 0x8B04

	)

243 
	#SIOCGIWFREQ
 0x8B05

	)

244 
	#SIOCSIWMODE
 0x8B06

	)

245 
	#SIOCGIWMODE
 0x8B07

	)

246 
	#SIOCSIWSENS
 0x8B08

	)

247 
	#SIOCGIWSENS
 0x8B09

	)

250 
	#SIOCSIWRANGE
 0x8B0A

	)

251 
	#SIOCGIWRANGE
 0x8B0B

	)

252 
	#SIOCSIWPRIV
 0x8B0C

	)

253 
	#SIOCGIWPRIV
 0x8B0D

	)

254 
	#SIOCSIWSTATS
 0x8B0E

	)

255 
	#SIOCGIWSTATS
 0x8B0F

	)

260 
	#SIOCSIWSPY
 0x8B10

	)

261 
	#SIOCGIWSPY
 0x8B11

	)

262 
	#SIOCSIWTHRSPY
 0x8B12

	)

263 
	#SIOCGIWTHRSPY
 0x8B13

	)

266 
	#SIOCSIWAP
 0x8B14

	)

267 
	#SIOCGIWAP
 0x8B15

	)

268 
	#SIOCGIWAPLIST
 0x8B17

	)

269 
	#SIOCSIWSCAN
 0x8B18

	)

270 
	#SIOCGIWSCAN
 0x8B19

	)

273 
	#SIOCSIWESSID
 0x8B1A

	)

274 
	#SIOCGIWESSID
 0x8B1B

	)

275 
	#SIOCSIWNICKN
 0x8B1C

	)

276 
	#SIOCGIWNICKN
 0x8B1D

	)

282 
	#SIOCSIWRATE
 0x8B20

	)

283 
	#SIOCGIWRATE
 0x8B21

	)

284 
	#SIOCSIWRTS
 0x8B22

	)

285 
	#SIOCGIWRTS
 0x8B23

	)

286 
	#SIOCSIWFRAG
 0x8B24

	)

287 
	#SIOCGIWFRAG
 0x8B25

	)

288 
	#SIOCSIWTXPOW
 0x8B26

	)

289 
	#SIOCGIWTXPOW
 0x8B27

	)

290 
	#SIOCSIWRETRY
 0x8B28

	)

291 
	#SIOCGIWRETRY
 0x8B29

	)

294 
	#SIOCSIWENCODE
 0x8B2A

	)

295 
	#SIOCGIWENCODE
 0x8B2B

	)

297 
	#SIOCSIWPOWER
 0x8B2C

	)

298 
	#SIOCGIWPOWER
 0x8B2D

	)

307 
	#SIOCSIWGENIE
 0x8B30

	)

308 
	#SIOCGIWGENIE
 0x8B31

	)

311 
	#SIOCSIWMLME
 0x8B16

	)

314 
	#SIOCSIWAUTH
 0x8B32

	)

315 
	#SIOCGIWAUTH
 0x8B33

	)

318 
	#SIOCSIWENCODEEXT
 0x8B34

	)

319 
	#SIOCGIWENCODEEXT
 0x8B35

	)

322 
	#SIOCSIWPMKSA
 0x8B36

	)

333 
	#SIOCIWFIRSTPRIV
 0x8BE0

	)

334 
	#SIOCIWLASTPRIV
 0x8BFF

	)

349 
	#SIOCIWFIRST
 0x8B00

	)

350 
	#SIOCIWLAST
 
SIOCIWLASTPRIV


	)

351 
	#IW_IOCTL_IDX
(
cmd
è((cmdè- 
SIOCIWFIRST
)

	)

352 
	#IW_HANDLER
(
id
, 
func
) \

353 [
	`IW_IOCTL_IDX
(
id
)] = 
func


	)

356 
	#IW_IS_SET
(
cmd
è(!((cmdè& 0x1))

	)

357 
	#IW_IS_GET
(
cmd
è((cmdè& 0x1)

	)

363 
	#IWEVTXDROP
 0x8C00

	)

364 
	#IWEVQUAL
 0x8C01

	)

365 
	#IWEVCUSTOM
 0x8C02

	)

366 
	#IWEVREGISTERED
 0x8C03

	)

367 
	#IWEVEXPIRED
 0x8C04

	)

368 
	#IWEVGENIE
 0x8C05

	)

374 
	#IWEVMICHAELMICFAILURE
 0x8C06

	)

377 
	#IWEVASSOCREQIE
 0x8C07

	)

386 
	#IWEVASSOCRESPIE
 0x8C08

	)

393 
	#IWEVPMKIDCAND
 0x8C09

	)

397 
	#IWEVFIRST
 0x8C00

	)

398 
	#IW_EVENT_IDX
(
cmd
è((cmdè- 
IWEVFIRST
)

	)

407 
	#IW_PRIV_TYPE_MASK
 0x7000

	)

408 
	#IW_PRIV_TYPE_NONE
 0x0000

	)

409 
	#IW_PRIV_TYPE_BYTE
 0x1000

	)

410 
	#IW_PRIV_TYPE_CHAR
 0x2000

	)

411 
	#IW_PRIV_TYPE_INT
 0x4000

	)

412 
	#IW_PRIV_TYPE_FLOAT
 0x5000

	)

413 
	#IW_PRIV_TYPE_ADDR
 0x6000

	)

415 
	#IW_PRIV_SIZE_FIXED
 0x0800

	)

417 
	#IW_PRIV_SIZE_MASK
 0x07FF

	)

427 
	#IW_MAX_FREQUENCIES
 32

	)

433 
	#IW_MAX_BITRATES
 32

	)

436 
	#IW_MAX_TXPOWER
 8

	)

441 
	#IW_MAX_SPY
 8

	)

445 
	#IW_MAX_AP
 64

	)

448 
	#IW_ESSID_MAX_SIZE
 32

	)

451 
	#IW_MODE_AUTO
 0

	)

452 
	#IW_MODE_ADHOC
 1

	)

453 
	#IW_MODE_INFRA
 2

	)

454 
	#IW_MODE_MASTER
 3

	)

455 
	#IW_MODE_REPEAT
 4

	)

456 
	#IW_MODE_SECOND
 5

	)

457 
	#IW_MODE_MONITOR
 6

	)

458 
	#IW_MODE_MESH
 7

	)

461 
	#IW_QUAL_QUAL_UPDATED
 0x01

	)

462 
	#IW_QUAL_LEVEL_UPDATED
 0x02

	)

463 
	#IW_QUAL_NOISE_UPDATED
 0x04

	)

464 
	#IW_QUAL_ALL_UPDATED
 0x07

	)

465 
	#IW_QUAL_DBM
 0x08

	)

466 
	#IW_QUAL_QUAL_INVALID
 0x10

	)

467 
	#IW_QUAL_LEVEL_INVALID
 0x20

	)

468 
	#IW_QUAL_NOISE_INVALID
 0x40

	)

469 
	#IW_QUAL_RCPI
 0x80

	)

470 
	#IW_QUAL_ALL_INVALID
 0x70

	)

473 
	#IW_FREQ_AUTO
 0x00

	)

474 
	#IW_FREQ_FIXED
 0x01

	)

478 
	#IW_MAX_ENCODING_SIZES
 8

	)

481 
	#IW_ENCODING_TOKEN_MAX
 64

	)

484 
	#IW_ENCODE_INDEX
 0x00FF

	)

485 
	#IW_ENCODE_FLAGS
 0xFF00

	)

486 
	#IW_ENCODE_MODE
 0xF000

	)

487 
	#IW_ENCODE_DISABLED
 0x8000

	)

488 
	#IW_ENCODE_ENABLED
 0x0000

	)

489 
	#IW_ENCODE_RESTRICTED
 0x4000

	)

490 
	#IW_ENCODE_OPEN
 0x2000

	)

491 
	#IW_ENCODE_NOKEY
 0x0800

	)

492 
	#IW_ENCODE_TEMP
 0x0400

	)

495 
	#IW_POWER_ON
 0x0000

	)

496 
	#IW_POWER_TYPE
 0xF000

	)

497 
	#IW_POWER_PERIOD
 0x1000

	)

498 
	#IW_POWER_TIMEOUT
 0x2000

	)

499 
	#IW_POWER_MODE
 0x0F00

	)

500 
	#IW_POWER_UNICAST_R
 0x0100

	)

501 
	#IW_POWER_MULTICAST_R
 0x0200

	)

502 
	#IW_POWER_ALL_R
 0x0300

	)

503 
	#IW_POWER_FORCE_S
 0x0400

	)

504 
	#IW_POWER_REPEATER
 0x0800

	)

505 
	#IW_POWER_MODIFIER
 0x000F

	)

506 
	#IW_POWER_MIN
 0x0001

	)

507 
	#IW_POWER_MAX
 0x0002

	)

508 
	#IW_POWER_RELATIVE
 0x0004

	)

511 
	#IW_TXPOW_TYPE
 0x00FF

	)

512 
	#IW_TXPOW_DBM
 0x0000

	)

513 
	#IW_TXPOW_MWATT
 0x0001

	)

514 
	#IW_TXPOW_RELATIVE
 0x0002

	)

515 
	#IW_TXPOW_RANGE
 0x1000

	)

518 
	#IW_RETRY_ON
 0x0000

	)

519 
	#IW_RETRY_TYPE
 0xF000

	)

520 
	#IW_RETRY_LIMIT
 0x1000

	)

521 
	#IW_RETRY_LIFETIME
 0x2000

	)

522 
	#IW_RETRY_MODIFIER
 0x00FF

	)

523 
	#IW_RETRY_MIN
 0x0001

	)

524 
	#IW_RETRY_MAX
 0x0002

	)

525 
	#IW_RETRY_RELATIVE
 0x0004

	)

526 
	#IW_RETRY_SHORT
 0x0010

	)

527 
	#IW_RETRY_LONG
 0x0020

	)

530 
	#IW_SCAN_DEFAULT
 0x0000

	)

531 
	#IW_SCAN_ALL_ESSID
 0x0001

	)

532 
	#IW_SCAN_THIS_ESSID
 0x0002

	)

533 
	#IW_SCAN_ALL_FREQ
 0x0004

	)

534 
	#IW_SCAN_THIS_FREQ
 0x0008

	)

535 
	#IW_SCAN_ALL_MODE
 0x0010

	)

536 
	#IW_SCAN_THIS_MODE
 0x0020

	)

537 
	#IW_SCAN_ALL_RATE
 0x0040

	)

538 
	#IW_SCAN_THIS_RATE
 0x0080

	)

540 
	#IW_SCAN_TYPE_ACTIVE
 0

	)

541 
	#IW_SCAN_TYPE_PASSIVE
 1

	)

543 
	#IW_SCAN_MAX_DATA
 4096

	)

546 
	#IW_SCAN_CAPA_NONE
 0x00

	)

547 
	#IW_SCAN_CAPA_ESSID
 0x01

	)

548 
	#IW_SCAN_CAPA_BSSID
 0x02

	)

549 
	#IW_SCAN_CAPA_CHANNEL
 0x04

	)

550 
	#IW_SCAN_CAPA_MODE
 0x08

	)

551 
	#IW_SCAN_CAPA_RATE
 0x10

	)

552 
	#IW_SCAN_CAPA_TYPE
 0x20

	)

553 
	#IW_SCAN_CAPA_TIME
 0x40

	)

556 
	#IW_CUSTOM_MAX
 256

	)

559 
	#IW_GENERIC_IE_MAX
 1024

	)

562 
	#IW_MLME_DEAUTH
 0

	)

563 
	#IW_MLME_DISASSOC
 1

	)

564 
	#IW_MLME_AUTH
 2

	)

565 
	#IW_MLME_ASSOC
 3

	)

568 
	#IW_AUTH_INDEX
 0x0FFF

	)

569 
	#IW_AUTH_FLAGS
 0xF000

	)

574 
	#IW_AUTH_WPA_VERSION
 0

	)

575 
	#IW_AUTH_CIPHER_PAIRWISE
 1

	)

576 
	#IW_AUTH_CIPHER_GROUP
 2

	)

577 
	#IW_AUTH_KEY_MGMT
 3

	)

578 
	#IW_AUTH_TKIP_COUNTERMEASURES
 4

	)

579 
	#IW_AUTH_DROP_UNENCRYPTED
 5

	)

580 
	#IW_AUTH_80211_AUTH_ALG
 6

	)

581 
	#IW_AUTH_WPA_ENABLED
 7

	)

582 
	#IW_AUTH_RX_UNENCRYPTED_EAPOL
 8

	)

583 
	#IW_AUTH_ROAMING_CONTROL
 9

	)

584 
	#IW_AUTH_PRIVACY_INVOKED
 10

	)

585 
	#IW_AUTH_CIPHER_GROUP_MGMT
 11

	)

586 
	#IW_AUTH_MFP
 12

	)

589 
	#IW_AUTH_WPA_VERSION_DISABLED
 0x00000001

	)

590 
	#IW_AUTH_WPA_VERSION_WPA
 0x00000002

	)

591 
	#IW_AUTH_WPA_VERSION_WPA2
 0x00000004

	)

595 
	#IW_AUTH_CIPHER_NONE
 0x00000001

	)

596 
	#IW_AUTH_CIPHER_WEP40
 0x00000002

	)

597 
	#IW_AUTH_CIPHER_TKIP
 0x00000004

	)

598 
	#IW_AUTH_CIPHER_CCMP
 0x00000008

	)

599 
	#IW_AUTH_CIPHER_WEP104
 0x00000010

	)

600 
	#IW_AUTH_CIPHER_AES_CMAC
 0x00000020

	)

603 
	#IW_AUTH_KEY_MGMT_802_1X
 1

	)

604 
	#IW_AUTH_KEY_MGMT_PSK
 2

	)

607 
	#IW_AUTH_ALG_OPEN_SYSTEM
 0x00000001

	)

608 
	#IW_AUTH_ALG_SHARED_KEY
 0x00000002

	)

609 
	#IW_AUTH_ALG_LEAP
 0x00000004

	)

612 
	#IW_AUTH_ROAMING_ENABLE
 0

	)

613 
	#IW_AUTH_ROAMING_DISABLE
 1

	)

617 
	#IW_AUTH_MFP_DISABLED
 0

	)

618 
	#IW_AUTH_MFP_OPTIONAL
 1

	)

619 
	#IW_AUTH_MFP_REQUIRED
 2

	)

622 
	#IW_ENCODE_SEQ_MAX_SIZE
 8

	)

624 
	#IW_ENCODE_ALG_NONE
 0

	)

625 
	#IW_ENCODE_ALG_WEP
 1

	)

626 
	#IW_ENCODE_ALG_TKIP
 2

	)

627 
	#IW_ENCODE_ALG_CCMP
 3

	)

628 
	#IW_ENCODE_ALG_PMK
 4

	)

629 
	#IW_ENCODE_ALG_AES_CMAC
 5

	)

631 
	#IW_ENCODE_EXT_TX_SEQ_VALID
 0x00000001

	)

632 
	#IW_ENCODE_EXT_RX_SEQ_VALID
 0x00000002

	)

633 
	#IW_ENCODE_EXT_GROUP_KEY
 0x00000004

	)

634 
	#IW_ENCODE_EXT_SET_TX_KEY
 0x00000008

	)

637 
	#IW_MICFAILURE_KEY_ID
 0x00000003

	)

638 
	#IW_MICFAILURE_GROUP
 0x00000004

	)

639 
	#IW_MICFAILURE_PAIRWISE
 0x00000008

	)

640 
	#IW_MICFAILURE_STAKEY
 0x00000010

	)

641 
	#IW_MICFAILURE_COUNT
 0x00000060

	)

645 
	#IW_ENC_CAPA_WPA
 0x00000001

	)

646 
	#IW_ENC_CAPA_WPA2
 0x00000002

	)

647 
	#IW_ENC_CAPA_CIPHER_TKIP
 0x00000004

	)

648 
	#IW_ENC_CAPA_CIPHER_CCMP
 0x00000008

	)

649 
	#IW_ENC_CAPA_4WAY_HANDSHAKE
 0x00000010

	)

654 
	#IW_EVENT_CAPA_BASE
(
cmd
è((cmd >ğ
SIOCIWFIRSTPRIV
) ? \

655 (
cmd
 - 
SIOCIWFIRSTPRIV
 + 0x60) : \

656 (
cmd
 - 
SIOCIWFIRST
))

	)

657 
	#IW_EVENT_CAPA_INDEX
(
cmd
è(
	`IW_EVENT_CAPA_BASE
(cmdè>> 5)

	)

658 
	#IW_EVENT_CAPA_MASK
(
cmd
è(1 << (
	`IW_EVENT_CAPA_BASE
(cmdè& 0x1F))

	)

661 
	#IW_EVENT_CAPA_K_0
 (
	`IW_EVENT_CAPA_MASK
(0x8B04) | \

662 
	`IW_EVENT_CAPA_MASK
(0x8B06) | \

663 
	`IW_EVENT_CAPA_MASK
(0x8B1A))

	)

664 
	#IW_EVENT_CAPA_K_1
 (
	`IW_EVENT_CAPA_MASK
(0x8B2A))

	)

666 
	#IW_EVENT_CAPA_SET
(
ev’t_ÿ·
, 
cmd
èÓv’t_ÿ·[
	`IW_EVENT_CAPA_INDEX
(cmd)] |ğ
	`IW_EVENT_CAPA_MASK
(cmd))

	)

667 
	#IW_EVENT_CAPA_SET_KERNEL
(
ev’t_ÿ·
è{ev’t_ÿ·[0] |ğ
IW_EVENT_CAPA_K_0
;ƒv’t_ÿ·[1] |ğ
IW_EVENT_CAPA_K_1
; }

	)

676 
	siw_·¿m
 {

677 
__s32
 
	mv®ue
;

678 
__u8
 
	mfixed
;

679 
__u8
 
	mdi§bËd
;

680 
__u16
 
	mæags
;

687 
	siw_pošt
 {

688 *
	mpoš‹r
;

689 
__u16
 
	mËngth
;

690 
__u16
 
	mæags
;

702 
	siw_äeq
 {

703 
__s32
 
	mm
;

704 
__s16
 
	me
;

705 
__u8
 
	mi
;

706 
__u8
 
	mæags
;

712 
	siw_qu®™y
 {

713 
__u8
 
	mqu®
;

715 
__u8
 
	mËv–
;

716 
__u8
 
	mnoi£
;

717 
__u8
 
	mupd©ed
;

727 
	siw_disÿrded
 {

728 
__u32
 
	mnwid
;

729 
__u32
 
	mcode
;

730 
__u32
 
	mäagm’t
;

731 
__u32
 
	m»Œ›s
;

732 
__u32
 
	mmisc
;

739 
	siw_mis£d
 {

740 
__u32
 
	mb—cÚ
;

746 
	siw_thr¥y
 {

747 
sockaddr
 
	maddr
;

748 
iw_qu®™y
 
	mqu®
;

749 
iw_qu®™y
 
	mlow
;

750 
iw_qu®™y
 
	mhigh
;

764 
	siw_sÿn_»q
 {

765 
__u8
 
	msÿn_ty³
;

766 
__u8
 
	messid_Ën
;

767 
__u8
 
	mnum_chªÃls
;

769 
__u8
 
	mæags
;

772 
sockaddr
 
	mbssid
;

781 
__u8
 
	messid
[
IW_ESSID_MAX_SIZE
];

793 
__u32
 
	mmš_chªÃl_time
;

794 
__u32
 
	mmax_chªÃl_time
;

796 
iw_äeq
 
	mchªÃl_li¡
[
IW_MAX_FREQUENCIES
];

825 
	siw_’code_ext
 {

826 
__u32
 
	mext_æags
;

827 
__u8
 
	mtx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

828 
__u8
 
	mrx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

829 
sockaddr
 
	maddr
;

832 
__u16
 
	m®g
;

833 
__u16
 
	mkey_Ën
;

834 
__u8
 
	mkey
[0];

838 
	siw_mlme
 {

839 
__u16
 
	mcmd
;

840 
__u16
 
	m»asÚ_code
;

841 
sockaddr
 
	maddr
;

845 
	#IW_PMKSA_ADD
 1

	)

846 
	#IW_PMKSA_REMOVE
 2

	)

847 
	#IW_PMKSA_FLUSH
 3

	)

849 
	#IW_PMKID_LEN
 16

	)

851 
	siw_pmk§
 {

852 
__u32
 
	mcmd
;

853 
sockaddr
 
	mbssid
;

854 
__u8
 
	mpmkid
[
IW_PMKID_LEN
];

858 
	siw_mich«lmicçu»
 {

859 
__u32
 
	mæags
;

860 
sockaddr
 
	m¤c_addr
;

861 
__u8
 
	mtsc
[
IW_ENCODE_SEQ_MAX_SIZE
];

865 
	#IW_PMKID_CAND_PREAUTH
 0x00000001

	)

866 
	siw_pmkid_ÿnd
 {

867 
__u32
 
	mæags
;

868 
__u32
 
	mšdex
;

870 
sockaddr
 
	mbssid
;

877 
	siw_¡©i¡ics
 {

878 
__u16
 
	m¡©us
;

881 
iw_qu®™y
 
	mqu®
;

883 
iw_disÿrded
 
	mdisÿrd
;

884 
iw_mis£d
 
	mmiss
;

898 
	uiw»q_d©a
 {

900 
	mÇme
[
IFNAMSIZ
];

904 
iw_pošt
 
	messid
;

905 
iw_·¿m
 
	mnwid
;

906 
iw_äeq
 
	mäeq
;

910 
iw_·¿m
 
	m£ns
;

911 
iw_·¿m
 
	mb™¿‹
;

912 
iw_·¿m
 
	mtxpow”
;

913 
iw_·¿m
 
	m¹s
;

914 
iw_·¿m
 
	mäag
;

915 
__u32
 
	mmode
;

916 
iw_·¿m
 
	m»Œy
;

918 
iw_pošt
 
	m’codšg
;

919 
iw_·¿m
 
	mpow”
;

920 
iw_qu®™y
 
	mqu®
;

922 
sockaddr
 
	m­_addr
;

923 
sockaddr
 
	maddr
;

925 
iw_·¿m
 
	m·¿m
;

926 
iw_pošt
 
	md©a
;

935 
	siw»q
 {

938 
	miän_Çme
[
IFNAMSIZ
];

939 } 
	miä_iän
;

942 
iw»q_d©a
 
	mu
;

955 
	siw_¿nge
 {

957 
__u32
 
	mthroughput
;

966 
__u32
 
	mmš_nwid
;

967 
__u32
 
	mmax_nwid
;

970 
__u16
 
	mŞd_num_chªÃls
;

971 
__u8
 
	mŞd_num_äequ’cy
;

974 
__u8
 
	msÿn_ÿ·
;

977 
__u32
 
	mev’t_ÿ·
[6];

980 
__s32
 
	m£ns™iv™y
;

987 
iw_qu®™y
 
	mmax_qu®
;

997 
iw_qu®™y
 
	mavg_qu®
;

1000 
__u8
 
	mnum_b™¿‹s
;

1001 
__s32
 
	mb™¿‹
[
IW_MAX_BITRATES
];

1004 
__s32
 
	mmš_¹s
;

1005 
__s32
 
	mmax_¹s
;

1008 
__s32
 
	mmš_äag
;

1009 
__s32
 
	mmax_äag
;

1012 
__s32
 
	mmš_pmp
;

1013 
__s32
 
	mmax_pmp
;

1014 
__s32
 
	mmš_pmt
;

1015 
__s32
 
	mmax_pmt
;

1016 
__u16
 
	mpmp_æags
;

1017 
__u16
 
	mpmt_æags
;

1018 
__u16
 
	mpm_ÿ·
;

1021 
__u16
 
	m’codšg_size
[
IW_MAX_ENCODING_SIZES
];

1022 
__u8
 
	mnum_’codšg_sizes
;

1023 
__u8
 
	mmax_’codšg_tok’s
;

1025 
__u8
 
	m’codšg_logš_šdex
;

1028 
__u16
 
	mtxpow”_ÿ·
;

1029 
__u8
 
	mnum_txpow”
;

1030 
__s32
 
	mtxpow”
[
IW_MAX_TXPOWER
];

1033 
__u8
 
	mwe_v”siÚ_comped
;

1034 
__u8
 
	mwe_v”siÚ_sourû
;

1037 
__u16
 
	m»Œy_ÿ·
;

1038 
__u16
 
	m»Œy_æags
;

1039 
__u16
 
	mr_time_æags
;

1040 
__s32
 
	mmš_»Œy
;

1041 
__s32
 
	mmax_»Œy
;

1042 
__s32
 
	mmš_r_time
;

1043 
__s32
 
	mmax_r_time
;

1046 
__u16
 
	mnum_chªÃls
;

1047 
__u8
 
	mnum_äequ’cy
;

1048 
iw_äeq
 
	mäeq
[
IW_MAX_FREQUENCIES
];

1052 
__u32
 
	m’c_ÿ·
;

1059 
	siw_´iv_¬gs
 {

1060 
__u32
 
	mcmd
;

1061 
__u16
 
	m£t_¬gs
;

1062 
__u16
 
	mg‘_¬gs
;

1063 
	mÇme
[
IFNAMSIZ
];

1076 
	siw_ev’t
 {

1077 
__u16
 
	mËn
;

1078 
__u16
 
	mcmd
;

1079 
iw»q_d©a
 
	mu
;

1083 
	#IW_EV_LCP_LEN
 ((
iw_ev’t
è- (
iw»q_d©a
))

	)

1085 
	#IW_EV_CHAR_LEN
 (
IW_EV_LCP_LEN
 + 
IFNAMSIZ
)

	)

1086 
	#IW_EV_UINT_LEN
 (
IW_EV_LCP_LEN
 + (
__u32
))

	)

1087 
	#IW_EV_FREQ_LEN
 (
IW_EV_LCP_LEN
 + (
iw_äeq
))

	)

1088 
	#IW_EV_PARAM_LEN
 (
IW_EV_LCP_LEN
 + (
iw_·¿m
))

	)

1089 
	#IW_EV_ADDR_LEN
 (
IW_EV_LCP_LEN
 + (
sockaddr
))

	)

1090 
	#IW_EV_QUAL_LEN
 (
IW_EV_LCP_LEN
 + (
iw_qu®™y
))

	)

1095 
	#IW_EV_POINT_OFF
 
	`off£tof
(
iw_pošt
, 
Ëngth
)

	)

1096 
	#IW_EV_POINT_LEN
 (
IW_EV_LCP_LEN
 + (
iw_pošt
) - \

1097 
IW_EV_POINT_OFF
)

	)

1101 
	#IW_EV_LCP_PK_LEN
 (4)

	)

1103 
	#IW_EV_CHAR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 
IFNAMSIZ
)

	)

1104 
	#IW_EV_UINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
__u32
))

	)

1105 
	#IW_EV_FREQ_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_äeq
))

	)

1106 
	#IW_EV_PARAM_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_·¿m
))

	)

1107 
	#IW_EV_ADDR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
sockaddr
))

	)

1108 
	#IW_EV_QUAL_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_qu®™y
))

	)

1109 
	#IW_EV_POINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 4)

	)

	@/usr/include/sys/socket.h

19 #iâdef 
_SYS_SOCKET_H


20 
	#_SYS_SOCKET_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	g__BEGIN_DECLS


26 
	~<b™s/ty³s/¡ruù_iovec.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

33 
	~<b™s/sock‘.h
>

35 #ifdeà
__USE_MISC


36 
	~<b™s/ty³s/¡ruù_osockaddr.h
>

43 
	mSHUT_RD
 = 0,

44 
	#SHUT_RD
 
SHUT_RD


	)

45 
	mSHUT_WR
,

46 
	#SHUT_WR
 
SHUT_WR


	)

47 
	mSHUT_RDWR


48 
	#SHUT_RDWR
 
SHUT_RDWR


	)

57 #ià
defšed
 
__ılu¥lus
 || !
__GNUC_PREREQ
 (2, 7è|| !defšed 
__USE_GNU


58 
	#__SOCKADDR_ARG
 
sockaddr
 *
__»¡riù


	)

59 
	#__CONST_SOCKADDR_ARG
 cÚ¡ 
sockaddr
 *

	)

63 
	#__SOCKADDR_ALLTYPES
 \

64 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

65 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

66 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

67 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

68 
	`__SOCKADDR_ONETYPE
 (
sockaddr_eÚ
) \

69 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š
) \

70 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š6
) \

71 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š¬p
) \

72 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x
) \

73 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

74 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

75 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

78 
	#__SOCKADDR_ONETYPE
(
ty³
èty³ *
__»¡riù
 
__
##ty³##__;

	)

79 uniÚ { 
	m__SOCKADDR_ALLTYPES


80 } 
	t__SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

81 #undeà
__SOCKADDR_ONETYPE


82 
	#__SOCKADDR_ONETYPE
(
ty³
ècÚ¡ ty³ *
__»¡riù
 
__
##ty³##__;

	)

83 uniÚ { 
	m__SOCKADDR_ALLTYPES


84 } 
	t__CONST_SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

85 #undeà
__SOCKADDR_ONETYPE


88 #ifdeà
__USE_GNU


90 
	smmsghdr


92 
msghdr
 
	mmsg_hdr
;

93 
	mmsg_Ën
;

102 
	$sock‘
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
è
__THROW
;

108 
	$sock‘·œ
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
,

109 
__fds
[2]è
__THROW
;

112 
	$bšd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
)

113 
__THROW
;

116 
	$g‘sockÇme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

117 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

126 
	`cÚÃù
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
);

130 
	$g‘³”Çme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

131 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

138 
ssize_t
 
	`£nd
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
, 
__æags
);

145 
ssize_t
 
	`»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
);

152 
ssize_t
 
	`£ndto
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

153 
__æags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

154 
sockËn_t
 
__addr_Ën
);

163 
ssize_t
 
	`»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

164 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

165 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

173 #iâdeà
__USE_TIME_BITS64


174 
ssize_t
 
	`£ndmsg
 (
__fd
, cÚ¡ 
msghdr
 *
__mes§ge
,

175 
__æags
);

177 #ifdeà
__REDIRECT


178 
ssize_t
 
	`__REDIRECT
 (
£ndmsg
, (
__fd
, cÚ¡ 
msghdr
 *
__mes§ge
,

179 
__æags
),

180 
__£ndmsg64
);

182 
ssize_t
 
	`__£ndmsg64
 (
__fd
, cÚ¡ 
msghdr
 *
__mes§ge
,

183 
__æags
);

184 
	#£ndmsg
 
__£ndmsg64


	)

188 #ifdeà
__USE_GNU


194 #iâdeà
__USE_TIME_BITS64


195 
	`£ndmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

196 
__vËn
, 
__æags
);

198 #ifdeà
__REDIRECT


199 
	`__REDIRECT
 (
£ndmmsg
, (
__fd
, 
mmsghdr
 *
__vmes§ges
,

200 
__vËn
, 
__æags
),

201 
__£ndmmsg64
);

203 
	`__£ndmmsg64
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

204 
__vËn
, 
__æags
);

205 
	#£ndmmsg
 
__£ndmmsg64


	)

215 #iâdeà
__USE_TIME_BITS64


216 
ssize_t
 
	`»cvmsg
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

218 #ifdeà
__REDIRECT


219 
ssize_t
 
	`__REDIRECT
 (
»cvmsg
,

220 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
),

221 
__»cvmsg64
);

223 
ssize_t
 
	`__»cvmsg64
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

224 
	#»cvmsg
 
__»cvmsg64


	)

228 #ifdeà
__USE_GNU


234 #iâdeà
__USE_TIME_BITS64


235 
	`»cvmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

236 
__vËn
, 
__æags
,

237 
time¥ec
 *
__tmo
);

239 #ifdeà
__REDIRECT


240 
	`__REDIRECT
 (
»cvmmsg
, (
__fd
, 
mmsghdr
 *
__vmes§ges
,

241 
__vËn
, 
__æags
,

242 
time¥ec
 *
__tmo
),

243 
__»cvmmsg64
);

245 
	#»cvmmsg
 
__»cvmmsg64


	)

254 #iâdeà
__USE_TIME_BITS64


255 
	$g‘sockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

256 *
__»¡riù
 
__İtv®
,

257 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

259 #ifdeà
__REDIRECT


260 
	`__REDIRECT_NTH
 (
g‘sockİt
,

261 (
__fd
, 
__Ëv–
, 
__İŠame
,

262 *
__»¡riù
 
__İtv®
,

263 
sockËn_t
 *
__»¡riù
 
__İ’
),

264 
__g‘sockİt64
);

266 
	$__g‘sockİt64
 (
__fd
, 
__Ëv–
, 
__İŠame
,

267 *
__»¡riù
 
__İtv®
,

268 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

269 
	#g‘sockİt
 
__g‘sockİt64


	)

276 #iâdeà
__USE_TIME_BITS64


277 
	$£tsockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

278 cÚ¡ *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

280 #ifdeà
__REDIRECT


281 
	`__REDIRECT_NTH
 (
£tsockİt
,

282 (
__fd
, 
__Ëv–
, 
__İŠame
,

283 cÚ¡ *
__İtv®
, 
sockËn_t
 
__İ’
),

284 
__£tsockİt64
);

286 
	$__£tsockİt64
 (
__fd
, 
__Ëv–
, 
__İŠame
,

287 cÚ¡ *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

288 
	#£tsockİt
 
__£tsockİt64


	)

296 
	$li¡’
 (
__fd
, 
__n
è
__THROW
;

306 
	`acû±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

307 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

309 #ifdeà
__USE_GNU


314 
	`acû±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

315 
sockËn_t
 *
__»¡riù
 
__addr_Ën
, 
__æags
);

324 
	$shutdown
 (
__fd
, 
__how
è
__THROW
;

327 #ifdeà
__USE_XOPEN2K


329 
	$sock©m¬k
 (
__fd
è
__THROW
;

333 #ifdeà
__USE_MISC


337 
	$isfdty³
 (
__fd
, 
__fdty³
è
__THROW
;

342 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


343 
	~<b™s/sock‘2.h
>

346 
__END_DECLS


	@/usr/include/asm/byteorder.h

2 #iâdeà
_ASM_X86_BYTEORDER_H


3 
	#_ASM_X86_BYTEORDER_H


	)

5 
	~<lšux/by‹Üd”/l™e_’dŸn.h
>

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/poll.h

1 
	~<asm-g’”ic/pŞl.h
>

	@/usr/include/asm/types.h

1 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/bits/socket.h

19 #iâdeà
__BITS_SOCKET_H


20 
	#__BITS_SOCKET_H


	)

22 #iâdeà
_SYS_SOCKET_H


26 
	#__Ãed_size_t


	)

27 
	~<¡ddef.h
>

29 
	~<sys/ty³s.h
>

32 #iâdeà
__sockËn_t_defšed


33 
__sockËn_t
 
	tsockËn_t
;

34 
	#__sockËn_t_defšed


	)

38 
	~<b™s/sock‘_ty³.h
>

41 
	#PF_UNSPEC
 0

	)

42 
	#PF_LOCAL
 1

	)

43 
	#PF_UNIX
 
PF_LOCAL


	)

44 
	#PF_FILE
 
PF_LOCAL


	)

45 
	#PF_INET
 2

	)

46 
	#PF_AX25
 3

	)

47 
	#PF_IPX
 4

	)

48 
	#PF_APPLETALK
 5

	)

49 
	#PF_NETROM
 6

	)

50 
	#PF_BRIDGE
 7

	)

51 
	#PF_ATMPVC
 8

	)

52 
	#PF_X25
 9

	)

53 
	#PF_INET6
 10

	)

54 
	#PF_ROSE
 11

	)

55 
	#PF_DECÃt
 12

	)

56 
	#PF_NETBEUI
 13

	)

57 
	#PF_SECURITY
 14

	)

58 
	#PF_KEY
 15

	)

59 
	#PF_NETLINK
 16

	)

60 
	#PF_ROUTE
 
PF_NETLINK


	)

61 
	#PF_PACKET
 17

	)

62 
	#PF_ASH
 18

	)

63 
	#PF_ECONET
 19

	)

64 
	#PF_ATMSVC
 20

	)

65 
	#PF_RDS
 21

	)

66 
	#PF_SNA
 22

	)

67 
	#PF_IRDA
 23

	)

68 
	#PF_PPPOX
 24

	)

69 
	#PF_WANPIPE
 25

	)

70 
	#PF_LLC
 26

	)

71 
	#PF_IB
 27

	)

72 
	#PF_MPLS
 28

	)

73 
	#PF_CAN
 29

	)

74 
	#PF_TIPC
 30

	)

75 
	#PF_BLUETOOTH
 31

	)

76 
	#PF_IUCV
 32

	)

77 
	#PF_RXRPC
 33

	)

78 
	#PF_ISDN
 34

	)

79 
	#PF_PHONET
 35

	)

80 
	#PF_IEEE802154
 36

	)

81 
	#PF_CAIF
 37

	)

82 
	#PF_ALG
 38

	)

83 
	#PF_NFC
 39

	)

84 
	#PF_VSOCK
 40

	)

85 
	#PF_KCM
 41

	)

86 
	#PF_QIPCRTR
 42

	)

87 
	#PF_SMC
 43

	)

88 
	#PF_XDP
 44

	)

89 
	#PF_MCTP
 45

	)

90 
	#PF_MAX
 46

	)

93 
	#AF_UNSPEC
 
PF_UNSPEC


	)

94 
	#AF_LOCAL
 
PF_LOCAL


	)

95 
	#AF_UNIX
 
PF_UNIX


	)

96 
	#AF_FILE
 
PF_FILE


	)

97 
	#AF_INET
 
PF_INET


	)

98 
	#AF_AX25
 
PF_AX25


	)

99 
	#AF_IPX
 
PF_IPX


	)

100 
	#AF_APPLETALK
 
PF_APPLETALK


	)

101 
	#AF_NETROM
 
PF_NETROM


	)

102 
	#AF_BRIDGE
 
PF_BRIDGE


	)

103 
	#AF_ATMPVC
 
PF_ATMPVC


	)

104 
	#AF_X25
 
PF_X25


	)

105 
	#AF_INET6
 
PF_INET6


	)

106 
	#AF_ROSE
 
PF_ROSE


	)

107 
	#AF_DECÃt
 
PF_DECÃt


	)

108 
	#AF_NETBEUI
 
PF_NETBEUI


	)

109 
	#AF_SECURITY
 
PF_SECURITY


	)

110 
	#AF_KEY
 
PF_KEY


	)

111 
	#AF_NETLINK
 
PF_NETLINK


	)

112 
	#AF_ROUTE
 
PF_ROUTE


	)

113 
	#AF_PACKET
 
PF_PACKET


	)

114 
	#AF_ASH
 
PF_ASH


	)

115 
	#AF_ECONET
 
PF_ECONET


	)

116 
	#AF_ATMSVC
 
PF_ATMSVC


	)

117 
	#AF_RDS
 
PF_RDS


	)

118 
	#AF_SNA
 
PF_SNA


	)

119 
	#AF_IRDA
 
PF_IRDA


	)

120 
	#AF_PPPOX
 
PF_PPPOX


	)

121 
	#AF_WANPIPE
 
PF_WANPIPE


	)

122 
	#AF_LLC
 
PF_LLC


	)

123 
	#AF_IB
 
PF_IB


	)

124 
	#AF_MPLS
 
PF_MPLS


	)

125 
	#AF_CAN
 
PF_CAN


	)

126 
	#AF_TIPC
 
PF_TIPC


	)

127 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

128 
	#AF_IUCV
 
PF_IUCV


	)

129 
	#AF_RXRPC
 
PF_RXRPC


	)

130 
	#AF_ISDN
 
PF_ISDN


	)

131 
	#AF_PHONET
 
PF_PHONET


	)

132 
	#AF_IEEE802154
 
PF_IEEE802154


	)

133 
	#AF_CAIF
 
PF_CAIF


	)

134 
	#AF_ALG
 
PF_ALG


	)

135 
	#AF_NFC
 
PF_NFC


	)

136 
	#AF_VSOCK
 
PF_VSOCK


	)

137 
	#AF_KCM
 
PF_KCM


	)

138 
	#AF_QIPCRTR
 
PF_QIPCRTR


	)

139 
	#AF_SMC
 
PF_SMC


	)

140 
	#AF_XDP
 
PF_XDP


	)

141 
	#AF_MCTP
 
PF_MCTP


	)

142 
	#AF_MAX
 
PF_MAX


	)

148 
	#SOL_RAW
 255

	)

149 
	#SOL_DECNET
 261

	)

150 
	#SOL_X25
 262

	)

151 
	#SOL_PACKET
 263

	)

152 
	#SOL_ATM
 264

	)

153 
	#SOL_AAL
 265

	)

154 
	#SOL_IRDA
 266

	)

155 
	#SOL_NETBEUI
 267

	)

156 
	#SOL_LLC
 268

	)

157 
	#SOL_DCCP
 269

	)

158 
	#SOL_NETLINK
 270

	)

159 
	#SOL_TIPC
 271

	)

160 
	#SOL_RXRPC
 272

	)

161 
	#SOL_PPPOL2TP
 273

	)

162 
	#SOL_BLUETOOTH
 274

	)

163 
	#SOL_PNPIPE
 275

	)

164 
	#SOL_RDS
 276

	)

165 
	#SOL_IUCV
 277

	)

166 
	#SOL_CAIF
 278

	)

167 
	#SOL_ALG
 279

	)

168 
	#SOL_NFC
 280

	)

169 
	#SOL_KCM
 281

	)

170 
	#SOL_TLS
 282

	)

171 
	#SOL_XDP
 283

	)

174 
	#SOMAXCONN
 4096

	)

177 
	~<b™s/sockaddr.h
>

180 
	ssockaddr


182 
__SOCKADDR_COMMON
 (
§_
);

183 
	m§_d©a
[14];

189 
	#__ss_®igÁy³
 

	)

190 
	#_SS_PADSIZE
 \

191 (
_SS_SIZE
 - 
__SOCKADDR_COMMON_SIZE
 -  (
__ss_®igÁy³
))

	)

193 
	ssockaddr_¡Üage


195 
__SOCKADDR_COMMON
 (
ss_
);

196 
	m__ss_·ddšg
[
_SS_PADSIZE
];

197 
__ss_®igÁy³
 
	m__ss_®ign
;

204 
	mMSG_OOB
 = 0x01,

205 
	#MSG_OOB
 
MSG_OOB


	)

206 
	mMSG_PEEK
 = 0x02,

207 
	#MSG_PEEK
 
MSG_PEEK


	)

208 
	mMSG_DONTROUTE
 = 0x04,

209 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

210 #ifdeà
__USE_GNU


212 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

213 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

215 
	mMSG_CTRUNC
 = 0x08,

216 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

217 
	mMSG_PROXY
 = 0x10,

218 
	#MSG_PROXY
 
MSG_PROXY


	)

219 
	mMSG_TRUNC
 = 0x20,

220 
	#MSG_TRUNC
 
MSG_TRUNC


	)

221 
	mMSG_DONTWAIT
 = 0x40,

222 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

223 
	mMSG_EOR
 = 0x80,

224 
	#MSG_EOR
 
MSG_EOR


	)

225 
	mMSG_WAITALL
 = 0x100,

226 
	#MSG_WAITALL
 
MSG_WAITALL


	)

227 
	mMSG_FIN
 = 0x200,

228 
	#MSG_FIN
 
MSG_FIN


	)

229 
	mMSG_SYN
 = 0x400,

230 
	#MSG_SYN
 
MSG_SYN


	)

231 
	mMSG_CONFIRM
 = 0x800,

232 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

233 
	mMSG_RST
 = 0x1000,

234 
	#MSG_RST
 
MSG_RST


	)

235 
	mMSG_ERRQUEUE
 = 0x2000,

236 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

237 
	mMSG_NOSIGNAL
 = 0x4000,

238 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

239 
	mMSG_MORE
 = 0x8000,

240 
	#MSG_MORE
 
MSG_MORE


	)

241 
	mMSG_WAITFORONE
 = 0x10000,

242 
	#MSG_WAITFORONE
 
MSG_WAITFORONE


	)

243 
	mMSG_BATCH
 = 0x40000,

244 
	#MSG_BATCH
 
MSG_BATCH


	)

245 
	mMSG_ZEROCOPY
 = 0x4000000,

246 
	#MSG_ZEROCOPY
 
MSG_ZEROCOPY


	)

247 
	mMSG_FASTOPEN
 = 0x20000000,

248 
	#MSG_FASTOPEN
 
MSG_FASTOPEN


	)

250 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

253 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

259 
	smsghdr


261 *
	mmsg_Çme
;

262 
sockËn_t
 
	mmsg_Çm–’
;

264 
iovec
 *
	mmsg_iov
;

265 
size_t
 
	mmsg_iovËn
;

267 *
	mmsg_cÚŒŞ
;

268 
size_t
 
	mmsg_cÚŒŞËn
;

273 
	mmsg_æags
;

277 
	scmsghdr


279 
size_t
 
	mcmsg_Ën
;

284 
	mcmsg_Ëv–
;

285 
	mcmsg_ty³
;

286 #ià
__glibc_c99_æex¬r_avaabË


287 
__ex‹nsiÚ__
 
__cmsg_d©a
 
	m__æex¬r
;

292 #ià
__glibc_c99_æex¬r_avaabË


293 
	#CMSG_DATA
(
cmsg
è((cmsg)->
__cmsg_d©a
)

	)

295 
	#CMSG_DATA
(
cmsg
è((*è((
cmsghdr
 *è(cmsgè+ 1))

	)

297 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

298 
	#CMSG_FIRSTHDR
(
mhdr
) \

299 ((
size_t
è(
mhdr
)->
msg_cÚŒŞËn
 >ğ (
cmsghdr
) \

300 ? (
cmsghdr
 *è(
mhdr
)->
msg_cÚŒŞ
 : (cmsghd¸*è0)

	)

301 
	#CMSG_ALIGN
(
Ën
è((Ö’è+  (
size_t
) - 1) \

302 & (
size_t
è~( (size_tè- 1))

	)

303 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
 (len) \

304 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

305 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
 ( (
cmsghdr
)è+ (Ën))

	)

307 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

308 
cmsghdr
 *
__cmsg
è
__THROW
;

309 #ifdeà
__USE_EXTERN_INLINES


310 #iâdeà
_EXTERN_INLINE


311 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

313 
_EXTERN_INLINE
 
cmsghdr
 *

314 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

316 ià((
size_t
è
__cmsg
->
cmsg_Ën
 <  (
cmsghdr
))

318  (
cmsghdr
 *) 0;

320 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

321 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Ën
));

322 ià((*è(
__cmsg
 + 1è> ((*è
__mhdr
->
msg_cÚŒŞ


323 + 
__mhdr
->
msg_cÚŒŞËn
)

324 || ((*è
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Ën
)

325 > ((*è
__mhdr
->
msg_cÚŒŞ
 + __mhdr->
msg_cÚŒŞËn
)))

327  (
cmsghdr
 *) 0;

328  
__cmsg
;

329 
	}
}

336 
	mSCM_RIGHTS
 = 0x01

337 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

338 #ifdeà
__USE_GNU


339 , 
	mSCM_CREDENTIALS
 = 0x02

340 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

344 #ifdeà
__USE_GNU


346 
	suüed


348 
pid_t
 
	mpid
;

349 
uid_t
 
	muid
;

350 
gid_t
 
	mgid
;

354 #ifdeà
__USE_MISC


355 
	~<b™s/ty³s/time_t.h
>

356 
	~<asm/sock‘.h
>

358 
	#SO_DEBUG
 1

	)

359 
	~<b™s/sock‘-cÚ¡ªts.h
>

363 
	slšg”


365 
	ml_Úoff
;

366 
	ml_lšg”
;

	@/usr/include/bits/socket2.h

19 #iâdeà
_SYS_SOCKET_H


23 
ssize_t
 
__»cv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

24 
__æags
);

25 
ssize_t
 
__REDIRECT
 (
__»cv_®Ÿs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

26 
__æags
), 
»cv
);

27 
ssize_t
 
__REDIRECT
 (
__»cv_chk_w¬n
,

28 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

29 
__æags
), 
__»cv_chk
)

30 
__w¬Ç‰r
 ("recv called with bigger†engthhan size of destination "

33 
__fÜtify_funùiÚ
 
ssize_t


34 
	$»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
)

36 
size_t
 
sz
 = 
	`__glibc_objsize0
 (
__buf
);

37 ià(
	`__glibc_§ã_Ü_unknown_Ën
 (
__n
,  (), 
sz
))

38  
	`__»cv_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
);

39 ià(
	`__glibc_un§ã_Ën
 (
__n
,  (), 
sz
))

40  
	`__»cv_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
sz
, 
__æags
);

41  
	`__»cv_chk
 (
__fd
, 
__buf
, 
__n
, 
sz
, 
__æags
);

42 
	}
}

44 
ssize_t
 
__»cväom_chk
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

45 
size_t
 
__buæ’
, 
__æags
,

46 
__SOCKADDR_ARG
 
__addr
,

47 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

48 
ssize_t
 
__REDIRECT
 (
__»cväom_®Ÿs
,

49 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

50 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

51 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
»cväom
);

52 
ssize_t
 
__REDIRECT
 (
__»cväom_chk_w¬n
,

53 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

54 
size_t
 
__buæ’
, 
__æags
,

55 
__SOCKADDR_ARG
 
__addr
,

56 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
__»cväom_chk
)

57 
__w¬Ç‰r
 ("recvfrom called with bigger†engthhan size of "

60 
__fÜtify_funùiÚ
 
ssize_t


61 
	$»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
, 
__æags
,

62 
__SOCKADDR_ARG
 
__addr
, 
sockËn_t
 *
__»¡riù
 
__addr_Ën
)

64 
size_t
 
sz
 = 
	`__glibc_objsize0
 (
__buf
);

65 ià(
	`__glibc_§ã_Ü_unknown_Ën
 (
__n
,  (), 
sz
))

66  
	`__»cväom_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
, 
__addr
, 
__addr_Ën
);

67 ià(
	`__glibc_un§ã_Ën
 (
__n
,  (), 
sz
))

68  
	`__»cväom_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
sz
, 
__æags
, 
__addr
,

69 
__addr_Ën
);

70  
	`__»cväom_chk
 (
__fd
, 
__buf
, 
__n
, 
sz
, 
__æags
, 
__addr
, 
__addr_Ën
);

71 
	}
}

	@/usr/include/bits/types/struct_iovec.h

19 #iâdeà
__iovec_defšed


20 
	#__iovec_defšed
 1

	)

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 
	siovec


28 *
	miov_ba£
;

29 
size_t
 
	miov_Ën
;

	@/usr/include/bits/types/struct_osockaddr.h

1 #iâdeà
__osockaddr_defšed


2 
	#__osockaddr_defšed
 1

	)

6 
	sosockaddr


8 
	m§_çmy
;

9 
	m§_d©a
[14];

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

126 #undeà
__USE_ISOC11


127 #undeà
__USE_ISOC99


128 #undeà
__USE_ISOC95


129 #undeà
__USE_ISOCXX11


130 #undeà
__USE_POSIX


131 #undeà
__USE_POSIX2


132 #undeà
__USE_POSIX199309


133 #undeà
__USE_POSIX199506


134 #undeà
__USE_XOPEN


135 #undeà
__USE_XOPEN_EXTENDED


136 #undeà
__USE_UNIX98


137 #undeà
__USE_XOPEN2K


138 #undeà
__USE_XOPEN2KXSI


139 #undeà
__USE_XOPEN2K8


140 #undeà
__USE_XOPEN2K8XSI


141 #undeà
__USE_LARGEFILE


142 #undeà
__USE_LARGEFILE64


143 #undeà
__USE_FILE_OFFSET64


144 #undeà
__USE_MISC


145 #undeà
__USE_ATFILE


146 #undeà
__USE_DYNAMIC_STACK_SIZE


147 #undeà
__USE_GNU


148 #undeà
__USE_FORTIFY_LEVEL


149 #undeà
__KERNEL_STRICT_NAMES


150 #undeà
__GLIBC_USE_ISOC2X


151 #undeà
__GLIBC_USE_DEPRECATED_GETS


152 #undeà
__GLIBC_USE_DEPRECATED_SCANF


156 #iâdeà
_LOOSE_KERNEL_NAMES


157 
	#__KERNEL_STRICT_NAMES


	)

167 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


168 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

169 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

171 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

178 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


179 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

180 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

182 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

186 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

192 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

193 && !
defšed
 
	g_DEFAULT_SOURCE


195 #undeà
_DEFAULT_SOURCE


196 
	#_DEFAULT_SOURCE
 1

	)

200 #ifdeà
_GNU_SOURCE


201 #undeà
_ISOC95_SOURCE


202 
	#_ISOC95_SOURCE
 1

	)

203 #undeà
_ISOC99_SOURCE


204 
	#_ISOC99_SOURCE
 1

	)

205 #undeà
_ISOC11_SOURCE


206 
	#_ISOC11_SOURCE
 1

	)

207 #undeà
_ISOC2X_SOURCE


208 
	#_ISOC2X_SOURCE
 1

	)

209 #undeà
_POSIX_SOURCE


210 
	#_POSIX_SOURCE
 1

	)

211 #undeà
_POSIX_C_SOURCE


212 
	#_POSIX_C_SOURCE
 200809L

	)

213 #undeà
_XOPEN_SOURCE


214 
	#_XOPEN_SOURCE
 700

	)

215 #undeà
_XOPEN_SOURCE_EXTENDED


216 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

217 #undeà
_LARGEFILE64_SOURCE


218 
	#_LARGEFILE64_SOURCE
 1

	)

219 #undeà
_DEFAULT_SOURCE


220 
	#_DEFAULT_SOURCE
 1

	)

221 #undeà
_ATFILE_SOURCE


222 
	#_ATFILE_SOURCE
 1

	)

223 #undeà
_DYNAMIC_STACK_SIZE_SOURCE


224 
	#_DYNAMIC_STACK_SIZE_SOURCE
 1

	)

229 #ià(
defšed
 
_DEFAULT_SOURCE
 \

230 || (!
defšed
 
	g__STRICT_ANSI__
 \

231 && !
defšed
 
	g_ISOC99_SOURCE
 && !defšed 
	g_ISOC11_SOURCE
 \

232 && !
defšed
 
	g_ISOC2X_SOURCE
 \

233 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

234 && !
defšed
 
	g_XOPEN_SOURCE
))

235 #undeà
_DEFAULT_SOURCE


236 
	#_DEFAULT_SOURCE
 1

	)

240 #ià(
defšed
 
_ISOC2X_SOURCE
 \

241 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ > 201710L))

242 
	#__GLIBC_USE_ISOC2X
 1

	)

244 
	#__GLIBC_USE_ISOC2X
 0

	)

248 #ià(
defšed
 
_ISOC11_SOURCE
 || defšed 
_ISOC2X_SOURCE
 \

249 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

250 
	#__USE_ISOC11
 1

	)

254 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

255 || 
defšed
 
_ISOC2X_SOURCE
 \

256 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

257 
	#__USE_ISOC99
 1

	)

261 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

262 || 
defšed
 
_ISOC2X_SOURCE
 \

263 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

264 
	#__USE_ISOC95
 1

	)

267 #ifdeà
__ılu¥lus


269 #ià
__ılu¥lus
 >= 201703L

270 
	#__USE_ISOC11
 1

	)

274 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


275 
	#__USE_ISOCXX11
 1

	)

276 
	#__USE_ISOC99
 1

	)

283 #ifdeà
_DEFAULT_SOURCE


284 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


285 
	#__USE_POSIX_IMPLICITLY
 1

	)

287 #undeà
_POSIX_SOURCE


288 
	#_POSIX_SOURCE
 1

	)

289 #undeà
_POSIX_C_SOURCE


290 
	#_POSIX_C_SOURCE
 200809L

	)

293 #ià((!
defšed
 
__STRICT_ANSI__
 \

294 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

295 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

296 
	#_POSIX_SOURCE
 1

	)

297 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

298 
	#_POSIX_C_SOURCE
 2

	)

299 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

300 
	#_POSIX_C_SOURCE
 199506L

	)

301 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

302 
	#_POSIX_C_SOURCE
 200112L

	)

304 
	#_POSIX_C_SOURCE
 200809L

	)

306 
	#__USE_POSIX_IMPLICITLY
 1

	)

315 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

316 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

317 
	#_POSIX_SOURCE
 1

	)

318 #undeà
_POSIX_C_SOURCE


319 
	#_POSIX_C_SOURCE
 199506L

	)

322 #ià(
defšed
 
_POSIX_SOURCE
 \

323 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

324 || 
defšed
 
_XOPEN_SOURCE
)

325 
	#__USE_POSIX
 1

	)

328 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


329 
	#__USE_POSIX2
 1

	)

332 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

333 
	#__USE_POSIX199309
 1

	)

336 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

337 
	#__USE_POSIX199506
 1

	)

340 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

341 
	#__USE_XOPEN2K
 1

	)

342 #undeà
__USE_ISOC95


343 
	#__USE_ISOC95
 1

	)

344 #undeà
__USE_ISOC99


345 
	#__USE_ISOC99
 1

	)

348 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

349 
	#__USE_XOPEN2K8
 1

	)

350 #undeà
_ATFILE_SOURCE


351 
	#_ATFILE_SOURCE
 1

	)

354 #ifdef 
_XOPEN_SOURCE


355 
	#__USE_XOPEN
 1

	)

356 #ià(
_XOPEN_SOURCE
 - 0) >= 500

357 
	#__USE_XOPEN_EXTENDED
 1

	)

358 
	#__USE_UNIX98
 1

	)

359 #undeà
_LARGEFILE_SOURCE


360 
	#_LARGEFILE_SOURCE
 1

	)

361 #ià(
_XOPEN_SOURCE
 - 0) >= 600

362 #ià(
_XOPEN_SOURCE
 - 0) >= 700

363 
	#__USE_XOPEN2K8
 1

	)

364 
	#__USE_XOPEN2K8XSI
 1

	)

366 
	#__USE_XOPEN2K
 1

	)

367 
	#__USE_XOPEN2KXSI
 1

	)

368 #undeà
__USE_ISOC95


369 
	#__USE_ISOC95
 1

	)

370 #undeà
__USE_ISOC99


371 
	#__USE_ISOC99
 1

	)

374 #ifdeà
_XOPEN_SOURCE_EXTENDED


375 
	#__USE_XOPEN_EXTENDED
 1

	)

380 #ifdeà
_LARGEFILE_SOURCE


381 
	#__USE_LARGEFILE
 1

	)

384 #ifdeà
_LARGEFILE64_SOURCE


385 
	#__USE_LARGEFILE64
 1

	)

388 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

389 
	#__USE_FILE_OFFSET64
 1

	)

392 
	~<ã©u»s-time64.h
>

394 #ià
defšed
 
_DEFAULT_SOURCE


395 
	#__USE_MISC
 1

	)

398 #ifdef 
_ATFILE_SOURCE


399 
	#__USE_ATFILE
 1

	)

402 #ifdef 
_DYNAMIC_STACK_SIZE_SOURCE


403 
	#__USE_DYNAMIC_STACK_SIZE
 1

	)

406 #ifdef 
_GNU_SOURCE


407 
	#__USE_GNU
 1

	)

410 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0

411 #ià!
defšed
 
__OPTIMIZE__
 || __OPTIMIZE__ <= 0

412 #–ià!
__GNUC_PREREQ
 (4, 1)

413 #–ià
_FORTIFY_SOURCE
 > 2 && (
__glibc_şªg_´”eq
 (9, 0) \

414 || 
	$__GNUC_PREREQ
 (12, 0))

416 #ià
_FORTIFY_SOURCE
 > 3

418 
	#__USE_FORTIFY_LEVEL
 3

	)

419 #–ià
_FORTIFY_SOURCE
 > 1

420 #ià
_FORTIFY_SOURCE
 > 2

422 
	#__USE_FORTIFY_LEVEL
 2

	)

424 
	#__USE_FORTIFY_LEVEL
 1

	)

427 #iâdeà
__USE_FORTIFY_LEVEL


428 
	#__USE_FORTIFY_LEVEL
 0

	)

435 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


436 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

438 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

453 #ià(
defšed
 
__USE_GNU
 \

454 && (
defšed
 
__ılu¥lus
 \

455 ? (
__ılu¥lus
 < 201103L && !
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
) \

456 : (!
defšed
 
__STDC_VERSION__
 || __STDC_VERSION__ < 199901L)))

457 
	#__GLIBC_USE_DEPRECATED_SCANF
 1

	)

459 
	#__GLIBC_USE_DEPRECATED_SCANF
 0

	)

464 
	~<¡dc-´edef.h
>

472 #undeà
__GNU_LIBRARY__


473 
	#__GNU_LIBRARY__
 6

	)

477 
	#__GLIBC__
 2

	)

478 
	#__GLIBC_MINOR__
 35

	)

480 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

481 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

484 #iâdeà
__ASSEMBLER__


485 #iâdeà
_SYS_CDEFS_H


486 
	~<sys/cdefs.h
>

491 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


492 
	#__USE_LARGEFILE
 1

	)

493 
	#__USE_LARGEFILE64
 1

	)

499 #ià
	`__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

500 && !
defšed
 
__OPTIMIZE_SIZE__
 && !defšed 
__NO_INLINE__
 \

501 && 
defšed
 
__ex‹º_šlše


502 
	#__USE_EXTERN_INLINES
 1

	)

510 
	~<gnu/¡ubs.h
>

	@/usr/include/linux/const.h

4 #iâdeà
_LINUX_CONST_H


5 
	#_LINUX_CONST_H


	)

16 #ifdeà
__ASSEMBLY__


17 
	#_AC
(
X
,
Y
è
	)
X

18 
	#_AT
(
T
,
X
è
	)
X

20 
	#__AC
(
X
,
Y
è(X##Y)

	)

21 
	#_AC
(
X
,
Y
è
	`__AC
(X,Y)

	)

22 
	#_AT
(
T
,
X
è((T)(X))

	)

25 
	#_UL
(
x
è(
	`_AC
(x, 
UL
))

	)

26 
	#_ULL
(
x
è(
	`_AC
(x, 
ULL
))

	)

28 
	#_BITUL
(
x
è(
	`_UL
(1è<< (x))

	)

29 
	#_BITULL
(
x
è(
	`_ULL
(1è<< (x))

	)

31 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`__ty³of__
(x))×è- 1)

	)

32 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

34 
	#__KERNEL_DIV_ROUND_UP
(
n
, 
d
è((Òè+ (dè- 1è/ (d))

	)

	@/usr/include/linux/fscrypt.h

8 #iâdeà
_LINUX_FSCRYPT_H


9 
	#_LINUX_FSCRYPT_H


	)

11 
	~<lšux/ioùl.h
>

12 
	~<lšux/ty³s.h
>

15 
	#FSCRYPT_POLICY_FLAGS_PAD_4
 0x00

	)

16 
	#FSCRYPT_POLICY_FLAGS_PAD_8
 0x01

	)

17 
	#FSCRYPT_POLICY_FLAGS_PAD_16
 0x02

	)

18 
	#FSCRYPT_POLICY_FLAGS_PAD_32
 0x03

	)

19 
	#FSCRYPT_POLICY_FLAGS_PAD_MASK
 0x03

	)

20 
	#FSCRYPT_POLICY_FLAG_DIRECT_KEY
 0x04

	)

21 
	#FSCRYPT_POLICY_FLAG_IV_INO_LBLK_64
 0x08

	)

22 
	#FSCRYPT_POLICY_FLAG_IV_INO_LBLK_32
 0x10

	)

25 
	#FSCRYPT_MODE_AES_256_XTS
 1

	)

26 
	#FSCRYPT_MODE_AES_256_CTS
 4

	)

27 
	#FSCRYPT_MODE_AES_128_CBC
 5

	)

28 
	#FSCRYPT_MODE_AES_128_CTS
 6

	)

29 
	#FSCRYPT_MODE_ADIANTUM
 9

	)

38 
	#FSCRYPT_POLICY_V1
 0

	)

39 
	#FSCRYPT_KEY_DESCRIPTOR_SIZE
 8

	)

40 
	sfsüy±_pŞicy_v1
 {

41 
__u8
 
	mv”siÚ
;

42 
__u8
 
	mcÚ‹Ás_’üy±iÚ_mode
;

43 
__u8
 
	mf’ames_’üy±iÚ_mode
;

44 
__u8
 
	mæags
;

45 
__u8
 
	mma¡”_key_desütÜ
[
FSCRYPT_KEY_DESCRIPTOR_SIZE
];

52 
	#FSCRYPT_KEY_DESC_PREFIX
 "fsüy±:"

	)

53 
	#FSCRYPT_KEY_DESC_PREFIX_SIZE
 8

	)

54 
	#FSCRYPT_MAX_KEY_SIZE
 64

	)

55 
	sfsüy±_key
 {

56 
__u32
 
	mmode
;

57 
__u8
 
	m¿w
[
FSCRYPT_MAX_KEY_SIZE
];

58 
__u32
 
	msize
;

64 
	#FSCRYPT_POLICY_V2
 2

	)

65 
	#FSCRYPT_KEY_IDENTIFIER_SIZE
 16

	)

66 
	sfsüy±_pŞicy_v2
 {

67 
__u8
 
	mv”siÚ
;

68 
__u8
 
	mcÚ‹Ás_’üy±iÚ_mode
;

69 
__u8
 
	mf’ames_’üy±iÚ_mode
;

70 
__u8
 
	mæags
;

71 
__u8
 
	m__»£rved
[4];

72 
__u8
 
	mma¡”_key_id’tif›r
[
FSCRYPT_KEY_IDENTIFIER_SIZE
];

76 
	sfsüy±_g‘_pŞicy_ex_¬g
 {

77 
__u64
 
	mpŞicy_size
;

79 
__u8
 
	mv”siÚ
;

80 
fsüy±_pŞicy_v1
 
	mv1
;

81 
fsüy±_pŞicy_v2
 
	mv2
;

82 } 
	mpŞicy
;

89 
	#FSCRYPT_KEY_SPEC_TYPE_DESCRIPTOR
 1

	)

96 
	#FSCRYPT_KEY_SPEC_TYPE_IDENTIFIER
 2

	)

102 
	sfsüy±_key_¥ecif›r
 {

103 
__u32
 
	mty³
;

104 
__u32
 
	m__»£rved
;

106 
__u8
 
	m__»£rved
[32];

107 
__u8
 
	mdesütÜ
[
FSCRYPT_KEY_DESCRIPTOR_SIZE
];

108 
__u8
 
	mid’tif›r
[
FSCRYPT_KEY_IDENTIFIER_SIZE
];

109 } 
	mu
;

116 
	sfsüy±_´ovisiÚšg_key_·ylßd
 {

117 
__u32
 
	mty³
;

118 
__u32
 
	m__»£rved
;

119 
__u8
 
	m¿w
[];

123 
	sfsüy±_add_key_¬g
 {

124 
fsüy±_key_¥ecif›r
 
	mkey_¥ec
;

125 
__u32
 
	m¿w_size
;

126 
__u32
 
	mkey_id
;

127 
__u32
 
	m__»£rved
[8];

128 
__u8
 
	m¿w
[];

132 
	sfsüy±_»move_key_¬g
 {

133 
fsüy±_key_¥ecif›r
 
	mkey_¥ec
;

134 
	#FSCRYPT_KEY_REMOVAL_STATUS_FLAG_FILES_BUSY
 0x00000001

	)

135 
	#FSCRYPT_KEY_REMOVAL_STATUS_FLAG_OTHER_USERS
 0x00000002

	)

136 
__u32
 
	m»mov®_¡©us_æags
;

137 
__u32
 
	m__»£rved
[5];

141 
	sfsüy±_g‘_key_¡©us_¬g
 {

143 
fsüy±_key_¥ecif›r
 
	mkey_¥ec
;

144 
__u32
 
	m__»£rved
[6];

147 
	#FSCRYPT_KEY_STATUS_ABSENT
 1

	)

148 
	#FSCRYPT_KEY_STATUS_PRESENT
 2

	)

149 
	#FSCRYPT_KEY_STATUS_INCOMPLETELY_REMOVED
 3

	)

150 
__u32
 
	m¡©us
;

151 
	#FSCRYPT_KEY_STATUS_FLAG_ADDED_BY_SELF
 0x00000001

	)

152 
__u32
 
	m¡©us_æags
;

153 
__u32
 
	mu£r_couÁ
;

154 
__u32
 
	m__out_»£rved
[13];

157 
	#FS_IOC_SET_ENCRYPTION_POLICY
 
	`_IOR
('f', 19, 
fsüy±_pŞicy_v1
)

	)

158 
	#FS_IOC_GET_ENCRYPTION_PWSALT
 
	`_IOW
('f', 20, 
__u8
[16])

	)

159 
	#FS_IOC_GET_ENCRYPTION_POLICY
 
	`_IOW
('f', 21, 
fsüy±_pŞicy_v1
)

	)

160 
	#FS_IOC_GET_ENCRYPTION_POLICY_EX
 
	`_IOWR
('f', 22, 
__u8
[9]è

	)

161 
	#FS_IOC_ADD_ENCRYPTION_KEY
 
	`_IOWR
('f', 23, 
fsüy±_add_key_¬g
)

	)

162 
	#FS_IOC_REMOVE_ENCRYPTION_KEY
 
	`_IOWR
('f', 24, 
fsüy±_»move_key_¬g
)

	)

163 
	#FS_IOC_REMOVE_ENCRYPTION_KEY_ALL_USERS
 
	`_IOWR
('f', 25, 
fsüy±_»move_key_¬g
)

	)

164 
	#FS_IOC_GET_ENCRYPTION_KEY_STATUS
 
	`_IOWR
('f', 26, 
fsüy±_g‘_key_¡©us_¬g
)

	)

165 
	#FS_IOC_GET_ENCRYPTION_NONCE
 
	`_IOR
('f', 27, 
__u8
[16])

	)

170 
	#fsüy±_pŞicy
 
fsüy±_pŞicy_v1


	)

171 
	#FS_KEY_DESCRIPTOR_SIZE
 
FSCRYPT_KEY_DESCRIPTOR_SIZE


	)

172 
	#FS_POLICY_FLAGS_PAD_4
 
FSCRYPT_POLICY_FLAGS_PAD_4


	)

173 
	#FS_POLICY_FLAGS_PAD_8
 
FSCRYPT_POLICY_FLAGS_PAD_8


	)

174 
	#FS_POLICY_FLAGS_PAD_16
 
FSCRYPT_POLICY_FLAGS_PAD_16


	)

175 
	#FS_POLICY_FLAGS_PAD_32
 
FSCRYPT_POLICY_FLAGS_PAD_32


	)

176 
	#FS_POLICY_FLAGS_PAD_MASK
 
FSCRYPT_POLICY_FLAGS_PAD_MASK


	)

177 
	#FS_POLICY_FLAG_DIRECT_KEY
 
FSCRYPT_POLICY_FLAG_DIRECT_KEY


	)

178 
	#FS_POLICY_FLAGS_VALID
 0x07

	)

179 
	#FS_ENCRYPTION_MODE_INVALID
 0

	)

180 
	#FS_ENCRYPTION_MODE_AES_256_XTS
 
FSCRYPT_MODE_AES_256_XTS


	)

181 
	#FS_ENCRYPTION_MODE_AES_256_GCM
 2

	)

182 
	#FS_ENCRYPTION_MODE_AES_256_CBC
 3

	)

183 
	#FS_ENCRYPTION_MODE_AES_256_CTS
 
FSCRYPT_MODE_AES_256_CTS


	)

184 
	#FS_ENCRYPTION_MODE_AES_128_CBC
 
FSCRYPT_MODE_AES_128_CBC


	)

185 
	#FS_ENCRYPTION_MODE_AES_128_CTS
 
FSCRYPT_MODE_AES_128_CTS


	)

186 
	#FS_ENCRYPTION_MODE_SPECK128_256_XTS
 7

	)

187 
	#FS_ENCRYPTION_MODE_SPECK128_256_CTS
 8

	)

188 
	#FS_ENCRYPTION_MODE_ADIANTUM
 
FSCRYPT_MODE_ADIANTUM


	)

189 
	#FS_KEY_DESC_PREFIX
 
FSCRYPT_KEY_DESC_PREFIX


	)

190 
	#FS_KEY_DESC_PREFIX_SIZE
 
FSCRYPT_KEY_DESC_PREFIX_SIZE


	)

191 
	#FS_MAX_KEY_SIZE
 
FSCRYPT_MAX_KEY_SIZE


	)

	@/usr/include/linux/hdlc/ioctl.h

2 #iâdeà
__HDLC_IOCTL_H__


3 
	#__HDLC_IOCTL_H__


	)

6 
	#GENERIC_HDLC_VERSION
 4

	)

8 
	#CLOCK_DEFAULT
 0

	)

9 
	#CLOCK_EXT
 1

	)

10 
	#CLOCK_INT
 2

	)

11 
	#CLOCK_TXINT
 3

	)

12 
	#CLOCK_TXFROMRX
 4

	)

15 
	#ENCODING_DEFAULT
 0

	)

16 
	#ENCODING_NRZ
 1

	)

17 
	#ENCODING_NRZI
 2

	)

18 
	#ENCODING_FM_MARK
 3

	)

19 
	#ENCODING_FM_SPACE
 4

	)

20 
	#ENCODING_MANCHESTER
 5

	)

23 
	#PARITY_DEFAULT
 0

	)

24 
	#PARITY_NONE
 1

	)

25 
	#PARITY_CRC16_PR0
 2

	)

26 
	#PARITY_CRC16_PR1
 3

	)

27 
	#PARITY_CRC16_PR0_CCITT
 4

	)

28 
	#PARITY_CRC16_PR1_CCITT
 5

	)

29 
	#PARITY_CRC32_PR0_CCITT
 6

	)

30 
	#PARITY_CRC32_PR1_CCITT
 7

	)

32 
	#LMI_DEFAULT
 0

	)

33 
	#LMI_NONE
 1

	)

34 
	#LMI_ANSI
 2

	)

35 
	#LMI_CCITT
 3

	)

36 
	#LMI_CISCO
 4

	)

38 #iâdeà
__ASSEMBLY__


41 
	mşock_¿‹
;

42 
	mşock_ty³
;

43 
	mloİback
;

44 } 
	tsync_£rŸl_£‰šgs
;

47 
	mşock_¿‹
;

48 
	mşock_ty³
;

49 
	mloİback
;

50 
	m¦Ù_m­
;

51 } 
	t‹1_£‰šgs
;

54 
	m’codšg
;

55 
	m·r™y
;

56 } 
	t¿w_hdlc_´Ùo
;

59 
	mt391
;

60 
	mt392
;

61 
	mn391
;

62 
	mn392
;

63 
	mn393
;

64 
	mlmi
;

65 
	mdû
;

66 } 
	tä_´Ùo
;

69 
	mdlci
;

70 } 
	tä_´Ùo_pvc
;

73 
	mdlci
;

74 
	mma¡”
[
IFNAMSIZ
];

75 }
	tä_´Ùo_pvc_šfo
;

78 
	mš‹rv®
;

79 
	mtimeout
;

80 } 
	tcisco_´Ùo
;

83 
	mdû
;

84 
	mmodulo
;

85 
	mwšdow
;

86 
	mt1
;

87 
	mt2
;

88 
	mn2
;

89 } 
	tx25_hdlc_´Ùo
;

	@/usr/include/linux/if_addr.h

2 #iâdeà
__LINUX_IF_ADDR_H


3 
	#__LINUX_IF_ADDR_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

8 
	siçddrmsg
 {

9 
__u8
 
	miç_çmy
;

10 
__u8
 
	miç_´efixËn
;

11 
__u8
 
	miç_æags
;

12 
__u8
 
	miç_scİe
;

13 
__u32
 
	miç_šdex
;

27 
	mIFA_UNSPEC
,

28 
	mIFA_ADDRESS
,

29 
	mIFA_LOCAL
,

30 
	mIFA_LABEL
,

31 
	mIFA_BROADCAST
,

32 
	mIFA_ANYCAST
,

33 
	mIFA_CACHEINFO
,

34 
	mIFA_MULTICAST
,

35 
	mIFA_FLAGS
,

36 
	mIFA_RT_PRIORITY
,

37 
	mIFA_TARGET_NETNSID
,

38 
	m__IFA_MAX
,

41 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

44 
	#IFA_F_SECONDARY
 0x01

	)

45 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

47 
	#IFA_F_NODAD
 0x02

	)

48 
	#IFA_F_OPTIMISTIC
 0x04

	)

49 
	#IFA_F_DADFAILED
 0x08

	)

50 
	#IFA_F_HOMEADDRESS
 0x10

	)

51 
	#IFA_F_DEPRECATED
 0x20

	)

52 
	#IFA_F_TENTATIVE
 0x40

	)

53 
	#IFA_F_PERMANENT
 0x80

	)

54 
	#IFA_F_MANAGETEMPADDR
 0x100

	)

55 
	#IFA_F_NOPREFIXROUTE
 0x200

	)

56 
	#IFA_F_MCAUTOJOIN
 0x400

	)

57 
	#IFA_F_STABLE_PRIVACY
 0x800

	)

59 
	siç_ÿchešfo
 {

60 
__u32
 
	miç_´eã»d
;

61 
__u32
 
	miç_v®id
;

62 
__u32
 
	mc¡amp
;

63 
__u32
 
	mt¡amp
;

67 
	#IFA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
içddrmsg
))))

	)

68 
	#IFA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
içddrmsg
))

	)

	@/usr/include/linux/if_link.h

2 #iâdeà
_LINUX_IF_LINK_H


3 
	#_LINUX_IF_LINK_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

9 
	s¹Æ_lšk_¡©s
 {

10 
__u32
 
	mrx_·ck‘s
;

11 
__u32
 
	mtx_·ck‘s
;

12 
__u32
 
	mrx_by‹s
;

13 
__u32
 
	mtx_by‹s
;

14 
__u32
 
	mrx_”rÜs
;

15 
__u32
 
	mtx_”rÜs
;

16 
__u32
 
	mrx_drİ³d
;

17 
__u32
 
	mtx_drİ³d
;

18 
__u32
 
	mmuÉiÿ¡
;

19 
__u32
 
	mcŞlisiÚs
;

21 
__u32
 
	mrx_Ëngth_”rÜs
;

22 
__u32
 
	mrx_ov”_”rÜs
;

23 
__u32
 
	mrx_üc_”rÜs
;

24 
__u32
 
	mrx_äame_”rÜs
;

25 
__u32
 
	mrx_fifo_”rÜs
;

26 
__u32
 
	mrx_mis£d_”rÜs
;

29 
__u32
 
	mtx_abÜ‹d_”rÜs
;

30 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

31 
__u32
 
	mtx_fifo_”rÜs
;

32 
__u32
 
	mtx_h—¹b—t_”rÜs
;

33 
__u32
 
	mtx_wšdow_”rÜs
;

36 
__u32
 
	mrx_com´es£d
;

37 
__u32
 
	mtx_com´es£d
;

39 
__u32
 
	mrx_nohªdËr
;

215 
	s¹Æ_lšk_¡©s64
 {

216 
__u64
 
	mrx_·ck‘s
;

217 
__u64
 
	mtx_·ck‘s
;

218 
__u64
 
	mrx_by‹s
;

219 
__u64
 
	mtx_by‹s
;

220 
__u64
 
	mrx_”rÜs
;

221 
__u64
 
	mtx_”rÜs
;

222 
__u64
 
	mrx_drİ³d
;

223 
__u64
 
	mtx_drİ³d
;

224 
__u64
 
	mmuÉiÿ¡
;

225 
__u64
 
	mcŞlisiÚs
;

228 
__u64
 
	mrx_Ëngth_”rÜs
;

229 
__u64
 
	mrx_ov”_”rÜs
;

230 
__u64
 
	mrx_üc_”rÜs
;

231 
__u64
 
	mrx_äame_”rÜs
;

232 
__u64
 
	mrx_fifo_”rÜs
;

233 
__u64
 
	mrx_mis£d_”rÜs
;

236 
__u64
 
	mtx_abÜ‹d_”rÜs
;

237 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

238 
__u64
 
	mtx_fifo_”rÜs
;

239 
__u64
 
	mtx_h—¹b—t_”rÜs
;

240 
__u64
 
	mtx_wšdow_”rÜs
;

243 
__u64
 
	mrx_com´es£d
;

244 
__u64
 
	mtx_com´es£d
;

245 
__u64
 
	mrx_nohªdËr
;

249 
	s¹Æ_lšk_ifm­
 {

250 
__u64
 
	mmem_¡¬t
;

251 
__u64
 
	mmem_’d
;

252 
__u64
 
	mba£_addr
;

253 
__u16
 
	mœq
;

254 
__u8
 
	mdma
;

255 
__u8
 
	mpÜt
;

277 
	mIFLA_UNSPEC
,

278 
	mIFLA_ADDRESS
,

279 
	mIFLA_BROADCAST
,

280 
	mIFLA_IFNAME
,

281 
	mIFLA_MTU
,

282 
	mIFLA_LINK
,

283 
	mIFLA_QDISC
,

284 
	mIFLA_STATS
,

285 
	mIFLA_COST
,

286 
	#IFLA_COST
 
IFLA_COST


	)

287 
	mIFLA_PRIORITY
,

288 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

289 
	mIFLA_MASTER
,

290 
	#IFLA_MASTER
 
IFLA_MASTER


	)

291 
	mIFLA_WIRELESS
,

292 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

293 
	mIFLA_PROTINFO
,

294 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

295 
	mIFLA_TXQLEN
,

296 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

297 
	mIFLA_MAP
,

298 
	#IFLA_MAP
 
IFLA_MAP


	)

299 
	mIFLA_WEIGHT
,

300 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

301 
	mIFLA_OPERSTATE
,

302 
	mIFLA_LINKMODE
,

303 
	mIFLA_LINKINFO
,

304 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

305 
	mIFLA_NET_NS_PID
,

306 
	mIFLA_IFALIAS
,

307 
	mIFLA_NUM_VF
,

308 
	mIFLA_VFINFO_LIST
,

309 
	mIFLA_STATS64
,

310 
	mIFLA_VF_PORTS
,

311 
	mIFLA_PORT_SELF
,

312 
	mIFLA_AF_SPEC
,

313 
	mIFLA_GROUP
,

314 
	mIFLA_NET_NS_FD
,

315 
	mIFLA_EXT_MASK
,

316 
	mIFLA_PROMISCUITY
,

317 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

318 
	mIFLA_NUM_TX_QUEUES
,

319 
	mIFLA_NUM_RX_QUEUES
,

320 
	mIFLA_CARRIER
,

321 
	mIFLA_PHYS_PORT_ID
,

322 
	mIFLA_CARRIER_CHANGES
,

323 
	mIFLA_PHYS_SWITCH_ID
,

324 
	mIFLA_LINK_NETNSID
,

325 
	mIFLA_PHYS_PORT_NAME
,

326 
	mIFLA_PROTO_DOWN
,

327 
	mIFLA_GSO_MAX_SEGS
,

328 
	mIFLA_GSO_MAX_SIZE
,

329 
	mIFLA_PAD
,

330 
	mIFLA_XDP
,

331 
	mIFLA_EVENT
,

332 
	mIFLA_NEW_NETNSID
,

333 
	mIFLA_IF_NETNSID
,

334 
	mIFLA_TARGET_NETNSID
 = 
IFLA_IF_NETNSID
,

335 
	mIFLA_CARRIER_UP_COUNT
,

336 
	mIFLA_CARRIER_DOWN_COUNT
,

337 
	mIFLA_NEW_IFINDEX
,

338 
	mIFLA_MIN_MTU
,

339 
	mIFLA_MAX_MTU
,

340 
	mIFLA_PROP_LIST
,

341 
	mIFLA_ALT_IFNAME
,

342 
	mIFLA_PERM_ADDRESS
,

343 
	mIFLA_PROTO_DOWN_REASON
,

348 
	mIFLA_PARENT_DEV_NAME
,

349 
	mIFLA_PARENT_DEV_BUS_NAME
,

351 
	m__IFLA_MAX


355 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

358 
	mIFLA_PROTO_DOWN_REASON_UNSPEC
,

359 
	mIFLA_PROTO_DOWN_REASON_MASK
,

360 
	mIFLA_PROTO_DOWN_REASON_VALUE
,

362 
	m__IFLA_PROTO_DOWN_REASON_CNT
,

363 
	mIFLA_PROTO_DOWN_REASON_MAX
 = 
__IFLA_PROTO_DOWN_REASON_CNT
 - 1

367 
	#IFLA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

368 
	#IFLA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
ifšfomsg
))

	)

371 
	mIFLA_INET_UNSPEC
,

372 
	mIFLA_INET_CONF
,

373 
	m__IFLA_INET_MAX
,

376 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

409 
	mIFLA_INET6_UNSPEC
,

410 
	mIFLA_INET6_FLAGS
,

411 
	mIFLA_INET6_CONF
,

412 
	mIFLA_INET6_STATS
,

413 
	mIFLA_INET6_MCAST
,

414 
	mIFLA_INET6_CACHEINFO
,

415 
	mIFLA_INET6_ICMP6STATS
,

416 
	mIFLA_INET6_TOKEN
,

417 
	mIFLA_INET6_ADDR_GEN_MODE
,

418 
	mIFLA_INET6_RA_MTU
,

419 
	m__IFLA_INET6_MAX


422 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

424 
	eš6_addr_g’_mode
 {

425 
	mIN6_ADDR_GEN_MODE_EUI64
,

426 
	mIN6_ADDR_GEN_MODE_NONE
,

427 
	mIN6_ADDR_GEN_MODE_STABLE_PRIVACY
,

428 
	mIN6_ADDR_GEN_MODE_RANDOM
,

434 
	mIFLA_BR_UNSPEC
,

435 
	mIFLA_BR_FORWARD_DELAY
,

436 
	mIFLA_BR_HELLO_TIME
,

437 
	mIFLA_BR_MAX_AGE
,

438 
	mIFLA_BR_AGEING_TIME
,

439 
	mIFLA_BR_STP_STATE
,

440 
	mIFLA_BR_PRIORITY
,

441 
	mIFLA_BR_VLAN_FILTERING
,

442 
	mIFLA_BR_VLAN_PROTOCOL
,

443 
	mIFLA_BR_GROUP_FWD_MASK
,

444 
	mIFLA_BR_ROOT_ID
,

445 
	mIFLA_BR_BRIDGE_ID
,

446 
	mIFLA_BR_ROOT_PORT
,

447 
	mIFLA_BR_ROOT_PATH_COST
,

448 
	mIFLA_BR_TOPOLOGY_CHANGE
,

449 
	mIFLA_BR_TOPOLOGY_CHANGE_DETECTED
,

450 
	mIFLA_BR_HELLO_TIMER
,

451 
	mIFLA_BR_TCN_TIMER
,

452 
	mIFLA_BR_TOPOLOGY_CHANGE_TIMER
,

453 
	mIFLA_BR_GC_TIMER
,

454 
	mIFLA_BR_GROUP_ADDR
,

455 
	mIFLA_BR_FDB_FLUSH
,

456 
	mIFLA_BR_MCAST_ROUTER
,

457 
	mIFLA_BR_MCAST_SNOOPING
,

458 
	mIFLA_BR_MCAST_QUERY_USE_IFADDR
,

459 
	mIFLA_BR_MCAST_QUERIER
,

460 
	mIFLA_BR_MCAST_HASH_ELASTICITY
,

461 
	mIFLA_BR_MCAST_HASH_MAX
,

462 
	mIFLA_BR_MCAST_LAST_MEMBER_CNT
,

463 
	mIFLA_BR_MCAST_STARTUP_QUERY_CNT
,

464 
	mIFLA_BR_MCAST_LAST_MEMBER_INTVL
,

465 
	mIFLA_BR_MCAST_MEMBERSHIP_INTVL
,

466 
	mIFLA_BR_MCAST_QUERIER_INTVL
,

467 
	mIFLA_BR_MCAST_QUERY_INTVL
,

468 
	mIFLA_BR_MCAST_QUERY_RESPONSE_INTVL
,

469 
	mIFLA_BR_MCAST_STARTUP_QUERY_INTVL
,

470 
	mIFLA_BR_NF_CALL_IPTABLES
,

471 
	mIFLA_BR_NF_CALL_IP6TABLES
,

472 
	mIFLA_BR_NF_CALL_ARPTABLES
,

473 
	mIFLA_BR_VLAN_DEFAULT_PVID
,

474 
	mIFLA_BR_PAD
,

475 
	mIFLA_BR_VLAN_STATS_ENABLED
,

476 
	mIFLA_BR_MCAST_STATS_ENABLED
,

477 
	mIFLA_BR_MCAST_IGMP_VERSION
,

478 
	mIFLA_BR_MCAST_MLD_VERSION
,

479 
	mIFLA_BR_VLAN_STATS_PER_PORT
,

480 
	mIFLA_BR_MULTI_BOOLOPT
,

481 
	mIFLA_BR_MCAST_QUERIER_STATE
,

482 
	m__IFLA_BR_MAX
,

485 
	#IFLA_BR_MAX
 (
__IFLA_BR_MAX
 - 1)

	)

487 
	siæa_bridge_id
 {

488 
__u8
 
	m´io
[2];

489 
__u8
 
	maddr
[6];

493 
	mBRIDGE_MODE_UNSPEC
,

494 
	mBRIDGE_MODE_HAIRPIN
,

498 
	mIFLA_BRPORT_UNSPEC
,

499 
	mIFLA_BRPORT_STATE
,

500 
	mIFLA_BRPORT_PRIORITY
,

501 
	mIFLA_BRPORT_COST
,

502 
	mIFLA_BRPORT_MODE
,

503 
	mIFLA_BRPORT_GUARD
,

504 
	mIFLA_BRPORT_PROTECT
,

505 
	mIFLA_BRPORT_FAST_LEAVE
,

506 
	mIFLA_BRPORT_LEARNING
,

507 
	mIFLA_BRPORT_UNICAST_FLOOD
,

508 
	mIFLA_BRPORT_PROXYARP
,

509 
	mIFLA_BRPORT_LEARNING_SYNC
,

510 
	mIFLA_BRPORT_PROXYARP_WIFI
,

511 
	mIFLA_BRPORT_ROOT_ID
,

512 
	mIFLA_BRPORT_BRIDGE_ID
,

513 
	mIFLA_BRPORT_DESIGNATED_PORT
,

514 
	mIFLA_BRPORT_DESIGNATED_COST
,

515 
	mIFLA_BRPORT_ID
,

516 
	mIFLA_BRPORT_NO
,

517 
	mIFLA_BRPORT_TOPOLOGY_CHANGE_ACK
,

518 
	mIFLA_BRPORT_CONFIG_PENDING
,

519 
	mIFLA_BRPORT_MESSAGE_AGE_TIMER
,

520 
	mIFLA_BRPORT_FORWARD_DELAY_TIMER
,

521 
	mIFLA_BRPORT_HOLD_TIMER
,

522 
	mIFLA_BRPORT_FLUSH
,

523 
	mIFLA_BRPORT_MULTICAST_ROUTER
,

524 
	mIFLA_BRPORT_PAD
,

525 
	mIFLA_BRPORT_MCAST_FLOOD
,

526 
	mIFLA_BRPORT_MCAST_TO_UCAST
,

527 
	mIFLA_BRPORT_VLAN_TUNNEL
,

528 
	mIFLA_BRPORT_BCAST_FLOOD
,

529 
	mIFLA_BRPORT_GROUP_FWD_MASK
,

530 
	mIFLA_BRPORT_NEIGH_SUPPRESS
,

531 
	mIFLA_BRPORT_ISOLATED
,

532 
	mIFLA_BRPORT_BACKUP_PORT
,

533 
	mIFLA_BRPORT_MRP_RING_OPEN
,

534 
	mIFLA_BRPORT_MRP_IN_OPEN
,

535 
	mIFLA_BRPORT_MCAST_EHT_HOSTS_LIMIT
,

536 
	mIFLA_BRPORT_MCAST_EHT_HOSTS_CNT
,

537 
	m__IFLA_BRPORT_MAX


539 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

541 
	siæa_ÿchešfo
 {

542 
__u32
 
	mmax_»asm_Ën
;

543 
__u32
 
	mt¡amp
;

544 
__u32
 
	m»achabË_time
;

545 
__u32
 
	m»Œªs_time
;

549 
	mIFLA_INFO_UNSPEC
,

550 
	mIFLA_INFO_KIND
,

551 
	mIFLA_INFO_DATA
,

552 
	mIFLA_INFO_XSTATS
,

553 
	mIFLA_INFO_SLAVE_KIND
,

554 
	mIFLA_INFO_SLAVE_DATA
,

555 
	m__IFLA_INFO_MAX
,

558 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

563 
	mIFLA_VLAN_UNSPEC
,

564 
	mIFLA_VLAN_ID
,

565 
	mIFLA_VLAN_FLAGS
,

566 
	mIFLA_VLAN_EGRESS_QOS
,

567 
	mIFLA_VLAN_INGRESS_QOS
,

568 
	mIFLA_VLAN_PROTOCOL
,

569 
	m__IFLA_VLAN_MAX
,

572 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

574 
	siæa_vÏn_æags
 {

575 
__u32
 
	mæags
;

576 
__u32
 
	mmask
;

580 
	mIFLA_VLAN_QOS_UNSPEC
,

581 
	mIFLA_VLAN_QOS_MAPPING
,

582 
	m__IFLA_VLAN_QOS_MAX


585 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

587 
	siæa_vÏn_qos_m­pšg
 {

588 
__u32
 
	mäom
;

589 
__u32
 
	mto
;

594 
	mIFLA_MACVLAN_UNSPEC
,

595 
	mIFLA_MACVLAN_MODE
,

596 
	mIFLA_MACVLAN_FLAGS
,

597 
	mIFLA_MACVLAN_MACADDR_MODE
,

598 
	mIFLA_MACVLAN_MACADDR
,

599 
	mIFLA_MACVLAN_MACADDR_DATA
,

600 
	mIFLA_MACVLAN_MACADDR_COUNT
,

601 
	mIFLA_MACVLAN_BC_QUEUE_LEN
,

602 
	mIFLA_MACVLAN_BC_QUEUE_LEN_USED
,

603 
	m__IFLA_MACVLAN_MAX
,

606 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

608 
	emacvÏn_mode
 {

609 
	mMACVLAN_MODE_PRIVATE
 = 1,

610 
	mMACVLAN_MODE_VEPA
 = 2,

611 
	mMACVLAN_MODE_BRIDGE
 = 4,

612 
	mMACVLAN_MODE_PASSTHRU
 = 8,

613 
	mMACVLAN_MODE_SOURCE
 = 16,

616 
	emacvÏn_maÿddr_mode
 {

617 
	mMACVLAN_MACADDR_ADD
,

618 
	mMACVLAN_MACADDR_DEL
,

619 
	mMACVLAN_MACADDR_FLUSH
,

620 
	mMACVLAN_MACADDR_SET
,

623 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

624 
	#MACVLAN_FLAG_NODST
 2

	)

628 
	mIFLA_VRF_UNSPEC
,

629 
	mIFLA_VRF_TABLE
,

630 
	m__IFLA_VRF_MAX


633 
	#IFLA_VRF_MAX
 (
__IFLA_VRF_MAX
 - 1)

	)

636 
	mIFLA_VRF_PORT_UNSPEC
,

637 
	mIFLA_VRF_PORT_TABLE
,

638 
	m__IFLA_VRF_PORT_MAX


641 
	#IFLA_VRF_PORT_MAX
 (
__IFLA_VRF_PORT_MAX
 - 1)

	)

645 
	mIFLA_MACSEC_UNSPEC
,

646 
	mIFLA_MACSEC_SCI
,

647 
	mIFLA_MACSEC_PORT
,

648 
	mIFLA_MACSEC_ICV_LEN
,

649 
	mIFLA_MACSEC_CIPHER_SUITE
,

650 
	mIFLA_MACSEC_WINDOW
,

651 
	mIFLA_MACSEC_ENCODING_SA
,

652 
	mIFLA_MACSEC_ENCRYPT
,

653 
	mIFLA_MACSEC_PROTECT
,

654 
	mIFLA_MACSEC_INC_SCI
,

655 
	mIFLA_MACSEC_ES
,

656 
	mIFLA_MACSEC_SCB
,

657 
	mIFLA_MACSEC_REPLAY_PROTECT
,

658 
	mIFLA_MACSEC_VALIDATION
,

659 
	mIFLA_MACSEC_PAD
,

660 
	mIFLA_MACSEC_OFFLOAD
,

661 
	m__IFLA_MACSEC_MAX
,

664 
	#IFLA_MACSEC_MAX
 (
__IFLA_MACSEC_MAX
 - 1)

	)

668 
	mIFLA_XFRM_UNSPEC
,

669 
	mIFLA_XFRM_LINK
,

670 
	mIFLA_XFRM_IF_ID
,

671 
	m__IFLA_XFRM_MAX


674 
	#IFLA_XFRM_MAX
 (
__IFLA_XFRM_MAX
 - 1)

	)

676 
	emac£c_v®id©iÚ_ty³
 {

677 
	mMACSEC_VALIDATE_DISABLED
 = 0,

678 
	mMACSEC_VALIDATE_CHECK
 = 1,

679 
	mMACSEC_VALIDATE_STRICT
 = 2,

680 
	m__MACSEC_VALIDATE_END
,

681 
	mMACSEC_VALIDATE_MAX
 = 
__MACSEC_VALIDATE_END
 - 1,

684 
	emac£c_ofæßd
 {

685 
	mMACSEC_OFFLOAD_OFF
 = 0,

686 
	mMACSEC_OFFLOAD_PHY
 = 1,

687 
	mMACSEC_OFFLOAD_MAC
 = 2,

688 
	m__MACSEC_OFFLOAD_END
,

689 
	mMACSEC_OFFLOAD_MAX
 = 
__MACSEC_OFFLOAD_END
 - 1,

694 
	mIFLA_IPVLAN_UNSPEC
,

695 
	mIFLA_IPVLAN_MODE
,

696 
	mIFLA_IPVLAN_FLAGS
,

697 
	m__IFLA_IPVLAN_MAX


700 
	#IFLA_IPVLAN_MAX
 (
__IFLA_IPVLAN_MAX
 - 1)

	)

702 
	evÏn_mode
 {

703 
	mIPVLAN_MODE_L2
 = 0,

704 
	mIPVLAN_MODE_L3
,

705 
	mIPVLAN_MODE_L3S
,

706 
	mIPVLAN_MODE_MAX


709 
	#IPVLAN_F_PRIVATE
 0x01

	)

710 
	#IPVLAN_F_VEPA
 0x02

	)

714 
	mIFLA_VXLAN_UNSPEC
,

715 
	mIFLA_VXLAN_ID
,

716 
	mIFLA_VXLAN_GROUP
,

717 
	mIFLA_VXLAN_LINK
,

718 
	mIFLA_VXLAN_LOCAL
,

719 
	mIFLA_VXLAN_TTL
,

720 
	mIFLA_VXLAN_TOS
,

721 
	mIFLA_VXLAN_LEARNING
,

722 
	mIFLA_VXLAN_AGEING
,

723 
	mIFLA_VXLAN_LIMIT
,

724 
	mIFLA_VXLAN_PORT_RANGE
,

725 
	mIFLA_VXLAN_PROXY
,

726 
	mIFLA_VXLAN_RSC
,

727 
	mIFLA_VXLAN_L2MISS
,

728 
	mIFLA_VXLAN_L3MISS
,

729 
	mIFLA_VXLAN_PORT
,

730 
	mIFLA_VXLAN_GROUP6
,

731 
	mIFLA_VXLAN_LOCAL6
,

732 
	mIFLA_VXLAN_UDP_CSUM
,

733 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_TX
,

734 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_RX
,

735 
	mIFLA_VXLAN_REMCSUM_TX
,

736 
	mIFLA_VXLAN_REMCSUM_RX
,

737 
	mIFLA_VXLAN_GBP
,

738 
	mIFLA_VXLAN_REMCSUM_NOPARTIAL
,

739 
	mIFLA_VXLAN_COLLECT_METADATA
,

740 
	mIFLA_VXLAN_LABEL
,

741 
	mIFLA_VXLAN_GPE
,

742 
	mIFLA_VXLAN_TTL_INHERIT
,

743 
	mIFLA_VXLAN_DF
,

744 
	mIFLA_VXLAN_FAN_MAP
 = 33,

745 
	m__IFLA_VXLAN_MAX


747 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

749 
	siæa_vxÏn_pÜt_¿nge
 {

750 
__be16
 
	mlow
;

751 
__be16
 
	mhigh
;

754 
	eiæa_vxÏn_df
 {

755 
	mVXLAN_DF_UNSET
 = 0,

756 
	mVXLAN_DF_SET
,

757 
	mVXLAN_DF_INHERIT
,

758 
	m__VXLAN_DF_END
,

759 
	mVXLAN_DF_MAX
 = 
__VXLAN_DF_END
 - 1,

764 
	mIFLA_GENEVE_UNSPEC
,

765 
	mIFLA_GENEVE_ID
,

766 
	mIFLA_GENEVE_REMOTE
,

767 
	mIFLA_GENEVE_TTL
,

768 
	mIFLA_GENEVE_TOS
,

769 
	mIFLA_GENEVE_PORT
,

770 
	mIFLA_GENEVE_COLLECT_METADATA
,

771 
	mIFLA_GENEVE_REMOTE6
,

772 
	mIFLA_GENEVE_UDP_CSUM
,

773 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_TX
,

774 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_RX
,

775 
	mIFLA_GENEVE_LABEL
,

776 
	mIFLA_GENEVE_TTL_INHERIT
,

777 
	mIFLA_GENEVE_DF
,

778 
	mIFLA_GENEVE_INNER_PROTO_INHERIT
,

779 
	m__IFLA_GENEVE_MAX


781 
	#IFLA_GENEVE_MAX
 (
__IFLA_GENEVE_MAX
 - 1)

	)

783 
	eiæa_g’eve_df
 {

784 
	mGENEVE_DF_UNSET
 = 0,

785 
	mGENEVE_DF_SET
,

786 
	mGENEVE_DF_INHERIT
,

787 
	m__GENEVE_DF_END
,

788 
	mGENEVE_DF_MAX
 = 
__GENEVE_DF_END
 - 1,

793 
	mIFLA_BAREUDP_UNSPEC
,

794 
	mIFLA_BAREUDP_PORT
,

795 
	mIFLA_BAREUDP_ETHERTYPE
,

796 
	mIFLA_BAREUDP_SRCPORT_MIN
,

797 
	mIFLA_BAREUDP_MULTIPROTO_MODE
,

798 
	m__IFLA_BAREUDP_MAX


801 
	#IFLA_BAREUDP_MAX
 (
__IFLA_BAREUDP_MAX
 - 1)

	)

805 
	mIFLA_PPP_UNSPEC
,

806 
	mIFLA_PPP_DEV_FD
,

807 
	m__IFLA_PPP_MAX


809 
	#IFLA_PPP_MAX
 (
__IFLA_PPP_MAX
 - 1)

	)

813 
	eiæa_g_rŞe
 {

814 
	mGTP_ROLE_GGSN
 = 0,

815 
	mGTP_ROLE_SGSN
,

819 
	mIFLA_GTP_UNSPEC
,

820 
	mIFLA_GTP_FD0
,

821 
	mIFLA_GTP_FD1
,

822 
	mIFLA_GTP_PDP_HASHSIZE
,

823 
	mIFLA_GTP_ROLE
,

824 
	m__IFLA_GTP_MAX
,

826 
	#IFLA_GTP_MAX
 (
__IFLA_GTP_MAX
 - 1)

	)

831 
	mIFLA_BOND_UNSPEC
,

832 
	mIFLA_BOND_MODE
,

833 
	mIFLA_BOND_ACTIVE_SLAVE
,

834 
	mIFLA_BOND_MIIMON
,

835 
	mIFLA_BOND_UPDELAY
,

836 
	mIFLA_BOND_DOWNDELAY
,

837 
	mIFLA_BOND_USE_CARRIER
,

838 
	mIFLA_BOND_ARP_INTERVAL
,

839 
	mIFLA_BOND_ARP_IP_TARGET
,

840 
	mIFLA_BOND_ARP_VALIDATE
,

841 
	mIFLA_BOND_ARP_ALL_TARGETS
,

842 
	mIFLA_BOND_PRIMARY
,

843 
	mIFLA_BOND_PRIMARY_RESELECT
,

844 
	mIFLA_BOND_FAIL_OVER_MAC
,

845 
	mIFLA_BOND_XMIT_HASH_POLICY
,

846 
	mIFLA_BOND_RESEND_IGMP
,

847 
	mIFLA_BOND_NUM_PEER_NOTIF
,

848 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

849 
	mIFLA_BOND_MIN_LINKS
,

850 
	mIFLA_BOND_LP_INTERVAL
,

851 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

852 
	mIFLA_BOND_AD_LACP_RATE
,

853 
	mIFLA_BOND_AD_SELECT
,

854 
	mIFLA_BOND_AD_INFO
,

855 
	mIFLA_BOND_AD_ACTOR_SYS_PRIO
,

856 
	mIFLA_BOND_AD_USER_PORT_KEY
,

857 
	mIFLA_BOND_AD_ACTOR_SYSTEM
,

858 
	mIFLA_BOND_TLB_DYNAMIC_LB
,

859 
	mIFLA_BOND_PEER_NOTIF_DELAY
,

860 
	mIFLA_BOND_AD_LACP_ACTIVE
,

861 
	mIFLA_BOND_MISSED_MAX
,

862 
	m__IFLA_BOND_MAX
,

865 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

868 
	mIFLA_BOND_AD_INFO_UNSPEC
,

869 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

870 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

871 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

872 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

873 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

874 
	m__IFLA_BOND_AD_INFO_MAX
,

877 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

880 
	mIFLA_BOND_SLAVE_UNSPEC
,

881 
	mIFLA_BOND_SLAVE_STATE
,

882 
	mIFLA_BOND_SLAVE_MII_STATUS
,

883 
	mIFLA_BOND_SLAVE_LINK_FAILURE_COUNT
,

884 
	mIFLA_BOND_SLAVE_PERM_HWADDR
,

885 
	mIFLA_BOND_SLAVE_QUEUE_ID
,

886 
	mIFLA_BOND_SLAVE_AD_AGGREGATOR_ID
,

887 
	mIFLA_BOND_SLAVE_AD_ACTOR_OPER_PORT_STATE
,

888 
	mIFLA_BOND_SLAVE_AD_PARTNER_OPER_PORT_STATE
,

889 
	m__IFLA_BOND_SLAVE_MAX
,

892 
	#IFLA_BOND_SLAVE_MAX
 (
__IFLA_BOND_SLAVE_MAX
 - 1)

	)

897 
	mIFLA_VF_INFO_UNSPEC
,

898 
	mIFLA_VF_INFO
,

899 
	m__IFLA_VF_INFO_MAX
,

902 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

905 
	mIFLA_VF_UNSPEC
,

906 
	mIFLA_VF_MAC
,

907 
	mIFLA_VF_VLAN
,

908 
	mIFLA_VF_TX_RATE
,

909 
	mIFLA_VF_SPOOFCHK
,

910 
	mIFLA_VF_LINK_STATE
,

911 
	mIFLA_VF_RATE
,

912 
	mIFLA_VF_RSS_QUERY_EN
,

915 
	mIFLA_VF_STATS
,

916 
	mIFLA_VF_TRUST
,

917 
	mIFLA_VF_IB_NODE_GUID
,

918 
	mIFLA_VF_IB_PORT_GUID
,

919 
	mIFLA_VF_VLAN_LIST
,

920 
	mIFLA_VF_BROADCAST
,

921 
	m__IFLA_VF_MAX
,

924 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

926 
	siæa_vf_mac
 {

927 
__u32
 
	mvf
;

928 
__u8
 
	mmac
[32];

931 
	siæa_vf_brßdÿ¡
 {

932 
__u8
 
	mbrßdÿ¡
[32];

935 
	siæa_vf_vÏn
 {

936 
__u32
 
	mvf
;

937 
__u32
 
	mvÏn
;

938 
__u32
 
	mqos
;

942 
	mIFLA_VF_VLAN_INFO_UNSPEC
,

943 
	mIFLA_VF_VLAN_INFO
,

944 
	m__IFLA_VF_VLAN_INFO_MAX
,

947 
	#IFLA_VF_VLAN_INFO_MAX
 (
__IFLA_VF_VLAN_INFO_MAX
 - 1)

	)

948 
	#MAX_VLAN_LIST_LEN
 1

	)

950 
	siæa_vf_vÏn_šfo
 {

951 
__u32
 
	mvf
;

952 
__u32
 
	mvÏn
;

953 
__u32
 
	mqos
;

954 
__be16
 
	mvÏn_´Ùo
;

957 
	siæa_vf_tx_¿‹
 {

958 
__u32
 
	mvf
;

959 
__u32
 
	m¿‹
;

962 
	siæa_vf_¿‹
 {

963 
__u32
 
	mvf
;

964 
__u32
 
	mmš_tx_¿‹
;

965 
__u32
 
	mmax_tx_¿‹
;

968 
	siæa_vf_¥oofchk
 {

969 
__u32
 
	mvf
;

970 
__u32
 
	m£‰šg
;

973 
	siæa_vf_guid
 {

974 
__u32
 
	mvf
;

975 
__u64
 
	mguid
;

979 
	mIFLA_VF_LINK_STATE_AUTO
,

980 
	mIFLA_VF_LINK_STATE_ENABLE
,

981 
	mIFLA_VF_LINK_STATE_DISABLE
,

982 
	m__IFLA_VF_LINK_STATE_MAX
,

985 
	siæa_vf_lšk_¡©e
 {

986 
__u32
 
	mvf
;

987 
__u32
 
	mlšk_¡©e
;

990 
	siæa_vf_rss_qu”y_’
 {

991 
__u32
 
	mvf
;

992 
__u32
 
	m£‰šg
;

996 
	mIFLA_VF_STATS_RX_PACKETS
,

997 
	mIFLA_VF_STATS_TX_PACKETS
,

998 
	mIFLA_VF_STATS_RX_BYTES
,

999 
	mIFLA_VF_STATS_TX_BYTES
,

1000 
	mIFLA_VF_STATS_BROADCAST
,

1001 
	mIFLA_VF_STATS_MULTICAST
,

1002 
	mIFLA_VF_STATS_PAD
,

1003 
	mIFLA_VF_STATS_RX_DROPPED
,

1004 
	mIFLA_VF_STATS_TX_DROPPED
,

1005 
	m__IFLA_VF_STATS_MAX
,

1008 
	#IFLA_VF_STATS_MAX
 (
__IFLA_VF_STATS_MAX
 - 1)

	)

1010 
	siæa_vf_Œu¡
 {

1011 
__u32
 
	mvf
;

1012 
__u32
 
	m£‰šg
;

1031 
	mIFLA_VF_PORT_UNSPEC
,

1032 
	mIFLA_VF_PORT
,

1033 
	m__IFLA_VF_PORT_MAX
,

1036 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

1039 
	mIFLA_PORT_UNSPEC
,

1040 
	mIFLA_PORT_VF
,

1041 
	mIFLA_PORT_PROFILE
,

1042 
	mIFLA_PORT_VSI_TYPE
,

1043 
	mIFLA_PORT_INSTANCE_UUID
,

1044 
	mIFLA_PORT_HOST_UUID
,

1045 
	mIFLA_PORT_REQUEST
,

1046 
	mIFLA_PORT_RESPONSE
,

1047 
	m__IFLA_PORT_MAX
,

1050 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

1052 
	#PORT_PROFILE_MAX
 40

	)

1053 
	#PORT_UUID_MAX
 16

	)

1054 
	#PORT_SELF_VF
 -1

	)

1057 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

1058 
	mPORT_REQUEST_PREASSOCIATE_RR
,

1059 
	mPORT_REQUEST_ASSOCIATE
,

1060 
	mPORT_REQUEST_DISASSOCIATE
,

1064 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

1065 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

1066 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

1067 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

1068 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

1069 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

1070 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

1072 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

1073 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

1074 
	mPORT_PROFILE_RESPONSE_INVALID
,

1075 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

1076 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

1077 
	mPORT_PROFILE_RESPONSE_ERROR
,

1080 
	siæa_pÜt_vsi
 {

1081 
__u8
 
	mvsi_mgr_id
;

1082 
__u8
 
	mvsi_ty³_id
[3];

1083 
__u8
 
	mvsi_ty³_v”siÚ
;

1084 
__u8
 
	m·d
[3];

1091 
	mIFLA_IPOIB_UNSPEC
,

1092 
	mIFLA_IPOIB_PKEY
,

1093 
	mIFLA_IPOIB_MODE
,

1094 
	mIFLA_IPOIB_UMCAST
,

1095 
	m__IFLA_IPOIB_MAX


1099 
	mIPOIB_MODE_DATAGRAM
 = 0,

1100 
	mIPOIB_MODE_CONNECTED
 = 1,

1103 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

1110 
	mHSR_PROTOCOL_HSR
,

1111 
	mHSR_PROTOCOL_PRP
,

1112 
	mHSR_PROTOCOL_MAX
,

1116 
	mIFLA_HSR_UNSPEC
,

1117 
	mIFLA_HSR_SLAVE1
,

1118 
	mIFLA_HSR_SLAVE2
,

1119 
	mIFLA_HSR_MULTICAST_SPEC
,

1120 
	mIFLA_HSR_SUPERVISION_ADDR
,

1121 
	mIFLA_HSR_SEQ_NR
,

1122 
	mIFLA_HSR_VERSION
,

1123 
	mIFLA_HSR_PROTOCOL
,

1126 
	m__IFLA_HSR_MAX
,

1129 
	#IFLA_HSR_MAX
 (
__IFLA_HSR_MAX
 - 1)

	)

1133 
	sif_¡©s_msg
 {

1134 
__u8
 
	mçmy
;

1135 
__u8
 
	m·d1
;

1136 
__u16
 
	m·d2
;

1137 
__u32
 
	mifšdex
;

1138 
__u32
 
	mf‹r_mask
;

1145 
	mIFLA_STATS_UNSPEC
,

1146 
	mIFLA_STATS_LINK_64
,

1147 
	mIFLA_STATS_LINK_XSTATS
,

1148 
	mIFLA_STATS_LINK_XSTATS_SLAVE
,

1149 
	mIFLA_STATS_LINK_OFFLOAD_XSTATS
,

1150 
	mIFLA_STATS_AF_SPEC
,

1151 
	m__IFLA_STATS_MAX
,

1154 
	#IFLA_STATS_MAX
 (
__IFLA_STATS_MAX
 - 1)

	)

1156 
	#IFLA_STATS_FILTER_BIT
(
ATTR
è(1 << (ATTR - 1))

	)

1164 
	mLINK_XSTATS_TYPE_UNSPEC
,

1165 
	mLINK_XSTATS_TYPE_BRIDGE
,

1166 
	mLINK_XSTATS_TYPE_BOND
,

1167 
	m__LINK_XSTATS_TYPE_MAX


1169 
	#LINK_XSTATS_TYPE_MAX
 (
__LINK_XSTATS_TYPE_MAX
 - 1)

	)

1173 
	mIFLA_OFFLOAD_XSTATS_UNSPEC
,

1174 
	mIFLA_OFFLOAD_XSTATS_CPU_HIT
,

1175 
	m__IFLA_OFFLOAD_XSTATS_MAX


1177 
	#IFLA_OFFLOAD_XSTATS_MAX
 (
__IFLA_OFFLOAD_XSTATS_MAX
 - 1)

	)

1181 
	#XDP_FLAGS_UPDATE_IF_NOEXIST
 (1U << 0)

	)

1182 
	#XDP_FLAGS_SKB_MODE
 (1U << 1)

	)

1183 
	#XDP_FLAGS_DRV_MODE
 (1U << 2)

	)

1184 
	#XDP_FLAGS_HW_MODE
 (1U << 3)

	)

1185 
	#XDP_FLAGS_REPLACE
 (1U << 4)

	)

1186 
	#XDP_FLAGS_MODES
 (
XDP_FLAGS_SKB_MODE
 | \

1187 
XDP_FLAGS_DRV_MODE
 | \

1188 
XDP_FLAGS_HW_MODE
)

	)

1189 
	#XDP_FLAGS_MASK
 (
XDP_FLAGS_UPDATE_IF_NOEXIST
 | \

1190 
XDP_FLAGS_MODES
 | 
XDP_FLAGS_REPLACE
)

	)

1194 
	mXDP_ATTACHED_NONE
 = 0,

1195 
	mXDP_ATTACHED_DRV
,

1196 
	mXDP_ATTACHED_SKB
,

1197 
	mXDP_ATTACHED_HW
,

1198 
	mXDP_ATTACHED_MULTI
,

1202 
	mIFLA_XDP_UNSPEC
,

1203 
	mIFLA_XDP_FD
,

1204 
	mIFLA_XDP_ATTACHED
,

1205 
	mIFLA_XDP_FLAGS
,

1206 
	mIFLA_XDP_PROG_ID
,

1207 
	mIFLA_XDP_DRV_PROG_ID
,

1208 
	mIFLA_XDP_SKB_PROG_ID
,

1209 
	mIFLA_XDP_HW_PROG_ID
,

1210 
	mIFLA_XDP_EXPECTED_FD
,

1211 
	m__IFLA_XDP_MAX
,

1214 
	#IFLA_XDP_MAX
 (
__IFLA_XDP_MAX
 - 1)

	)

1217 
	mIFLA_EVENT_NONE
,

1218 
	mIFLA_EVENT_REBOOT
,

1219 
	mIFLA_EVENT_FEATURES
,

1220 
	mIFLA_EVENT_BONDING_FAILOVER
,

1221 
	mIFLA_EVENT_NOTIFY_PEERS
,

1222 
	mIFLA_EVENT_IGMP_RESEND
,

1223 
	mIFLA_EVENT_BONDING_OPTIONS
,

1229 
	mIFLA_TUN_UNSPEC
,

1230 
	mIFLA_TUN_OWNER
,

1231 
	mIFLA_TUN_GROUP
,

1232 
	mIFLA_TUN_TYPE
,

1233 
	mIFLA_TUN_PI
,

1234 
	mIFLA_TUN_VNET_HDR
,

1235 
	mIFLA_TUN_PERSIST
,

1236 
	mIFLA_TUN_MULTI_QUEUE
,

1237 
	mIFLA_TUN_NUM_QUEUES
,

1238 
	mIFLA_TUN_NUM_DISABLED_QUEUES
,

1239 
	m__IFLA_TUN_MAX
,

1242 
	#IFLA_TUN_MAX
 (
__IFLA_TUN_MAX
 - 1)

	)

1246 
	#RMNET_FLAGS_INGRESS_DEAGGREGATION
 (1U << 0)

	)

1247 
	#RMNET_FLAGS_INGRESS_MAP_COMMANDS
 (1U << 1)

	)

1248 
	#RMNET_FLAGS_INGRESS_MAP_CKSUMV4
 (1U << 2)

	)

1249 
	#RMNET_FLAGS_EGRESS_MAP_CKSUMV4
 (1U << 3)

	)

1250 
	#RMNET_FLAGS_INGRESS_MAP_CKSUMV5
 (1U << 4)

	)

1251 
	#RMNET_FLAGS_EGRESS_MAP_CKSUMV5
 (1U << 5)

	)

1254 
	mIFLA_RMNET_UNSPEC
,

1255 
	mIFLA_RMNET_MUX_ID
,

1256 
	mIFLA_RMNET_FLAGS
,

1257 
	m__IFLA_RMNET_MAX
,

1260 
	#IFLA_RMNET_MAX
 (
__IFLA_RMNET_MAX
 - 1)

	)

1262 
	siæa_rmÃt_æags
 {

1263 
__u32
 
	mæags
;

1264 
__u32
 
	mmask
;

1270 
	mIFLA_MCTP_UNSPEC
,

1271 
	mIFLA_MCTP_NET
,

1272 
	m__IFLA_MCTP_MAX
,

1275 
	#IFLA_MCTP_MAX
 (
__IFLA_MCTP_MAX
 - 1)

	)

	@/usr/include/linux/if_packet.h

2 #iâdeà
__LINUX_IF_PACKET_H


3 
	#__LINUX_IF_PACKET_H


	)

5 
	~<asm/by‹Üd”.h
>

6 
	~<lšux/ty³s.h
>

8 
	ssockaddr_pkt
 {

9 
	m¥kt_çmy
;

10 
	m¥kt_deviû
[14];

11 
__be16
 
	m¥kt_´ÙocŞ
;

14 
	ssockaddr_Î
 {

15 
	m¦l_çmy
;

16 
__be16
 
	m¦l_´ÙocŞ
;

17 
	m¦l_ifšdex
;

18 
	m¦l_h©y³
;

19 
	m¦l_pk‰y³
;

20 
	m¦l_h®’
;

21 
	m¦l_addr
[8];

26 
	#PACKET_HOST
 0

	)

27 
	#PACKET_BROADCAST
 1

	)

28 
	#PACKET_MULTICAST
 2

	)

29 
	#PACKET_OTHERHOST
 3

	)

30 
	#PACKET_OUTGOING
 4

	)

31 
	#PACKET_LOOPBACK
 5

	)

32 
	#PACKET_USER
 6

	)

33 
	#PACKET_KERNEL
 7

	)

35 
	#PACKET_FASTROUTE
 6

	)

39 
	#PACKET_ADD_MEMBERSHIP
 1

	)

40 
	#PACKET_DROP_MEMBERSHIP
 2

	)

41 
	#PACKET_RECV_OUTPUT
 3

	)

43 
	#PACKET_RX_RING
 5

	)

44 
	#PACKET_STATISTICS
 6

	)

45 
	#PACKET_COPY_THRESH
 7

	)

46 
	#PACKET_AUXDATA
 8

	)

47 
	#PACKET_ORIGDEV
 9

	)

48 
	#PACKET_VERSION
 10

	)

49 
	#PACKET_HDRLEN
 11

	)

50 
	#PACKET_RESERVE
 12

	)

51 
	#PACKET_TX_RING
 13

	)

52 
	#PACKET_LOSS
 14

	)

53 
	#PACKET_VNET_HDR
 15

	)

54 
	#PACKET_TX_TIMESTAMP
 16

	)

55 
	#PACKET_TIMESTAMP
 17

	)

56 
	#PACKET_FANOUT
 18

	)

57 
	#PACKET_TX_HAS_OFF
 19

	)

58 
	#PACKET_QDISC_BYPASS
 20

	)

59 
	#PACKET_ROLLOVER_STATS
 21

	)

60 
	#PACKET_FANOUT_DATA
 22

	)

61 
	#PACKET_IGNORE_OUTGOING
 23

	)

63 
	#PACKET_FANOUT_HASH
 0

	)

64 
	#PACKET_FANOUT_LB
 1

	)

65 
	#PACKET_FANOUT_CPU
 2

	)

66 
	#PACKET_FANOUT_ROLLOVER
 3

	)

67 
	#PACKET_FANOUT_RND
 4

	)

68 
	#PACKET_FANOUT_QM
 5

	)

69 
	#PACKET_FANOUT_CBPF
 6

	)

70 
	#PACKET_FANOUT_EBPF
 7

	)

71 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

72 
	#PACKET_FANOUT_FLAG_UNIQUEID
 0x2000

	)

73 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

75 
	sack‘_¡©s
 {

76 
	m_·ck‘s
;

77 
	m_drİs
;

80 
	sack‘_¡©s_v3
 {

81 
	m_·ck‘s
;

82 
	m_drİs
;

83 
	m_ä“ze_q_út
;

86 
	sack‘_rŞlov”_¡©s
 {

87 
__®igÃd_u64
 
	m_®l
;

88 
__®igÃd_u64
 
	m_huge
;

89 
__®igÃd_u64
 
	m_çed
;

92 
	uack‘_¡©s_u
 {

93 
ack‘_¡©s
 
	m¡©s1
;

94 
ack‘_¡©s_v3
 
	m¡©s3
;

97 
	sack‘_auxd©a
 {

98 
__u32
 
	m_¡©us
;

99 
__u32
 
	m_Ën
;

100 
__u32
 
	m_¢­Ën
;

101 
__u16
 
	m_mac
;

102 
__u16
 
	m_Ãt
;

103 
__u16
 
	m_vÏn_tci
;

104 
__u16
 
	m_vÏn_id
;

108 
	#TP_STATUS_KERNEL
 0

	)

109 
	#TP_STATUS_USER
 (1 << 0)

	)

110 
	#TP_STATUS_COPY
 (1 << 1)

	)

111 
	#TP_STATUS_LOSING
 (1 << 2)

	)

112 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

113 
	#TP_STATUS_VLAN_VALID
 (1 << 4è

	)

114 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

115 
	#TP_STATUS_VLAN_TPID_VALID
 (1 << 6è

	)

116 
	#TP_STATUS_CSUM_VALID
 (1 << 7)

	)

119 
	#TP_STATUS_AVAILABLE
 0

	)

120 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

121 
	#TP_STATUS_SENDING
 (1 << 1)

	)

122 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

125 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

126 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30è

	)

127 
	#TP_STATUS_TS_RAW_HARDWARE
 (1U << 31)

	)

130 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

132 
	sack‘_hdr
 {

133 
	m_¡©us
;

134 
	m_Ën
;

135 
	m_¢­Ën
;

136 
	m_mac
;

137 
	m_Ãt
;

138 
	m_£c
;

139 
	m_u£c
;

142 
	#TPACKET_ALIGNMENT
 16

	)

143 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

144 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

146 
	sack‘2_hdr
 {

147 
__u32
 
	m_¡©us
;

148 
__u32
 
	m_Ën
;

149 
__u32
 
	m_¢­Ën
;

150 
__u16
 
	m_mac
;

151 
__u16
 
	m_Ãt
;

152 
__u32
 
	m_£c
;

153 
__u32
 
	m_n£c
;

154 
__u16
 
	m_vÏn_tci
;

155 
__u16
 
	m_vÏn_id
;

156 
__u8
 
	m_·ddšg
[4];

159 
	sack‘_hdr_v¬ŸÁ1
 {

160 
__u32
 
	m_rxhash
;

161 
__u32
 
	m_vÏn_tci
;

162 
__u16
 
	m_vÏn_id
;

163 
__u16
 
	m_·ddšg
;

166 
	sack‘3_hdr
 {

167 
__u32
 
	m_Ãxt_off£t
;

168 
__u32
 
	m_£c
;

169 
__u32
 
	m_n£c
;

170 
__u32
 
	m_¢­Ën
;

171 
__u32
 
	m_Ën
;

172 
__u32
 
	m_¡©us
;

173 
__u16
 
	m_mac
;

174 
__u16
 
	m_Ãt
;

177 
ack‘_hdr_v¬ŸÁ1
 
	mhv1
;

179 
__u8
 
	m_·ddšg
[8];

182 
	sack‘_bd_ts
 {

183 
	mts_£c
;

185 
	mts_u£c
;

186 
	mts_n£c
;

190 
	sack‘_hdr_v1
 {

191 
__u32
 
	mblock_¡©us
;

192 
__u32
 
	mnum_pkts
;

193 
__u32
 
	moff£t_to_fœ¡_pkt
;

198 
__u32
 
	mblk_Ën
;

209 
__®igÃd_u64
 
	m£q_num
;

236 
ack‘_bd_ts
 
	mts_fœ¡_pkt
, 
	mts_Ï¡_pkt
;

239 
	uack‘_bd_h—d”_u
 {

240 
ack‘_hdr_v1
 
	mbh1
;

243 
	sack‘_block_desc
 {

244 
__u32
 
	mv”siÚ
;

245 
__u32
 
	moff£t_to_´iv
;

246 
ack‘_bd_h—d”_u
 
	mhdr
;

249 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

250 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘3_hdr
)è+ (
sockaddr_Î
))

	)

252 
	eack‘_v”siÚs
 {

253 
	mTPACKET_V1
,

254 
	mTPACKET_V2
,

255 
	mTPACKET_V3


271 
	sack‘_»q
 {

272 
	m_block_size
;

273 
	m_block_Ä
;

274 
	m_äame_size
;

275 
	m_äame_Ä
;

278 
	sack‘_»q3
 {

279 
	m_block_size
;

280 
	m_block_Ä
;

281 
	m_äame_size
;

282 
	m_äame_Ä
;

283 
	m_»tœe_blk_tov
;

284 
	m_sizeof_´iv
;

285 
	m_ã©u»_»q_wÜd
;

288 
	uack‘_»q_u
 {

289 
ack‘_»q
 
	m»q
;

290 
ack‘_»q3
 
	m»q3
;

293 
	s·ck‘_m»q
 {

294 
	mmr_ifšdex
;

295 
	mmr_ty³
;

296 
	mmr_®’
;

297 
	mmr_add»ss
[8];

300 
	sçnout_¬gs
 {

301 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

302 
__u16
 
	mid
;

303 
__u16
 
	mty³_æags
;

305 
__u16
 
	mty³_æags
;

306 
__u16
 
	mid
;

308 
__u32
 
	mmax_num_memb”s
;

311 
	#PACKET_MR_MULTICAST
 0

	)

312 
	#PACKET_MR_PROMISC
 1

	)

313 
	#PACKET_MR_ALLMULTI
 2

	)

314 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/ioctl.h

2 #iâdeà
_LINUX_IOCTL_H


3 
	#_LINUX_IOCTL_H


	)

5 
	~<asm/ioùl.h
>

	@/usr/include/linux/libc-compat.h

49 #iâdeà
_LIBC_COMPAT_H


50 
	#_LIBC_COMPAT_H


	)

53 #ià
defšed
(
__GLIBC__
)

56 #ià
defšed
(
_NET_IF_H
è&& defšed(
__USE_MISC
)

61 
	#__UAPI_DEF_IF_IFCONF
 0

	)

62 
	#__UAPI_DEF_IF_IFMAP
 0

	)

63 
	#__UAPI_DEF_IF_IFNAMSIZ
 0

	)

64 
	#__UAPI_DEF_IF_IFREQ
 0

	)

66 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 0

	)

68 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


69 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

78 
	#__UAPI_DEF_IF_IFCONF
 1

	)

79 
	#__UAPI_DEF_IF_IFMAP
 1

	)

80 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

81 
	#__UAPI_DEF_IF_IFREQ
 1

	)

83 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

85 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

90 #ià
defšed
(
_NETINET_IN_H
)

94 
	#__UAPI_DEF_IN_ADDR
 0

	)

95 
	#__UAPI_DEF_IN_IPPROTO
 0

	)

96 
	#__UAPI_DEF_IN_PKTINFO
 0

	)

97 
	#__UAPI_DEF_IP_MREQ
 0

	)

98 
	#__UAPI_DEF_SOCKADDR_IN
 0

	)

99 
	#__UAPI_DEF_IN_CLASS
 0

	)

101 
	#__UAPI_DEF_IN6_ADDR
 0

	)

106 #ià
defšed
(
__USE_MISC
è|| defšed (
__USE_GNU
)

107 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

109 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

111 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

112 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

113 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

114 
	#__UAPI_DEF_IPV6_OPTIONS
 0

	)

115 
	#__UAPI_DEF_IN6_PKTINFO
 0

	)

116 
	#__UAPI_DEF_IP6_MTUINFO
 0

	)

123 
	#__UAPI_DEF_IN_ADDR
 1

	)

124 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

125 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

126 
	#__UAPI_DEF_IP_MREQ
 1

	)

127 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

128 
	#__UAPI_DEF_IN_CLASS
 1

	)

130 
	#__UAPI_DEF_IN6_ADDR
 1

	)

133 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

134 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

135 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

136 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

137 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

138 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

139 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

144 #ià
defšed
(
__NETIPX_IPX_H
)

146 
	#__UAPI_DEF_SOCKADDR_IPX
 0

	)

147 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 0

	)

148 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 0

	)

149 
	#__UAPI_DEF_IPX_CONFIG_DATA
 0

	)

150 
	#__UAPI_DEF_IPX_ROUTE_DEF
 0

	)

154 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

155 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

156 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

157 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

158 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

163 #ià
defšed
(
_SYS_XATTR_H
)

164 
	#__UAPI_DEF_XATTR
 0

	)

166 
	#__UAPI_DEF_XATTR
 1

	)

176 #iâdeà
__UAPI_DEF_IF_IFCONF


177 
	#__UAPI_DEF_IF_IFCONF
 1

	)

179 #iâdeà
__UAPI_DEF_IF_IFMAP


180 
	#__UAPI_DEF_IF_IFMAP
 1

	)

182 #iâdeà
__UAPI_DEF_IF_IFNAMSIZ


183 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

185 #iâdeà
__UAPI_DEF_IF_IFREQ


186 
	#__UAPI_DEF_IF_IFREQ
 1

	)

189 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS


190 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

193 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


194 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

198 #iâdeà
__UAPI_DEF_IN_ADDR


199 
	#__UAPI_DEF_IN_ADDR
 1

	)

201 #iâdeà
__UAPI_DEF_IN_IPPROTO


202 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

204 #iâdeà
__UAPI_DEF_IN_PKTINFO


205 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

207 #iâdeà
__UAPI_DEF_IP_MREQ


208 
	#__UAPI_DEF_IP_MREQ
 1

	)

210 #iâdeà
__UAPI_DEF_SOCKADDR_IN


211 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

213 #iâdeà
__UAPI_DEF_IN_CLASS


214 
	#__UAPI_DEF_IN_CLASS
 1

	)

218 #iâdeà
__UAPI_DEF_IN6_ADDR


219 
	#__UAPI_DEF_IN6_ADDR
 1

	)

221 #iâdeà
__UAPI_DEF_IN6_ADDR_ALT


222 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

224 #iâdeà
__UAPI_DEF_SOCKADDR_IN6


225 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

227 #iâdeà
__UAPI_DEF_IPV6_MREQ


228 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

230 #iâdeà
__UAPI_DEF_IPPROTO_V6


231 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

233 #iâdeà
__UAPI_DEF_IPV6_OPTIONS


234 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

236 #iâdeà
__UAPI_DEF_IN6_PKTINFO


237 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

239 #iâdeà
__UAPI_DEF_IP6_MTUINFO


240 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

244 #iâdeà
__UAPI_DEF_SOCKADDR_IPX


245 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

247 #iâdeà
__UAPI_DEF_IPX_ROUTE_DEFINITION


248 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

250 #iâdeà
__UAPI_DEF_IPX_INTERFACE_DEFINITION


251 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

253 #iâdeà
__UAPI_DEF_IPX_CONFIG_DATA


254 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

256 #iâdeà
__UAPI_DEF_IPX_ROUTE_DEF


257 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

261 #iâdeà
__UAPI_DEF_XATTR


262 
	#__UAPI_DEF_XATTR
 1

	)

	@/usr/include/linux/limits.h

2 #iâdeà
_LINUX_LIMITS_H


3 
	#_LINUX_LIMITS_H


	)

5 
	#NR_OPEN
 1024

	)

7 
	#NGROUPS_MAX
 65536

	)

8 
	#ARG_MAX
 131072

	)

9 
	#LINK_MAX
 127

	)

10 
	#MAX_CANON
 255

	)

11 
	#MAX_INPUT
 255

	)

12 
	#NAME_MAX
 255

	)

13 
	#PATH_MAX
 4096

	)

14 
	#PIPE_BUF
 4096

	)

15 
	#XATTR_NAME_MAX
 255

	)

16 
	#XATTR_SIZE_MAX
 65536

	)

17 
	#XATTR_LIST_MAX
 65536

	)

19 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/mount.h

1 #iâdeà
_LINUX_MOUNT_H


2 
	#_LINUX_MOUNT_H


	)

4 
	~<lšux/ty³s.h
>

13 
	#MS_RDONLY
 1

	)

14 
	#MS_NOSUID
 2

	)

15 
	#MS_NODEV
 4

	)

16 
	#MS_NOEXEC
 8

	)

17 
	#MS_SYNCHRONOUS
 16

	)

18 
	#MS_REMOUNT
 32

	)

19 
	#MS_MANDLOCK
 64

	)

20 
	#MS_DIRSYNC
 128

	)

21 
	#MS_NOSYMFOLLOW
 256

	)

22 
	#MS_NOATIME
 1024

	)

23 
	#MS_NODIRATIME
 2048

	)

24 
	#MS_BIND
 4096

	)

25 
	#MS_MOVE
 8192

	)

26 
	#MS_REC
 16384

	)

27 
	#MS_VERBOSE
 32768

	)

29 
	#MS_SILENT
 32768

	)

30 
	#MS_POSIXACL
 (1<<16è

	)

31 
	#MS_UNBINDABLE
 (1<<17è

	)

32 
	#MS_PRIVATE
 (1<<18è

	)

33 
	#MS_SLAVE
 (1<<19è

	)

34 
	#MS_SHARED
 (1<<20è

	)

35 
	#MS_RELATIME
 (1<<21è

	)

36 
	#MS_KERNMOUNT
 (1<<22è

	)

37 
	#MS_I_VERSION
 (1<<23è

	)

38 
	#MS_STRICTATIME
 (1<<24è

	)

39 
	#MS_LAZYTIME
 (1<<25è

	)

42 
	#MS_SUBMOUNT
 (1<<26)

	)

43 
	#MS_NOREMOTELOCK
 (1<<27)

	)

44 
	#MS_NOSEC
 (1<<28)

	)

45 
	#MS_BORN
 (1<<29)

	)

46 
	#MS_ACTIVE
 (1<<30)

	)

47 
	#MS_NOUSER
 (1<<31)

	)

52 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
|\

53 
MS_LAZYTIME
)

	)

58 
	#MS_MGC_VAL
 0xC0ED0000

	)

59 
	#MS_MGC_MSK
 0xffff0000

	)

64 
	#OPEN_TREE_CLONE
 1

	)

65 
	#OPEN_TREE_CLOEXEC
 
O_CLOEXEC


	)

70 
	#MOVE_MOUNT_F_SYMLINKS
 0x00000001

	)

71 
	#MOVE_MOUNT_F_AUTOMOUNTS
 0x00000002

	)

72 
	#MOVE_MOUNT_F_EMPTY_PATH
 0x00000004

	)

73 
	#MOVE_MOUNT_T_SYMLINKS
 0x00000010

	)

74 
	#MOVE_MOUNT_T_AUTOMOUNTS
 0x00000020

	)

75 
	#MOVE_MOUNT_T_EMPTY_PATH
 0x00000040

	)

76 
	#MOVE_MOUNT_SET_GROUP
 0x00000100

	)

77 
	#MOVE_MOUNT__MASK
 0x00000177

	)

82 
	#FSOPEN_CLOEXEC
 0x00000001

	)

87 
	#FSPICK_CLOEXEC
 0x00000001

	)

88 
	#FSPICK_SYMLINK_NOFOLLOW
 0x00000002

	)

89 
	#FSPICK_NO_AUTOMOUNT
 0x00000004

	)

90 
	#FSPICK_EMPTY_PATH
 0x00000008

	)

95 
	efscÚfig_commªd
 {

96 
	mFSCONFIG_SET_FLAG
 = 0,

97 
	mFSCONFIG_SET_STRING
 = 1,

98 
	mFSCONFIG_SET_BINARY
 = 2,

99 
	mFSCONFIG_SET_PATH
 = 3,

100 
	mFSCONFIG_SET_PATH_EMPTY
 = 4,

101 
	mFSCONFIG_SET_FD
 = 5,

102 
	mFSCONFIG_CMD_CREATE
 = 6,

103 
	mFSCONFIG_CMD_RECONFIGURE
 = 7,

109 
	#FSMOUNT_CLOEXEC
 0x00000001

	)

114 
	#MOUNT_ATTR_RDONLY
 0x00000001

	)

115 
	#MOUNT_ATTR_NOSUID
 0x00000002

	)

116 
	#MOUNT_ATTR_NODEV
 0x00000004

	)

117 
	#MOUNT_ATTR_NOEXEC
 0x00000008

	)

118 
	#MOUNT_ATTR__ATIME
 0x00000070

	)

119 
	#MOUNT_ATTR_RELATIME
 0x00000000

	)

120 
	#MOUNT_ATTR_NOATIME
 0x00000010

	)

121 
	#MOUNT_ATTR_STRICTATIME
 0x00000020

	)

122 
	#MOUNT_ATTR_NODIRATIME
 0x00000080

	)

123 
	#MOUNT_ATTR_IDMAP
 0x00100000

	)

124 
	#MOUNT_ATTR_NOSYMFOLLOW
 0x00200000

	)

129 
	smouÁ_©Œ
 {

130 
__u64
 
	m©Œ_£t
;

131 
__u64
 
	m©Œ_şr
;

132 
__u64
 
	m´İag©iÚ
;

133 
__u64
 
	mu£ºs_fd
;

137 
	#MOUNT_ATTR_SIZE_VER0
 32

	)

	@/usr/include/linux/neighbour.h

2 #iâdeà
__LINUX_NEIGHBOUR_H


3 
	#__LINUX_NEIGHBOUR_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

8 
	sndmsg
 {

9 
__u8
 
	mndm_çmy
;

10 
__u8
 
	mndm_·d1
;

11 
__u16
 
	mndm_·d2
;

12 
__s32
 
	mndm_ifšdex
;

13 
__u16
 
	mndm_¡©e
;

14 
__u8
 
	mndm_æags
;

15 
__u8
 
	mndm_ty³
;

19 
	mNDA_UNSPEC
,

20 
	mNDA_DST
,

21 
	mNDA_LLADDR
,

22 
	mNDA_CACHEINFO
,

23 
	mNDA_PROBES
,

24 
	mNDA_VLAN
,

25 
	mNDA_PORT
,

26 
	mNDA_VNI
,

27 
	mNDA_IFINDEX
,

28 
	mNDA_MASTER
,

29 
	mNDA_LINK_NETNSID
,

30 
	mNDA_SRC_VNI
,

31 
	mNDA_PROTOCOL
,

32 
	mNDA_NH_ID
,

33 
	mNDA_FDB_EXT_ATTRS
,

34 
	m__NDA_MAX


37 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

43 
	#NTF_USE
 0x01

	)

44 
	#NTF_SELF
 0x02

	)

45 
	#NTF_MASTER
 0x04

	)

46 
	#NTF_PROXY
 0x08

	)

47 
	#NTF_EXT_LEARNED
 0x10

	)

48 
	#NTF_OFFLOADED
 0x20

	)

49 
	#NTF_STICKY
 0x40

	)

50 
	#NTF_ROUTER
 0x80

	)

56 
	#NUD_INCOMPLETE
 0x01

	)

57 
	#NUD_REACHABLE
 0x02

	)

58 
	#NUD_STALE
 0x04

	)

59 
	#NUD_DELAY
 0x08

	)

60 
	#NUD_PROBE
 0x10

	)

61 
	#NUD_FAILED
 0x20

	)

64 
	#NUD_NOARP
 0x40

	)

65 
	#NUD_PERMANENT
 0x80

	)

66 
	#NUD_NONE
 0x00

	)

76 
	snda_ÿchešfo
 {

77 
__u32
 
	mndm_cÚfœmed
;

78 
__u32
 
	mndm_u£d
;

79 
__u32
 
	mndm_upd©ed
;

80 
__u32
 
	mndm_»fút
;

108 
	sndt_¡©s
 {

109 
__u64
 
	mndts_®locs
;

110 
__u64
 
	mndts_de¡roys
;

111 
__u64
 
	mndts_hash_grows
;

112 
__u64
 
	mndts_»s_çed
;

113 
__u64
 
	mndts_lookups
;

114 
__u64
 
	mndts_h™s
;

115 
__u64
 
	mndts_rcv_´obes_mÿ¡
;

116 
__u64
 
	mndts_rcv_´obes_uÿ¡
;

117 
__u64
 
	mndts_³riodic_gc_runs
;

118 
__u64
 
	mndts_fÜûd_gc_runs
;

119 
__u64
 
	mndts_bË_fuÎs
;

123 
	mNDTPA_UNSPEC
,

124 
	mNDTPA_IFINDEX
,

125 
	mNDTPA_REFCNT
,

126 
	mNDTPA_REACHABLE_TIME
,

127 
	mNDTPA_BASE_REACHABLE_TIME
,

128 
	mNDTPA_RETRANS_TIME
,

129 
	mNDTPA_GC_STALETIME
,

130 
	mNDTPA_DELAY_PROBE_TIME
,

131 
	mNDTPA_QUEUE_LEN
,

132 
	mNDTPA_APP_PROBES
,

133 
	mNDTPA_UCAST_PROBES
,

134 
	mNDTPA_MCAST_PROBES
,

135 
	mNDTPA_ANYCAST_DELAY
,

136 
	mNDTPA_PROXY_DELAY
,

137 
	mNDTPA_PROXY_QLEN
,

138 
	mNDTPA_LOCKTIME
,

139 
	mNDTPA_QUEUE_LENBYTES
,

140 
	mNDTPA_MCAST_REPROBES
,

141 
	mNDTPA_PAD
,

142 
	m__NDTPA_MAX


144 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

146 
	sndtmsg
 {

147 
__u8
 
	mndtm_çmy
;

148 
__u8
 
	mndtm_·d1
;

149 
__u16
 
	mndtm_·d2
;

152 
	sndt_cÚfig
 {

153 
__u16
 
	mndtc_key_Ën
;

154 
__u16
 
	mndtc_’Œy_size
;

155 
__u32
 
	mndtc_’Œ›s
;

156 
__u32
 
	mndtc_Ï¡_æush
;

157 
__u32
 
	mndtc_Ï¡_¿nd
;

158 
__u32
 
	mndtc_hash_ºd
;

159 
__u32
 
	mndtc_hash_mask
;

160 
__u32
 
	mndtc_hash_chaš_gc
;

161 
__u32
 
	mndtc_´oxy_qËn
;

165 
	mNDTA_UNSPEC
,

166 
	mNDTA_NAME
,

167 
	mNDTA_THRESH1
,

168 
	mNDTA_THRESH2
,

169 
	mNDTA_THRESH3
,

170 
	mNDTA_CONFIG
,

171 
	mNDTA_PARMS
,

172 
	mNDTA_STATS
,

173 
	mNDTA_GC_INTERVAL
,

174 
	mNDTA_PAD
,

175 
	m__NDTA_MAX


177 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

184 
	mFDB_NOTIFY_BIT
 = (1 << 0),

185 
	mFDB_NOTIFY_INACTIVE_BIT
 = (1 << 1)

195 
	mNFEA_UNSPEC
,

196 
	mNFEA_ACTIVITY_NOTIFY
,

197 
	mNFEA_DONT_REFRESH
,

198 
	m__NFEA_MAX


200 
	#NFEA_MAX
 (
__NFEA_MAX
 - 1)

	)

	@/usr/include/linux/netlink.h

2 #iâdeà
__LINUX_NETLINK_H


3 
	#__LINUX_NETLINK_H


	)

5 
	~<lšux/cÚ¡.h
>

6 
	~<lšux/sock‘.h
>

7 
	~<lšux/ty³s.h
>

9 
	#NETLINK_ROUTE
 0

	)

10 
	#NETLINK_UNUSED
 1

	)

11 
	#NETLINK_USERSOCK
 2

	)

12 
	#NETLINK_FIREWALL
 3

	)

13 
	#NETLINK_SOCK_DIAG
 4

	)

14 
	#NETLINK_NFLOG
 5

	)

15 
	#NETLINK_XFRM
 6

	)

16 
	#NETLINK_SELINUX
 7

	)

17 
	#NETLINK_ISCSI
 8

	)

18 
	#NETLINK_AUDIT
 9

	)

19 
	#NETLINK_FIB_LOOKUP
 10

	)

20 
	#NETLINK_CONNECTOR
 11

	)

21 
	#NETLINK_NETFILTER
 12

	)

22 
	#NETLINK_IP6_FW
 13

	)

23 
	#NETLINK_DNRTMSG
 14

	)

24 
	#NETLINK_KOBJECT_UEVENT
 15

	)

25 
	#NETLINK_GENERIC
 16

	)

27 
	#NETLINK_SCSITRANSPORT
 18

	)

28 
	#NETLINK_ECRYPTFS
 19

	)

29 
	#NETLINK_RDMA
 20

	)

30 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_SMC
 22

	)

33 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

35 
	#MAX_LINKS
 32

	)

37 
	ssockaddr_Æ
 {

38 
__k”Ãl_§_çmy_t
 
	mÆ_çmy
;

39 
	mÆ_·d
;

40 
__u32
 
	mÆ_pid
;

41 
__u32
 
	mÆ_groups
;

44 
	sÆmsghdr
 {

45 
__u32
 
	mÆmsg_Ën
;

46 
__u16
 
	mÆmsg_ty³
;

47 
__u16
 
	mÆmsg_æags
;

48 
__u32
 
	mÆmsg_£q
;

49 
__u32
 
	mÆmsg_pid
;

54 
	#NLM_F_REQUEST
 0x01

	)

55 
	#NLM_F_MULTI
 0x02

	)

56 
	#NLM_F_ACK
 0x04

	)

57 
	#NLM_F_ECHO
 0x08

	)

58 
	#NLM_F_DUMP_INTR
 0x10

	)

59 
	#NLM_F_DUMP_FILTERED
 0x20

	)

62 
	#NLM_F_ROOT
 0x100

	)

63 
	#NLM_F_MATCH
 0x200

	)

64 
	#NLM_F_ATOMIC
 0x400

	)

65 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

68 
	#NLM_F_REPLACE
 0x100

	)

69 
	#NLM_F_EXCL
 0x200

	)

70 
	#NLM_F_CREATE
 0x400

	)

71 
	#NLM_F_APPEND
 0x800

	)

74 
	#NLM_F_NONREC
 0x100

	)

77 
	#NLM_F_CAPPED
 0x100

	)

78 
	#NLM_F_ACK_TLVS
 0x200

	)

89 
	#NLMSG_ALIGNTO
 4U

	)

90 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

91 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

92 
	#NLMSG_LENGTH
(
Ën
è(Ö’è+ 
NLMSG_HDRLEN
)

	)

93 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

94 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
NLMSG_HDRLEN
))

	)

95 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

96 (
Æmsghdr
 *)(((*)(
Æh
)) + \

97 
	`NLMSG_ALIGN
((
Æh
)->
Æmsg_Ën
)))

	)

98 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

99 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

100 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

101 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

103 
	#NLMSG_NOOP
 0x1

	)

104 
	#NLMSG_ERROR
 0x2

	)

105 
	#NLMSG_DONE
 0x3

	)

106 
	#NLMSG_OVERRUN
 0x4

	)

108 
	#NLMSG_MIN_TYPE
 0x10

	)

110 
	sÆmsg”r
 {

111 
	m”rÜ
;

112 
Æmsghdr
 
	mmsg
;

137 
	eÆmsg”r_©Œs
 {

138 
	mNLMSGERR_ATTR_UNUSED
,

139 
	mNLMSGERR_ATTR_MSG
,

140 
	mNLMSGERR_ATTR_OFFS
,

141 
	mNLMSGERR_ATTR_COOKIE
,

142 
	mNLMSGERR_ATTR_POLICY
,

144 
	m__NLMSGERR_ATTR_MAX
,

145 
	mNLMSGERR_ATTR_MAX
 = 
__NLMSGERR_ATTR_MAX
 - 1

148 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

149 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

150 
	#NETLINK_PKTINFO
 3

	)

151 
	#NETLINK_BROADCAST_ERROR
 4

	)

152 
	#NETLINK_NO_ENOBUFS
 5

	)

153 
	#NETLINK_RX_RING
 6

	)

154 
	#NETLINK_TX_RING
 7

	)

155 
	#NETLINK_LISTEN_ALL_NSID
 8

	)

156 
	#NETLINK_LIST_MEMBERSHIPS
 9

	)

157 
	#NETLINK_CAP_ACK
 10

	)

158 
	#NETLINK_EXT_ACK
 11

	)

159 
	#NETLINK_GET_STRICT_CHK
 12

	)

161 
	sÆ_pktšfo
 {

162 
__u32
 
	mgroup
;

165 
	sÆ_mm­_»q
 {

166 
	mnm_block_size
;

167 
	mnm_block_Ä
;

168 
	mnm_äame_size
;

169 
	mnm_äame_Ä
;

172 
	sÆ_mm­_hdr
 {

173 
	mnm_¡©us
;

174 
	mnm_Ën
;

175 
__u32
 
	mnm_group
;

177 
__u32
 
	mnm_pid
;

178 
__u32
 
	mnm_uid
;

179 
__u32
 
	mnm_gid
;

182 
	eÆ_mm­_¡©us
 {

183 
	mNL_MMAP_STATUS_UNUSED
,

184 
	mNL_MMAP_STATUS_RESERVED
,

185 
	mNL_MMAP_STATUS_VALID
,

186 
	mNL_MMAP_STATUS_COPY
,

187 
	mNL_MMAP_STATUS_SKIP
,

190 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

191 
	#NL_MMAP_MSG_ALIGN
(
sz
è
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

192 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
Æ_mm­_hdr
))

	)

194 
	#NET_MAJOR
 36

	)

197 
	mNETLINK_UNCONNECTED
 = 0,

198 
	mNETLINK_CONNECTED
,

210 
	sÆ©Œ
 {

211 
__u16
 
	mÆa_Ën
;

212 
__u16
 
	mÆa_ty³
;

225 
	#NLA_F_NESTED
 (1 << 15)

	)

226 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

227 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

229 
	#NLA_ALIGNTO
 4

	)

230 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

231 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

246 
	sÆa_b™f›ld32
 {

247 
__u32
 
	mv®ue
;

248 
__u32
 
	m£ËùÜ
;

283 
	eÃšk_©Œibu‹_ty³
 {

284 
	mNL_ATTR_TYPE_INVALID
,

286 
	mNL_ATTR_TYPE_FLAG
,

288 
	mNL_ATTR_TYPE_U8
,

289 
	mNL_ATTR_TYPE_U16
,

290 
	mNL_ATTR_TYPE_U32
,

291 
	mNL_ATTR_TYPE_U64
,

293 
	mNL_ATTR_TYPE_S8
,

294 
	mNL_ATTR_TYPE_S16
,

295 
	mNL_ATTR_TYPE_S32
,

296 
	mNL_ATTR_TYPE_S64
,

298 
	mNL_ATTR_TYPE_BINARY
,

299 
	mNL_ATTR_TYPE_STRING
,

300 
	mNL_ATTR_TYPE_NUL_STRING
,

302 
	mNL_ATTR_TYPE_NESTED
,

303 
	mNL_ATTR_TYPE_NESTED_ARRAY
,

305 
	mNL_ATTR_TYPE_BITFIELD32
,

336 
	eÃšk_pŞicy_ty³_©Œ
 {

337 
	mNL_POLICY_TYPE_ATTR_UNSPEC
,

338 
	mNL_POLICY_TYPE_ATTR_TYPE
,

339 
	mNL_POLICY_TYPE_ATTR_MIN_VALUE_S
,

340 
	mNL_POLICY_TYPE_ATTR_MAX_VALUE_S
,

341 
	mNL_POLICY_TYPE_ATTR_MIN_VALUE_U
,

342 
	mNL_POLICY_TYPE_ATTR_MAX_VALUE_U
,

343 
	mNL_POLICY_TYPE_ATTR_MIN_LENGTH
,

344 
	mNL_POLICY_TYPE_ATTR_MAX_LENGTH
,

345 
	mNL_POLICY_TYPE_ATTR_POLICY_IDX
,

346 
	mNL_POLICY_TYPE_ATTR_POLICY_MAXTYPE
,

347 
	mNL_POLICY_TYPE_ATTR_BITFIELD32_MASK
,

348 
	mNL_POLICY_TYPE_ATTR_PAD
,

349 
	mNL_POLICY_TYPE_ATTR_MASK
,

352 
	m__NL_POLICY_TYPE_ATTR_MAX
,

353 
	mNL_POLICY_TYPE_ATTR_MAX
 = 
__NL_POLICY_TYPE_ATTR_MAX
 - 1

	@/usr/include/linux/posix_types.h

2 #iâdeà
_LINUX_POSIX_TYPES_H


3 
	#_LINUX_POSIX_TYPES_H


	)

5 
	~<lšux/¡ddef.h
>

22 #undeà
__FD_SETSIZE


23 
	#__FD_SETSIZE
 1024

	)

26 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

27 } 
	t__k”Ãl_fd_£t
;

30 (*
	t__k”Ãl_sighªdËr_t
)();

33 
	t__k”Ãl_key_t
;

34 
	t__k”Ãl_mqd_t
;

36 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/stddef.h

2 #iâdeà
_LINUX_STDDEF_H


3 
	#_LINUX_STDDEF_H


	)

7 #iâdeà
__®ways_šlše


8 
	#__®ways_šlše
 
__šlše__


	)

26 
	#__¡ruù_group
(
TAG
, 
NAME
, 
ATTRS
, 
MEMBERS
...) \

28 ¡ruù { 
MEMBERS
 } 
ATTRS
; \

29 
	sTAG
 { 
MEMBERS
 } 
ATTRS
 
NAME
; \

30 } 
ATTRS


	)

42 
	#__DECLARE_FLEX_ARRAY
(
TYPE
, 
NAME
) \

44 ¡ruù { } 
__em±y_
 ## 
NAME
; \

45 
TYPE
 
NAME
[]; \

46 }

	)

	@/usr/include/linux/sysinfo.h

2 #iâdeà
_LINUX_SYSINFO_H


3 
	#_LINUX_SYSINFO_H


	)

5 
	~<lšux/ty³s.h
>

7 
	#SI_LOAD_SHIFT
 16

	)

8 
	ssysšfo
 {

9 
__k”Ãl_lÚg_t
 
	mu±ime
;

10 
__k”Ãl_ulÚg_t
 
	mlßds
[3];

11 
__k”Ãl_ulÚg_t
 
	mtÙ®¿m
;

12 
__k”Ãl_ulÚg_t
 
	mä“¿m
;

13 
__k”Ãl_ulÚg_t
 
	msh¬ed¿m
;

14 
__k”Ãl_ulÚg_t
 
	mbufã¼am
;

15 
__k”Ãl_ulÚg_t
 
	mtÙ®sw­
;

16 
__k”Ãl_ulÚg_t
 
	mä“sw­
;

17 
__u16
 
	m´ocs
;

18 
__u16
 
	m·d
;

19 
__k”Ãl_ulÚg_t
 
	mtÙ®high
;

20 
__k”Ãl_ulÚg_t
 
	mä“high
;

21 
__u32
 
	mmem_un™
;

22 
	m_f
[20-2*(
__k”Ãl_ulÚg_t
)-(
__u32
)];

	@/usr/include/linux/time_types.h

2 #iâdeà
_LINUX_TIME_TYPES_H


3 
	#_LINUX_TIME_TYPES_H


	)

5 
	~<lšux/ty³s.h
>

7 
	s__k”Ãl_time¥ec
 {

8 
__k”Ãl_time64_t
 
	mtv_£c
;

9 
	mtv_n£c
;

12 
	s__k”Ãl_™im”¥ec
 {

13 
__k”Ãl_time¥ec
 
	m™_š‹rv®
;

14 
__k”Ãl_time¥ec
 
	m™_v®ue
;

24 #iâdeà
__k”Ãl_Şd_timev®


25 
	s__k”Ãl_Şd_timev®
 {

26 
__k”Ãl_lÚg_t
 
	mtv_£c
;

27 
__k”Ãl_lÚg_t
 
	mtv_u£c
;

31 
	s__k”Ãl_Şd_time¥ec
 {

32 
__k”Ãl_Şd_time_t
 
	mtv_£c
;

33 
	mtv_n£c
;

36 
	s__k”Ãl_Şd_™im”v®
 {

37 
__k”Ãl_Şd_timev®
 
	m™_š‹rv®
;

38 
__k”Ãl_Şd_timev®
 
	m™_v®ue
;

41 
	s__k”Ãl_sock_timev®
 {

42 
__s64
 
	mtv_£c
;

43 
__s64
 
	mtv_u£c
;

	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 #ià
defšed
 
__ılu¥lus
 && (
__GNUC_PREREQ
 (4, 4) \

37 || 
	$__glibc_şªg_´”eq
 (3, 5))

38 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

43 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

44 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

47 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

48 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

53 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || 
	`__GLIBC_USE
 (
ISOC2X
)

54 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
	`__©Œ_acûss
 ((
__wr™e_Úly__
, 1, 4));

61 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

64 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

65 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

80 
	$__memcm³q
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

81 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

84 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


87 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

88 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

89 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

90 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

92 #ifdeà
__OPTIMIZE__


93 
__ex‹º_®ways_šlše
 *

94 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


96  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

99 
__ex‹º_®ways_šlše
 const *

100 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


102  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

105 
	}
}

107 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

108 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 #ifdeà
__USE_GNU


114 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


115 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

116 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

117 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

118 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

120 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

125 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


126 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

127 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1))

128 
	`__©Œ_acûss
 ((
__»ad_Úly__
, 1, 3));

129 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

130 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1))

131 
	`__©Œ_acûss
 ((
__»ad_Úly__
, 1, 3));

133 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

134 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1))

135 
	`__©Œ_acûss
 ((
__»ad_Úly__
, 1, 3));

141 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

142 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

144 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

145 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

146 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

149 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

150 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

152 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

153 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

156 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

157 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

159 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

160 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

163 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

164 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

166 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

167 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

168 
__THROW
 
	`__nÚnuÎ
 ((2)è
	`__©Œ_acûss
 ((
__wr™e_Úly__
, 1, 3));

170 #ifdeà
__USE_XOPEN2K8


172 
	~<b™s/ty³s/loÿË_t.h
>

175 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__l
)

176 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

179 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

180 
loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4))

181 
	`__©Œ_acûss
 ((
__wr™e_Úly__
, 1, 3));

184 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8
 \

185 || 
	`__GLIBC_USE
 (
LIB_EXT2
è|| 
	$__GLIBC_USE
 (
ISOC2X
))

187 *
	$¡rdup
 (cÚ¡ *
__s
)

188 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

194 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
è|| __GLIBC_USE (
ISOC2X
)

195 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

196 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

199 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


201 
	#¡rdu·
(
s
) \

202 (
__ex‹nsiÚ__
 \

204 cÚ¡ *
__Şd
 = (
s
); \

205 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

206 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

207 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

208 
	}
}))

	)

211 
	#¡ºdu·
(
s
, 
n
) \

212 (
__ex‹nsiÚ__
 \

214 cÚ¡ *
__Şd
 = (
s
); \

215 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

216 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

217 
__Ãw
[
__Ën
] = '\0'; \

218 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

219 }))

	)

223 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


226 *
¡rchr
 (*
__s
, 
__c
)

227 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

228 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

229 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

231 #ifdeà
__OPTIMIZE__


232 
__ex‹º_®ways_šlše
 *

233 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


235  
__butš_¡rchr
 (
__s
, 
__c
);

238 
__ex‹º_®ways_šlše
 const *

239 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


241  
__butš_¡rchr
 (
__s
, 
__c
);

246 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

247 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

250 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


253 *
	`¡¼chr
 (*
__s
, 
__c
)

254 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

255 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

256 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

258 #ifdeà
__OPTIMIZE__


259 
__ex‹º_®ways_šlše
 *

260 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


262  
	`__butš_¡¼chr
 (
__s
, 
__c
);

265 
__ex‹º_®ways_šlše
 const *

266 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


268  
	`__butš_¡¼chr
 (
__s
, 
__c
);

271 
	}
}

273 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

274 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 #ifdeà
__USE_GNU


280 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


281 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

282 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

283 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

284 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

286 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

287 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

293 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

294 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

298 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

300 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


303 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

304 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

305 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

306 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

308 #ifdeà
__OPTIMIZE__


309 
__ex‹º_®ways_šlše
 *

310 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


312  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

315 
__ex‹º_®ways_šlše
 const *

316 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


318  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

321 
	}
}

323 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

324 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


330 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

331 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

332 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

333 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 #ifdeà
__OPTIMIZE__


336 
__ex‹º_®ways_šlše
 *

337 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


339  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

342 
__ex‹º_®ways_šlše
 const *

343 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


345  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

348 
	}
}

350 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

351 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

356 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

357 
__THROW
 
	`__nÚnuÎ
 ((2));

361 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

362 cÚ¡ *
__»¡riù
 
__d–im
,

363 **
__»¡riù
 
__§ve_±r
)

364 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

365 #ifdeà
__USE_POSIX


366 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

367 **
__»¡riù
 
__§ve_±r
)

368 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

371 #ifdeà
__USE_GNU


373 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


374 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

375 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

376 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

377 cÚ¡ *
__ÃedË
)

378 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

380 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

381 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

385 #ifdeà
__USE_GNU


389 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

390 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

391 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3))

392 
	`__©Œ_acûss
 ((
__»ad_Úly__
, 1, 2))

393 
	`__©Œ_acûss
 ((
__»ad_Úly__
, 3, 4));

397 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

398 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

399 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

400 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

401 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

402 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

407 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

408 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

410 #ifdef 
__USE_XOPEN2K8


413 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

414 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

419 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

420 #ifdeà
__USE_XOPEN2K


428 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


431 #ifdeà
__REDIRECT_NTH


432 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

433 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

434 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2))

435 
	`__©Œ_acûss
 ((
__wr™e_Úly__
, 2, 3));

437 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

438 
__THROW
 
	`__nÚnuÎ
 ((2)è
	`__©Œ_acûss
 ((
__wr™e_Úly__
, 2, 3));

439 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

444 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

445 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
 
	`__©Œ_acûss
 ((
__wr™e_Úly__
, 2, 3));

448 #ifdeà
__USE_GNU


450 cÚ¡ *
	$¡»¼Üdesc_Å
 (
__”r
è
__THROW
;

452 cÚ¡ *
	$¡»¼ÜÇme_Å
 (
__”r
è
__THROW
;

456 #ifdeà
__USE_XOPEN2K8


458 *
	$¡»¼Ü_l
 (
__”ºum
, 
loÿË_t
 
__l
è
__THROW
;

461 #ifdeà
__USE_MISC


462 
	~<¡ršgs.h
>

466 
	$ex¶ic™_bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1))

467 
	`__fÜtif›d_©Œ_acûss
 (
__wr™e_Úly__
, 1, 2);

471 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

472 cÚ¡ *
__»¡riù
 
__d–im
)

473 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

476 #ifdef 
__USE_XOPEN2K8


478 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

480 #ifdeà
__USE_GNU


482 cÚ¡ *
	$sigabb»v_Å
 (
__sig
è
__THROW
;

485 cÚ¡ *
	$sigdesü_Å
 (
__sig
è
__THROW
;

489 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

490 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

491 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

492 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

496 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

497 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

498 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

499 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

500 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

501 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

504 #ifdef 
__USE_GNU


506 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

507 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

510 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

513 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1))

514 
	`__©Œ_acûss
 ((
__»ad_wr™e__
, 1, 2));

516 #iâdeà
ba£Çme


521 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


522 "C++" *
	$ba£Çme
 (*
__f’ame
)

523 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

524 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

525 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

527 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

532 #ià
	`__GNUC_PREREQ
 (3,4)

533 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


535 
	~<b™s/¡ršg_fÜtif›d.h
>

539 
__END_DECLS


	@/usr/include/asm-generic/errno.h

2 #iâdeà
_ASM_GENERIC_ERRNO_H


3 
	#_ASM_GENERIC_ERRNO_H


	)

5 
	~<asm-g’”ic/”ºo-ba£.h
>

7 
	#EDEADLK
 35

	)

8 
	#ENAMETOOLONG
 36

	)

9 
	#ENOLCK
 37

	)

18 
	#ENOSYS
 38

	)

20 
	#ENOTEMPTY
 39

	)

21 
	#ELOOP
 40

	)

22 
	#EWOULDBLOCK
 
EAGAIN


	)

23 
	#ENOMSG
 42

	)

24 
	#EIDRM
 43

	)

25 
	#ECHRNG
 44

	)

26 
	#EL2NSYNC
 45

	)

27 
	#EL3HLT
 46

	)

28 
	#EL3RST
 47

	)

29 
	#ELNRNG
 48

	)

30 
	#EUNATCH
 49

	)

31 
	#ENOCSI
 50

	)

32 
	#EL2HLT
 51

	)

33 
	#EBADE
 52

	)

34 
	#EBADR
 53

	)

35 
	#EXFULL
 54

	)

36 
	#ENOANO
 55

	)

37 
	#EBADRQC
 56

	)

38 
	#EBADSLT
 57

	)

40 
	#EDEADLOCK
 
EDEADLK


	)

42 
	#EBFONT
 59

	)

43 
	#ENOSTR
 60

	)

44 
	#ENODATA
 61

	)

45 
	#ETIME
 62

	)

46 
	#ENOSR
 63

	)

47 
	#ENONET
 64

	)

48 
	#ENOPKG
 65

	)

49 
	#EREMOTE
 66

	)

50 
	#ENOLINK
 67

	)

51 
	#EADV
 68

	)

52 
	#ESRMNT
 69

	)

53 
	#ECOMM
 70

	)

54 
	#EPROTO
 71

	)

55 
	#EMULTIHOP
 72

	)

56 
	#EDOTDOT
 73

	)

57 
	#EBADMSG
 74

	)

58 
	#EOVERFLOW
 75

	)

59 
	#ENOTUNIQ
 76

	)

60 
	#EBADFD
 77

	)

61 
	#EREMCHG
 78

	)

62 
	#ELIBACC
 79

	)

63 
	#ELIBBAD
 80

	)

64 
	#ELIBSCN
 81

	)

65 
	#ELIBMAX
 82

	)

66 
	#ELIBEXEC
 83

	)

67 
	#EILSEQ
 84

	)

68 
	#ERESTART
 85

	)

69 
	#ESTRPIPE
 86

	)

70 
	#EUSERS
 87

	)

71 
	#ENOTSOCK
 88

	)

72 
	#EDESTADDRREQ
 89

	)

73 
	#EMSGSIZE
 90

	)

74 
	#EPROTOTYPE
 91

	)

75 
	#ENOPROTOOPT
 92

	)

76 
	#EPROTONOSUPPORT
 93

	)

77 
	#ESOCKTNOSUPPORT
 94

	)

78 
	#EOPNOTSUPP
 95

	)

79 
	#EPFNOSUPPORT
 96

	)

80 
	#EAFNOSUPPORT
 97

	)

81 
	#EADDRINUSE
 98

	)

82 
	#EADDRNOTAVAIL
 99

	)

83 
	#ENETDOWN
 100

	)

84 
	#ENETUNREACH
 101

	)

85 
	#ENETRESET
 102

	)

86 
	#ECONNABORTED
 103

	)

87 
	#ECONNRESET
 104

	)

88 
	#ENOBUFS
 105

	)

89 
	#EISCONN
 106

	)

90 
	#ENOTCONN
 107

	)

91 
	#ESHUTDOWN
 108

	)

92 
	#ETOOMANYREFS
 109

	)

93 
	#ETIMEDOUT
 110

	)

94 
	#ECONNREFUSED
 111

	)

95 
	#EHOSTDOWN
 112

	)

96 
	#EHOSTUNREACH
 113

	)

97 
	#EALREADY
 114

	)

98 
	#EINPROGRESS
 115

	)

99 
	#ESTALE
 116

	)

100 
	#EUCLEAN
 117

	)

101 
	#ENOTNAM
 118

	)

102 
	#ENAVAIL
 119

	)

103 
	#EISNAM
 120

	)

104 
	#EREMOTEIO
 121

	)

105 
	#EDQUOT
 122

	)

107 
	#ENOMEDIUM
 123

	)

108 
	#EMEDIUMTYPE
 124

	)

109 
	#ECANCELED
 125

	)

110 
	#ENOKEY
 126

	)

111 
	#EKEYEXPIRED
 127

	)

112 
	#EKEYREVOKED
 128

	)

113 
	#EKEYREJECTED
 129

	)

116 
	#EOWNERDEAD
 130

	)

117 
	#ENOTRECOVERABLE
 131

	)

119 
	#ERFKILL
 132

	)

121 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/poll.h

2 #iâdeà
__ASM_GENERIC_POLL_H


3 
	#__ASM_GENERIC_POLL_H


	)

6 
	#POLLIN
 0x0001

	)

7 
	#POLLPRI
 0x0002

	)

8 
	#POLLOUT
 0x0004

	)

9 
	#POLLERR
 0x0008

	)

10 
	#POLLHUP
 0x0010

	)

11 
	#POLLNVAL
 0x0020

	)

14 
	#POLLRDNORM
 0x0040

	)

15 
	#POLLRDBAND
 0x0080

	)

16 #iâdeà
POLLWRNORM


17 
	#POLLWRNORM
 0x0100

	)

19 #iâdeà
POLLWRBAND


20 
	#POLLWRBAND
 0x0200

	)

22 #iâdeà
POLLMSG


23 
	#POLLMSG
 0x0400

	)

25 #iâdeà
POLLREMOVE


26 
	#POLLREMOVE
 0x1000

	)

28 #iâdeà
POLLRDHUP


29 
	#POLLRDHUP
 0x2000

	)

32 
	#POLLFREE
 (
__pŞl_t
)0x4000

	)

34 
	#POLL_BUSY_LOOP
 (
__pŞl_t
)0x8000

	)

36 
	spŞlfd
 {

37 
	mfd
;

38 
	mev’ts
;

39 
	m»v’ts
;

	@/usr/include/asm-generic/types.h

2 #iâdeà
_ASM_GENERIC_TYPES_H


3 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-g’”ic/št-Î64.h
>

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/posix_types.h

2 #ifdeà
__i386__


3 
	~<asm/posix_ty³s_32.h
>

4 #–ià
defšed
(
__ILP32__
)

5 
	~<asm/posix_ty³s_x32.h
>

7 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-g’”ic/sock‘.h
>

	@/usr/include/bits/libc-header-start.h

27 #iâdeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


31 #undeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


33 
	~<ã©u»s.h
>

37 #undeà
__GLIBC_USE_LIB_EXT2


38 #ià(
defšed
 
__USE_GNU
 \

39 || (
defšed
 
	g__STDC_WANT_LIB_EXT2__
 && __STDC_WANT_LIB_EXT2__ > 0))

40 
	#__GLIBC_USE_LIB_EXT2
 1

	)

42 
	#__GLIBC_USE_LIB_EXT2
 0

	)

67 #undeà
__GLIBC_USE_IEC_60559_BFP_EXT


68 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_BFP_EXT__


69 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 1

	)

71 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 0

	)

73 #undeà
__GLIBC_USE_IEC_60559_BFP_EXT_C2X


74 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| __GLIBC_USE (
ISOC2X
)

75 
	#__GLIBC_USE_IEC_60559_BFP_EXT_C2X
 1

	)

77 
	#__GLIBC_USE_IEC_60559_BFP_EXT_C2X
 0

	)

79 #undeà
__GLIBC_USE_IEC_60559_EXT


80 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| 
defšed
 
__STDC_WANT_IEC_60559_EXT__


81 
	#__GLIBC_USE_IEC_60559_EXT
 1

	)

83 
	#__GLIBC_USE_IEC_60559_EXT
 0

	)

90 #undeà
__GLIBC_USE_IEC_60559_FUNCS_EXT


91 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_FUNCS_EXT__


92 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 1

	)

94 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 0

	)

96 #undeà
__GLIBC_USE_IEC_60559_FUNCS_EXT_C2X


97 #ià
__GLIBC_USE
 (
IEC_60559_FUNCS_EXT
è|| __GLIBC_USE (
ISOC2X
)

98 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT_C2X
 1

	)

100 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT_C2X
 0

	)

105 #undeà
__GLIBC_USE_IEC_60559_TYPES_EXT


106 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_TYPES_EXT__


107 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 1

	)

109 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 0

	)

	@/usr/include/bits/sockaddr.h

23 #iâdeà
_BITS_SOCKADDR_H


24 
	#_BITS_SOCKADDR_H
 1

	)

28 
	t§_çmy_t
;

34 
	#__SOCKADDR_COMMON
(
§_´efix
) \

35 
§_çmy_t
 
§_´efix
##
çmy


	)

37 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

40 
	#_SS_SIZE
 128

	)

	@/usr/include/bits/socket-constants.h

19 #iâdeà
_SYS_SOCKET_H


23 
	~<b™s/timesize.h
>

25 
	#SOL_SOCKET
 1

	)

26 
	#SO_ACCEPTCONN
 30

	)

27 
	#SO_BROADCAST
 6

	)

28 
	#SO_DONTROUTE
 5

	)

29 
	#SO_ERROR
 4

	)

30 
	#SO_KEEPALIVE
 9

	)

31 
	#SO_LINGER
 13

	)

32 
	#SO_OOBINLINE
 10

	)

33 
	#SO_RCVBUF
 8

	)

34 
	#SO_RCVLOWAT
 18

	)

35 
	#SO_REUSEADDR
 2

	)

36 
	#SO_SNDBUF
 7

	)

37 
	#SO_SNDLOWAT
 19

	)

38 
	#SO_TYPE
 3

	)

40 #ià(
__TIMESIZE
 =ğ64 && 
__WORDSIZE
 == 32 \

41 && (!
defšed
 
	g__SYSCALL_WORDSIZE
 || __SYSCALL_WORDSIZE == 32))

42 
	#SO_RCVTIMEO
 66

	)

43 
	#SO_SNDTIMEO
 67

	)

44 
	#SO_TIMESTAMP
 63

	)

45 
	#SO_TIMESTAMPNS
 64

	)

46 
	#SO_TIMESTAMPING
 65

	)

48 #ià
__TIMESIZE
 == 64

49 
	#SO_RCVTIMEO
 20

	)

50 
	#SO_SNDTIMEO
 21

	)

51 
	#SO_TIMESTAMP
 29

	)

52 
	#SO_TIMESTAMPNS
 35

	)

53 
	#SO_TIMESTAMPING
 37

	)

55 
	#SO_RCVTIMEO_OLD
 20

	)

56 
	#SO_SNDTIMEO_OLD
 21

	)

57 
	#SO_RCVTIMEO_NEW
 66

	)

58 
	#SO_SNDTIMEO_NEW
 67

	)

60 
	#SO_TIMESTAMP_OLD
 29

	)

61 
	#SO_TIMESTAMPNS_OLD
 35

	)

62 
	#SO_TIMESTAMPING_OLD
 37

	)

63 
	#SO_TIMESTAMP_NEW
 63

	)

64 
	#SO_TIMESTAMPNS_NEW
 64

	)

65 
	#SO_TIMESTAMPING_NEW
 65

	)

67 #ifdeà
__USE_TIME_BITS64


68 
	#SO_RCVTIMEO
 
SO_RCVTIMEO_NEW


	)

69 
	#SO_SNDTIMEO
 
SO_SNDTIMEO_NEW


	)

70 
	#SO_TIMESTAMP
 
SO_TIMESTAMP_NEW


	)

71 
	#SO_TIMESTAMPNS
 
SO_TIMESTAMPNS_NEW


	)

72 
	#SO_TIMESTAMPING
 
SO_TIMESTAMPING_NEW


	)

74 
	#SO_RCVTIMEO
 
SO_RCVTIMEO_OLD


	)

75 
	#SO_SNDTIMEO
 
SO_SNDTIMEO_OLD


	)

76 
	#SO_TIMESTAMP
 
SO_TIMESTAMP_OLD


	)

77 
	#SO_TIMESTAMPNS
 
SO_TIMESTAMPNS_OLD


	)

78 
	#SO_TIMESTAMPING
 
SO_TIMESTAMPING_OLD


	)

	@/usr/include/bits/socket_type.h

19 #iâdeà
_SYS_SOCKET_H


24 
	e__sock‘_ty³


26 
	mSOCK_STREAM
 = 1,

28 
	#SOCK_STREAM
 
SOCK_STREAM


	)

29 
	mSOCK_DGRAM
 = 2,

31 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

32 
	mSOCK_RAW
 = 3,

33 
	#SOCK_RAW
 
SOCK_RAW


	)

34 
	mSOCK_RDM
 = 4,

35 
	#SOCK_RDM
 
SOCK_RDM


	)

36 
	mSOCK_SEQPACKET
 = 5,

38 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

39 
	mSOCK_DCCP
 = 6,

40 
	#SOCK_DCCP
 
SOCK_DCCP


	)

41 
	mSOCK_PACKET
 = 10,

44 
	#SOCK_PACKET
 
SOCK_PACKET


	)

49 
	mSOCK_CLOEXEC
 = 02000000,

51 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

52 
	mSOCK_NONBLOCK
 = 00004000

54 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

	@/usr/include/bits/string_fortified.h

18 #iâdeà
_BITS_STRING_FORTIFIED_H


19 
	#_BITS_STRING_FORTIFIED_H
 1

	)

21 #iâdeà
_STRING_H


25 
__fÜtify_funùiÚ
 *

26 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

27 
size_t
 
__Ën
))

29  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
,

30 
	`__glibc_objsize0
 (
__de¡
));

31 
	}
}

33 
__fÜtify_funùiÚ
 *

34 
__NTH
 (
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__Ën
))

36  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
,

37 
	`__glibc_objsize0
 (
__de¡
));

38 
	}
}

40 #ifdeà
__USE_GNU


41 
__fÜtify_funùiÚ
 *

42 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__Ën
))

45  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
,

46 
	`__glibc_objsize0
 (
__de¡
));

47 
	}
}

56 
__fÜtify_funùiÚ
 *

57 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

59  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
,

60 
	`__glibc_objsize0
 (
__de¡
));

61 
	}
}

63 #ifdeà
__USE_MISC


64 
	~<b™s/¡ršgs_fÜtif›d.h
>

66 
	$__ex¶ic™_bz”o_chk
 (*
__de¡
, 
size_t
 
__Ën
, size_ˆ
__de¡Ën
)

67 
__THROW
 
	`__nÚnuÎ
 ((1)è
	`__fÜtif›d_©Œ_acûss
 (
__wr™e_Úly__
, 1, 2);

69 
__fÜtify_funùiÚ
 

70 
	`__NTH
 (
	$ex¶ic™_bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

72 
	`__ex¶ic™_bz”o_chk
 (
__de¡
, 
__Ën
, 
	`__glibc_objsize0
 (__dest));

73 
	}
}

76 
__fÜtify_funùiÚ
 *

77 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

79  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__glibc_objsize
 (__dest));

80 
	}
}

82 #ifdeà
__USE_XOPEN2K8


83 
__fÜtify_funùiÚ
 *

84 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

86  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__glibc_objsize
 (__dest));

87 
	}
}

91 
__fÜtify_funùiÚ
 *

92 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

93 
size_t
 
__Ën
))

95  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
,

96 
	`__glibc_objsize
 (
__de¡
));

97 
	}
}

99 #ifdeà
__USE_XOPEN2K8


100 #ià
__GNUC_PREREQ
 (4, 7è|| 
__glibc_şªg_´”eq
 (2, 6)

101 
__fÜtify_funùiÚ
 *

102 
__NTH
 (
	$¡²ıy
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
))

104  
	`__butš___¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

105 
	`__glibc_objsize
 (
__de¡
));

106 
	}
}

108 *
	$__¡²ıy_chk
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

109 
size_t
 
__de¡Ën
è
__THROW


110 
	`__fÜtif›d_©Œ_acûss
 ((
__wr™e_Úly__
, 1, 3))

111 
	`__©Œ_acûss
 ((
__»ad_Úly__
, 2));

112 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
, cÚ¡ *
__¤c
,

113 
size_t
 
__n
), 
¡²ıy
);

115 
__fÜtify_funùiÚ
 *

116 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
))

118 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

119 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À> 
	`__bos
 (
__de¡
)))

120  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

121  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

122 
	}
}

127 
__fÜtify_funùiÚ
 *

128 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

130  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__glibc_objsize
 (__dest));

131 
	}
}

134 
__fÜtify_funùiÚ
 *

135 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

136 
size_t
 
__Ën
))

138  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
,

139 
	`__glibc_objsize
 (
__de¡
));

140 
	}
}

	@/usr/include/bits/types/locale_t.h

19 #iâdeà
_BITS_TYPES_LOCALE_T_H


20 
	#_BITS_TYPES_LOCALE_T_H
 1

	)

22 
	~<b™s/ty³s/__loÿË_t.h
>

24 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/bits/types/time_t.h

1 #iâdeà
__time_t_defšed


2 
	#__time_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 #ifdeà
__USE_TIME_BITS64


8 
__time64_t
 
	ttime_t
;

10 
__time_t
 
	ttime_t
;

	@/usr/include/features-time64.h

20 
	~<b™s/wÜdsize.h
>

21 
	~<b™s/timesize.h
>

23 #ià
defšed
 
_TIME_BITS


24 #ià
_TIME_BITS
 == 64

25 #ià! 
defšed
 (
_FILE_OFFSET_BITS
) || _FILE_OFFSET_BITS != 64

27 #–ià
__TIMESIZE
 == 32

28 
	#__USE_TIME_BITS64
 1

	)

30 #–ià
_TIME_BITS
 == 32

31 #ià
__TIMESIZE
 > 32

35 #”rÜ 
Inv®id
 
_TIME_BITS
 
v®ue
 (
ÿn
 
Úly
 
be
 32 
Ü
 64-
b™
)

	@/usr/include/gnu/stubs.h

6 #ià!
defšed
 
__x86_64__


7 
	~<gnu/¡ubs-32.h
>

9 #ià
defšed
 
__x86_64__
 && defšed 
__LP64__


10 
	~<gnu/¡ubs-64.h
>

12 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


13 
	~<gnu/¡ubs-x32.h
>

	@/usr/include/linux/byteorder/little_endian.h

2 #iâdeà
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


3 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

5 #iâdeà
__LITTLE_ENDIAN


6 
	#__LITTLE_ENDIAN
 1234

	)

8 #iâdeà
__LITTLE_ENDIAN_BITFIELD


9 
	#__LITTLE_ENDIAN_BITFIELD


	)

12 
	~<lšux/¡ddef.h
>

13 
	~<lšux/ty³s.h
>

14 
	~<lšux/swab.h
>

16 
	#__cÚ¡ªt_htÚl
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

17 
	#__cÚ¡ªt_Áohl
(
x
è
	`___cÚ¡ªt_swab32
((
__be32
)(x))

	)

18 
	#__cÚ¡ªt_htÚs
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

19 
	#__cÚ¡ªt_Áohs
(
x
è
	`___cÚ¡ªt_swab16
((
__be16
)(x))

	)

20 
	#__cÚ¡ªt_ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

21 
	#__cÚ¡ªt_Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

22 
	#__cÚ¡ªt_ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

23 
	#__cÚ¡ªt_Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

24 
	#__cÚ¡ªt_ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

25 
	#__cÚ¡ªt_Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

26 
	#__cÚ¡ªt_ıu_to_be64
(
x
è((
__be64
)
	`___cÚ¡ªt_swab64
((x)))

	)

27 
	#__cÚ¡ªt_be64_to_ıu
(
x
è
	`___cÚ¡ªt_swab64
((
__u64
)(
__be64
)(x))

	)

28 
	#__cÚ¡ªt_ıu_to_be32
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

29 
	#__cÚ¡ªt_be32_to_ıu
(
x
è
	`___cÚ¡ªt_swab32
((
__u32
)(
__be32
)(x))

	)

30 
	#__cÚ¡ªt_ıu_to_be16
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

31 
	#__cÚ¡ªt_be16_to_ıu
(
x
è
	`___cÚ¡ªt_swab16
((
__u16
)(
__be16
)(x))

	)

32 
	#__ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

33 
	#__Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

34 
	#__ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

35 
	#__Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

36 
	#__ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

37 
	#__Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

38 
	#__ıu_to_be64
(
x
è((
__be64
)
	`__swab64
((x)))

	)

39 
	#__be64_to_ıu
(
x
è
	`__swab64
((
__u64
)(
__be64
)(x))

	)

40 
	#__ıu_to_be32
(
x
è((
__be32
)
	`__swab32
((x)))

	)

41 
	#__be32_to_ıu
(
x
è
	`__swab32
((
__u32
)(
__be32
)(x))

	)

42 
	#__ıu_to_be16
(
x
è((
__be16
)
	`__swab16
((x)))

	)

43 
	#__be16_to_ıu
(
x
è
	`__swab16
((
__u16
)(
__be16
)(x))

	)

45 
__®ways_šlše
 
__Ë64
 
	$__ıu_to_Ë64p
(cÚ¡ 
__u64
 *
p
)

47  (
__Ë64
)*
p
;

48 
	}
}

49 
__®ways_šlše
 
__u64
 
	$__Ë64_to_ıup
(cÚ¡ 
__Ë64
 *
p
)

51  (
__u64
)*
p
;

52 
	}
}

53 
__®ways_šlše
 
__Ë32
 
	$__ıu_to_Ë32p
(cÚ¡ 
__u32
 *
p
)

55  (
__Ë32
)*
p
;

56 
	}
}

57 
__®ways_šlše
 
__u32
 
	$__Ë32_to_ıup
(cÚ¡ 
__Ë32
 *
p
)

59  (
__u32
)*
p
;

60 
	}
}

61 
__®ways_šlše
 
__Ë16
 
	$__ıu_to_Ë16p
(cÚ¡ 
__u16
 *
p
)

63  (
__Ë16
)*
p
;

64 
	}
}

65 
__®ways_šlše
 
__u16
 
	$__Ë16_to_ıup
(cÚ¡ 
__Ë16
 *
p
)

67  (
__u16
)*
p
;

68 
	}
}

69 
__®ways_šlše
 
__be64
 
	$__ıu_to_be64p
(cÚ¡ 
__u64
 *
p
)

71  (
__be64
)
	`__swab64p
(
p
);

72 
	}
}

73 
__®ways_šlše
 
__u64
 
	$__be64_to_ıup
(cÚ¡ 
__be64
 *
p
)

75  
	`__swab64p
((
__u64
 *)
p
);

76 
	}
}

77 
__®ways_šlše
 
__be32
 
	$__ıu_to_be32p
(cÚ¡ 
__u32
 *
p
)

79  (
__be32
)
	`__swab32p
(
p
);

80 
	}
}

81 
__®ways_šlše
 
__u32
 
	$__be32_to_ıup
(cÚ¡ 
__be32
 *
p
)

83  
	`__swab32p
((
__u32
 *)
p
);

84 
	}
}

85 
__®ways_šlše
 
__be16
 
	$__ıu_to_be16p
(cÚ¡ 
__u16
 *
p
)

87  (
__be16
)
	`__swab16p
(
p
);

88 
	}
}

89 
__®ways_šlše
 
__u16
 
	$__be16_to_ıup
(cÚ¡ 
__be16
 *
p
)

91  
	`__swab16p
((
__u16
 *)
p
);

92 
	}
}

93 
	#__ıu_to_Ë64s
(
x
èdØ{ ()(x); } 0)

	)

94 
	#__Ë64_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

95 
	#__ıu_to_Ë32s
(
x
èdØ{ ()(x); } 0)

	)

96 
	#__Ë32_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

97 
	#__ıu_to_Ë16s
(
x
èdØ{ ()(x); } 0)

	)

98 
	#__Ë16_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

99 
	#__ıu_to_be64s
(
x
è
	`__swab64s
((x))

	)

100 
	#__be64_to_ıus
(
x
è
	`__swab64s
((x))

	)

101 
	#__ıu_to_be32s
(
x
è
	`__swab32s
((x))

	)

102 
	#__be32_to_ıus
(
x
è
	`__swab32s
((x))

	)

103 
	#__ıu_to_be16s
(
x
è
	`__swab16s
((x))

	)

104 
	#__be16_to_ıus
(
x
è
	`__swab16s
((x))

	)

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

39 
	#__STDC_IEC_60559_BFP__
 201404L

	)

42 
	#__STDC_IEC_559__
 1

	)

43 
	#__STDC_IEC_60559_BFP__
 201404L

	)

46 #ifdeà
__GCC_IEC_559_COMPLEX


47 #ià
__GCC_IEC_559_COMPLEX
 > 0

48 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_60559_COMPLEX__
 201404L

	)

52 
	#__STDC_IEC_559_COMPLEX__
 1

	)

53 
	#__STDC_IEC_60559_COMPLEX__
 201404L

	)

62 
	#__STDC_ISO_10646__
 201706L

	)

	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


34 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

38 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

39 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

42 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

45 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`šdex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

50 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

53 #ià
defšed
 
__OPTIMIZE__


54 
__ex‹º_®ways_šlše
 *

55 
	`šdex
 (*
__s
, 
__c
è
__THROW


57  
	`__butš_šdex
 (
__s
, 
__c
);

60 
__ex‹º_®ways_šlše
 const *

61 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


63  
	`__butš_šdex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

69 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

73 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`ršdex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ià
defšed
 
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`ršdex
 (*
__s
, 
__c
è
__THROW


85  
	`__butš_ršdex
 (
__s
, 
__c
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


91  
	`__butš_ršdex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

101 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
è
__THROW
 
__©Œibu‹_cÚ¡__
;

109 #ifdef 
__USE_MISC


110 
	$ff¦
 (
__l
è
__THROW
 
__©Œibu‹_cÚ¡__
;

111 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

112 
__THROW
 
__©Œibu‹_cÚ¡__
;

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<b™s/ty³s/loÿË_t.h
>

128 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__loc
)

129 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

133 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

134 
size_t
 
__n
, 
loÿË_t
 
__loc
)

135 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

138 
__END_DECLS


140 #ià
	`__GNUC_PREREQ
 (3,4è&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
defšed
 
__fÜtify_funùiÚ


143 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


144 
	~<b™s/¡ršgs_fÜtif›d.h
>

	@/usr/include/sys/cdefs.h

19 #iâdef 
_SYS_CDEFS_H


20 
	#_SYS_CDEFS_H
 1

	)

23 #iâdeà
_FEATURES_H


24 
	~<ã©u»s.h
>

30 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


35 #undeà
__P


36 #undeà
__PMT


42 #ià(
defšed
 
__has_©Œibu‹
 \

43 && (!
defšed
 
	g__şªg_mšÜ__
 \

44 || 3 < 
	g__şªg_majÜ__
 + (5 <ğ
__şªg_mšÜ__
)))

45 
	#__glibc_has_©Œibu‹
(
©Œ
è
	`__has_©Œibu‹
 (©Œ)

	)

47 
	#__glibc_has_©Œibu‹
(
©Œ
è0

	)

49 #ifdeà
__has_butš


50 
	#__glibc_has_butš
(
Çme
è
	`__has_butš
 (Çme)

	)

52 
	#__glibc_has_butš
(
Çme
è0

	)

54 #ifdeà
__has_ex‹nsiÚ


55 
	#__glibc_has_ex‹nsiÚ
(
ext
è
	`__has_ex‹nsiÚ
 (ext)

	)

57 
	#__glibc_has_ex‹nsiÚ
(
ext
è0

	)

60 #ià
defšed
 
__GNUC__
 || defšed 
__şªg__


64 #ià
__GNUC_PREREQ
 (4, 6è&& !
defšed
 
_LIBC


65 
	#__LEAF
 , 
__Ëaf__


	)

66 
	#__LEAF_ATTR
 
	`__©Œibu‹__
 ((
__Ëaf__
))

	)

68 
	#__LEAF


	)

69 
	#__LEAF_ATTR


	)

77 #ià!
defšed
 
__ılu¥lus
 \

78 && (
__GNUC_PREREQ
 (3, 4è|| 
	$__glibc_has_©Œibu‹
 (
__nÙhrow__
))

79 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
))

	)

80 
	#__THROWNL
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

81 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
)è
	)
fct

82 
	#__NTHNL
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

84 #ià
defšed
 
__ılu¥lus
 && (
	`__GNUC_PREREQ
 (2,8è|| 
__şªg_majÜ
 >= 4)

85 #ià
__ılu¥lus
 >= 201103L

86 
	#__THROW
 
	`nÛxû±
 (
Œue
)

	)

88 
	#__THROW
 
	`throw
 ()

	)

90 
	#__THROWNL
 
__THROW


	)

91 
	#__NTH
(
fù
è
__LEAF_ATTR
 fù 
__THROW


	)

92 
	#__NTHNL
(
fù
èfù 
__THROW


	)

94 
	#__THROW


	)

95 
	#__THROWNL


	)

96 
	#__NTH
(
fù
è
	)
fct

97 
	#__NTHNL
(
fù
è
	)
fct

103 #ià(
defšed
 
__ılu¥lus
 \

104 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

105 
	#__šlše
 
šlše


	)

107 
	#__šlše


	)

110 
	#__THROW


	)

111 
	#__THROWNL


	)

112 
	#__NTH
(
fù
è
	)
fct

118 
	#__P
(
¬gs
è
	)
args

119 
	#__PMT
(
¬gs
è
	)
args

124 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

125 
	#__STRING
(
x
è#x

	)

128 
	#__±r_t
 *

	)

132 #ifdef 
__ılu¥lus


133 
	#__BEGIN_DECLS
 "C" {

	)

134 
	#__END_DECLS
 
	}

	)
}

136 
	#__BEGIN_DECLS


	)

137 
	#__END_DECLS


	)

142 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

143 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

146 #ià
__USE_FORTIFY_LEVEL
 =ğ3 && (
__glibc_şªg_´”eq
 (9, 0) \

147 || 
	$__GNUC_PREREQ
 (12, 0))

148 
	#__glibc_objsize0
(
__o
è
	`__butš_dyÇmic_objeù_size
 (__o, 0)

	)

149 
	#__glibc_objsize
(
__o
è
	`__butš_dyÇmic_objeù_size
 (__o, 1)

	)

151 
	#__glibc_objsize0
(
__o
è
	`__bos0
 (__o)

	)

152 
	#__glibc_objsize
(
__o
è
	`__bos
 (__o)

	)

159 
	#__glibc_§ã_Ën_cÚd
(
__l
, 
__s
, 
__osz
è((__lè<ğ(__oszè/ (__s))

	)

160 
	#__glibc_unsigÃd_Ü_pos™ive
(
__l
) \

161 ((
	`__ty³of
 (
__l
)) 0 < (__typeof (__l)) -1 \

162 || (
	`__butš_cÚ¡ªt_p
 (
__l
è&& (__lè> 0))

	)

167 
	#__glibc_§ã_Ü_unknown_Ën
(
__l
, 
__s
, 
__osz
) \

168 (
	`__glibc_unsigÃd_Ü_pos™ive
 (
__l
) \

169 && 
	`__butš_cÚ¡ªt_p
 (
	`__glibc_§ã_Ën_cÚd
 ((
__SIZE_TYPE__
è(
__l
), \

170 
__s
, 
__osz
)) \

171 && 
	`__glibc_§ã_Ën_cÚd
 ((
__SIZE_TYPE__
è(
__l
), 
__s
, 
__osz
))

	)

176 
	#__glibc_un§ã_Ën
(
__l
, 
__s
, 
__osz
) \

177 (
	`__glibc_unsigÃd_Ü_pos™ive
 (
__l
) \

178 && 
	`__butš_cÚ¡ªt_p
 (
	`__glibc_§ã_Ën_cÚd
 ((
__SIZE_TYPE__
è(
__l
), \

179 
__s
, 
__osz
)) \

180 && !
	`__glibc_§ã_Ën_cÚd
 ((
__SIZE_TYPE__
è(
__l
), 
__s
, 
__osz
))

	)

185 
	#__glibc_fÜtify
(
f
, 
__l
, 
__s
, 
__osz
, ...) \

186 (
	`__glibc_§ã_Ü_unknown_Ën
 (
__l
, 
__s
, 
__osz
) \

187 ? 
__
 ## 
f
 ## 
	`_®Ÿs
 (
__VA_ARGS__
) \

188 : (
	`__glibc_un§ã_Ën
 (
__l
, 
__s
, 
__osz
) \

189 ? 
__
 ## 
f
 ## 
	`_chk_w¬n
 (
__VA_ARGS__
, 
__osz
) \

190 : 
__
 ## 
f
 ## 
	`_chk
 (
__VA_ARGS__
, 
__osz
))) \

191 

	)

195 
	#__glibc_fÜtify_n
(
f
, 
__l
, 
__s
, 
__osz
, ...) \

196 (
	`__glibc_§ã_Ü_unknown_Ën
 (
__l
, 
__s
, 
__osz
) \

197 ? 
__
 ## 
f
 ## 
	`_®Ÿs
 (
__VA_ARGS__
) \

198 : (
	`__glibc_un§ã_Ën
 (
__l
, 
__s
, 
__osz
) \

199 ? 
__
 ## 
f
 ## 
	`_chk_w¬n
 (
__VA_ARGS__
, (
__osz
è/ (
__s
)) \

200 : 
__
 ## 
f
 ## 
	`_chk
 (
__VA_ARGS__
, (
__osz
è/ (
__s
)))) \

201 

	)

202 #ià
	`__GNUC_PREREQ
 (4,3)

203 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

204 
	#__”rÜdeş
(
Çme
, 
msg
) \

205 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

207 
	#__w¬Ç‰r
(
msg
)

	)

208 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

215 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >ğ199901L && !defšed 
__HP_cc


216 
	#__æex¬r
 []

	)

217 
	#__glibc_c99_æex¬r_avaabË
 1

	)

218 #–ià
	`__GNUC_PREREQ
 (2,97è|| 
defšed
 
__şªg__


221 
	#__æex¬r
 []

	)

222 
	#__glibc_c99_æex¬r_avaabË
 1

	)

223 #–ià
defšed
 
__GNUC__


226 
	#__æex¬r
 [0]

	)

227 
	#__glibc_c99_æex¬r_avaabË
 1

	)

230 
	#__æex¬r
 [1]

	)

231 
	#__glibc_c99_æex¬r_avaabË
 0

	)

245 #ià(
defšed
 
__GNUC__
 && __GNUC__ >ğ2è|| (
__şªg_majÜ__
 >= 4)

247 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

248 #ifdeà
__ılu¥lus


249 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

250 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

251 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

252 
Çme
 
´Ùo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

254 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

255 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

256 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

257 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROWNL


	)

259 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

260 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

273 #ià!(
defšed
 
__GNUC__
 || defšed 
__şªg__
)

274 
	#__©Œibu‹__
(
xyz
è

	)

280 #ià
	`__GNUC_PREREQ
 (2,96è|| 
	`__glibc_has_©Œibu‹
 (
__m®loc__
)

281 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

283 
	#__©Œibu‹_m®loc__


	)

288 #ià
	`__GNUC_PREREQ
 (4, 3)

289 
	#__©Œibu‹_®loc_size__
(
·¿ms
) \

290 
	`__©Œibu‹__
 ((
__®loc_size__
 
·¿ms
))

	)

292 
	#__©Œibu‹_®loc_size__
(
·¿ms
è

	)

297 #ià
	`__GNUC_PREREQ
 (4, 9è|| 
	`__glibc_has_©Œibu‹
 (
__®loc_®ign__
)

298 
	#__©Œibu‹_®loc_®ign__
(
·¿m
) \

299 
	`__©Œibu‹__
 ((
__®loc_®ign__
 
·¿m
))

	)

301 
	#__©Œibu‹_®loc_®ign__
(
·¿m
è

	)

307 #ià
	`__GNUC_PREREQ
 (2,96è|| 
	`__glibc_has_©Œibu‹
 (
__pu»__
)

308 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

310 
	#__©Œibu‹_pu»__


	)

314 #ià
	`__GNUC_PREREQ
 (2,5è|| 
	`__glibc_has_©Œibu‹
 (
__cÚ¡__
)

315 
	#__©Œibu‹_cÚ¡__
 
	`__©Œibu‹__
 ((
__cÚ¡__
))

	)

317 
	#__©Œibu‹_cÚ¡__


	)

320 #ià
	`__GNUC_PREREQ
 (2,7è|| 
	`__glibc_has_©Œibu‹
 (
__unu£d__
)

321 
	#__©Œibu‹_maybe_unu£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

323 
	#__©Œibu‹_maybe_unu£d__


	)

329 #ià
	`__GNUC_PREREQ
 (3,1è|| 
	`__glibc_has_©Œibu‹
 (
__u£d__
)

330 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

331 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

333 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

334 
	#__©Œibu‹_nošlše__


	)

338 #ià
	`__GNUC_PREREQ
 (3,2è|| 
	`__glibc_has_©Œibu‹
 (
__d•»ÿ‹d__
)

339 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

341 
	#__©Œibu‹_d•»ÿ‹d__


	)

347 #ià
	`__GNUC_PREREQ
 (4,5) \

348 || 
	$__glibc_has_ex‹nsiÚ
 (
__©Œibu‹_d•»ÿ‹d_w™h_mes§ge__
)

349 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
) \

350 
	`__©Œibu‹__
 ((
	`__d•»ÿ‹d__
 (
msg
)))

	)

352 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
è
__©Œibu‹_d•»ÿ‹d__


	)

361 #ià
	`__GNUC_PREREQ
 (2,8è|| 
	`__glibc_has_©Œibu‹
 (
__fÜm©_¬g__
)

362 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

364 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

371 #ià
	`__GNUC_PREREQ
 (2,97è|| 
	`__glibc_has_©Œibu‹
 (
__fÜm©__
)

372 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

373 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

375 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

382 #iâdeà
__©Œibu‹_nÚnuÎ__


383 #ià
	`__GNUC_PREREQ
 (3,3è|| 
	`__glibc_has_©Œibu‹
 (
__nÚnuÎ__
)

384 
	#__©Œibu‹_nÚnuÎ__
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

386 
	#__©Œibu‹_nÚnuÎ__
(
·¿ms
)

	)

389 #iâdeà
__nÚnuÎ


390 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹_nÚnuÎ__
 (·¿ms)

	)

395 #iâdeà
__»tuºs_nÚnuÎ


396 #ià
	`__GNUC_PREREQ
 (4, 9è|| 
	`__glibc_has_©Œibu‹
 (
__»tuºs_nÚnuÎ__
)

397 
	#__»tuºs_nÚnuÎ
 
	`__©Œibu‹__
 ((
__»tuºs_nÚnuÎ__
))

	)

399 
	#__»tuºs_nÚnuÎ


	)

405 #ià
	`__GNUC_PREREQ
 (3,4è|| 
	`__glibc_has_©Œibu‹
 (
__w¬n_unu£d_»suÉ__
)

406 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

407 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

408 #ià
defšed
 
__USE_FORTIFY_LEVEL
 && __USE_FORTIFY_LEVEL > 0

409 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

412 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

414 #iâdeà
__wur


415 
	#__wur


	)

419 #ià
	`__GNUC_PREREQ
 (3,2è|| 
	`__glibc_has_©Œibu‹
 (
__®ways_šlše__
)

423 #undeà
__®ways_šlše


424 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

426 #undeà
__®ways_šlše


427 
	#__®ways_šlše
 
__šlše


	)

432 #ià
	`__GNUC_PREREQ
 (4,3è|| 
	`__glibc_has_©Œibu‹
 (
__¬tificŸl__
)

433 
	#__©Œibu‹_¬tificŸl__
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

435 
	#__©Œibu‹_¬tificŸl__


	)

447 #ià(!
defšed
 
__ılu¥lus
 || 
	`__GNUC_PREREQ
 (4,3) \

448 || (
defšed
 
__şªg__
 && (defšed 
__GNUC_STDC_INLINE__
 \

449 || 
defšed
 
__GNUC_GNU_INLINE__
)))

450 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


451 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

452 
	#__ex‹º_®ways_šlše
 \

453 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

455 
	#__ex‹º_šlše
 
__šlše


	)

456 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

460 #ifdeà
__ex‹º_®ways_šlše


461 
	#__fÜtify_funùiÚ
 
__ex‹º_®ways_šlše
 
__©Œibu‹_¬tificŸl__


	)

466 #ià
	`__GNUC_PREREQ
 (4,3)

467 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

468 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

475 #ià!(
	`__GNUC_PREREQ
 (2,8è|| 
defšed
 
__şªg__
)

476 
	#__ex‹nsiÚ__


	)

482 #ià!(
	`__GNUC_PREREQ
 (2,92è|| 
__şªg_majÜ__
 >= 3)

483 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

484 
	#__»¡riù
 
»¡riù


	)

486 
	#__»¡riù


	)

494 #ià(
	`__GNUC_PREREQ
 (3,1è|| 
__şªg_majÜ__
 >ğ3è&& !
defšed
 
__ılu¥lus


495 
	#__»¡riù_¬r
 
__»¡riù


	)

497 #ifdeà
__GNUC__


498 
	#__»¡riù_¬r


	)

500 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

501 
	#__»¡riù_¬r
 
»¡riù


	)

504 
	#__»¡riù_¬r


	)

509 #ià(
__GNUC__
 >ğ3è|| 
	`__glibc_has_butš
 (
__butš_ex³ù
)

510 
	#__glibc_uÆik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 0)

	)

511 
	#__glibc_lik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 1)

	)

513 
	#__glibc_uÆik–y
(
cÚd
è(cÚd)

	)

514 
	#__glibc_lik–y
(
cÚd
è(cÚd)

	)

517 #ià(!
defšed
 
_NÜ‘uº
 \

518 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

519 && !(
	`__GNUC_PREREQ
 (4,7) \

520 || (3 < 
__şªg_majÜ__
 + (5 <ğ
__şªg_mšÜ__
))))

521 #ià
	`__GNUC_PREREQ
 (2,8)

522 
	#_NÜ‘uº
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

	)

524 
	#_NÜ‘uº


	)

528 #ià
	`__GNUC_PREREQ
 (8, 0)

532 
	#__©Œibu‹_nÚ¡ršg__
 
	`__©Œibu‹__
 ((
__nÚ¡ršg__
))

	)

534 
	#__©Œibu‹_nÚ¡ršg__


	)

538 #undeà
__©Œibu‹_cİy__


539 #ià
	`__GNUC_PREREQ
 (9, 0)

542 
	#__©Œibu‹_cİy__
(
¬g
è
	`__©Œibu‹__
 ((
	`__cİy__
 (¬g)))

	)

544 
	#__©Œibu‹_cİy__
(
¬g
)

	)

547 #ià(!
defšed
 
_Stic_as£¹
 && !defšed 
__ılu¥lus
 \

548 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

549 && (!(
	`__GNUC_PREREQ
 (4, 6è|| 
__şªg_majÜ__
 >= 4) \

550 || 
defšed
 
__STRICT_ANSI__
))

551 
	#_Stic_as£¹
(
ex´
, 
dŸgno¡ic
) \

552 (*
	`__Stic_as£¹_funùiÚ
 ()) \

553 [!! (¡ruù { 
__”rÜ_if_Ãg©ive
: (
ex´
è? 2 : -1; })]

	)

558 #iâdeà
__GNULIB_CDEFS


559 
	~<b™s/wÜdsize.h
>

560 
	~<b™s/lÚg-doubË.h
>

563 #ià
__LDOUBLE_REDIRECTS_TO_FLOAT128_ABI
 == 1

564 #ifdeà
__REDIRECT


567 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
è... 
unu£d__ldbl_»dœ


	)

568 
	#__LDBL_REDIR_DECL
(
Çme
) \

569 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__" #Çm"›“128"));

	)

572 
	#__LDBL_REDIR2_DECL
(
Çme
) \

573 
	`__ty³of
 (
__
##
Çme
) __##name \

574 
	`__asm
 (
	`__ASMNAME
 ("__" #Çm"›“128"));

	)

577 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è... 
unu£d__ldbl_»dœ1


	)

578 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

579 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

581 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

582 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

583 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

584 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__
##
®Ÿs
##
›“128
)

	)

587 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è... 
unu£d__»dœeù_ldbl


	)

588 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
è... 
unu£d__ldbl_»dœ_Áh


	)

591 
	`_Stic_as£¹
 (0, "IEEE 128-bits†ong double„equires„edirection onhis…latform");

593 #–ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


594 
	#__LDBL_COMPAT
 1

	)

595 #ifdeà
__REDIRECT


596 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

597 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

598 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

599 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

600 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

601 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

602 
	#__LDBL_REDIR2_DECL
(
Çme
) \

603 
	`__ty³of
 (
__
##
Çme
è__##Çm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl___" #Çme));

	)

604 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

605 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

606 
	#__LDBL_REDIR_DECL
(
Çme
) \

607 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

608 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

609 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

610 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

611 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

614 #ià(!
defšed
 
__LDBL_COMPAT
 && 
__LDOUBLE_REDIRECTS_TO_FLOAT128_ABI
 == 0) \

615 || !
defšed
 
__REDIRECT


616 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

617 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

618 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

619 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

620 
	#__LDBL_REDIR2_DECL
(
Çme
)

	)

621 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

622 #ifdeà
__REDIRECT


623 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

624 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

625 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

634 #ià
	`__GNUC_PREREQ
 (4,8è|| 
	`__glibc_şªg_´”eq
 (3,5)

635 
	#__glibc_maüo_w¬nšg1
(
mes§ge
è
	`_P¿gma
 (#mes§ge)

	)

636 
	#__glibc_maüo_w¬nšg
(
mes§ge
) \

637 
	`__glibc_maüo_w¬nšg1
 (
GCC
 
w¬nšg
 
mes§ge
)

	)

639 
	#__glibc_maüo_w¬nšg
(
msg
)

	)

649 #ià!
defšed
 
__ılu¥lus
 \

650 && (
	`__GNUC_PREREQ
 (4, 9) \

651 || 
	`__glibc_has_ex‹nsiÚ
 (
c_g’”ic_£ËùiÚs
) \

652 || (!
defšed
 
__GNUC__
 && defšed 
__STDC_VERSION__
 \

653 && 
__STDC_VERSION__
 >= 201112L))

654 
	#__HAVE_GENERIC_SELECTION
 1

	)

656 
	#__HAVE_GENERIC_SELECTION
 0

	)

659 #ià
	`__GNUC_PREREQ
 (10, 0)

665 
	#__©Œ_acûss
(
x
è
	`__©Œibu‹__
 ((
__acûss__
 x))

	)

670 #ià
__USE_FORTIFY_LEVEL
 == 3

671 
	#__fÜtif›d_©Œ_acûss
(
a
, 
o
, 
s
è
	`__©Œibu‹__
 ((
	`__acûss__
 (a, o)))

	)

673 
	#__fÜtif›d_©Œ_acûss
(
a
, 
o
, 
s
è
	`__©Œ_acûss
 (×, o, s))

	)

675 #ià
	`__GNUC_PREREQ
 (11, 0)

676 
	#__©Œ_acûss_nÚe
(
¬gno
è
	`__©Œibu‹__
 ((
	`__acûss__
 (
__nÚe__
,‡rgno)))

	)

678 
	#__©Œ_acûss_nÚe
(
¬gno
)

	)

681 
	#__fÜtif›d_©Œ_acûss
(
a
, 
o
, 
s
)

	)

682 
	#__©Œ_acûss
(
x
)

	)

683 
	#__©Œ_acûss_nÚe
(
¬gno
)

	)

686 #ià
	`__GNUC_PREREQ
 (11, 0)

689 
	#__©Œ_d—Îoc
(
d—Îoc
, 
¬gno
) \

690 
	`__©Œibu‹__
 ((
	`__m®loc__
 (
d—Îoc
, 
¬gno
)))

	)

691 
	#__©Œ_d—Îoc_ä“
 
	`__©Œ_d—Îoc
 (
__butš_ä“
, 1)

	)

693 
	#__©Œ_d—Îoc
(
d—Îoc
, 
¬gno
)

	)

694 
	#__©Œ_d—Îoc_ä“


	)

699 #ià
	`__GNUC_PREREQ
 (4, 1)

700 
	#__©Œibu‹_»tuºs_twiû__
 
	`__©Œibu‹__
 ((
__»tuºs_twiû__
))

	)

702 
	#__©Œibu‹_»tuºs_twiû__


	)

	@/usr/include/sys/types.h

22 #iâdef 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdef 
__USE_MISC


32 #iâdeà
__u_ch¬_defšed


33 
__u_ch¬
 
	tu_ch¬
;

34 
__u_shÜt
 
	tu_shÜt
;

35 
__u_št
 
	tu_št
;

36 
__u_lÚg
 
	tu_lÚg
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¬_defšed


	)

42 
__loff_t
 
	tloff_t
;

45 #iâdeà
__šo_t_defšed


46 #iâdeà
__USE_FILE_OFFSET64


47 
__šo_t
 
	tšo_t
;

49 
__šo64_t
 
	tšo_t
;

51 
	#__šo_t_defšed


	)

53 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


54 
__šo64_t
 
	tšo64_t
;

55 
	#__šo64_t_defšed


	)

58 #iâdeà
__dev_t_defšed


59 
__dev_t
 
	tdev_t
;

60 
	#__dev_t_defšed


	)

63 #iâdeà
__gid_t_defšed


64 
__gid_t
 
	tgid_t
;

65 
	#__gid_t_defšed


	)

68 #iâdeà
__mode_t_defšed


69 
__mode_t
 
	tmode_t
;

70 
	#__mode_t_defšed


	)

73 #iâdeà
__Æšk_t_defšed


74 
__Æšk_t
 
	tÆšk_t
;

75 
	#__Æšk_t_defšed


	)

78 #iâdeà
__uid_t_defšed


79 
__uid_t
 
	tuid_t
;

80 
	#__uid_t_defšed


	)

83 #iâdeà
__off_t_defšed


84 #iâdeà
__USE_FILE_OFFSET64


85 
__off_t
 
	toff_t
;

87 
__off64_t
 
	toff_t
;

89 
	#__off_t_defšed


	)

91 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


92 
__off64_t
 
	toff64_t
;

93 
	#__off64_t_defšed


	)

96 #iâdeà
__pid_t_defšed


97 
__pid_t
 
	tpid_t
;

98 
	#__pid_t_defšed


	)

101 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
) \

102 && !
defšed
 
__id_t_defšed


103 
__id_t
 
	tid_t
;

104 
	#__id_t_defšed


	)

107 #iâdeà
__ssize_t_defšed


108 
__ssize_t
 
	tssize_t
;

109 
	#__ssize_t_defšed


	)

112 #ifdef 
__USE_MISC


113 #iâdeà
__daddr_t_defšed


114 
__daddr_t
 
	tdaddr_t
;

115 
__ÿddr_t
 
	tÿddr_t
;

116 
	#__daddr_t_defšed


	)

120 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


121 
__key_t
 
	tkey_t
;

122 
	#__key_t_defšed


	)

125 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


126 
	~<b™s/ty³s/şock_t.h
>

128 
	~<b™s/ty³s/şockid_t.h
>

129 
	~<b™s/ty³s/time_t.h
>

130 
	~<b™s/ty³s/tim”_t.h
>

132 #ifdeà
__USE_XOPEN


133 #iâdeà
__u£cÚds_t_defšed


134 
__u£cÚds_t
 
	tu£cÚds_t
;

135 
	#__u£cÚds_t_defšed


	)

137 #iâdeà
__su£cÚds_t_defšed


138 
__su£cÚds_t
 
	tsu£cÚds_t
;

139 
	#__su£cÚds_t_defšed


	)

143 
	#__Ãed_size_t


	)

144 
	~<¡ddef.h
>

146 #ifdeà
__USE_MISC


148 
	tulÚg
;

149 
	tushÜt
;

150 
	tušt
;

155 
	~<b™s/¡dšt-šŠ.h
>

158 
__ušt8_t
 
	tu_št8_t
;

159 
__ušt16_t
 
	tu_št16_t
;

160 
__ušt32_t
 
	tu_št32_t
;

161 
__ušt64_t
 
	tu_št64_t
;

163 #ià
__GNUC_PREREQ
 (2, 7)

164 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

166 
	t»gi¡”_t
;

171 
	#__BIT_TYPES_DEFINED__
 1

	)

174 #ifdef 
__USE_MISC


176 
	~<’dŸn.h
>

179 
	~<sys/£Ëù.h
>

183 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
) \

184 && !
defšed
 
__blksize_t_defšed


185 
__blksize_t
 
	tblksize_t
;

186 
	#__blksize_t_defšed


	)

190 #iâdeà
__USE_FILE_OFFSET64


191 #iâdeà
__blkút_t_defšed


192 
__blkút_t
 
	tblkút_t
;

193 
	#__blkút_t_defšed


	)

195 #iâdeà
__fsblkút_t_defšed


196 
__fsblkút_t
 
	tfsblkút_t
;

197 
	#__fsblkút_t_defšed


	)

199 #iâdeà
__fsfút_t_defšed


200 
__fsfút_t
 
	tfsfút_t
;

201 
	#__fsfút_t_defšed


	)

204 #iâdeà
__blkút_t_defšed


205 
__blkút64_t
 
	tblkút_t
;

206 
	#__blkút_t_defšed


	)

208 #iâdeà
__fsblkút_t_defšed


209 
__fsblkút64_t
 
	tfsblkút_t
;

210 
	#__fsblkút_t_defšed


	)

212 #iâdeà
__fsfút_t_defšed


213 
__fsfút64_t
 
	tfsfút_t
;

214 
	#__fsfút_t_defšed


	)

218 #ifdeà
__USE_LARGEFILE64


219 
__blkút64_t
 
	tblkút64_t
;

220 
__fsblkút64_t
 
	tfsblkút64_t
;

221 
__fsfút64_t
 
	tfsfút64_t
;

226 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


227 
	~<b™s/±h»adty³s.h
>

230 
	g__END_DECLS


	@/usr/include/asm-generic/errno-base.h

2 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


3 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

5 
	#EPERM
 1

	)

6 
	#ENOENT
 2

	)

7 
	#ESRCH
 3

	)

8 
	#EINTR
 4

	)

9 
	#EIO
 5

	)

10 
	#ENXIO
 6

	)

11 
	#E2BIG
 7

	)

12 
	#ENOEXEC
 8

	)

13 
	#EBADF
 9

	)

14 
	#ECHILD
 10

	)

15 
	#EAGAIN
 11

	)

16 
	#ENOMEM
 12

	)

17 
	#EACCES
 13

	)

18 
	#EFAULT
 14

	)

19 
	#ENOTBLK
 15

	)

20 
	#EBUSY
 16

	)

21 
	#EEXIST
 17

	)

22 
	#EXDEV
 18

	)

23 
	#ENODEV
 19

	)

24 
	#ENOTDIR
 20

	)

25 
	#EISDIR
 21

	)

26 
	#EINVAL
 22

	)

27 
	#ENFILE
 23

	)

28 
	#EMFILE
 24

	)

29 
	#ENOTTY
 25

	)

30 
	#ETXTBSY
 26

	)

31 
	#EFBIG
 27

	)

32 
	#ENOSPC
 28

	)

33 
	#ESPIPE
 29

	)

34 
	#EROFS
 30

	)

35 
	#EMLINK
 31

	)

36 
	#EPIPE
 32

	)

37 
	#EDOM
 33

	)

38 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/int-ll64.h

9 #iâdeà
_ASM_GENERIC_INT_LL64_H


10 
	#_ASM_GENERIC_INT_LL64_H


	)

12 
	~<asm/b™¥”lÚg.h
>

14 #iâdeà
__ASSEMBLY__


20 
__sigÃd__
 
	t__s8
;

21 
	t__u8
;

23 
__sigÃd__
 
	t__s16
;

24 
	t__u16
;

26 
__sigÃd__
 
	t__s32
;

27 
	t__u32
;

29 #ifdeà
__GNUC__


30 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

31 
__ex‹nsiÚ__
 
	t__u64
;

33 
__sigÃd__
 
	t__s64
;

34 
	t__u64
;

	@/usr/include/asm-generic/ioctl.h

2 #iâdeà
_ASM_GENERIC_IOCTL_H


3 
	#_ASM_GENERIC_IOCTL_H


	)

23 
	#_IOC_NRBITS
 8

	)

24 
	#_IOC_TYPEBITS
 8

	)

31 #iâdeà
_IOC_SIZEBITS


32 
	#_IOC_SIZEBITS
 14

	)

35 #iâdeà
_IOC_DIRBITS


36 
	#_IOC_DIRBITS
 2

	)

39 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

40 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

41 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

42 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

44 
	#_IOC_NRSHIFT
 0

	)

45 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

46 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

47 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

57 #iâdeà
_IOC_NONE


58 
	#_IOC_NONE
 0U

	)

61 #iâdeà
_IOC_WRITE


62 
	#_IOC_WRITE
 1U

	)

65 #iâdeà
_IOC_READ


66 
	#_IOC_READ
 2U

	)

69 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

70 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

71 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

72 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

73 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

75 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

83 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

84 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

85 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

86 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

87 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

88 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

89 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

92 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

93 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

94 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

95 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

99 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

100 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

101 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

102 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

103 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm-generic/socket.h

2 #iâdeà
__ASM_GENERIC_SOCKET_H


3 
	#__ASM_GENERIC_SOCKET_H


	)

5 
	~<lšux/posix_ty³s.h
>

6 
	~<asm/sockios.h
>

9 
	#SOL_SOCKET
 1

	)

11 
	#SO_DEBUG
 1

	)

12 
	#SO_REUSEADDR
 2

	)

13 
	#SO_TYPE
 3

	)

14 
	#SO_ERROR
 4

	)

15 
	#SO_DONTROUTE
 5

	)

16 
	#SO_BROADCAST
 6

	)

17 
	#SO_SNDBUF
 7

	)

18 
	#SO_RCVBUF
 8

	)

19 
	#SO_SNDBUFFORCE
 32

	)

20 
	#SO_RCVBUFFORCE
 33

	)

21 
	#SO_KEEPALIVE
 9

	)

22 
	#SO_OOBINLINE
 10

	)

23 
	#SO_NO_CHECK
 11

	)

24 
	#SO_PRIORITY
 12

	)

25 
	#SO_LINGER
 13

	)

26 
	#SO_BSDCOMPAT
 14

	)

27 
	#SO_REUSEPORT
 15

	)

28 #iâdeà
SO_PASSCRED


29 
	#SO_PASSCRED
 16

	)

30 
	#SO_PEERCRED
 17

	)

31 
	#SO_RCVLOWAT
 18

	)

32 
	#SO_SNDLOWAT
 19

	)

33 
	#SO_RCVTIMEO_OLD
 20

	)

34 
	#SO_SNDTIMEO_OLD
 21

	)

38 
	#SO_SECURITY_AUTHENTICATION
 22

	)

39 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

40 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

42 
	#SO_BINDTODEVICE
 25

	)

45 
	#SO_ATTACH_FILTER
 26

	)

46 
	#SO_DETACH_FILTER
 27

	)

47 
	#SO_GET_FILTER
 
SO_ATTACH_FILTER


	)

49 
	#SO_PEERNAME
 28

	)

51 
	#SO_ACCEPTCONN
 30

	)

53 
	#SO_PEERSEC
 31

	)

54 
	#SO_PASSSEC
 34

	)

56 
	#SO_MARK
 36

	)

58 
	#SO_PROTOCOL
 38

	)

59 
	#SO_DOMAIN
 39

	)

61 
	#SO_RXQ_OVFL
 40

	)

63 
	#SO_WIFI_STATUS
 41

	)

64 
	#SCM_WIFI_STATUS
 
SO_WIFI_STATUS


	)

65 
	#SO_PEEK_OFF
 42

	)

68 
	#SO_NOFCS
 43

	)

70 
	#SO_LOCK_FILTER
 44

	)

72 
	#SO_SELECT_ERR_QUEUE
 45

	)

74 
	#SO_BUSY_POLL
 46

	)

76 
	#SO_MAX_PACING_RATE
 47

	)

78 
	#SO_BPF_EXTENSIONS
 48

	)

80 
	#SO_INCOMING_CPU
 49

	)

82 
	#SO_ATTACH_BPF
 50

	)

83 
	#SO_DETACH_BPF
 
SO_DETACH_FILTER


	)

85 
	#SO_ATTACH_REUSEPORT_CBPF
 51

	)

86 
	#SO_ATTACH_REUSEPORT_EBPF
 52

	)

88 
	#SO_CNX_ADVICE
 53

	)

90 
	#SCM_TIMESTAMPING_OPT_STATS
 54

	)

92 
	#SO_MEMINFO
 55

	)

94 
	#SO_INCOMING_NAPI_ID
 56

	)

96 
	#SO_COOKIE
 57

	)

98 
	#SCM_TIMESTAMPING_PKTINFO
 58

	)

100 
	#SO_PEERGROUPS
 59

	)

102 
	#SO_ZEROCOPY
 60

	)

104 
	#SO_TXTIME
 61

	)

105 
	#SCM_TXTIME
 
SO_TXTIME


	)

107 
	#SO_BINDTOIFINDEX
 62

	)

109 
	#SO_TIMESTAMP_OLD
 29

	)

110 
	#SO_TIMESTAMPNS_OLD
 35

	)

111 
	#SO_TIMESTAMPING_OLD
 37

	)

113 
	#SO_TIMESTAMP_NEW
 63

	)

114 
	#SO_TIMESTAMPNS_NEW
 64

	)

115 
	#SO_TIMESTAMPING_NEW
 65

	)

117 
	#SO_RCVTIMEO_NEW
 66

	)

118 
	#SO_SNDTIMEO_NEW
 67

	)

120 
	#SO_DETACH_REUSEPORT_BPF
 68

	)

122 
	#SO_PREFER_BUSY_POLL
 69

	)

123 
	#SO_BUSY_POLL_BUDGET
 70

	)

125 
	#SO_NETNS_COOKIE
 71

	)

127 
	#SO_BUF_LOCK
 72

	)

130 #ià
__BITS_PER_LONG
 =ğ64 || (
defšed
(
__x86_64__
è&& defšed(
__ILP32__
))

132 
	#SO_TIMESTAMP
 
SO_TIMESTAMP_OLD


	)

133 
	#SO_TIMESTAMPNS
 
SO_TIMESTAMPNS_OLD


	)

134 
	#SO_TIMESTAMPING
 
SO_TIMESTAMPING_OLD


	)

136 
	#SO_RCVTIMEO
 
SO_RCVTIMEO_OLD


	)

137 
	#SO_SNDTIMEO
 
SO_SNDTIMEO_OLD


	)

139 
	#SO_TIMESTAMP
 ((
time_t
è=ğ(
__k”Ãl_lÚg_t
è? 
SO_TIMESTAMP_OLD
 : 
SO_TIMESTAMP_NEW
)

	)

140 
	#SO_TIMESTAMPNS
 ((
time_t
è=ğ(
__k”Ãl_lÚg_t
è? 
SO_TIMESTAMPNS_OLD
 : 
SO_TIMESTAMPNS_NEW
)

	)

141 
	#SO_TIMESTAMPING
 ((
time_t
è=ğ(
__k”Ãl_lÚg_t
è? 
SO_TIMESTAMPING_OLD
 : 
SO_TIMESTAMPING_NEW
)

	)

143 
	#SO_RCVTIMEO
 ((
time_t
è=ğ(
__k”Ãl_lÚg_t
è? 
SO_RCVTIMEO_OLD
 : 
SO_RCVTIMEO_NEW
)

	)

144 
	#SO_SNDTIMEO
 ((
time_t
è=ğ(
__k”Ãl_lÚg_t
è? 
SO_SNDTIMEO_OLD
 : 
SO_SNDTIMEO_NEW
)

	)

147 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

148 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

149 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

	@/usr/include/asm/posix_types_32.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_32_H


3 
	#_ASM_X86_POSIX_TYPES_32_H


	)

11 
	t__k”Ãl_mode_t
;

12 
	#__k”Ãl_mode_t
 
__k”Ãl_mode_t


	)

14 
	t__k”Ãl_c_pid_t
;

15 
	#__k”Ãl_c_pid_t
 
__k”Ãl_c_pid_t


	)

17 
	t__k”Ãl_uid_t
;

18 
	t__k”Ãl_gid_t
;

19 
	#__k”Ãl_uid_t
 
__k”Ãl_uid_t


	)

21 
	t__k”Ãl_Şd_dev_t
;

22 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

24 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_64.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_64_H


3 
	#_ASM_X86_POSIX_TYPES_64_H


	)

11 
	t__k”Ãl_Şd_uid_t
;

12 
	t__k”Ãl_Şd_gid_t
;

13 
	#__k”Ãl_Şd_uid_t
 
__k”Ãl_Şd_uid_t


	)

15 
	t__k”Ãl_Şd_dev_t
;

16 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

18 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_x32.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_X32_H


3 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

14 
	t__k”Ãl_lÚg_t
;

15 
	t__k”Ãl_ulÚg_t
;

16 
	#__k”Ãl_lÚg_t
 
__k”Ãl_lÚg_t


	)

18 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/bits/long-double.h

21 
	#__LDOUBLE_REDIRECTS_TO_FLOAT128_ABI
 0

	)

	@/usr/include/bits/pthreadtypes.h

19 #iâdeà
_BITS_PTHREADTYPES_COMMON_H


20 
	#_BITS_PTHREADTYPES_COMMON_H
 1

	)

23 
	~<b™s/th»ad-sh¬ed-ty³s.h
>

27 
	t±h»ad_t
;

34 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

35 
	m__®ign
;

36 } 
	t±h»ad_mu‹x©Œ_t
;

43 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

44 
	m__®ign
;

45 } 
	t±h»ad_cÚd©Œ_t
;

49 
	t±h»ad_key_t
;

53 
	t__ONCE_ALIGNMENT
 
	t±h»ad_Úû_t
;

56 
	u±h»ad_©Œ_t


58 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

59 
	m__®ign
;

61 #iâdeà
__have_±h»ad_©Œ_t


62 
±h»ad_©Œ_t
 
	t±h»ad_©Œ_t
;

63 
	#__have_±h»ad_©Œ_t
 1

	)

69 
__±h»ad_mu‹x_s
 
	m__d©a
;

70 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

71 
	m__®ign
;

72 } 
	t±h»ad_mu‹x_t
;

77 
__±h»ad_cÚd_s
 
	m__d©a
;

78 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

79 
__ex‹nsiÚ__
 
	m__®ign
;

80 } 
	t±h»ad_cÚd_t
;

83 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


88 
__±h»ad_rwlock_¬ch_t
 
	m__d©a
;

89 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

90 
	m__®ign
;

91 } 
	t±h»ad_rwlock_t
;

95 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

96 
	m__®ign
;

97 } 
	t±h»ad_rwlock©Œ_t
;

101 #ifdeà
__USE_XOPEN2K


103 vŞ©
	t±h»ad_¥šlock_t
;

110 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

111 
	m__®ign
;

112 } 
	t±h»ad_b¬r›r_t
;

116 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

117 
	m__®ign
;

118 } 
	t±h»ad_b¬r›¿‰r_t
;

	@/usr/include/bits/stdint-intn.h

19 #iâdeà
_BITS_STDINT_INTN_H


20 
	#_BITS_STDINT_INTN_H
 1

	)

22 
	~<b™s/ty³s.h
>

24 
__št8_t
 
	tšt8_t
;

25 
__št16_t
 
	tšt16_t
;

26 
__št32_t
 
	tšt32_t
;

27 
__št64_t
 
	tšt64_t
;

	@/usr/include/bits/strings_fortified.h

19 #iâdeà
__STRINGS_FORTIFIED


20 
	#__STRINGS_FORTIFIED
 1

	)

22 
__fÜtify_funùiÚ
 

23 
__NTH
 (
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__Ën
))

25 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
,

26 
	`__glibc_objsize0
 (
__de¡
));

27 
	}
}

29 
__fÜtify_funùiÚ
 

30 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

32 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
,

33 
	`__glibc_objsize0
 (
__de¡
));

34 
	}
}

	@/usr/include/bits/timesize.h

19 
	~<b™s/wÜdsize.h
>

21 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


23 
	#__TIMESIZE
 64

	)

26 
	#__TIMESIZE
 
__WORDSIZE


	)

	@/usr/include/bits/types.h

23 #iâdef 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wÜdsize.h
>

28 
	~<b™s/timesize.h
>

31 
	t__u_ch¬
;

32 
	t__u_shÜt
;

33 
	t__u_št
;

34 
	t__u_lÚg
;

37 sigÃd 
	t__št8_t
;

38 
	t__ušt8_t
;

39 sigÃd 
	t__št16_t
;

40 
	t__ušt16_t
;

41 sigÃd 
	t__št32_t
;

42 
	t__ušt32_t
;

43 #ià
__WORDSIZE
 == 64

44 sigÃd 
	t__št64_t
;

45 
	t__ušt64_t
;

47 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

48 
__ex‹nsiÚ__
 
	t__ušt64_t
;

52 
__št8_t
 
	t__št_Ëa¡8_t
;

53 
__ušt8_t
 
	t__ušt_Ëa¡8_t
;

54 
__št16_t
 
	t__št_Ëa¡16_t
;

55 
__ušt16_t
 
	t__ušt_Ëa¡16_t
;

56 
__št32_t
 
	t__št_Ëa¡32_t
;

57 
__ušt32_t
 
	t__ušt_Ëa¡32_t
;

58 
__št64_t
 
	t__št_Ëa¡64_t
;

59 
__ušt64_t
 
	t__ušt_Ëa¡64_t
;

62 #ià
__WORDSIZE
 == 64

63 
	t__quad_t
;

64 
	t__u_quad_t
;

66 
__ex‹nsiÚ__
 
	t__quad_t
;

67 
__ex‹nsiÚ__
 
	t__u_quad_t
;

71 #ià
__WORDSIZE
 == 64

72 
	t__štmax_t
;

73 
	t__uštmax_t
;

75 
__ex‹nsiÚ__
 
	t__štmax_t
;

76 
__ex‹nsiÚ__
 
	t__uštmax_t
;

109 
	#__S16_TYPE
 

	)

110 
	#__U16_TYPE
 

	)

111 
	#__S32_TYPE
 

	)

112 
	#__U32_TYPE
 

	)

113 
	#__SLONGWORD_TYPE
 

	)

114 
	#__ULONGWORD_TYPE
 

	)

115 #ià
__WORDSIZE
 == 32

116 
	#__SQUAD_TYPE
 
__št64_t


	)

117 
	#__UQUAD_TYPE
 
__ušt64_t


	)

118 
	#__SWORD_TYPE
 

	)

119 
	#__UWORD_TYPE
 

	)

120 
	#__SLONG32_TYPE
 

	)

121 
	#__ULONG32_TYPE
 

	)

122 
	#__S64_TYPE
 
__št64_t


	)

123 
	#__U64_TYPE
 
__ušt64_t


	)

126 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

127 #–ià
__WORDSIZE
 == 64

128 
	t__SQUAD_TYPE
 

	)

129 
	t__UQUAD_TYPE
 

	)

130 
	t__SWORD_TYPE
 

	)

131 
	t__UWORD_TYPE
 

	)

132 
	t__SLONG32_TYPE
 

	)

133 
	t__ULONG32_TYPE
 

	)

134 
	t__S64_TYPE
 

	)

135 
	t__U64_TYPE
 

	)

137 
	t__STD_TYPE
 

	)

141 
	~<b™s/ty³sizes.h
>

142 
	~<b™s/time64.h
>

145 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

146 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

147 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

148 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

149 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

150 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

151 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

152 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

153 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

154 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

155 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

156 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

157 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

158 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

159 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

160 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

161 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

162 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

163 
__STD_TYPE
 
__SUSECONDS64_T_TYPE
 
	g__su£cÚds64_t
;

165 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

166 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

169 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

172 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

175 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

180 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

181 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

184 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

185 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

188 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

189 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

192 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fswÜd_t
;

194 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

197 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysÿÎ_¦Úg_t
;

199 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysÿÎ_ulÚg_t
;

203 
__off64_t
 
	t__loff_t
;

204 *
	t__ÿddr_t
;

207 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

210 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

215 
	t__sig_©omic_t
;

220 #ià
__TIMESIZE
 =ğ64 && 
defšed
 
__LIBC


221 
	#__time64_t
 
__time_t


	)

222 #–ià
__TIMESIZE
 != 64

223 
__STD_TYPE
 
__TIME64_T_TYPE
 
	g__time64_t
;

226 #undeà
__STD_TYPE


	@/usr/include/bits/types/__locale_t.h

19 #iâdeà
_BITS_TYPES___LOCALE_T_H


20 
	#_BITS_TYPES___LOCALE_T_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

41 
__loÿË_¡ruù
 *
	t__loÿË_t
;

	@/usr/include/bits/types/clock_t.h

1 #iâdeà
__şock_t_defšed


2 
	#__şock_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şock_t
 
	tşock_t
;

	@/usr/include/bits/types/clockid_t.h

1 #iâdeà
__şockid_t_defšed


2 
	#__şockid_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şockid_t
 
	tşockid_t
;

	@/usr/include/bits/types/timer_t.h

1 #iâdeà
__tim”_t_defšed


2 
	#__tim”_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__tim”_t
 
	ttim”_t
;

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__
 && !defšed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

7 
	#__WORDSIZE32_SIZE_ULONG
 0

	)

8 
	#__WORDSIZE32_PTRDIFF_LONG
 0

	)

11 #ifdeà
__x86_64__


12 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

14 
	#__SYSCALL_WORDSIZE
 64

	)

16 
	#__WORDSIZE_TIME64_COMPAT32
 0

	)

	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

24 
	~<b™s/’dŸn.h
>

26 #ifdeà
__USE_MISC


27 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

28 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

29 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

30 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

33 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


35 
	~<b™s/by‹sw­.h
>

36 
	~<b™s/ušŠ-id’t™y.h
>

38 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


39 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

40 
	#htŞe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

41 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

42 
	#Ë16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

44 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

45 
	#htŞe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

46 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

47 
	#Ë32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

49 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

50 
	#htŞe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

51 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

52 
	#Ë64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

55 
	#htobe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

56 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

57 
	#be16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

58 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

60 
	#htobe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

61 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

62 
	#be32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

63 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

65 
	#htobe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

66 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

67 
	#be64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

68 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_chæags


	)

11 
	#__¡ub_fchæags


	)

12 
	#__¡ub_g‰y


	)

13 
	#__¡ub_»voke


	)

14 
	#__¡ub_£ogš


	)

15 
	#__¡ub_sig»tuº


	)

16 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_fchæags


	)

13 
	#__¡ub_g‰y


	)

14 
	#__¡ub_»voke


	)

15 
	#__¡ub_£ogš


	)

16 
	#__¡ub_sig»tuº


	)

17 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-x32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub___com·t_ü—‹_moduË


	)

12 
	#__¡ub___com·t_g‘_k”Ãl_syms


	)

13 
	#__¡ub___com·t_nfs£rvùl


	)

14 
	#__¡ub___com·t_qu”y_moduË


	)

15 
	#__¡ub___com·t_u£lib


	)

16 
	#__¡ub_chæags


	)

17 
	#__¡ub_fchæags


	)

18 
	#__¡ub_g‰y


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_¡ty


	)

	@/usr/include/linux/swab.h

2 #iâdeà
_LINUX_SWAB_H


3 
	#_LINUX_SWAB_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/¡ddef.h
>

7 
	~<asm/b™¥”lÚg.h
>

8 
	~<asm/swab.h
>

14 
	#___cÚ¡ªt_swab16
(
x
è((
__u16
)( \

15 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

16 (((
__u16
)(
x
è& (__u16)0xff00Uè>> 8)))

	)

18 
	#___cÚ¡ªt_swab32
(
x
è((
__u32
)( \

19 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

20 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

21 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

22 (((
__u32
)(
x
è& (__u32)0xff000000ULè>> 24)))

	)

24 
	#___cÚ¡ªt_swab64
(
x
è((
__u64
)( \

25 (((
__u64
)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

26 (((
__u64
)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

27 (((
__u64
)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

28 (((
__u64
)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

29 (((
__u64
)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

30 (((
__u64
)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

31 (((
__u64
)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

32 (((
__u64
)(
x
è& (__u64)0xff00000000000000ULLè>> 56)))

	)

34 
	#___cÚ¡ªt_swahw32
(
x
è((
__u32
)( \

35 (((
__u32
)(
x
) & (__u32)0x0000ffffUL) << 16) | \

36 (((
__u32
)(
x
è& (__u32)0xffff0000ULè>> 16)))

	)

38 
	#___cÚ¡ªt_swahb32
(
x
è((
__u32
)( \

39 (((
__u32
)(
x
) & (__u32)0x00ff00ffUL) << 8) | \

40 (((
__u32
)(
x
è& (__u32)0xff00ff00ULè>> 8)))

	)

48 
__šlše__
 
__u16
 
	$__fswab16
(
__u16
 
v®
)

50 #ià
	`defšed
 (
__¬ch_swab16
)

51  
	`__¬ch_swab16
(
v®
);

53  
	`___cÚ¡ªt_swab16
(
v®
);

55 
	}
}

57 
__šlše__
 
__u32
 
	$__fswab32
(
__u32
 
v®
)

59 #ià
	`defšed
(
__¬ch_swab32
)

60  
	`__¬ch_swab32
(
v®
);

62  
	`___cÚ¡ªt_swab32
(
v®
);

64 
	}
}

66 
__šlše__
 
__u64
 
	$__fswab64
(
__u64
 
v®
)

68 #ià
	`defšed
 (
__¬ch_swab64
)

69  
	`__¬ch_swab64
(
v®
);

70 #–ià
	`defšed
(
__SWAB_64_THRU_32__
)

71 
__u32
 
h
 = 
v®
 >> 32;

72 
__u32
 
l
 = 
v®
 & ((1ULL << 32) - 1);

73  (((
__u64
)
	`__fswab32
(
l
)è<< 32è| ((__u64)(__fswab32(
h
)));

75  
	`___cÚ¡ªt_swab64
(
v®
);

77 
	}
}

79 
__šlše__
 
__u32
 
	$__fswahw32
(
__u32
 
v®
)

81 #ifdeà
__¬ch_swahw32


82  
	`__¬ch_swahw32
(
v®
);

84  
	`___cÚ¡ªt_swahw32
(
v®
);

86 
	}
}

88 
__šlše__
 
__u32
 
	$__fswahb32
(
__u32
 
v®
)

90 #ifdeà
__¬ch_swahb32


91  
	`__¬ch_swahb32
(
v®
);

93  
	`___cÚ¡ªt_swahb32
(
v®
);

95 
	}
}

101 #ifdeà
__HAVE_BUILTIN_BSWAP16__


102 
	#__swab16
(
x
è(
__u16
)
	`__butš_bsw­16
((__u16)(x))

	)

104 
	#__swab16
(
x
) \

105 (
	`__butš_cÚ¡ªt_p
((
__u16
)(
x
)) ? \

106 
	`___cÚ¡ªt_swab16
(
x
) : \

107 
	`__fswab16
(
x
))

	)

114 #ifdeà
__HAVE_BUILTIN_BSWAP32__


115 
	#__swab32
(
x
è(
__u32
)
	`__butš_bsw­32
((__u32)(x))

	)

117 
	#__swab32
(
x
) \

118 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

119 
	`___cÚ¡ªt_swab32
(
x
) : \

120 
	`__fswab32
(
x
))

	)

127 #ifdeà
__HAVE_BUILTIN_BSWAP64__


128 
	#__swab64
(
x
è(
__u64
)
	`__butš_bsw­64
((__u64)(x))

	)

130 
	#__swab64
(
x
) \

131 (
	`__butš_cÚ¡ªt_p
((
__u64
)(
x
)) ? \

132 
	`___cÚ¡ªt_swab64
(
x
) : \

133 
	`__fswab64
(
x
))

	)

136 
__®ways_šlše
 
	$__swab
(cÚ¡ 
y
)

138 #ià
__BITS_PER_LONG
 == 64

139  
	`__swab64
(
y
);

141  
	`__swab32
(
y
);

143 
	}
}

151 
	#__swahw32
(
x
) \

152 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

153 
	`___cÚ¡ªt_swahw32
(
x
) : \

154 
	`__fswahw32
(
x
))

	)

162 
	#__swahb32
(
x
) \

163 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

164 
	`___cÚ¡ªt_swahb32
(
x
) : \

165 
	`__fswahb32
(
x
))

	)

171 
__®ways_šlše
 
__u16
 
	$__swab16p
(cÚ¡ 
__u16
 *
p
)

173 #ifdeà
__¬ch_swab16p


174  
	`__¬ch_swab16p
(
p
);

176  
	`__swab16
(*
p
);

178 
	}
}

184 
__®ways_šlše
 
__u32
 
	$__swab32p
(cÚ¡ 
__u32
 *
p
)

186 #ifdeà
__¬ch_swab32p


187  
	`__¬ch_swab32p
(
p
);

189  
	`__swab32
(*
p
);

191 
	}
}

197 
__®ways_šlše
 
__u64
 
	$__swab64p
(cÚ¡ 
__u64
 *
p
)

199 #ifdeà
__¬ch_swab64p


200  
	`__¬ch_swab64p
(
p
);

202  
	`__swab64
(*
p
);

204 
	}
}

212 
__šlše__
 
__u32
 
	$__swahw32p
(cÚ¡ 
__u32
 *
p
)

214 #ifdeà
__¬ch_swahw32p


215  
	`__¬ch_swahw32p
(
p
);

217  
	`__swahw32
(*
p
);

219 
	}
}

227 
__šlše__
 
__u32
 
	$__swahb32p
(cÚ¡ 
__u32
 *
p
)

229 #ifdeà
__¬ch_swahb32p


230  
	`__¬ch_swahb32p
(
p
);

232  
	`__swahb32
(*
p
);

234 
	}
}

240 
__šlše__
 
	$__swab16s
(
__u16
 *
p
)

242 #ifdeà
__¬ch_swab16s


243 
	`__¬ch_swab16s
(
p
);

245 *
p
 = 
	`__swab16p
(p);

247 
	}
}

252 
__®ways_šlše
 
	$__swab32s
(
__u32
 *
p
)

254 #ifdeà
__¬ch_swab32s


255 
	`__¬ch_swab32s
(
p
);

257 *
p
 = 
	`__swab32p
(p);

259 
	}
}

265 
__®ways_šlše
 
	$__swab64s
(
__u64
 *
p
)

267 #ifdeà
__¬ch_swab64s


268 
	`__¬ch_swab64s
(
p
);

270 *
p
 = 
	`__swab64p
(p);

272 
	}
}

280 
__šlše__
 
	$__swahw32s
(
__u32
 *
p
)

282 #ifdeà
__¬ch_swahw32s


283 
	`__¬ch_swahw32s
(
p
);

285 *
p
 = 
	`__swahw32p
(p);

287 
	}
}

295 
__šlše__
 
	$__swahb32s
(
__u32
 *
p
)

297 #ifdeà
__¬ch_swahb32s


298 
	`__¬ch_swahb32s
(
p
);

300 *
p
 = 
	`__swahb32p
(p);

302 
	}
}

	@/usr/include/sys/select.h

21 #iâdeà
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

30 
	~<b™s/£Ëù.h
>

33 
	~<b™s/ty³s/sig£t_t.h
>

36 
	~<b™s/ty³s/time_t.h
>

37 
	~<b™s/ty³s/¡ruù_timev®.h
>

38 #ifdeà
__USE_XOPEN2K


39 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

42 #iâdeà
__su£cÚds_t_defšed


43 
__su£cÚds_t
 
	tsu£cÚds_t
;

44 
	#__su£cÚds_t_defšed


	)

49 
	t__fd_mask
;

52 #undeà
__NFDBITS


54 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

55 
	#__FD_ELT
(
d
è((dè/ 
__NFDBITS
)

	)

56 
	#__FD_MASK
(
d
è((
__fd_mask
è(1UL << ((dè% 
__NFDBITS
)))

	)

63 #ifdeà
__USE_XOPEN


64 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

65 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

67 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

68 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

70 } 
	tfd_£t
;

73 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

75 #ifdeà
__USE_MISC


77 
__fd_mask
 
	tfd_mask
;

80 
	#NFDBITS
 
__NFDBITS


	)

85 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

86 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

87 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

88 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

91 
	g__BEGIN_DECLS


101 #iâdeà
__USE_TIME_BITS64


102 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

103 
fd_£t
 *
__»¡riù
 
__wr™efds
,

104 
fd_£t
 *
__»¡riù
 
__exû±fds
,

105 
timev®
 *
__»¡riù
 
__timeout
);

107 #ifdeà
__REDIRECT


108 
__REDIRECT
 (
£Ëù
,

109 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

110 
fd_£t
 *
__»¡riù
 
__wr™efds
,

111 
fd_£t
 *
__»¡riù
 
__exû±fds
,

112 
timev®
 *
__»¡riù
 
__timeout
),

113 
__£Ëù64
);

115 
	#£Ëù
 
__£Ëù64


	)

119 #ifdeà
__USE_XOPEN2K


126 #iâdeà
__USE_TIME_BITS64


127 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

128 
fd_£t
 *
__»¡riù
 
__wr™efds
,

129 
fd_£t
 *
__»¡riù
 
__exû±fds
,

130 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

131 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

133 #ifdeà
__REDIRECT


134 
__REDIRECT
 (
p£Ëù
,

135 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

136 
fd_£t
 *
__»¡riù
 
__wr™efds
,

137 
fd_£t
 *
__»¡riù
 
__exû±fds
,

138 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

139 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
),

140 
__p£Ëù64
);

142 
	#p£Ëù
 
__p£Ëù64


	)

149 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__GNUC__


150 
	~<b™s/£Ëù2.h
>

153 
	g__END_DECLS


	@/usr/include/asm-generic/posix_types.h

2 #iâdeà
__ASM_GENERIC_POSIX_TYPES_H


3 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

5 
	~<asm/b™¥”lÚg.h
>

14 #iâdeà
__k”Ãl_lÚg_t


15 
	t__k”Ãl_lÚg_t
;

16 
	t__k”Ãl_ulÚg_t
;

19 #iâdeà
__k”Ãl_šo_t


20 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_šo_t
;

23 #iâdeà
__k”Ãl_mode_t


24 
	t__k”Ãl_mode_t
;

27 #iâdeà
__k”Ãl_pid_t


28 
	t__k”Ãl_pid_t
;

31 #iâdeà
__k”Ãl_c_pid_t


32 
	t__k”Ãl_c_pid_t
;

35 #iâdeà
__k”Ãl_uid_t


36 
	t__k”Ãl_uid_t
;

37 
	t__k”Ãl_gid_t
;

40 #iâdeà
__k”Ãl_su£cÚds_t


41 
__k”Ãl_lÚg_t
 
	t__k”Ãl_su£cÚds_t
;

44 #iâdeà
__k”Ãl_daddr_t


45 
	t__k”Ãl_daddr_t
;

48 #iâdeà
__k”Ãl_uid32_t


49 
	t__k”Ãl_uid32_t
;

50 
	t__k”Ãl_gid32_t
;

53 #iâdeà
__k”Ãl_Şd_uid_t


54 
__k”Ãl_uid_t
 
	t__k”Ãl_Şd_uid_t
;

55 
__k”Ãl_gid_t
 
	t__k”Ãl_Şd_gid_t
;

58 #iâdeà
__k”Ãl_Şd_dev_t


59 
	t__k”Ãl_Şd_dev_t
;

66 #iâdeà
__k”Ãl_size_t


67 #ià
__BITS_PER_LONG
 != 64

68 
	t__k”Ãl_size_t
;

69 
	t__k”Ãl_ssize_t
;

70 
	t__k”Ãl_±rdiff_t
;

72 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_size_t
;

73 
__k”Ãl_lÚg_t
 
	t__k”Ãl_ssize_t
;

74 
__k”Ãl_lÚg_t
 
	t__k”Ãl_±rdiff_t
;

78 #iâdeà
__k”Ãl_fsid_t


80 
	mv®
[2];

81 } 
	t__k”Ãl_fsid_t
;

87 
__k”Ãl_lÚg_t
 
	t__k”Ãl_off_t
;

88 
	t__k”Ãl_loff_t
;

89 
__k”Ãl_lÚg_t
 
	t__k”Ãl_Şd_time_t
;

90 
__k”Ãl_lÚg_t
 
	t__k”Ãl_time_t
;

91 
	t__k”Ãl_time64_t
;

92 
__k”Ãl_lÚg_t
 
	t__k”Ãl_şock_t
;

93 
	t__k”Ãl_tim”_t
;

94 
	t__k”Ãl_şockid_t
;

95 * 
	t__k”Ãl_ÿddr_t
;

96 
	t__k”Ãl_uid16_t
;

97 
	t__k”Ãl_gid16_t
;

	@/usr/include/asm/bitsperlong.h

2 #iâdeà
__ASM_X86_BITSPERLONG_H


3 
	#__ASM_X86_BITSPERLONG_H


	)

5 #ià
defšed
(
__x86_64__
è&& !defšed(
__ILP32__
)

6 
	#__BITS_PER_LONG
 64

	)

8 
	#__BITS_PER_LONG
 32

	)

11 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/asm/sockios.h

1 
	~<asm-g’”ic/sockios.h
>

	@/usr/include/asm/swab.h

2 #iâdeà
_ASM_X86_SWAB_H


3 
	#_ASM_X86_SWAB_H


	)

5 
	~<lšux/ty³s.h
>

8 
__šlše__
 
__u32
 
	$__¬ch_swab32
(
__u32
 
v®
)

10 
	`__asm__
("bsw­È%0" : "ô" (
v®
) : "0" (val));

11  
v®
;

12 
	}
}

13 
	#__¬ch_swab32
 
__¬ch_swab32


	)

15 
__šlše__
 
__u64
 
	$__¬ch_swab64
(
__u64
 
v®
)

17 #ifdeà
__i386__


20 
__u32
 
a
;

21 
__u32
 
b
;

22 } 
s
;

23 
__u64
 
u
;

24 } 
v
;

25 
v
.
u
 = 
v®
;

26 
	`__asm__
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

27 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

28 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

29  
v
.
u
;

31 
	`__asm__
("bsw­q %0" : "ô" (
v®
) : "0" (val));

32  
v®
;

34 
	}
}

35 
	#__¬ch_swab64
 
__¬ch_swab64


	)

	@/usr/include/bits/byteswap.h

19 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

30 
	#__bsw­_cÚ¡ªt_16
(
x
) \

31 ((
__ušt16_t
è((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8)))

	)

33 
__šlše
 
__ušt16_t


34 
	$__bsw­_16
 (
__ušt16_t
 
__bsx
)

36 #ià
	`__GNUC_PREREQ
 (4, 8)

37  
	`__butš_bsw­16
 (
__bsx
);

39  
	`__bsw­_cÚ¡ªt_16
 (
__bsx
);

41 
	}
}

44 
	#__bsw­_cÚ¡ªt_32
(
x
) \

45 ((((
x
) & 0xff000000u) >> 24) | (((x) & 0x00ff0000u) >> 8) \

46 | (((
x
è& 0x0000ff00uè<< 8è| (((xè& 0x000000ffuè<< 24))

	)

48 
__šlše
 
__ušt32_t


49 
	$__bsw­_32
 (
__ušt32_t
 
__bsx
)

51 #ià
	`__GNUC_PREREQ
 (4, 3)

52  
	`__butš_bsw­32
 (
__bsx
);

54  
	`__bsw­_cÚ¡ªt_32
 (
__bsx
);

56 
	}
}

59 
	#__bsw­_cÚ¡ªt_64
(
x
) \

60 ((((
x
) & 0xff00000000000000ull) >> 56) \

61 | (((
x
) & 0x00ff000000000000ull) >> 40) \

62 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

63 | (((
x
) & 0x000000ff00000000ull) >> 8) \

64 | (((
x
) & 0x00000000ff000000ull) << 8) \

65 | (((
x
) & 0x0000000000ff0000ull) << 24) \

66 | (((
x
) & 0x000000000000ff00ull) << 40) \

67 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

69 
__ex‹nsiÚ__
 
__šlše
 
__ušt64_t


70 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

72 #ià
	`__GNUC_PREREQ
 (4, 3)

73  
	`__butš_bsw­64
 (
__bsx
);

75  
	`__bsw­_cÚ¡ªt_64
 (
__bsx
);

77 
	}
}

	@/usr/include/bits/endian.h

19 #iâdeà
_BITS_ENDIAN_H


20 
	#_BITS_ENDIAN_H
 1

	)

30 
	#__LITTLE_ENDIAN
 1234

	)

31 
	#__BIG_ENDIAN
 4321

	)

32 
	#__PDP_ENDIAN
 3412

	)

35 
	~<b™s/’dŸÂess.h
>

39 #iâdeà
__FLOAT_WORD_ORDER


40 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

43 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


44 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

45 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


46 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

	@/usr/include/bits/select.h

18 #iâdeà
_SYS_SELECT_H


25 
	#__FD_ZERO
(
s
) \

27 
__i
; \

28 
fd_£t
 *
__¬r
 = (
s
); \

29 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

30 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

31 } 0)

	)

32 
	#__FD_SET
(
d
, 
s
) \

33 ((è(
	`__FDS_BITS
 (
s
)[
	`__FD_ELT
(
d
)] |ğ
	`__FD_MASK
(d)))

	)

34 
	#__FD_CLR
(
d
, 
s
) \

35 ((è(
	`__FDS_BITS
 (
s
)[
	`__FD_ELT
(
d
)] &ğ~
	`__FD_MASK
(d)))

	)

36 
	#__FD_ISSET
(
d
, 
s
) \

37 ((
	`__FDS_BITS
 (
s
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)è!ğ0)

	)

	@/usr/include/bits/select2.h

19 #iâdeà
_SYS_SELECT_H


24 
__fd–t_chk
 (
__d
);

25 
	$__fd–t_w¬n
 (
__d
)

26 
	`__w¬Ç‰r
 ("bit outside of fd_set selected");

27 #undeà
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__ex‹nsiÚ__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__butš_cÚ¡ªt_p
 (
__d
) \

32 ? (0 <ğ
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fd–t_w¬n
 (
__d
)) \

35 : 
	`__fd–t_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/thread-shared-types.h

19 #iâdeà
_THREAD_SHARED_TYPES_H


20 
	#_THREAD_SHARED_TYPES_H
 1

	)

44 
	~<b™s/±h»adty³s-¬ch.h
>

46 
	~<b™s/©omic_wide_couÁ”.h
>

51 
	s__±h»ad_š‹º®_li¡


53 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

54 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

55 } 
	t__±h»ad_li¡_t
;

57 
	s__±h»ad_š‹º®_¦i¡


59 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

60 } 
	t__±h»ad_¦i¡_t
;

76 
	~<b™s/¡ruù_mu‹x.h
>

89 
	~<b™s/¡ruù_rwlock.h
>

94 
	s__±h»ad_cÚd_s


96 
__©omic_wide_couÁ”
 
	m__w£q
;

97 
__©omic_wide_couÁ”
 
	m__g1_¡¬t
;

98 
	m__g_»fs
[2] 
	m__LOCK_ALIGNMENT
;

99 
	m__g_size
[2];

100 
	m__g1_Üig_size
;

101 
	m__w»fs
;

102 
	m__g_sigÇls
[2];

105 
	t__tss_t
;

106 
	t__thrd_t
;

110 
__d©a
 
	m__ONCE_ALIGNMENT
;

111 } 
	t__Úû_æag
;

113 
	#__ONCE_FLAG_INIT
 { 0 }

	)

	@/usr/include/bits/time64.h

19 #iâdeà
_BITS_TYPES_H


23 #iâdef 
_BITS_TIME64_H


24 
	#_BITS_TIME64_H
 1

	)

28 #ià
__TIMESIZE
 == 64

30 
	#__TIME64_T_TYPE
 
__TIME_T_TYPE


	)

33 
	#__TIME64_T_TYPE
 
__SQUAD_TYPE


	)

	@/usr/include/bits/types/sigset_t.h

1 #iâdeà
__sig£t_t_defšed


2 
	#__sig£t_t_defšed
 1

	)

4 
	~<b™s/ty³s/__sig£t_t.h
>

7 
__sig£t_t
 
	tsig£t_t
;

	@/usr/include/bits/types/struct_timespec.h

2 #iâdeà
_STRUCT_TIMESPEC


3 
	#_STRUCT_TIMESPEC
 1

	)

5 
	~<b™s/ty³s.h
>

6 
	~<b™s/’dŸn.h
>

7 
	~<b™s/ty³s/time_t.h
>

11 
	stime¥ec


13 #ifdeà
__USE_TIME_BITS64


14 
__time64_t
 
	mtv_£c
;

16 
__time_t
 
	mtv_£c
;

18 #ià
__WORDSIZE
 == 64 \

19 || (
defšed
 
	m__SYSCALL_WORDSIZE
 && __SYSCALL_WORDSIZE == 64) \

20 || (
__TIMESIZE
 =ğ32 && !
defšed
 
__USE_TIME_BITS64
)

21 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

23 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


25 
	mtv_n£c
;

27 
	mtv_n£c
;

	@/usr/include/bits/types/struct_timeval.h

1 #iâdeà
__timev®_defšed


2 
	#__timev®_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

8 
	stimev®


10 #ifdeà
__USE_TIME_BITS64


11 
__time64_t
 
	mtv_£c
;

12 
__su£cÚds64_t
 
	mtv_u£c
;

14 
__time_t
 
	mtv_£c
;

15 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/typesizes.h

19 #iâdeà
_BITS_TYPES_H


23 #iâdef 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifdeà
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__SUSECONDS64_T_TYPE
 
__SQUAD_TYPE


	)

68 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

69 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

70 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

71 
	#__TIMER_T_TYPE
 *

	)

72 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

73 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

74 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

75 
	#__CPU_MASK_TYPE
 
__SYSCALL_ULONG_TYPE


	)

77 #ifdeà
__x86_64__


81 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

84 
	#__INO_T_MATCHES_INO64_T
 1

	)

87 
	#__RLIM_T_MATCHES_RLIM64_T
 1

	)

90 
	#__STATFS_MATCHES_STATFS64
 1

	)

93 
	#__KERNEL_OLD_TIMEVAL_MATCHES_TIMEVAL64
 1

	)

95 
	#__RLIM_T_MATCHES_RLIM64_T
 0

	)

97 
	#__STATFS_MATCHES_STATFS64
 0

	)

99 
	#__KERNEL_OLD_TIMEVAL_MATCHES_TIMEVAL64
 0

	)

103 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uintn-identity.h

19 #ià!
defšed
 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_UINTN_IDENTITY_H


24 
	#_BITS_UINTN_IDENTITY_H
 1

	)

26 
	~<b™s/ty³s.h
>

32 
__šlše
 
__ušt16_t


33 
	$__ušt16_id’t™y
 (
__ušt16_t
 
__x
)

35  
__x
;

36 
	}
}

38 
__šlše
 
__ušt32_t


39 
	$__ušt32_id’t™y
 (
__ušt32_t
 
__x
)

41  
__x
;

42 
	}
}

44 
__šlše
 
__ušt64_t


45 
	$__ušt64_id’t™y
 (
__ušt64_t
 
__x
)

47  
__x
;

48 
	}
}

	@/usr/include/asm-generic/bitsperlong.h

2 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


3 
	#__ASM_GENERIC_BITS_PER_LONG


	)

12 #iâdeà
__BITS_PER_LONG


13 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/asm-generic/sockios.h

2 #iâdeà
__ASM_GENERIC_SOCKIOS_H


3 
	#__ASM_GENERIC_SOCKIOS_H


	)

6 
	#FIOSETOWN
 0x8901

	)

7 
	#SIOCSPGRP
 0x8902

	)

8 
	#FIOGETOWN
 0x8903

	)

9 
	#SIOCGPGRP
 0x8904

	)

10 
	#SIOCATMARK
 0x8905

	)

11 
	#SIOCGSTAMP_OLD
 0x8906

	)

12 
	#SIOCGSTAMPNS_OLD
 0x8907

	)

	@/usr/include/bits/atomic_wide_counter.h

19 #iâdeà
_BITS_ATOMIC_WIDE_COUNTER_H


20 
	#_BITS_ATOMIC_WIDE_COUNTER_H


	)

27 
__ex‹nsiÚ__
 
	m__v®ue64
;

30 
	m__low
;

31 
	m__high
;

32 } 
	m__v®ue32
;

33 } 
	t__©omic_wide_couÁ”
;

	@/usr/include/bits/endianness.h

1 #iâdeà
_BITS_ENDIANNESS_H


2 
	#_BITS_ENDIANNESS_H
 1

	)

4 #iâdeà
_BITS_ENDIAN_H


9 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/pthreadtypes-arch.h

18 #iâdeà
_BITS_PTHREADTYPES_ARCH_H


19 
	#_BITS_PTHREADTYPES_ARCH_H
 1

	)

21 
	~<b™s/wÜdsize.h
>

23 #ifdeà
__x86_64__


24 #ià
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

28 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

30 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

31 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

32 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

36 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

37 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

38 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

39 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

41 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

42 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

43 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

44 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

45 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

47 
	#__LOCK_ALIGNMENT


	)

48 
	#__ONCE_ALIGNMENT


	)

50 #iâdeà
__x86_64__


52 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/struct_mutex.h

19 #iâdeà
_THREAD_MUTEX_INTERNAL_H


20 
	#_THREAD_MUTEX_INTERNAL_H
 1

	)

22 
	s__±h»ad_mu‹x_s


24 
	m__lock
;

25 
	m__couÁ
;

26 
	m__owÃr
;

27 #ifdeà
__x86_64__


28 
	m__nu£rs
;

32 
	m__kšd
;

33 #ifdeà
__x86_64__


34 
	m__¥šs
;

35 
	m__–isiÚ
;

36 
__±h»ad_li¡_t
 
	m__li¡
;

37 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

39 
	m__nu£rs
;

40 
__ex‹nsiÚ__
 union

44 
	m__e¥šs
;

45 
	m__“lisiÚ
;

46 
	#__¥šs
 
__–isiÚ_d©a
.
__e¥šs


	)

47 
	#__–isiÚ
 
__–isiÚ_d©a
.
__“lisiÚ


	)

48 } 
	m__–isiÚ_d©a
;

49 
__±h»ad_¦i¡_t
 
	m__li¡
;

51 
	#__PTHREAD_MUTEX_HAVE_PREV
 0

	)

55 #ifdeà
__x86_64__


56 
	#__PTHREAD_MUTEX_INITIALIZER
(
__kšd
) \

57 0, 0, 0, 0, 
__kšd
, 0, 0, { 0, 0 }

	)

59 
	#__PTHREAD_MUTEX_INITIALIZER
(
__kšd
) \

60 0, 0, 0, 
__kšd
, 0, { { 0, 0 } }

	)

	@/usr/include/bits/struct_rwlock.h

20 #iâdeà
_RWLOCK_INTERNAL_H


21 
	#_RWLOCK_INTERNAL_H


	)

23 
	s__±h»ad_rwlock_¬ch_t


25 
	m__»ad”s
;

26 
	m__wr™”s
;

27 
	m__w½ha£_fu‹x
;

28 
	m__wr™”s_fu‹x
;

29 
	m__·d3
;

30 
	m__·d4
;

31 #ifdeà
__x86_64__


32 
	m__cur_wr™”
;

33 
	m__sh¬ed
;

34 sigÃd 
	m__rw–isiÚ
;

35 #ifdeà 
__ILP32__


36 
	m__·d1
[3];

37 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0 }

	)

39 
	m__·d1
[7];

40 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0, 0, 0, 0, 0 }

	)

42 
	m__·d2
;

45 
	m__æags
;

49 
	m__æags
;

50 
	m__sh¬ed
;

51 sigÃd 
	m__rw–isiÚ
;

52 
	m__·d2
;

53 
	m__cur_wr™”
;

57 #ifdeà
__x86_64__


58 
	#__PTHREAD_RWLOCK_INITIALIZER
(
__æags
) \

59 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 
__æags


	)

61 
	#__PTHREAD_RWLOCK_INITIALIZER
(
__æags
) \

62 0, 0, 0, 0, 0, 0, 
__æags
, 0, 0, 0, 0

	)

	@/usr/include/bits/types/__sigset_t.h

1 #iâdeà
____sig£t_t_defšed


2 
	#____sig£t_t_defšed


	)

4 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

7 
	m__v®
[
_SIGSET_NWORDS
];

8 } 
	t__sig£t_t
;

	@
1
.
1
/usr/include
234
5255
acm_api.c
ba.c
ba.h
ba_replay.c
cac.c
cac.h
cfg80211_ops.c
cfg80211_ops.h
cm_if.c
const.h
debug.c
debug.h
debug_frame.c
dev.c
dev.h
fapi.h
fw_test.c
fw_test.h
hanged_record.h
hip.c
hip.h
hip4.c
hip4.h
hip4_sampler.c
hip4_sampler.h
hip4_smapper.c
hip4_smapper.h
hip_bh.h
ini_config.c
ioctl.c
ioctl.h
kic.c
kic.h
log2us.c
log2us.h
log_clients.c
log_clients.h
mbulk.c
mbulk.h
mbulk_def.h
mgt.c
mgt.h
mib.c
mib.h
mib_text_convert.c
mib_text_convert.h
mlme.c
mlme.h
mlme_nan.c
netif.c
netif.h
nl80211_vendor.c
nl80211_vendor.h
nl80211_vendor_nan.c
nl80211_vendor_nan.h
porting_imx.h
procfs.c
procfs.h
qsfs.c
qsfs.h
reg_info.c
reg_info.h
rx.c
sap.h
sap_dbg.c
sap_dbg.h
sap_ma.c
sap_ma.h
sap_mlme.c
sap_mlme.h
sap_test.c
sap_test.h
scsc_wifi_cm_if.h
scsc_wifi_fcq.c
scsc_wifi_fcq.h
scsc_wifilogger.h
scsc_wifilogger_api.c
scsc_wifilogger_core.c
scsc_wifilogger_core.h
scsc_wifilogger_debugfs.c
scsc_wifilogger_debugfs.h
scsc_wifilogger_internal.c
scsc_wifilogger_internal.h
scsc_wifilogger_module.c
scsc_wifilogger_module.h
scsc_wifilogger_ring_connectivity.c
scsc_wifilogger_ring_connectivity.h
scsc_wifilogger_ring_connectivity_api.h
scsc_wifilogger_ring_pktfate.c
scsc_wifilogger_ring_pktfate.h
scsc_wifilogger_ring_pktfate_api.h
scsc_wifilogger_ring_test.c
scsc_wifilogger_ring_test.h
scsc_wifilogger_ring_wakelock.c
scsc_wifilogger_ring_wakelock.h
scsc_wifilogger_ring_wakelock_api.h
scsc_wifilogger_rings.h
scsc_wifilogger_types.h
scsc_wlan_mmap.c
scsc_wlan_mmap.h
slsi_cpuhp_monitor.c
slsi_cpuhp_monitor.h
src_sink.c
src_sink.h
test/dev_test.c
test/hip_test.c
test/hydra_test.c
test/udi_test.c
test/unittest.h
traffic_monitor.c
traffic_monitor.h
tx.c
tx_api.h
udi.c
udi.h
unifiio.h
utils.h
wl_result.h
../../../misc/samsung/scsc/scsc_wlbtd.h
/usr/include/linux/errno.h
/usr/include/linux/fs.h
/usr/include/linux/if.h
/usr/include/linux/if_ether.h
/usr/include/linux/igmp.h
/usr/include/linux/in.h
/usr/include/linux/ip.h
/usr/include/linux/kernel.h
/usr/include/linux/module.h
/usr/include/linux/netdevice.h
/usr/include/linux/nl80211.h
/usr/include/linux/poll.h
/usr/include/linux/rtnetlink.h
/usr/include/linux/sched.h
/usr/include/linux/socket.h
/usr/include/linux/string.h
/usr/include/linux/time.h
/usr/include/linux/types.h
/usr/include/linux/version.h
/usr/include/linux/wait.h
/usr/include/linux/wireless.h
/usr/include/sys/socket.h
/usr/include/asm/byteorder.h
/usr/include/asm/errno.h
/usr/include/asm/poll.h
/usr/include/asm/types.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/types/struct_iovec.h
/usr/include/bits/types/struct_osockaddr.h
/usr/include/features.h
/usr/include/linux/const.h
/usr/include/linux/fscrypt.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_addr.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/ioctl.h
/usr/include/linux/libc-compat.h
/usr/include/linux/limits.h
/usr/include/linux/mount.h
/usr/include/linux/neighbour.h
/usr/include/linux/netlink.h
/usr/include/linux/posix_types.h
/usr/include/linux/stddef.h
/usr/include/linux/sysinfo.h
/usr/include/linux/time_types.h
/usr/include/string.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/poll.h
/usr/include/asm-generic/types.h
/usr/include/asm/ioctl.h
/usr/include/asm/posix_types.h
/usr/include/asm/socket.h
/usr/include/bits/libc-header-start.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket-constants.h
/usr/include/bits/socket_type.h
/usr/include/bits/string_fortified.h
/usr/include/bits/types/locale_t.h
/usr/include/bits/types/time_t.h
/usr/include/features-time64.h
/usr/include/gnu/stubs.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/stdc-predef.h
/usr/include/strings.h
/usr/include/sys/cdefs.h
/usr/include/sys/types.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm-generic/socket.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/bits/long-double.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/stdint-intn.h
/usr/include/bits/strings_fortified.h
/usr/include/bits/timesize.h
/usr/include/bits/types.h
/usr/include/bits/types/__locale_t.h
/usr/include/bits/types/clock_t.h
/usr/include/bits/types/clockid_t.h
/usr/include/bits/types/timer_t.h
/usr/include/bits/wordsize.h
/usr/include/endian.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/gnu/stubs-x32.h
/usr/include/linux/swab.h
/usr/include/sys/select.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/sockios.h
/usr/include/asm/swab.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/thread-shared-types.h
/usr/include/bits/time64.h
/usr/include/bits/types/sigset_t.h
/usr/include/bits/types/struct_timespec.h
/usr/include/bits/types/struct_timeval.h
/usr/include/bits/typesizes.h
/usr/include/bits/uintn-identity.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/asm-generic/sockios.h
/usr/include/bits/atomic_wide_counter.h
/usr/include/bits/endianness.h
/usr/include/bits/pthreadtypes-arch.h
/usr/include/bits/struct_mutex.h
/usr/include/bits/struct_rwlock.h
/usr/include/bits/types/__sigset_t.h
